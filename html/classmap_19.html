<div class="container">

<table style="width: 100%;"><tr>
<td>vcr.neural.train</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Prepare for visualization of a neural network classification on training data.
</h2>

<h3>Description</h3>

<p>Produces output for the purpose of constructing graphical displays such as the <code>classmap</code>. The user first needs train a neural network. The representation of the data in a given layer (e.g. the final layer before applying the softmax function) then serves as the argument <code>X</code> to  <code>vcr.neural.train</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">vcr.neural.train(X, y, probs, estmethod = meancov)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>the coordinates of the <code>n</code> objects of the training
data, in the layer chosen by the user. Missing
values are not allowed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>factor with the given class labels of the objects.
Make sure that the levels are in the same order as
used in the neural net, i.e. the columns of its
binary "once-hot-encoded" response vectors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>
<p>posterior probabilities obtained by the neural
net, e.g. in keras. For each case (row of <code>X</code>),
the classes have probabilities that add up to 1.
Each row of the matrix probs contains these
probabilities. The columns of probs must be in
the same order as the levels of <code>y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estmethod</code></td>
<td>
<p>function for location and covariance estimation.
Should return a list with <code>$m</code> and <code>$S</code>.
Can be <code>meancov</code>
(classical mean and covariance matrix) or <code>DetMCD</code>.
If one or more classes have a singular covariance
matrix, the function automatically switches to
the PCA-based farness used in <code>vcr.svm.train</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with components: <br></p>
<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>the coordinates of the <code>n</code> objects of the training
data, in the layer chosen by the user.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yint</code></td>
<td>
<p>number of the given class of each case. Can contain <code>NA</code>'s.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>given class label of each case. Can contain <code>NA</code>'s.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>levels</code></td>
<td>
<p>levels of <code>y</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predint</code></td>
<td>
<p>predicted class number of each case. For each case this is the class with the highest posterior probability. Always exists.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred</code></td>
<td>
<p>predicted label of each case.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>altint</code></td>
<td>
<p>number of the alternative class. Among the classes different from the given class, it is the one with the highest posterior probability. Is <code>NA</code> for cases whose <code>y</code> is missing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>altlab</code></td>
<td>
<p>label of the alternative class. Is <code>NA</code> for cases whose <code>y</code> is missing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncolX</code></td>
<td>
<p>number of columns in <code>X</code>.  Keep??</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PAC</code></td>
<td>
<p>probability of the alternative class. Is <code>NA</code> for cases whose <code>y</code> is missing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>computeMD</code></td>
<td>
<p>Whether or not the farness is computed using the Mahalanobis distance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>classMS</code></td>
<td>
<p>list with center and covariance matrix of each class</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PCAfits</code></td>
<td>
<p>if not <code>NULL</code>, PCA fits to each class, estimated from the training data but also useful for new data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>figparams</code></td>
<td>
<p>parameters for computing <code>fig</code>, can be used for new data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fig</code></td>
<td>
<p>distance of each case <code class="reqn">i</code> from each class <code class="reqn">g</code>. Always exists.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>farness</code></td>
<td>
<p>farness of each case from its given class. Is <code>NA</code> for cases whose <code>y</code> is missing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ofarness</code></td>
<td>
<p>for each case <code>i</code>, its lowest  <code>fig[i,g]</code> to any class <code>g</code>. Always exists.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Raymaekers J., Rousseeuw P.J.
</p>


<h3>References</h3>

<p>Raymaekers J., Rousseeuw P.J.(2021). Silhouettes and quasi residual plots for neural nets and tree-based classifiers. <a href="https://arxiv.org/abs/2106.08814">(link to open access pdf)</a>
</p>


<h3>See Also</h3>

<p><code>vcr.neural.newdata</code>, <code>classmap</code>, <code>silplot</code>, <code>stackedplot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># For examples, we refer to the vignette:
## Not run: 
vignette("Neural_net_examples")

## End(Not run)
</code></pre>


</div>