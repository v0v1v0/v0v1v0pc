<div class="container">

<table style="width: 100%;"><tr>
<td>count_and_plot_ancestry_matrices</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Count up the number of different kinds of related pairs and make a plot</h2>

<h3>Description</h3>

<p>This counts up all the different types of pairwise relationships and
makes a plot (or multiple pages of them). For an example, see
the Vignette: <code>vignette("species_1_simulation", package = "CKMRpop")</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">count_and_plot_ancestry_matrices(
  Pairs,
  nrow = 6,
  ncol = 5,
  white_ball_size = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Pairs</code></td>
<td>
<p>a tibble like that returned by <code>compile_related_pairs()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrow</code></td>
<td>
<p>the number of rows to plot per page</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncol</code></td>
<td>
<p>the number of columns to plot per page</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>white_ball_size</code></td>
<td>
<p>the size of the white dot plotted on top of the
primary shared ancestors' cells.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list with the following components:
</p>

<ul>
<li> <p><code>highly_summarised</code>: a tibble reporting counts of different types of relationships with
the columns:
</p>

<ul>
<li> <p><code>dom_relat</code>: The name of the dominant relationship (e.g. Si, PO, A, etc).
</p>
</li>
<li> <p><code>max_hit</code>: The number of primary shared ancestors.
</p>
</li>
<li> <p><code>n</code>: The number of occurrences of this type of relationship.
</p>
</li>
</ul>
</li>
<li> <p><code>dr_counts</code>: A tibble with the counts of all the different, unique ancestry match matrices
observed, with the following columns:
</p>

<ul>
<li> <p><code>dom_relat</code>: The dominant relationship type
</p>
</li>
<li> <p><code>dr_hits</code>: list column with the number of primary shared ancestors in the upper and lower quadrants
of the ancestry match matrix (values are repeated for symmetrical relationships).
</p>
</li>
<li> <p><code>max_hit</code>: the number of primary shared ancestors.
</p>
</li>
<li> <p><code>anc_match_matrix</code>: a list column of ancestry match matrices.
</p>
</li>
<li> <p><code>n</code>: The number of pairs with this type of ancestry match matrix
</p>
</li>
<li> <p><code>tot_dom</code>: The total number of pairs within the given dominant relationship category.
</p>
</li>
<li> <p><code>ID</code>: A unique, properly sorting name for this category for placing a title on
facets of plots of these ancestry match matrices.
</p>
</li>
</ul>
</li>
<li> <p><code>dr_plots</code>: a list named by the dominant relationship. Each component is a ggplot
object which is a plot of the ancestry match matrices, faceted by their <code>ID</code>'s as
given in <code>dr_counts</code>.
</p>
</li>
<li> <p><code>anc_mat_counts</code>: A tibble summarizing the counts of different ancestry match matrices
without regard to dominant relationship type, etc. Rows are arranged in descending order
of number of pairs observed with each ancestry match matrix. It has the columns:
</p>

<ul>
<li> <p><code>anc_match_matrix</code>: a list column of ancestry match matrices.
</p>
</li>
<li> <p><code>n</code>:  the number of such matrices observed.
</p>
</li>
</ul>
</li>
<li> <p><code>anc_mat_plots</code>: a list of ggplot pages.  These are plots faceted by ancestry match
matrix of all ancestry match matrices observed, ordered by number of occurrences (as
given in <code>anc_mat_counts</code>).
</p>
</li>
</ul>
</div>