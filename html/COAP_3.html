<div class="container">

<table style="width: 100%;"><tr>
<td>selectParams</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Select the parameters in COAP models</h2>

<h3>Description</h3>

<p>Select the number of factors and the rank of coefficient matrix in the covariate-augmented overdispersed Poisson factor model
</p>


<h3>Usage</h3>

<pre><code class="language-R">selectParams(
  X_count,
  Z,
  multiFac = rep(1, nrow(X_count)),
  q_max = 15,
  r_max = 24,
  threshold = c(0.1, 0.01),
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X_count</code></td>
<td>
<p>a count matrix, the observed count matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>an optional matrix, the covariate matrix; default as a full-one column vector if there is no additional covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>multiFac</code></td>
<td>
<p>an optional vector, the normalization factor for each unit; default as full-one vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q_max</code></td>
<td>
<p>an optional string, specify the upper bound for the number of factors; default as 15.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r_max</code></td>
<td>
<p>an optional integer, specify the upper bound for the rank of the regression coefficient matrix; default as 24.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>an optional 2-dimensional positive vector, specify the the thresholds that filters the singular values of beta and B, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>a logical value, whether output the information in iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>..., </code></td>
<td>
<p>other arguments passed to the function <code>RR_COAP</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The threshold is to filter the singular values with  low signal, to assist the identification of underlying model structure.
</p>


<h3>Value</h3>

<p>return a named vector with names 'hr' and 'hq', the estimated rank and number of factors.
</p>


<h3>References</h3>

<p>None
</p>


<h3>See Also</h3>

<p><code>RR_COAP</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">n &lt;- 300; p &lt;- 100
d &lt;- 20; q &lt;- 6; r &lt;- 3
datlist &lt;- gendata_simu(seed=30, n=n, p=p, d=20, q=q, rank0=r)
str(datlist)
set.seed(1)
para_vec &lt;- selectParams(X_count=datlist$X, Z = datlist$Z)
print(para_vec)
</code></pre>


</div>