<div class="container">

<table style="width: 100%;"><tr>
<td>write_h</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Write structure factors to a reflections file</h2>

<h3>Description</h3>

<p>This function writes standardised structure factors data into an ASCII
file. The files includes cell size, space group character symbol and
Miller indices vector. It can include all of some of observed and/or
calculated structure factors amplitudes and phases, either for anomalous
or non-anomalous data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">write_h(filename, fdata)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>filename</code></td>
<td>
<p>A character string. Prefix of the structure factors
file name. The file name has the form "[prefix]_h.dat".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fdata</code></td>
<td>
<p>A names list, usually created with functions 
<code>standardise_fdata</code> or <code>read_h</code>, and consisting of
the following fields:
</p>

<ul>
<li>
<p>a    Real numeric. Unit cell length in angstroms. Always 
included.
</p>
</li>
<li>
<p>SG.   Spacegroup 2-letters character string. There are only two 
symmetries possible when working within 1D 
crystallography, P1 (no symmetry) and P-1 (inversion 
through the origin). SG can be either "P1" or "P-1". 
Always included.
</p>
</li>
<li>
<p>hidx. Real numeric array. 1D unique (positive in the 1D context) 
Miller indices. Always included.
</p>
</li>
<li>
<p>Fobs.      Real numeric array. Amplitudes of observed structure 
factors. Not always included.
</p>
</li>
<li>
<p>sigFobs.   Real numeric array. Errors associated with Fobs. Not 
always included.
</p>
</li>
<li>
<p>Fp.        Real numeric vector. Amplitudes of the positive 
component of Friedel (or Bijvoet) pairs (F+). Not
always included.
</p>
</li>
<li>
<p>sigFp.     Real numeric vector. Errors associated with Fp. 
Not always included.
</p>
</li>
<li>
<p>Fm.        Real numeric vector. Amplitudes of the negative 
component of Friedel (or Bijvoet) pairs (F-). Not always
included.
</p>
</li>
<li>
<p>sigFm.     Real numeric vector. Errors associated with Fm. Not
always included.
</p>
</li>
<li>
<p>Phiobs.    Real numeric array. Phases (in degrees) of structure 
factors obtained with one of the methods used for 
structure solution. Not always included.
</p>
</li>
<li>
<p>Phicalc.   Real numeric array. Phases (in degrees) of structure 
factors calculated from the correct 1D structure. 
They are normally used to check correctness of 
Phiobs. Not always included.
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Value</h3>

<p>This function does not return anything, but will create an ASCII 
file of name *_h.dat which contains structure factors and other type of 
information.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Data from thiocyanate structure
datadir &lt;- system.file("extdata",package="crone")
filename &lt;- file.path(datadir,"thiocyanate_x.dat")
sdata &lt;- read_x(filename)

# Miller indices
hidx &lt;- 1:10

# Observed structure factors with errors
ltmp &lt;- sfobs(hidx,sdata)
Fobs &lt;- ltmp$F
sigFobs &lt;- ltmp$sF

# Phases from calculated structure factors
ftmp &lt;- strufac(hidx,sdata)
phicalc &lt;- ftmp$Fpha

# Create standardised fdata structure
fdata &lt;- standardise_fdata(sdata$a,sdata$SG,hidx,Fobs=Fobs,
                     sigFobs=sigFobs,Phicalc=phicalc)
 
# Name of structure factors file (in temporary directory)
wd &lt;- tempdir()
fname &lt;- file.path(wd,"test")

# Write data to file
write_h(fname,fdata)

</code></pre>


</div>