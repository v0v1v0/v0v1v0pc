<div class="container">

<table style="width: 100%;"><tr>
<td>condtMVN</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Conditional Truncated Multivariate Normal Parameters</h2>

<h3>Description</h3>

<p>Suppose that <strong>Z = (X,Y)</strong> is from a fully-joint multivariate normal distribution of dimension <em>n</em> with <code>mean</code> and covariance matrix <code>sigma</code> truncated between <code>lower</code> and <code>upper</code>. This function provides the parameters for the conditional mean and covariance matrix of <strong>Y</strong> given <strong>X</strong>. See the vignette for more information.
</p>


<h3>Usage</h3>

<pre><code class="language-R">condtMVN(
  mean,
  sigma,
  lower,
  upper,
  dependent.ind,
  given.ind,
  X.given,
  init = rep(0, length(mean))
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p>the mean vector for Z of length of n</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>the symmetric and positive-definite covariance matrix of dimension n x n of Z.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>a vector of lower bounds of length n that truncate Z</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>a vector of upper bounds of length n that truncate Z</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dependent.ind</code></td>
<td>
<p>a vector of integers denoting the indices of dependent variable Y.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>given.ind</code></td>
<td>
<p>a vector of integers denoting the indices of conditioning variable X.  If specified as integer vector of length zero or left unspecified, the unconditional density is returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X.given</code></td>
<td>
<p>a vector of reals denoting the conditioning value of X. This should be of the same length as <code>given.ind</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>initial value used for random generation of truncated multivariate normal in a Gibbs sampler. Default: A vector of zeros, equal to the number of components. For details, see tmvmixnorm::<code>rtmvn</code>().</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The first four arguments are the parameters of multivariate normal and the truncation space. <code>dependent.ind, given.ind, X.given, init</code> are all arguments that determines the conditional truncated MVN.
</p>
<p>Using the full data <strong>Z</strong>, the conditional mean and conditional variance of <strong>Y|X</strong> are determined (Wang, 2006). Additionally, to reflect the reduced dimension of <strong>Y|X</strong>, the truncation limits are also adjusted.
</p>
<p>See the vignette for more information.
</p>


<h3>Value</h3>

<p>Returns a list of: </p>

<ul>
<li>
<p> condMean - conditional mean of <strong>Y|X</strong>
</p>
</li>
<li>
<p> condVar - conditional variance of <strong>Y|X</strong>
</p>
</li>
<li>
<p> condLower - the lower bound of <strong>Y|X</strong>
</p>
</li>
<li>
<p> condUpper - the upper bound of <strong>Y|X</strong>
</p>
</li>
<li>
<p> condInit - the initial values adjusted to match the dimension of <strong>Y|X</strong>. These are used to randomly generate the truncated multivariate normal rcmvtruncnorm.
</p>
</li>
</ul>
<h3>Note</h3>

<p>This function is based on <code>condMVN</code> from the <strong>condMVNorm</strong> package.
</p>


<h3>References</h3>

<p>Wang, R. 2006. Appendix A: Marginal and conditional distributions of multivariate normal distribution. <a href="http://fourier.eng.hmc.edu/e161/lectures/gaussianprocess/node7.html">http://fourier.eng.hmc.edu/e161/lectures/gaussianprocess/node7.html</a>.
</p>


<h3>See Also</h3>

<p><code>cmvnorm</code>, <code>pmvnorm</code>, <code>Mvnorm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Suppose X2,X3,X5|X2,X4 ~ N_3(1, Sigma) and truncated between -10 and 10.
d &lt;- 5
rho &lt;- 0.9
Sigma &lt;- matrix(0, nrow = d, ncol = d)
Sigma &lt;- rho^abs(row(Sigma) - col(Sigma))

# Conditional Truncated Normal Parameters
condtMVN(mean = rep(1, d),
  sigma = Sigma,
  lower = rep(-10, d),
  upper = rep(10, d),
  dependent.ind = c(2, 3, 5),
  given.ind = c(1, 4), X.given = c(1, -1)
)
</code></pre>


</div>