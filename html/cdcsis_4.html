<div class="container">

<table style="width: 100%;"><tr>
<td>cdcov.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Conditional Distance Covariance Independence Test</h2>

<h3>Description</h3>

<p>Performs the nonparametric conditional distance covariance test for conditional independence assumption
</p>


<h3>Usage</h3>

<pre><code class="language-R">cdcov.test(
  x,
  y,
  z,
  num.bootstrap = 99,
  width,
  distance = FALSE,
  index = 1,
  seed = 1,
  num.threads = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector, matrix, or <code>dist</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a numeric vector, matrix, or <code>dist</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p><code>z</code> is a numeric vector or matrix. It is the variable being conditioned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.bootstrap</code></td>
<td>
<p>the number of local bootstrap procedure replications. Default: <code>num.bootstrap = 99</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>a user-specified positive value (univariate conditional variable) or vector (multivariate conditional variable) for 
gaussian kernel bandwidth. Its default value is relies on <code>stats::bw.nrd0</code> function when conditional variable is univariate, 
<code>ks::Hpi.diag</code> when conditional variable with at most trivariate, and <code>stats::bw.nrd</code> on the other cases.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p>if <code>distance = TRUE</code>, <code>x</code> and <code>y</code> will be considered as distance matrices. Default: <code>distance = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>
<p>exponent on Euclidean distance, in <code class="reqn">(0,2]</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>the random seed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.threads</code></td>
<td>
<p>number of threads. Default <code>num.threads = 1</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>cdcov.test</code> returns a list with class "htest" containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>conditional distance covariance statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>the <code class="reqn">p</code>-value for the test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replicates</code></td>
<td>
<p>the number of local bootstrap procedure replications.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>sample sizes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>a character string describing the alternative hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string indicating what type of test was performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p>description of data.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Wang, X., Pan, W., Hu, W., Tian, Y. and Zhang, H., 2015. Conditional distance correlation. Journal of the American Statistical Association, 110(512), pp.1726-1734.
</p>


<h3>See Also</h3>

<p><code>cdcov</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">

library(cdcsis)
set.seed(1)
num &lt;- 50
################# Conditional Independent #################
## Case 1:
cov_mat &lt;- matrix(c(1, 0.36, 0.6, 0.36, 1, 0.6, 0.6, 0.6, 1), nrow = 3)
dat &lt;- mvtnorm::rmvnorm(n = num, sigma = cov_mat)
x &lt;- dat[, 1]
y &lt;- dat[, 2]
z &lt;- dat[, 3]
cdcov.test(x, y, z)
## Case 2:
z &lt;- rnorm(num)
x &lt;- 0.5 * (z^3 / 7 + z / 2) + tanh(rnorm(num))
x &lt;- x + x^3 / 3
y &lt;- (z^3 + z) / 3 + rnorm(num)
y &lt;- y + tanh(y / 3)
cdcov.test(x, y, z, num.bootstrap = 99)

################# Conditional Dependent #################
## Case 3:
cov_mat &lt;- matrix(c(1, 0.7, 0.6, 0.7, 1, 0.6, 0.6, 0.6, 1), nrow = 3)
dat &lt;- mvtnorm::rmvnorm(n = num, sigma = cov_mat)
x &lt;- dat[, 1]
y &lt;- dat[, 2]
z &lt;- dat[, 3]
cdcov.test(x, y, z, width = 0.5)
## Case 4:
z &lt;- matrix(rt(num * 4, df = 2), nrow = num)
x &lt;- z
y &lt;- cbind(sin(z[, 1]) + cos(z[, 2]) + (z[, 3])^2 + (z[, 4])^2, 
           (z[, 1])^2 + (z[, 2])^2 + z[, 3] + z[, 4])
z &lt;- z[, 1:2]
cdcov.test(x, y, z, seed = 2)

################# Distance Matrix Input #################
x &lt;- dist(x)
y &lt;- dist(y)
cdcov.test(x, y, z, seed = 2, distance = TRUE)

</code></pre>


</div>