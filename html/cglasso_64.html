<div class="container">

<table style="width: 100%;"><tr>
<td>qqcnorm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Quantile-Quantile Plots for a <code>datacggm</code> Object</h2>

<h3>Description</h3>

<p>Creates a quantile-quantile plot for a censored Gaussian distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">qqcnorm(x, which, max.plot = 1L, save.plot = FALSE, grdev = pdf, grdev.arg,
        main = "Censored Normal Q-Q Plot", xlab = "Theoretical Quantiles",
        ylab = "Sample Quantiles", plot.it = TRUE, plot.pch = c(2L, 20L),
        plot.col = c(2L, 1L), plot.cex = c(2L, 1L), abline = FALSE,
        line.col = "gray50", line.lwd = 1L, line.lty = 2L, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class ‘<code>datacggm</code>’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>a vector of integers used to specify the response variables for which the histogram is required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.plot</code></td>
<td>
<p>the maximum number of plots drawn in a single figure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save.plot</code></td>
<td>
<p>a logical variable or a string specifying the path of the directory where plots will be saved. Letting ‘<code>save.plot = TRUE</code>’, the required plots will be saved as external files inside the current working directory. User can save these files on a specific working directory passing the absolute path through the argument <code>save.plot</code>. On exit, working directory will be always set the previous one.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grdev</code></td>
<td>
<p>the graphics device used to save the required histograms on external files. See ‘<code>device</code>’ for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grdev.arg</code></td>
<td>
<p>additional parameters passed to the graphics device specified by ‘<code>grdev</code>’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main, xlab, ylab</code></td>
<td>
<p>plot labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.it</code></td>
<td>
<p>logical. Should the result be plotted?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.pch</code></td>
<td>
<p>a pair of graphical parameters. The first entry specifies the symbol used for plotting the points associated to the censoring values <code class="reqn">lo</code> and <code class="reqn">up</code> (by default a triangle), whereas the second entry specifies the symbol used for the remaining points (by default a black point).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.col</code></td>
<td>
<p>a pair of graphical parameters. The first entry specifies the colour used for plotting the points associated to the censoring values <code class="reqn">lo</code> and <code class="reqn">up</code> (by default a red triangle), whereas the second entry specifies the colour used for the remaining points (by default a black point).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.cex</code></td>
<td>
<p>a pair of graphical parameters. The first entry specifies the size of the symbol used for plotting the points associated to the censoring values <code class="reqn">lo</code> and <code class="reqn">up</code>, whereas the second entry specifies the size of the symbol used for the remaining points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abline</code></td>
<td>
<p>logical. Should the line <code class="reqn">y = x</code> be plotted?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line.col</code></td>
<td>
<p>graphical parameter. If ‘<code>abline = TRUE</code>’, then this argument specifies the colour of the line <code class="reqn">y = x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line.lwd</code></td>
<td>
<p>graphical parameter. If ‘<code>abline = TRUE</code>’, then this argument specifies the line width of the line <code class="reqn">y = x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line.lty</code></td>
<td>
<p>graphical parameter. If ‘<code>abline = TRUE</code>’, then this argument specifies the line type of the line <code class="reqn">y = x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional graphical parameter passed to ‘<code>plot</code>’.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>‘<code>qqcnorm</code>’ produces a censored normal QQ plot, that is, a graphical method for comparing the empirical distribution of a given response variable (specified by the argument <code>which</code>) to the censored Gaussian distribution, which is defined as:
</p>

<table>
<tr>
<td style="text-align: left;">
<code class="reqn">\Phi((lo - \mu)/\sigma)</code> </td>
<td style="text-align: center;"> if </td>
<td style="text-align: left;"> <code class="reqn">y\le lo</code> </td>
</tr>
<tr>
<td style="text-align: left;">
<code class="reqn">\phi((y - \mu)/\sigma) / \sigma</code> </td>
<td style="text-align: center;"> if </td>
<td style="text-align: left;"> <code class="reqn">lo &lt; y &lt; up</code> </td>
</tr>
<tr>
<td style="text-align: left;">
<code class="reqn">1 - \Phi((up - \mu)/\sigma)</code> </td>
<td style="text-align: center;"> if </td>
<td style="text-align: left;"> <code class="reqn">y\ge up</code>
</td>
</tr>
</table>
<p>where <code class="reqn">\phi</code> and <code class="reqn">\Phi</code> are the probability density function and the cumulative ditribution of the standard normal distribution, respectively, whereas <code class="reqn">lo</code> and <code class="reqn">up</code> are the lower and upper censoring values, respectively.
</p>
<p>The comparison is done by plotting the empirical quantiles (<code class="reqn">y</code>-coordinate) against the theoretical quantiles (<code class="reqn">x</code>-coordinate) of the censored Gaussian distribution, which are defined as follows:
</p>

<table>
<tr>
<td style="text-align: left;">
<code class="reqn">lo</code> </td>
<td style="text-align: center;"> if </td>
<td style="text-align: left;"> <code class="reqn">p \le \Phi((lo - \mu)/\sigma)</code> </td>
</tr>
<tr>
<td style="text-align: left;">
<code class="reqn">\mu + \sigma \Phi^{-1}(p)</code> </td>
<td style="text-align: center;"> if </td>
<td style="text-align: left;"> <code class="reqn">\Phi((lo - \mu)/\sigma) &lt; p &lt; 1 - \Phi((up - \mu)/\sigma)</code> </td>
</tr>
<tr>
<td style="text-align: left;">
<code class="reqn">up</code> </td>
<td style="text-align: center;"> if </td>
<td style="text-align: left;"> <code class="reqn">p \ge 1 - \Phi((up - \mu)/\sigma)</code> 
</td>
</tr>
</table>
<p>where <code class="reqn">p\in(0, 1)</code>. If the two distributions are similar, the points will approximately lie on the line <code class="reqn">y = x</code>. If the distributions are linearly related, the points will approximately lie on a line, but not necessarily on the line <code class="reqn">y = x</code>. In order to evaluate if the proportions of left/right-censored values are similar to the Gaussian tail probabilities, points corresponding to the censored values are plotted using a  specific symbol (see argument ‘<code>plot.pch</code>’), colour (see argument ‘<code>plot.col</code>’) and size (see argument ‘<code>plot.cex</code>’).
</p>
<p>Finally, maximum likelihood estimates of the marginal parameters <code class="reqn">\mu</code> and <code class="reqn">\sigma</code> are computed as described in ‘<code>datacggm</code>’ and can be extracted from an <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> of class ‘<code>datacggm</code>’ by using the functions ‘<code>ColMeans</code>’ and ‘<code>ColVars</code>’, respectively.
</p>


<h3>Value</h3>

<p>A named list is silently returned. Each element of the list contains a two-columns matrix; first columns (named ‘<code>x</code>’) contains the theoretical quantiles whereas second columns (named ‘<code>y</code>’) contains the empirical quantiles.
</p>


<h3>Author(s)</h3>

<p>Gianluca Sottile (<a href="mailto:gianluca.sottile@unipa.it">gianluca.sottile@unipa.it</a>)</p>


<h3>References</h3>

<p>Augugliaro L., Sottile G., Wit E.C., and Vinciotti V. (2023) &lt;<a href="https://doi.org/10.18637/jss.v105.i01">doi:10.18637/jss.v105.i01</a>&gt;.
cglasso: An R Package for Conditional Graphical Lasso Inference with Censored and Missing Values.
<em>Journal of Statistical Software</em> <b>105</b>(1), 1–58.
</p>
<p>Augugliaro, L., Sottile, G., and Vinciotti, V. (2020) &lt;<a href="https://doi.org/10.1007/s11222-020-09945-7">doi:10.1007/s11222-020-09945-7</a>&gt;.
The conditional censored graphical lasso estimator.
<em>Statistics and Computing</em> <b>30</b>, 1273–1289.
</p>
<p>Augugliaro, L., Abbruzzo, A., and Vinciotti, V. (2020) &lt;<a href="https://doi.org/10.1093/biostatistics/kxy043">doi:10.1093/biostatistics/kxy043</a>&gt;.
<code class="reqn">\ell_1</code>-Penalized censored Gaussian graphical model.
<em>Biostatistics</em> <b>21</b>, e1–e16.
</p>


<h3>See Also</h3>

<p><code>datacggm</code>, <code>rcggm</code>, <code>ColMeans</code>, <code>ColVars</code> and <code>hist.datacggm</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(123)

# a dataset from a right-censored Gaussian graphical model
n &lt;- 1000L
p &lt;- 10L
Y &lt;- matrix(rnorm(n * p), n, p)
up &lt;- 1
Y[Y &gt;= up] &lt;- up
Z &lt;- datacggm(Y = Y, up = up)
qqcnorm(Z, max.plot = 4L)

# a dataset from a  conditional censored Gaussian graphical model
n &lt;- 1000L
p &lt;- 10L
q &lt;- 2
Y &lt;- matrix(rnorm(n * p), n, p)
up &lt;- 1
lo &lt;- -1
Y[Y &gt;= up] &lt;- up
Y[Y &lt;= lo] &lt;- lo
X &lt;- matrix(rnorm(n * q), n, q)
Z &lt;- datacggm(Y = Y, lo = lo, up = up, X = X)
qqcnorm(Z, max.plot = 4L)
</code></pre>


</div>