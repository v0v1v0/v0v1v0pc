<div class="container">

<table style="width: 100%;"><tr>
<td>groupFit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>groupFit</h2>

<h3>Description</h3>

<p>Fits grouped continuous data or discrete data to a distribution and computes Cramer-Von Mises Goodness of Fit statistics and p-values.
</p>


<h3>Usage</h3>

<pre><code class="language-R">groupFit(breaks, counts, data, discrete, distr, N, params, initials,
  pfixed, bootstrap = FALSE, numLoops = 5000, known = FALSE,
  pave = FALSE, imhof = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>
<p>Vector defining the breaks in each group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>counts</code></td>
<td>
<p>Vector containing the frequency of counts in each group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Vector containing values of discrete random variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>discrete</code></td>
<td>
<p>Logical. Is the distribution discrete?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distr</code></td>
<td>
<p>Character; the name of the distribution users want to fit the data to.
</p>
<p>Included continuous distributions are: "exp", "gamma", "lnorm", "norm", "unif" and "weibull".
</p>
<p>Included discrete distributions are: "binom" and "pois".
</p>
<p>User defined distributions are supported as "user".
</p>
<p>Short-hand or full spelling of these distributions will be recognized, case insensitive.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Number of trials, used only for the binomial distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>
<p>Vector of distribution parameters. This is only required when known == TRUE. groupFit will estimate the parameters if known == FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initials</code></td>
<td>
<p>Vector of distribution parameters to use as starting points for calculating MLEs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pfixed</code></td>
<td>
<p>Vector of known probabilities for corresponding counts vector. pfixed must be provided when distr = "user".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bootstrap</code></td>
<td>
<p>Logical. Should p-values be calculated via bootstrapping?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numLoops</code></td>
<td>
<p>Number of Bootstrap iterations. Set to be 5000 by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>known</code></td>
<td>
<p>Logical. Set to be TRUE if the parameters are known and do not need to be estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pave</code></td>
<td>
<p>Logical. Set to be FALSE if the probabilities in groups are used; set to TRUE if the average of probabilities of groups j and j + 1 are used. See page 2 of Spinelli (2001) for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>imhof</code></td>
<td>
<p>Logical. Set to be TRUE if Imhof's method from the package "CompQuadForm" is used to approximate the null distributions.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For grouped continuous data: call groupFit with arguments breaks, counts, and distr to fit the data.
</p>
<p>For discrete data call groupFit with data and distr to fit the data. If distr = "binom", then be sure to call groupFit with N as well.
</p>
<p>Provide initials to suggest starting points for parameter estimation.
</p>
<p>Provide params and set known = TRUE to test goodness of fit when parameters are known.
</p>
<p>Set bootstrap = TRUE to use bootstrapping to estimate p-values rather than using asymptotic distributions.
</p>
<p>Set imhof = FALSE when <code class="reqn">a+bX^2_p</code> is used to approximate the null distributions. See page 5 of Spinelli (2001) for details.
</p>
<p>groupFit can test the fit of user defined discrete distributions. To do so, set distr to "user", and provide the vector pfixed, where each cell contains the probability corresponding to that same cell in counts.
</p>


<h3>Value</h3>

<p>List containing the components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>estimates</code></td>
<td>
<p>The estimated parameters of the distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stats</code></td>
<td>
<p>Data frame containing the goodness of fit statistics</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvals</code></td>
<td>
<p>Data frame containing p-values for the goodness of fit statistics</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Shaun Zheng Sun and Dillon Duncan
</p>


<h3>References</h3>

<p>V. Choulakian, R. A. Lockhart &amp; M. A. Stephens (1994). Cramer-vonMises statistics for discrete distributions.
The Canadian Journal of Statistics,2 2,125-137.
</p>
<p>J.J.Spinelli (2001). Testing fit for the grouped exponential distribution.
The Canadian Journal of Statistics,29,451-458.
</p>
<p>J.J. Spinelli (1994). Cramer-vonMises statistics for discrete distributions.
Phd thesis. Simon Fraser University, Burnaby, Canada.
</p>
<p>S. Z. Sun, J.J. Spinelli &amp; M. A. Stephens (2012).  Testing fit for the grouped gamma and weibull distributions.
Technical report. Simon Fraser University, Burnaby, Canada.
</p>


<h3>See Also</h3>

<p><code>distrFit</code>: Parameter estimation function
</p>


<h3>Examples</h3>

<pre><code class="language-R">
#Poisson Example (Spinelli 1994) p36

counts &lt;- c(9, 22, 6, 2, 1, 0, 0, 0, 0)
vals &lt;- 0:8
data &lt;- rep(vals, counts)

groupFit(data = data, distr = "pois")


# When the parameters are unknown
#(Spinelli 1994) p56

counts &lt;- c(57, 203, 383, 525, 532, 408, 273, 139, 45, 27, 10, 4, 0, 1, 1)
vals &lt;- 0:14
data &lt;- rep(vals, counts)

(pois_fit &lt;- groupFit(data = data, distr = "pois"))

#Binomial example when the parameter is unknown
#Spinelli (1994) P92.
N=12
counts= c(185, 1149, 3265, 5475, 6114, 5194,
          3067, 1331, 403, 105, 14, 4, 0)
vals &lt;- 0:12
data &lt;- rep(vals, counts)

(binom_fit &lt;- groupFit(data = data, N = N, distr = "binom"))

#When the parameter is assumed known and is equal to 1/3

(binom_fit &lt;- groupFit(data = data, N = N, distr = "binom", params = 1/3, known = TRUE))

#uniform example (Choulakian, Lockhart and Stephens(1994) Example 2, p8)

counts &lt;- c(10, 19, 18, 15, 11, 13, 7, 10, 13, 23, 15, 22)

(uni_fit &lt;- groupFit(0:12, counts, distr = "unif"))


#uniform example (Choulakian, Lockhart and Stephens(1994) Example 3, p8)
counts &lt;- c(1, 4, 11, 4, 0)
probability &lt;- c(0.05, 0.3, 0.3, 0.3, 0.05)
breaks &lt;- c(0, cumsum(probability))

#with bootstrapping
(uni_fit1 &lt;- groupFit(breaks, counts, distr = "unif", bootstrap = TRUE, numLoops = 500))

#without bootstrapping
(uni_fit2 &lt;- groupFit(breaks, counts, distr = "unif", bootstrap = FALSE))

#exponential example (Spinelli 2001)

breaks &lt;- c(0, 2, 6, 10, 14, 18, 22, 26)
counts &lt;- c(21, 9, 5, 2, 1, 1, 0)

(exp_fit &lt;- groupFit(breaks, counts, distr = "exp", pave = TRUE))


#Example Sun, Stephens &amp; Spinelli (2012) set 2.
breaks &lt;- c(0, 2, 6, 10, 14, 18, 22, 26)
counts &lt;- c(21, 9, 5, 2, 1, 1, 0)
breaks[1] &lt;- 1e-6
breaks[8] &lt;- Inf

(weibull_fit &lt;- groupFit(breaks, counts, distr = "Weibull"))


#Example Sun, Stephens &amp; Spinelli (2012) set 3.

breaks &lt;- c(0, seq(0.5, 6.5, 1) )
counts &lt;- c(32, 12, 3, 6, 0, 0, 1)
breaks[1] &lt;- 1e-6
breaks[8] &lt;- Inf

(weibull_fit &lt;- groupFit(breaks, counts, distr = "Weibull"))


#Example Sun, Stephens &amp; Spinelli (2012) set 3.
breaks &lt;- c(0, 2, 6, 10, 14, 18, 22, 26)
counts &lt;- c(21, 9, 5, 2, 1, 1, 0)
breaks[1] &lt;- 1e-6
breaks[8] &lt;- Inf

(gamma_fit &lt;- groupFit(breaks, counts, distr = "exp"))


#Example Sun, Stephens &amp; Spinelli (2012) set 3.
breaks &lt;- c(0, seq(0.5, 6.5, 1) )
counts &lt;- c(32, 12, 3, 6, 0, 0, 1)
breaks[1] &lt;- 1e-6
breaks[8] &lt;- Inf

(gamma_fit &lt;- groupFit(breaks, counts, distr = "gamma"))


#More examples

breaks &lt;- c(0, seq(0.5, 6.5, 1) )
counts &lt;- table(cut(rgamma(100, 3, 1/3), breaks))
breaks[8] &lt;- Inf

#setting pave to true
(exp_fit &lt;- groupFit(breaks, counts, distr = "exp", initials = 0.2, pave = TRUE))

#Setting known to true, with params
(gamma_fit &lt;- groupFit(breaks, counts, distr = "gamma",
                      params = c(3, 1/3), known = TRUE))

#with bootstrapping, specifying the number of loops.
(lnorm_fit &lt;- groupFit(breaks, counts, distr = "lnorm",
                      bootstrap = TRUE, numLoops = 1000))

#fitting with both pave and imhof set to false
#by setting imhof to false, we use a+bX^2_p to approximate
#the distribution of the goodness-of-fit Statistics
(weibull_fit &lt;- groupFit(breaks, counts, distr = "weibull",
                        pave = TRUE, imhof = FALSE))

#Using the user defined distribution to test for Benford's law

#genomic data, Lesperance et al (2016)

genomic &lt;- c(48, 14, 12, 6, 18, 5, 7, 8, 9)
phat &lt;- log10(1+1/1:9)

(fit &lt;- groupFit(counts = genomic, distr = "user", pfixed = phat, imhof = FALSE, pave = TRUE))

</code></pre>


</div>