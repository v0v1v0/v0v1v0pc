<div class="container">

<table style="width: 100%;"><tr>
<td>covaprop-class</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Class "covaprop"</h2>

<h3>Description</h3>

<p>A function for testing some properties (symmetry, separability, type of
non-separability) of spatio-temporal covariance functions and some classes
of space-time covariance models
<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script></p>


<h3>Usage</h3>

<pre><code class="language-R">covaprop(cblock, cstat, nonseptype = NULL, sign.level = 0.05)

## S4 method for signature 'covaprop'
show(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cblock</code></td>
<td>
<p>object of class <code>covablocks</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cstat</code></td>
<td>
<p>object of class <code>covastat</code> or <code>covastatM</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nonseptype</code></td>
<td>
<p>integer, this argumet is required only for objects
(<code>cblock</code> and <code>cstat</code>) defined to perform the type of non
separability test, otherwise it has to be set equal to <code>NULL</code> (default choice).
Set <code>nonseptype=0</code> for testing the null hypothesis that the non
separability is non positive; set <code>nonseptype=1</code> for testing the null
hypothesis that the non separability is non negative</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sign.level</code></td>
<td>
<p>numeric, level of significance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>object of class <code>covaprop</code> for method <code>show</code></p>
</td>
</tr>
</table>
<h3>Details</h3>



<ul>
<li>
<p> A message helps to decide for either reject the null hypothesis in favor of
the alternative or not reject it, at a specific level of significance
</p>
</li>
<li>
<p> The test on full symmetry (when the slot <code>@typetest</code> is
equal to <code>"sym"</code>) represents the first step
for the selection of a suitable class of spatio-temporal covariance functions.
According to the definition of full symmetry, the null hypothesis to be
tested is \[H_0: C(\mathbf{h},u) - C(\mathbf{h},-u)=0\]
</p>
</li>
<li>
<p> The test of separability (when the slot <code>@typetest</code> is
equal to <code>"sep"</code>) represents the second
step of the testing procedure. According to the definition of separability,
the null hypothesis to be tested is
\[H_0: C(\mathbf{h}, u)/C(\mathbf{h}, 0) - C(\mathbf{0}, u)/C(\mathbf{0},0)=0\]
</p>
</li>
<li>
<p> The test on the type of non separability (when the slot
<code>@typetest</code> is equal to <code>"tnSep"</code>)
represents the third step for the selection of a suitable class of space-time
covariance functions.
According to the definition of type of non separability, the null hypothesis
to be tested is that the non separability is non negative
\[H_0: C(\mathbf{h},u)/C(\mathbf{h},0) - C(\mathbf{0},u)/C(\mathbf{0},0) &gt; 0\]
or
\[H_0: C(\mathbf{h},u)/C(\mathbf{h},0) - C(\mathbf{0},u)/C(\mathbf{0},0) &lt; 0\]
if the null hypothesis to test is that the non separability is non positive
</p>
</li>
<li>
<p> If the slot <code>@typetest</code> is equal to <code>"productSum"</code>
<code>"intProduct"</code> or <code>"gneiting"</code>, the goodness of a specific class of
space-time covariance function will be tested. For this testing procedure
the generic null hypothesis is: \[H_0: \mathbf{Af(G)}=0\]
</p>
</li>
</ul>
<p>For the analytic expression of each test statistic and its probability
distribution see Cappello et al. (2018). In the same contribution the
different <code>f(G)</code> are given for each test to be computed.

</p>


<h3>Slots</h3>


<dl>
<dt><code>test.statistics</code></dt>
<dd>
<p>numeric, the value of the test statistic</p>
</dd>
<dt><code>p.value</code></dt>
<dd>
<p>numeric, the lower tail p value of the test statistic</p>
</dd>
<dt><code>df</code></dt>
<dd>
<p>numeric, the degrees of freedom, if available</p>
</dd>
<dt><code>typetest</code></dt>
<dd>
<p>character, contains the code of the test to be performed</p>
</dd>
</dl>
<h3>Note</h3>



<ul>
<li>
<p> A stop occurs if the type of test set in <code>cblock</code> is not consistent
with the type of test set in <code>cstat</code>.
</p>
</li>
<li>
<p> If the message <code>Error in solve.default(): system is computationally singular:...</code>
appears, the inverse of the matrix involved in the test statistic
in (9) of Cappello et al. (2020) is computationally singular.
In order to overcome this numerical problem often related to the tests on the
models, the object <code>stpairs</code> (of class
<code>couples</code>) has to be modified. In particular, by considering that for each spatial
triplet and each temporal triplet 6 contrasts can be defined, it is advisable
to adopt one of the following options: 1) set equal to zero one of the
highest temporal lags, for each spatial and each temporal triplet, through the
specific <code>setzero</code> method, 2) substitute triplets associated with long spatial
or temporal distances with others characterized by lower distances.
Then, the user has to run again <code>blocks</code>, <code>covablocks</code>,
<code>covastatM</code> and <code>covaprop</code>.
The above error message also occurs if there are at least two spatial triplets, where:
</p>

<ul>
<li>
<p> two couples are replicated;
</p>
</li>
<li>
<p> one couple is replicated.
</p>
</li>
</ul>
<p>In such cases it is enough to set equal to zero one temporal lag for each temporal
triplet associated to the couples involved in the replications.
</p>
</li>
</ul>
<h3>References</h3>

<p>Cappello, C., De Iaco, S., Posa, D., 2018, Testing the type of
non-separability and some classes of space-time covariance function models.
Stochastic Environmental Research and Risk Assessment,
<b>32</b> 17–35
</p>
<p>Cappello, C., De Iaco, S., Posa, D., 2020, covatest: An R Package for
Selecting a Class of Space-Time Covariance Functions.
Journal of Statistical Software, <b>94(1)</b> 1–42.
</p>
<p>De Iaco, S., Palma, M., Posa, D., 2016. A general procedure for selecting a
class of fully symmetric space-time covariance functions.
Environmentrics, <b>27(4)</b> 212–224.
</p>
<p>Li, B., Genton, M.G., Sherman, M., 2007, A nonparametric assessment
of properties of spacetime covariance functions.
Journal of the American Statistical Association, <b>102</b> 736–744.
</p>


<h3>See Also</h3>

<p>couples
</p>
<p>blocks
</p>
<p>covablocks
</p>
<p>covastat
</p>


<h3>Examples</h3>

<pre><code class="language-R"># --start define the STFDF rr_13-- #
library(sp)
library(spacetime)
#library(gstat)
data(air)
ls()
if (!exists("rural")) rural = STFDF(stations, dates, data.frame(PM10 =
as.vector(air)))
rr = rural[,"2005::2010"]
unsel = which(apply(as(rr, "xts"), 2, function(x) all(is.na(x))))
r5to10 = rr[-unsel,]
rr_13 &lt;- r5to10[c("DEHE046","DESN049","DETH026","DENW063","DETH061","DEBY047",
"DENW065","DEUB029","DENW068","DENI019","DEHE051","DERP016","DENI051"),
"2005::2006"]
# --end define the STFDF rr_13-- #

#--Example 1: test on symmetry--#

sel.staz.sym &lt;- c("DERP016", "DENW065", "DEHE051", "DETH026", "DENW063", "DENI019",
"DENW068", "DEHE046", "DEUB029", "DEBY047", "DETH061", "DESN049")

sp.couples.in.sym &lt;- matrix(data = c("DERP016", "DENW065", "DEHE051", "DETH026",
"DENW063", "DENI019", "DENW068", "DEHE046", "DEUB029", "DEBY047", "DETH061", "DESN049"),
ncol = 2, byrow = TRUE)

t.couples.in.sym &lt;- c(1, 2)

couples.sym &lt;- couples(sel.staz = sel.staz.sym, sp.couples.in = sp.couples.in.sym,
t.couples.in = t.couples.in.sym, typetest = "sym", typecode = character())

block.sym &lt;- blocks(lb = 40, ls = 10, matdata = rr_13, pardata1 = 1, pardata2 = 1,
stpairs = couples.sym)

covabl.sym &lt;- covablocks(stblocks = block.sym, stpairs = couples.sym, typetest = "sym")

covast.sym &lt;- covastat(matdata = rr_13, pardata1 = 1, pardata2 = 1,
stpairs = couples.sym, typetest = "sym")

test.sym &lt;- covaprop(cblock = covabl.sym, cstat = covast.sym, nonseptype = NULL,
sign.level = 0.05)

#--Example 2: test on the Gneiting model--#
sel.staz.mod &lt;- c("DETH061", "DEBY047", "DEHE051", "DEUB029", "DENI019",
"DENI051", "DETH026", "DESN049")

sp.couples.in.mod &lt;- matrix(data = c("DETH061", "DEBY047",
                                    "DEHE051", "DEUB029",
                                    "DENI019", "DENI051",
                                    "DEHE051", "DETH026",
                                    "DEBY047", "DESN049",
                                    "DETH026", "DETH061"),
                           ncol = 2, byrow = TRUE)
                           t.couples.in.mod &lt;- c(1, 2, 3)

couples.mod &lt;- couples(sel.staz = sel.staz.mod,
sp.couples.in = sp.couples.in.mod, t.couples.in = t.couples.in.mod,
typetest = "gneiting", typecode = character())

zero.index &lt;- matrix(data = c(3, 7, 6, 7), ncol = 2, byrow = TRUE)

couples.mod &lt;- setzero(x = couples.mod, zero = FALSE, index = zero.index, value = 0)

block.mod &lt;- blocks(lb = 60, ls = 10, matdata = rr_13, pardata1 = 1,
pardata2 = 1, stpairs = couples.mod)

covabl.gn &lt;- covablocks(stblocks = block.mod, stpairs = couples.mod,
typetest = "gneiting")

covast.gn &lt;- covastatM(matdata = rr_13, pardata1 = 1, pardata2 = 1,
stpairs = couples.mod, typetest = "gneiting", beta.data = seq(0.5, 1, by=0.1))

test.gn &lt;- covaprop(cblock = covabl.gn, cstat = covast.gn, nonseptype = NULL,
sign.level = 0.05)

### method for covaprop
#1. show
test.sym

</code></pre>


</div>