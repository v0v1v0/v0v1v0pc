<div class="container">

<table style="width: 100%;"><tr>
<td>plot_metrics</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot chemical metrics of community reference proteomes</h2>

<h3>Description</h3>

<p>Functions to plot chemical metrics of community reference proteomes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  plot_metrics(mdat,
    xvar = "Zc", yvar = "nH2O",
    xlim = NULL, ylim = NULL,
    xlab = chemlab(xvar), ylab = chemlab(yvar),
    plot.it = TRUE, add = FALSE, identify = FALSE,
    points = TRUE, lines = FALSE, title = TRUE,
    cex = 1, pt.open.col = 1, pch1 = 1, pch2 = 21,
    return = "data", extracolumn = NULL
  )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mdat</code></td>
<td>
<p>list, output by <code>get_metadata</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xvar</code></td>
<td>
<p>character, name of x variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yvar</code></td>
<td>
<p>character, name of y variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>numeric, x axis limits</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>numeric, y axis limits</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>x axis label</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>y axis label</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.it</code></td>
<td>
<p>logical, make a plot?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>logical, add to existing plot?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>identify</code></td>
<td>
<p>logical, run <code>identify</code> for interactive identification of points?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>points</code></td>
<td>
<p>logical, plot points?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lines</code></td>
<td>
<p>logical, plot lines?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>character, plot title</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p>numeric, point size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pt.open.col</code></td>
<td>
<p>color of border for open point symbols (<code>pch &gt; 20</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch1</code></td>
<td>
<p>numeric, symbol for samples in group 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch2</code></td>
<td>
<p>numeric, symbol for samples in group 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return</code></td>
<td>
<p>character, indicates whether to return ‘<span class="samp">⁠data⁠</span>’ values or group ‘<span class="samp">⁠means⁠</span>’</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extracolumn</code></td>
<td>
<p>character, the name of one or more extra columns (from <code>get_metadata</code>) to include in the output</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>plot_metrics</code> plots the values of <i>Z</i><sub>C</sub> and <i>n</i><sub>H<sub>2</sub>O</sub> (or other variables indicated by <code>xvar</code> and <code>yvar</code>) provided in <code>mdat$metrics</code>.
Symbol shape and color (<code>pch</code> and <code>col</code>) are taken from <code>mdat$metadata</code>.
</p>
<p>If <code>pch1</code> and <code>pch2</code> are provided, then samples are classified into two groups according to the value of <code>mdat$metadata$pch</code>.
Mean values of the chemical metrics for each group are plotted with star-shaped symbols.
</p>


<h3>Value</h3>

<p>For <code>plot_metrics</code>, a data frame with columns for study name and Run IDs (‘<span class="samp">⁠name⁠</span>’, ‘<span class="samp">⁠Run⁠</span>’), chemical metrics (taken from <code>mdat$metrics</code>), and symbols and colors for plotting points (‘<span class="samp">⁠pch⁠</span>’, ‘<span class="samp">⁠col⁠</span>’).
</p>


<h3>References</h3>

<p>Herlemann, D. P. R., Lundin, D., Andersson, A. F., Labrenz, M. and Jürgens, K. (2016) Phylogenetic signals of salinity and season in bacterial community composition across the salinity gradient of the Baltic Sea. <em>Front. Microbiol.</em> <b>7</b>, 1883. <a href="https://doi.org/10.3389/fmicb.2016.01883">doi:10.3389/fmicb.2016.01883</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Make a plot for the Baltic Sea salinity gradient
# (data from Herlemann et al., 2016)
RDPfile &lt;- system.file("extdata/RDP/HLA+16.tab.xz", package = "chem16S")
RDP &lt;- read_RDP(RDPfile)
map &lt;- map_taxa(RDP, refdb = "RefSeq_206")
metrics &lt;- get_metrics(RDP, map, refdb = "RefSeq_206")
mdatfile &lt;- system.file("extdata/metadata/HLA+16.csv", package = "chem16S")
mdat &lt;- get_metadata(mdatfile, metrics)
pm &lt;- plot_metrics(mdat)
# Add a legend
legend &lt;- c("&lt; 6 PSU", "6-20 PSU", "&gt; 20 PSU")
pch &lt;- c(24, 20, 21)
pt.bg &lt;- c(3, NA, 4)
legend("bottomright", legend, pch = pch, col = 1, pt.bg = pt.bg, bg = "white")
# Classify samples with low and high salinity
ilo &lt;- mdat$metadata$salinity &lt; 6
ihi &lt;- mdat$metadata$salinity &gt; 20
# Add convex hulls
canprot::add_hull(pm$Zc[ilo], pm$nH2O[ilo],
  col = adjustcolor("green3", alpha.f = 0.3), border = NA)
canprot::add_hull(pm$Zc[ihi], pm$nH2O[ihi],
  col = adjustcolor("blue", alpha.f = 0.3), border = NA)

# Show points for all samples and larger star-shaped points
# for mean values of high- and low-salinity samples
plot_metrics(mdat, pch1 = 21, pch2 = 24)

# Plot nO2 instead of Zc
plot_metrics(mdat, xvar = "nO2")

# Make a plot for only Proteobacteria
RDP &lt;- read_RDP(RDPfile, lineage = "Proteobacteria")
map &lt;- map_taxa(RDP, refdb = "RefSeq_206")
metrics &lt;- get_metrics(RDP, map, refdb = "RefSeq_206")
mdatfile &lt;- system.file("extdata/metadata/HLA+16.csv", package = "chem16S")
mdat &lt;- get_metadata(mdatfile, metrics)
mdat$metadata$name &lt;- paste(mdat$metadata$name, "(Proteobacteria)")
plot_metrics(mdat)
</code></pre>


</div>