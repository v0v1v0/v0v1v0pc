<div class="container">

<table style="width: 100%;"><tr>
<td>structure_gauss</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Structure of gaussian atoms</h2>

<h3>Description</h3>

<p>Structure formed by all gaussian atoms in the unit cell. Positions, 
atomic numbers and thermal factors are given by vectors of a same 
length. Each atom forming the structure is also characterised by a given 
occupancy (between 0 and 1).
</p>


<h3>Usage</h3>

<pre><code class="language-R">structure_gauss(sdata, x = NULL, N = NULL, k = ksigma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sdata</code></td>
<td>
<p>A named list, normally obtained through the use of
function <code>read_x</code> or <code>standardise_sdata</code>. 
The list names correspond to  different object types:
</p>

<ul>
<li>
<p>a.     Real numeric. The size of the unit cell.
</p>
</li>
<li>
<p>SG.    Character string. Space group symbol; either "P1" 
or "P-1"
</p>
</li>
<li>
<p>x0.    Vector of real numerics indicating the expanded atomic
positions in the unit cell.
</p>
</li>
<li>
<p>Z.     Vector of integers indicating the expanded 
atomic numbers for all atoms in the unit cell.
</p>
</li>
<li>
<p>B.    Vector of real numerics indicating the expanded 
B factors for all atoms in the unit cell.
</p>
</li>
<li>
<p>occ.  Vector of real numerics indicating the expanded 
occupancies for all atoms in the unit cell.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Point in the 1D cell at which this function is calculated.
Default is NULL, in which case a grid is set up internally.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Integer. Number of points in the regular grid, if the grid
is not provided directly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>A real number. It controls the standard deviation of the 
gaussian function describing the atom and, thus, the shape of the
associated peak. The standard deviation sigma is given by:
<code>sigma = k * sqrt(Z)</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A named list of length 2: x is the grid (either input by
user or set up internally), rr is a vector of length equal to the 
length of vector x, with values equal to the evaluated gaussian atoms.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Cell, atom types, positions and B factors
a &lt;- 10
SG &lt;- "P1"
x0 &lt;- c(2,5,7)
Z &lt;- c(6,16,8)
B &lt;- c(0,0,0)

# All occupancies to 1
occ &lt;- c(1,1,1)

# Standard data format
sdata &lt;- standardise_sdata(a,SG,x0,Z,B,occ)

# Grid for unit cell
x &lt;- seq(0,a,length=1000)

# Structure density
rtmp &lt;- structure_gauss(sdata,x)
plot(rtmp$x,rtmp$rr,type="l",xlab="x",ylab=expression(rho))

# Now reduce occupancy of sulphur
occ[2] &lt;- 0.5
sdata &lt;- standardise_sdata(a,SG,x0,Z,B,occ)
rtmp &lt;- structure_gauss(sdata,x)
points(rtmp$x,rtmp$rr,type="l",col=2)

# Increase temperature of oxygen
B[3] &lt;- 10
sdata &lt;- standardise_sdata(a,SG,x0,Z,B,occ)
rtmp &lt;- structure_gauss(sdata,x)
points(rtmp$x,rtmp$rr,type="l",col=3)

</code></pre>


</div>