<div class="container">

<table style="width: 100%;"><tr>
<td>pcm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Projected covariance measure test for conditional mean independence</h2>

<h3>Description</h3>

<p>Projected covariance measure test for conditional mean independence
</p>


<h3>Usage</h3>

<pre><code class="language-R">pcm(
  Y,
  X,
  Z,
  rep = 1,
  est_vhat = TRUE,
  reg_YonXZ = "rf",
  reg_YonZ = "rf",
  reg_YhatonZ = "rf",
  reg_VonXZ = "rf",
  reg_RonZ = "rf",
  args_YonXZ = NULL,
  args_YonZ = NULL,
  args_YhatonZ = list(mtry = identity),
  args_VonXZ = list(mtry = identity),
  args_RonZ = list(mtry = identity),
  frac = 0.5,
  indices = NULL,
  coin = FALSE,
  cointrol = NULL,
  return_fitted_models = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Vector of response values. Can be supplied as a numeric vector or
a single column matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Matrix or data.frame of covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>Matrix or data.frame of covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rep</code></td>
<td>
<p>Number of repetitions with which to repeat the PCM test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est_vhat</code></td>
<td>
<p>Logical; whether to estimate the variance functional</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reg_YonXZ</code></td>
<td>
<p>Character string or function specifying the regression
for Y on X and Z, default is <code>"rf"</code> for random forest.
See <code>?regressions</code> for more detail.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reg_YonZ</code></td>
<td>
<p>Character string or function specifying the regression
for Y on Z, default is <code>"rf"</code> for random forest.
See <code>?regressions</code> for more detail.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reg_YhatonZ</code></td>
<td>
<p>Character string or function specifying the regression
for the predicted values of <code>reg_YonXZ</code> on Z, default is <code>"rf"</code>
for random forest.
See <code>?regressions</code> for more detail.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reg_VonXZ</code></td>
<td>
<p>Character string or function specifying the regression
for estimating the conditional variance of Y given X and Z, default
is <code>"rf"</code> for random forest.
See <code>?regressions</code> for more detail.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reg_RonZ</code></td>
<td>
<p>Character string or function specifying the regression
for the estimated transformation of Y, X, and Z on Z, default is
<code>"rf"</code> for random forest.
See <code>?regressions</code> for more detail.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args_YonXZ</code></td>
<td>
<p>A list of named arguments passed to <code>reg_YonXZ</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args_YonZ</code></td>
<td>
<p>A list of named arguments passed to <code>reg_YonZ</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args_YhatonZ</code></td>
<td>
<p>A list of named arguments passed to <code>reg_YhatonZ</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args_VonXZ</code></td>
<td>
<p>A list of named arguments passed to <code>reg_VonXZ</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args_RonZ</code></td>
<td>
<p>A list of named arguments passed to <code>reg_RonZ</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frac</code></td>
<td>
<p>Relative size of train split.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indices</code></td>
<td>
<p>A numeric vector of indices specifying the observations used
for estimating the estimating the direction (the other observations will
be used for computing the final test statistic). Default is <code>NULL</code>
and the indices will be generated randomly using <code>frac</code>.
When using <code>rep</code> larger than 1, a list (of length <code>rep</code>) of
indices can be supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coin</code></td>
<td>
<p>Logical; whether or not to use the <code>coin</code> package for
computing the test statistic and p-value. The <code>coin</code> package
computes variances with n - 1 degrees of freedom.
The default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cointrol</code></td>
<td>
<p>List; further arguments passed to
<code>independence_test</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_fitted_models</code></td>
<td>
<p>Logical; whether to return the fitted regressions
(default is <code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments currently ignored.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The projected covariance measure test tests whether the conditional
mean of Y given X and Z is independent of X.
</p>


<h3>Value</h3>

<p>Object of class '<code>pcm</code>' and '<code>htest</code>' with the following
components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>The value of the test statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>The p-value for the <code>hypothesis</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameter</code></td>
<td>
<p>In case X is multidimensional, this is the degrees of
freedom used for the chi-squared test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hypothesis</code></td>
<td>
<p>Null hypothesis of conditional mean independence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null.value</code></td>
<td>
<p>Null hypothesis of conditional mean independence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The string <code>"Projected covariance measure test"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p>A character string giving the name(s) of the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check.data</code></td>
<td>
<p>A <code>data.frame</code> containing the residuals for plotting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>models</code></td>
<td>
<p>List of fitted regressions if <code>return_fitted_models</code> is <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Lundborg, A. R., Kim, I., Shah, R. D., &amp; Samworth, R. J. (2022). The
Projected Covariance Measure for assumption-lean variable significance
testing. arXiv preprint. <a href="https://doi.org/10.48550/arXiv.2211.02039">doi:10.48550/arXiv.2211.02039</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">n &lt;- 1e2
X &lt;- matrix(rnorm(2 * n), ncol = 2)
colnames(X) &lt;- c("X1", "X2")
Z &lt;- matrix(rnorm(2 * n), ncol = 2)
colnames(Z) &lt;- c("Z1", "Z2")
Y &lt;- X[, 2]^2 + Z[, 2] + rnorm(n)
(pcm1 &lt;- pcm(Y, X, Z))

</code></pre>


</div>