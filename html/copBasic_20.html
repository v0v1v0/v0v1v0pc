<div class="container">

<table style="width: 100%;"><tr>
<td>tauCOP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The Kendall Tau and Concordance Function of a Copula</h2>

<h3>Description</h3>

<p>Compute the measure of association known as the <em>Kendall Tau</em> (<code class="reqn">\tau_\mathbf{C}</code>) of a copula (<code class="reqn">\tau_\mathbf{C}</code>) according to Nelsen (2006, sec. 5.1.1 and p. 161) by
</p>
<p style="text-align: center;"><code class="reqn">\tau_\mathbf{C} = \mathcal{Q}(\mathbf{C}, \mathbf{C}) = 4\int\!\!\int_{\mathcal{I}^2}
                         \mathbf{C}(u,v)\,\mathrm{d}\mathbf{C}(u,v) - 1\mbox{,}</code>
</p>

<p>where <code class="reqn">\mathcal{Q}(\mathbf{C}, \mathbf{C})</code> is a <em>concordance function</em> (<code>concordCOP</code>) of a copula with itself. Nelsen (2006, p. 164) reports however that this form is often not amenable to computation when there is a singular component to the copula and that the expression
</p>
<p style="text-align: center;"><code class="reqn">\tau_\mathbf{C} = 1 - 4\int\!\!\int_{\mathcal{I}^2}
                         \frac{\delta\mathbf{C}(u,v)}{\delta u}
                         \frac{\delta\mathbf{C}(u,v)}{\delta v}\,
                         \mathrm{d}u\mathrm{d}v</code>
</p>

<p>is to be preferred. Such an expression hence relies on the partial numerical derivatives of the copula provided by <code>derCOP</code> and <code>derCOP2</code>. The Nelsen (2006) preferred expression is used by the <code>tauCOP</code> function. Nelsen (2006, pp. 175–176) reports that the relation between <code class="reqn">\tau_\mathbf{C}</code> and <code class="reqn">\rho_\mathbf{C}</code> (<code>rhoCOP</code>) is
<code class="reqn">-1 \le 3\tau - 2\rho \le 1</code> (see <code>rhoCOP</code> for more details).
</p>
<p>Nelsen (2006, pp. 160–161) lists some special identities involving <code class="reqn">\mathcal{Q}(\mathbf{C}_1,\mathbf{C}_2)</code>:
</p>
<p style="text-align: center;"><code class="reqn">\mathcal{Q}(\mathbf{M}, \mathbf{M}) = 4\int_0^1 u\,\mathrm{d}u - 1 = 1\mbox{,}</code>
</p>

<p style="text-align: center;"><code class="reqn">\mathcal{Q}(\mathbf{M}, \mathbf{\Pi}) = 4\int_0^1 u^2\,\mathrm{d}u - 1 = 1/3\mbox{,}</code>
</p>

<p style="text-align: center;"><code class="reqn">\mathcal{Q}(\mathbf{M}, \mathbf{W}) = 4\int_{1/2}^1 (2u-1)\,\mathrm{d}u - 1 = 0\mbox{,}</code>
</p>

<p style="text-align: center;"><code class="reqn">\mathcal{Q}(\mathbf{W}, \mathbf{\Pi}) = 4\int_0^1 u(1-u)\,\mathrm{d}u - 1 = -1/3\mbox{,}</code>
</p>

<p style="text-align: center;"><code class="reqn">\mathcal{Q}(\mathbf{W}, \mathbf{W}) = 4\int_0^1 0\,\mathrm{d}u - 1 = -1\mbox{, and}</code>
</p>

<p style="text-align: center;"><code class="reqn">\mathcal{Q}(\mathbf{\Pi}, \mathbf{\Pi}) = 4\int\!\!\int_{\mathcal{I}^2} uv\,\mathrm{d}u\mathrm{d}v - 1 = 0\mbox{.}</code>
</p>

<p>Kendall Tau also can be expressed in terms of the <em>Kendall Function</em> (<code class="reqn">F_K(z)</code>; <code>kfuncCOP</code>):
</p>
<p style="text-align: center;"><code class="reqn">\tau_\mathbf{C} = 3 - 4\int_0^1 F_K(t)\,\mathrm{d}t\mbox{,}</code>
</p>

<p>which is readily verified by code shown in <b>Examples</b>. This definition might be useful if integration errors are encountered for some arbitrary copula and arbitrary parameter set. In fact, should two attempts (see source code) at dual integration of the partial derivatives occur, the implementation switches over to integration of the Kendall Function (<em>e.g.</em> <code>tauCOP(cop=N4212cop, para=2)</code>). Note, Durante and Sempi have erroneously dropped the multiplication by “<code class="reqn">4</code>” as shown above in their definition of <code class="reqn">\tau_\mathbf{C}</code> as a function of <code class="reqn">F_K(t)</code> (Durante and Sempi, 2015, eq. 3.9.4, p. 121).
</p>


<h3>Usage</h3>

<pre><code class="language-R">tauCOP( cop=NULL,  para=NULL,
       cop2=NULL, para2=NULL, as.sample=FALSE, brute=FALSE, delta=0.002, ...)

concordCOP(cop=NULL,  para=NULL, cop2=NULL, para2=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cop</code></td>
<td>
<p>A copula function;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>para</code></td>
<td>
<p>Vector of parameters or other data structure, if needed, to pass to the copula;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cop2</code></td>
<td>
<p>A second copula function;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>para2</code></td>
<td>
<p>Vector of parameters or other data structure, if needed, to pass to the second copula;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>as.sample</code></td>
<td>
<p>A logical controlling whether an optional <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> <code>data.frame</code> in <code>para</code> is used to compute the <code class="reqn">\hat\tau</code> by dispatch to <code>cor()</code> function in <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> with <code>method = "kendall"</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>brute</code></td>
<td>
<p>Should brute force be used instead of two nested <code>integrate()</code> functions in <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> to perform the double integration;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>The <code class="reqn">\mathrm{d}u</code> and <code class="reqn">\mathrm{d}v</code> for the brute force integration using <code>brute</code>; and</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to pass on to <code>derCOP</code> and <code>derCOP2</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The value for <code class="reqn">\tau_\mathbf{C}</code> is returned.
</p>


<h3>Note</h3>

<p>Although titled for computation of the Kendall Tau, the <code>tauCOP</code> function also is the implementation of the <em>concordance function</em> <code class="reqn">\mathcal{Q}(\mathbf{C}_1, \mathbf{C}_2)</code> (see Nelsen (2006, pp. 158–159) when given two different copulas and respective parameters as arguments. The function <code>concordCOP</code> just dispatches to <code>tauCOP</code>. A useful relation is
</p>
<p style="text-align: center;"><code class="reqn">\int\!\!\int_{\mathcal{I}^2} \mathbf{C}_1(u,v)\,\mathrm{d}\mathbf{C}_2(u,v) =
      \frac{1}{2} - \int\!\!\int_{\mathcal{I}^2} \frac{\delta}{\delta u}\mathbf{C}_1(u,v)\,\frac{\delta}{\delta v}\mathbf{C}_2(u,v)\,\mathrm{d}u\mathrm{d}v\mbox{,}</code>
</p>

<p>where <code class="reqn">\mathbf{C}_1(u,v)</code> is the first copula and <code class="reqn">\mathbf{C}_2(u,v)</code> is the second copula.
</p>
<p>Nelsen <em>et al.</em> (2001, p. 281) lists several measures of association defined by the concordance function:<br><code class="reqn">\mbox{}\quad\mathrm{1.}\quad\mbox{}</code><code class="reqn">\tau_\mathbf{C} = \quad\ \mathcal{Q}(\mathbf{C}, \mathbf{C})</code> : (Kendall Tau; <code>tauCOP</code>);<br><code class="reqn">\mbox{}\quad\mathrm{2.}\quad\mbox{}</code><code class="reqn">\rho_\mathbf{C} = 3\cdot\mathcal{Q}(\mathbf{C}, \mathbf{\Pi})</code> : (Spearman Rho; <code>rhoCOP</code>);<br><code class="reqn">\mbox{}\quad\mathrm{3.}\quad\mbox{}</code><code class="reqn">\gamma_\mathbf{C} = 2\cdot\mathcal{Q}(\mathbf{C}, [\mathbf{M}+\mathbf{W}]/2)</code> : (Gini Gamma; <code>giniCOP</code>); and<br><code class="reqn">\mbox{}\quad\mathrm{4.}\quad\mbox{}</code><code class="reqn">\psi_\mathbf{C} = \frac{3}{2}\cdot\mathcal{Q}(\mathbf{C}, \mathbf{M}) - \frac{1}{2}</code> : (Spearman Footrule; <code>footCOP</code>).
</p>


<h3>Author(s)</h3>

<p>W.H. Asquith</p>


<h3>References</h3>

<p>Durante, F., and Sempi, C., 2015, Principles of copula theory: Boca Raton, CRC Press, 315 p.
</p>
<p>Nelsen, R.B., 2006, An introduction to copulas: New York, Springer, 269 p.
</p>
<p>Nelsen, R.B., Quesada-Molina, J.J., Rodríguez-Lallena, J.A., and Úbeda-Flores, M., 2001, Distribution functions of copulas—A class of bivariate probability integral transforms: Statistics and Probability Letters, v. 54, no. 3, pp. 277–282.
</p>


<h3>See Also</h3>

<p><code>blomCOP</code>, <code>footCOP</code>, <code>giniCOP</code>,
<code>hoefCOP</code>, <code>rhoCOP</code>, <code>wolfCOP</code>,
<code>joeskewCOP</code>, <code>uvlmoms</code>,
<code>derCOP</code>, <code>derCOP2</code>, <code>kfuncCOP</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
tauCOP(cop=PSP) # 1/3
# Now compute Kendall Tau via integration of the Kendall Function.
# 3 - 4*integrate(function(t) kfuncCOP(t, cop=PSP), 0, 1)$value # 0.3333314
## End(Not run)

## Not run: 
tauCOP(cop=PSP, brute=TRUE) # 0.3306625
# CPU heavy example showing that the dual-integration (fast) results in
# a Kendall Tau that matches a sample version
dotau &lt;- function(n) {
   uv &lt;- simCOP(n=n, cop=PSP, ploton=FALSE, points=FALSE)
   return(cor(uv$U, uv$V, method="kendall"))
}
set.seed(817600)
taus &lt;- replicate(100, dotau(100))
tau.sample &lt;- mean(taus); print(tau.sample) # 0.3342034
## End(Not run)

## Not run: 
# Nelsen (2006, pp. 160-161, numeric results shown thereine)
# The rational values or integers may be derived analytically.
tauCOP(cop=M, cop2=M) #   1, correct
tauCOP(cop=M, cop2=P) # 1/3, correct
tauCOP(cop=P, cop2=M) # 1/3, correct
tauCOP(cop=M, cop2=W) #   0, correct
tauCOP(cop=W, cop2=M) # throws warning, swaps copulas, == tauCOP(M,W)
tauCOP(cop=W, cop2=P) # throws warning, swaps copulas, approx. -1/3
tauCOP(cop=P, cop2=W) # -1/3, correct
tauCOP(cop=P, cop2=P) #    0, correct
tauCOP(cop=M, cop2=W, brute=TRUE) #    0, correct
## End(Not run)

## Not run: 
para &lt;- list(cop1=PLACKETTcop,  cop2=PLACKETTcop,
             para1=0.00395, para2=4.67, alpha=0.9392, beta=0.5699)
tauCOP(cop=composite2COP, para=para) # -0.4671213

para &lt;- list(cop1=PLACKETTcop,  cop2=PLACKETTcop,
             para1=0.14147, para2=20.96, alpha=0.0411, beta=0.6873)
tauCOP(cop=composite2COP, para=para) # +0.1950727

para &lt;- list(cop1=PLACKETTcop,  cop2=PLACKETTcop,
             para1=0.10137, para2=4492.87, alpha=0.0063, beta=0.0167)
# Theoretical attempt fails because para2 is large and thus a singularity
# is emerging and internal copula swapping does not help.
tauCOP(cop=composite2COP, para=para) # fails (0.94+-.01)
tauCOP(cop=composite2COP, para=para, brute=TRUE) # about 0.94+-.01
## End(Not run)
</code></pre>


</div>