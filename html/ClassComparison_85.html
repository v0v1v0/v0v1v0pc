<div class="container">

<table style="width: 100%;"><tr>
<td>SmoothTtest-class</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Class "SmoothTtest"</h2>

<h3>Description</h3>

<p>Implements the smooth t-test for differential expression as developed
by Baggerly and Coombes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">SmoothTtest(stats, aname='Group One', bname='Group Two',
 name=paste(aname, 'vs.', bname))
## S4 method for signature 'SmoothTtest'
as.data.frame(x, row.names=NULL, optional=FALSE)
## S4 method for signature 'SmoothTtest'
summary(object, ...)
## S4 method for signature 'SmoothTtest,missing'
plot(x, folddiff=3, goodflag=2, badch=4, ccl=0,
 name=x@name, pch='.', xlab='log intensity', ylab='log ratio', ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>stats</code></td>
<td>
<p>object of class <code>TwoGroupStats</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aname</code></td>
<td>
<p>character string specifying the name of the first group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bname</code></td>
<td>
<p>character string specifying the name of the second group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>character string specifying the name of this object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>object of class <code>SmoothTtest</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>object of class <code>SmoothTtest</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>row.names</code></td>
<td>
<p>See the base version of <code>as.data.frame.default</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optional</code></td>
<td>
<p>See the base version of <code>as.data.frame.default</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>folddiff</code></td>
<td>
<p>numeric scalar specifying the level of fold difference
considered large enough to be indicated in the plots</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>goodflag</code></td>
<td>
<p>numeric scalar specifying the level (in standard deviation
units) of the smooth t-statistic considered large enough to be indicated
in the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>badch</code></td>
<td>
<p>numeric scalar specifying the level of variability in single
groups considered large enough to be worrisome. See the <code>multiple</code>
argument to the <code>plot</code> method in the <code>SingleGroup</code> class.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ccl</code></td>
<td>
<p>list containing objects of class
<code>ColorCoding</code>. If left at its default
value of zero, colors are chosen automatically.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>
<p>default plotting character</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>character string specifying label for the x axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>character string specifying label for the y axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>extra arguments for generic or plotting routines</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In 2001 and 2002, Baggerly and Coombes developed the smooth t-test for
finding differentially expressed genes in microarray data. Along with
many others, they began by log-transforming the data as a reasonable
step in the direction of variance stabilization. They observed,
however, that the gene-by-gene standard deviations still seemed to
vary in a systematic way as a function of the mean log intensity. By
borrowing strength across genes and using <code>loess</code> to fit
the observed standard deviations as a function of the mean, one
presumably got a better estimate of the true standard deviation.
</p>
<p>These smooth estimates are computed for each of two groups of samples
being compared. They are then combined (gene-by-gene using the usual
univariate formulas) to compute pooled "smooth" estimates of the standard
deviation. These smooth estimates are then used in gene-by-gene
t-tests.
</p>
<p>The interesting question then arises of how to compute and interpret
p-values associated to these individual tests. The liberal
argument asserts that, because smoothing uses data from hundreds
of measurements to estimate the standard deviation, it can effectively
be treated as "known" in the t-tests, which should thus be compared
against the normal distribution. A conservative argument claims
that the null distribution should still be the t-distribution with the
degrees of freedom determined in the usual way by the number of
samples. The truth probably lies somewhere in between, and is
probably best approximated by some kind of permutation test. In this
implementation, we take the coward's way out and don't provide any of
those alternatives. You have to extract the t-statistics (from the
<code>smooth.t.statistics</code> slot of the object) and compute your own
p-values in your favorite way. If you base the computations on a
theoretical model rather than a permutation test, then the
<code>Bum</code> class provides a convenient way to account for
multiple testing.
</p>


<h3>Creating Objects</h3>

<p>In practice, users will first use a data frame and a classification
vector (or an <code>ExpressionSet</code>) to construct an object of the
<code>TwoGroupStats</code> object. This object can then be handed
directly to the <code>SmoothTtest</code> function to perform the smooth
t-test.
</p>


<h3>Slots</h3>


<dl>
<dt>
<code>one</code>:</dt>
<dd>
<p>object of class <code>SingleGroup</code> representing a
loess smooth of standard deviation as a function of the mean in the
first group of samples</p>
</dd>
<dt>
<code>two</code>:</dt>
<dd>
<p>object of class <code>SingleGroup</code> representing a
loess smooth of standard deviation as a function of the mean in the
second group of samples</p>
</dd>
<dt>
<code>smooth.t.statistics</code>:</dt>
<dd>
<p>numeric vector containing the
smooth t-statistics</p>
</dd>
<dt>
<code>fit</code>:</dt>
<dd>
<p>data.frame with two columns, <code>x</code> and <code>y</code>,
containing the smooth estimates of the pooled standard deviation</p>
</dd>
<dt>
<code>dif</code>:</dt>
<dd>
<p>numeric vector of the differences in mean
values between the two groups</p>
</dd>
<dt>
<code>avg</code>:</dt>
<dd>
<p>numeric vector of the overall mean value</p>
</dd>
<dt>
<code>aname</code>:</dt>
<dd>
<p>character string specifying the name of the first
group</p>
</dd>
<dt>
<code>bname</code>:</dt>
<dd>
<p>character string specifying the name of the second
group</p>
</dd>
<dt>
<code>name</code>:</dt>
<dd>
<p>character string specifying the name of this object</p>
</dd>
<dt>
<code>stats</code>:</dt>
<dd>
<p>object of class <code>TwoGroupStats</code> that was used
to create this object</p>
</dd>
</dl>
<h3>Methods</h3>


<dl>
<dt>as.data.frame(x, row.names=NULL, optional=FALSE)</dt>
<dd>
<p>Convert the
object into a data frame suitable for printing or exporting.</p>
</dd>
<dt>summary(object, ...)</dt>
<dd>
<p>Write out a summary of the object.</p>
</dd>
<dt>plot(x, folddiff=3, goodflag=2, badch=4, ccl=0, name=x@name,
pch='.', xlab='log intensity', ylab='log ratio', ...)</dt>
<dd>
<p>Create a
set of six plots.  The first two plots are the QC plots from the
<code>SingleGroup</code> objects representing the two groups of
samples. The third plot is a scatter plot comparing the means in
the two groups. The fourth plot is Bland-Altman plot of the
overall mean against the difference in means (also known colloquially
as an M-vs-A plot). The fifth plot is a histogram of the smooth
t-statistics. The final plot is a scatter plot of the smooth
t-statistics as a function of the mean intensity.
Colors in the plots are controlled by the current values of
<code>oompaColor$BORING</code>,
<code>oompaColor$SIGNIFICANT</code>,
<code>oompaColor$BAD.REPLICATE</code>,
<code>oompaColor$WORST.REPLICATE</code>,
<code>oompaColor$FOLD.DIFFERENCE</code>,
<code>oompaColor$CENTRAL.LINE</code>, and
<code>oompaColor$CONFIDENCE.CURVE</code>.
</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Kevin R. Coombes <a href="mailto:krc@silicovore.com">krc@silicovore.com</a>
</p>


<h3>References</h3>

<p>Baggerly KA, Coombes KR, Hess KR, Stivers DN, Abruzzo LV, Zhang W.<br><em>Identifying differentially expressed genes in cDNA microarray
experiments.</em><br>
J Comp Biol. 8:639-659, 2001.
</p>
<p>Coombes KR, Highsmith WE, Krogmann TA, Baggerly KA, Stivers DN, Abruzzo LV.<br><em>Identifying and quantifying sources of variation in microarray data
using high-density cDNA membrane arrays.</em><br>
J Comp Biol. 9:655-669, 2002.
</p>
<p>Altman DG, Bland JM.<br><em>Measurement in Medicine: the Analysis of Method Comparison Studies.</em><br>
The Statistician, 1983; 32: 307-317. 
</p>


<h3>See Also</h3>

<p><code>Bum</code>,
<code>MultiTtest</code>,
<code>SingleGroup</code>,
<code>TwoGroupStats</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">showClass("SmoothTtest")
bogus &lt;- matrix(rnorm(30*1000, 8, 3), ncol=30, nrow=1000)
splitter &lt;- rep(FALSE, 30)
splitter[16:30] &lt;- TRUE
x &lt;- TwoGroupStats(bogus, splitter)
y &lt;- SmoothTtest(x)

opar &lt;- par(mfrow=c(2, 3), pch='.')
plot(y, badch=2, goodflag=1)
par(opar)
</code></pre>


</div>