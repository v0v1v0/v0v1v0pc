<div class="container">

<table style="width: 100%;"><tr>
<td>vgmFit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compositional variogram model fitting</h2>

<h3>Description</h3>

<p>Fits a parametric variogram model to an empirical logratio-Variogram 
</p>


<h3>Usage</h3>

<pre><code class="language-R">vgmFit2lrv(emp,vg,...,mode="log",psgn=rep(-1,length(param)),print.level=1)
## S3 method for class 'logratioVariogram'
fit.lmc(v,model,...,mode="log",psgn=rep(-1,length(param)),print.level=1)
vgmFit(emp,vg,...,mode="log",psgn=rep(-1,length(param)),print.level=1)
vgmGof(p = vgmGetParameters(vg), emp, vg, mode = "log")
vgmGetParameters(vg,envir=environment(vg))
vgmSetParameters(vg,p)
fit.lmc(v,...)
          </code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>emp</code></td>
<td>
<p>An empirical logratio-Variogram as e.g. returned by <code>logratioVariogram</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>An empirical logratio-Variogram as e.g. returned by <code>logratioVariogram</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vg</code></td>
<td>
<p>A compositional clr-variogram (or ilt-vagriogram) model function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>A compositional clr-variogram (or ilt-vagriogram) model function, output of a call to
.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further parameters to <code>nlm</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode</code></td>
<td>
<p>either "ls" or "log"  for selection of either using either
least squares or least squares on logarithmic values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psgn</code></td>
<td>
<p>Contains a parameter code for each of the parameters. -1
means the parameter should be used as is. 0 means the parameter is
nonnegativ and 1 means the parameter is striktly positiv. This
allows to provide parameter limits if the fitting procedure fails.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.level</code></td>
<td>
<p>The print.level of <code>nlm</code>. 0 for no
printing. 1 for a rough information about the sucess and 2 for step
by step printing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Is the parameter of the variogram model in linearized form as
e.g. 
returned by <code>vgmGetParameters</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>envir</code></td>
<td>
<p>The environment the default parameters of the model
should be evaluated in.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function is mainly a wrapper to <code>nlm</code> specifying the
an objective function for modell fitting, taking the starting values
of fitting procedure from the default arguments and writing the
results back. Variogram model fitting is more an art than a straight
forward procedure. Fitting procedures typically only find a right
optimum if reasonable starting parameters are provided.
The fit should
be visually checked afterwards.
<br>
The meaning of <code>psgn</code> is subject to change. We will probably
provide a more automatic procedure later.
<br><code>vgmFit</code> is a copy of <code>vgmFit2lrv</code>, but deprecated. The name
will later be used for other functionality. 
</p>


<h3>Value</h3>

<p><code>vgmFit2lrv</code> returns a list of two elements.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>nlm</code></td>
<td>
<p>The result of <code>nlm</code> containing covergence
codes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vg</code></td>
<td>
<p>A version of <code>vg</code> but with default parameters
modified according to the fitting.</p>
</td>
</tr>
</table>
<p><code>vgmGof</code> returns a scalar quantifiying the goodness of fit, of a
model and an empirical variogram.
<br><code>vgmGetParameters</code> extracts the default values of a variogram model
function to a parameter vector. It returns a numeric vector.
<br><code>vgmSetParameters</code> does the inverse operation and modifies the
default according to the new values in <code>p</code>. It returns <code>vg</code>
with modifiend default parameter values.
</p>


<h3>Author(s)</h3>

<p>K.Gerald v.d. Boogaart <a href="http://www.stat.boogaart.de">http://www.stat.boogaart.de</a></p>


<h3>See Also</h3>

<p><code>vgram2lrvgram</code>,
<code>CompLinModCoReg</code>,
<code>logratioVariogram</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data(juraset)
X &lt;- with(juraset,cbind(X,Y))
comp &lt;- acomp(juraset,c("Cd","Cu","Pb","Co","Cr"))
lrv &lt;- logratioVariogram(comp,X,maxdist=1,nbins=10)
fff &lt;- CompLinModCoReg(~nugget()+sph(0.5)+R1*exp(0.7),comp)
fit &lt;- vgmFit(lrv,fff)
fit
fff(1:3)
plot(lrv,lrvg=vgram2lrvgram(fit$vg))

## End(Not run)
</code></pre>


</div>