<div class="container">

<table style="width: 100%;"><tr>
<td>sample.basic.models.joint</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Jointly samples speciation and extinction trajectories through time, with noise.</h2>

<h3>Description</h3>

<p>Jointly samples speciation and extinction trajectories through time, with noise.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sample.basic.models.joint(
  times,
  p.delta,
  lambda0,
  mu0 = NULL,
  MRF.type = "HSMRF",
  beta.param = c(0.3, 0.3),
  mu0.median = 0.1,
  mu0.logsd = 1.17481,
  mrf.sd.scale = 1,
  min.lambda = 0,
  min.mu = 0,
  max.lambda = 10,
  max.mu = 10,
  min.p = -0.05,
  max.p = 1.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>
<p>the time knots</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.delta</code></td>
<td>
<p>The The pulled diversification rate function (measured in time before present).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda0</code></td>
<td>
<p>The speciation rate at present.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu0</code></td>
<td>
<p>The extinction rate at present, otherwise drawn randomly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MRF.type</code></td>
<td>
<p>"HSMRF" or "GMRF", type for stochastic noise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.param</code></td>
<td>
<p>Parameters of the Beta distribution used for</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu0.median</code></td>
<td>
<p>When not specified, extinction rate at present is drawn from a lognormal distribution with this median.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu0.logsd</code></td>
<td>
<p>When not specified, extinction rate at present is drawn from a lognormal distribution with this sd</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mrf.sd.scale</code></td>
<td>
<p>scale the sd of the mrf process up or down. defaults to 1.0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.lambda</code></td>
<td>
<p>The minimum speciation rate (rescaling done after after drawing rates).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.mu</code></td>
<td>
<p>The minimum extinction rate (rescaling done after after drawing rates).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.lambda</code></td>
<td>
<p>The maximum speciation rate (rescaling done after after drawing rates).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.mu</code></td>
<td>
<p>The maximum extinction rate (rescaling done after after drawing rates).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.p</code></td>
<td>
<p>The lower bound of parameter p's trajectory.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.p</code></td>
<td>
<p>The upper bound of parameter p's trajectory.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Speciation or extinction rate at a number of timepoints.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("primates_ebd")

l &lt;- approxfun(primates_ebd[["time"]], primates_ebd[["lambda"]])
mu &lt;- approxfun(primates_ebd[["time"]], primates_ebd[["mu"]])
times &lt;- primates_ebd[["time"]]

model &lt;- create.model(l, mu, times)

sample.joint.rates &lt;- function(n) {
  sample.basic.models.joint(times = times, 
                            p.delta = model$p.delta,  
                            beta.param = c(0.5,0.3),  
                            lambda0 = l(0.0),  
                            mu0.median = mu(0.0))
}

joint.samples &lt;- sample.congruence.class(model = model, 
                                         num.samples = 40, 
                                         rate.type = "joint", 
                                         sample.joint.rates = sample.joint.rates)

joint.samples
</code></pre>


</div>