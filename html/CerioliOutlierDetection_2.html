<div class="container">

<table style="width: 100%;"><tr>
<td>cerioli2010.fsrmcd.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Finite-Sample Reweighted MCD Outlier Detection Test of Cerioli (2010) </h2>

<h3>Description</h3>

<p>Given a set of observations, this function tests whether 
there are outliers in the data set and identifies outlying
points. Outlier testing/identification is done using the
Mahalanobis-distances based on the MCD dispersion estimate. 
The finite-sample reweighted MCD method of Cerioli (2010) is used 
to test for unusually large distances, which indicate possible
outliers.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cerioli2010.fsrmcd.test(datamat, 
  mcd.alpha = max.bdp.mcd.alpha(n,v), 
  signif.alpha = 0.05, nsamp = 500, 
  nmini = 300, trace = FALSE, 
  delta = 0.025, hrdf.method=c("GM14","HR05"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>datamat</code></td>
<td>
<p> (Data Frame or Matrix)
Data set to test for outliers (rows = observations, 
columns = variables). <code>datamat</code> cannot have
missing values; please deal with them prior to
calling this function. <code>datamat</code> will be converted
to a matrix.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcd.alpha</code></td>
<td>
<p> (Numeric)
Value to control the fraction
of observations used to compute the covariance matrices
in the MCD calculation.
Default value is corresponds to the maximum breakpoint
case of the MCD; valid values are between
0.5 and 1. See the <code>covMcd</code> documentation 
in the <code>robustbase</code> library for further details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>signif.alpha</code></td>
<td>
<p> (Numeric)
Desired nominal size <code class="reqn">\alpha</code> of the <em>individual</em> outlier test 
(default value is 0.05). Equivalently, significance level 
at which to test individual observations for outlyingness. (This is
the <code class="reqn">\alpha</code> parameter in Cerioli (2010).)
To test the intersection hypothesis of no outliers in the data,
specify 
</p>
<p style="text-align: center;"><code class="reqn">\alpha = 1 - (1 - \gamma)^{(1/n)},</code>
</p>
 
<p>where <code class="reqn">\gamma</code> is the nominal size of the intersection test and 
<code class="reqn">n</code> is the number of observations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsamp</code></td>
<td>
<p> (Integer)
Number of subsamples to use in computing the MCD. See the
<code>covMcd</code> documentation in the
<code>robustbase</code> library.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nmini</code></td>
<td>
<p> (Integer)
See the <code>covMcd</code> documentation in the
<code>robustbase</code> library.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p> (Logical)
See the <code>covMcd</code> documentation in the
<code>robustbase</code> library.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p> (Numeric)
False-positive rate to use in the reweighting 
step (Step 2). Defaults to 0.025 as used in
Cerioli (2010). When the ratio <code class="reqn">n/\nu</code> of
sample size to dimension is very small, using
a smaller delta can improve the accuracy of
the method.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hrdf.method</code></td>
<td>
<p> (String)
Method to use for computing degrees of freedom
and cutoff values for the non-MCD subset. The
original method of Hardin and Rocke (2005) and
the expanded method of Green and Martin (2017)
are available as the options “HR05” and “GM14”,
respectively. “GM14” is the default, as it 
is more accurate across a wider range of <code>mcd.alpha</code>
values.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mu.hat</code></td>
<td>
<p>Location estimate from the MCD calculation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.hat</code></td>
<td>
<p>Dispersion estimate from the MCD calculation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mahdist</code></td>
<td>
<p>Mahalanobis distances calculated using the MCD estimate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DD</code></td>
<td>
<p>Hardin-Rocke or Green-Martin critical values for testing MCD distances. Used
to produce weights for reweighted MCD. See Equation (16) in Cerioli (2010).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Weights used in the reweighted MCD. See Equation (16) in Cerioli
(2010).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu.hat.rw</code></td>
<td>
<p>Location estimate from the reweighted MCD calculation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.hat.rw</code></td>
<td>
<p>Dispersion estimate from the reweighted MCD calculation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mahdist.rw</code></td>
<td>
<p>a matrix of dimension <code>nrow(datamat)</code> by
<code>length(signif.alpha)</code> of Mahalanobis distances computed
using the finite-sample reweighted MCD methodology in
Cerioli (2010). Even though the distances do not depend
on <code>signif.alpha</code>, there is one column per entry in 
<code>signif.alpha</code> for user convenience.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>critvalfcn</code></td>
<td>
<p>Function to compute critical values for Mahalanobis distances
based on the reweighted MCD; see Equations (18) and (19) in Cerioli (2010). The
function takes a signifance level as its only argument, and provides a critical
value for each of the original observations (though there will only be two
unique values, one for points included in the reweighted MCD (<code>weights == 1</code>)
and one for points excluded from the reweighted MCD (<code>weights == 0</code>)).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>signif.alpha</code></td>
<td>
<p>Significance levels used in testing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcd.alpha</code></td>
<td>
<p>Fraction of the observations used to compute the MCD estimate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outliers</code></td>
<td>
<p>A matrix of dimension <code>nrow(datamat)</code> by 
<code>length(signif.alpha)</code> indicating 
whether each row of <code>datamat</code> is an outlier. The <code>i-th</code> 
column corresponds to the result of testing observations
for outlyingness at significance level <code>signif.alpha[i]</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Written and maintained by Christopher G. Green &lt;christopher.g.green@gmail.com&gt;
</p>


<h3>References</h3>

<p>Andrea Cerioli. Multivariate outlier detection with high-breakdown estimators. 
Journal of the American Statistical Association, 105(489):147-156, 2010.
<a href="https://doi.org/10.1198/jasa.2009.tm09147">doi:10.1198/jasa.2009.tm09147</a>
</p>
<p>Andrea Cerioli, Marco Riani, and Anthony C. Atkinson. Controlling the size of multivariate
outlier tests with the MCD estimator of scatter. Statistical Computing, 19:341-353, 2009.
<a href="https://doi.org/10.1007/s11222-008-9096-5">doi:10.1007/s11222-008-9096-5</a>
</p>


<h3>See Also</h3>

<p><code>cerioli2010.irmcd.test</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
require(mvtnorm, quiet=TRUE)

############################################
# dimension v, number of observations n
v &lt;- 5
n &lt;- 200
simdata &lt;- array( rmvnorm(n*v, mean=rep(0,v), 
    sigma = diag(rep(1,v))), c(n,v) )
#
# detect outliers with nominal sizes 
# c(0.05,0.01,0.001)
#
sa &lt;- 1. - ((1. - c(0.05,0.01,0.001))^(1./n))
results &lt;- cerioli2010.fsrmcd.test( simdata, 
    signif.alpha=sa )
# count number of outliers detected for each 
# significance level
colSums( results$outliers )


#############################################
# add some contamination to illustrate how to 
# detect outliers using the fsrmcd test
# 10/200 = 5% contamination
simdata[ sample(n,10), ] &lt;- array( 
  rmvnorm( 10*v, mean=rep(2,v), sigma = diag(rep(1,v))),
  c(10,v)
)
results &lt;- cerioli2010.fsrmcd.test( simdata, 
  signif.alpha=sa )
colMeans( results$outliers )


## Not run: 
#############################################
# example of how to ensure the size of the intersection test is correct

  n.sim &lt;- 5000
  simdata &lt;- array( 
    rmvnorm(n*v*n.sim, mean=rep(0,v), sigma=diag(rep(1,v))),
    c(n,v,n.sim)
  )
  # in practice we'd do this using one of the parallel processing
  # methods out there
  sa &lt;- 1. - ((1. - 0.01)^(1./n))
  results &lt;- apply( simdata, 3, function(dm) {
    z &lt;- cerioli2010.fsrmcd.test( dm, 
      signif.alpha=sa )
    # true if outliers were detected in the data, false otherwise
    any(z$outliers[,1,drop=TRUE])
  })
  # count the percentage of samples where outliers were detected;
  # should be close to the significance level value used (0.01) in these
  # samples for the intersection test.
  mean(results)


## End(Not run)
</code></pre>


</div>