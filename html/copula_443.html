<div class="container">

<table style="width: 100%;"><tr>
<td>Copula</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Density, Evaluation, and Random Number Generation for Copula Functions</h2>

<h3>Description</h3>

<p>Density (<code>dCopula</code>), distribution function (<code>pCopula</code>), and
random generation (<code>rCopula</code>) for a <code>copula</code> object.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dCopula(u, copula, log=FALSE, ...)
pCopula(u, copula, ...)
rCopula(n, copula, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>copula</code></td>
<td>
<p>an <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> object of class <code>"Copula"</code>,
(i.e., <code>"copula"</code> or  <code>"nacopula"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>a vector of the copula dimension <code class="reqn">d</code> or a matrix with <code class="reqn">d</code>
columns, giving the points where the density or distribution
function needs to be evaluated.  Note that in all cases, values
outside of the cube <code class="reqn">[0,1]^d</code> are treated equivalently
to those on the cube boundary.  So, e.g., the density is zero.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>logical indicating if the <code class="reqn">\log(f(\cdot))</code>
should be returned instead of <code class="reqn">f(\cdot)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>(for <code>rCopula()</code>:) number of observations to be generated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further optional arguments for some methods, e.g.,
<code>method</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The density (<code>dCopula</code>) and distribution function
(<code>pCopula</code>) methods for Archimedean copulas now use the
corresponding function slots of the Archimedean copula objects, such
as <code>copClayton</code>, <code>copGumbel</code>, etc.
</p>
<p>If an <code class="reqn">u_j</code> is outside <code class="reqn">(0,1)</code> we declare the density to be
zero, and this is true even when another <code class="reqn">u_k, k \ne j</code>
is <code>NA</code> or <code>NaN</code>; see also the
“outside” example.
</p>
<p>The distribution function of a <code>t</code> copula uses <code>pmvt</code> from
package <span class="pkg">mvtnorm</span>; similarly, the density (<code>dCopula</code>) calls
<code>dmvt</code> from CRAN package <a href="https://CRAN.R-project.org/package=mvtnorm"><span class="pkg">mvtnorm</span></a>.
The <code>normalCopula</code> methods use <code>dmvnorm</code> and <code>pmvnorm</code>
from the same package.
</p>
<p>The random number generator for an Archimedean copula uses the
conditional approach for the bivariate case and the Marshall-Olkin (1988)
approach for dimension greater than 2.
</p>


<h3>Value</h3>

<p><code>dCopula()</code> gives the density, <code>pCopula()</code> gives the
distribution function, and <code>rCopula()</code> generates random variates.
</p>


<h3>References</h3>

<p>Frees, E. W.  and Valdez, E. A. (1998). Understanding relationships using
copulas.
<em>North American Actuarial Journal</em> <b>2</b>, 1–25.
</p>
<p>Genest, C. and Favre, A.-C. (2007).
Everything you always wanted to know about copula modeling but were
afraid to ask.
<em>Journal of Hydrologic Engineering</em> <b>12</b>, 347–368.
</p>
<p>Joe, H. (1997). <em>Multivariate Models and Dependence Concepts</em>.
Chapman and Hall, London.
</p>
<p>Marshall, A. W. and Olkin, I. (1988)
Families of multivariate distributions.
<em>Journal of the American Statistical Association</em> <b>83</b>, 834–841.
</p>
<p>Nelsen, R. B. (2006)
<em>An introduction to Copulas</em>. Springer, New York.
</p>


<h3>See Also</h3>

<p>the <code>copula</code> and <code>acopula</code>
classes, the acopula families, <code>acopula-families</code>.
Constructor functions such as
<code>ellipCopula</code>, <code>archmCopula</code>,
<code>fgmCopula</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">norm.cop &lt;- normalCopula(0.5)
norm.cop
## one d-vector =^= 1-row matrix, works too :
dCopula(c(0.5, 0.5), norm.cop)
pCopula(c(0.5, 0.5), norm.cop)

u &lt;- rCopula(100, norm.cop)
plot(u)
dCopula(u, norm.cop)
pCopula(u, norm.cop)
persp  (norm.cop, dCopula)
contour(norm.cop, pCopula)

## a 3-dimensional normal copula
u &lt;- rCopula(1000, normalCopula(0.5, dim = 3))
if(require(scatterplot3d))
  scatterplot3d(u)

## a 3-dimensional clayton copula
cl3 &lt;- claytonCopula(2, dim = 3)
v &lt;- rCopula(1000, cl3)
pairs(v)
if(require(scatterplot3d))
  scatterplot3d(v)

## Compare with the "nacopula" version :
fu1 &lt;- dCopula(v, cl3)
fu2 &lt;- copClayton@dacopula(v, theta = 2)
Fu1 &lt;- pCopula(v, cl3)
Fu2 &lt;- pCopula(v, onacopula("Clayton", C(2.0, 1:3)))
## The density and cumulative values are the same:
stopifnot(all.equal(fu1, fu2, tolerance= 1e-14),
          all.equal(Fu1, Fu2, tolerance= 1e-15))

## NA and "outside" u[]
u &lt;- v[1:12,]
## replace some by values outside (0,1) and some by NA/NaN
u[1, 2:3] &lt;- c(1.5, NaN); u[2, 1] &lt;- 2; u[3, 1:2] &lt;- c(NA, -1)
u[cbind(4:9, 1:3)] &lt;- c(NA, NaN)
f &lt;- dCopula(u, cl3)
cbind(u, f) # note: f(.) == 0 at [1] and [3] inspite of NaN/NA
stopifnot(f[1:3] == 0, is.na(f[4:9]), 0 &lt; f[10:12])
</code></pre>


</div>