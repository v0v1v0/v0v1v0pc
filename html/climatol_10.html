<div class="container">

<table style="width: 100%;"><tr>
<td>dahstat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extract series or statistics of the homogenized data</h2>

<h3>Description</h3>

<p>Lists series, means, medians, standard deviations, quantiles or trends, for a
specified period, from series homogenized by <code>homogen</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dahstat(varcli, anyi, anyf, anyip=anyi, anyfp=anyf, stat="me", ndc=NA, vala=2,
valm=vala, cod=NULL, prob=.5, all=FALSE, long=FALSE, relref=FALSE, pernyr=10,
estcol=c(1,2,4), sep=',', dec='.')
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>varcli</code></td>
<td>
<p>Short name of the studied climatic variable,
as in the data file name.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>anyi</code></td>
<td>
<p>Initial year of the homogenized period.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>anyf</code></td>
<td>
<p>Final year of the homogenized period.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>anyip</code></td>
<td>
<p>First year of the period to analyze. (Defaults to <code>anyi</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>anyfp</code></td>
<td>
<p>Last year of the period to analyze. (Defaults to <code>anyf</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stat</code></td>
<td>
<p>Statistical parameter to compute for the selected period:
</p>

<dl>
<dt>"me":</dt>
<dd>
<p>Means (default),</p>
</dd>
<dt>"mdn"</dt>
<dd>
<p>Medians,</p>
</dd>
<dt>"max"</dt>
<dd>
<p>Maxima,</p>
</dd>
<dt>"min"</dt>
<dd>
<p>Minima,</p>
</dd>
<dt>"std"</dt>
<dd>
<p>Standard deviations,</p>
</dd>
<dt>"q"</dt>
<dd>
<p>Quantiles (see the <code>prob</code> parameter),</p>
</dd>
<dt>"tnd"</dt>
<dd>
<p>OLS trends and their p-values,</p>
</dd>
<dt>"series"</dt>
<dd>
<p>Do not compute any statistic; only write homogenized
series and flags into two CSV files.</p>
</dd>
<dt>"mseries"</dt>
<dd>
<p>As before, but output series in individual *.csv files.
(Not applicable to daily series.)</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndc</code></td>
<td>
<p>Number of decimal places to be saved in the output file (defaults to that used in the homogenization).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vala</code></td>
<td>
<p>Annual values to compute from the sub-annual data:
</p>

<dl>
<dt>0:</dt>
<dd>
<p>None,</p>
</dd>
<dt>1:</dt>
<dd>
<p>Sum,</p>
</dd>
<dt>2:</dt>
<dd>
<p>Mean (default),</p>
</dd>
<dt>3:</dt>
<dd>
<p>Maximum,</p>
</dd>
<dt>4:</dt>
<dd>
<p>Minimum.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>valm</code></td>
<td>
<p>Monthly values to calculate from sub-monthly data (defaults to
<code>vala</code>):
</p>

<dl>
<dt>1:</dt>
<dd>
<p>Sum,</p>
</dd>
<dt>2:</dt>
<dd>
<p>Mean,</p>
</dd>
<dt>3:</dt>
<dd>
<p>Maximum,</p>
</dd>
<dt>4:</dt>
<dd>
<p>Minimum.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cod</code></td>
<td>
<p>Vector of requested station codes (all by default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>Probability for the computation of quantiles (0.5 by default,
i.e., medians). You can set probabilities with more than 2 decimals, but
the name of the output file will be identified with the rounded percentile.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>all</code></td>
<td>
<p>If <code>TRUE</code>, all reconstructed series will be used. The default
is <code>FALSE</code>, hence using only the series reconstructed from the last
homogeneous subperiod.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>long</code></td>
<td>
<p>If <code>TRUE</code> (the default is <code>FALSE</code>), only series
reconstructed from the longest homogeneous subperiod will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>relref</code></td>
<td>
<p>If <code>TRUE</code>, statistics from reliable reference series will
also be listed. (<code>FALSE</code> by default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pernyr</code></td>
<td>
<p>Number of years on which to express trend units (10 by default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estcol</code></td>
<td>
<p>Columns of the homogenized stations file to be included in the
output file. (Defaults to c(1,2,4), the columns of station coordinates and codes).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sep</code></td>
<td>
<p>Field separator (',' by default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dec</code></td>
<td>
<p>Decimal point ('.' by default).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Homogenized data are read from the file ‘<span class="file">VRB_ANYI-ANYF.rda</span>’
saved by <code>homogen</code>, while this function saves the
computed data for the specified period in ‘<span class="file">VRB_ANYIP-ANYFP.STAT</span>’,
where <code>STAT</code> is substituted by the <code>stat</code> requested
statistic. An exception is when <code>stat="q"</code>, since then the
extension of the output file will be <code>qPP</code>, where <code>PP</code>
stands for the specified <code>prob</code> probability (in percent).
</p>
<p>The output period <code>ANYIP-ANYFP</code> must of course be comprised
within the period of the input data, <code>ANYI-ANYF</code>.
</p>
<p><code>stat='tnd'</code> computes trends by Ordinary Least Squares linear regression
on time, listing them in a CSV file ‘<span class="file">*_tnd.csv</span>’ and their p-values in
‘<span class="file">*_pval.csv</span>’
</p>
<p>If <code>stat='series'</code> is chosen, two text files in CSV format will be
produced for every station, one with the data and another with their flags: 0
for original, 1 for infilled and 2 for corrected data.
</p>


<h3>See Also</h3>

<p><code>homogen</code>, <code>dahgrid</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R">## Set a temporal working directory:
wd &lt;- tempdir()
wd0 &lt;- setwd(wd)

## Copy an example file of homogenization results:
file.copy(exampleFiles('Temp_1991-2000.rda'),'.')

## Now run the examples:
dahstat('Temp', 1991, 2000)
dahstat('Temp', 1991, 2000, stat='q', prob=0.4)
dahstat('Temp', 1991, 2000, stat='tnd')
dahstat('Temp', 1991, 2000, stat='series')

## Return to user's working directory:
setwd(wd0)

## Input and output files can be found in directory:
print(wd)
</code></pre>


</div>