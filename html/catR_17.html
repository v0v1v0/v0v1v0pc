<div class="container">

<table style="width: 100%;"><tr>
<td>MEI</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>(Maximum) Expected Information (MEI)</h2>

<h3>Description</h3>

<p>This command returns the expected information (EI) for a given item (under dichotomous and polytomous IRT models), as used for Maximum Expected Information (MEI) criterion.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MEI(itemBank, item, x, theta, it.given, model = NULL, method = "BM", 
 	priorDist = "norm", priorPar = c(0, 1), D = 1, range = c(-4, 4), 
 	parInt = c(-4, 4, 33), infoType = "observed")
 </code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>itemBank</code></td>
<td>
<p>numeric: a suitable matrix of item parameters. See <b>Details</b>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>item</code></td>
<td>
<p>numeric: the item (referred to as its rank in the item bank) for which the expected information must be computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>numeric: a vector of item responses, coded as 0 or 1 only (for dichotomous items) or from 0 to the number of response categories minus one (for polytomous items).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>numeric: the provisional ability estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>it.given</code></td>
<td>
<p>numeric: a suitable matrix of item parameters for previously administered items. The number of rows of <code>it.given</code> must be equal to the length of <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>either <code>NULL</code> (default) for dichotomous models, or any suitable acronym for polytomous models. Possible values are <code>"GRM"</code>, <code>"MGRM"</code>, <code>"PCM"</code>, <code>"GPCM"</code>, <code>"RSM"</code> and <code>"NRM"</code>. See <b>Details</b>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>character: the ability estimator. Possible values are <code>"BM"</code> (default), <code>"ML"</code> and <code>"WL"</code>. See <b>Details</b>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>priorDist</code></td>
<td>
<p>character: specifies the prior distribution. Possible values are <code>"norm"</code> (default), <code>"unif"</code> and <code>"Jeffreys"</code>.
Ignored if <code>method</code> is neither <code>"BM"</code> nor <code>"EAP"</code>. See <b>Details</b>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>priorPar</code></td>
<td>
<p>numeric: vector of two components specifying the prior parameters (default is <code>c(0,1)</code>) of the prior ability distribution. Ignored if <code>method</code> is neither <code>"BM"</code>
nor <code>"EAP"</code>, or if <code>priorDist="Jeffreys"</code>. See <b>Details</b>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>numeric: the metric constant. Default is <code>D=1</code> (for logistic metric); <code>D=1.702</code> yields approximately the normal metric (Haley, 1952).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range</code></td>
<td>
<p>numeric: vector of two components specifying the range wherein the ability estimate must be looked for (default is <code>c(-4,4)</code>). Ignored if <code>method=="EAP"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parInt</code></td>
<td>
<p>numeric: vector of three components, holding respectively the values of the arguments <code>lower</code>, <code>upper</code> and <code>nqp</code> of the
<code>eapEst</code> command. Default vector is (-4, 4, 33). Ignored if <code>method</code> is not <code>"EAP"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>infoType</code></td>
<td>
<p>character: the type of information function to be used. Possible values are <code>"observed"</code> (default) for observed information function, and <code>"Fisher"</code> for Fisher information function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The MEI (van der Linden, 1998; van der Linden and Pashley, 2000) can be used as a rule for selecting the next item in the CAT process (see also Choi and Swartz, 2009), both with dichotomous and polytomous IRT models. This command serves as a subroutine for the <code>nextItem</code> function.
</p>
<p>Dichotomous IRT models are considered whenever <code>model</code> is set to <code>NULL</code> (default value). In this case, <code>itemBank</code> must be a matrix with one row per item and four columns, with the values of the discrimination, the difficulty, the pseudo-guessing and the inattention parameters (in this order). These are the parameters of the four-parameter logistic (4PL) model (Barton and Lord, 1981). 
</p>
<p>Polytomous IRT models are specified by their respective acronym: <code>"GRM"</code> for Graded Response Model, <code>"MGRM"</code> for Modified Graded Response Model, <code>"PCM"</code> for Partical Credit Model, <code>"GPCM"</code> for Generalized Partial Credit Model, <code>"RSM"</code> for Rating Scale Model and <code>"NRM"</code> for Nominal Response Model. The <code>itemBank</code> still holds one row per item, end the number of columns and their content depends on the model. See <code>genPolyMatrix</code> for further information and illustrative examples of suitable polytomous item banks.
</p>
<p>Under polytomous IRT models, let <em>k</em> be the number of administered items, and set <code class="reqn">x_1, ..., x_k</code> as the provisional response pattern (where each response <code class="reqn">x_l</code> takes values in <code class="reqn">\{0, 1, ..., g_l\}</code>). Set <code class="reqn">\hat{\theta}_k</code> as the provisional ability estimate (with the first <em>k</em> responses) and let <em>j</em> be the item of interest (not previously administered). Set also <code class="reqn">P_{jt}(\theta)</code> as the probability of answering response category <em>t</em> to item <em>j</em> for a given ability level <code class="reqn">\theta</code>. Finally, set
<code class="reqn">\hat{\theta}_{k+1}^t</code> as the ability estimates computed under the condition that the response to item <em>j</em> is <em>t</em> (with <code class="reqn">t=0, ..., g_j</code>). Then, the EI for item <em>j</em> equals
</p>
<p style="text-align: center;"><code class="reqn">EI_j = \sum_{t=0}^{g_j} P_{jt}(\hat{\theta}_k)\,I_j(\hat{\theta}_{k+1}^t)</code>
</p>
 
<p>where <code class="reqn">I_j(\theta)</code> is the information function for item <em>j</em>.
</p>
<p>In case of dichotomous IRT models, all <code class="reqn">g_l</code> values reduce to 1, so that item responses <code class="reqn">x_l</code> equal either 0 or 1. Set simply <code class="reqn">P_j(\theta)</code> as the probability of answering item <em>j</em> correctly for a given ability level <code class="reqn">\theta</code>, and  set <code class="reqn">Q_j(\theta)=1-P_j(\theta)</code>. Finally, set <code class="reqn">\hat{\theta}_{k+1}^0</code> and <code class="reqn">\hat{\theta}_{k+1}^1</code> as the ability estimates computed under the condition that the response to item <em>j</em> is 0 or 1 respectively (that is, if the response pattern is updated by 0 or 1 for item <em>j</em>). Then, the EI for item <em>j</em> reduces to
</p>
<p style="text-align: center;"><code class="reqn">EI_j = P_j(\hat{\theta}_k)\,I_j(\hat{\theta}_{k+1}^1) +  Q_j(\hat{\theta}_k)\,I_j(\hat{\theta}_{k+1}^0)</code>
</p>
<p>.
</p>
<p>Two types of information functions are available. The first one is the observed information function, defined as 
</p>
<p style="text-align: center;"><code class="reqn">OI_j(\theta) = -\frac{\partial^2}{\partial \theta^2} \,\log L(\theta | x_j)</code>
</p>

<p>(van der Linden, 1998), where <code class="reqn">L(\theta | x_j)</code> is the likelihood related to item <em>j</em>. The second one is Fisher information function:
</p>
<p style="text-align: center;"><code class="reqn">I_j(\theta) = -E\,\left[\frac{\partial^2}{\partial\,\theta^2} \,\log L(\theta | x_j))\right].</code>
</p>

<p>Under the 1PL and the 2PL models, these functions are identical (Veerkamp, 1996). See also <code>OIi</code>. 
</p>
<p>The observed and Fisher information functions are specified by the <code>infoType</code> argument, with respective values <code>"observed"</code> and <code>"Fisher"</code>. By default, the observed information function is considered (Choi and Swartz, 2009; van der Linden, 1998).
</p>
<p>The estimator of provisional ability is defined by means of the arguments <code>method</code>, <code>priorDist</code>, <code>priorPar</code>, <code>D</code>, <code>range</code> and <code>parInt</code> of the <code>thetaEst</code> function. See the corresponding help file for further details.
</p>
<p>The provisional response pattern and the related item parameters are provided by the arguments <code>x</code> and <code>it.given</code> respectively. The target item (for which the maximum information computed) is given by its number in the item bank, through the
<code>item</code> argument. 
</p>
<p>Note that the provisional response pattern <code>x</code> can also be set to <code>NULL</code> (which is useful when the number <code>nrItems</code> of starting items is set to zero). In this case, <code>it.given</code> must be a matrix with zero rows, such as e.g., <code>itemBank[NULL,]</code>. 
</p>


<h3>Value</h3>

<p>The required expected information for the selected item.
</p>


<h3>Author(s)</h3>

<p>David Magis <br>
Department of Psychology, University of Liege, Belgium <br><a href="mailto:david.magis@uliege.be">david.magis@uliege.be</a>
</p>


<h3>References</h3>

<p>Barton, M.A., and Lord, F.M. (1981). <em>An upper asymptote for the three-parameter logistic item-response model</em>.
Research Bulletin 81-20. Princeton, NJ: Educational Testing Service.
</p>
<p>Choi, S. W., and Swartz, R. J. (2009). Comparison of CAT item selection criteria for polytomous items. <em>Applied Psychological Measurement, 32</em>, 419-440. doi: <a href="https://doi.org/10.1177/0146621608327801">10.1177/0146621608327801</a>
</p>
<p>Haley, D.C. (1952). <em>Estimation of the dosage mortality relationship when the dose is subject to error</em>. Technical report no 15. Palo Alto, CA: Applied Mathematics and Statistics Laboratory, Stanford University. 
</p>
<p>Magis, D. and Barrada, J. R. (2017). Computerized Adaptive Testing with R: Recent Updates of the Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>Code Snippets</em>, <em>76(1)</em>, 1-18. doi: <a href="https://doi.org/10.18637/jss.v076.c01">10.18637/jss.v076.c01</a>
</p>
<p>Magis, D., and Raiche, G. (2012). Random Generation of Response Patterns under Computerized Adaptive Testing with the R Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>48 (8)</em>, 1-31. doi: <a href="https://doi.org/10.18637/jss.v048.i08">10.18637/jss.v048.i08</a>
</p>
<p>van der Linden, W. J. (1998). Bayesian item selection criteria for adaptive testing. <em>Psychometrika, 63</em>, 201-216. doi: <a href="https://doi.org/10.1007/BF02294775">10.1007/BF02294775</a>
</p>
<p>van der Linden, W. J., and Pashley, P. J. (2000). Item selection and ability estimation in adaptive testing. In W. J. van der Linden and C. A. W. Glas (Eds.), <em>Computerized adaptive testing. Theory and practice</em> (pp. 1-25). Boston, MA: Kluwer. 
</p>
<p>Veerkamp, W. J. J. (1996). <em>Statistical inference for adaptive testing</em>. Internal report. Enschede, The Netherlands: 
University of Twente. 
</p>


<h3>See Also</h3>

<p><code>Ii</code>, <code>OIi</code>, <code>nextItem</code>, <code>thetaEst</code>, <code>genPolyMatrix</code> 
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Dichotomous models ##

 # Loading the 'tcals' parameters 
 data(tcals)

 # Selecting item parameters only
 bank &lt;- as.matrix(tcals[,1:4])
 
 # Selection of two arbitrary items (15 and 20) of the
 # 'tcals' data set
 it.given &lt;- bank[c(15, 20),]

 # Creation of a response pattern
 x &lt;- c(0, 1)

 # MEI for item 1, provisional ability level 0
 MEI(bank, 1, x, 0, it.given)

 # With Fisher information instead
 MEI(bank, 1, x, 0, it.given, infoType = "Fisher")

 # With WL estimator instead
 MEI(bank, 1, x, 0, it.given, method = "WL")


## Polytomous models ##

 # Generation of an item bank under GRM with 100 items and at most 4 categories
 m.GRM &lt;- genPolyMatrix(100, 4, "GRM")
 m.GRM &lt;- as.matrix(m.GRM)

 # Selection of two arbitrary items (15 and 20) 
it.given &lt;- m.GRM[c(15, 20),]

 # Generation of a response pattern (true ability level 0)
 x &lt;- genPattern(0, it.given, model = "GRM")

 # EPV for item 1, provisional ability level 0
 MEI(m.GRM, 1, x, 0, it.given, model = "GRM")

 # With WL method
 MEI(m.GRM, 1, x, 0, it.given, model = "GRM", method = "WL")

 # With Fisher information
 MEI(m.GRM, 1, x, 0, it.given, model = "GRM", infoType = "Fisher")

 # Loading the cat_pav data
 data(cat_pav)
 cat_pav &lt;- as.matrix(cat_pav)

 # Selection of two arbitrary items (15 and 20) 
 it.given &lt;- cat_pav[c(15, 20),]

 # Generation of a response pattern (true ability level 0)
 x &lt;- genPattern(0, it.given, model = "GPCM")

 # EPV for item 1, provisional ability level 0
 MEI(cat_pav, 1, x, 0, it.given, model = "GPCM")

 # With WL method
 MEI(cat_pav, 1, x, 0, it.given, model = "GPCM", method = "WL")

 # With Fisher information
 MEI(cat_pav, 1, x, 0, it.given, model = "GPCM", infoType = "Fisher") 
 </code></pre>


</div>