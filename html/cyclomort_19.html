<div class="container">

<table style="width: 100%;"><tr>
<td>predict.cmfit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Prediction method for cyclomort fits</h2>

<h3>Description</h3>

<p>Obtain predictions and confidence intervals for the hazard function or the 
time to event from a fitted cyclomort object.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'cmfit'
predict(
  object,
  ...,
  t = seq(0, object$period, length = 500),
  type = "hazard",
  CI = FALSE,
  CI.level = 0.95,
  nreps = 1000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>a cmfit object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>(not implemented)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>times for prediction.  By default, covers 100 observations over a 
single period.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>either <code>hazard</code> or <code>timetoevent</code> - dictates what 
exactly will be predicted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI</code></td>
<td>
<p>a boolean dictating whether or not to compute confidence intervals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI.level</code></td>
<td>
<p>confidence level (default 0.95) for CIs (if CI is TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nreps</code></td>
<td>
<p>number of samples drawn to generate confidence intervals.  The 
default 10^3 is generally sufficient, and very fast for the hazard function, 
but possibly prohibitively slow for the time-to-event functionality.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Confidence intervals are produced by sampling from the multivariate 
normal distribution of the MLE parameter estimates accounting for the 
covariance in the estimates by using the Hessian of the MLE.
</p>


<h3>Value</h3>

<p>a list of vectors containing predictions for each value in <code>t</code>, 
as well as (optional) confidence intervals.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># simulate two-peak mortality process
sim.morts &lt;- simulate_cycloSurv(300, period = 1, peaks = c(0.3, 0.8), 
                      durations = c(0.15, 0.20), weights = c(3, 2)/5, 
                      meanhazard = 1, plotme = FALSE, max.periods = 6)
sim.morts &lt;- simulate_cycloSurv(300, period = 365, peaks = c(0.3, 0.8)*365, 
                                durations = c(0.15, 0.20)*365, weights = c(3, 2)/5, 
                                meanhazard = 1/365, plotme = FALSE, max.periods = 6)

# estimate parameters
sim.morts.fit &lt;- fit_cyclomort(sim.morts, n.seasons = 2)

# compute predictions for one moment in time (with 95% confidence interval)
predict(sim.morts.fit, CI = TRUE, type = "hazard")

# compute predictions for a range of times
predict(sim.morts.fit, t = 1:365, CI = FALSE, type = "hazard")

# these predictions are used (internally) in the plot.cmfit method:


plot(sim.morts.fit, CI.level = 0.95, months = FALSE, histogram = FALSE, monthlabs = TRUE)
plot(sim.morts.fit, CI.level = 0.8, months = FALSE, histogram = FALSE, add = TRUE)
plot(sim.morts.fit, CI.level = 0.5, months = FALSE, histogram = FALSE, add = TRUE)


# predict time to event given a start at times (this is a very slow calculation!)


timetoeventprediction &lt;- predict(sim.morts.fit, t = seq(1,365,3), type = "timetoevent",
                       CI = TRUE, nreps = 1e2)


# the following object contains a prediction
data(timetoeventprediction)

with(timetoeventprediction, {
  plot(t, fit, type = "l", lwd = 2,  main = "expected time to event", 
       ylim = c(100,365), ylab = "days")
  lines(t, CI[1,], lty = 3)
  lines(t, CI[2,], lty = 3)
})
</code></pre>


</div>