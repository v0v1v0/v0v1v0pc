<div class="container">

<table style="width: 100%;"><tr>
<td>catdap2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Categorical Data Analysis Program Package 02</h2>

<h3>Description</h3>

<p>Search for the best single explanatory variable and detect the best subset of
explanatory variables.
</p>


<h3>Usage</h3>

<pre><code class="language-R">catdap2(data, pool = NULL, response.name, accuracy = NULL, nvar = NULL,
        additional.output = NULL, missingmark = NULL, pa1 = 1, pa2 = 4, pa3 = 10,
        print.level = 0, plot = 1, gray.shade = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data matrix with variable names on the first row.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pool</code></td>
<td>
<p>the ways of pooling to categorize each variable must be specified
by integer parameters:
</p>

<dl>
<dt>(-m) &lt; 0 :</dt>
<dd>
<p><code class="reqn">m</code>-bin histogram is employed to describe the
distribution of continuous response variable (this option is valid only
for the response variable),</p>
</dd>
<dt>0 :</dt>
<dd>
<p>equally spaced pooling via a top-down algorithm,</p>
</dd>
<dt>1 :</dt>
<dd>
<p>unequally spaced pooling via a bottom-up algorithm (default),</p>
</dd>
<dt>2 :</dt>
<dd>
<p>no pooling for discrete variables.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>response.name</code></td>
<td>
<p>variable name of the response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accuracy</code></td>
<td>
<p>minimum width for the discretization for each variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nvar</code></td>
<td>
<p>number of variables to be retained for the analysis of
multidimensional tables. Default is the number of variables in <code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>additional.output</code></td>
<td>
<p>list of sets of explanatory variable names for
additional output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>missingmark</code></td>
<td>
<p>positive number for handling missing value. See 'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pa1, pa2, pa3</code></td>
<td>
<p>control parameter for size of the working area. If error
message is output, please change the value of parameter according to it.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.level</code></td>
<td>
<p>this argument determines the level of output printing. The
default value of '<code>0</code>' means that lists of "AIC's of the models with k
explanatory variables (k=1,2,...)" are printed. A value of '<code>1</code>' means
that those lists are not printed and "Summary of subsets of explanatory
variables" within the top 30 is listed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>split directions of the mosaic plot for single explanatory models
and minimum AIC model:
</p>

<dl>
<dt>0 :</dt>
<dd>
<p>no plot,</p>
</dd>
<dt>1 :</dt>
<dd>
<p>horizontal (default),</p>
</dd>
<dt>2 :</dt>
<dd>
<p>alternating directions, beginning with a vertical split.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gray.shade</code></td>
<td>
<p>A logical value indicating whether the gamma-corrected grey
palette should be used. If <code>FALSE</code> (default), any color palette is used.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is an R-function style clone of Sakamoto's CATDAP-02 program
for categorical data analysis. CATDAP-02 can be used to search for the best
subset of explanatory variables which have the most effective information on a
specified response variable. Continuous explanatory variables could be
explanatory variables. In that case CATDAP-02 searches for optimal
categorization of continuous values.
</p>
<p>The basic statistic adopted is obtained by the application of the
statistic AIC to the models.
</p>
<p><code class="reqn">E</code> denotes the response variable and <code class="reqn">F</code> denotes candidate
explanatory variable, and their cell frequencies by
<code class="reqn">n_E(i) (i \in E)</code> and
<code class="reqn">n_F(j) (j \in F)</code>. The cross frequency is denoted by
<code class="reqn">n_{E,F}(i,j)</code> <code class="reqn">(i \in E, j \in F)</code>. To measure
the strength of dependence of a specific set of response variables <code class="reqn">E</code> on
the explanatory variable <code class="reqn">F</code>, we use the following statistic:
</p>
<p style="text-align: center;"><code class="reqn">AIC(E;F) = -2\sum_{i \in E, j \in F} n_{E,F}(i,j)\ \ln\{n_{E,F}(i,j)/n_F(j)\} + 2C_F(C_E-1),\ \ (1)</code>
</p>

<p>where <code class="reqn">C_E</code> and <code class="reqn">C_F</code> denote the total number of categories of the
corresponding sets of variables, respectively.
</p>
<p>The selection of the best subset of explanatory variables is realized by the
search for <code class="reqn">F</code> which gives the minimum <code class="reqn">AIC(E;F)</code>.
</p>
<p>In case of <code class="reqn">F=\phi</code>, the formula (1) reduces to
</p>
<p style="text-align: center;"><code class="reqn">AIC(E;\phi) = -2\sum_{i \in E} n_E(i)\ \ln\{n_E(i)/n\} + 2(C_E-1).</code>
</p>

<p>Here it is assumed that <code class="reqn">C_\phi=1</code> and <code class="reqn">n_\phi(1)=n</code>.
</p>
<p>Sakamoto's original CATDAP outputs <code class="reqn">AIC(E;F) - AIC(E;\phi)</code> as the AIC
value instead of <code class="reqn">AIC(E;F)</code>. By this way the positive value of AIC
indicates that the variable <code class="reqn">F</code> is judged to be useless as the explanatory
variable of the <code class="reqn">E</code>.
</p>
<p>On the other hand, this policy make impossible to compare the goodness of the
CATDAP model with other models, logit models for example. 
</p>
<p>Considering the convenience of users, present "R version CATDAP" provides not
only <code class="reqn">AIC = AIC(E;F) - AIC(E;\phi)</code>, but <code class="reqn">AIC(E;\phi)</code>, either. The
latter value is given as base_AIC in the output.
</p>
<p>Users could recover <code class="reqn">AIC(E;F)</code> by adding AIC and base_AIC.
</p>
<p><code>missingmark</code> enables missing value handling.
When a positive values, say <code class="reqn">1000</code>, is set here, any value, say <code class="reqn">x</code>,
greater than or equal to <code class="reqn">1000</code> is treated as a missing value. If
<code class="reqn">1000 \le x &lt; 2000</code>, <code class="reqn">x</code> is treated as a missing
value of the 1st type. If <code class="reqn">2000 \le x &lt; 3000</code>, <code class="reqn">x</code>
is treated as a missing value of the 2nd type, and so on. Generally speaking,
any <code class="reqn">x</code> that <code class="reqn">1000k \le x &lt; 1000(k+1)</code> is
treated as the <code class="reqn">k</code>-th type missing value. Users are referred to the
reference for the technical details of the missing value handling procedure.
</p>
<p>For continuous variables, we assume that
<code class="reqn">b_1, b_2, \dots, b_{m+1}</code> are boundary values
of <code class="reqn">m</code> bins. Output value ranges <code class="reqn">r_i</code> <code class="reqn">(1 \le i \le m)</code> are
defined as follows : 
</p>
<p style="text-align: center;"><code class="reqn">r_i = \left[ \; b_i,\; b_{i+1}\; \right. ) \;\; \mathrm{for} \;1 \le i &lt; m,</code>
</p>

<p style="text-align: center;"><code class="reqn">r_m = \left[ \; b_m,\; b_{m+1}\; \right] .</code>
</p>

<p>Specifically, for continuous response variable <code class="reqn">V</code>,
</p>
<p style="text-align: center;"><code class="reqn">r_i = \left[ \; x_{min} + (i-1)*s,\; x_{min} + i*s \; \right. ) \;\; \mathrm{for} \;1 \le i &lt; m,</code>
</p>

<p style="text-align: center;"><code class="reqn">r_m = \left[ \; x_{min} + (m-1)*s,\; x_{max} \; \right] ,</code>
</p>

<p>where <code class="reqn">x_{min}</code> and <code class="reqn">x_{max}</code> are the minimum and the
maximums of variable V respectively and
<code class="reqn">s = (x_{max} - x_{min}) / m</code>.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tway.table</code></td>
<td>
<p>two-way tables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>total</code></td>
<td>
<p>total number of data with corresponding code of variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interval</code></td>
<td>
<p>class interval for continuous and discrete explanatory
variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>base.aic</code></td>
<td>
<p>base_AIC.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aic</code></td>
<td>
<p>AIC's of single explanatory variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aic.order</code></td>
<td>
<p>list of explanatory variable numbers arranged in ascending
order of AIC.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsub</code></td>
<td>
<p>number of subsets of explanatory variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>list of subsets of explanatory variables in ascending order of
AIC with the following components:
</p>

<dl>
<dt>nv:</dt>
<dd>
<p>number of explanatory variables,</p>
</dd>
<dt>ncc:</dt>
<dd>
<p>number of categories,</p>
</dd>
<dt>aic:</dt>
<dd>
<p>AIC's,</p>
</dd>
<dt>exv:</dt>
<dd>
<p>explanatory variables,</p>
</dd>
<dt>vname:</dt>
<dd>
<p>explanatory variable names.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ctable</code></td>
<td>
<p>list of contingency table constructed by the best subset and additional
subsets if any variables is specified by <code>additional.output</code> with the following components:
</p>

<dl>
<dt>aic:</dt>
<dd>
<p>AIC of subset of explanatory variables,</p>
</dd>
<dt>exvar:</dt>
<dd>
<p>explanatory variables,</p>
</dd>
<dt>nrange:</dt>
<dd>
<p>number of intervals,</p>
</dd>
<dt>range:</dt>
<dd>
<p>class interval for continuous and discrete explanatory,</p>
</dd>
<dt>n:</dt>
<dd>
<p>contingency table values,</p>
</dd>
<dt>p:</dt>
<dd>
<p>ratio vales.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>missing</code></td>
<td>
<p>number of types of the missing values for each variable.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>K.Katsura and Y.Sakamoto (1980) <em>Computer Science Monograph, No.14,
CATDAP, A Categorical Data Analysis Program Package.</em>
The Institute of Statistical Mathematics.
</p>
<p>Y.Sakamoto (1985) <em>Model Analysis of Categorical Data.</em> Kyoritsu Shuppan
Co., Ltd., Tokyo. (in Japanese)
</p>
<p>Y.Sakamoto (1985) <em>Categorical Data Analysis by AIC.</em> Kluwer Academic
publishers.
</p>
<p><em>An AIC-based Tool for Data Visualization</em> (2015),
<a href="http://hdl.handle.net/10787/3614">NTT DATA Mathematical Systems Inc.</a>
(in Japanese)
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Example 1 (medical data "HealthData")
# as additional output, contingency tables for explanatory variable sets
# c("aortic.wav","min.press") and c("ecg","age") are obtained.

data(HealthData)
catdap2(HealthData, c(2, 2, 2, 0, 0, 0, 0, 2), "symptoms",
        c(0., 0., 0., 1., 1., 1., 0.1, 0.), ,
        list(c("aortic.wav", "min.press"), c("ecg", "age")))

# Example 2 (Edgar Anderson's Iris Data)
# continuous response variable handling and the usage of Barplot2WayTable
# function to visualize the result in shape of stacked histogram.

data(iris)  
resvar &lt;- "Petal.Width"
z &lt;- catdap2(iris, c(0, 0, 0, -7, 2), resvar, c(0.1, 0.1, 0.1, 0.1, 0))
z

exvar &lt;- c("Sepal.Length", "Petal.Length")
Barplot2WayTable(z, exvar)

# Example 3  (in the case of a large number of variables)
data(HelloGoodbye)
pool &lt;- rep(2, 56)

## using the default values of parameters pa1, pa2, pa3
## catdap2(HelloGoodbye, pool, "Isay", nvar = 10, print.level = 1, plot = 0) 
## Error : Working area for contingency table is too short, try pa1 = 12.

### According to the error message, set the parameter p1 at 12, then ..
catdap2(HelloGoodbye, pool, "Isay", nvar = 10, pa1 = 12, print.level = 1,
        plot = 0)

# Example 4 (HealthData with missing values)
data(MissingHealthData)
catdap2(MissingHealthData, c(2, 2, 2, 0, 0, 0, 0, 2), "symptoms",
        c(0., 0., 0., 1., 1., 1., 0.1, 0.), missingmark = 300)
</code></pre>


</div>