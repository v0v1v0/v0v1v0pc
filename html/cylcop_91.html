<div class="container">

<table style="width: 100%;"><tr>
<td>plot_joint_scat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Scatterplot of Turn Angles and Step Lengths</h2>

<h3>Description</h3>

<p>This function produces a scatterplot ('<code>ggplot</code>' object) of
the turn angles and step lengths.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_joint_scat(
  traj = NULL,
  theta = NULL,
  x = NULL,
  periodic = FALSE,
  plot_margins = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>traj</code></td>
<td>
<p>data.frame containing the trajectory produced by e.g.
<code>traj_sim()</code>. It must contain
the columns <code>traj$angle</code> and <code>traj$steplength</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>(alternatively) numeric vector of angles
(measurements of a circular variable).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>(alternatively) numeric vector of step lengths
(measurements of a linear variable).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>periodic</code></td>
<td>
<p>logical value denoting whether the plot should
be periodically extended past -pi and pi.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_margins</code></td>
<td>
<p>logical determining whether the marginal kernel
density estimates are computed and plotted. Alternatively, <code>plot_margins</code> can
be a list of length 2 containing first a kernel density estimate for <code>theta</code> and
second a kernel density estimate for <code>x</code>. The first entry must be of type
<code>'density.circular'</code> (as returned e.g. by <code>fit_angle(theta, parametric=FALSE))</code>,
and the second entry must be of type <code>"density"</code>
(as returned e.g. by <code>fit_steplength(x, parametric=FALSE))</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>You can either specify <code>traj</code> or the angels and step lengths
(<code>theta</code> and <code>x</code>).
If <code>plot_margins=T</code>, the code will attempt to find appropriate bandwidths for
the kernel density estimate autonomously, also taking into account computational time.
For more control over the actual method and parameters used to obtain the kernel
density estimates, you can calculate them "by hand" using e.g.
<code>fit_angle(theta, parametric=FALSE)</code>
and <code>fit_steplength(x, parametric=FALSE))</code>.
</p>


<h3>Value</h3>

<p>A '<code>ggplot</code>' object, the scatterplot.
</p>


<h3>References</h3>

<p>Hodel FH, Fieberg JR (2022).
“Circular-Linear Copulae for Animal Movement Data.”
<em>Methods in Ecology and Evolution</em>.
<a href="https://doi.org/10.1111/2041-210X.13821">doi:10.1111/2041-210X.13821</a>.
</p>
<p>Hodel FH, Fieberg JR (2021).
“Cylcop: An R Package for Circular-Linear Copulae with Angular Symmetry.”
<em>bioRxiv</em>.
<a href="https://doi.org/10.1101/2021.07.14.452253">doi:10.1101/2021.07.14.452253</a>, <a href="https://www.biorxiv.org/content/10.1101/2021.07.14.452253v3/">https://www.biorxiv.org/content/10.1101/2021.07.14.452253v3/</a>.
</p>


<h3>See Also</h3>

<p><code>plot_cop_scat()</code>, <code>plot_track()</code>,
<code>plot_joint_circ()</code>, <code>plot_cop_surf()</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(123)
traj &lt;- traj_sim(100,
  copula = cyl_quadsec(0.1),
  marginal_circ = list(name = "vonmises", coef  = list(0, 1)),
  marginal_lin = list(name = "weibull", coef = list(shape = 3))
)

plot1 &lt;- plot_joint_scat(traj)
plot2 &lt;- plot_joint_scat(traj, periodic = TRUE)
plot3 &lt;- plot_joint_scat(theta=traj$angle, x=traj$steplength, periodic = TRUE, plot_margins=TRUE)

bw &lt;- opt_circ_bw(theta = traj$angle, method = "nrd",kappa.est = "trigmoments")
ang_dens &lt;- fit_angle(theta=traj$angle, parametric=FALSE, bandwidth=bw)
step_dens &lt;- fit_steplength(x=traj$steplength, parametric=FALSE)
plot4 &lt;- plot_joint_scat(traj, periodic = TRUE, plot_margins=list(ang_dens, step_dens))

</code></pre>


</div>