<div class="container">

<table style="width: 100%;"><tr>
<td>two.level.density.LR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate the likelihood ratio using multivariate KDEs</h2>

<h3>Description</h3>

<p>Takes a <code>compitem</code> object which represents some control item, and a
<code>compitem</code> object which represents a recovered item, then uses information
from a <code>compcovar</code> object, which represents the
information from the population, to calculate a likelihood ratio as a measure
of the evidence given by the observations for the same/different source
propositions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">two.level.density.LR(control, recovered, background)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a <code>compitem</code> object with the control item information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>recovered</code></td>
<td>
<p>a <code>compitem</code> object with the recovered item information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>background</code></td>
<td>
<p>a <code>compcovar</code> object with the population information.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an estimate of the likelihood ratio
</p>


<h3>References</h3>

<p>Aitken, C.G.G. &amp; Lucy, D. (2004) Evaluation of trace evidence in the form of multivariate data. <em>Applied Statistics</em>: <b>53</b>(1); 109-122.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(comparison)
# load Greg Zadora's glass data
data(glass)

# calculate a compcovar object based upon glass
# using K, Ca and Fe - warning - could take time
# on slower machines
Z = two.level.components(glass, c(7,8,9), 1)

# calculate a compitem object representing the control item
control = two.level.comparison.items(glass[1:6,], c(7,8,9))

# calculate a compitem object representing the recovered item
# known to be from the same item (item 1)
recovered.1 = two.level.comparison.items(glass[7:12,], c(7,8,9))

# calculate a compitem object representing the recovered item
# known to be from a different item (item 2)
recovered.2 = two.level.comparison.items(glass[19:24,], c(7,8,9))


# calculate the likelihood ratio for a known
# same source comparison - should be 20.59322
# 2020-08-01 Both this version and the previous version return 20.58967
lr.1 = two.level.density.LR(control, recovered.1, Z)
lr.1

# calculate the likelihood ratio for a known
# different source comparison - should be 0.02901532
# 2020-08-01 Both this version and the previous version return 0.01161392
lr.2 = two.level.density.LR(control, recovered.2, Z)
lr.2
</code></pre>


</div>