<div class="container">

<table style="width: 100%;"><tr>
<td>EMPIRgridder</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Derivatives of the Grid of the Bivariate Empirical Copula for V with respect to U</h2>

<h3>Description</h3>

<p>Generate derivatives of <code class="reqn">V</code> with respect to <code class="reqn">U</code> of a gridded representation of the <em>bivariate empirical copula</em> (see <code>EMPIRcop</code>). This function is the empirical analog to <code>derCOP</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">EMPIRgridder(empgrid=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>empgrid</code></td>
<td>
<p>The grid from <code>EMPIRgrid</code>; and</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to pass.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The gridded values of the derivatives of the bivariate empirical copula.
</p>


<h3>Author(s)</h3>

<p>W.H. Asquith</p>


<h3>See Also</h3>

<p><code>EMPIRcop</code>, <code>EMPIRcopdf</code>, <code>EMPIRgrid</code>, <code>EMPIRgridder2</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
para   &lt;- list(alpha=0.15,  beta=0.65, cop1=PLACKETTcop, cop2=PLACKETTcop,
               para1=0.005, para2=1000)
uv &lt;- simCOP(n=1000, cop=composite2COP, para=para)
fakeU &lt;- lmomco::pp(uv[,1], sort=FALSE)
fakeV &lt;- lmomco::pp(uv[,2], sort=FALSE)
uv &lt;- data.frame(U=fakeU, V=fakeV)

"trans3d" &lt;-                         # blackslashes seem needed for the package
function(x,y,z, pmat) {              # for user manual building but bad syntax
  tmat &lt;- cbind(x,y,z,1) %*% pmat    # because remember the percent sign is a
  return(tmat[,1:2] / tmat[,4])      # a comment character in LaTeX.
}

the.grid &lt;- EMPIRgrid(para=uv, deluv=0.1)
the.diag &lt;- diagCOP(cop=EMPIRcop, para=uv, ploton=FALSE, lines=FALSE)
empcop &lt;- EMPIRcopdf(para=uv) # data.frame of all points

the.persp &lt;- persp(the.grid$empcop, theta=-25, phi=20,
                   xlab="U VARIABLE", ylab="V VARIABLE", zlab="COPULA C(u,v)")
points(trans3d(empcop$u, empcop$v, empcop$empcop, the.persp),
       col=rgb(0,1-sqrt(empcop$empcop),1,sqrt(empcop$empcop)), pch=16, cex=0.75)

# Now extract the copula sections
some.lines &lt;- trans3d(rep(0.2, length(the.grid$v)),
                      the.grid$v, the.grid$empcop[3,], the.persp)
lines(some.lines, lwd=2, col=2)
some.lines &lt;- trans3d(the.grid$u, rep(0.6, length(the.grid$u)),
                      the.grid$empcop[,7], the.persp)
lines(some.lines, lwd=2, col=3)
some.lines &lt;- trans3d(rep(0.7, length(the.grid$v)), the.grid$v,
                      the.grid$empcop[8,], the.persp)
lines(some.lines, lwd=2, col=6)

# Now compute some derivatives or conditional cumulative
# distribution functions
empder &lt;- EMPIRgridder(empgrid=the.grid)
some.lines &lt;- trans3d(rep(0.2, length(the.grid$v)), the.grid$v, empder[3,], the.persp)
lines(some.lines, lwd=4, col=2)

empder &lt;- EMPIRgridder2(empgrid=the.grid)
some.lines &lt;- trans3d(the.grid$u, rep(0.6, length(the.grid$u)), empder[,7], the.persp)
lines(some.lines, lwd=4, col=3)

empder &lt;- EMPIRgridder(empgrid=the.grid)
some.lines &lt;- trans3d(rep(0.7, length(the.grid$v)), the.grid$v, empder[8,], the.persp)
lines(some.lines, lwd=4, col=6)

# Demonstrate conditional quantile function extraction for
# the 70th percentile of U and see how it plots on top of
# the thick purple line
empinv &lt;- EMPIRgridderinv(empgrid=the.grid)
some.lines &lt;- trans3d(rep(0.7, length(the.grid$v)), empinv[8,],
                      attributes(empinv)$colnames, the.persp)
lines(some.lines, lwd=4, col=5, lty=2)#
## End(Not run)
</code></pre>


</div>