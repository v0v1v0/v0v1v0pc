<div class="container">

<table style="width: 100%;"><tr>
<td>ch_get_peaks</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extracts peak flows over a threshold</h2>

<h3>Description</h3>

<p>This function is development code being shared as is. It is expected that the user will be interested in the
data frame returned for POT analysis and for plotting (i.e. ch_booth_plot).
</p>
<p>This function retrieves peaks greater than or equal to the prescribed threshold.  It returns a data frame of peak characteristics
suitable for subsequent analysis.
</p>
<p>The portion under development is returns a list of the flows during an event with the values of the four
preceding days and three subsequent days. If the peak is a single point the fragment is nine points long; if the events is longer 
the fragment contains all days above the threshold and eight additional days.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ch_get_peaks(dataframe, threshold)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dataframe</code></td>
<td>
<p>a data frame of streamflow data containing columns named <span class="option">Date</span> and <span class="option">Flow</span></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>a value for the threshold. Values above the threshold are tested for peaks.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>POTevents</code></td>
<td>
<p>a dataframe contining details of the events</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>events</code></td>
<td>
<p>a vector with the value 0 when the flow is below the threshold and 1 when above.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>event_num</code></td>
<td>
<p>a vector with the value 0 when the flow is below a threshold or the index of the events when the threshold was exceeded. i.e. 1,2,3, etc</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>st_date</code></td>
<td>
<p>start date of events</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>case</code></td>
<td>
<p>a list of the daily flows in each individual event (see details for more information)</p>
</td>
</tr>
</table>
<p>The <code>POTevents</code> data frame contains five columns: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>st_date</code></td>
<td>
<p>starting date of event</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_date</code></td>
<td>
<p>date of maximum in the event</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max</code></td>
<td>
<p>maximum discharge during event</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>volume</code></td>
<td>
<p>flow volume during the event</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>duration</code></td>
<td>
<p>length of the event in days</p>
</td>
</tr>
</table>
<p>The <code>case</code> list contains the flows during an event and also for four preceding and subsequent days. Each event will have
a length between nine to n days in length. Note: in rare cases where the event is in progress when data becomes available the 
event might be shorter than nine days long.
</p>


<h3>Author(s)</h3>

<p>Paul Whitfield
</p>


<h3>References</h3>

<p>Burn, D.H., Whitfield, P.H., Sharif, M., 2016. Identification of changes in floods and flood regimes
in Canada using a peaks over threshold approach. Hydrological Processes, 39: 3303-3314. DOI:10.1002/hyp.10861
</p>
<p>Whitfield, P.H., and J.W. Pomeroy. 2016. Changes to flood peaks of a mountain river: implications
for analysis of the 2013 flood in the Upper Bow River, Canada. Hydrological Processes 30:4657-73. doi:
10.1002/hyp.10957.
</p>


<h3>See Also</h3>

<p><code>ch_booth_plot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">CAN05AA008 &lt;- CAN05AA008
threshold &lt;- 0.5*max(CAN05AA008$Flow)  # arbitrary threshold
my_peaks &lt;- ch_get_peaks(CAN05AA008, threshold)
str(my_peaks)
</code></pre>


</div>