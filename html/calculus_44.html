<div class="container">

<table style="width: 100%;"><tr>
<td>ode</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Ordinary Differential Equations</h2>

<h3>Description</h3>

<p>Solves a numerical or symbolic system of ordinary differential equations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ode(
  f,
  var,
  times,
  timevar = NULL,
  params = list(),
  method = "rk4",
  drop = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>vector of <code>characters</code>, or a <code>function</code> returning a numeric vector, giving the values of the derivatives in the ODE system at time <code>timevar</code>. See examples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>
<p>vector giving the initial conditions. See examples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>
<p>discretization sequence, the first value represents the initial time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timevar</code></td>
<td>
<p>the time variable used by <code>f</code>, if any.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>
<p><code>list</code> of additional parameters passed to <code>f</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the solver to use. One of <code>"rk4"</code> (Runge-Kutta) or <code>"euler"</code> (Euler).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop</code></td>
<td>
<p>if <code>TRUE</code>, return only the final solution instead of the whole trajectory.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Vector of final solutions if <code>drop=TRUE</code>, otherwise a <code>matrix</code> with as many 
rows as elements in <code>times</code> and as many columns as elements in <code>var</code>.
</p>


<h3>References</h3>

<p>Guidotti E (2022). "calculus: High-Dimensional Numerical and Symbolic Calculus in R." Journal of Statistical Software, 104(5), 1-37. <a href="https://doi.org/10.18637/jss.v104.i05">doi:10.18637/jss.v104.i05</a>
</p>


<h3>See Also</h3>

<p>Other integrals: 
<code>integral()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## ==================================================
## Example: symbolic system 
## System:  dx = x dt
## Initial: x0 = 1
## ==================================================
f &lt;- "x"
var &lt;- c(x=1)
times &lt;- seq(0, 2*pi, by=0.001)
x &lt;- ode(f, var, times)
plot(times, x, type = "l")

## ==================================================
## Example: time dependent system
## System:  dx = cos(t) dt
## Initial: x0 = 0
## ==================================================
f &lt;- "cos(t)"
var &lt;- c(x=0)
times &lt;- seq(0, 2*pi, by=0.001)
x &lt;- ode(f, var, times, timevar = "t")
plot(times, x, type = "l")

## ==================================================
## Example: multivariate time dependent system
## System:  dx = x dt 
##          dy = x*(1+cos(10*t)) dt
## Initial: x0 = 1
##          y0 = 1
## ==================================================
f &lt;- c("x", "x*(1+cos(10*t))")
var &lt;- c(x=1, y=1)
times &lt;- seq(0, 2*pi, by=0.001)
x &lt;- ode(f, var, times, timevar = "t")
matplot(times, x, type = "l", lty = 1, col = 1:2)

## ==================================================
## Example: numerical system
## System:  dx = x dt 
##          dy = y dt 
## Initial: x0 = 1
##          y0 = 2
## ==================================================
f &lt;- function(x, y) c(x, y)
var &lt;- c(x=1, y=2)
times &lt;- seq(0, 2*pi, by=0.001)
x &lt;- ode(f, var, times)
matplot(times, x, type = "l", lty = 1, col = 1:2)

## ==================================================
## Example: vectorized interface
## System:  dx = x dt 
##          dy = y dt 
##          dz = y*(1+cos(10*t)) dt  
## Initial: x0 = 1
##          y0 = 2
##          z0 = 2
## ==================================================
f &lt;- function(x, t) c(x[1], x[2], x[2]*(1+cos(10*t)))
var &lt;- c(1,2,2)
times &lt;- seq(0, 2*pi, by=0.001)
x &lt;- ode(f, var, times, timevar = "t")
matplot(times, x, type = "l", lty = 1, col = 1:3)

</code></pre>


</div>