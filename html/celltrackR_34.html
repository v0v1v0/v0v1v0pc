<div class="container">

<table style="width: 100%;"><tr>
<td>distanceToPlane</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Distance to a Reference Plane</h2>

<h3>Description</h3>

<p>Compute the (shortest) distance between the starting point of a track and a reference plane.
Useful to detect directed movement and/or tracking artefacts.
</p>


<h3>Usage</h3>

<pre><code class="language-R">distanceToPlane(x, p1 = c(0, 0, 0), p2 = c(0, 1, 0), p3 = c(1, 0, 0), from = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a single input track; a matrix whose first column is time and whose
remaining columns are a spatial coordinate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p1, p2, p3</code></td>
<td>
<p>numeric vectors of coordinates of three points specifying a reference plane to
compute distances to.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>from</code></td>
<td>
<p>index, or vector of indices, of the first row of the track. If
<code>from</code> is a vector, distances are returned for all steps starting at
the indices in <code>from</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A single distance.
</p>


<h3>See Also</h3>

<p><code>angleToPlane</code> to compute the angle to the plane, and
<code>AngleAnalysis</code> for other methods to compute angles and distances.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Plotting the angle versus the distance to a reference plane can be informative to
## detect tracking artefacts near the border of the imaging volume.
## We should be suspicious especially when small angles are more frequent at low distances
## to the border planes.
load( system.file("extdata", "TCellsRaw.rda", package="celltrackR" ) )
steps &lt;- subtracks( TCellsRaw, 1 )
minz &lt;- boundingBox( TCellsRaw )["min","z"]
## Compute angles and distances to the lower plane in z-dimension
angles &lt;- sapply( steps, angleToPlane, p1 = c(0,0,minz), p2 = c(1,0,minz), p3 = c(0,1,minz) )
distances &lt;- sapply( steps, distanceToPlane, p1 = c(0,0,minz), p2 = c(1,0,minz), p3 = c(0,1,minz) )
scatter.smooth( distances, angles )
abline( h = 32.7, col = "red" )
</code></pre>


</div>