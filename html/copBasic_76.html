<div class="container">

<table style="width: 100%;"><tr>
<td>joint.curvesCOP2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute Coordinates of the Marginal Probabilities given joint AND or OR Probability</h2>

<h3>Description</h3>

<p>Compute the coordinates of the bivariate marginal probabilities for variables <code class="reqn">U</code> and <code class="reqn">V</code> given selected probabilities levels <code class="reqn">t</code> for a copula <code class="reqn">\mathbf{C}(u,v)</code> for <code class="reqn">u</code> with respect to <code class="reqn">v</code>. For the case of a <b>joint and</b> probability, symbolically the solution is
</p>
<p style="text-align: center;"><code class="reqn">\mathrm{Pr}[U \le v,\ V \le v] = t = \mathbf{C}(u,v)\mbox{,}</code>
</p>

<p>where <code class="reqn">V \mapsto [t_i, t_{j}, t_{j+1}, \cdots, 1; \Delta]</code> (an irregular sequence of <code class="reqn">v</code> values from the <code class="reqn">i</code>th value of <code class="reqn">t_i</code> provided through to unity) and thus
</p>
<p style="text-align: center;"><code class="reqn">t_i \mapsto \mathbf{C}(u, v=V)\mbox{,}</code>
</p>

<p>and solving for the sequence of <code class="reqn">u</code>. The index <code class="reqn">j</code> is to indicate that a separate loop is involved and is distinct from <code class="reqn">i</code>. The pairings <code class="reqn">\{u(t_i), v(t_i)\}</code> for each <code class="reqn">t</code> are packaged as an <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> <code>data.frame</code>. This operation is very similiar to the plotting capabilities in <code>level.curvesCOP2</code> for <em>level curves</em> (Nelsen, 2006, pp. 12–13) but implemented in the function <code>joint.curvesCOP2</code> for alternative utility.
</p>
<p>For the case of a <b>joint or</b> probability, the <em>dual of a copula (function)</em> or <code class="reqn">\tilde{\mathbf{C}}(u,v)</code> from a copula (Nelsen, 2006, pp. 33–34) is used and symbolically the solution is:
</p>
<p style="text-align: center;"><code class="reqn">\mathrm{Pr}[U \le v \mathrm{\ or\ } V \le v] = t = \tilde{\mathbf{C}}(u,v) = u + v - \mathbf{C}(u,v)\mbox{,}</code>
</p>

<p>where <code class="reqn">V \mapsto [0, v_j, v_{j+1}, \cdots, t_i; \Delta]</code> (an irregular sequence of <code class="reqn">v</code> values from zero through to the <code class="reqn">i</code>th value of <code class="reqn">t</code>) and thus
</p>
<p style="text-align: center;"><code class="reqn">t_i \mapsto \tilde{\mathbf{C}}(u, v=V)\mbox{,}</code>
</p>

<p>and solving for the sequence of <code class="reqn">u</code>.  The index <code class="reqn">j</code> is to indicate that a separate loop is involved and is distinct from <code class="reqn">i</code>. The pairings <code class="reqn">\{u(t_i), v(t_i)\}</code> for each <code class="reqn">t</code> are packaged as an <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> <code>data.frame</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">joint.curvesCOP2(cop=NULL, para=NULL, type=c("and", "or"),
                 probs=c(0.5, 0.8, 0.90, 0.96, 0.98, 0.99, 0.995, 0.998),
                 zero2small=TRUE, small=1E-6, divisor=100, delv=0.001, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cop</code></td>
<td>
<p>A copula function;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>para</code></td>
<td>
<p>Vector of parameters or other data structure, if needed, to pass to the copula;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>What type of joint probability is to be computed;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>
<p>The joint probabilities for which to compute the coordinates. The default values represent especially useful annual return period equivalents that are useful in hydrologic risk analyses;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zero2small</code></td>
<td>
<p>A logical controlling whether precise zero value for probability are converted to a <code>small</code> value and precise unity values for probability are converted to the value <code>1 - small</code>; this logical is useful if transformation from probability space into standard normal variates or <em>Gumbel reduced variates</em> (GRV; see function <code>prob2grv()</code> in package <span class="pkg">lmomco</span>) is later desired by the user for attendant graphics (see <b>Examples</b> section);</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>small</code></td>
<td>
<p>The value for <em>small</em> described for <code>zero2small</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>divisor</code></td>
<td>
<p>A divisor on a computation of a <code class="reqn">\Delta</code> for incrementing through the <code class="reqn">v</code> domain as part of the coordinate computation (see source code);</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delv</code></td>
<td>
<p>A <code class="reqn">\Delta v</code> for setup of the incrementing through the <code class="reqn">v</code> domain as part of the coordinate computation (see source code); and</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to pass to the <code>duCOP</code> function of <span class="pkg">copBasic</span> or <code>uniroot()</code> function.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> <code>list</code> is returned with elements each of the given <code>probs</code>.
</p>


<h3>Author(s)</h3>

<p>W.H. Asquith</p>


<h3>References</h3>

<p>Nelsen, R.B., 2006, An introduction to copulas: New York, Springer, 269 p.
</p>


<h3>See Also</h3>

<p><code>diagCOPatf</code>, <code>duCOP</code>, <code>jointCOP</code>, <code>joint.curvesCOP</code>, <code>level.curvesCOP2</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># See Note for joint.curvesCOP()
## Not run: 
# Approach the joint curves from both "with respect two" perspectives---results same.
JCvwrtu &lt;- joint.curvesCOP( cop=PSP, prob=0.98)$"0.98"
JCuwrtv &lt;- joint.curvesCOP2(cop=PSP, prob=0.98)$"0.98"; lim &lt;- c(2,5)
plot(qnorm(JCvwrtu$U), qnorm(JCvwrtu$V), type="l", lwd=6, col=8, xlim=lim, ylim=lim,
     xlab="STANDARD NORMAL VARIATE OF U", ylab="STANDARD NORMAL VARIATE OF V")
lines(qnorm(JCuwrtv$U), qnorm(JCuwrtv$V), col=2, lwd=2)
mtext("98th Joint Percentile Level Curve for PSP Copula")#
## End(Not run)
</code></pre>


</div>