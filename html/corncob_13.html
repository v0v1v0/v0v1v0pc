<div class="container">

<table style="width: 100%;"><tr>
<td>differentialTest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Identify differentially-abundant and differentially-variable taxa</h2>

<h3>Description</h3>

<p>Identify differentially-abundant and differentially-variable taxa
</p>


<h3>Usage</h3>

<pre><code class="language-R">differentialTest(
  formula,
  phi.formula,
  formula_null,
  phi.formula_null,
  data,
  link = "logit",
  phi.link = "logit",
  test,
  boot = FALSE,
  B = 1000,
  sample_data = NULL,
  taxa_are_rows = TRUE,
  filter_discriminant = TRUE,
  fdr_cutoff = 0.05,
  fdr = "fdr",
  full_output = FALSE,
  inits = NULL,
  inits_null = NULL,
  try_only = NULL,
  verbose = FALSE,
  robust = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class <code>formula</code> without the response: a symbolic description of the model to be fitted to the abundance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi.formula</code></td>
<td>
<p>an object of class <code>formula</code> without the response: a symbolic description of the model to be fitted to the dispersion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula_null</code></td>
<td>
<p>Formula for mean under null, without response</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi.formula_null</code></td>
<td>
<p>Formula for overdispersion under null, without response</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame containing the OTU table, or <code>phyloseq</code> object containing the variables in the models</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>
<p>link function for abundance covariates, defaults to <code>"logit"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi.link</code></td>
<td>
<p>link function for dispersion covariates, defaults to <code>"logit"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>Character. Hypothesis testing procedure to use. One of <code>"Wald"</code>, <code>"LRT"</code> (likelihood ratio test), or <code>"Rao"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot</code></td>
<td>
<p>Boolean. Defaults to <code>FALSE</code>. Indicator of whether or not to use parametric bootstrap algorithm. (See <code>pbWald</code> and <code>pbLRT</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>Optional integer. Number of bootstrap iterations. Ignored if <code>boot</code> is <code>FALSE</code>. Otherwise, defaults to <code>1000</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample_data</code></td>
<td>
<p>Data frame or matrix. Defaults to <code>NULL</code>. If <code>data</code> is a data frame or matrix, this must be included as covariates/sample data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taxa_are_rows</code></td>
<td>
<p>Boolean. Optional. If <code>data</code> is a data frame or matrix, this indicates whether taxa are rows. Defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filter_discriminant</code></td>
<td>
<p>Boolean. Defaults to <code>TRUE</code>. If <code>FALSE</code>, discriminant taxa will not be filtered out.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fdr_cutoff</code></td>
<td>
<p>Integer. Defaults to <code>0.05</code>. Desired false discovery rate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fdr</code></td>
<td>
<p>Character. Defaults to <code>"fdr"</code>. False discovery rate control method, see <code>p.adjust</code> for more options.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>full_output</code></td>
<td>
<p>Boolean. Opetional. Defaults to <code>FALSE</code>. Indicator of whether to include full <code>bbdml</code> model output for all taxa.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inits</code></td>
<td>
<p>Optional initializations for model fit using <code>formula</code> and <code>phi.formula</code> as rows of a matrix. Defaults to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inits_null</code></td>
<td>
<p>Optional initializations for model fit using <code>formula_null</code> and <code>phi.formula_null</code> as rows of a matrix. Defaults to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>try_only</code></td>
<td>
<p>Optional numeric. Will try only the <code>try_only</code> taxa, specified either via numeric input or character taxa names. Useful for speed when troubleshooting. Defaults to <code>NULL</code>, testing all taxa.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Boolean. Defaults to <code>FALSE</code>; print status updates for long-running analyses</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust</code></td>
<td>
<p>Should robust standard errors be used? If not, model-based standard errors are used. Logical, defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Optional additional arguments for <code>bbdml</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See package vignette for details and example usage. Make sure the number of columns in all of the initializations are correct! <code>inits</code> probably shouldn't match <code>inits_null</code>. To use a contrast matrix, see <code>contrastsTest</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>differentialTest</code>. List with elements <code>p</code> containing the p-values, <code>p_fdr</code> containing the p-values after false discovery rate control,  <code>significant_taxa</code> containing the taxa names of the statistically significant taxa, <code>significant_models</code> containing a list of the model fits for the significant taxa, <code>all_models</code> containing a list of the model fits for all taxa, <code>restrictions_DA</code> containing a list of covariates that were tested for differential abundance, <code>restrictions_DV</code> containing a list of covariates that were tested for differential variability, <code>discriminant_taxa_DA</code> containing the taxa for which at least one covariate associated with the abundance was perfectly discriminant, <code>discriminant_taxa_DV</code> containing the taxa for which at least one covariate associated with the dispersion was perfectly discriminant, <code>data</code> containing the data used to fit the models. If <code>full_output = TRUE</code>, it will also include <code>full_output</code>, a list of all model output from <code>bbdml</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# data frame example
data(soil_phylum_small_sample)
data(soil_phylum_small_otu)
da_analysis &lt;- differentialTest(formula = ~ DayAmdmt,
                                phi.formula = ~ DayAmdmt,
                                formula_null = ~ 1,
                                phi.formula_null = ~ DayAmdmt,
                                test = "Wald", boot = FALSE,
                                data = soil_phylum_small_otu,
                                sample_data = soil_phylum_small_sample,
                                fdr_cutoff = 0.05,
                                try_only = 1:5)

# phyloseq example (only run if you have phyloseq installed)
## Not run: 
data_phylo &lt;- phyloseq::phyloseq(phyloseq::sample_data(soil_phylum_small_sample),
phyloseq::otu_table(soil_phylum_small_otu, taxa_are_rows = TRUE))
da_analysis &lt;- differentialTest(formula = ~ DayAmdmt,
                               phi.formula = ~ DayAmdmt,
                               formula_null = ~ 1,
                               phi.formula_null = ~ DayAmdmt,
                               test = "Wald", boot = FALSE,
                               data = data_phylo,
                               fdr_cutoff = 0.05,
                               try_only = 1:5)

## End(Not run)

</code></pre>


</div>