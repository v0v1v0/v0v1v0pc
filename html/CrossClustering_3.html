<div class="container">

<table style="width: 100%;"><tr>
<td>cc_crossclustering</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>A partial clustering algorithm with automatic estimation of the
number of clusters and identification of outliers</h2>

<h3>Description</h3>

<p>This function performs the CrossClustering algorithm. This method
combines the Ward's minimum variance and Complete-linkage (default,
useful for finding spherical clusters) or Single-linkage (useful for
finding elongated clusters) algorithms, providing automatic
estimation of a suitable number of clusters and identification of
outlier elements.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cc_crossclustering(
  dist,
  k_w_min = 2,
  k_w_max = attr(dist, "Size") - 2,
  k2_max = k_w_max + 1,
  out = TRUE,
  method = c("complete", "single")
)

## S3 method for class 'crossclustering'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>
<p>A dissimilarity structure as produced by the function
<code>dist</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k_w_min</code></td>
<td>
<p>(int) Minimum number of clusters for the Ward's
minimum variance method. By default is set equal 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k_w_max</code></td>
<td>
<p>(int) Maximum number of clusters for the Ward's
minimum variance method (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k2_max</code></td>
<td>
<p>(int) Maximum number of clusters for the
Complete/Single-linkage method. It can not be equal or greater than
the number of elements to cluster (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out</code></td>
<td>
<p>(lgl) If <code>TRUE</code> (default) outliers must be searched
(see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>(chr) "complete" (default) or "single". CrossClustering
combines Ward's algorithm with Complete-linkage if method is set to
"complete", otherwise (if method is set to 'single') Single-linkage
will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object used to select a method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See cited document for more details.
</p>


<h3>Value</h3>

<p>A list of objects describing characteristics of the
partitioning as follows:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Optimal_cluster</code></td>
<td>
<p>number of clusters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster_list_elements</code></td>
<td>
<p>a list of clusters; each element of this
lists contains the indices of the elements belonging to the
cluster</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Silhouette</code></td>
<td>
<p>the average silhouette width over all the clusters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_total</code></td>
<td>
<p>total number of input elements</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_clustered</code></td>
<td>
<p>number of input elements that have actually
been clustered</p>
</td>
</tr>
</table>
<h3>Functions</h3>


<ul><li> <p><code>print(crossclustering)</code>: 
</p>
</li></ul>
<h3>Author(s)</h3>

<p>Paola Tellaroli, &lt;paola <code>dot</code> tellaroli <code>at</code> unipd <code>dot</code> it&gt;;;
Marco Bazzi, &lt;bazzi <code>at</code> stat <code>dot</code> unipd <code>dot</code> it&gt;;
Michele Donato, &lt;mdonato <code>at</code> stanford <code>dot</code> edu&gt;
</p>


<h3>References</h3>

<p>Tellaroli P, Bazzi M., Donato M., Brazzale A. R., Draghici S. (2016).
Cross-Clustering: A Partial Clustering Algorithm with Automatic
Estimation of the Number of Clusters. PLoS ONE 11(3):   e0152333.
doi:10.1371/journal.pone.0152333
</p>
<p>#' Tellaroli P, Bazzi M., Donato M., Brazzale A. R., Draghici S. (2017).
E1829: Cross-Clustering: A Partial Clustering Algorithm with Automatic
Estimation of the Number of Clusters. CMStatistics 2017, London 16-18
December, Book of Abstracts (ISBN 978-9963-2227-4-2)
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(CrossClustering)

#### Example of Cross-Clustering as in reference paper
#### method = "complete"

data(toy)

### toy is transposed as we want to cluster samples (columns of the
### original matrix)
toy_dist &lt;- t(toy) |&gt;
  dist(method = "euclidean")

### Run CrossClustering
cc_crossclustering(
  toy_dist,
  k_w_min = 2,
  k_w_max = 5,
  k2_max = 6,
  out = TRUE
)

#### Simulated data as in reference paper
#### method = "complete"
set.seed(10)
sg &lt;- c(500, 250, 700, 300, 100)

# 5 clusters

t &lt;- matrix(0, nrow = 5, ncol = 5)
t[1, ] &lt;- rep(6, 5)
t[2, ] &lt;- c( 0,  5, 12, 13, 15)
t[3, ] &lt;- c(15, 11,  9,  5,  0)
t[4, ] &lt;- c( 6, 12, 15, 10,  5)
t[5, ] &lt;- c(12, 17,  3,  7, 10)

t_mat &lt;- NULL
for (i in seq_len(nrow(t))) {
  t_mat &lt;- rbind(
    t_mat,
    matrix(rep(t[i, ], sg[i]), nrow = sg[i], byrow = TRUE)
  )
}

data_15 &lt;- matrix(NA, nrow = 2000, ncol = 5)
data_15[1:1850, ] &lt;- matrix(
  abs(rnorm(sum(sg) * 5, sd = 1.5)),
  nrow = sum(sg),
  ncol = 5
) + t_mat

set.seed(100) # simulate outliers
data_15[1851:2000, ] &lt;- matrix(
  runif(n = 150 * 5, min = 0, max = max(data_15, na.rm = TRUE)),
  nrow = 150,
  ncol = 5
)

### Run CrossClustering
cc_crossclustering(
  dist(data_15),
  k_w_min = 2,
  k_w_max = 19,
  k2_max = 20,
  out = TRUE
)


#### Correlation-based distance is often used in gene expression time-series
### data analysis. Here there is an example, using the "complete" method.

data(nb_data)
nb_dist &lt;- as.dist(1 - abs(cor(t(nb_data))))
cc_crossclustering(dist = nb_dist, k_w_max = 20, k2_max = 19)




#### method = "single"
### Example on a famous shape data set
### Two moons data

data(twomoons)

moons_dist &lt;- twomoons[, 1:2] |&gt;
  dist(method = "euclidean")

cc_moons &lt;- cc_crossclustering(
  moons_dist,
  k_w_max = 9,
  k2_max = 10,
  method = 'single'
)

moons_col &lt;- cc_get_cluster(cc_moons)
plot(
  twomoons[, 1:2],
  col = moons_col,
  pch      = 19,
  xlab     = "",
  ylab     = "",
  main     = "CrossClustering-Single"
)

### Worms data
data(worms)

worms_dist &lt;- worms[, 1:2] |&gt;
  dist(method = "euclidean")

cc_worms &lt;- cc_crossclustering(
  worms_dist,
  k_w_max = 9,
  k2_max  = 10,
  method  = "single"
)

worms_col &lt;-  cc_get_cluster(cc_worms)

plot(
  worms[, 1:2],
  col = worms_col,
  pch = 19,
  xlab = "",
  ylab = "",
  main = "CrossClustering-Single"
)


### CrossClustering-Single is not affected to chain-effect problem

data(chain_effect)

chain_dist &lt;- chain_effect |&gt;
  dist(method = "euclidean")
cc_chain &lt;- cc_crossclustering(
  chain_dist,
  k_w_max = 9,
  k2_max = 10,
  method = "single"
)

chain_col &lt;- cc_get_cluster(cc_chain)

plot(
  chain_effect,
  col = chain_col,
  pch = 19,
  xlab = "",
  ylab = "",
  main = "CrossClustering-Single"
)

</code></pre>


</div>