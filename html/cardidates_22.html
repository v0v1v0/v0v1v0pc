<div class="container">

<table style="width: 100%;"><tr>
<td>metaCDW</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extract Cardinal Dates of Multiple Time Series at Once Using Fitted Weibull Curves</h2>

<h3>Description</h3>

<p><code>metaCDW</code> determines the relevant peak of 
several time series and fits four- resp. six-parametric 
Weibull curves to these peaks of all series at once and extracts “cardinal dates” from
the fitted curves. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">metaCDW(dat, method = "weibull6", xstart = 55, xmin = 0, xmax = 365, 
        minpeak = 0.1, mincut = 0.382,
        quantile = 0.05, symmetric = FALSE, p0 = NULL, linint = -1, 
        findpeak = TRUE, maxit = 2000)
## S3 method for class 'cardiMetacdw'
summary(object, file="", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>a <code>data.frame</code> containig the columns: 
<code>sample</code> (description of the timeseries such as year, water body, or any 
other code (should be numeric or factor),
<code>x</code> (the independend variable, e.g. Julian day of the year),
<code>y</code> (the dependend variable, e.g. phytoplankton biovolume)
and an optional column <code>flag</code> (of type <code>boolean</code> indicating whether
a data point should be included in analysis),</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>either "weibull6" or "weibull4",</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xstart</code></td>
<td>
<p>offset (day of year) for the "spring" peak; either a single 
numeric value for all years or a vector of the same length as number of samples,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xmin</code></td>
<td>
<p>left boundary (in day of year) of the integral under the curve,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xmax</code></td>
<td>
<p>right boundary (in day of year) of the integral under the curve,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quantile</code></td>
<td>
<p>two-sided quantile (percentage of integral)
which defines beginning and end of the peak,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minpeak</code></td>
<td>
<p>minimum value of the total maximum which is regarded as peak
(default value is derived from golden section),</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mincut</code></td>
<td>
<p>minimum relative height of a pit compared to the lower of the
two neighbouring maxima at which these maxima are regarded as separate peaks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>symmetric</code></td>
<td>
<p>if (<code>TRUE</code>), quantiles are calculated for the whole area
under the curve, otherwise for each of the branches separately.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p0</code></td>
<td>
<p>initial parameters for optimization. In case of <code>p0 = NULL</code>
a heuristic algorithm to derive initial values is used for <code>fitweibull6</code>,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linint</code></td>
<td>
<p>control parameter to select interpolation behavior.
Negative values (default) specify automatic selection heuristic,
zero disables interpolation. A positive value is interpreted as mandatory
interpolation time step.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>maximum number of iterations passed to the optimisation functions,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>findpeak</code></td>
<td>
<p>a logical value indicating whether the relevant peaks of the time series
should be identified automatically with <code>peakwindow</code> 
before the computation proceeds,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>a result from a call to <code>metaCDW</code>,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>file name where the data are to be written to, defaults to screen,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other parameters of <code>summary</code> passed to <code>write</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is a top-level function which calls <code>peakwindow</code>,
<code>fitweibull</code> and
<code>CDW</code> for a series of data sets and returns
a table (<code>data frame</code>) of all results.
</p>


<h3>Value</h3>

<p>A list with components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>metares</code></td>
<td>
<p>data frame with cardinal dates and fitted parameters, 
see  <code>CDW</code> for details,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weibullfits</code></td>
<td>
<p>list of fit details for all fits, 
see <code>fitweibull</code> for details.</p>
</td>
</tr>
</table>
<h3>See Also</h3>


<p><code>weibull4</code>,
<code>weibull6</code>,
<code>fitweibull</code>,
<code>peakwindow</code>,
<code>CDW</code>,

<code>cardidates</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## open test data set (3 years) with 4 columns
## sample, x, y, flag
data(carditest)
dat &lt;- carditest

## alternatively: import data from spreadsheet via the clipboard
# dat &lt;- read.table("clipboard", sep = "\t", header = TRUE)

## or, for languages with comma as decimal separator:
# dat &lt;- read.table("clipboard", sep = "\t", header = TRUE, dec = ",")

## Note: as.numeric recodes factor year to numeric value
plot(as.numeric(dat$sample)*365 + dat$x, dat$y, type = "b")

## do the analysis
tt &lt;- metaCDW(dat, xstart = 55)

## plot results
par(mfrow=c(1, 3))
lapply(tt$weibullfits, plot)

## return table of results
summary(tt)

## Not run: 
## copy to clipboard in spreadsheet compatible format
summary(tt, file = "clipboard", sep = "\t", quote = FALSE, row.names = FALSE)

## or, for languages with comma as decimal separator:
#summary(tt, file = "clipboard", sep = "\t", dec = ",",
#  quote = FALSE, row.names = FALSE)

## End(Not run)
</code></pre>


</div>