<div class="container">

<table style="width: 100%;"><tr>
<td>d.rel.conn.beta.prior</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate the probability distribution of relative connectivity values 
assuming a Beta-distributed prior</h2>

<h3>Description</h3>

<p>These functions calculate the probability density function 
(<code>d.rel.conn.beta.prior</code>), the probability distribution function (aka 
the cumulative distribution function; <code>p.rel.conn.beta.prior</code>) and the 
quantile function (<code>q.rel.conn.beta.prior</code>) for the relative (to all 
settlers at the destination site) connectivity value for larval transport 
between a source and destination site given a known fraction of marked 
individuals (i.e., eggs) in the source population.  A non-uniform prior is 
used for the relative connectivity value.
</p>


<h3>Usage</h3>

<pre><code class="language-R">d.rel.conn.beta.prior(
  phi,
  p,
  k,
  n,
  prior.shape1 = 0.5,
  prior.shape2 = prior.shape1,
  prior.func = function(phi) dbeta(phi, prior.shape1, prior.shape2),
  ...
)

p.rel.conn.beta.prior(
  phi,
  p,
  k,
  n,
  prior.shape1 = 0.5,
  prior.shape2 = prior.shape1,
  prior.func = function(phi) dbeta(phi, prior.shape1, prior.shape2),
  ...
)

q.rel.conn.beta.prior.func(
  p,
  k,
  n,
  prior.shape1 = 0.5,
  prior.shape2 = prior.shape1,
  prior.func = function(phi) dbeta(phi, prior.shape1, prior.shape2),
  N = 1000,
  ...
)

q.rel.conn.beta.prior(
  q,
  p,
  k,
  n,
  prior.shape1 = 0.5,
  prior.shape2 = prior.shape1,
  prior.func = function(phi) dbeta(phi, prior.shape1, prior.shape2),
  N = 1000,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>Vector of fractions of individuals (i.e., eggs) from the source 
population settling at the destination population</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Fraction of individuals (i.e., eggs) marked in the source population</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Number of marked settlers found in sample</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Total number of settlers collected</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior.shape1</code></td>
<td>
<p>First shape parameter for Beta distributed prior. 
Defaults to 0.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior.shape2</code></td>
<td>
<p>Second shape parameter for Beta distributed prior. 
Defaults to being the same as <code>prior.shape1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior.func</code></td>
<td>
<p>Function for prior distribution.  Should take one 
parameter, <code>phi</code>, and return a probability.  Defaults to 
<code>function(phi) dbeta(phi,prior.shape1,prior.shape2)</code>.  If this is
specified, then inputs <code>prior.shape1</code> and <code>prior.shape2</code> are
ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Extra arguments for the <code>integrate</code> function used 
for normalization of probability distributions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Number of points at which to estimate cumulative probability 
function for reverse approximation of quantile distribution. Defaults to 
<code>1000</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>Vector of quantiles</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The prior distribution for relative connectivity <code>phi</code> defaults to a 
Beta distribution with both shape parameters equal to 0.5.  This is the 
Reference or Jeffreys prior for a binomial distribution parameter.  Both 
shape parameters equal to 1 corresponds to a uniform prior.
</p>
<p>Estimations of the probability distribution are based on numerical 
integration using the <code>integrate</code> function, and therefore are 
accurate to the level of that function.  Some modification of the default 
arguments to that function may be necessary to acheive good results for 
certain parameter values.
</p>


<h3>Value</h3>

<p>Vector of probabilities or quantiles, or a function in the case of 
<code>q.rel.conn.beta.prior.func</code>.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>d.rel.conn.beta.prior</code>: Returns the probability density for 
relative connectivity between a pair of sites
</p>
</li>
<li> <p><code>p.rel.conn.beta.prior</code>: Returns the cumulative probability
distribution for relative connectivity between a paire of sites
</p>
</li>
<li> <p><code>q.rel.conn.beta.prior.func</code>: Returns a function to estimate quantiles for
the probability distribution function for relative connectivity between a
pair of sites.
</p>
</li>
<li> <p><code>q.rel.conn.beta.prior</code>: Estimates quantiles for the probability
distribution function for relative connectivity between a pair of sites
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>David M. Kaplan <a href="mailto:dmkaplan2000@gmail.com">dmkaplan2000@gmail.com</a>
</p>


<h3>References</h3>

<p>Kaplan DM, Cuif M, Fauvelot C, Vigliola L, Nguyen-Huu T, Tiavouane J and Lett C 
(in press) Uncertainty in empirical estimates of marine larval connectivity. 
ICES Journal of Marine Science. doi:10.1093/icesjms/fsw182.
</p>


<h3>See Also</h3>

<p>Other connectivity estimation: 
<code>d.rel.conn.dists.func()</code>,
<code>d.rel.conn.finite.settlement()</code>,
<code>d.rel.conn.multinomial.unnorm()</code>,
<code>d.rel.conn.multiple()</code>,
<code>d.rel.conn.unif.prior()</code>,
<code>dual.mark.transmission()</code>,
<code>optim.rel.conn.dists()</code>,
<code>r.marked.egg.fraction()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(ConnMatTools)

k &lt;- 10 # Number of marked settlers among sample
n.obs &lt;- 87 # Number of settlers in sample

p &lt;- 0.4 # Fraction of eggs that was marked
phi &lt;- seq(0.001,1-0.001,length.out=101) # Values for relative connectivity

# Probability distribution assuming infinite settler pool and uniform prior
drc &lt;- d.rel.conn.unif.prior(phi,p,k,n.obs)
qrc &lt;- q.rel.conn.unif.prior(c(0.025,0.975),p,k,n.obs) # 95% confidence interval

# Probability distribution assuming infinite settler pool and using reference/Jeffreys prior
drp &lt;- d.rel.conn.beta.prior(phi,p,k,n.obs)
prp &lt;- p.rel.conn.beta.prior(phi,p,k,n.obs)
qrp &lt;- q.rel.conn.beta.prior(c(0.025,0.975),p,k,n.obs) # 95% confidence interval

# Make a plot of different distributions
# black = Jeffreys prior; red = uniform prior
# Jeffreys prior draws distribution slightly towards zero
plot(phi,drp,type="l",main="Probability of relative connectivity values",
     xlab=expression(phi),ylab="Probability density")
lines(phi,drc,col="red")
abline(v=qrp,col="black",lty="dashed")
abline(v=qrc,col="red",lty="dashed")
</code></pre>


</div>