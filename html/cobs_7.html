<div class="container">

<table style="width: 100%;"><tr>
<td>drqssbc2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Regression Quantile Smoothing Spline with Constraints</h2>

<h3>Description</h3>

<p>Estimate the B-spline coefficients for a regression quantile
<em>smoothing</em> spline with optional constraints, using Ng(1996)'s
algorithm.
</p>


<h3>Usage</h3>

<pre><code class="language-R">drqssbc2(x, y, w = rep.int(1,n), pw, knots, degree, Tlambda,
        constraint, ptConstr, maxiter = 100, trace = 0,
        nrq = length(x), nl1, neqc, niqc, nvar,
        tau = 0.5, select.lambda, give.pseudo.x = FALSE,
        rq.tol = 1e-8 * sc.y, tol.0res = 1e-6,
        print.warn = TRUE, rq.print.warn = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>numeric vector, sorted increasingly, the abscissa values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>numeric, same length as <code>x</code>, the observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>numeric vector of weights, same length as <code>x</code>, as in
<code>cobs</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pw</code></td>
<td>
<p>penalty weights vector passed to <code>l1.design2</code> or
<code>loo.design2</code>. <b>FIXME</b>: This is currently unused.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knots</code></td>
<td>
<p>numeric vector of knots for the splines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degree</code></td>
<td>
<p>integer, must be 1 or 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tlambda</code></td>
<td>
<p>vector of smoothing parameter values <code class="reqn">\lambda</code>; if
it is longer than one, an “optimal” value will be selected
from these.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constraint</code></td>
<td>
<p>see <code>cobs</code> (but cannot be abbreviated here).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ptConstr</code></td>
<td>
<p><code>list</code> of <b>p</b>oin<b>t</b>wise constraints;
notably <code>equal</code>, <code>smaller</code>, <code>greater</code> and <code>gradient</code>
are 3-column matrices specifying the respective constraints.  May have
0 rows if there are no constraints of the corresponding kind.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>maximal number of iterations; defaults to 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>integer or logical indicating the tracing level of the
<em>underlying</em> algorithms; not much implemented (due to lack of trace
in quantreg ...)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrq</code></td>
<td>
<p>integer, <code class="reqn">= n</code>, the number of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nl1</code></td>
<td>
<p>integer, number of observations in the l1 norm that
correspond to roughness measure (may be zero).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>neqc</code></td>
<td>
<p>integer giving the number of equations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niqc</code></td>
<td>
<p>integer giving the number of <b>i</b>ne<b>q</b>uality
<b>c</b>onstraints; of the same length as <code>constraint</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nvar</code></td>
<td>
<p>integer giving the number of equations <em>and</em> constraints.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>desired quantile level; defaults to 0.5 (median).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>select.lambda</code></td>
<td>
<p>logical indicating if an optimal lambda should be
selected from the vector of <code>Tlambda</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>give.pseudo.x</code></td>
<td>
<p>logical indicating if the pseudo design matrix
<code class="reqn">\tilde{X}</code> should be returned (as <em>sparse</em> matrix).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rq.tol</code></td>
<td>
<p>numeric convergence tolerance for the interior point
algorithm called from <code>rq.fit.sfnc()</code> or
<code>rq.fit.sfn()</code>.  Note that (for scale
invariance) this has to be in units of <code>y</code>, which the default
makes use of.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol.0res</code></td>
<td>
<p>tolerance used to check for zero residuals, i.e.,
<code class="reqn">|r_i| &lt; tol * mean(|r_i|)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.warn</code></td>
<td>
<p>logical indicating if warnings should be printed,
when the algorithm seems to have behaved somewhat unexpectedly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rq.print.warn</code></td>
<td>
<p>logical indicating if warnings should be printed
from inside the <code>rq.*</code> function calls, see below.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is an auxiliary function for <code>cobs</code>, possibly
interesting on its own.  Depending on <code>degree</code>, either
<code>l1.design2</code> or <code>loo.design2</code> are
called for construction of the sparse design matrix.
</p>
<p>Subsequently, either <code>rq.fit.sfnc</code> or
<code>rq.fit.sfn</code> is called as the main “work horse”.
</p>
<p>This documentation is currently sparse; read the source code!
</p>


<h3>Value</h3>

<p>a list with components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>comp1 </code></td>
<td>
<p>Description of ‘comp1’</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>comp2 </code></td>
<td>
<p>Description of ‘comp2’</p>
</td>
</tr>
</table>
<p>...
</p>


<h3>Author(s)</h3>

<p>Pin Ng; this help page: Martin Maechler.</p>


<h3>References</h3>

<p>Ng, P. (1996)
An Algorithm for Quantile Smoothing Splines,
<em>Computational Statistics &amp; Data Analysis</em> <b>22</b>, 99–118.
</p>


<h3>See Also</h3>

<p>The main function <code>cobs</code> and its auxiliary
<code>qbsks2</code> which calls <code>drqssbc2()</code> repeatedly.
</p>
<p><code>l1.design2</code> and <code>loo.design2</code>;
further <code>rq.fit.sfnc</code> and
<code>rq.fit.sfn</code> from package <span class="pkg">quantreg</span>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1243)
x  &lt;- 1:32
fx &lt;- (x-5)*(x-15)^2*(x-21)
y  &lt;- fx + round(rnorm(x,s = 0.25),2)


</code></pre>


</div>