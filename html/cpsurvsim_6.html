<div class="container">

<table style="width: 100%;"><tr>
<td>weib_cdfsim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Inverse CDF simulation for the Weibull change-point hazard distribution</h2>

<h3>Description</h3>

<p><code>weib_cdfsim</code> simulates time-to-event data from the Weibull change-point
hazard distribution by implementing the inverse CDF method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">weib_cdfsim(n, endtime, gamma, theta, tau = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Sample size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>endtime</code></td>
<td>
<p>Maximum study time, point at which all participants
are censored</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>Shape parameter <code class="reqn">\gamma</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>Scale parameter <code class="reqn">\theta</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>Change-point(s) <code class="reqn">\tau</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function simulates data from the Weibull change-point hazard distribution
with <code class="reqn">K</code> change-points by simulating values of the exponential distribution and
substituting them into the inverse hazard function. This method applies Type I
right censoring at the endtime specified by the user. This function allows for
up to four change-points and <code class="reqn">\gamma</code> is held constant.
</p>


<h3>Value</h3>

<p>Dataset with n participants including a survival time
and censoring indicator (0 = censored, 1 = event).
</p>


<h3>Examples</h3>

<pre><code class="language-R">nochangepoint &lt;- weib_cdfsim(n = 10, endtime = 20, gamma = 2,
  theta = 0.5)
onechangepoint &lt;- weib_cdfsim(n = 10, endtime = 20, gamma = 2,
  theta = c(0.05, 0.01), tau = 10)
twochangepoints &lt;- weib_cdfsim(n = 10, endtime = 20, gamma = 2,
  theta = c(0.05, 0.01, 0.05), tau = c(8, 12))

#' # Pay attention to how you parameterize your model!
# This simulates an increasing hazard
set.seed(9945)
increasingHazard &lt;- weib_cdfsim(n = 100, endtime = 20, gamma = 2,
  theta = c(0.001, 0.005, 0.02), tau = c(8, 12))
# This tries to fit a decreasing hazard, resulting in biased estimates
cp2.nll &lt;- function(par, tau = tau, gamma = gamma, dta = dta){
  theta1 &lt;- par[1]
  theta2 &lt;- par[2]
  theta3 &lt;- par[3]
  ll &lt;- (gamma - 1) * sum(dta$censor * log(dta$time)) +
    log(theta1) * sum((dta$time &lt; tau[1])) +
    log(theta2) * sum((tau[1] &lt;= dta$time) * (dta$time &lt; tau[2])) +
    log(theta3) * sum((dta$time &gt;= tau[2]) * dta$censor) -
    (theta1/gamma) * sum((dta$time^gamma) * (dta$time &lt; tau[1]) +
      (tau[1]^gamma) * (dta$time &gt;= tau[1])) -
    (theta2/gamma) * sum((dta$time^gamma - tau[1]^gamma) *
      (dta$time &gt;= tau[1]) * (dta$time&lt;tau[2]) +
      (tau[2]^gamma - tau[1]^gamma) * (dta$time &gt;= tau[2])) -
    (theta3/gamma) * sum((dta$time^gamma - tau[2]^gamma) *
      (dta$time &gt;= tau[2]))
  return(-ll)
}
optim(par = c(0.2, 0.02, 0.01), fn = cp2.nll,
  tau = c(8, 12), gamma = 2,
  dta = increasingHazard)

</code></pre>


</div>