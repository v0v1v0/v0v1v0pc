<div class="container">

<table style="width: 100%;"><tr>
<td>NN</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>NN Function</h2>

<h3>Description</h3>

<p>This function trains an ensemble of deep neural networks to predict keff values (imports Tabulate, Scale, Model, Fit, Plot, and Test functions).
</p>


<h3>Usage</h3>

<pre><code class="language-R">NN(
  batch.size = 8192,
  code = "mcnp",
  dataset,
  ensemble.size = 5,
  epochs = 1500,
  layers = "8192-256-256-256-256-16",
  loss = "sse",
  opt.alg = "adamax",
  learning.rate = 0.00075,
  val.split = 0.2,
  overwrite = FALSE,
  remodel = FALSE,
  replot = TRUE,
  verbose = FALSE,
  ext.dir,
  training.dir = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>batch.size</code></td>
<td>
<p>Batch size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>code</code></td>
<td>
<p>Monte Carlo radiation transport code (e.g., "cog", "mcnp")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataset</code></td>
<td>
<p>Training and test data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ensemble.size</code></td>
<td>
<p>Number of deep neural networks in the ensemble</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epochs</code></td>
<td>
<p>Number of training epochs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>layers</code></td>
<td>
<p>String that defines the deep neural network architecture (e.g., "64-64")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loss</code></td>
<td>
<p>Loss function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opt.alg</code></td>
<td>
<p>Optimization algorithm</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>learning.rate</code></td>
<td>
<p>Learning rate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>val.split</code></td>
<td>
<p>Validation split</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overwrite</code></td>
<td>
<p>Boolean (TRUE/FALSE) that determines if files should be overwritten</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remodel</code></td>
<td>
<p>Boolean (TRUE/FALSE) that determines if an existing metamodel should be reused</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replot</code></td>
<td>
<p>Boolean (TRUE/FALSE) that determines if .png files should be replotted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Boolean (TRUE/FALSE) that determines if TensorFlow and Fit function output should be displayed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ext.dir</code></td>
<td>
<p>External directory (full path)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>training.dir</code></td>
<td>
<p>Training directory (full path)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of lists containing an ensemble of deep neural networks and weights
</p>


<h3>Examples</h3>

<pre><code class="language-R">
ext.dir &lt;- paste0(tempdir(), "/criticality/extdata")
dir.create(ext.dir, recursive = TRUE, showWarnings = FALSE)

extdata &lt;- paste0(.libPaths()[1], "/criticality/extdata")
file.copy(paste0(extdata, "/facility.csv"), ext.dir, recursive = TRUE)
file.copy(paste0(extdata, "/mcnp-dataset.RData"), ext.dir, recursive = TRUE)

config &lt;- FALSE
try(config &lt;- reticulate::py_config()$available)
try(if (config == TRUE) {
  NN(
    batch.size = 128,
    ensemble.size = 1,
    epochs = 10,
    layers = "256-256-16",
    loss = "sse",
    replot = FALSE,
    ext.dir = ext.dir
  )
})

</code></pre>


</div>