<div class="container">

<table style="width: 100%;"><tr>
<td>plot_morphospace_stack</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot stacked ordination spaces</h2>

<h3>Description</h3>

<p>Plots a stack of ordination spaces representing multiple time-slices.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_morphospace_stack(
  pcoa_input,
  taxon_ages,
  taxon_groups,
  time_bins,
  shear = 0.2,
  x_axis = 1,
  y_axis = 2,
  palette = "viridis",
  plot_cushion = 0.3,
  platform_size = 0.95,
  plot_pillars = TRUE,
  plot_crosshair = TRUE,
  plot_grid_cells = TRUE,
  plot_convex_hulls = TRUE,
  plot_timebin_names = TRUE,
  plot_tickmarks = TRUE,
  plot_group_legend = TRUE,
  group_legend_position = "bottom_right",
  point_size = 1.5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pcoa_input</code></td>
<td>
<p>The main input in the format output from ordinate_cladistic_matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taxon_ages</code></td>
<td>
<p>A two-column matrix of the first and last apperance dates (columns; <code>"fad"</code> and <code>"lad"</code>) for the taxa (as rownames) from <code>pcoa_input</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taxon_groups</code></td>
<td>
<p>An object of class <code>taxonGroups</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time_bins</code></td>
<td>
<p>An object of class <code>timeBins</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shear</code></td>
<td>
<p>A single value (between 0 and 1) that determines the "sheared" visual appearance of the platforms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_axis</code></td>
<td>
<p>The ordination axis to plot on the x-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_axis</code></td>
<td>
<p>The ordination axis to plot nn the y-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>palette</code></td>
<td>
<p>The palette to use for plotting each element of <code>taxon_groups</code>. See palette.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_cushion</code></td>
<td>
<p>A number determining the "cushion" around the edge of each stack in which no data will be plotted. This should be larger than zero or points will "hang" over the edge. Additionally, if using a <code>platform_size</code> value in excess of one this will avoid points being hidden under overlying platforms. Note that this effectively adds empty plot space around the data, it does not remove anything.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>platform_size</code></td>
<td>
<p>The size of each platform as a proportion. Values of less than one will show slight gaps between platforms, whereas values in excess of one will mean platforms will appear to overlap.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_pillars</code></td>
<td>
<p>Logical indicating whether or not to plot the pillars linking the corners of each platform.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_crosshair</code></td>
<td>
<p>Logical indicating whether or not to plot the "crosshair" (i.e., the zero-zero lines that run through the origin of the morphospace).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_grid_cells</code></td>
<td>
<p>Logical indicating whether or not to plot grid cells that help visualise the distorted aspect ratio of the plot. Each cell is a square in the ordination space.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_convex_hulls</code></td>
<td>
<p>Logical indicating whether or not to plot convex hulls around the taxonomic groupings. Only relevant if <code>taxon_groups</code> is in use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_timebin_names</code></td>
<td>
<p>Logical indicating whether or not to plot the names of each time bin next to each platform. I.e., the rownames from <code>time_bins</code>. Note if these are long they may disappear behind overlying platforms. To avoid this try using a smaller <code>platform_size</code> value, a larger <code>shear</code> value, or simply shorter or abbreviated names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_tickmarks</code></td>
<td>
<p>Logical indicating whether or not to plot tickmarks next to the bottom platform.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_group_legend</code></td>
<td>
<p>Logical indicating whether or not to plot a legend. Only relevant if using <code>taxon_groups</code>. Note this may obscure some points so use with caution and try picking different values for <code>group_legend_position</code> to avoid this.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group_legend_position</code></td>
<td>
<p>The position the group legend should be plotted. Only relevant if using <code>taxon_groups</code> and <code>plot_group_legend = TRUE</code>. Options are: <code>"bottom_left"</code>, <code>"bottom_right"</code>, <code>"top_left"</code>, and <code>"top_right"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>point_size</code></td>
<td>
<p>The size at which the points should be plotted. Note that here points are custom polygons and hence are not editable by normal plot options, e.g., <code>pch</code> or <code>cex</code>. At present all points are plotted as circles.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This style of plot is taken from various papers by Michael Foote (Foote 1993; his Figures 2, 4, 6, 8, 10, 12, and 14; Foote 1994; his Figure 2; Foote 1995; his Figure 3; Foote 1999; his Figure 22), and can be seen elsewhere in the literature (e.g., Friedman and Coates 2006; their Figure 2c). Here multiple ordination (or morpho-) spaces are plotted in stratigraphic order (oldest at bottom) as a stacked series of "platforms" representing named time bins.
</p>
<p>The user needs to supply three main pieces of information to use the function: 1) ordination data that includes rows (taxa) and columns (ordination axes), 2) the ages (first and last appearance dates) of the taxa sampled, and 3) the ages (first and last appearance dates) of the named time bins used.
</p>
<p>Note that since version 0.6.1 this function has been completely rewritten to better reflect the usage of these type of figures (see citations above) as well as allow additional features. This was also done in part to standardise the function to fit the style of the other major disparity plotting functions in Claddis, such as plot_morphospace. This means the input data is now assumed to come directly from ordinate_cladistic_matrix, but the user could easily still bring in data from elsewhere (the way the function worked previously) by reformatting it using something like:
</p>
<p><code>pcoa_input &lt;- list(vectors = my_imported_data)</code>
</p>
<p>Where my_imported_data has columns representing ordination axes (1 to N) and rownames corresponding to taxon names.
</p>


<h3>Author(s)</h3>

<p>Graeme T. Lloyd <a href="mailto:graemetlloyd@gmail.com">graemetlloyd@gmail.com</a> and Emma Sherratt <a href="mailto:emma.sherratt@gmail.com">emma.sherratt@gmail.com</a>
</p>


<h3>References</h3>

<p>Foote, M., 1993. Discordance and concordance between morphological and taxonomic diversity. <em>Paleobiology</em>, <b>19</b>, 185-204.
</p>
<p>Foote, M., 1994. Morphological disparity in Ordovician-Devonian crinoids and the early saturation of morphological space. <em>Paleobiology</em>, <b>20</b>, 320-344.
</p>
<p>Foote, M., 1995. Morphological diversification of Paleozoic crinoids. <em>Paleobiology</em>, <b>21</b>, 273-299.
</p>
<p>Foote, M., 1999. Morphological diversity in the evolutionary radiation of Paleozoic and post-Paleozoic crinoids. <em>Paleobiology</em>, <b>25</b>, 1-115.
</p>
<p>Friedman, M. and Coates, M. I., 2006. A newly recognized fossil coelacanth highlights the early morphological diversification of the clade. <em>Proceedings of the Royal Society of London B</em>, <b>273</b>, 245-250.
</p>


<h3>See Also</h3>

<p>assign_taxa_to_bins, plot_chronophylomorphospace, plot_morphospace, plot_multi_morphospace, ordinate_cladistic_matrix
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Build taxon ages matrix for Day et al 2016 data:
taxon_ages &lt;- matrix(data = c(269, 267, 263, 260, 265, 265, 265, 265, 257, 255, 259, 259, 258, 258,
  260, 257, 257, 255, 257, 257, 255, 252, 259, 259, 260, 258, 253, 252, 257, 255, 257, 255),
  ncol = 2, byrow = TRUE, dimnames = list(c("Biarmosuchus_tener", "Hipposaurus_boonstrai",
  "Bullacephalus_jacksoni", "Pachydectes_elsi", "Lemurosaurus_pricei", "Lobalopex_mordax",
  "Lophorhinus_willodenensis", "Proburnetia_viatkensis", "Lende_chiweta",
  "Paraburnetia_sneeubergensis", "Burnetia_mirabilis", "BP_1_7098", "Niuksenitia_sukhonensis",
  "Ictidorhinus_martinsi", "RC_20", "Herpetoskylax_hopsoni"), c("FAD", "LAD")))

# Ordinate Day et al 2016 data set:
pcoa_input &lt;- ordinate_cladistic_matrix(cladistic_matrix = prune_cladistic_matrix(
  cladistic_matrix = day_2016,
  taxa2prune = "Lycaenodon_longiceps"))

# Build simple taxonomic groups for Day et al 2016 daat set:
taxon_groups &lt;- list(nonBurnetiamorpha = c("Biarmosuchus_tener", "Hipposaurus_boonstrai",
  "Bullacephalus_jacksoni", "Pachydectes_elsi", "Niuksenitia_sukhonensis", "Ictidorhinus_martinsi",
  "RC_20", "Herpetoskylax_hopsoni"), Burnetiamorpha = c("Lemurosaurus_pricei", "Lobalopex_mordax",
  "Lophorhinus_willodenensis", "Proburnetia_viatkensis", "Lende_chiweta",
  "Paraburnetia_sneeubergensis", "Burnetia_mirabilis", "BP_1_7098"))

# Set class as taxonGroups:
class(taxon_groups) &lt;- "taxonGroups"

# Build a sequence of equally spaced time bins spanning Day et al. 2016 data:
time_sequence &lt;- seq(from = 270, to = 252, length.out = 6)

# Reformat this sequence into named time bin matrix:
time_bins &lt;- matrix(
  data = c(time_sequence[1:(length(x = time_sequence) - 1)],
  time_sequence[2:length(x = time_sequence)]),
  ncol = 2,
  dimnames = list(c("Bin 1", "Bin 2", "Bin 3", "Bin 4", "Bin 5"), c("fad", "lad"))
)

# Set class as timeBins:
class(time_bins) &lt;- "timeBins"

# Plot morphospace stack using named time bins:
plot_morphospace_stack(
  pcoa_input = pcoa_input,
  taxon_ages = taxon_ages,
  taxon_groups = taxon_groups,
  time_bins = time_bins,
)

</code></pre>


</div>