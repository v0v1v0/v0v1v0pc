<div class="container">

<table style="width: 100%;"><tr>
<td>import_coin_tool</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Import data directly from COIN Tool</h2>

<h3>Description</h3>

<p>The <a href="https://knowledge4policy.ec.europa.eu/composite-indicators/coin-tool_en">COIN Tool</a> is an Excel-based tool
for building composite indicators. This function provides a direct interface for reading a COIN Tool input deck and
converting it to COINr. You need to provide a COIN Tool file, with the "Database" sheet properly compiled.
</p>


<h3>Usage</h3>

<pre><code class="language-R">import_coin_tool(fname, makecodes = FALSE, oldtool = FALSE, out2 = "list")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fname</code></td>
<td>
<p>The file name and path to read, e.g. <code>"C:/Documents/COINToolFile.xlsx"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>makecodes</code></td>
<td>
<p>Logical: if <code>TRUE</code>, will generate short indicator codes based on indicator names,
otherwise if <code>FALSE</code>, will use COIN Tool indicator codes <code>"Ind.01"</code>, etc. Currently only does this
for indicators, not aggregation groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>oldtool</code></td>
<td>
<p>Logical: if <code>TRUE</code>, compatible with old COIN Tool (pre-release, early 2019 or earlier).
There are some minor differences on where the elements are found.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out2</code></td>
<td>
<p>Either <code>"list"</code> (default) to output a list with <code>iData</code> and <code>iMeta</code> entries (for input into <code>new_coin()</code>),
else <code>"coin"</code> to output a coin.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function replaces the now-defunct <code>COINToolIn()</code> from COINr &lt; v1.0.
</p>


<h3>Value</h3>

<p>Either a list or a coin, depending on <code>out2</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## This example downloads a COIN Tool spreadsheet containing example data,
## saves it to a temporary directory, unzips, and reads into R. Finally it
## assembles it into a COIN.

# Make temp zip filename in temporary directory
tmpz &lt;- tempfile(fileext = ".zip")
# Download an example COIN Tool file to temporary directory
# NOTE: the download.file() command may need its "method" option set to a
# specific value depending on the platform you run this on. You can also
# choose to download/unzip this file manually.
download.file("https://knowledge4policy.ec.europa.eu/sites/default/
files/coin_tool_v1_lite_exampledata.zip", tmpz)
# Unzip
CTpath &lt;- unzip(tmpz, exdir = tempdir())
# Read COIN Tool into R
l &lt;- import_coin_tool(CTpath, makecodes = TRUE) 
## End(Not run)

</code></pre>


</div>