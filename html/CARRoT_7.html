<div class="container">

<table style="width: 100%;"><tr>
<td>cross_val</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cross-validation run</h2>

<h3>Description</h3>

<p>Function running a single cross-validation by partitioning the data into training and test set
</p>


<h3>Usage</h3>

<pre><code class="language-R">cross_val(
  vari,
  outi,
  c,
  rule,
  part,
  l,
  we,
  vari_col,
  preds,
  mode,
  cmode,
  predm,
  cutoff,
  objfun,
  minx = 1,
  maxx = NULL,
  nr = NULL,
  maxw = NULL,
  st = NULL,
  corr = 1,
  Rsq = F,
  marg = 0,
  n_tr,
  preds_tr
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>vari</code></td>
<td>
<p>set of predictors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outi</code></td>
<td>
<p>array of outcomes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c</code></td>
<td>
<p>set of all indices of the predictors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rule</code></td>
<td>
<p>an Events per Variable (EPV) rule, defaults to 10</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>part</code></td>
<td>
<p>indicates partition of the original data-set into training and test set in a proportion <code>(part-1):1</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l</code></td>
<td>
<p>number of observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>we</code></td>
<td>
<p>weights of the predictors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vari_col</code></td>
<td>
<p>overall number of predictors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>preds</code></td>
<td>
<p>array to write predictions for the test split into, intially empty</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode</code></td>
<td>
<p><code>'binary'</code> (logistic regression), <code>'multin'</code> (multinomial regression)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cmode</code></td>
<td>
<p><code>'det'</code> or <code>''</code>; <code>'det'</code> always predicts the more likely outcome as determined by the odds ratio; <code>''</code> predicts certain outcome with probability corresponding to its odds ratio (more conservative). Option available for multinomial/logistic regression</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predm</code></td>
<td>
<p><code>'exact'</code> or <code>''</code>; for logistic and multinomial regression; <code>'exact'</code> computes how many times the exact outcome category was predicted, <code>''</code> computes how many times either the exact outcome category or its nearest neighbour was predicted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p>cut-off value for logistic regression</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>objfun</code></td>
<td>
<p><code>'roc'</code> for maximising the predictive power with respect to AUC, <code>'acc'</code> for maximising predictive power with respect to accuracy.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minx</code></td>
<td>
<p>minimum number of predictors to be included in a regression, defaults to 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxx</code></td>
<td>
<p>maximum number of predictors to be included in a regression, defaults to maximum feasible number according to one in ten rule</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nr</code></td>
<td>
<p>a subset of the data-set, such that <code>1/part</code> of it lies in the test set and <code>1-1/part</code> is in the training set, defaults to empty set</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxw</code></td>
<td>
<p>maximum weight of predictors to be included in a regression, defaults to maximum weight according to one in ten rule</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>st</code></td>
<td>
<p>a subset of predictors to be always included into a predictive model,defaults to empty set</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corr</code></td>
<td>
<p>maximum correlation between a pair of predictors in a model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rsq</code></td>
<td>
<p>whether R-squared statistics constrained is introduced</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marg</code></td>
<td>
<p>margin of error for R-squared statistics constraint</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_tr</code></td>
<td>
<p>size of the training set</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>preds_tr</code></td>
<td>
<p>array to write predictions for the training split into, intially empty</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>regr</code></td>
<td>
<p>An M x N matrix of sums of the absolute errors for each element of the test set for each feasible regression. M is maximum feasible number of variables included in a regression, N is the maximum feasible number of regressions of the fixed size; the row index indicates the number of variables included in a regression. Therefore each row corresponds to results obtained from running regressions with the same number of variables and columns correspond to different subsets of predictors used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>regrr</code></td>
<td>
<p>An M x N matrix of sums of the relative errors for each element of the test set (only for <code>mode = 'linear'</code>) for each feasible regression. M is maximum feasible number of variables included in a regression, N is the maximum feasible number of regressions of the fixed size; the row index indicates the number of variables included in a regression. Therefore each row corresponds to results obtained from running regressions with the same number of variables and columns correspond to different subsets of predictors used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nvar</code></td>
<td>
<p>Maximum feasible number of variables in the regression</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>emp</code></td>
<td>
<p>An accuracy of always predicting the more likely outcome as suggested by the training set (only for <code>mode = 'binary'</code> and <code>objfun = 'acc'</code>)</p>
</td>
</tr>
</table>
<p>In <code>regr</code> and <code>regrr</code> <code>NA</code> values are possible since for some numbers of variables there are fewer feasible regressions than for the others.
</p>


<h3>See Also</h3>

<p>Uses <code>compute_max_weight</code>, <code>sum_weights_sub</code>, <code>make_numeric_sets</code>, <code>get_predictions_lin</code>, <code>get_predictions</code>, <code>get_probabilities</code>, <code>AUC</code>, <code>combn</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#creating variables

vari&lt;-matrix(c(1:100,seq(1,300,3)),ncol=2)

#creating outcomes

out&lt;-rbinom(100,1,0.3)

#creating array for predictions

pr&lt;-array(NA,c(2,2))

pr_tr&lt;-array(NA,c(2,2))

#passing set of the inexes of the predictors

c&lt;-c(1:2)

#passing the weights of the predictors

we&lt;-c(1,1)

#setting the mode

m&lt;-'binary'

#running the function

cross_val(vari,out,c,10,10,100,we,2,pr,m,'det','exact',0.5,'acc',nr=c(1,4),n_tr=90,preds_tr=pr_tr)
</code></pre>


</div>