<div class="container">

<table style="width: 100%;"><tr>
<td>matrixweave</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Combine covariance matrix and pseudo covariance matrix into a "double covariance matrix"</h2>

<h3>Description</h3>

<p>Interleaves the elements of a <code class="reqn">(p x p)</code> matrix with those of a different <code class="reqn">(p x p)</code> matrix to form a <code class="reqn">(2p x 2p)</code> matrix.
This function was originally made to combine the covariance and pseudo covariance matrices of a
complex random vector into a single "double covariance matrix", as described in (van den Bos 1995). However, it will accept
and operate on matrices of any storage mode.
</p>


<h3>Usage</h3>

<pre><code class="language-R">matrixweave(cov, pcov, FUNC = Conj)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cov</code></td>
<td>
<p>A square matrix, such as one describing the covariance between two complex random vectors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pcov</code></td>
<td>
<p>A square matrix with the same size as cov. Perhaps a pseudo covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUNC</code></td>
<td>
<p>A function to operate on the elements of <code>pcov</code>. The results of which will be a quarter of the elements of the returned matrix. Default is <code>Conj</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A square matrix with dimension twice that of the input matrices. Each element of which is an element from one of the inputs, and its nearest non-diagonal neighbors are from the other input.
Half of the elements from <code>pcov</code> present in the output matrix are replaced by <code>FUNC</code> operated on them. Thus if two 2x2 matrices, <code>A</code> and <code>B</code> are given to <code>matrixweave()</code>, the elements of the result are:<br><code style="white-space: pre;">⁠matrixweave(A,B)[i,j] = if(i+j is even) A[ceiling(i/2), ceiling(j/2)]⁠</code><br><code style="white-space: pre;">⁠                        if(i+j is odd and i &gt; j) B[ceiling(i/2), ceiling(j/2)]⁠</code><br><code style="white-space: pre;">⁠                        if(i+j is odd and i &lt; j) FUNC(B[ceiling(i/2),ceiling(j/2)])⁠</code>
</p>


<h3>References</h3>

<p>A. van den Bos, The Multivariate Complex Normal Distribution-a Generalization, IEEE Trans. Inform. Theory 41, 537 (1995).
</p>


<h3>See Also</h3>

<p>mahalanobis, vcov.zlm, vcov.rzlm
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(4242)
mata &lt;- matrix(rnorm(9), nrow = 3)
matb &lt;- matrix(rnorm(9), nrow = 3)
matrixweave(mata, matb)
</code></pre>


</div>