<div class="container">

<table style="width: 100%;"><tr>
<td>raPlot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate a Ratio Average [RAy] Plot.</h2>

<h3>Description</h3>

<p>A plot which turns two vectors of count data into log scaled fold change ratio and average abundance.  
The plot derives from a Bland-Altman plot and is also very similar to an MA plot.  
The RA plot is unique, however, in it's creative inclusion of the vector-unique 'arms' which are artificially introduced into the plot by adding a &lt;1 epsilon factor before the log function is applied.
The name RAy comes from the fact that the aforementioned 'uniques' arms addition makes it strongly resemble a geometric ray.  
Many of the parameters to the function play off of this convenient anatomical analogy.
</p>


<h3>Usage</h3>

<pre><code class="language-R">raPlot(a, b=NULL, uniques=5, normalize=FALSE,  
        nr=0, alpha = 0.01, jitter=FALSE, jit.wgts=NULL,
        rex=1, flat=TRUE, tail=.5, arms=.5, spine=1, border=NULL, plot=TRUE,  ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>a vector of counts for a.  can also be a matrix with two columns 1 for a and 2 for b.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>a vector of counts for b.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uniques</code></td>
<td>
<p>a boolean specifying whether or not to plot the library-unique genes (those with zero counts in one or the other library).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalize</code></td>
<td>
<p>A boolean specifying whether or not to normalize the counts into proportions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nr</code></td>
<td>
<p>a numeric value indicating the asymptotic normalization ratio line.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>a statisical significance value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jitter</code></td>
<td>
<p>whether or not or how much to jitter the a and b counts into surrounding, non-overlapping space.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jit.wgts</code></td>
<td>
<p>a weight vector used to spread the counts of a and b into surrounding, non-overlapping space.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rex</code></td>
<td>
<p>a numeric value specifying the radial expansion of the plot points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flat</code></td>
<td>
<p>a boolean for the radial expansion of points as a function of both R and A axes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tail</code></td>
<td>
<p>a numeric or boolean value indicating the line thickness of the two trailing curved significance lines of the RAy.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arms</code></td>
<td>
<p>a numeric or boolean value indicating the line thickness of the two leading straight separator lines of the RAy.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spine</code></td>
<td>
<p>a numeric or boolean value indicating the line thickness of the normalization line (whose y position is specified by mm).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>border</code></td>
<td>
<p>a vector of strings used to color the borders of the points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>whether or not to do the actual plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other parameters passed to plot.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a RAy plot
</p>


<h3>See Also</h3>

<p>limma::plotMA, edgeR::maPlot
</p>


<h3>Examples</h3>

<pre><code class="language-R">
a &lt;- rnbinom(n=10000, mu=5, size=2)
b &lt;- rnbinom(n=10000, mu=5, size=2)

## the alternative 
plot(a,b)
## the raPlot version
raPlot(a, b) 

## highlight the condition unique points in the same way as  edgeR's "maPlot"
RA &lt;- raPlot(a, b, pch='')
cond.unique &lt;- apply(cbind(a,b), 1, function(d) any(d==0))
points(RA$A,RA$R, col=c('black','orange')[cond.unique+1])

## try playing with jittering over plotted points
raPlot(a, b, jitter=.3)

</code></pre>


</div>