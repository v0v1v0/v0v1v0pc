<div class="container">

<table style="width: 100%;"><tr>
<td>cggm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Post-Hoc Maximum Likelihood Refitting of a Conditional Graphical Lasso</h2>

<h3>Description</h3>

<p>‘<code>cggm</code>’ is used to perform post-hoc maximum likelihood refitting of a selected conditional graphical lasso model with censored and/or missing values.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cggm(object, GoF = AIC, lambda.id, rho.id, tp.min = 1.0E-6, ntp = 100L,
     maxit.em = 1.0E+4, thr.em = 1.0E-3, maxit.bcd = 1.0E+5, thr.bcd = 1.0E-4, 
     trace = 0L, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> object of S3 class ‘<code>cglasso</code>’, that is, the output of the function <code>cglasso</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GoF</code></td>
<td>
<p>a valid goodness-of-fit function, such as <code>AIC.cglasso</code> or <code>BIC.cglasso</code>, or an <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> object of class ‘<code>GoF</code>’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.id</code></td>
<td>
<p>an optional integer used to identify a <code class="reqn">\lambda</code>-value stored in <code>object</code>. See section ‘Details’ for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho.id</code></td>
<td>
<p>an optional integer used to identify a <code class="reqn">\rho</code>-value stored in <code>object</code>. See section ‘Details’ for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tp.min</code></td>
<td>
<p>the smallest <code class="reqn">\lambda</code> and <code class="reqn">\rho</code> value. See section ‘Details’ for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntp</code></td>
<td>
<p>integer; number of <code class="reqn">\lambda</code>- and <code class="reqn">\rho</code>-values used to compute the coefficients path. See section ‘Details’ for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit.em</code></td>
<td>
<p>maximum number of iterations of the EM algorithm. Default is <code>1.0E+4</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thr.em</code></td>
<td>
<p>threshold for the convergence of the EM algorithm. Default value is <code>1.0E-4</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit.bcd</code></td>
<td>
<p>maximum number of iterations of the glasso algorithm. Default is <code>1.0E+5</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thr.bcd</code></td>
<td>
<p>threshold for the convergence of the glasso algorithm. Default is <code>1.0E-4</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>integer for printing information out as iterations proceed: <code>trace = 0</code> no information is printed out on screen; <code>trace = 1</code> minimal information is printed; <code>trace = 2</code> detailed information is printed on screen.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>the <em>penalty</em> parameter passed to the goodness-of-fit function (argument ‘<code>GoF</code>’).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The model-fitting function <code>cggm</code> is used to obtain the maximum likelihood estimates of a censored Gaussian graphical model whose structure was found by penalised cglasso inference. That is, given a fitted cglasso model, identified along the path via a goodness-of-fit function (passed by <code>GoF</code>) or via the optional arguments <code>lambda.id</code> and <code>rho.id</code>), <code>cggm</code> computes the maximum likelihood estimates of the parameters with zero constraints associated to the given structure.
</p>
<p>Maximum likelihood estimates are computed using <code>cglasso</code> as workhorse function, that is, <code>cggm</code> fits a sequence of cglasso models, with length equal to <code>ntp</code>, reducing <code class="reqn">\lambda</code> and <code class="reqn">\rho</code> until they are equal to the value ‘<code>min(tp.min, lambda.min, rho.min)</code>’, where <code>lambda.min</code> and <code>rho.min</code> are the smallest <code class="reqn">\lambda</code>- and <code class="reqn">\rho</code>-values stored in <code>object</code>. Maximum likelihood estimates are obtained from the last fitted cglasso model.
</p>
<p>The model-fitting function <code>cggm</code> returns an <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> object inheriting the S3 class ‘<code>cglasso</code>’, for which all printing and plotting functions, designed for a <code>cglasso</code> object, can be used (see section ‘<code>See Also</code>’). Function <code>ShowStructure</code> can be used to show the structure of the package.
</p>
<p>NOTE: if the user tries a problem when the sample size is not large enough, then increase the number of fitted cglasso models (argument <code>ntp</code>).
</p>


<h3>Value</h3>

<p><code>cggm</code> returns an object of S3 class “<code>cggm</code>”, i.e., a list containing the
following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the call that produced this object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Yipt</code></td>
<td>
<p>an array storing the ‘working response matrix’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>the maximum likelihood estimate of the regression coefficient matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>the fitted expected values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>the ‘working residuals’ matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>the ‘working empirical covariance matrix’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sgm</code></td>
<td>
<p>the maximum likelihood estimate of the covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tht</code></td>
<td>
<p>the maximum likelihood estimate of the precision matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dfB</code></td>
<td>
<p>the number of estimated non-zero regression coefficients. Only for internal purpose.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dfTht</code></td>
<td>
<p>the number of estimated non-zero (off-diagonal) partial correlation coefficients. Only for internal purpose.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>InfoStructure</code></td>
<td>
<p>a named list whose elements are used to store the information about the estimated networks. Only for internal purpose.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nit</code></td>
<td>
<p>the number of EM steps.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>the ‘<code>datacggm</code>’ object used to compute the censored graphical lasso estimator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlambda</code></td>
<td>
<p>Only for internal purpose.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>the <code class="reqn">\lambda</code>-value of the selected cglasso model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrho</code></td>
<td>
<p>Only for internal purpose.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>the <code class="reqn">\rho</code>-value of the selected cglasso model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit.em</code></td>
<td>
<p>maximum number of iterations of the EM algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thr.em</code></td>
<td>
<p>threshold for the convergence of the EM algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit.bcd</code></td>
<td>
<p>maximum number of iterations of the glasso algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thr.bcd</code></td>
<td>
<p>threshold for the convergence of the glasso algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conv</code></td>
<td>
<p>a description of the error that has occurred.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subrout</code></td>
<td>
<p>the name of the Fortran subroutine where the error has occurred (for internal debug only).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>the integer used for printing information on screen.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nobs</code></td>
<td>
<p>the sample size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nresp</code></td>
<td>
<p>the number of response variables used to fit the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npred</code></td>
<td>
<p>the number of predictors used to fit the model.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Luigi Augugliaro (<a href="mailto:luigi.augugliaro@unipa.it">luigi.augugliaro@unipa.it</a>)</p>


<h3>See Also</h3>

<p><code>cglasso</code>, <code>coef.cglasso</code>, <code>fitted.cglasso</code>, <code>residuals.cglasso</code>, <code>predict.cggm</code>, <code>impute</code>, <code>AIC.cglasso</code>, <code>BIC.cglasso</code>, <code>summary.cglasso</code>, <code>to_graph</code>, <code>plot.cglasso2igraph</code> and <code>ShowStructure</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(123)
# Y ~ N(XB, Sigma)  and
# 1. probability of left/right censored values equal to 0.05
# 2. probability of missing-at-random values equal to 0.05
n &lt;- 100L
p &lt;- 3L
q &lt;- 2L
b0 &lt;- runif(p)
B &lt;- matrix(runif(q * p), nrow = q, ncol = p)
X &lt;- matrix(rnorm(n * q), nrow = n, ncol = q)
rho &lt;- 0.3
Sigma &lt;- outer(1L:p, 1L:p, function(i, j) rho^abs(i - j))
Z &lt;- rcggm(n = n, b0 = b0, X = X, B = B, Sigma = Sigma, probl = 0.05, probr = 0.5, probna = 0.05)
out &lt;- cglasso(. ~ ., data = Z)

# MLE of the censored Gaussian graphical model identified by 'BIC'
out.mle &lt;- cggm(out, GoF = BIC)
out.mle

# accessor functions
coef(out.mle, drop = TRUE)
fitted(out.mle, drop = TRUE)
residuals(out.mle, type = "working", drop = TRUE)
impute(out.mle, type = "both")

# goodness-of-fit functions
AIC(out.mle)
BIC(out.mle)
summary(out.mle)

# network analysis
out.graph &lt;- plot(out.mle)
out.graph
</code></pre>


</div>