<div class="container">

<table style="width: 100%;"><tr>
<td>cellwiseheatmap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Heatmap of cellwise outliers</h2>

<h3>Description</h3>

<p>Makes a heatmap of cellwise outliers.</p>


<h3>Usage</h3>

<pre><code class="language-R">cellwiseheatmap(cellwiseoutliers, data,
                col = c("blue", "lightgray", "red"), col.scale.factor = 1,
                notecol.outlier = "white", notecol.clean = "black", notecex = 1,
                margins = c(9.5, 14), lhei = c(0.5, 15), lwid = c(0.1, 3.5),
                sepcolor = "white", sepwidth = c(0.01, 0.01))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cellwiseoutliers</code></td>
<td>
<p>a matrix that indicates the cellwise outliers as the (scaled) difference between the original data and imputed data, both scaled and centered. Typically the result of a call to the <code>crm</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>the data as a data frame that is shown in the cells, including row and column names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>vector of colors used for downward outliers, clean cells and upward outliers respectively (default is <code>c("blue", "lightgray", "red")</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.scale.factor</code></td>
<td>
<p>numeric factor for scaling the colors of the cells (default is <code>1</code>). Usually a value between 0 and 1, e.g. 1/2, 1/3, etc.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>notecol.outlier</code></td>
<td>
<p>character string specifying the color for cellnote text of cellwise outliers (default is <code>"white"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>notecol.clean</code></td>
<td>
<p>character string specifying the color for cellnote text of clean cells (default is <code>"black"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>notecex</code></td>
<td>
<p>numeric scaling factor for cellnotes (default is <code>1</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>margins</code></td>
<td>
<p>numeric vector of length 2 containing the margins (see <code>par(mar= *)</code>) for column and row names, respectively (default is <code>c(9.5, 14)</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lhei</code></td>
<td>
<p>numeric vector of length 2 containing the row height (default is <code>c(1, 15)</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwid</code></td>
<td>
<p>numeric vector of length 2 containing the row width (default is <code>c(0.7, 3.5)</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sepcolor</code></td>
<td>
<p>character string specifying the color between the cells (default is <code>"white"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sepwidth</code></td>
<td>
<p>vector of length 2 giving the width and height of the separator box drawn between the cells (default is <code>c(0.01, 0.01)</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>cellwiseheatmap</code> plots a heatmap of cellwise outliers which are typically
the result of a call to the <code>crm</code> function.</p>


<h3>Author(s)</h3>

<p>Peter Filzmoser, Sebastiaan Hoppner, Irene Ortner, Sven Serneels, and Tim Verdonck</p>


<h3>References</h3>

<p>Filzmoser, P., Hoppner, S., Ortner, I., Serneels, S., and Verdonck, T. (2020). Cellwise Robust M regression.
<em>Computational Statistics and Data Analysis</em>, 147, 106944.
<em>DOI:10.1016/j.csda.2020.106944</em>
</p>


<h3>See Also</h3>

<p><code>crm</code>, <code>spadimo</code>, <code>predict.crm</code>, <code>daprpr</code></p>


<h3>Examples</h3>

<pre><code class="language-R">library(crmReg)
data(topgear)

# fit Cellwise Robust M-regression:
crmfit &lt;- crm(formula = MPG ~ ., data = topgear)

# cellwise heatmap of casewise outliers:
cellwiseheatmap(cellwiseoutliers = crmfit$cellwiseoutliers[which(crmfit$casewiseoutliers), ],
                data = round(topgear[which(crmfit$casewiseoutliers), -7], 2),
                col.scale.factor = 1/4)
# check the plotted heatmap!
</code></pre>


</div>