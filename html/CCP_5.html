<div class="container">

<table style="width: 100%;"><tr>
<td>p.asym</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Asymptotic tests for the statistical significance of canonical correlation coefficients </h2>

<h3>Description</h3>

<p>This function runs asymptotic tests to assign the statistical significance 
of canonical correlation coefficients.
F-approximations of Wilks' Lambda, the Hotelling-Lawley Trace,
the Pillai-Bartlett Trace, or of Roy's Largest Root can be used as a test statistic.
</p>


<h3>Usage</h3>

<pre><code class="language-R">p.asym(rho, N, p, q, tstat = "Wilks")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p> vector containing the canonical correlation coefficients. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p> number of observations for each variable. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p> number of independent variables. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p> number of dependent variables. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tstat</code></td>
<td>
<p> test statistic to be used. One of "Wilks" (default), "Hotelling", "Pillai", or "Roy". </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Canonical correlation analysis (CCA) measures the degree of linear relationship between two sets of variables.
The number of correlation coefficients calculated in CCA is equal to the number of variables in the smaller set: <code class="reqn">m = min(p,q)</code>.
The coefficients are arranged in descending order of magnitude: <code class="reqn">rho[1] &gt; rho[2] &gt; rho[3] &gt; ... &gt; rho[m]</code>.
Except for <code>tstat = "Roy"</code>, the function <code>p.asym</code> calculates <code class="reqn">m</code> p-values for each test statistic:
the first p-value is calculated including <em>all</em> canonical correlation coefficients,
the second p-value is calculated by excluding <code class="reqn">rho[1]</code>, 
the third p-value is calculated by excluding <code class="reqn">rho[1]</code> and <code class="reqn">rho[2]</code> etc., 
therewith allowing assessment of the statistical significance of each individual correlation coefficient. 
On principle, Roy's Largest Root takes only <code class="reqn">rho[1]</code> into account, hence one p-value is calculated only. 
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>stat</code></td>
<td>
<p>value of the statistic, i.e. the value of either Wilks' Lambda, the Hotelling-Lawley Trace, the Pillai-Bartlett Trace, or Roy's Largest Root.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>approx</code></td>
<td>
<p>value of the corresponding F-approximation for the statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df1</code></td>
<td>
<p>numerator degrees of freedom for the F-approximation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df2</code></td>
<td>
<p>denominator degrees of freedom for the F-approximation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>p-value</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p> Usage of asymptotic approximations requires multivariate normality of the variables, 
or a large number of observations. Canonical correlation is sensitive to outliers.
The F-approximation for Roy's Largest Root is an upper bound, and the significance level is therefore 
optimistically small. The canonical correlation coefficients are statistically significant
if Wilks' Lambda is <em>smaller</em> than a critical value.
</p>


<h3>Author(s)</h3>

<p> Uwe Menzel  &lt;uwemenzel@gmail.com&gt;</p>


<h3>References</h3>

<p>Wilks, S. S. (1935)
On the independence of <code class="reqn">k</code> sets of normally distributed statistical variables.
<em>Econometrica</em>, <b>3</b> 309–326.  
</p>
<p>Rao, C. R. (1973)
<em>Linear Statistical Inference and It's Applications (2nd ed.).</em>
John Wiley and Sons, New York, 533–543, 555–556.
</p>
<p>Pillai, K. C. W. (1956)
On the distribution of the largest or the smallest root of a matrix in multivariate analysis.
<em>Biometrika</em>, <b>43</b> 122–127.
</p>
<p>Muller, K. E. and Peterson B. L. (1984)
Practical Methods for computing power in testing the multivariate general linear hypothesis.
<em>Computational Statistics &amp; Data Analysis</em>, <b>2</b> 143–158.
</p>
<p>Anderson, T. W. (1984)
<em>An introduction to Multivariate Statistical Analysis.</em> 
John Wiley and Sons, New York.
</p>


<h3>See Also</h3>

<p> See the function <code>cancor</code> or the <code>CCA</code> package for the calculation of canonical correlation coefficients. </p>


<h3>Examples</h3>

<pre><code class="language-R">
## Load the CCP package:
library(CCP)



## Simulate example data:
X &lt;- matrix(rnorm(150), 50, 3)
Y &lt;- matrix(rnorm(250), 50, 5)


## Calculate canonical correlations:
rho &lt;- cancor(X,Y)$cor

## Define number of observations, 
## and number of dependent and independent variables:
N = dim(X)[1]       
p = dim(X)[2]   
q = dim(Y)[2]

## Calculate p-values using F-approximations of some test statistics:
p.asym(rho, N, p, q, tstat = "Wilks")
p.asym(rho, N, p, q, tstat = "Hotelling")
p.asym(rho, N, p, q, tstat = "Pillai")
p.asym(rho, N, p, q, tstat = "Roy")

## Plot the F-approximation for Wilks' Lambda, 
## considering 3, 2, or 1 canonical correlation(s):
res1 &lt;- p.asym(rho, N, p, q)
plt.asym(res1,rhostart=1)
plt.asym(res1,rhostart=2)
plt.asym(res1,rhostart=3)
</code></pre>


</div>