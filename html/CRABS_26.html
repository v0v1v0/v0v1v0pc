<div class="container">

<table style="width: 100%;"><tr>
<td>sample.congruence.class.posterior</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Stochastic exploration of congruent models for all samples in the posterior</h2>

<h3>Description</h3>

<p>This function takes a posterior sample as input: a list of CRABS objects. 
It will then iterate over the samples, and for each posterior sample it will
sample from the posterior class. It will sample using the <code>sample.basic.models</code>
function, and all additional parameters are passed to <code>sample.basic.models</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sample.congruence.class.posterior(
  posterior,
  num.samples,
  rate.type = "extinction",
  mu0.equal = FALSE,
  rate0 = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>posterior</code></td>
<td>
<p>a list of CRABS model objects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.samples</code></td>
<td>
<p>The number of samples to be drawn</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate.type</code></td>
<td>
<p>either "extinction", "speciation", "both" or "joint"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu0.equal</code></td>
<td>
<p>whether to propose alternative mu starting at mu0 equal to the posterior sample. default to FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate0</code></td>
<td>
<p>rate0 allows the user to fix the extinction rate at the present to a single value. defaults to NULL, for drawing it randomly</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Arguments passed on to <code>sample.basic.models</code>
</p>

<dl>
<dt><code>times</code></dt>
<dd>
<p>the time knots</p>
</dd>
<dt><code>model</code></dt>
<dd>
<p>"MRF" for pure MRF model, otherwise MRF has a trend of type "exponential","linear", or "episodic&lt;n&gt;"</p>
</dd>
<dt><code>direction</code></dt>
<dd>
<p>"increase" or "decrease" (measured in past to present)</p>
</dd>
<dt><code>noisy</code></dt>
<dd>
<p>If FALSE, no MRF noise is added to the trajectory</p>
</dd>
<dt><code>MRF.type</code></dt>
<dd>
<p>"HSMRF" or "GMRF", type for stochastic noise.</p>
</dd>
<dt><code>monotonic</code></dt>
<dd>
<p>Whether the curve should be forced to always move in one direction.</p>
</dd>
<dt><code>fc.mean</code></dt>
<dd>
<p>Determines the average amount of change when drawing from the model.</p>
</dd>
<dt><code>rate0.median</code></dt>
<dd>
<p>When not specified, rate at present is drawn from a lognormal distribution with this median.</p>
</dd>
<dt><code>rate0.logsd</code></dt>
<dd>
<p>When not specified, rate at present is drawn from a lognormal distribution with this sd</p>
</dd>
<dt><code>mrf.sd.scale</code></dt>
<dd>
<p>scale the sd of the mrf process up or down. defaults to 1.0</p>
</dd>
<dt><code>min.rate</code></dt>
<dd>
<p>The minimum rate (rescaling fone after after drawing rates).</p>
</dd>
<dt><code>max.rate</code></dt>
<dd>
<p>The maximum rate (rescaling fone after after drawing rates).</p>
</dd>
</dl>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A named list with congruent rates.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(primates_ebd_log)

posterior &lt;- read.RevBayes(primates_ebd_log, max_t = 65, n_samples = 10)

samples &lt;- sample.congruence.class.posterior(posterior, 
                                             num.samples = 5,
                                             rate.type = "extinction",
                                             rate0.median = 0.1,
                                             model = "MRF",
                                             max.rate = 1.0)

print(samples)
</code></pre>


</div>