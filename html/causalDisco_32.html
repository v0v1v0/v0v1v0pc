<div class="container">

<table style="width: 100%;"><tr>
<td>probmat2amat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Convert a matrix of probabilities into an adjacency matrix</h2>

<h3>Description</h3>

<p>Convert a matrix of probabilities into an adjacency matrix
</p>


<h3>Usage</h3>

<pre><code class="language-R">probmat2amat(
  probmat,
  threshold,
  method = "cutoff",
  keep_vnames = TRUE,
  graph_criterion = "pdag",
  deletesym = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>probmat</code></td>
<td>
<p>Square matrix of probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>Value between 0 and 1. Any probabilities lower than
this value will be set to 0 (no arrowhead).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Either <code>"cutoff"</code> or <code>"bpco"</code>, see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep_vnames</code></td>
<td>
<p>If <code>TRUE</code>, variable names (provided as rownames in the input probmat)
will be preserved in the output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>graph_criterion</code></td>
<td>
<p>Which criterion to check if the output graph fulfills for the bpco
method. Should be one of <code>"dag"</code>, <code>"pdag"</code> or <code>"cpdag"</code>  or
<code>NULL</code>. Choosing <code>NULL</code> (the default) puts no further restrictions on the output.
See <code>isValidGraph</code> for definitions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deletesym</code></td>
<td>
<p>If <code>TRUE</code>, edges are deleted symmetrically in the bcpo method. This means that instead
of removing arrowheads (setting singular elements to 0), the procedure removes full edges (setting both potential
arrowheads for the given edge to zero). This only makes a difference if the graph may include undirected edges,
which should be encoded as bidirected edges.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Two methods for converting the probability matrix into an adjacency
matrix are implemented. First, the cutoff-method (<code>method = "cutoff"</code>) simply
uses a threshold value and sets all values below that to zero in the outputted
adjacency matrix. No checks are performed to ensure that the resulting
matrix is a proper dag/pdag/cpdag adjacency matrix. Second, the backwards
PC orientation method (<code>method = "bpco"</code>) first uses a cutoff, and then
sets further elements to zero until the resulting matrix can be converted into
a proper adjacency matrix (using the graph criterion specified in the
<code>graph_criterion</code> argument) by applying the PC algorithm orientation rules.
See Petersen et al. 2022 for further details.
</p>


<h3>Value</h3>

<p>A square matrix of probabilities (all entries in [0,1]).
</p>


<h3>References</h3>

<p>Petersen, Anne Helby, et al. "Causal discovery for observational sciences using supervised machine learning."
arXiv preprint arXiv:2202.12813 (2022).
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Make random probability matrix that can be 
#converted into adjancency matrix
pmat &lt;- matrix(runif(25, 0, 1), 5, 5)
diag(pmat) &lt;- 0

#Convert to adjacency matrix using cutoff-method (threshold = 0.5)
probmat2amat(pmat, threshold = 0.5)

#Convert to adjacency matrix using BPCO-method (threshold = 0.5)
probmat2amat(pmat, threshold = 0.5, method = "bpco")

</code></pre>


</div>