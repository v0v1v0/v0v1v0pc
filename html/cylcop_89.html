<div class="container">

<table style="width: 100%;"><tr>
<td>plot_joint_box</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Circular Boxplot of Turn Angles and Step Lengths</h2>

<h3>Description</h3>

<p>This function produces circular boxplots (a '<code>ggplot</code>' object)
of the turn angles corresponding to specific quantiles of the step lengths.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_joint_box(
  traj = NULL,
  theta = NULL,
  x = NULL,
  levels = 5,
  marginal_lin = NULL,
  spacing = 0.3,
  legend_pos = "right"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>traj</code></td>
<td>
<p>data.frame containing the trajectory produced by e.g.
<code>traj_sim()</code>. It must contain
the columns <code>traj$angle</code> and <code>traj$steplength</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>(alternatively) numeric vector of angles
(measurements of a circular variable) or "circular" component of pseudo-observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>(alternatively) numeric vector of step lengths
(measurements of a linear variable) or "linear" component of pseudo-observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>levels</code></td>
<td>
<p>integer value between 1 and 15, the number of
quantiles into which the step lengths are split.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marginal_lin</code></td>
<td>
<p>named list (for parametric estimates) or
a '<code>density</code>' object (for kernel density estimates).
The output of function <code>fit_steplength()</code> can be used here directly for
both cases. If <code>marginal_lin</code> is specified, the limits of the quantiles of the step lengths
are determined from that distribution instead of from the data specified with
<code>traj$steplength</code> or <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spacing</code></td>
<td>
<p>numeric value between 0 and 10 determining the
spacing between the boxplots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend_pos</code></td>
<td>
<p>character string denoting the position of the legend (limits
of the step length quantiles). Either <code>"left"</code>, <code>"right"</code>, <code>"top"</code>, or
<code>"bottom"</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The step lengths are split into quantiles. For each quantile a boxplot of the
corresponding turn angles is produced and wrapped around the circle.
The turn angle values are plotted
as scatter plot overlaying the boxplot. Outliers are plotted in red.
The median of the turn angles is defined as the center of the shortest arc
that connects all points. The length of the whiskers is 1.5 times the interquartile range.
</p>
<p>You can either specify <code>traj</code> or the angels (<code>theta</code>)
and step lengths (codex).
If entered "by hand", the named list describing the marginal linear distribution
(for <code>marginal_lin</code>) must contain 2 entries:
</p>

<ol>
<li>
<p><code>name</code>:
a character string denoting the name of the linear distribution,
i.e. the name of its
distribution function without the "p",
e.g. "norm" for normal distribution.
</p>
</li>
<li>
<p><code>coef</code>: a named list containing the parameters of the distribution
given in <code>"name"</code>.
</p>
</li>
</ol>
<h3>Value</h3>

<p>A '<code>ggplot</code>' object, the circular boxplot.
</p>


<h3>References</h3>

<p>Hodel FH, Fieberg JR (2022).
“Circular-Linear Copulae for Animal Movement Data.”
<em>Methods in Ecology and Evolution</em>.
<a href="https://doi.org/10.1111/2041-210X.13821">doi:10.1111/2041-210X.13821</a>.
</p>
<p>Hodel FH, Fieberg JR (2021).
“Cylcop: An R Package for Circular-Linear Copulae with Angular Symmetry.”
<em>bioRxiv</em>.
<a href="https://doi.org/10.1101/2021.07.14.452253">doi:10.1101/2021.07.14.452253</a>, <a href="https://www.biorxiv.org/content/10.1101/2021.07.14.452253v3/">https://www.biorxiv.org/content/10.1101/2021.07.14.452253v3/</a>.
</p>


<h3>See Also</h3>

<p><code>plot_cop_scat()</code>, <code>plot_track()</code>,
<code>plot_joint_circ()</code>, <code>plot_cop_surf()</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1234)

traj &lt;- traj_sim(100,
  copula = cyl_rect_combine(copula::frankCopula(6)),
  marginal_circ = list(name= "vonmises", coef=list(0, 2)),
  marginal_lin = list(name = "weibull", coef=list(shape=3))
)

plot1 &lt;- plot_joint_box(traj)
plot2 &lt;- plot_joint_box(traj,
  marginal_lin=list(name = "weibull", coef=list(shape=3))
)

</code></pre>


</div>