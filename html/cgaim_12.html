<div class="container">

<table style="width: 100%;"><tr>
<td>vcov.cgaim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate Variance-Covariance Matrix for a Fitted CGAIM Object</h2>

<h3>Description</h3>

<p>Returns the variance covariance matrix of the main parameters of a fitted <code>cgaim</code> object. These parameters correspond to the index weights <code>alpha</code> and the scaling coefficients <code>beta</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'cgaim'
vcov(object, parm = c("alpha", "beta"), type = c("normal",
  "bootstrap"), B = 100, complete = TRUE, ...)

## S3 method for class 'boot.cgaim'
vcov(object, parm = c("alpha", "beta"),
  complete = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A <code>cgaim</code> or <code>boot.cgaim</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parm</code></td>
<td>
<p>The model components for which to get confidence intervals. 
Either <code>"alpha"</code> (the default) for index weights or <code>"beta"</code> for scaling coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>The type of confidence intervals. Either <code>"normal"</code> (the default)
or <code>"bootstrap"</code>. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>The number of samples to be simulated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>complete</code></td>
<td>
<p>Indicates whether the full variance-covariance matrix should be returned when some of the parameters could not be estimated. If so, the matrix is padded with <code>NA</code>s.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters to be passed to <code>boot.cgaim</code> for bootstrap replications.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Two types of computation are currently implemented in the function.
When <code>type = "normal"</code>, variance-covariance matrices are computed assuming 
components are normally distributed. Beta coefficients are treated as
regular linear regression coefficients and alpha
coefficients are assumed to follow a Truncated Multivariate Normal distribution. 
The latter is obtained by simulating from TMVN (see <code>tmvnorm</code>) 
and computing the empirical variance covariance matrix from these simulations. The parameter <code>B</code> controls the number of simulations from the TMVN (and is not used when <code>parm = "beta"</code>).
</p>
<p>When <code>type = "bootstrap"</code>, the variance-covariance matrix is computed on Bootstrap replications. In this case <code>boot.cgaim</code> is called internally and <code>B</code> corresponds to the number of replications. Alternatively, the user can directly call <code>boot.cgaim</code> and feed the result into <code>vcov.boot.cgaim</code> (see examples).
</p>


<h3>Value</h3>

<p>A variance-covariance matrix object.
</p>


<h3>References</h3>

<p>Masselot, P. and others, 2022. Constrained groupwise additive index models.
Biostatistics.
</p>
<p>Pya, N., Wood, S.N., 2015. Shape constrained additive models. 
Stat. Comput. 25, 543â€“559. 
</p>
<p>Wood, S.N., 2017. Generalized Additive Models: An Introduction with R, 
2nd ed, Texts in Statistical Science. Chapman and Hall/CRC.
</p>


<h3>See Also</h3>

<p><code>boot.cgaim</code> for bootstrapping and <code>confint.cgaim</code> for confidence intervals.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># A simple CGAIM
n &lt;- 200
x1 &lt;- rnorm(n)
x2 &lt;- x1 + rnorm(n)
z &lt;- x1 + x2
y &lt;- z + rnorm(n)
df1 &lt;- data.frame(y, x1, x2) 
ans &lt;- cgaim(y ~ g(x1, x2, acons = list(monotone = 1)), data = df1)

# (Truncated) Normal variance-covariance matrix
set.seed(1)
vcov(ans, B = 1000)
set.seed(1)
vcov(ans, parm = "alpha", B = 1000) # Same result
vcov(ans, parm = "beta", B = 1000)

# Confidence intervals by bootstrap (more computationally intensive, B should be increased)
set.seed(2)
vcov(ans, type = "boot", B = 10)

# Alternatively, bootstrap samples can be performed beforehand
set.seed(2) 
boot1 &lt;- boot.cgaim(ans, B = 10)
vcov(boot1)

</code></pre>


</div>