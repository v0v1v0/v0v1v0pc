<div class="container">

<table style="width: 100%;"><tr>
<td>plot_2DprofileLikelihood</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>plot_2DprofileLikelihood</h2>

<h3>Description</h3>

<p>Make likelihood related values v.s. parameterValues plot using the function evaluations used during CGNM computation. Note plot_SSRsurface can only be used when log is saved by setting saveLog=TRUE option when running Cluster_Gauss_Newton_method().
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_2DprofileLikelihood(
  logLocation,
  index_x = NA,
  index_y = NA,
  plotType = 2,
  plotMax = NA,
  ParameterNames = NA,
  ReparameterizationDef = NA,
  numBins = NA,
  showInitialRange = TRUE,
  alpha = 0.25,
  Likelihood_function = Residual_function_def
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>logLocation</code></td>
<td>
<p>(required input) <em>A string or a list of strings</em> of folder directory where CGNM computation log files exist.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index_x</code></td>
<td>
<p>(default: NA) <em>A vector of strings or numbers</em> List parameter names or indices used for the surface plot. (if NA all parameters are used)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index_y</code></td>
<td>
<p>(default: NA) <em>A vector of strings or numbers</em> List parameter names or indices used for the surface plot. (if NA all parameters are used)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotType</code></td>
<td>
<p>(default: 2) <em>A number 0,1,2,3, or 4</em> 0: number of model evaluations done, 1: (1-alpha) where alpha is the significance level, this plot is recommended for the ease of visualization as it ranges from 0 to 1. 2: -2log likelihood. 3: SSR. 4: all points within 1-alpha confidence region</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotMax</code></td>
<td>
<p>(default: NA) <em>A number</em> the maximum value that will be plotted on surface plot. (If NA all values are included in the plot, note SSR or likelihood can range many orders of magnitudes fo may want to restrict when plotting them)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ParameterNames</code></td>
<td>
<p>(default: NA) <em>A vector of strings</em> the user can supply so that these names are used when making the plot. (Note if it set as NA or vector of incorrect length then the parameters are named as theta1, theta2, ... or as in ReparameterizationDef)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ReparameterizationDef</code></td>
<td>
<p>(default: NA) <em>A vector of strings</em> the user can supply definition of reparameterization where each string follows R syntax</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numBins</code></td>
<td>
<p>(default: NA) <em>A positive integer</em> 2D profile likelihood surface is plotted by finding the minimum SSR given two of the parameters are fixed and then repeat this for various values.  numBins specifies the number of different parameter values to fix for each parameter. (if set NA the number of bins are set as num_minimizersToFind/10)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showInitialRange</code></td>
<td>
<p>(default: TRUE) <em>TRUE or FALSE</em> if TRUE then the initial range appears in the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>(default: 0.25) <em>a number between 0 and 1</em> level of significance (all the points outside of this significance level will not be plotted when plot tyoe 1,2 or 4 are chosen).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Likelihood_function</code></td>
<td>
<p>(default: Residual_function_def) <em>a function</em> that takes CGNM_result and initial then to calculate a quantity to be sketched in logscale e.g. SSR) this was implemented to conduct pos hoc drawing of the profile likelihood by providing the new definition of likelihood after all CGNM calculations are done.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><em>A ggplot object</em> including the violin plot, interquartile range and median, minimum and maximum.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
model_analytic_function=function(x){

 observation_time=c(0.1,0.2,0.4,0.6,1,2,3,6,12)
 Dose=1000
 F=1

 ka=10^x[1]
 V1=10^x[2]
 CL_2=10^x[3]
 t=observation_time

 Cp=ka*F*Dose/(V1*(ka-CL_2/V1))*(exp(-CL_2/V1*t)-exp(-ka*t))

 log10(Cp)
}

observation=log10(c(4.91, 8.65, 12.4, 18.7, 24.3, 24.5, 18.4, 4.66, 0.238))

CGNM_result=Cluster_Gauss_Newton_method(
nonlinearFunction=model_analytic_function,
targetVector = observation,
initial_lowerRange = c(-1,-1,-1), initial_upperRange =  c(1,1,1),
num_iter = 10, num_minimizersToFind = 500, saveLog=TRUE)

## the minimum example
plot_2DprofileLikelihood("CGNM_log")

## we can draw profilelikelihood also including bootstrap result
CGNM_result=Cluster_Gauss_Newton_Bootstrap_method(CGNM_result,
                      nonlinearFunction = model_analytic_function)

## example with various options
plot_2DprofileLikelihood(c("CGNM_log","CGNM_log_bootstrap"),
 showInitialRange = TRUE,index_x = c("ka","V1"))
 
## End(Not run)
</code></pre>


</div>