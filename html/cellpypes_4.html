<div class="container">

<table style="width: 100%;"><tr>
<td>feat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Feature plots: Color gene expression in 2D embeddings</h2>

<h3>Description</h3>

<p>Highlight gene expression in UMAP embeddings, for example.
</p>


<h3>Usage</h3>

<pre><code class="language-R">feat(obj, features, fast = NULL, verbose = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>A cellpypes object, see section <strong>cellpypes Objects</strong> below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>features</code></td>
<td>
<p>A vector of genes (features) to colour by.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fast</code></td>
<td>
<p>Set this to TRUE if you want fast plotting in spite of many cells
(using the scattermore package). If NULL (default), cellpypes decides
automatically and fast plotting is done for more than 10k cells, if FALSE
it always uses <code>geom_point</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>feat ignores gene names not present in your object and
warns you about them by default. <code>verbose</code>=FALSE will suppress the warning
(not recommended in interactive use).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments passed to cowplot's plot_grid function,
for example ncol or rel_widths.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A ggplot object (assembled by cowplot).
</p>


<h3>cellpypes Objects</h3>

<p>A cellpypes object is a list with four slots:
</p>

<dl>
<dt><code>raw </code></dt>
<dd>
<p>(sparse) matrix with genes in rows, cells in columns</p>
</dd>
<dt><code>totalUMI </code></dt>
<dd>
<p>the colSums of obj$raw</p>
</dd>
<dt><code>embed </code></dt>
<dd>
<p>two-dimensional embedding of the cells, provided as data.frame
or tibble with two columns and one row per cell.</p>
</dd>
<dt><code>neighbors </code></dt>
<dd>
<p>index matrix with one row per cell and k columns, where
k is the number of nearest neighbors (we recommend 15&lt;k&lt;100, e.g. k=50).
Here are two ways to get the neighbors index matrix:
</p>

<ul>
<li>
<p> Use <code>find_knn(featureMatrix)$idx</code>, where featureMatrix could be
principal components, latent variables or normalized genes (features in
rows, cells in columns).
</p>
</li>
<li>
<p> use <code>as(seurat@graphs[["RNA_nn"]], "dgCMatrix")&gt; .1</code> to extract
the kNN
graph computed on RNA. The <code>&gt; .1</code> ensures this also works with RNA_snn,
wknn/wsnn or any other
available graph â€“ check with <code>names(seurat@graphs)</code>.
</p>
</li>
</ul>
</dd>
</dl>
<h3>Examples</h3>

<pre><code class="language-R">feat(simulated_umis, "CD3E")
</code></pre>


</div>