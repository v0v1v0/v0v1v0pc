<div class="container">

<table style="width: 100%;"><tr>
<td>convDir</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Convert a directory of raw DICOM images to material classes</h2>

<h3>Description</h3>

<p>Calculates the area and volume of material classes for each CT slice in a directory. This approach  directly replicates Earl Davey's manual classification approach. This method is deprecated as of coreCT version 1.3.0.
</p>


<h3>Usage</h3>

<pre><code class="language-R">convDir(directory = file.choose(), upperLim = 3045, lowerLim = -1025, 
airHU = -850.3233, airSD = 77.6953, 
SiHU = 271.7827, SiSD = 39.2814,
glassHU = 1345.0696, glassSD = 45.4129,
waterHU = 63.912, waterSD = 14.1728,
densities = c(0.0012, 1, 1.23, 2.2),
rootData = TRUE, 
diameter.classes = c(1, 2, 2.5, 10), 
class.names = diameter.classes,
pixel.minimum = 4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>directory</code></td>
<td>
<p>a character string that can be a matrix of DICOM images or the address of an individual DICOM file in a folder of DICOM images. The default action is &lt;code&gt;file.choose()&lt;/code&gt;; a browser menu appears so the user can select the the desired directory by identifying a single DICOM file in the folder of images.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upperLim</code></td>
<td>
<p>upper bound cutoff for pixels (Hounsfield Units)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lowerLim</code></td>
<td>
<p>lower bound cutoff for pixels (Hounsfield Units)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>airHU</code></td>
<td>
<p>mean value for air-filled calibration rod (Hounsfield Units)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>airSD</code></td>
<td>
<p>standard deviation for air-filled calibration rod</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SiHU</code></td>
<td>
<p>mean value for colloidal silica calibration rod</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SiSD</code></td>
<td>
<p>standard deviation for colloidal Si calibration rod</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>glassHU</code></td>
<td>
<p>mean value for glass calibration rod</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>glassSD</code></td>
<td>
<p>standard deviation for glass calibration rod</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>waterHU</code></td>
<td>
<p>mean value for water filled calibration rod</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>waterSD</code></td>
<td>
<p>standard deviation for water filled calibration rod</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>densities</code></td>
<td>
<p>numeric vector of known cal rod densities. Format must be c(air, water, Si, glass)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rootData</code></td>
<td>
<p>if TRUE, <code>rootSize</code> is also called on the matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diameter.classes</code></td>
<td>
<p>if rootData is TRUE, this argument provides an integer vector of diameter cut points used by <code>rootSize</code>. Units are mm (zero is added in automatically).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>class.names</code></td>
<td>
<p>placeholder, not used presently</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pixel.minimum</code></td>
<td>
<p>minimum number of pixels needed for a clump to be identified as a root</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Calculates the area and volume of material classes for each CT slice in a directory. Unlike <code>conv</code>, <code>convDir</code> accepts a folder of raw values and makes the conversion to Hounsfield Units using the metadata associated with the DICOM images.
</p>


<h3>Value</h3>

<p>value <code>convDir</code> returns a dataframe with one row per CT slice. Values returned are the area and volume of seven material classes: gas, peat, roots and rhizomes, rock and shell, fine mineral particles, sand, and water. If <code>rootData = TRUE</code>, the output will also contain data on the abundance (number of particles), volume (cm3), and external surface area (cm2) of the root size classes specified in the <code>diameter.classes</code> argument.
</p>


<h3>See Also</h3>

<p><code>convDir</code> is a wrapper for <code>conv</code>. <code>rootSizeDir</code> operates similarly.
</p>


<h3>Examples</h3>

<pre><code class="language-R">materials &lt;- convDir("core_426", rootData = FALSE)


## Not run:  
# plot using "ggplot" package after transforming with "reshape2" package
mass.long &lt;- reshape2::melt(materials, id.vars = c("depth"), 
   measure.vars = grep(".g", names(materials)))
ggplot2::ggplot(data = mass.long, ggplot2::aes(y = -depth, x = value, 
   color = variable)) + ggplot2::geom_point() + ggplot2::theme_classic() + 
   ggplot2::xlab("mass per section (g)") 

## End(Not run)

</code></pre>


</div>