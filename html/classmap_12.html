<div class="container">

<table style="width: 100%;"><tr>
<td>vcr.da.newdata</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Carry out discriminant analysis on new data, and prepare to visualize its results.
</h2>

<h3>Description</h3>

<p>Predicts class labels for new data by discriminant analysis, using the output of <code>vcr.da.train</code> on the training data. For new data cases whose label in <code>yintnew</code> is non-missing, additional output is produced for constructing graphical displays such as the <code>classmap</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">vcr.da.newdata(Xnew, ynew=NULL, vcr.da.train.out)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Xnew</code></td>
<td>
<p>data matrix of the new data, with the same number of columns as in the training data. Missing values are not allowed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ynew</code></td>
<td>
<p>factor with class membership of each new case. Can be <code>NA</code> for some or all cases. If <code>NULL</code>, is assumed to be <code>NA</code> everywhere.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcr.da.train.out</code></td>
<td>
<p>output of <code>vcr.da.train</code> on the training data.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with components: <br></p>
<table>
<tr style="vertical-align: top;">
<td><code>yintnew</code></td>
<td>
<p>number of the given class of each case. Can contain <code>NA</code>'s.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ynew </code></td>
<td>
<p>given class label of each case. Can contain <code>NA</code>'s.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>levels </code></td>
<td>
<p>levels of the response, from <code>vcr.da.train.out</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predint</code></td>
<td>
<p>predicted class number of each case. Always exists.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred</code></td>
<td>
<p>predicted label of each case.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>altint</code></td>
<td>
<p>number of the alternative class. Among the classes different from the given class, it is the one with the highest posterior probability. Is <code>NA</code> for cases whose <code>ynew</code> is missing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>altlab</code></td>
<td>
<p>label of the alternative class. Is <code>NA</code> for cases whose <code>ynew</code> is missing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PAC</code></td>
<td>
<p>probability of the alternative class. Is <code>NA</code> for cases whose <code>ynew</code> is missing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fig</code></td>
<td>
<p>distance of each case <code class="reqn">i</code> to each class <code class="reqn">g</code>. Always exists.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>farness</code></td>
<td>
<p>farness of each case <code class="reqn">i</code> from its given class. Is <code>NA</code> for cases whose <code>ynew</code> is missing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ofarness</code></td>
<td>
<p>For each case <code class="reqn">i</code>, its lowest <code>fig[i,g]</code> to any class <code>g</code>. Always exists.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>classMS</code></td>
<td>
<p>list with center and covariance matrix of each class, from <code>vcr.da.train.out</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lCurrent</code></td>
<td>
<p>log of mixture density of each case in its given class. Is <code>NA</code> for cases with missing <code>ynew</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lPred</code></td>
<td>
<p>log of mixture density of each case in its predicted class. Always exists.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lAlt</code></td>
<td>
<p>log of mixture density of each case in its alternative class. Is <code>NA</code> for cases with missing <code>ynew</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Raymaekers J., Rousseeuw P.J.
</p>


<h3>References</h3>

<p>Raymaekers J., Rousseeuw P.J., Hubert M. (2021). Class maps for visualizing classification results. <em>Technometrics</em>, appeared online. doi: <a href="https://doi.org/10.1080/00401706.2021.1927849">10.1080/00401706.2021.1927849</a>(link to open access pdf)
</p>


<h3>See Also</h3>

<p><code>vcr.da.train</code>, <code>classmap</code>, <code>silplot</code>, <code>stackedplot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
vcr.train &lt;- vcr.da.train(iris[, 1:4], iris[, 5])
inds &lt;- c(51:150) # a subset, containing only 2 classes
iris2 &lt;- iris[inds, ] # fake "new" data
iris2[c(1:10, 51:60), 5] &lt;- NA
vcr.test &lt;- vcr.da.newdata(iris2[, 1:4], iris2[, 5], vcr.train)
vcr.test$PAC[1:25] # between 0 and 1. Is NA where the response is.
plot(vcr.test$PAC, vcr.train$PAC[inds]); abline(0, 1) # match
plot(vcr.test$farness, vcr.train$farness[inds]); abline(0, 1) # match
confmat.vcr(vcr.train) # for comparison
confmat.vcr(vcr.test)
stackedplot(vcr.train) # for comparison
stackedplot(vcr.test)
classmap(vcr.train, "versicolor", classCols = 2:4) # for comparison
classmap(vcr.test, "versicolor", classCols = 2:4) # has fewer points

# For more examples, we refer to the vignette:
## Not run: 
vignette("Discriminant_analysis_examples")

## End(Not run)
</code></pre>


</div>