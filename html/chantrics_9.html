<div class="container">

<table style="width: 100%;"><tr>
<td>adj_loglik</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Loglikelihood adjustments for fitted models</h2>

<h3>Description</h3>

<p>This function adjusts the loglikelihood of fitted model objects based on
Chandler and Bate (2007). It is a
generic function for different types of models, which are listed in
<strong>Supported models</strong>. This section also contains links to function-specific
help pages.
</p>


<h3>Usage</h3>

<pre><code class="language-R">adj_loglik(x, cluster = NULL, use_vcov = TRUE, use_mle = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A supported fitted model object, see <strong>Supported models</strong></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>A vector or factor indicating the cluster the corresponding
loglikelihood contribution belongs to. It is required to have the same
length as the vector returned by <code>logLik_vec()</code>. If <code>cluster</code> is not
supplied or <code>NULL</code>, then it is assumed that each observation forms its own
cluster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_vcov</code></td>
<td>
<p>A logical scalar. By default, the <code>vcov()</code> method for <code>x</code> is
used to estimate the Hessian of the independence loglikelihood, if the
function exists. Otherwise, or if <code>use_vcov = FALSE</code>, <code>H</code> is estimated
using <code>stats::optimHess()</code> inside <code>chandwich::adjust_loglik()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_mle</code></td>
<td>
<p>A logical scalar. By default, the MLE from <code>x</code> is taken as
given, and is not reestimated. By setting <code>use_mle</code> to <code>FALSE</code>, the parameters
are reestimated in the function <code>chandwich::adjust_loglik()</code> using
<code>stats::optim()</code>.This feature is currently for development purposes only,
may return misleading/false results and may be removed without notice.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed to <code>sandwich::meatCL()</code> if
<code>cluster</code> is defined, if <code>cluster = NULL</code>, they are passed into
<code>sandwich::meat()</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>use_vcov = TRUE</code>, the current default, the function will test
whether a <code>vcov</code> S3 method exists for <code>x</code>, and will take the
variance-covariance matrix from there. Otherwise, or if <code>use_vcov = FALSE</code>
the variance-covariance matrix of the MLE is estimated inside
<code>chandwich::adjust_loglik()</code> using <code>stats::optimHess()</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>"chantrics"</code> inheriting from class <code>"chandwich"</code>.
See the documentation provided with <code>chandwich::adjust_loglik()</code>.
</p>


<h3>Supported models</h3>


<ul>
<li> <p>glm
</p>
</li>
<li> <p>glm.nb
</p>
</li>
</ul>
<h3>Available methods</h3>

<p><code>"chantrics"</code> objects have the following methods available to them:
</p>

<ul>
<li> <p><code>AIC</code>
</p>
</li>
<li> <p><code>anova</code>
</p>
</li>
<li> <p><code>alrtest</code> - Adjusted Likelihood ratio tests
</p>
</li>
<li> <p><code>coef</code>
</p>
</li>
<li> <p><code>lmtest::coeftest</code> - \(z\) tests for all
coefficients
</p>
</li>
<li> <p><code>confint</code>
and <code>plot.confint</code> - confidence intervals for
all coefficients, and diagnostics plots for <code>confint()</code>.
</p>
</li>
<li> <p><code>conf_intervals</code> - enhanced confidence
interval reports
</p>
</li>
<li> <p><code>conf_region</code> - two-dimensional confidence
regions
</p>
</li>
<li> <p><code>df.residual</code>
</p>
</li>
<li> <p><code>fitted</code>
</p>
</li>
<li> <p><code>logLik</code>
</p>
</li>
<li> <p><code>logLik_vec</code>
</p>
</li>
<li> <p><code>nobs</code>
</p>
</li>
<li> <p><code>plot</code>
</p>
</li>
<li> <p><code>predict</code>
</p>
</li>
<li> <p><code>print</code>
</p>
</li>
<li> <p><code>residuals</code>
</p>
</li>
<li> <p><code>summary</code>
</p>
</li>
<li> <p><code>terms</code>
</p>
</li>
<li> <p><code>vcov</code>
</p>
</li>
</ul>
<h3>Examples</h3>

<p>See the model-specific pages in the <em>supported models</em>
section.
</p>


<h3>References</h3>

<p>R. E. Chandler and S. Bate, Inference for clustered data using the
independence loglikelihood, Biometrika, 94 (2007), pp. 167â€“183.
doi: <a href="https://doi.org/10.1093/biomet/asm015">10.1093/biomet/asm015</a>.
</p>


<h3>See Also</h3>

<p><code>lax::alogLik()</code> supports adjustment for user-supplied objects.
</p>


</div>