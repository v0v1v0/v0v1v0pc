<div class="container">

<table style="width: 100%;"><tr>
<td>as.mbsts</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Definition and estimation of a Multivariate Bayesian Structural Time Series model (MBSTS)</h2>

<h3>Description</h3>

<p>The function creates a multivariate Bayesian structural time series model. It then estimates
the model, samples from the joint posterior distribution of its parameters, and outputs an
object of class <code>mbsts</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">as.mbsts(
  y,
  components,
  seas.period = NULL,
  cycle.period = NULL,
  X = NULL,
  H = NULL,
  nu0.r = NULL,
  s0.r = 0.01 * var(y, na.rm = TRUE),
  nu0.eps = NULL,
  s0.eps = 0.01 * var(y, na.rm = TRUE),
  niter,
  burn,
  ping = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>t x d data.frame (or matrix) of observations, where d is the number of time series
in the multivariate model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>components</code></td>
<td>
<p>Character vector specifying the components of the multivariate structural
time series model. Possible values are c("trend", "slope", "seasonal", "cycle").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seas.period</code></td>
<td>
<p>Length of the seasonal pattern, if present.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cycle.period</code></td>
<td>
<p>Length of the cycle pattern, if present.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Optional t x N data frame (or matrix) of N predictors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>
<p>P x P variance-covariance matrix of the regression coefficients. Set by
default to H = c(X'X)^(-1) which is akin to the Zellner's g-prior. The value of
the scaling factor is set to <code>c = 1</code>. Alternative priors could be
H = c*diag((X'X)^(-1)) or H = c*I. See also Smith &amp; Kohn, 1995 that suggest
setting <code>c</code> in the range [10,1000].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu0.r</code></td>
<td>
<p>Degrees of freedom of the Inverse-Wishart prior for each element of
Sigma.r, a vector of errors for state r. Set by default to d + 2
(must be greater than d - 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s0.r</code></td>
<td>
<p>Scale matrix of the Inverse-Wishart prior for each Sigma.r, a vector
of errors for state r. Must be a (d x d) positive definite. Default set to the
variance-covariance matrix of y multiplied by a scaling factor of 0.01.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu0.eps</code></td>
<td>
<p>Degrees of freedom of the Inverse-Wishart prior for Sigma.eps,
a vector of observation errors for each time series. Set by default to d + 2
(must be greater than d - 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s0.eps</code></td>
<td>
<p>Scale matrix of the Inverse-Wishart prior for Sigma.eps, a vector
of observation errors for each time series. Must be a (d x d) positive definite.
Default set to Default set to the variance-covariance matrix of y multiplied by
a scaling factor of 0.01.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niter</code></td>
<td>
<p>Number of MCMC iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn</code></td>
<td>
<p>Desired burn-in, set by default to 0.1 * <code>niter</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ping</code></td>
<td>
<p>A status message is printed every <code>ping</code> iteration. Default
set to 0.1 * <code>niter</code>. Set to 0 to not track the status.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class 'mbsts' which is a list with the following components:
</p>

<dl>
<dt>eta.samples</dt>
<dd>
<p>(<code>niter</code>- <code>burn</code>) draws from the distribution of eta_r.</p>
</dd>
<dt>eps.samples</dt>
<dd>
<p>(<code>niter</code>- <code>burn</code>) draws from the distribution of eps.</p>
</dd>
<dt>states.samples</dt>
<dd>
<p>(<code>niter</code>- <code>burn</code>) draws from p(alpha_t | Y_1:T).</p>
</dd>
<dt>Sigma.r</dt>
<dd>
<p>(<code>niter</code>- <code>burn</code>) draws from the posterior distribution of Sigma.r.</p>
</dd>
<dt>Sigma.eps</dt>
<dd>
<p>(<code>niter</code>- <code>burn</code>) draws from the posterior distribution of Sigma.eps.</p>
</dd>
<dt>Z.beta</dt>
<dd>
<p>(<code>niter</code>- <code>burn</code>) x P matrix of the models selected at each
iteration (if a matrix of predictors is provided).</p>
</dd>
<dt>beta</dt>
<dd>
<p> P x d x (<code>niter</code>- <code>burn</code>) ) array of the draws from the posterior
distribution of the regression coefficient matrix (if a matrix of predictors is provided).</p>
</dd>
<dt>X</dt>
<dd>
<p>Predictor matrix (if provided).</p>
</dd>
<dt>y</dt>
<dd>
<p>Matrix of observations.</p>
</dd>
<dt>Z</dt>
<dd>
<p>(d x m) selection matrix of the observation equation.</p>
</dd>
<dt>Tt</dt>
<dd>
<p>(m x m) matrix of the state equation.</p>
</dd>
<dt>R</dt>
<dd>
<p>(m x r) matrix selecting the state disturbances.</p>
</dd>
<dt>niter</dt>
<dd>
<p>Number of mcmc iterations.</p>
</dd>
<dt>burn</dt>
<dd>
<p>Burn-in.</p>
</dd>
</dl>
<h3>Examples</h3>

<pre><code class="language-R">## Example 1 : local level + seasonal (d = 3)
y &lt;- cbind(seq(0.5,100,by=0.5)*0.1 + rnorm(200),
           seq(100.25,150,by=0.25)*0.05 + rnorm(200),
           rnorm(200, 5,1))
mbsts.1 &lt;- as.mbsts(y = y, components = c("trend", "seasonal"), seas.period = 7,
                    s0.r = diag(3), s0.eps = diag(3), niter = 50, burn = 5)

## Example 2 : local level + seasonal + covariates (d = 2)
y &lt;- cbind(rnorm(100), rnorm(100, 2, 3))
X &lt;- cbind(rnorm(100, 0.5, 1) + 5, rnorm(100, 0.2, 2) - 2)
mbsts.2 &lt;- as.mbsts(y = y, components = c("trend", "seasonal"), , seas.period = 7,
                    X = X, s0.r = diag(2), s0.eps = diag(2), niter = 100, burn = 10)
</code></pre>


</div>