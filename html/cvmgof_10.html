<div class="container">

<table style="width: 100%;"><tr>
<td>df.statistics</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Global test statistic for the conditional distribution function</h2>

<h3>Description</h3>

<p>This function computes the global test statistic for the conditional distribution function.</p>


<h3>Usage</h3>

<pre><code class="language-R">df.statistics(data.X, data.Y, cdf.H0, bandwidth,
    kernel.function = kernel.function.epan, integration.step = 0.01)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data.X</code></td>
<td>
<p>a numeric data vector used to obtain the nonparametric estimator of the conditional distribution function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.Y</code></td>
<td>
<p>a numeric data vector used to obtain the nonparametric estimator of the conditional distribution function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cdf.H0</code></td>
<td>
<p>the conditional distribution function under the null hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bandwidth</code></td>
<td>
<p>bandwidth used to obtain the nonparametric estimator of the conditional distribution function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel.function</code></td>
<td>
<p>kernel function used to obtain the nonparametric estimator of the conditional distribution function. Default option is "kernel.function.epan".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>integration.step</code></td>
<td>
<p>a numeric value specifying integration step. Default is <code>integration.step</code> = 0.01.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>An inappropriate bandwidth choice can produce "NaN" values in cumulative distribution function estimates.</p>


<h3>Author(s)</h3>

<p>Romain Azais, Sandie Ferrigno and Marie-Jose Martinez</p>


<h3>References</h3>

<p>G. R. Ducharme and S. Ferrigno. An omnibus test of goodness-of-fit for conditional distributions
with applications to regression models. <em>Journal of Statistical Planning and
Inference</em>, 142, 2748:2761, 2012.
</p>
<p>R. Azais, S. Ferrigno and M-J Martinez. cvmgof: An R package for Cramer-von Mises goodness-of-fit tests in regression models. Submitted. January 2021.<a href="https://hal.archives-ouvertes.fr/hal-03101612">hal-03101612</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Uncomment the following code block
#
# set.seed(1)
#
# # Data simulation
# n = 25 # Dataset size
# data.X = runif(n,min=0,max=5) # X
# data.Y = 0.2*data.X^2-data.X+2+rnorm(n,mean=0,sd=0.3) # Y
#
# ########################################################################
#
# # Bandwidth selection under H0
#
# # We want to test if the link function is f(x)=0.2*x^2-x+2
# # The answer is yes (see the definition of data.Y above)
# # We generate a dataset under H0 to estimate the optimal bandwidth under H0
#
# linkfunction.H0 = function(x){0.2*x^2-x+2}
#
# data.X.H0 = runif(n,min=0,max=5)
# data.Y.H0 = linkfunction.H0(data.X.H0)+rnorm(n,mean=0,sd=0.3)
#
# h.opt.df = df.bandwidth.selection.linkfunction(data.X.H0, data.Y.H0,linkfunction.H0)
#
# ########################################################################
#
# # Test statistics under H0
#
# cond_cdf.H0 = function(x,y)
# {
#   out=matrix(0,nrow=length(x),ncol=length(y))
#   for (i in 1:length(x)){
#     x0=x[i]
#     out[i,]=pnorm(y-linkfunction.H0(x0),0,0.3)
#   }
#   out
# }
# # cond_cdf.H0 is the conditional CDF associated with linkfunction.H0
# # with additive Gaussian noise (standard deviation=0.3)
#
# df.statistics(data.X,data.Y,cond_cdf.H0,h.opt.df)
</code></pre>


</div>