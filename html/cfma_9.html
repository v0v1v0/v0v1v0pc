<div class="container">

<table style="width: 100%;"><tr>
<td>FMA.historical.boot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Functional mediation analysis under historical influence regression model with point-wise bootstrap confidence interval
</h2>

<h3>Description</h3>

<p> This function performs functional mediation regression under the historical influence model with given tuning parameter. Point-wise confidence bands are obtained from bootstrap.
</p>


<h3>Usage</h3>

<pre><code class="language-R">FMA.historical.boot(Z, M, Y, delta.grid1 = 1, delta.grid2 = 1, delta.grid3 = 1, 
    intercept = TRUE, basis1 = NULL, Ld2.basis1 = NULL, basis2 = NULL, Ld2.basis2 = NULL, 
    basis.type = c("fourier"), nbasis1 = 3, nbasis2 = 3, 
    timeinv = c(0, 1), timegrids = NULL, 
    lambda1.m = 0.01, lambda2.m = 0.01, lambda1.y = 0.01, lambda2.y = 0.01, 
    sims = 1000, boot = TRUE, boot.ci.type = c("bca", "perc"), 
    conf.level = 0.95, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p> a data matrix. <code>Z</code> is the treatment trajectory in the mediation analysis. The number of rows is the number of subjects, and the number of columns is the number of measured time points.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p> a data matrix. <code>M</code> is the mediator trajectory in the mediation analysis. The number of rows is the number of subjects, and the number of columns is the number of measured time points.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p> a data matrix. <code>Y</code> is the outcome trajectory in the mediation analysis. The number of rows is the number of subjects, and the number of columns is the number of measured time points.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta.grid1</code></td>
<td>
<p> a number indicates the width of treatment-mediator time interval in the mediator model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta.grid2</code></td>
<td>
<p> a number indicates the width of treatment-outcome time interval in the outcome model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta.grid3</code></td>
<td>
<p> a number indicates the width of mediator-outcome time interval in the outcome model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p> a logic variable. Default is <code>TRUE</code>, an intercept term is included in the regression model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basis1</code></td>
<td>
<p> a data matrix. Basis function on the <code class="reqn">s</code> domain used in the functional data analysis. The number of columns is the number of basis function considered. If <code>basis = NULL</code>, Fourier basis functions will be generated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ld2.basis1</code></td>
<td>
<p> a data matrix. The second derivative of the basis function on the <code class="reqn">s</code> domain. The number of columns is the number of basis function considered. If <code>Ld2.basis = NULL</code>, the second derivative of Fourier basis functions will be generated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basis2</code></td>
<td>
<p> a data matrix. Basis function on the <code class="reqn">t</code> domain used in the functional data analysis. The number of columns is the number of basis function considered. If <code>basis = NULL</code>, Fourier basis functions will be generated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ld2.basis2</code></td>
<td>
<p> a data matrix. The second derivative of the basis function on the <code class="reqn">t</code> domain. The number of columns is the number of basis function considered. If <code>Ld2.basis = NULL</code>, the second derivative of Fourier basis functions will be generated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basis.type</code></td>
<td>
<p> a character of basis function type. Default is Fourier basis (<code>basis.type = "fourier"</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbasis1</code></td>
<td>
<p> an integer, the number of basis function on the <code class="reqn">s</code> domain included. If <code>basis1</code> is provided, this argument will be ignored.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbasis2</code></td>
<td>
<p> an integer, the number of basis function on the <code class="reqn">t</code> domain included. If <code>basis2</code> is provided, this argument will be ignored.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timeinv</code></td>
<td>
<p> a numeric vector of length two, the time interval considered in the analysis. Default is (0,1).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timegrids</code></td>
<td>
<p> a numeric vector of time grids of measurement. If <code>timegrids = NULL</code>, it is assumed the between measurement time interval is constant.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda1.m</code></td>
<td>
<p> a numeric vector of tuning parameter values on the <code class="reqn">s</code> domain in the mediator model. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda2.m</code></td>
<td>
<p> a numeric vector of tuning parameter values on the <code class="reqn">t</code> domain in the mediator model. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda1.y</code></td>
<td>
<p> a numeric vector of tuning parameter values on the <code class="reqn">s</code> domain in the outcome model. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda2.y</code></td>
<td>
<p> a numeric vector of tuning parameter values on the <code class="reqn">t</code> domain in the outcome model. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sims</code></td>
<td>
<p> an integer indicating the number of simulations for inference.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot</code></td>
<td>
<p> a logical value, indicating whether or not bootstrap should be used. Default is <code>TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot.ci.type</code></td>
<td>
<p> a character of confidence interval method. <code>boot.ci.type = "bca"</code> bias corrected confidence interval; <code>boot.ci.type = "perc"</code> percentile confidence interval.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p> a number of significance level. Default is 0.95.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p> a logical value, indicating whether print out bootstrap replications.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p> The historical influence mediation model is
</p>
<p style="text-align: center;"><code class="reqn">M(t)=\int_{\Omega_{t}^{1}}Z(s)\alpha(s,t)ds+\epsilon_{1}(t),</code>
</p>

<p style="text-align: center;"><code class="reqn">Y(t)=\int_{\Omega_{t}^{2}}Z(s)\gamma(s,t)ds+\int_{\Omega_{t}^{3}}M(s)\beta(s,t)ds+\epsilon_{2}(t),</code>
</p>

<p>where <code class="reqn">\alpha(s,t)</code>, <code class="reqn">\beta(s,t)</code>, <code class="reqn">\gamma(s,t)</code> are coefficient curves; <code class="reqn">\Omega_{t}^{j}=[(t-\delta_{j})\vee 0,t]</code> for <code class="reqn">j=1,2,3</code>. The model coefficient curves are estimated by minimizing the penalized <code class="reqn">L_{2}</code>-loss.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>a list of output for <code class="reqn">\alpha</code> estimate
</p>
<p><code>coefficients</code>: the result of the coefficient estimates corresponding to the basis function
</p>
<p><code>curve</code>: the point-wise estimate of the coefficient curve
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>a list of output for <code class="reqn">\gamma</code> estimate
</p>
<p><code>coefficients</code>: the result of the coefficient estimates corresponding to the basis function
</p>
<p><code>curve</code>: the point-wise estimate of the coefficient curve
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>a list of output for <code class="reqn">\beta</code> estimate
</p>
<p><code>coefficients</code>: the result of the coefficient estimates corresponding to the basis function
</p>
<p><code>curve</code>: the point-wise estimate of the coefficient curve
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>IE</code></td>
<td>
<p>a list of output for indirect effect estimate
</p>
<p><code>curve</code>: the point-wise estimate of the coefficient curve
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DE</code></td>
<td>
<p>a list of output for direct effect estimate
</p>
<p><code>curve</code>: the point-wise estimate of the coefficient curve
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Yi Zhao, Johns Hopkins University, <a href="mailto:zhaoyi1026@gmail.com">zhaoyi1026@gmail.com</a>;
</p>
<p>Xi Luo, Brown University <a href="mailto:xi.rossi.luo@gmail.com">xi.rossi.luo@gmail.com</a>; 
</p>
<p>Martin Lindquist, Johns Hopkins University, <a href="mailto:mal2053@gmail.com">mal2053@gmail.com</a>; 
</p>
<p>Brian Caffo, Johns Hopkins University, <a href="mailto:bcaffo@gmail.com">bcaffo@gmail.com</a>
</p>


<h3>References</h3>

<p>Zhao et al. (2017). <em>Functional Mediation Analysis with an Application to Functional Magnetic Resonance Imaging Data.</em> arXiv preprint arXiv:1805.06923.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
##################################################
# Historical influence functional mediation model
data(env.historical)
Z&lt;-get("Z",env.historical)
M&lt;-get("M",env.historical)
Y&lt;-get("Y",env.historical)


# consider Fourier basis
fit.boot&lt;-FMA.historical.boot(Z,M,Y,delta.grid1=3,delta.grid2=3,delta.grid3=3,
    intercept=FALSE,timeinv=c(0,300))

##################################################
</code></pre>


</div>