<div class="container">

<table style="width: 100%;"><tr>
<td>pdotaprox</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculating Pdot-approximation coefficients</h2>

<h3>Description</h3>

<p>The function provides the Pdot-approximation coefficients of the defined Chebyshev polynomials in <code>aproxdef</code>.
For now, only unidimensional case is developed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pdotaprox(aproxspace, stock, sdot, dsdotds, dsdotdss, dwds, dwdss)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>aproxspace</code></td>
<td>
<p>An approximation space defined by <code>aproxdef</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stock</code></td>
<td>
<p>An array of stock, <code class="reqn">s</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdot</code></td>
<td>
<p>An array of ds/dt, <code class="reqn">\dot{s}=\frac{ds}{dt}</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dsdotds</code></td>
<td>
<p>An array of d(sdot)/ds, <code class="reqn">\frac{d \dot{s}}{d s}</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dsdotdss</code></td>
<td>
<p>An array of d/ds(d(sdot)/ds), <code class="reqn"> \frac{d}{ds} \left( \frac{d \dot{s}}{ds} \right)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dwds</code></td>
<td>
<p>An array of dw/ds, <code class="reqn">\frac{dW}{ds}</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dwdss</code></td>
<td>
<p>An array of d/ds(dw/ds), <code class="reqn">\frac{d}{ds} \left( \frac{dW}{ds} \right)</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Pdot-approximation is finding the shadow price of a stock, <code class="reqn">p</code> from the relation:<br><br><code class="reqn">p(s) = \frac{W_{s}(s) + \dot{p}(s)}{\delta - \dot{s}_{s}}</code>, <br><br>
where <code class="reqn">W_{s} = \frac{dW}{ds}</code>, <code class="reqn"> \dot{p}(s) = \frac{dp}{ds}</code>,
<code class="reqn">\dot{s}_{s} = \frac{d\dot{s}}{ds} </code>, and <code class="reqn">\delta</code> is the given discount rate.<br><br>
In order to operationalize this approach, we take the time derivative of this expression:<br><br><code class="reqn"> \dot{p} = \frac{ \left( \left(W_{ss}\dot{s} + \ddot{p} \right) \left( \delta - \dot{s}_{s} \right) +
   \left( W_{s} + \dot{p} \right) \left(\dot{s}_{ss} \dot{s} \right)  \right)  }
   { \left( \delta - \dot{s}_{s} \right)^{2} } </code> <br><br>
Consider approximation <code class="reqn"> \dot{p}(s) = \mathbf{\mu}(s)\mathbf{\beta}</code>, <code class="reqn">\mathbf{\mu}(s)</code>
is Chebyshev polynomials and <code class="reqn">\mathbf{\beta}</code> is their coeffcients.
Then, <code class="reqn"> \ddot{p} = \frac{ d \dot{p}}{ds} \frac{ds}{dt} = diag (\dot{s}) \mathbf{\mu}_{s}(s) \mathbf{\beta}</code> by the orthogonality of Chebyshev basis.
Adopting the properties above, we can get the unknown coefficient vector <code class="reqn">\beta</code> from:<br><br><code class="reqn"> \mathbf{\mu \beta} =  diag \left( \delta - \dot{s}_{s} \right)^{-2}
   \left[ \left(W_{ss}\dot{s} + diag (\dot{s}) \mathbf{\mu}_{s} \mathbf{\beta} \right)\left( \delta - \dot{s}_{s} \right) +
   diag \left(\dot{s}_{ss} \dot{s} \right) \left( W_{s} + \mathbf{\mu \beta} \right) \right] </code>, and <br><br><code class="reqn">\mathbf{\beta} = \left[ diag \left( \delta - \dot{s}_{s} \right)^{2} \mathbf{\mu} - diag \left( \dot{s}\left( \delta - \dot{s}_{s} \right) \right) \mathbf{\mu}_{s}
    - diag (\dot{s}_{ss} \dot{s} ) \mathbf{\mu}   \right]^{-1}
    \left( W_{ss} \dot{s} \left( \delta - \dot{s}_{s} \right) + W_{s} \dot{s}_{ss} \dot{s} \right) </code>.  <br><br>
If we suppose <code class="reqn"> A = \left[ diag \left( \delta - \dot{s}_{s} \right)^{2} \mathbf{\mu} - diag \left( \dot{s}\left( \delta - \dot{s}_{s} \right) \right) \mathbf{\mu}_{s}
    - diag (\dot{s}_{ss} \dot{s} ) \mathbf{\mu}    \right] </code> and <br><code class="reqn"> B = \left( W_{ss} \dot{s} \left( \delta - \dot{s}_{s} \right) + W_{s} \dot{s}_{ss} \dot{s} \right) </code>,
then over-determined case can be calculated:<br><br><code class="reqn"> \mathbf{\beta} = \left( A^{T}A \right)^{-1} A^{T}B </code>.<br><br>
For more detils see <a href="http://www.journals.uchicago.edu/doi/abs/10.1086/676034">Fenichel and Abbott (2014)</a>.
</p>


<h3>Value</h3>

<p>A list of approximation results: deg, lb, ub, delta, and coefficients. Use <code>results$item</code> <br> (or <code>results[["item"]]</code>) to import each result item.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>degree</code></td>
<td>
<p>degree of Chebyshev polynomial</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lowerB</code></td>
<td>
<p>lower bound of Chebyshev nodes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upperB</code></td>
<td>
<p>upper bound of Chebyshev nodes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>discount rate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficient</code></td>
<td>
<p>Chebyshev polynomial coefficients</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Fenichel, Eli P. and Joshua K. Abbott. (2014) "<a href="http://www.journals.uchicago.edu/doi/abs/10.1086/676034">Natural Capital: From Metaphor to Measurement</a>."
<em>Journal of the Association of Environmental Economists</em>. 1(1/2):1-27.<br></p>


<h3>See Also</h3>

<p><code>aproxdef, pdotsim</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## 1-D Reef-fish example: see Fenichel and Abbott (2014)
data("GOM")
nodes &lt;- chebnodegen(param$nodes,param$lowerK,param$upperK)
simuDataPdot &lt;- cbind(nodes,sdot(nodes,param),
                      dsdotds(nodes,param),dsdotdss(nodes,param),
                      dwds(nodes,param),dwdss(nodes,param))
Aspace &lt;- aproxdef(param$order,param$lowerK,param$upperK,param$delta)
pdotC &lt;- pdotaprox(Aspace,simuDataPdot[,1],simuDataPdot[,2],
                   simuDataPdot[,3],simuDataPdot[,4],
                   simuDataPdot[,5],simuDataPdot[,6])
</code></pre>


</div>