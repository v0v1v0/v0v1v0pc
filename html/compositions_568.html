<div class="container">

<table style="width: 100%;"><tr>
<td>rMahalanobis</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute distributions of empirical Mahalanobis distances based on
simulations</h2>

<h3>Description</h3>

<p>Decissions about outliers are often made based on Mahalanobis
distances with respect to robustly estimated variances. These function
deliver the necessary distributions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rEmpiricalMahalanobis(n,N,d,...,sorted=FALSE,pow=1,robust=TRUE)
pEmpiricalMahalanobis(q,N,d,...,pow=1,replicates=100,resample=FALSE,
                        robust=TRUE)
qEmpiricalMahalanobis(p,N,d,...,pow=1,replicates=100,resample=FALSE,
                        robust=TRUE)
rMaxMahalanobis(n,N,d,...,pow=1,robust=TRUE)
pMaxMahalanobis(q,N,d,...,pow=1,replicates=998,resample=FALSE,
                        robust=TRUE)
qMaxMahalanobis(p,N,d,...,pow=1,replicates=998,resample=FALSE,
                        robust=TRUE)
rPortionMahalanobis(n,N,d,cut,...,pow=1,robust=TRUE)
pPortionMahalanobis(q,N,d,cut,...,replicates=1000,resample=FALSE,pow=1,
                        robust=TRUE)
qPortionMahalanobis(p,N,d,cut,...,replicates=1000,resample=FALSE,pow=1,
                        robust=TRUE)
pQuantileMahalanobis(q,N,d,p,...,replicates=1000,resample=FALSE,
                        ulimit=TRUE,pow=1,robust=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of simulations to do.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>A vector giving quantiles of the distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>A vector giving probabilities. (only a single probility for 
<code>pQuantileMahalanobis</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Number of cases in the dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>degrees of freedom (i.e. dimension) of the dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cut</code></td>
<td>
<p>A cutting limit. The random variable is the portion of
Mahalanobis distances lower equal to the cutting limit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to <code>MahalanobisDist</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pow</code></td>
<td>
<p>the power of the Mahalanobis distance to be used. Higher
powers can be used to stretch the outlierregion visually.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust</code></td>
<td>
<p>logical or a robust method description (see
<code>robustnessInCompositions</code>) specifiying how the center
and covariance
matrix are estimated,if not given.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sorted</code></td>
<td>

<p>Specifies a transformation to be applied to the whole sequence of
Mahalanobis distances: FALSE is no transformation, TRUE sorts the
entries in ascending order, a numeric vector picks the given entries
from the entries sorted in ascending order; alternatively a function
such as <code>max</code> can be given to directly transform the data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replicates</code></td>
<td>
<p>the number of datasets in the
Monte-Carlo-Computations used in these routines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resample</code></td>
<td>
<p>a logical forcing a resampling of the
Monte-Carlo-Sampling. See details. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ulimit</code></td>
<td>
<p>logical: is this an upper limit of a joint confidence
bound or a lower limit.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>All the distribution correspond to the distribution under the
Null-Hypothesis of multivariate joint Gaussian distribution of the
dataset.
</p>
<p>The set of empirically estimated Mahalanobis distances of a dataset is
in the first step a random vector with exchangable but dependent
entries. The distribution of this vector is given by the
<code>rEmpiricalMahalanobis</code> if no sorted argument is given. Please be
advised that this is not a fixed distribution in a mathematical sense,
but an implementation dependent distribution incorporating the
performance of underlying robust spread estimator. As long as no
sorted argument is given <code>pEmpiricalMahalanobis</code> and
<code>qEmpiricalMahalanobis</code> represent the distribution function and
the quantile function of a randomly picked element of this
vector.
<br>
If a sorted attribute is given, it specifies a transformation is
applied to each of the vector prior to processing. Three important
special cases
are provided by seperate functions. The MaxMahalanobis functions
correspond to picking only the larges value. The PortionMahalanobis
functions correspond to reporting the portion of Mahalanobis distances
over a cutoff. The QuantileMahalanobis distribution correponds to the
distribution of the p-quantile of the dataset. 
<br>
The Monte-Carlo-Simulations of these
distributions are rather slow, since for each datum we need to
simulate a whole dataset and to apply a robust covariance estimator
to it, which typically itself involves
Monte-Carlo-Algorithms. Therefore each type of simulations is only
done the first time needed and stored for later use in the
environment <code>gsi.pStore</code>. With the resampling argument a
resampling of the cashed dataset can be forced.
</p>


<h3>Value</h3>

<p>The r* functions deliver a vector (or a matrix of row-vectors) of
simulated value of the given distributions. A total of n values (or
row vectors) is returned.
<br>
The p* functions deliver a vector (of the same length as x) of
probabilities for random variable of the given distribution to be
under the given quantil values q.
<br>
The q* functions deliver a vector of quantiles corresponding to the
length of the vector p providing the probabilities.
</p>


<h3>Note</h3>

<p>Unlike the <code>mahalanobis</code> function this function does not
be default compute the square of the mahalanobis distance. The pow
option is provided if the square is needed.
<br>
The package <span class="pkg">robustbase</span> is required for using the
robust estimations.</p>


<h3>Author(s)</h3>

<p>K.Gerald v.d. Boogaart <a href="http://www.stat.boogaart.de">http://www.stat.boogaart.de</a></p>


<h3>See Also</h3>

<p><code>dist</code>, <code>OutlierClassifier1</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">rEmpiricalMahalanobis(10,25,2,sorted=TRUE,pow=1,robust=TRUE)
pEmpiricalMahalanobis(qchisq(0.95,df=10),11,1,pow=2,replicates=1000)
(xx&lt;-pMaxMahalanobis(qchisq(0.95,df=10),11,1,pow=2))
qEmpiricalMahalanobis(0.95,11,2)
rMaxMahalanobis(10,25,4)
qMaxMahalanobis(xx,11,1)
</code></pre>


</div>