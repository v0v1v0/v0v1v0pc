<div class="container">

<table style="width: 100%;"><tr>
<td>cpop.crops</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate changepoint locations over a range of penalty values</h2>

<h3>Description</h3>

<p>Runs the Changepoints for a Range of Penalties (CROPS) algorithm of Haynes et al. (2017) to find all of the optimal segmentations for multiple penalty values over a continuous range.
For details of the CROPS method see the <span class="pkg">crops</span> package. To obtain details for each segmentation determined by <code>cpop.crops</code> use the 
<code>segmentations</code> method (see example below).
</p>


<h3>Usage</h3>

<pre><code class="language-R">cpop.crops(
  y,
  x = 1:length(y),
  grid = x,
  beta_min = 1.5 * log(length(y)),
  beta_max = 2.5 * log(length(y)),
  sd = sqrt(mean(diff(diff(y))^2)/6),
  minseglen = 0,
  prune.approx = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A vector of length n containing the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A vector of length n containing the locations of y. Default value is NULL, in which case the locations <code>x = 1:length(y)-1</code> are assumed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>An ordered vector of possible locations for the change points. If this is NULL, then this is set to x, the vector of times/locations of the data points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_min</code></td>
<td>
<p>Minimum value of the penalty range to be searched. Default is <code>1.5*log(length(y))</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_max</code></td>
<td>
<p>Maximum value of the penalty range to be searched. Default is <code>2.5*log(length(y))</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd</code></td>
<td>
<p>Estimate of residual standard deviation. Can be a single numerical value or a vector of values for the case of varying standard deviation.
Default value is <code>sd = sqrt(mean(diff(diff(y))^2)/6)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minseglen</code></td>
<td>
<p>The minimum allowable segment length, i.e. distance between successive changepoints. Default is 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prune.approx</code></td>
<td>
<p>Only relevant if a minimum segment length is set. If TRUE, cpop will use an approximate pruning algorithm that will speed up computation but may
occasionally lead to a sub-optimal solution in terms of the estimate change point locations. If the minimum segment length is 0, then an exact pruning algorithm is possible and is used.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An instance of an S4 class of type cpop.crops.class which extends the crops.class in <span class="pkg">crops</span>.
</p>


<h3>References</h3>

<p>Haynes K, Eckley IA, Fearnhead P (2017).
“Computationally Efficient Changepoint Detection for a Range of Penalties.”
<em>Journal of Computational and Graphical Statistics</em>, <b>26</b>(1), 134-143.
<a href="https://doi.org/10.1080/10618600.2015.1116445">doi:10.1080/10618600.2015.1116445</a>.
</p>
<p>Grose D, Fearnhead P (2021).
<em>crops: Changepoints for a Range of Penalties (CROPS)</em>.
R package version 1.0.1, <a href="https://CRAN.R-project.org/package=crops">https://CRAN.R-project.org/package=crops</a>.
</p>
<p>Fearnhead P, Grose D (2024).
“cpop: Detecting Changes in Piecewise-Linear Signals.”
<em>Journal of Statistical Software</em>, <b>109</b>(7), 1–30.
<a href="https://doi.org/10.18637/jss.v109.i07">doi:10.18637/jss.v109.i07</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(cpop)

# generate some data
set.seed(0)
x &lt;- seq(0,1,0.01)
n &lt;- length(x)
sd &lt;- rep(0.1,n)
mu &lt;- c(2*x[1:floor(n/2)],2 - 2*x[(floor(n/2)+1):n])
y &lt;- rnorm(n,mu,sd)
# calculate the changepoint locations and cost over a range of penalty values
res &lt;- cpop.crops(y,x,sd=sd,beta_min=0.4*log(length(y)),beta_max=2.5*log(length(y)))
summary(res)

# plot the results
plot(res) 

# show the segmentations
 segmentations(res)


</code></pre>


</div>