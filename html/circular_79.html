<div class="container">

<table style="width: 100%;"><tr>
<td>heatmap.circular</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Draw a Heat Map for circular data
</h2>

<h3>Description</h3>

<p>A heat map is a false color image (basically
<code>image(t(x))</code>) with a dendrogram added to the left side
and to the top.  Typically, reordering of the rows and columns
according to some set of values (row or column means) within the
restrictions imposed by the dendrogram is carried out. See also <code>heatmap</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">heatmap.circular(x, Rowv = NULL, Colv = if (symm) "Rowv" else NULL, 
distfun = dist.circular, hclustfun = hclust, 
reorderfun = function(d, w) reorder(d, w), add.expr, symm = FALSE, 
revC = identical(Colv, "Rowv"), na.rm = TRUE, margins = c(5, 5), 
lwid = c(1, 4), lhei = c(1, 4), ColSideColors, RowSideColors, 
NAColors = "black", cexRow = 0.2 + 1/log10(nr), cexCol = 0.2 + 1/log10(nc), 
labRow = NULL, labCol = NULL, main = NULL, xlab = NULL, ylab = NULL, 
keep.dendro = FALSE, annotate.expr, annotate = rep(NA, 4), 
verbose = getOption("verbose"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>numeric matrix of class <code>circular</code> of the values to be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rowv</code></td>
<td>
<p>determines if and how the <em>row</em> dendrogram should be
computed and reordered.  Either a <code>dendrogram</code> or a
vector of values used to reorder the row dendrogram or
<code>NA</code> to suppress any row dendrogram (and reordering) or
by default, <code>NULL</code>, see ‘Details’ below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Colv</code></td>
<td>
<p>determines if and how the <em>column</em> dendrogram should be
reordered.  Has the same options as the <code>Rowv</code> argument above and
<em>additionally</em> when <code>x</code> is a square matrix, <code>Colv =
      "Rowv"</code> means that columns should be treated identically to the
rows (and so if there is to be no row dendrogram there will not be a
column one either).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distfun</code></td>
<td>
<p>function used to compute the distance (dissimilarity)
between both rows and columns.  Defaults to <code>dist.circular</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hclustfun</code></td>
<td>
<p>function used to compute the hierarchical clustering
when <code>Rowv</code> or <code>Colv</code> are not dendrograms.  Defaults to
<code>hclust</code>. Should take as argument a result of <code>distfun</code>
and return an object to which <code>as.dendrogram</code> can be applied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reorderfun</code></td>
<td>
<p>function(d,w) of dendrogram and weights for
reordering the row and column dendrograms.  The default uses
<code>reorder.dendrogram</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.expr</code></td>
<td>
<p>expression that will be evaluated after the call to
<code>image</code>.  Can be used to add components to the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>symm</code></td>
<td>
<p>logical indicating if <code>x</code> should be treated
<b>symm</b>etrically; can only be true when <code>x</code> is a square matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>revC</code></td>
<td>
<p>logical indicating if the column order should be
<code>rev</code>ersed for plotting, such that e.g., for the
symmetric case, the symmetry axis is as usual.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>logical indicating whether <code>NA</code>'s should be removed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>margins</code></td>
<td>
<p>numeric vector of length 2 containing the margins
(see <code>par(mar= *)</code>) for column and row names, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwid</code></td>
<td>
<p>a vector of values for the widths of columns on the device.
Relative widths are specified with numeric values. Absolute
widths (in centimetres) are specified with the <code>lcm()</code>
function (see <code>layout</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lhei</code></td>
<td>
<p>a vector of values for the heights of rows on the device.
Relative and absolute heights can be specified, see <code>lwid</code> above.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ColSideColors</code></td>
<td>
<p>(optional) character vector of length <code>ncol(x)</code>
containing the color names for a horizontal side bar that may be used to
annotate the columns of <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RowSideColors</code></td>
<td>
<p>(optional) character vector of length <code>nrow(x)</code>
containing the color names for a vertical side bar that may be used to
annotate the rows of <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NAColors</code></td>
<td>

<p>the color used to plot missing values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cexRow, cexCol</code></td>
<td>
<p>positive numbers, used as <code>cex.axis</code> in
for the row or column axis labeling.  The defaults currently only
use number of rows or columns, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labRow, labCol</code></td>
<td>
<p>character vectors with row and column labels to
use; these default to <code>rownames(x)</code> or <code>colnames(x)</code>,
respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main, xlab, ylab</code></td>
<td>
<p>main, x- and y-axis titles; defaults to none.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep.dendro</code></td>
<td>
<p>logical indicating if the dendrogram(s) should be
kept as part of the result (when <code>Rowv</code> and/or <code>Colv</code> are
not NA).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>annotate</code></td>
<td>
<p>annotation in the four external side of the figure. A positive value in a position means you want annotate something in that position (1=bottom, 2=left, 3=top, 4=right). For instance, <code>annotate=c(0.1, NA, NA, 1, 1)</code> means you want to annotate one thing on the bottom with dimension <code>0.1</code> and two things on right each with dimension <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>annotate.expr</code></td>
<td>
<p>must be a list of expressions with the same length as <code>annotate</code>. For instance for <code>annotate=c(0.1, NA, NA, 1, 1)</code> you must have something as <code>annotate.expr=list(expr1, NA, NA, expr2, expr2)</code> where <code>expr1</code> etc. must be a valid <code>R</code> expression able to produce a plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical indicating if information should be printed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments passed on to <code>image</code>,
e.g., <code>col</code> specifying the colors.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If either <code>Rowv</code> or <code>Colv</code> are dendrograms they are honored
(and not reordered).  Otherwise, dendrograms are computed as
<code>dd &lt;- as.dendrogram(hclustfun(distfun(X)))</code> where <code>X</code> is
either <code>x</code> or <code>t(x)</code>.
</p>
<p>If either is a vector (of ‘weights’) then the appropriate
dendrogram is reordered according to the supplied values subject to
the constraints imposed by the dendrogram, by <code>reorder(dd,
    Rowv)</code>, in the row case.
If either is missing, as by default, then the ordering of the
corresponding dendrogram is by the mean direction value of the rows/columns,
i.e., in the case of rows, <code>Rowv &lt;- rowMeans(x, na.rm=na.rm)</code>.
If either is <code>NULL</code>, <em>no reordering</em> will be done for
the corresponding side.
</p>
<p>Unless <code>Rowv = NA</code> (or <code>Colw = NA</code>), the original rows and
columns are reordered <em>in any case</em> to match the dendrogram,
e.g., the rows by <code>order.dendrogram(Rowv)</code> where
<code>Rowv</code> is the (possibly <code>reorder()</code>ed) row
dendrogram.
</p>
<p><code>heatmap()</code> uses <code>layout</code> and draws the
<code>image</code> in the lower right corner of a 2x2 layout.
Consequentially, it can <b>not</b> be used in a multi column/row
layout, i.e., when <code>par(mfrow= *)</code> or <code>(mfcol= *)</code>
has been called.
</p>


<h3>Value</h3>

<p><code>par(mfrow= *)</code> or <code>(mfcol= *)</code>
has been called.
</p>


<h3>Author(s)</h3>

<p>Claudio Agostinelli using the code from <code>heatmap</code>.
</p>


<h3>See Also</h3>

<p><code>dist.circular</code>, <code>heatmap</code>, <code>image</code>, <code>hclust</code></p>


</div>