<div class="container">

<table style="width: 100%;"><tr>
<td>breveCOP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Add Asymmetry to a Copula</h2>

<h3>Description</h3>

<p>Adding <em>permutation asymmetry</em> (Chang and Joe, 2020, p. 1596) (<code>isCOP.permsym</code>) is simple for a bivariate copula family. Let <code class="reqn">\mathbf{C}</code> be a copula with respective vectors of parameters <code class="reqn">\Theta_\mathbf{C}</code>, then the permutation asymmetry is added through an asymmetry parameter <code class="reqn">\beta \in (-1, +1)</code> by
</p>
<p style="text-align: center;"><code class="reqn">\breve{\mathbf{C}}_{\beta;\Theta}(u,v) = v^{-\beta}\cdot\mathbf{C}(u, v^{(1+\beta)};\Theta)\mbox{, and}</code>
</p>

<p>for <code class="reqn">0 \le \beta \le +1</code> by
</p>
<p style="text-align: center;"><code class="reqn">\breve{\mathbf{C}}_{\beta;\Theta}(u,v) = u^{+\beta}\cdot\mathbf{C}(u^{(1-\beta)}, v;\Theta)\mbox{.}</code>
</p>

<p>The parameter <code class="reqn">\beta</code> clashes in name and symbology with a parameter used by functions <code>composite1COP</code>, <code>composite2COP</code>, and <code>composite3COP</code>. As a result, support for alternative naming is provided for compatibility.
</p>


<h3>Usage</h3>

<pre><code class="language-R">breveCOP(u,v, para, breve=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>Nonexceedance probability <code class="reqn">u</code> in the <code class="reqn">X</code> direction;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>Nonexceedance probability <code class="reqn">v</code> in the <code class="reqn">Y</code> direction;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>para</code></td>
<td>
<p>A special parameter <code>list</code> (see <b>Note</b>);</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breve</code></td>
<td>
<p>An alternative way from <code>para</code> to set the <code class="reqn">\beta</code> for this function; and</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to pass to the copula.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Value(s) for the copula are returned.
</p>


<h3>Note</h3>

<p>The following descriptions list in detail the structure and content of the <code>para</code> argument where <code>cop1</code> and <code>cop</code> and <code>para1</code> and <code>para</code> are respectively synonymous to have some structural similarity to the various copula constructors (compositors) of the <span class="pkg">copBasic</span> package:
</p>

<dl>
<dt><code>beta</code></dt>
<dd>
<p>— The <code class="reqn">\beta</code> asymmetry parameter;</p>
</dd>
<dt><code>breve</code></dt>
<dd>
<p>— The <code class="reqn">\beta</code> asymmetry parameter and presence of <code>breve</code> will not cause the non-use of <code>beta</code>; this feature is present so that <code>beta</code> remains accessible to the compositors that use <code>beta</code> (see <b>Examples</b>);</p>
</dd>
<dt><code>cop </code></dt>
<dd>
<p>— Function of the copula <code class="reqn">\mathbf{C}</code>;</p>
</dd>
<dt><code>cop1</code></dt>
<dd>
<p>— Alternative naming of the function of the coupla <code class="reqn">\mathbf{C}</code>;</p>
</dd>
<dt><code>para </code></dt>
<dd>
<p>— Vector of parameters <code class="reqn">\Theta_\mathbf{C}</code> for  <code class="reqn">\mathbf{C}</code>; and</p>
</dd>
<dt><code>para1</code></dt>
<dd>
<p>— Alternative naming of the vector of parameters <code class="reqn">\Theta_\mathbf{C}</code> for  <code class="reqn">\mathbf{C}</code>.</p>
</dd>
</dl>
<p>The function silently restricts the <code class="reqn">\beta</code> to its interval as defined, but parameter transform might be useful in some numerical optimization schemes. The following recipes might be useful for transform from a parameter in numerical optimization to the asymmetry parameter:
</p>
<pre>
   #    transform into space for optimization
   BREVEtfunc &lt;- function(p) { return(   qnorm((p[1] + 1) / 2) ) } # [-Inf, +Inf]
   # re-transform back into space for the copula
   BREVErfunc &lt;- function(p) { return(2 * pnorm(p[1]) - 1)       } # [-1  , +1  ]
</pre>


<h3>Author(s)</h3>

<p>W.H. Asquith</p>


<h3>References</h3>

<p>Chang, B., and Joe, H., 2020, Copula diagnostics for asymmetries and conditional dependence: Journal of Applied Statistics, v. 47, no. 9, pp. 1587–1615, <a href="https://doi.org/10.1080/02664763.2019.1685080">doi:10.1080/02664763.2019.1685080</a>.
</p>


<h3>See Also</h3>

<p><code>COP</code>, <code>convex2COP</code>, <code>convexCOP</code>, <code>composite1COP</code>, <code>composite2COP</code>, <code>composite3COP</code>, <code>FRECHETcop</code>, <code>glueCOP</code></p>


<h3>Examples</h3>

<pre><code class="language-R">para &lt;- list(breve=0.24, cop1=FRECHETcop, para1=c(0.4, 0.56))
breveCOP(0.87, 0.35, para=para) # 0.282743

betas &lt;- seq(-1,1, by=0.01)
bloms &lt;- sapply(betas, function(b) {
             breveCOP(0.15, 0.25, para=list(cop=GLPMcop, para=c(2, 2), beta=b))
         } )
plot(betas, bloms, type="l", main="GLPMcop(u,v; 2,2) by breveCOP(beta)")

## Not run: 
  # Notice the argument cop and para name adjustments to show that
  # translation exists inside the function to have use flexibility.
  para &lt;- list(beta=+0.44, cop1=FRECHETcop, para1=c(0.2, 0.56))
  UV   &lt;- simCOP(1000, cop=breveCOP, para=para)
  para &lt;- list(beta=-0.44, cop= FRECHETcop, para= c(0.2, 0.56))
  UV   &lt;- simCOP(1000, cop=breveCOP, para=para) # 
## End(Not run)

## Not run: 
  # Testing on a comprehensive copula (Plackett)
  betas &lt;- rhos &lt;- thetas &lt;- brhos &lt;- NULL
  for(beta  in seq(-1, 1, by=0.1 )) {
    for(rho in seq(-1, 1, by=0.01))   {
       theta  &lt;- PLACKETTpar(rho=rho, byrho=TRUE)
       thetas &lt;- c(thetas, theta)
       para   &lt;- list(  cop=PLcop,    para=theta, beta=beta)
       brho   &lt;- rhoCOP(cop=breveCOP, para=para)
       betas  &lt;- c(betas, beta); rhos &lt;- c(rhos, rho)
       brhos  &lt;- c(brhos, brho)
    }
  }
  df &lt;- data.frame(beta=betas, theta=thetas, rho=rhos, brho=brhos)
  plot(df$theta, df$brho, log="x", pch=16, cex=0.9, col="seagreen",
       xlab="Plackett parameter", ylab="Spearman Rho")
  lines(df$theta[df$beta == 0], df$brho[df$beta == 0], col="red", lwd=2)
  # Red line is the Plackett in its permutation symmetric definition. #
## End(Not run)

## Not run: 
  # Here is an example for a test using mleCOP() to estimate a 5-parameter asymmetric
  # copula model to "some data" on transition from yesterday to today data for a very
  # large daily time series. The purpose of example here is to demonstrate interfacing
  # to the breveCOP() for it to add asymmetry to composition of two copula.
  myASYMCOP &lt;- function(u,v, para, ...) {
    subpara &lt;- list(alpha=para$alpha, beta=para$beta, cop1=GHcop, para1=para$para1,
                                                      cop2=PLcop, para2=para$para2)
    breveCOP(u,v, cop=convex2COP, para=subpara)
  }
  para &lt;- list(alpha=+0.16934027, cop1=GHcop, para1=c(1.11144148, 10.32292673),
                beta=-0.01923808, cop2=PLcop, para2=3721.82966727)
  UV &lt;- simCOP(30000, cop=myASYMCOP, para=para, pch=16, col=grey(0, 0.1))
  abline(0,1, lwd=3, col="red") #
## End(Not run)

## Not run: 
  # Here is a demonstration of the permutations of the passing of the
  # asymmetry parameter into the function and then by
  UV &lt;- simCOP(1E3, cop=breveCOP, para=list(cop=HRcop, para=5), breve=+0.5)
  UV &lt;- simCOP(1E3, cop=breveCOP, para=list(cop=HRcop, para=5), breve=-0.5)
  UV &lt;- simCOP(1E3, cop=breveCOP, para=list(cop=HRcop, para=5,  beta =+0.5))
  UV &lt;- simCOP(1E3, cop=breveCOP, para=list(cop=HRcop, para=5,  breve=+0.5))
  UV &lt;- simCOP(1E3, cop=breveCOP, para=list(cop=HRcop, para=5,  beta=-0.4, breve=+0.5))

  para &lt;- list(cop1=HRcop, para1=6, cop2=PSP, para2=NULL, alpha=1, beta=0.7)
  myCOP &lt;- function(u,v, para, ...) breveCOP(u,v, cop=composite2COP, para=para)
  para$breve &lt;- "here I am"
  UV &lt;- simCOP(1E3, cop=composite2COP, para=para, seed=1) # breve is not used
  para$breve &lt;- -0.16
  UV &lt;- simCOP(1E3, cop=myCOP,         para=para, seed=1)
  para$breve &lt;- +0.16
  UV &lt;- simCOP(1E3, cop=myCOP,         para=para, seed=1) # 
## End(Not run)
</code></pre>


</div>