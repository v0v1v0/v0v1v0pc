<div class="container">

<table style="width: 100%;"><tr>
<td>CST_RFTemp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Temperature downscaling of a CSTools object using lapse rate
correction or a reference field</h2>

<h3>Description</h3>

<p>This function implements a simple lapse rate correction of a
temperature field (an object of class 's2dv_cube' as provided by
'CST_Load') as input.
The input lon grid must be increasing (but can be modulo 360).
The input lat grid can be irregularly spaced (e.g. a Gaussian grid)
The output grid can be irregularly spaced in lon and/or lat.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CST_RFTemp(
  data,
  oro,
  xlim = NULL,
  ylim = NULL,
  lapse = 6.5,
  lon_dim = "lon",
  lat_dim = "lat",
  time_dim = NULL,
  nolapse = FALSE,
  verbose = FALSE,
  compute_delta = FALSE,
  method = "bilinear",
  delta = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>An object of the class 's2dv_cube' as returned by 'CST_Load',
containing the temperature fields to downscale. The data object is expected 
to have an element named <code>$data</code> with at least two spatial dimensions 
named "lon" and "lat". (these default names can be changed with the 
<code>lon_dim</code> and <code>lat_dim</code> parameters).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>oro</code></td>
<td>
<p>An object of the class 's2dv_cube' as returned by 'CST_Load',
containing fine scale orography (in meters). The destination downscaling 
area must be contained in the orography field.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>Vector with longitude bounds for downscaling; the full input
field is downscaled if 'xlim' and 'ylim' are not specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>Vector with latitude bounds for downscaling</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lapse</code></td>
<td>
<p>Float with environmental lapse rate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lon_dim</code></td>
<td>
<p>String with name of longitude dimension</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lat_dim</code></td>
<td>
<p>String with name of latitude dimension</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time_dim</code></td>
<td>
<p>A vector of character string indicating the name of temporal 
dimension. By default, it is set to NULL and it considers "ftime", "sdate" 
and "time" as temporal dimensions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nolapse</code></td>
<td>
<p>Logical, if true 'oro' is interpreted as a fine-scale
climatology and used directly for bias correction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical if to print diagnostic output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>compute_delta</code></td>
<td>
<p>Logical if true returns only a delta to be used for
out-of-sample forecasts. Returns an object of the class 's2dv_cube',
containing a delta. Activates 'nolapse = TRUE'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>String indicating the method used for interpolation:
"nearest" (nearest neighbours followed by smoothing with a circular
uniform weights kernel), "bilinear" (bilinear interpolation)
The two methods provide similar results, but nearest is slightly better
provided that the fine-scale grid is correctly centered as a subdivision
of the large-scale grid.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>An object of the class 's2dv_cube', containing a delta
to be applied to the downscaled input data. Activates 'nolapse = TRUE'.
The grid of this object must coincide with that of the required output.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>CST_RFTemp() returns a downscaled CSTools object (i.e., of the class 
's2dv_cube').
</p>


<h3>Author(s)</h3>

<p>Jost von Hardenberg - ISAC-CNR, <a href="mailto:j.vonhardenberg@isac.cnr.it">j.vonhardenberg@isac.cnr.it</a>
</p>


<h3>References</h3>

<p>Method described in ERA4CS MEDSCOPE milestone M3.2: 
High-quality climate prediction data available to WP4 here: 
<a href="https://www.medscope-project.eu/the-project/deliverables-reports/">https://www.medscope-project.eu/the-project/deliverables-reports/</a>
and in H2020 ECOPOTENTIAL Deliverable No. 8.1:
High resolution (1-10 km) climate, land use and ocean change scenarios available 
here: <a href="https://ec.europa.eu/research/participants/documents/downloadPublic?documentIds=080166e5b6cd2324&amp;appId=PPGMS">https://ec.europa.eu/research/participants/documents/downloadPublic?documentIds=080166e5b6cd2324&amp;appId=PPGMS</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Generate simple synthetic data and downscale by factor 4
t &lt;- rnorm(7 * 6 * 2 * 3 * 4)*10 + 273.15 + 10
dim(t) &lt;- c(dataset = 1, member = 2, sdate = 3, ftime = 4, lat = 6, lon = 7)
lon &lt;- seq(3, 9, 1)
lat &lt;- seq(42, 47, 1)
coords &lt;- list(lat = lat, lon = lon)
exp &lt;- list(data = t, coords = coords)
attr(exp, 'class') &lt;- 's2dv_cube'
o &lt;- runif(29*29)*3000
dim(o) &lt;- c(lats = 29, lons = 29)
lon &lt;- seq(3, 10, 0.25)
lat &lt;- seq(41, 48, 0.25)
coords &lt;- list(lat = lat, lon = lon)
oro &lt;- list(data = o, coords = coords)
attr(oro, 'class') &lt;- 's2dv_cube'
res &lt;- CST_RFTemp(data = exp, oro = oro, xlim = c(4,8), ylim = c(43, 46), 
                 lapse = 6.5, time_dim = 'ftime',
                 lon_dim = 'lon', lat_dim = 'lat')
</code></pre>


</div>