<div class="container">

<table style="width: 100%;"><tr>
<td>catmaply</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Heatmap for categorical data using plotly</h2>

<h3>Description</h3>

<p><code>catmaply</code> is used to easily plot categorical data on heatmaps using plotly.
It can be used to plot heatmaps on categorical variables or, otherwise, plot continuous variables with categorical color range.
</p>


<h3>Usage</h3>

<pre><code class="language-R">catmaply(
  df,
  x,
  x_order,
  x_side = "top",
  x_tickangle = 90,
  x_range = 30,
  y,
  y_order,
  y_side = "left",
  y_tickangle = 0,
  z,
  text,
  text_color = "#444",
  text_size = 12,
  text_font_family = c("Open Sans", "verdana", "arial", "sans-serif"),
  hover_template,
  hover_hide = FALSE,
  color_palette = viridis::plasma,
  categorical_color_range = FALSE,
  categorical_col = NA,
  font_family = c("Open Sans", "verdana", "arial", "sans-serif"),
  font_size = 12,
  font_color = "#444",
  legend = TRUE,
  legend_col,
  legend_interactive = TRUE,
  tickformatstops = NULL,
  rangeslider = TRUE,
  slider = FALSE,
  slider_steps = list(slider_start = 1, slider_range = 15, slider_shift = 5,
    slider_step_name = "x"),
  slider_currentvalue_prefix = "",
  slider_step_visible = TRUE,
  slider_currentvalue_visible = TRUE,
  slider_tick_visible = TRUE,
  source = "catmaply"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>data.frame or tibble holding the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>column name holding the axis values for x.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_order</code></td>
<td>
<p>column name holding the ordering axis values for x. if no order is specified, then x will be used for ordering x; (default:"x").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_side</code></td>
<td>
<p>on which side the axis labels on the x axis should appear. options: c("top", "bottom"); (default:"top").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_tickangle</code></td>
<td>
<p>the angle of the axis label on the x axis. options: range -180 until 180; (default:90).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_range</code></td>
<td>
<p>the initial range that should be displayed on the x axis. Only works with non-time x-axis at the moment; (default: 30).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>column name holding the axis values for y.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_order</code></td>
<td>
<p>column name holding the ordering axis values for y. if no order is specified, then y will be used for ordering y; (default:"y").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_side</code></td>
<td>
<p>on which side the axis labels on the y axis should appear. options: c("left", "right"); (default:"left").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_tickangle</code></td>
<td>
<p>the angle of the axis label on the x axis. options: range -180 until 180; (default:0).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>column name holding the values for the fields.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text</code></td>
<td>
<p>optional column name holding the values that should be displayed in the fields. NA values will not be displayed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text_color</code></td>
<td>
<p>font color to be used for text; (default: "#444").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text_size</code></td>
<td>
<p>font size to be used for text/annotation. Needs to be a number greater than or equal to 1; (default: 12).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text_font_family</code></td>
<td>
<p>the typeface that will be applied by the web browser for the text/annotation.
The web browser will only be able to apply a font if it is available on the system which it operates.
Provide multiple font families, separated by commas, to indicate the preference in which to apply fonts if they aren't available on the system;
(default: c("Open Sans", "verdana", "arial", "sans-serif")).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hover_template</code></td>
<td>
<p>template to be used to create the hover label; (default:missing).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hover_hide</code></td>
<td>
<p>boolean indicating if the hover label should be hidden or not; (default: FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color_palette</code></td>
<td>
<p>a color palette vector a function that is able to create one; (default: viridis::plasma).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>categorical_color_range</code></td>
<td>
<p>if the resulting heatmap holds categorical field values or continuous values that belong to a category; (default: FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>categorical_col</code></td>
<td>
<p>if categorical_color_range is TRUE, then this column is used to create categories; (default: NA).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>font_family</code></td>
<td>
<p>the typeface that will be applied by the web browser.
The web browser will only be able to apply a font if it is available on the system which it operates.
Provide multiple font families, separated by commas, to indicate the preference in which to apply fonts if they aren't available on the system;
(default: c("Open Sans", "verdana", "arial", "sans-serif")).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>font_size</code></td>
<td>
<p>font size to be used for plot. needs to be a number greater than or equal to 1; (default: 12).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>font_color</code></td>
<td>
<p>font color to be used for plot; (default: "#444").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>
<p>boolean indicating if legend should be displayed or not; (default: TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend_col</code></td>
<td>
<p>column to be used for legend naming; (default: z/categorical_col).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend_interactive</code></td>
<td>
<p>whether the legend should be interactive or not; i.e. remove traces on click; (default: TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tickformatstops</code></td>
<td>
<p>used only if x axis is of type c("POSIXct", "POSIXt"). List of named list where each named list has one or
more of the keys listed here: https://plotly.com/r/reference/#heatmap-colorbar-tickformatstops. Default is optimized for summarized data of level day 24 hours; <br>
if default value (NULL) is set, tickformatstops is set as follows:
for column class "POSIXct" or "POSIXt" <br>
list( <br>
list(dtickrange = list(NULL, 1000), value = "%H:%M:%S.%L ms"), <br>
list(dtickrange = list(1000, 60000), value = "%H:%M:%S s"), <br>
list(dtickrange = list(60000, 3600000), value = "%H:%M m"), <br>
list(dtickrange = list(3600000, 86400000), value = "%H:%M h"), <br>
list(dtickrange = list(86400000, 604800000), value = "%H:%M h"), <br>
list(dtickrange = list(604800000, "M1"), value = "%H:%M h"), <br>
list(dtickrange = list("M1", "M12"), value = "%H:%M h"), <br>
list(dtickrange = list("M12", NULL), value = "%H:%M h") <br>
) <br>
) <br>
for class equals Date:
list( <br>
list(dtickrange = list(NULL, 1000), value = "%H:%M:%S.%L ms"), <br>
list(dtickrange = list(1000, 60000), value = "%H:%M:%S s"), <br>
list(dtickrange = list(60000, 3600000), value = "%H:%M m"), <br>
list(dtickrange = list(3600000, 86400000), value = "%H:%M h"), <br>
list(dtickrange = list(86400000, 604800000), value = "%e. %b d"), <br>
list(dtickrange = list(604800000, "M1"), value = "%e. %b w"), <br>
list(dtickrange = list("M1", "M12"), value = "%b '%y M"), <br>
list(dtickrange = list("M12", NULL), value = "%Y Y") <br>
) <br>
) <br>
(default: NULL)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rangeslider</code></td>
<td>
<p>boolean value indicating whether the rangeslider should be displayed or not; (default: TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slider</code></td>
<td>
<p>boolean value indicating whether to use slider or not; if specified, <code>rangeslider</code> will not be displayed; (default: FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slider_steps</code></td>
<td>
<p>list holding the configuration of the steps to be created. There are two alternatives: <code>auto</code> and
<code>custom</code>; whereas the <code>auto</code> mode creates the steps automatically and <code>custom</code> takes custom instructions on how to create the steps.
For mode <code>auto</code>, a <code>list</code> with the following elements has to be submitted (values of the list element are just examples): <br>
list( <br>
slider_start=1, <br>
slider_range=15, <br>
slider_shift=5, <br>
slider_step_name="x"
) <br>
This will create the steps automatically for you, essentially starting at position <code>slider_start</code>,
shifting the window of size <code>slider_range</code> along the x axis with a stepsize of <code>slider_shift</code>. The stepnames
are automatically selected with the x value of the left side of the slider_range (so for 1 it would take the first value of the x axis as name of the step). <br>
With custom, on the other hand, you can define the step configuration without any restrictions. The custom
configuration needs to be defined in a <code>list</code> with the following elements. <br>
list( <br>
list(name="Step_One", range=c(1, 50)), <br>
list(name="Step_Two", range=c(5, 55)), <br>
... <br>
). <br>
(default: <br>
list( <br>
slider_start=1, <br>
slider_range=15, <br>
slider_shift=5, <br>
)).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slider_currentvalue_prefix</code></td>
<td>
<p>prefix to be used for the slider title. Only used if <code>slider=TRUE</code>. (default: "").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slider_step_visible</code></td>
<td>
<p>boolean indicating if the step names should be displayed for the slider. (default: TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slider_currentvalue_visible</code></td>
<td>
<p>boolean indicating if the currently selected value should be displayed above the slider. (default: TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slider_tick_visible</code></td>
<td>
<p>boolean indicating if the tickvalues should be displayed below the slider. (default: TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>source</code></td>
<td>
<p>a character string of length 1. Match the value of this string with the source argument in event_data() to retrieve the event data corresponding to a specific plot (shiny apps can have multiple plots).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>plot_ly object
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(catmaply)

data("vbz")
df &lt;- vbz[[3]]

# simple plot
catmaply(
  df,
  x=trip_seq,
  x_order = trip_seq,
  y = stop_name,
  y_order = stop_seq,
  z = occ_category
)


# categorical color range and template
catmaply(
  df,
  x = trip_seq,
  y = stop_name,
  y_order = stop_seq,
  z = occupancy,
  categorical_color_range=TRUE,
  categorical_col = occ_category,
  hover_template = paste(
    '&lt;b&gt;Trip&lt;/b&gt;:', trip_seq,
    '&lt;br&gt;&lt;b&gt;Stop&lt;/b&gt;:', stop_seq,
    '&lt;br&gt;&lt;b&gt;Occupancy&lt;/b&gt;:', occ_category,
    '&lt;extra&gt;&lt;/extra&gt;'
  )
)
# for more examples, see vignette

</code></pre>


</div>