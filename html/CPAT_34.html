<div class="container">

<table style="width: 100%;"><tr>
<td>stat_hs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute the Hidalgo-Seo Statistic</h2>

<h3>Description</h3>

<p>This function computes the Hidalgo-Seo statistic for a change in mean model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">stat_hs(dat, estimate = FALSE, corr = TRUE, get_all_vals = FALSE,
  custom_var = NULL, use_kernel_var = FALSE, kernel = "ba",
  bandwidth = "and")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>The data vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>Set to <code>TRUE</code> to return the estimated location of the
change point</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corr</code></td>
<td>
<p>If <code>TRUE</code>, the long-run variance will be computed under the
assumption of correlated residuals; ignored if <code>custom_var</code>
is not <code>NULL</code> or <code>use_kernel_var</code> is <code>TRUE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>get_all_vals</code></td>
<td>
<p>If <code>TRUE</code>, return all values for the statistic at
every tested point in the data set</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>custom_var</code></td>
<td>
<p>Can be a vector the same length as <code>dat</code> consisting of
variance-like numbers at each potential change point (so
each entry of the vector would be the "best estimate" of
the long-run variance if that location were where the
change point occured) or a function taking two parameters
<code>x</code> and <code>k</code> that can be used to generate this
vector, with <code>x</code> representing the data vector and
<code>k</code> the position of a potential change point; if
<code>NULL</code>, this argument is ignored</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_kernel_var</code></td>
<td>
<p>Set to <code>TRUE</code> to use kernel methods for long-run
variance estimation (typically used when the data is
believed to be correlated); if <code>FALSE</code>, then the
long-run variance is estimated using
<code class="reqn">\hat{\sigma}^2_{T,t} = T^{-1}\left(
\sum_{s = 1}^t \left(X_s - \bar{X}_t\right)^2 +
\sum_{s = t + 1}^{T}\left(X_s -
\tilde{X}_{T - t}\right)^2\right)</code>, where
<code class="reqn">\bar{X}_t = t^{-1}\sum_{s = 1}^t X_s</code> and
<code class="reqn">\tilde{X}_{T - t} = (T - t)^{-1}
\sum_{s = t + 1}^{T} X_s</code>; if <code>custom_var</code> is not
<code>NULL</code>, this argument is ignored</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel</code></td>
<td>
<p>If character, the identifier of the kernel function as used in
<span class="pkg">cointReg</span> (see <code>getLongRunVar</code>); if
function, the kernel function to be used for long-run variance
estimation (default is the Bartlett kernel in <span class="pkg">cointReg</span>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bandwidth</code></td>
<td>
<p>If character, the identifier for how to compute the
bandwidth as defined in <span class="pkg">cointReg</span> (see
<code>getBandwidth</code>); if function, a function
to use for computing the bandwidth; if numeric, the bandwidth
value to use (the default is to use Andrews' method, as used in
<span class="pkg">cointReg</span>)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For a data set <code class="reqn">x_t</code> with <code class="reqn">n</code> observations, the test statistic is
</p>
<p style="text-align: center;"><code class="reqn">\max_{1 \leq s \leq n - 1} 	(\mathcal{LM}(s) - B_n)/A_n</code>
</p>

<p>where <code class="reqn">\hat{u}_t = x_t - \bar{x}</code> (<code class="reqn">\bar{x}</code> is the sample mean),
<code class="reqn">a_n = (2 \log \log n)^{1/2}</code>, <code class="reqn">b_n = a_n^2 - \frac{1}{2} \log \log
\log n - \log \Gamma (1/2)</code>, <code class="reqn">A_n = b_n / a_n^2</code>, <code class="reqn">B_n =
b_n^2/a_n^2</code>, <code class="reqn">\hat{\Delta} = \hat{\sigma}^2 = n^{-1} \sum_{t = 1}^{n}
\hat{u}_t^2</code>, and <code class="reqn">\mathcal{LM}(s) = n (n - s)^{-1} s^{-1}
\hat{\Delta}^{-1} \left( \sum_{t = 1}^{s} \hat{u}_t\right)^2</code>.
</p>
<p>If <code>corr</code> is <code>FALSE</code>, then the residuals are assumed to be
uncorrelated. Otherwise, the residuals are assumed to be correlated and
<code class="reqn">\hat{\Delta} = \hat{\gamma}(0) + 2 \sum_{j = 1}^{\lfloor \sqrt{n}
\rfloor} (1 - \frac{j}{\sqrt{n}}) \hat{\gamma}(j)</code> with <code class="reqn">\hat{\gamma}(j)
= \frac{1}{n}\sum_{t = 1}^{n - j} \hat{u}_t \hat{u}_{t + j}</code>.
</p>
<p>This statistic was presented in (Hidalgo and Seo 2013).
</p>


<h3>Value</h3>

<p>If both <code>estimate</code> and <code>get_all_vals</code> are <code>FALSE</code>, the
value of the test statistic; otherwise, a list that contains the test
statistic and the other values requested (if both are <code>TRUE</code>,
the test statistic is in the first position and the estimated change
point in the second)
</p>


<h3>References</h3>

<p>Hidalgo J, Seo MH (2013).
“Testing for structural stability in the whole sample.”
<em>Journal of Econometrics</em>, <b>175</b>(2), 84 - 93.
ISSN 0304-4076, doi: <a href="http://doi.org/10.1016/j.jeconom.2013.02.008">10.1016/j.jeconom.2013.02.008</a>, <a href="http://www.sciencedirect.com/science/article/pii/S0304407613000626">http://www.sciencedirect.com/science/article/pii/S0304407613000626</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">CPAT:::stat_hs(rnorm(1000))
CPAT:::stat_hs(rnorm(1000), corr = FALSE)
</code></pre>


</div>