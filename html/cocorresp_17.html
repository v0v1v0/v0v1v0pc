<div class="container">

<table style="width: 100%;"><tr>
<td>envfit.coca</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Fit an environmental vector or factor to a Co-CA ordination
</h2>

<h3>Description</h3>

<p>The function fits environmental vectors or factors to a Co-CA
ordination. The projections of points onto vectors have maximum
correlation with corresponding environmental variables, and the
factors show the averages of factor levels.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'coca'
envfit(ord, env, which = c("response", "predictor"),
       choices = c(1, 2), scaling = FALSE, w, na.rm = FALSE,
       strata = NULL, permutations = 999, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ord</code></td>
<td>
<p>a Co-CA ordination object, the result of a call to
<code>coca</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>env</code></td>
<td>
<p>a data frame, matrix or vector of environmental/external
variable(s) to be fitted to the ordination. The variables may be
of a mixed type (factors and continuous variables) in a data frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>character; which of the response or predictor ordinations
should be used during fitting of vectors and factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>choices</code></td>
<td>
<p>numeric; the axes to which vectors and factors are
fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaling</code></td>
<td>
<p>logical; should sacling be applied. See
<code>scores.symcoca</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>weights used in fitting vectors and factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>Remove points with missing values in ordination scores or
environmental variables. The operation is casewise; the whole row of
data is removed if there is a missing value and <code>na.rm =
      TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strata</code></td>
<td>
<p>An integer vector or factor specifying the strata for
permutation. If supplied, observations are permuted only within the
specified strata.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>permutations</code></td>
<td>
<p>Number of permutations for assessing significance
of vectors or factors. Set to <code>0</code> to skip permutations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments passed to <code>vectorfit</code> and
<code>factorfit</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See <code>envfit</code> for details of the method.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>envfit</code>. 
</p>


<h3>Author(s)</h3>

<p>Gavin L. Simpson. The code interfaces with and uses code from
<code>envfit</code> for the main computations, which was written by
Jari Oksanen.
</p>


<h3>See Also</h3>

<p><code>coca</code> for fitting models. <code>envfit</code> for
details of the generic function and the computations performed.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## symmetric CoCA
data(beetles)
data(plants)

## log transform the bettle data
beetles &lt;- log(beetles + 1)

## fit the model
bp.sym &lt;- coca(beetles ~ ., data = plants, method = "symmetric")

## load the environmental data
data(verges)

## fit vectors for the environmental data
sol &lt;- envfit(bp.sym, verges, which = "response")
sol

## plot the response matrix and the fitted vectors
biplot(bp.sym, which = "y1")
plot(sol)
</code></pre>


</div>