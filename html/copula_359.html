<div class="container">

<table style="width: 100%;"><tr>
<td>nacPairthetas</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Pairwise Thetas of Nested Archimedean Copulas</h2>

<h3>Description</h3>

<p>Return a <code class="reqn">d * d</code> matrix of pairwise thetas for a nested Archimedean
copula (<code>nacopula</code>) of dimension <code class="reqn">d</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">nacPairthetas(x)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an (outer) nacopula (with thetas sets).</p>
</td>
</tr></table>
<h3>Value</h3>

<p>a (<code class="reqn">d \times d</code>) matrix of thetas, say <code>T</code>, where
<code>T[j,k]</code> = theta of the bivariate Archimedean copula
<code class="reqn">C(U_j,U_k)</code>.
</p>


<h3>See Also</h3>

<p>the class <code>nacopula</code> (with its <code>dim</code>
method).
</p>


<h3>Examples</h3>

<pre><code class="language-R">## test with
options(width=97)

(mm &lt;- rnacModel("Gumbel", d=15, pr.comp = 0.25, order="random"))
stopifnot(isSymmetric(PT &lt;- nacPairthetas(mm)))
round(PT, 2)

## The tau's -- "Kendall's correlation matrix" :
round(copGumbel@tau(PT), 2)

## do this several times:
m1 &lt;- rnacModel("Gumbel", d=15, pr.comp = 1/8, order="seq")
stopifnot(isSymmetric(PT &lt;- nacPairthetas(m1)))
m1; PT



m100 &lt;- rnacModel("Gumbel", d= 100, pr.comp = 1/16, order="seq")
system.time(PT &lt;- nacPairthetas(m100))# how slow {non-optimal algorithm}?
##-- very fast, still!
stopifnot(isSymmetric(PT))
m100

## image(PT)# not ok -- want one color per theta
nt &lt;- length(th0 &lt;- unique(sort(PT[!is.na(PT)])))
th1 &lt;- c(th0[1]/2, th0, 1.25*th0[nt])
ths &lt;- (th1[-1]+th1[-(nt+2)])/2
image(log(PT), breaks = ths, col = heat.colors(nt))

## Nicer and easier:
require(Matrix)
image(as(log(PT),"Matrix"), main = "log( nacPairthetas( m100 ))",
      useAbs=FALSE, useRaster=TRUE, border=NA)
</code></pre>


</div>