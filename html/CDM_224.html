<div class="container">

<table style="width: 100%;"><tr>
<td>reglca</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Regularized Latent Class Analysis
</h2>

<h3>Description</h3>

<p>Estimates the regularized latent class model for dichotomous
responses based on regularization methods
(Chen, Liu, Xu, &amp; Ying, 2015; Chen, Li, Liu, &amp; Ying, 2017).
The SCAD and MCP penalty functions are available.
</p>


<h3>Usage</h3>

<pre><code class="language-R">reglca(dat, nclasses, weights=NULL, group=NULL, regular_type="scad",
   regular_lam=0, sd_noise_init=1, item_probs_init=NULL, class_probs_init=NULL,
   random_starts=1, random_iter=20, conv=1e-05, h=1e-04, mstep_iter=10,
   maxit=1000, verbose=TRUE, prob_min=.0001)

## S3 method for class 'reglca'
summary(object, digits=4, file=NULL,  ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>

<p>Matrix with dichotomous item responses. <code>NA</code>s are allowed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nclasses</code></td>
<td>

<p>Number of classes
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>

<p>Optional vector of sampling weights
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>

<p>Optional vector for grouping variable
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>regular_type</code></td>
<td>

<p>Regularization type. Can be <code>scad</code> or <code>mcp</code>. See <code>gdina</code> for
more information.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>regular_lam</code></td>
<td>

<p>Regularization parameter <code class="reqn">\lambda</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd_noise_init</code></td>
<td>

<p>Standard deviation for amount of noise in generating random starting values
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>item_probs_init</code></td>
<td>

<p>Optional matrix of initial item response probabilities
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>class_probs_init</code></td>
<td>

<p>Optional vector of class probabilities
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random_starts</code></td>
<td>

<p>Number of random starts
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random_iter</code></td>
<td>

<p>Number of initial iterations for random starts
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conv</code></td>
<td>

<p>Convergence criterion
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>

<p>Numerical differentiation parameter
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mstep_iter</code></td>
<td>

<p>Number of iterations in the M-step
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>

<p>Maximum number of iterations
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>Logical indicating whether convergence progress should be displayed
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob_min</code></td>
<td>
<p>Lower bound for probabilities in estimation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A required object of class <code>gdina</code>, obtained
from a call to the function <code>gdina</code>.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>Number of digits after decimal separator to display.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>Optional file name for a file in which <code>summary</code>
should be sinked.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The regularized latent class model for dichotomous item responses assumes <code class="reqn">C</code>
latent classes. The item response probabilities <code class="reqn">P(X_i=1|c)=p_{ic}</code> are estimated
in such a way such that the number of different <code class="reqn">p_{ic}</code> values per item is
minimized. This approach eases interpretability and enables to recover the
structure of a true (but unknown) cognitive diagnostic model.
</p>


<h3>Value</h3>

<p>A list containing following elements (selection):
</p>
<table>
<tr style="vertical-align: top;">
<td><code>item_probs</code></td>
<td>
<p>Item response probabilities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>class_probs</code></td>
<td>
<p>Latent class probabilities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.aj.xi</code></td>
<td>
<p>Individual posterior</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.xi.aj</code></td>
<td>
<p>Individual likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglike</code></td>
<td>
<p>Log-likelihood value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Npars</code></td>
<td>
<p>Number of estimated parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nskillpar</code></td>
<td>
<p>Number of skill class parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>
<p>Number of groups</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.ik</code></td>
<td>
<p>Expected counts</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nipar</code></td>
<td>
<p>Number of item parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_reg</code></td>
<td>
<p>Number of regularized parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_reg_item</code></td>
<td>
<p>Number of regularized parameters per item</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>item</code></td>
<td>
<p>Data frame with item parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pjk</code></td>
<td>
<p>Item response probabilities (in an array)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Number of persons</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>I</code></td>
<td>
<p>Number of items</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Chen, Y., Liu, J., Xu, G., &amp; Ying, Z. (2015). Statistical analysis of Q-matrix
based diagnostic classification models.
<em>Journal of the American Statistical Association, 110</em>, 850-866.
</p>
<p>Chen, Y., Li, X., Liu, J., &amp; Ying, Z. (2017).
Regularized latent class analysis with application in cognitive diagnosis.
<em>Psychometrika, 82</em>, 660-692.
</p>


<h3>See Also</h3>

<p>See also the <code>gdina</code> and <code>slca</code> functions
for regularized estimation.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
#############################################################################
# EXAMPLE 1: Estimating a regularized LCA for DINA data
#############################################################################

#---- simulate data
I &lt;- 12  # number of items
# define Q-matrix
q.matrix &lt;- matrix(0,I,2)
q.matrix[ 1:(I/3), 1 ] &lt;- 1
q.matrix[ I/3 + 1:(I/3), 2 ] &lt;- 1
q.matrix[ 2*I/3 + 1:(I/3), c(1,2) ] &lt;- 1
N &lt;- 1000  # number of persons
guess &lt;- rep(seq(.1,.3,length=I/3), 3)
slip &lt;- .1
rho &lt;- 0.3  # skill correlation
set.seed(987)
dat &lt;- CDM::sim.din( N=N, q.matrix=q.matrix, guess=guess, slip=slip,
           mean=0*c( .2, -.2 ), Sigma=matrix( c( 1, rho,rho,1), 2, 2 ) )
dat &lt;- dat$dat

#--- Model 1: Four latent classes without regularization
mod1 &lt;- CDM::reglca(dat=dat, nclasses=4, regular_lam=0, random_starts=3,
               random_iter=10, conv=1E-4)
summary(mod1)

#--- Model 2: Four latent classes with regularization and lambda=.08
mod2 &lt;- CDM::reglca(dat=dat, nclasses=4, regular_lam=0.08, regular_type="scad",
               random_starts=3, random_iter=10, conv=1E-4)
summary(mod2)

#--- Model 3: Four latent classes with regularization and lambda=.05 with warm start

# "warm start" -&gt; use initial parameters from fitted model with higher lambda value
item_probs_init &lt;- mod2$item_probs
class_probs_init &lt;- mod2$class_probs
mod3 &lt;- CDM::reglca(dat=dat, nclasses=4, regular_lam=0.05, regular_type="scad",
               item_probs_init=item_probs_init, class_probs_init=class_probs_init,
               random_starts=3, random_iter=10, conv=1E-4)

## End(Not run)
</code></pre>


</div>