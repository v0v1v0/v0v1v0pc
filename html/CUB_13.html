<div class="container">

<table style="width: 100%;"><tr>
<td>CUB</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Main function for CUB models</h2>

<h3>Description</h3>

<p>Main function to estimate and validate a CUB model for explaining uncertainty
and feeling for given ratings, with or without covariates and shelter effect.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CUB(Formula, data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Formula</code></td>
<td>
<p>Object of class Formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data frame from which model matrices and response variables are taken.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to be passed for the specification of the model, including covariates matrices Y, W, X for
#' for uncertainty, feeling and shelter, respectively.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is the main function for CUB models, which calls for the corresponding functions whenever
covariates or shelter effect are specified. It performs maximum likelihood estimation via the E-M algorithm
for CUB models and extensions. The optimization procedure is run via "optim".<br>
It is possible to fit data with CUB models, with or without covariates
for the parameters of the mixture model, and CUB models with shelter effect with no covariate included
in the model. The program also checks if the estimated variance-covariance matrix is positive definite:
if not, it prints a warning message and returns a matrix and related results with NA entries.
</p>


<h3>Value</h3>

<p>An object of the class "GEM"-CUB": returns a list containing the following results:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>estimates</code></td>
<td>
<p>Maximum likelihood estimates: <code class="reqn">(\pi, \xi)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>Log-likelihood function at the final estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varmat</code></td>
<td>
<p>Variance-covariance matrix of final estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niter</code></td>
<td>
<p>Number of executed iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BIC</code></td>
<td>
<p>BIC index for the estimated model</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Piccolo D. and D'Elia A. (2008). A new approach for modelling consumers' preferences, <em>Food Quality and Preference</em>,
<b>18</b>, 247–259 <br>
Iannario M. and Piccolo D. (2012). CUB models: Statistical methods and empirical evidence, in:
Kenett R. S. and Salini S. (eds.), <em>Modern Analysis of Customer Surveys: with applications using R</em>,
J. Wiley and Sons, Chichester, 231–258<br>
Iannario M. (2012). Modelling <em>shelter</em> choices in a class of mixture models for ordinal responses,
<em>Statistical Methods and Applications</em>, <b>21</b>, 1–22 <br>
Iannario M. and Piccolo D. (2014). Inference for CUB models: a program in R, <em>Statistica &amp; Applicazioni</em>,
<b>XII</b> n.2, 177–204 <br>
Iannario M. (2016). Testing the overdispersion parameter in CUBE models,
<em>Communications in Statistics: Simulation and Computation</em>, <b>45</b>(5), 1621–1635
</p>


<h3>See Also</h3>

<p><code>probcub00</code>, <code>probcubp0</code>, <code>probcub0q</code>, <code>probcubpq</code>,
<code>probcubshe1</code>, <code>loglikCUB</code>, <code>varmatCUB</code>
</p>


</div>