<div class="container">

<table style="width: 100%;"><tr>
<td>crtabs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Crunch xtabs: Crosstab and otherwise aggregate variables in a Crunch Dataset</h2>

<h3>Description</h3>

<p>Create a contingency table or other aggregation from cross-classifying
variables in a CrunchDataset, expanding on the notation allowed in
<code>stats::xtabs()</code> to tailor to the kinds of calculations available in crunch.
</p>


<h3>Usage</h3>

<pre><code class="language-R">crtabs(
  formula,
  data,
  weight = crunch::weight(data),
  useNA = c("no", "ifany", "always")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a stats::formula object that specifies that query
to calculate. See Details for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an object of class <code>CrunchDataset</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p>a CrunchVariable that has been designated as a potential
weight variable for <code>data</code>, or <code>NULL</code> for unweighted results.
Default is the currently applied <code>weight()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useNA</code></td>
<td>
<p>whether to include missing values in tabular results. See
<code>base::table()</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>There are 3 types of queries supported:
</p>

<ul>
<li>
<p> Crosstabs: Share the most in common with <code>stats::xtabs()</code>, are defined by
a formula with only a right hand side, with each dimension specified on the
right-hand side, separated by a <code>+</code>. A dimension are generally variables, but
categorical array variables contribute 2 dimensions, “categories” and
“subvariables”.
If you just use the categorical array variable directly, the subvariables dimensions
will be added first and the categories second, but you can choose their order by
specifying both <code>categories(var)</code> and <code>subvariables(var)</code> (where <code>var</code> is a
Categorical Array CrunchVariable).
</p>
</li>
<li>
<p> Aggregations: An extension to 'Crosstabs' where you can select one or more
measures by putting them in the left-hand side of the formula. Multiple measures
can be placed in a list to calculate them together. The currently supported
measures are <code>mean(var)</code>, <code>n()</code> (the same as a crosstab), <code>min(var)</code>, <code>max(var)</code>,
<code>sd(var)</code>, <code>sum(var)</code> and <code>median(var)</code> (where <code>var</code> is a CrunchVariable).
</p>
</li>
<li>
<p> Scorecards: When you want to compare multiple MR variables with the same
subvariables, you can use a scorecard to create a tabulation where they are
lined up. Scorecard queries cannot be combined with the other types. Use
the <code>scorecard(..., vars = NULL)</code> (where <code>...</code> is a set of MR variables or
<code>vars</code> is a list of them).
</p>
</li>
</ul>
<h3>Value</h3>

<p>an object of class <code>CrunchCube</code>
</p>


<h3>See Also</h3>

<p><code>weight()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Crosstab of people by `age_cat`:
crtabs(~age_cat, ds)

# Aggregation of means of income by `age_cat`
crtabs(mean(income) ~ age_cat, ds)

# Scorecard of multiple MRs with aligned subvariables
crtabs(~scorecard(trust_mr, value_mr, quality_mr), ds)
# Can also pre-define the variables in a scorecard with
mr_list &lt;- list(ds$trust_mr, ds$value_mr, ds$quality_mr)
crtabs(~scorecard(vars = mr_list), ds)

# Crosstab of people by `age_cat` and the reasons for enjoying a brand (cat array)
crtabs(~age_cat + enjoy_array, ds)

# Crosstab of people by `age_cat` and the `enjoy_array` (cat array)
# But manually choosing the order of the dimensions
crtabs(~subvariables(enjoy_array) + age_cat + categories(enjoy_array), ds)

# Aggregation of means &amp; standard deviations of income by `age_cat`
crtabs(list(mean = mean(income), sd = sd(income)) ~ age_cat, ds)

## End(Not run)
</code></pre>


</div>