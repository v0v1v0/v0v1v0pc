<div class="container">

<table style="width: 100%;"><tr>
<td>replace</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create an Implementation of [&lt;- For Custom Matrix-Like Types</h2>

<h3>Description</h3>

<p><code>replace</code> is a function that converts different index types such as
negative integer vectors, character vectors, or logical vectors passed to
the <code>[&lt;-</code> function as <code>i</code> (e.g. <code>X[i]</code>) or <code>i</code> and
<code>j</code> (e.g. <code>X[i, j]</code>) into positive integer vectors. The converted
indices are provided as the <code>i</code> parameter of <code>replace_vector</code> or
<code>i</code> and <code>j</code> parameters of <code>replace_matrix</code> to facilitate
implementing the replacement mechanism for custom matrix-like types. Values
are recycled to match the replacement length.
</p>


<h3>Usage</h3>

<pre><code class="language-R">replace(replace_vector, replace_matrix, allowDoubles = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>replace_vector</code></td>
<td>

<p>A function in the form of <code>function(x, i, ..., value)</code> that
replaces a vector subset of <code>x</code> based on a single index <code>i</code>
with the values in <code>value</code> and returns <code>x</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replace_matrix</code></td>
<td>

<p>A function in the form of <code>function(x, i, j, ..., value)</code> that
replaces a matrix subset of <code>x</code> based on two indices <code>i</code> and
<code>j</code> with the values in <code>value</code> and returns <code>x</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allowDoubles</code></td>
<td>

<p>If set, indices of type double are not converted to integers if the
operation would overflow to support matrices with <code>nrow()</code>,
<code>ncol()</code>, or <code>length()</code> greater than the largest integer that
can be represented (<code>.Machine$integer.max</code>).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The custom type must implement methods for <code>length</code>,
<code>dim</code> and <code>dimnames</code> for this function
to work.  Implementing methods for <code>nrow</code>,
<code>ncol</code>, <code>rownames</code>, and
<code>colnames</code> is not necessary as the default method of
those generics calls <code>dim</code> or
<code>dimnames</code> internally.
</p>


<h3>Value</h3>

<p>A function in the form of <code>function(x, i, j, ..., value)</code> that is
meant to be used as a method for <code>[&lt;-</code> for a custom type.
</p>


<h3>See Also</h3>

<p><code>vignette("StringMatrix", package = "crochet")</code> for a vignette
containing a complete example on how to use <code>replace</code> to implement
<code>[&lt;-</code> for a custom type.
</p>


<h3>Examples</h3>

<pre><code class="language-R">b &lt;- matrix(data = rnorm(25), nrow = 5, ncol = 5)
dimnames(b) &lt;- list(letters[1:5], letters[1:5])

a &lt;- structure(list(), class = "TestMatrix")

dim.TestMatrix &lt;- function(x) {
    dim(b)
}

dimnames.TestMatrix &lt;- function(x) {
    dimnames(b)
}

extract_vector &lt;- function(x, i) {
    # Dispatch to b instead to x for this demo
    b[i, drop = FALSE]
}

extract_matrix &lt;- function(x, i, j) {
    # Dispatch to b instead to x for this demo
    b[i, j, drop = FALSE]
}

`[.TestMatrix` &lt;- extract(extract_vector = extract_vector, extract_matrix = extract_matrix)

replace_vector &lt;- function(x, i, value) {
    .GlobalEnv$i &lt;- i
    .GlobalEnv$value &lt;- value
    # Dispatch to b instead to x for this demo
    with(.GlobalEnv, b[i] &lt;- value)
    # Don't forget to return x
    return(x)
}

replace_matrix &lt;- function(x, i, j, value) {
    .GlobalEnv$i &lt;- i
    .GlobalEnv$j &lt;- j
    .GlobalEnv$value &lt;- value
    # Dispatch to b instead to x for this demo
    with(.GlobalEnv, b[i, j] &lt;- value)
    # Don't forget to return x
    return(x)
}

`[&lt;-.TestMatrix` &lt;- replace(replace_vector = replace_vector, replace_matrix = replace_matrix)
</code></pre>


</div>