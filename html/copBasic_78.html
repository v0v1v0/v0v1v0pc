<div class="container">

<table style="width: 100%;"><tr>
<td>kfuncCOP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The Kendall (Distribution) Function of a Copula</h2>

<h3>Description</h3>

<p>To begin, there are at least three terms in the literature for what appear as the same function supported by the <code>kfuncCOP</code> function.  The <em>Kendall Function</em> also is known as <em>Kendall Distribution Function</em> (Nelsen, 2006, p. 163) and <em>Kendall Measure</em> (Salvadori <em>et al.</em>, 2007, p. 148). Each of these is dealt with in sequel to set the manner of the rather lengthy documentation for this function.
</p>
<p><em>KENDALL FUNCTION</em>—The <em>Kendall Function</em> (<code class="reqn">F_K</code>) (Joe, 2014, pp. 419–422) is the cumulative distribution function (CDF) of the vector <code class="reqn">\mathbf{U} = (U_1, U_2, \ldots)</code> or <code class="reqn">\mathbf{U} = (u,v)</code> (bivariate) where <code class="reqn">\mathbf{U}</code> is distributed as the copula: <code class="reqn">\mathbf{U} \sim \mathbf{C}(u,v)</code>. Letting <code class="reqn">Z</code> be the random variable for <code class="reqn">\mathbf{C}(u,v): Z = \mathbf{C}(u,v)</code>, the Kendall Function is defined as
</p>
<p style="text-align: center;"><code class="reqn">F_K(z; \mathbf{C}) = \mathrm{Pr}[Z \le z; \mathbf{U} \sim \mathbf{C}(u,v)]\mbox{,}</code>
</p>

<p>where <code class="reqn">F_K</code> is the nonexceedance probability of the joint probability <code class="reqn">z</code> stemming from the <code class="reqn">\mathbf{C}</code>. Note, unlike its univariate counterpart, <code class="reqn">F_K(z)</code> is rarely uniformly distributed (Nelsen <em>et al.</em>, 2001, p. 278). The inverse <code class="reqn">F_K^{(-1)}(z)</code> is implemented by the <code>kfuncCOPinv</code> function, which could be used for simulation of the correct joint probability using a single unformly distributed <code class="reqn">\sim</code> U(0,1) random variable. A reminder is needed that <code class="reqn">Z</code> is the <b>joint probability</b> and <code class="reqn">F_K(z)</code> is the Kendall Function.
</p>
<p>Joe (2014) and others as cited list various special cases of <code class="reqn">F_K(z)</code>, inequalities, and some useful identities suitable for validation study:<br><code class="reqn">\mbox{}\quad\bullet\quad\mbox{}</code>For <code class="reqn">\mathbf{M}(u,v)</code> (see <code>M</code>): <code class="reqn">F_K(z) = z</code> for all <code class="reqn">0 &lt; z &lt; 1</code> for all <code class="reqn">d \ge 2</code> dimensions;<br><code class="reqn">\mbox{}\quad\bullet\quad\mbox{}</code>For <code class="reqn">\mathbf{W}(u,v)</code> (see <code>W</code>): <code class="reqn">F_K(z) = 1</code> for all <code class="reqn">0 &lt; z &lt; 1</code> for <code class="reqn">d = 2</code> (bivariate only);<br><code class="reqn">\mbox{}\quad\bullet\quad\mbox{}</code>For <code class="reqn">\mathbf{\Pi}(u,v)</code> (see <code>P</code>): <code class="reqn">F_K(z) = z - z \log z</code> for <code class="reqn">0 &lt; z &lt; 1</code> for <code class="reqn">d = 2</code> (bivariate only);<br><code class="reqn">\mbox{}\quad\bullet\quad\mbox{}</code>For any <code class="reqn">\mathbf{C}</code>: <code class="reqn">z \le F_K(z)</code> for <code class="reqn">0 &lt; z &lt; 1</code>; and<br><code class="reqn">\mbox{}\quad\bullet\quad\mbox{}</code>For any <code class="reqn">\mathbf{C}</code>: <code class="reqn">\mathrm{E}[Z] = 1 - \int_0^1 F_K(t)\,\mathrm{d}t \ge z</code> (Nelsen, 2001, p. 281) — Z expectation, not <code class="reqn">F_K</code>!<br><code class="reqn">\mbox{}\quad\bullet\quad\mbox{}</code>For any <code class="reqn">\mathbf{C}</code>: <code class="reqn">\tau_\mathbf{C} = 3 - 4\int_0^1 F_K(t)\,\mathrm{d}t</code> (Nelsen, 2006, p. 163; see <code>tauCOP</code> [<b>Examples</b>]).<br><code class="reqn">\mbox{}\quad\bullet\quad\mbox{}</code>For any <code class="reqn">\mathbf{C}</code>: <code class="reqn">F_K(t)</code> does not uniquely determine the copula.
</p>
<p>The last item is from Durante and Sempi (2015, p. 118), and later discussion herein will concern an example of theirs. By coincidence within a few days before receipt of the Durante and Sempi book, experiments using <code>kfuncCOP</code> suggested that numerically the Galambos (<code>GLcop</code>), Gumbel–Hougaard (<code>GHcop</code>), and Hüsler–Reiss (<code>HRcop</code>) extreme value copulas for the same <em>Kendall Tau</em> (<code class="reqn">\tau_\mathbf{C}</code>) all have the same <code class="reqn">F_K(t)</code>. Therefore, do all <em>EV</em>-copulas have the same Kendall Function? Well in fact, they do and Durante and Sempi (2015, p. 207) show that <code class="reqn">F_K(z) = z - (1 - \tau_\mathbf{C})z \log(z)</code> for an <em>EV</em>-copula.
</p>
<p>Joe (2014, p. 420) also indicates that strength of <em>lower-tail dependence</em> (<code>taildepCOP</code>) affects <code class="reqn">F_K(z)</code> as <code class="reqn">z \rightarrow 0^{+}</code>, whereas strength of <em>upper-tail dependence</em> affects <code class="reqn">F_K(z)</code> as <code class="reqn">z \rightarrow 1^{-}</code>. (A demonstration of tail dependence dependence is made in section <b>Note</b>.) Also compared to <em>comonotonicity copula</em> [<code class="reqn">\mathbf{M}</code>] there are no <em>countermonotonicity copula</em> (<code class="reqn">\mathbf{W}_{d &gt; 2}</code>) for dimensions greater the bivariate (Joe, 2014, p. 214)
</p>
<p>Joe (2014) does not explicitly list an expression of <code class="reqn">F_K(z)</code> that is computable directly for any <code class="reqn">\mathbf{C}(u,v)</code>, and Nelsen (2006, p. 163) only lists a form (see later in documentation) for <em>Archimedean copulas</em>. Salvadori <em>et al.</em> (2007, eq. 3.47, p. 147) also list the Archimedean form; however, Salvadori <em>et al.</em> (2007, eq. 3.49, p. 148) <b>also list a form computable directly for any</b> <code class="reqn">\mathbf{C}(u,v)</code>. Considerable numerical experiments and derivations involving the <code class="reqn">\mathbf{\Pi}(u,v)</code> copula and results for <code class="reqn">K_\mathbf{C}(z)</code> shown later, indicate that the correct Kendall form for any <code class="reqn">\mathbf{C}(u,v)</code> is
</p>
<p style="text-align: center;"><code class="reqn">F_K(z) \equiv z + \int_z^1 \frac{\delta\mathbf{C}(u,t)}{\delta u}\,\mathrm{d}u\mbox{,}</code>
</p>

<p>where <code class="reqn">t = \mathbf{C}^{(-1)}(u,z)</code> for <code class="reqn">0 \le z \le 1</code>, <code class="reqn">t</code> can be computed by the <code>COPinv</code> function, and the partial derivative <code class="reqn">\delta\mathbf{C}(u,t)/\delta u</code> can be computed by the <code>derCOP</code> function. It is a curiosity that this form is not in Joe (2014), Nelsen <em>et al.</em> (2001, 2003), or Nelsen (2006), but actually in Salvadori <em>et al.</em> (2007).<br></p>
<p><em>KENDALL MEASURE</em>—The actual expression for any <code class="reqn">\mathbf{C}(u,v)</code> by Salvadori <em>et al.</em> (2007, eq. 3.49, p. 148) is for <em>Kendall Measure</em> (<code class="reqn">K_\mathbf{C}</code>) of a copula:
</p>
<p style="text-align: center;"><code class="reqn">K_\mathbf{C}(z) = z - \int_z^1 \frac{\delta\mathbf{C}(u,t)}{\delta u}\,\mathrm{d}u\mbox{,}</code>
</p>

<p>where <code class="reqn">t = \mathbf{C}^{(-1)}(u,z)</code> for <code class="reqn">0 \le z \le 1</code>. Those authors report that <code class="reqn">K_\mathbf{C}(z)</code> is the CDF of a random variable <code class="reqn">Z</code> whose distribution is <code class="reqn">\mathbf{C}(u,v)</code>. This is clearly appears to be the same meaning as Joe (2014) and Nelsen (2006). The minus “<code class="reqn">-</code>” in the above equation is very important.
</p>
<p>Salvadori <em>et al.</em> (2007, p. 148) report that “the function <code class="reqn">K_\mathbf{C}(z)</code> represents a fundamental tool for calculating the return period of extreme events.” The complement of <code class="reqn">K_\mathbf{C}(z)</code> is <code class="reqn">\overline{K}_\mathbf{C}(z) = 1 - K_\mathbf{C}(z)</code>, and the <code class="reqn">\overline{K}_\mathbf{C}(z)</code> inverse
</p>
<p style="text-align: center;"><code class="reqn">\frac{1}{1 - K_\mathbf{C}(z)} = \frac{1}{\overline{K}_\mathbf{C}(z)} = T_{\mathrm{KC}}</code>
</p>

<p>is referred to as a <em>secondary return period</em> (Salvadori <em>et al.</em>, 2007, pp. 161–170).<br></p>
<p><em>KENDALL DISTRIBUTION FUNCTION</em>—Nelsen (2006, p. 163) defines the <em>Kendall Distribution Function</em> (say <code class="reqn">K^\star_\mathbf{C}(t)</code>) as
</p>
<p style="text-align: center;"><code class="reqn">K^\star_\mathbf{C}(t) = t - \frac{\phi(t)}{\phi'(t^{+})}\mbox{,}</code>
</p>

<p>where <code class="reqn">\phi(t)</code> is a <em>generator function</em> of an <em>Archimedean copula</em> and <code class="reqn">\phi'(t^{+})</code> is a one-sided derivative (Nelsen, 2006, p. 125), and <code class="reqn">\phi(t)</code> is <code class="reqn">\phi(\mathbf{C}(u,v)) = \phi(u) + \phi(v)</code>. This same form is listed by Salvadori <em>et al.</em> (2007, eq. 3.47).
</p>
<p>Nelsen (2006) does not seem to list a more general definition for any <code class="reqn">\mathbf{C}(u,v)</code>. Because there is considerable support for Archimedean copulas in <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>, <span class="pkg">copBasic</span> has deliberately been kept from being yet another Archimedean-based package. This is made for more fundamental theory and pedogogic reasons without the algorithmic efficiency relative to the many convenient properties of Archimedean copulas.
</p>
<p>The similarity of <code class="reqn">F_K(z)</code>, <code class="reqn">K_\mathbf{C}(z)</code>, and <code class="reqn">K^\star_\mathbf{C}(t)</code>, however, is obvious—research shows that there are no syntatic differences between <code class="reqn">F_K(z)</code> and <code class="reqn">K_\mathbf{C}(t)</code> and <code class="reqn">K^\star_\mathbf{C}(z)</code>—they all are the CDF of the joint probability <code class="reqn">Z</code> of the copula. Consider now that Salvadori <em>et al.</em> show <code class="reqn">K_\mathbf{C}</code> having the form <code class="reqn">a - b</code> and not a form <code class="reqn">a + b</code> as previously shown for <code class="reqn">F_K(z)</code>. Which form is thus correct? The greater bulk of this documentation seeks to answer that question, and it must be concluded that Salvadori <em>et al.</em> (2007, eq. 3.49) definition for <code class="reqn">K_\mathbf{C}(z)</code> has a typesetting error.
</p>


<h3>Usage</h3>

<pre><code class="language-R">kfuncCOP(z, cop=NULL, para=NULL, wrtV=FALSE, as.sample=FALSE,
            verbose=FALSE, subdivisions=100L,
            rel.tol=.Machine$double.eps^0.25, abs.tol=rel.tol, ...)
kmeasCOP(z, cop=NULL, para=NULL, wrtV=FALSE, as.sample=FALSE,
            verbose=FALSE, subdivisions=100L,
            rel.tol=.Machine$double.eps^0.25, abs.tol=rel.tol, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>The values for <code class="reqn">z</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cop</code></td>
<td>
<p>A copula function;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>para</code></td>
<td>
<p>Vector of parameters or other data structure, if needed, to pass to the copula;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wrtV</code></td>
<td>
<p>A logical to toggle between with respect to <code class="reqn">v</code> or <code class="reqn">u</code> (default);</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>as.sample</code></td>
<td>
<p>A control on whether an optional <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> <code>data.frame</code> in <code>para</code> is used to compute the empirical <code class="reqn">\hat{F}_K(z)</code>. Let vector length of <code>para</code> be denoted <code class="reqn">m</code> and <code class="reqn">i = (1,\ldots,m)</code>, if <code>as.sample=TRUE</code>, then for each of the probability pairs in <code>para</code>, the <em>empirical copula</em> (<code>EMPIRcop</code>) function with additional arguments <code>...</code> is used to generate a vector <code class="reqn">(0, F^\sharp_{K,m}, 1)</code> of length <code class="reqn">m+2</code>, then a vector of <code class="reqn">(0, z^\sharp_m, 1)</code> again of length <code class="reqn">m+2</code> where <code class="reqn">z^\sharp = (i-0.5)/m</code> is created and linear interpolation by the <code>approx()</code> function in <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> for each of the <code class="reqn">z</code> values in <code>z</code> is used to estimate <code class="reqn">\hat{F}_K(z)</code> (see source code). If <code>as.sample="genest"</code>, then the <code class="reqn">\hat{F}_K(z)</code> is estimated without interpolation using a simple empirical copula basis and “pseudo-observations” after Genest <em>et al.</em> (2006, p. 339). The default <code class="reqn">\hat{F}_K</code> (<code>as.sample=TRUE</code>) is the linear interpolation based on the default call of Weibull form of the empirical copula, but that can be confirmed by <code>ctype="weibull"</code> (see <b>Note</b>);</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A logical supressing warnings from <code>integrate()</code> in <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> that are usually related to “integral divergence” for <code class="reqn">z \rightarrow 0^{+}</code>. The constructed behavior of <code>kfuncCOP</code> is to return <code class="reqn">F_K(z \rightarrow 0^{+}) = 0</code> if numerical integration returns <code>NULL</code>, and such a construction is made to avoid “end points not of opposite sign” during <code class="reqn">F_K(z)</code> inversion by <code>kfuncCOPinv</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subdivisions</code></td>
<td>
<p>Argument of same name passed to <code>integrate()</code>,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rel.tol</code></td>
<td>
<p>Argument of same name passed to <code>integrate()</code>,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abs.tol</code></td>
<td>
<p>Argument of same name passed to <code>integrate()</code>, and</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to pass.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The value(s) for <code class="reqn">F_K(z)</code> is returned.
</p>


<h3>Note</h3>

<p><em>VALIDATION STUDY</em>—A validation study using the <em>Independence copula</em> (<code class="reqn">\mathbf{\Pi =}</code> <code class="reqn">uv</code>; <code>P</code>) with theoretical results of Joe (2014) and empiricism is readily performed using the expression for <code class="reqn">F_K(z)</code>:
</p>
<pre>
  Z &lt;- sort(c(0.01, seq(0,1, by=0.05), 0.99))       # ** Joint probabilities **
  UV &lt;- simCOP(n=4000, cop=P, graphics=FALSE);      kendF &lt;- Z - Z*log(Z)
  emp.kendF  &lt;- kfuncCOP(Z, para=UV, as.sample="genest") # emp. Kendall func
  theo.kendF &lt;- kfuncCOP(Z, cop=P) # theo. Kendall func, numeric integration
  plot(Z, kendF, type="l", col=3, lwd=4, lty=2, xlim=c(0,1), ylim=c(0,1),
       xlab="COPULA(u,v) VALUE [JOINT PROBABILITY]",
       ylab="KENDALL FUNCTION, AS NONEXCEEDANCE PROBABILITY") # analytical
  points(Z,     kendF, col=3, lwd=1, lty=2, pch=16) # green (theo. values)
  points(Z, emp.kendF, col=4, lwd=2, cex=1.5)       # blue (empirical values)
  lines(Z, theo.kendF, col=2) # red (theoretical line by numerical integration)
  mtext("Kendall Functions: Independence Copula")
</pre>
<p>The figure so produced shows that the theoretical relation in Joe (2014) is correct because the empirical values from the simulated sample (<em>Empirical Kendall Function</em>; Nelsen <em>et al.</em>, 2003) match other curves quite well. Rerunning the above code with either <code class="reqn">\mathbf{M}</code> (<code>M</code>) or <code class="reqn">\mathbf{W}</code> (<code>W</code>) copulas will show that the special cases listed above are consistent with the empirical estimates. The case of <code class="reqn">\mathbf{W}(u,v)</code> is degenerate at <code class="reqn">z=0</code> so the empirical computation is in error for the smallest <code class="reqn">z</code> given because of interpolation. The <code class="reqn">\mathbf{M}</code> copula has <code class="reqn">F_K</code> along the equal value line (1:1) line.
</p>
<p>Now consider a more comprehensive demonstration using the <code>N4212cop</code> copula with some relatively weak dependence in <code class="reqn">\Theta = 1.17</code>.
</p>
<pre>
  Theta &lt;- 1.17; print(rhoCOP(cop=N4212cop, para=Theta)) # Spearman Rho = 6/10
  Z &lt;- sort(c(0.01, seq(0,1, by=0.05), 0.99))      # ** Joint probabilities **
  UV &lt;- simCOP(n=16000,      cop=N4212cop,   para=Theta, graphics=TRUE)
  empir.kendF &lt;- kfuncCOP(Z, as.sample=TRUE, para=UV, ctype="weibull")
  kwrtU       &lt;- kfuncCOP(Z, cop=N4212cop,   para=Theta, wrtV=FALSE)
  kwrtV       &lt;- kfuncCOP(Z, cop=N4212cop,   para=Theta, wrtV=TRUE )
  plot(Z, empir.kendF, type="p", col=2, lwd=7, lty=2, xlim=c(0,1),ylim=c(0,1),
       xlab="COPULA(u,v) VALUE [JOINT PROBABILITY]",
       ylab="KENDALL FUNCTION, AS NONEXCEEDANCE PROBABILITY")
  abline(0,1, lty=2, lwd=0.8); mtext("Kendall Functions: N4212(1.17) Copula")
  lines(Z, kwrtU, col=4, lwd=4, lty=2); lines(Z, kwrtV, col=3, lwd=1, lty=2)
</pre>
<p>The figure so produced again shows congruence between the two theoretical computations and the empirical curve. Now consider another comprehensive demonstration using the <code>PLACKETTcop</code> copula with some strong negative dependence in <code class="reqn">\Theta = 0.04</code>.
</p>
<pre>
  Theta &lt;- 0.04
  Z &lt;- sort(c(0.01, seq(0,1, by=0.05), 0.99))      # ** Joint probabilities **
  UV &lt;- simCOP(n=2600,       cop=PLACKETTcop,   para=Theta, graphics=TRUE)
  empir.kendF &lt;- kfuncCOP(Z, as.sample="hazen", para=UV)
  kwrtU       &lt;- kfuncCOP(Z, cop=PLACKETTcop,   para=Theta, wrtV=FALSE)
  kwrtV       &lt;- kfuncCOP(Z, cop=PLACKETTcop,   para=Theta, wrtV=TRUE )
  plot(Z, empir.kendF, type="p", col=2, lwd=7, lty=2, xlim=c(0,1),ylim=c(0,1),
       xlab="COPULA(u,v) VALUE [JOINT PROBABILITY]",
       ylab="KENDALL FUNCTION, AS NONEXCEEDANCE PROBABILITY")
  abline(0,1, lty=2, lwd=0.8); mtext("Kendall Function: Plackett Copula")
  lines(Z, kwrtU, col=4, lwd=4, lty=2); lines(Z, kwrtV, col=3, lwd=1, lty=2)
</pre>
<p>The figure so produced again shows congruence between the two theoretical computations and the empirical curve.
</p>
<p>Another comparison of <code class="reqn">F_K(z)</code> is useful and concerns <em>lower-</em> and <em>upper-tail dependency</em> parameters (<code>taildepCOP</code>) with a comparison of three different copula all having the same Kendall Tau. The following code computes and draws the respective <code class="reqn">F_K(z)</code>:
</p>
<pre>
  # Given a Kendall Tau of 0.4 and the GHcop, N4212, and Plackett copulas
  # parameters respectively are:
  Phi &lt;- 1.666667; Nu &lt;- 1.111119; Mu &lt;- 6.60344
  Z &lt;- seq(0.005, 0.995, by=0.005) #  ** Joint probabilities **
  GHkenf    &lt;- kfuncCOP(Z, cop=GHcop,       para=Phi, wrtV=FALSE)
  N4212kenf &lt;- kfuncCOP(Z, cop=N4212cop,    para=Nu,  wrtV=FALSE)
  PLkenf    &lt;- kfuncCOP(Z, cop=PLACKETTcop, para=Mu,  wrtV=FALSE)
  plot(qnorm(GHkenf), Z, type="l", col=1, lwd=2, xlim=c(-3,3), ylim=c(0,1),
       xlab="KENDALL FUNCTION, AS STANDARD NORMAL VARIATES",
       ylab="COPULA(u,v) VALUE, AS NONEXCEEDANCE PROBABILITY") # black curve
  lines(qnorm(N4212kenf), Z, col=2, lwd=2)                     # red   curve
  lines(qnorm(PLkenf),    Z, col=4, lwd=2)                     # blue  curve
</pre>
<p>The red curve for the <code class="reqn">\mathbf{N4212}(\Theta{=}1.1)</code> copula (<code>N4212cop</code>) is higher on the left, which shows the impact of its larger lower-tail dependency (<code class="reqn">\lambda_\mathbf{GH}^L{=}0 &lt; \lambda_\mathbf{N4212}^L{=}0.535</code>), whereas the black curve for the <code class="reqn">\mathbf{GH}(\Theta{=}1.67)</code> copula (<code>GHcop</code>) is similarly (about same magnitude) higher on the right, which shows the impact of its larger upper-tail dependency (<code class="reqn">\lambda_\mathbf{N4212}^L{=}0 &lt; \lambda_\mathbf{GH}^U{=}0.484</code>). The blue curve for the <code class="reqn">\mathbf{PL}(\Theta = 6.60)</code> copula (<code>PLACKETTcop</code>) nearly overwrites on the left the <code class="reqn">\mathbf{GH}</code> curve, which is a reflection of both copulae having zero lower-tail dependencies (<code class="reqn">\lambda_\mathbf{GH}^L = \lambda_\mathbf{PL}^L = 0</code>). Finally, as anticipated by <code class="reqn">\lambda^U</code>, the curve on the right for the <code class="reqn">\mathbf{N4212}</code> is just slightly larger for the <code class="reqn">\mathbf{PL}</code> because the <code class="reqn">\lambda_\mathrm{PL}^U{=}0 &lt; \lambda_\mathbf{N4212}^U{=}0.134</code> (a small difference however), and again on the right, the <code class="reqn">\mathbf{N4212}</code> curve is considerably smaller than the <code class="reqn">\mathbf{GH}</code> because <code class="reqn">\lambda_\mathbf{N4212}^U{=}0 &lt; \lambda_\mathbf{GH}^U{=}0.484</code>.
</p>
<p>Durante and Sempi (2015, p. 118) provide an example of two copula (<code class="reqn">\mathbf{C}_1</code> and <code class="reqn">\mathbf{C}_2</code>) having the same <code class="reqn">F_K(z) = \mathrm{min}(2z, 1)</code>. Let us check that out:
</p>
<pre>
  "C1" &lt;- function(u,v, ...) {
      if (length(u) == 1) { u &lt;- rep(u, length(v)) } else
      if (length(v) == 1) { v &lt;- rep(v, length(u)) }
      sapply(1:length(u), function(i) {
            min(c(u[i], max(c(v[i]/2, u[i]+v[i]-1)))) })
  }
  "C2" &lt;- function(u,v, ...) {
      if (length(u) == 1) { u &lt;- rep(u, length(v)) } else
      if (length(v) == 1) { v &lt;- rep(v, length(u)) }
      sapply(1:length(u), function(i) { g &lt;- 1/2
       max(c(0, u[i]+v[i]-1, min(c(u[i], v[i]-g)), min(c(u[i]-g, v[i])))) })
  }
  DSkf &lt;- function(t) sapply(t, function(z) min(c(2*z, 1)))
  zs &lt;- seq(0,1, by=.01); plot(zs, DSkf(zs), col=2, cex=3) # red dots (theory)
  lines(zs, kfuncCOP(zs, cop=C1), lwd=4, col=7) # thick yellow line
  lines(zs, kfuncCOP(zs, cop=C2), lwd=1, col=1) # thin black line
</pre>
<p>The plot so produced shows indeed that the numerical operations by <code>kfuncCOP</code> solidly work on these two strictly singular copulas <code class="reqn">\mathbf{C}_1</code> and <code class="reqn">\mathbf{C}_2</code> that are different from the two singular <code class="reqn">\mathbf{M}</code> and <code class="reqn">\mathbf{W}</code> copulas. The <code class="reqn">F_K(z)</code> curves exactly matching the theoretical curve provided by Durante and Sempi are produced.
</p>
<p><em>CONVERSATIONAL ASIDE</em>—Interestingly, Durante and Sempi (2015, pp. 115–121), like other authors of major works cited herein, do not list a general expression for the <code class="reqn">F_K(z)</code> as a function of any <code class="reqn">\mathbf{C}(u,v)</code>. Those authors develop the idea of Kendall Function well and show results but for the author (Asquith) the jump based of Theorem 3.9.2 to an expression, such as shown above for <code class="reqn">F_K(z)</code> based on <code class="reqn">\mathbf{C}(u,t)/\delta u</code>, to an usable form for any <code class="reqn">\mathbf{C}(u,v)</code> is difficult.
</p>
<p>This is a fascinating topic because if the Kendall Function is a reasonably important component of copula theory, then why so much difficulty in finding a canonical reference? For this one piece, whereas so much of <span class="pkg">copBasic</span> features are quite nomenclaturely clear in say Nelsen (2006) or Joe (2014) but somehow not for the Kendall Function.
</p>
<p>Perhaps to the professional mathematicians, the descriptions (nomenclature) used in all but Salvadori <em>et al.</em> (2007) are clear to intended readers. But even Salvadori <em>et al.</em> seemingly show theirs in error—perhaps the author (Asquith) has missed something fundamental, but the validations shown in this documentation prove at least that <code>kfuncCOP</code> does what it is supposed to be doing but perhaps for the wrong reasoning. Lastly, Durante and Sempi have an error in their expression for Kendall Tau as a function of <code class="reqn">F_K(z)</code> (see <code>tauCOP</code>).
</p>
<p><em>SECONDARY RETURN PERIOD</em>—As for “Kendall Measure” (after the lead of Salvadori <em>et al.</em> [2007, pp. 161–170]), the following code shows for purposes of discussing <em>secondary return period</em> that <code class="reqn">F_K(z)</code> is correct and once and for all as defined in this documentation <code class="reqn">F_K(z) \not\equiv  K_\mathbf{C}(z)</code>. The secondary return period (<code class="reqn">T_K</code>) is the expected interarrival time between events exceeding a <code class="reqn">T</code>-year joint probability either from <code class="reqn">U</code>, from <code class="reqn">V</code>, or both. Let us use the 100-year level (primary return period; <code class="reqn">T = 100</code>), the Gumbel–Hougaard copula (<code>GHcop</code>) <code class="reqn">F^{\mathbf{GH}(3.055)}_K(z)</code> where the choice of <code class="reqn">\Theta = 3.055</code> is made to match discussion in <code>copBasic-package</code> and Salvadori <em>et al.</em> (2007, table 3.3, p. 166).
</p>
<pre>
  # Gumbel-Hougaard [Kendall Tau=0.67267 (Salvadori et al. [2007])]
  Tyear &lt;- 100; ANEP &lt;- 1-1/Tyear; nsim &lt;- 30000; ix &lt;- 1:nsim
  1/(1-kfuncCOP(ANEP, cop=GHcop, para=3.055)) # 148.28 years
  BarT &lt;- sapply(1:20, function(i) {
                   UV &lt;- simCOP(n=nsim, cop=GHcop, para=3.055, graphics=FALSE)
                   nsim/sum(GHcop(UV$U, UV$V, para=3.055) &gt; ANEP) })
  message("# BarBarT=",               round(mean(BarT), digits=2),
          " years and StdDev(BarT)=", round(  sd(BarT), digits=2)," years")
  # BarBarT=149.61 years and StdDev(BarT)=11.12 years
</pre>
<p>The mean of 20 repeats of a large sample simulation run for <code class="reqn">F^\mathbf{GH}(\Theta{=}3.055)_K{(z{=}0.99)}</code> demonstrates empirical results that closely approximate theory <code class="reqn">149.61 \approx 148.28</code>, and thus congruence is shown that the definition for <code class="reqn">F_K(z)</code> must be correct and that for <code class="reqn">K_\mathbf{C}(z)</code> is incorrect. The table 3.3 in Salvadori <em>et al.</em> (2007) lists the secondary return period as 148.3 years, which obviously matches the output of <code>kfuncCOP</code> and empirical results shown.
</p>
<p>Some additional details on secondary return period from Salvadori <em>et al.</em> (2007). Letting <code class="reqn">t_\star</code> be some critical joint exceedance probability level, <code class="reqn">\overline{F}_K(z)</code> be the complement of <code class="reqn">F_K(z)</code>, those authors (p. 166) name <em>super-critical events</em> having <code class="reqn">\overline{F}_K(t_\star) &lt; 1 - t_\star</code>. Thus, the secondary return period  (<code class="reqn">\overline{F}_K(t_\star)^{-1} = T_K</code>) must be greater than the primary return period (<code class="reqn">t_\star^{-1}</code>), which is the case here (<code class="reqn">T_K{=}148.3 &gt; T{=}100</code>) (Salvadori <em>et al.</em>, 2007, p. 166).
</p>
<p>Salvadori <em>et al.</em> (2007) provide considerable discussion of <code class="reqn">T_K</code> and some highlights are:<br><code class="reqn">\mbox{}\quad\bullet\quad\mbox{}</code>(p. 162) events equally or exceeding probability <code class="reqn">F_K(1 - 1/t_\star)</code> or having return intervals <code class="reqn">\ge T_K</code> “represent [a] class of potentially dangerous events, the <em>outliers</em>, and [<code class="reqn">F_K</code> can be used to] introduce an <em>ad hoc</em> return period for such destructive events.”<br><code class="reqn">\mbox{}\quad\bullet\quad\mbox{}</code>(p. 162) “primary return period [<code class="reqn">T</code>] ... only takes into account the fact that a prescribed critical event is expected to appear once in a given time interval [<code class="reqn">T</code>] ... <code class="reqn">\overline{F}_K(t_\star)</code> provides the <em>exact probability</em> that a potentially destructive event will happen at any given realization of <code class="reqn">Z</code> ... and <code class="reqn">T_K</code> gives the expected time for such an outlier to occur.”<br><code class="reqn">\mbox{}\quad\bullet\quad\mbox{}</code>(p. 164) “[<code class="reqn">T</code>] only predicts that a critical event is <em>expected</em> to appear once in a given time interval ... would be more important to be able to calculate (1) the probability that a super-critical [sic.] event will occur at any given realization of [<code class="reqn">Z</code>], and (2) how long it takes, <em>on average</em>, for a super-critical event to appear.”<br><code class="reqn">\mbox{}\quad\bullet\quad\mbox{}</code>(p. 164) “the function <code class="reqn">\overline{F}_K</code> turns the difficult analysis of bivariate dynamics of <code class="reqn">X</code> and <code class="reqn">Y</code> into a simpler one-dimensional problem.”
</p>


<h3>Author(s)</h3>

<p>W.H. Asquith</p>


<h3>Source</h3>

<p>The comprehensive demonstrations are shown in the <b>Note</b> because of a sign convention and (or) probability convention incompatibility with the equation shown by Salvadori <em>et al.</em> (2007, p. 148).  Initial source code development for <span class="pkg">copBasic</span> was based on an hypothesis that the terms the “Kendall Function” and “Kendall Measure” might somehow have separate meanings—that the author must be blamed for misunderstanding the requisite nomenclature—this is evidently not true.
</p>
<p>The <code class="reqn">K_\mathbf{C}(z)</code> as shown herein simply can not reproduce <code class="reqn">F_K(z; \mathbf{\Pi}) = z - z\log z</code> for the <code class="reqn">\mathbf{\Pi}</code> copula unless the “<code class="reqn">-</code>” sign in the <code class="reqn">K_\mathbf{C}(z)</code> equation is changed to a “<code class="reqn">+</code>” to become the <code class="reqn">F_K(z)</code> definition as shown. The detective work needed for a valid function <code>kmeasCOP</code> was further complicated by fact that neither Durante and Sempi (2015), Joe (2014), Nelsen (2006), and others do not actually present a general equation for <code class="reqn">F_K(z)</code> computation for any <code class="reqn">\mathbf{C}(u,v)</code>.
</p>
<p>Because of the subtle differences evidently between “Kendall functions” (lower case), an explict derivation for <code class="reqn">F_K(z; \mathbf{\Pi})</code> is informative to confirm what is meant by the <em>Kendall Function</em> as defined by <code class="reqn">F_K(z)</code>. Starting with <code class="reqn">z = \mathbf{\Pi}(u,v) = uv</code>, then </p>
<p style="text-align: center;"><code class="reqn">v(z) = t = \mathbf{\Pi}^{(-1)}(u, z) = z/u\mbox{,\ and}</code>
</p>

<p style="text-align: center;"><code class="reqn">\frac{\delta}{\delta u} \mathbf{\Pi}(u,t) = \frac{\delta }{\delta u} u\,v \rightarrow v = \frac{z}{u}\mbox{,}</code>
</p>

<p>substitution can now proceed:
</p>
<p style="text-align: center;"><code class="reqn">F_K(z; \mathbf{\Pi}) = z + \int_z^1 \frac{\delta}{\delta u}\mathbf{\Pi}(u,t)\,\mathrm{d}u\, = z + \int_z^1 \frac{z}{u}\,\mathrm{d}u{,}</code>
</p>

<p>which simplfies to
</p>
<p style="text-align: center;"><code class="reqn">F_K(z; \mathbf{\Pi}) = z + [z\log(u)]\bigg|^1_z  = z + z[\log(1) - \log(z)] = z - z\log z\mbox{,}</code>
</p>

<p>which matches the special case shown by Joe (2014) for the independence copula (<code class="reqn">\mathbf{\Pi}</code>; <code>P</code>). It is obvious thus that the “<code class="reqn">+</code>” is needed in the <code class="reqn">F_K(z)</code> definition in order to stay consistent with the basic form and integration limits shown by Salvadori <em>et al.</em> (2007) for <code class="reqn">K_\mathbf{C}(z)</code>.
</p>


<h3>References</h3>

<p>Durante, F., and Sempi, C., 2015, Principles of copula theory: Boca Raton, CRC Press, 315 p.
</p>
<p>Genest, C., Quessy, J.F., Rémillard, B., 2006, Goodness-of-fit procedures for copula models based on the probability integral transformation: Scandinavian Journal of Statistics, v. 33, no. 2, pp. 337–366.
</p>
<p>Joe, H., 2014, Dependence modeling with copulas: Boca Raton, CRC Press, 462 p.
</p>
<p>Nelsen, R.B., 2006, An introduction to copulas: New York, Springer, 269 p.
</p>
<p>Nelsen, R.B., Quesada-Molina, J.J., Rodríguez-Lallena, J.A., Úbeda-Flores, M., 2001, Distribution functions of copulas—A class of bivariate probability integral transforms: Statistics and Probability Letters, v. 54, no. 3, pp. 277–282.
</p>
<p>Nelsen, R.B., Quesada-Molina, J.J., Rodríguez-Lallena, J.A., Úbeda-Flores, M., 2003, Kendall distribution functions: Statistics and Probability Letters, v. 65, no. 3, pp. 263–268.
</p>
<p>Salvadori, G., De Michele, C., Kottegoda, N.T., and Rosso, R., 2007, Extremes in nature—An approach using copulas: Dordrecht, Netherlands, Springer, Water Science and Technology Library 56, 292 p.
</p>


<h3>See Also</h3>

<p><code>kfuncCOPinv</code>, <code>tauCOP</code>, <code>derCOP</code>, <code>derCOP2</code>, <code>derCOPinv</code>, <code>derCOPinv2</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Salvadori et al. (2007, p. 148, fig. 3.5 [right])
zs &lt;- c(0.0001, seq(0.01, 1, by=0.01), 0.9999)
plot(zs, kmeasCOP(zs, cop=GHcop, para=5), log="y", type="l", lwd=4,
     xlab="Z &lt;= z", ylab="Kendall Function", xlim=c(0,1), ylim=c(0.001,1)) #
## End(Not run)
</code></pre>


</div>