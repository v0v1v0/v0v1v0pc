<div class="container">

<table style="width: 100%;"><tr>
<td>dag_node</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Add a node to an existing <code>causact_graph</code> object</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt="[Stable]"></a>
</p>
<p>Add a node to an existing <code>causact_graph</code> object. The graph object should be of class <code>causact_graph</code> and created using <code>dag_create()</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dag_node(
  graph,
  descr = as.character(NA),
  label = as.character(NA),
  rhs = NA,
  child = as.character(NA),
  data = NULL,
  obs = FALSE,
  keepAsDF = FALSE,
  extract = as.logical(NA),
  dec = FALSE,
  det = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>graph</code></td>
<td>
<p>a graph object of class <code>causact_graph</code>.  An initial object gets created using <code>dag_create()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>descr</code></td>
<td>
<p>a longer more descriptive character label for the node.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label</code></td>
<td>
<p>a shorter character label for referencing the node (e.g. "X","beta").  Labels with <code>.</code> in the name will be replaced by <code style="white-space: pre;">⁠_⁠</code> to ensure inter-operability with Python.  Additionally, Python reserved words, like <code>lambda</code> should not be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rhs</code></td>
<td>
<p>either a distribution such as <code style="white-space: pre;">⁠uniform, normal, lognormal, bernoulli,⁠</code> etc. or an R expression. Valid values include <code>normal(mu,sigma)</code>, <code>normal</code>, and <code>normal(6,2)</code>.  R computation/expression examples include <code>alpha+beta*x</code>,<code>c(int, coefs)</code>, or <code>1 / exp(-(alpha + beta * x))</code>.  Concatenation using <code>c()</code> is NOT supported.  If a distribution is given, this is a random/stochastic node, if a formula is given it is a deterministic node once given the values of its parents.  Quotes should not be used as all function/computations should consist of R objects, functions, and constants.  Common R arithmetic and geometric operators are supported, but less common R expressions may yield errors when running <code>dag_numpyro()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>child</code></td>
<td>
<p>an optional character vector of existing node labels.  Directed edges from the newly created node to the supplied nodes will be created.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a vector or data frame (with observations in rows and variables in columns).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs</code></td>
<td>
<p>a logical value indicating whether the node is observed.  Assumed to be <code>TRUE</code> when <code>data</code> argument is given.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keepAsDF</code></td>
<td>
<p>a logical value indicating whether the <code>data</code> argument should be split into one random variable node per column or kept together as a random matrix for matrix computation.  Defaults to creating one node per column of the data frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extract</code></td>
<td>
<p>a logical value.  When TRUE, child nodes will try to extract an indexed value from this node.  When FALSE, the entire random object (e.g. scalar, vector, matrix) is passed to children nodes.  Only use this argument when overriding default behavior seen using <code>dag_render()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dec</code></td>
<td>
<p>a logical value indicating whether the node is a decision node.  Used to show nodes as rectangles instead of ovals when using <code>dag_render()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>det</code></td>
<td>
<p>a logical value indicating whether the node is a deterministic function of its parents  Used to draw a double-line (i.e. peripheries = 2) around a shape when using <code>dag_render()</code>.  Assumed to be <code>TRUE</code> when <code>rhs</code> is a formula.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a graph object of class <code>causact_graph</code> with an additional node(s).
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Create an empty graph and add 2 nodes by using
# the `dag_node()` function twice
graph2 = dag_create() %&gt;%
  dag_node("Get Card","y",
         rhs = bernoulli(theta),
         data = carModelDF$getCard) %&gt;%
  dag_node(descr = "Card Probability by Car",label = "theta",
           rhs = beta(2,2),
           child = "y")
graph2 %&gt;% dag_render()


# The Eight Schools Example from Gelman et al.:

schools_dat &lt;- data.frame(y = c(28,  8, -3,  7, -1,  1, 18, 12),
sigma = c(15, 10, 16, 11,  9, 11, 10, 18), schoolName = paste0("School",1:8))

graph = dag_create() %&gt;%
  dag_node("Treatment Effect","y",
           rhs = normal(theta, sigma),
           data = schools_dat$y) %&gt;%
  dag_node("Std Error of Effect Estimates","sigma",
           data = schools_dat$sigma,
           child = "y") %&gt;%
  dag_node("Exp. Treatment Effect","theta",
           child = "y",
           rhs = avgEffect + schoolEffect) %&gt;%
  dag_node("Pop Treatment Effect","avgEffect",
           child = "theta",
           rhs = normal(0,30)) %&gt;%
  dag_node("School Level Effects","schoolEffect",
           rhs = normal(0,30),
           child = "theta") %&gt;%
  dag_plate("Observation","i",nodeLabels = c("sigma","y","theta")) %&gt;%
  dag_plate("School Name","school",
            nodeLabels = "schoolEffect",
            data = schools_dat$schoolName,
            addDataNode = TRUE)

graph %&gt;% dag_render()
## Not run: 
# below requires Tensorflow installation
drawsDF = graph %&gt;% dag_numpyro(mcmc=TRUE)
tidyDrawsDF %&gt;% dagp_plot()

## End(Not run)
</code></pre>


</div>