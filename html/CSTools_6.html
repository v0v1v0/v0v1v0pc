<div class="container">

<table style="width: 100%;"><tr>
<td>BEI_PDFBest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Computing the Best Index PDFs combining Index PDFs from two SFSs</h2>

<h3>Description</h3>

<p>This function implements the computation to obtain the index 
Probability Density Functions (PDFs) (e.g. NAO index) obtained to combining 
the Index PDFs for two Seasonal Forecast Systems (SFSs), the Best Index 
estimation (see Sanchez-Garcia, E. et al (2019), 
doi: <a href="https://doi.org/10.5194/asr-16-165-2019">10.5194/asr-16-165-2019</a> for more details about the 
methodology applied to estimate the Best Index).
</p>


<h3>Usage</h3>

<pre><code class="language-R">BEI_PDFBest(
  index_obs,
  index_hind1,
  index_hind2,
  index_fcst1 = NULL,
  index_fcst2 = NULL,
  method_BC = "none",
  time_dim_name = "time",
  na.rm = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>index_obs</code></td>
<td>
<p>Index (e.g. NAO index) array from an observational database
or reanalysis with at least a temporal dimension (by default 'time'), 
which must be greater than 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index_hind1</code></td>
<td>
<p>Index (e.g. NAO index) array from a SFS (named SFS1)
with at least two dimensions (time , member) or (time, statistic). 
The temporal dimension, by default 'time', must be greater than 2. 
The dimension 'member' must be greater than 1. The dimension 'statistic' 
must be equal to 2, for containing the two paramenters of a normal 
distribution (mean and sd) representing the ensemble of a SFS. It is not 
possible to have the dimension 'member' and 'statistic' 
at the same time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index_hind2</code></td>
<td>
<p>Index (e.g. NAO index) array from a SFS (named SFS2)
with at least two dimensions (time , member) or (time, statistic). 
The temporal dimension, by default 'time', must be greater than 2. 
The dimension 'member' must be greater than 1. 
The dimension 'statistic' must be equal to 2, for containing the two 
paramenters of a normal distribution (mean and sd) representing the ensemble 
of a SFS. It is not possible to have the dimension 'member' and  'statistic' 
together.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index_fcst1</code></td>
<td>
<p>(optional, default = NULL) Index (e.g. NAO index) array 
from forescating of SFS1 with at least two dimensions (time , member) or 
(time, statistic). The temporal dimension, by default 'time', must be equal 
to 1, the forecast year target. The dimension 'member' must be greater than 
1. The dimension 'statistic' must be equal to 2, for containing the two 
paramenters of a normal distribution (mean and sd) representing the ensemble 
of a SFS. It is not possible to have the dimension 'member' and  'statistic' 
together.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index_fcst2</code></td>
<td>
<p>(optional, default = NULL) Index (e.g. NAO index) array 
from forescating of SFS2 with at least two dimensions (time , member) or 
(time, statistic). The temporal dimension, by default 'time', must be equal 
to 1, the forecast year target. The dimension 'member' must be greater than 
1. The dimension 'statistic' must be equal to 2, for containing the two 
paramenters of a normal distribution (mean and sd) representing the ensemble 
of a SFS. It is not possible to have the dimension 'member' and  'statistic' 
together.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method_BC</code></td>
<td>
<p>A character vector of maximun length 2 indicating the bias 
correction methodology to be applied on each SFS. If it is 'none' or any of 
its elements is 'none', the bias correction won't be applied. Available 
methods developped are "ME" (a bias correction scheme based on the mean 
error or bias between observation and predictions to correct the predicted 
values), and "LMEV" (a bias correction scheme based on a linear model using 
ensemble variance of index as predictor). (see Sanchez-Garcia, E. et al 
(2019), doi: <a href="https://doi.org/10.5194/asr-16-165-2019">10.5194/asr-16-165-2019</a> for more details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time_dim_name</code></td>
<td>
<p>A character string indicating the name of the temporal 
dimension, by default 'time'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>Logical (default = FALSE). Should missing values be removed?</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>BEI_PDFBest() returns an array with the parameters that caracterize
the PDFs, with at least a temporal dimension, by default 'time' and dimension 
'statistic' equal to 2. The firt statistic is the parameter 'mean' of the PDF 
for the best estimation combining the two SFSs PDFs. The second statistic is 
the parameter 'standard deviation' of the PDF for the best estimation 
combining the two SFSs PDFs. If index_fcst1 and/or index_fcst2 are null, 
returns the values for hindcast period. Otherwise, it returns the values for a 
forecast year.
</p>


<h3>Author(s)</h3>

<p>Eroteida Sanchez-Garcia - AEMET, <a href="mailto:esanchezg@aemet.es">esanchezg@aemet.es</a>
</p>


<h3>References</h3>

<p>Regionally improved seasonal forecast of precipitation through 
Best estimation of winter NAO, Sanchez-Garcia, E. et al.,
Adv. Sci. Res., 16, 165174, 2019, doi: <a href="https://doi.org/10.5194/asr-16-165-2019">10.5194/asr-16-165-2019</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Example 1 for the BEI_PDFBest function
index_obs&lt;- rnorm(10, sd = 3)
dim(index_obs) &lt;- c(time = 5, season = 2)
index_hind1 &lt;- rnorm(40, mean = 0.2, sd = 3)
dim(index_hind1) &lt;- c(time = 5, member = 4, season = 2)
index_hind2 &lt;- rnorm(60, mean = -0.5, sd = 4)
dim(index_hind2) &lt;- c(time = 5, member = 6, season = 2)
index_fcst1 &lt;- rnorm(16, mean = 0.2, sd = 3)
dim(index_fcst1) &lt;- c(time = 1, member = 8, season = 2)
index_fcst2 &lt;- rnorm(18, mean = -0.5, sd = 4)
dim(index_fcst2) &lt;- c(time = 1, member = 9, season = 2)
method_BC &lt;- 'ME'
res &lt;- BEI_PDFBest(index_obs, index_hind1, index_hind2, index_fcst1, 
index_fcst2, method_BC)  
# Example 2 for the BEI_PDFBest function
index_obs&lt;- rnorm(10, sd = 3)
dim(index_obs) &lt;- c(time = 5, season = 2)
index_hind1 &lt;- rnorm(40, mean = 0.2, sd = 3)
dim(index_hind1) &lt;- c(time = 5, member = 4, season = 2)
index_hind2 &lt;- rnorm(60, mean = -0.5, sd = 4)
dim(index_hind2) &lt;- c(time = 5, member = 6, season = 2)
index_fcst1 &lt;- rnorm(16, mean = 0.2, sd = 3)
dim(index_fcst1) &lt;- c(time = 1, member = 8, season = 2)
index_fcst2 &lt;- rnorm(18, mean = -0.5, sd = 4)
dim(index_fcst2) &lt;- c(time = 1, member = 9, season = 2)
method_BC &lt;- c('LMEV', 'ME')
res &lt;- BEI_PDFBest(index_obs, index_hind1, index_hind2, index_fcst1, 
                   index_fcst2, method_BC) 
</code></pre>


</div>