<div class="container">

<table style="width: 100%;"><tr>
<td>d.rel.conn.dists.func</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Functions for estimating the probability distribution for relative 
connectivity given a pair of distributions for scores for marked and unmarked
individuals</h2>

<h3>Description</h3>

<p>These functions return functions that calculate the probability density 
function (<code>d.rel.conn.dists.func</code>), the probability distribution 
function (aka the cumulative distribution function; 
<code>p.rel.conn.dists.func</code>) and the quantile function 
(<code>q.rel.conn.dists.func</code>) for relative connectivity given a set of 
observed score values, distributions for unmarked and marked individuals, and
an estimate of the fraction of all eggs marked at the source site, <code>p</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">d.rel.conn.dists.func(
  obs,
  d.unmarked,
  d.marked,
  p = 1,
  N = max(100, min(5000, 2 * length(obs))),
  prior.shape1 = 0.5,
  prior.shape2 = prior.shape1,
  prior.func = function(phi) dbeta(phi, prior.shape1, prior.shape2),
  ...
)

p.rel.conn.dists.func(
  obs,
  d.unmarked,
  d.marked,
  p = 1,
  N = max(100, min(5000, 2 * length(obs))),
  prior.shape1 = 0.5,
  prior.shape2 = prior.shape1,
  prior.func = function(phi) dbeta(phi, prior.shape1, prior.shape2),
  ...
)

q.rel.conn.dists.func(
  obs,
  d.unmarked,
  d.marked,
  p = 1,
  N = max(100, min(5000, 2 * length(obs))),
  prior.shape1 = 0.5,
  prior.shape2 = prior.shape1,
  prior.func = function(phi) dbeta(phi, prior.shape1, prior.shape2),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obs</code></td>
<td>
<p>Vector of observed score values for potentially marked individuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d.unmarked</code></td>
<td>
<p>A function representing the PDF of unmarked individuals. 
Must be normalized so that it integrates to 1 for the function to work 
properly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d.marked</code></td>
<td>
<p>A function representing the PDF of marked individuals.  Must 
be normalized so that it integrates to 1 for the function to work properly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Fraction of individuals (i.e., eggs) marked in the source 
population. Defaults to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>number of steps between 0 and 1 at which to approximate likelihood 
function as input to <code>approxfun</code>. Defaults to
<code>2*length(obs)</code> so long as that number is comprised between <code>100</code>
and <code>5000</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior.shape1</code></td>
<td>
<p>First shape parameter for Beta distributed prior. 
Defaults to 0.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior.shape2</code></td>
<td>
<p>Second shape parameter for Beta distributed prior. 
Defaults to being the same as <code>prior.shape1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior.func</code></td>
<td>
<p>Function for prior distribution.  Should take one 
parameter, <code>phi</code>, and return a probability.  Defaults to 
<code>function(phi) dbeta(phi,prior.shape1,prior.shape2)</code>.  If this is 
specified, then inputs <code>prior.shape1</code> and <code>prior.shape2</code> are 
ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments for the <code>integrate</code> function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The normalization of the probability distribution is carried out using a 
simple, fixed-step trapezoidal integration scheme.  By default, the number of
steps between relative connectivity values of 0 and 1 defaults to 
<code>2*length(obs)</code> so long as that number is comprised between <code>100</code> 
and <code>5000</code>.
</p>


<h3>Value</h3>

<p>A function that takes one argument (the relative connectivity for 
<code>d.rel.conn.dists.func</code> and <code>p.rel.conn.dists.func</code>; the quantile
for <code>q.rel.conn.dists.func</code>) and returns the probability density, 
cumulative probability or score value, respectively. The returned function 
accepts both vector and scalar input values.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>d.rel.conn.dists.func</code>: Returns a function that is PDF for relative
connectivity
</p>
</li>
<li> <p><code>p.rel.conn.dists.func</code>: Returns a function that is cumulative
probability distribution for relative connectivity
</p>
</li>
<li> <p><code>q.rel.conn.dists.func</code>: Returns a function that is quantile
function for relative connectivity
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>David M. Kaplan <a href="mailto:dmkaplan2000@gmail.com">dmkaplan2000@gmail.com</a>
</p>


<h3>References</h3>

<p>Kaplan DM, Cuif M, Fauvelot C, Vigliola L, Nguyen-Huu T, Tiavouane J and Lett C 
(in press) Uncertainty in empirical estimates of marine larval connectivity. 
ICES Journal of Marine Science. doi:10.1093/icesjms/fsw182.
</p>


<h3>See Also</h3>

<p>Other connectivity estimation: 
<code>d.rel.conn.beta.prior()</code>,
<code>d.rel.conn.finite.settlement()</code>,
<code>d.rel.conn.multinomial.unnorm()</code>,
<code>d.rel.conn.multiple()</code>,
<code>d.rel.conn.unif.prior()</code>,
<code>dual.mark.transmission()</code>,
<code>optim.rel.conn.dists()</code>,
<code>r.marked.egg.fraction()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(ConnMatTools)
data(damselfish.lods)

# Histograms of simulated LODs
l &lt;- seq(-1,30,0.5)
h.in &lt;- hist(damselfish.lods$in.group,breaks=l)
h.out &lt;- hist(damselfish.lods$out.group,breaks=l)

# PDFs for marked and unmarked individuals based on simulations
d.marked &lt;- stepfun.hist(h.in)
d.unmarked &lt;- stepfun.hist(h.out)

# Fraction of adults genotyped at source site
p.adults &lt;- 0.25

# prior.shape1=1 # Uniform prior
prior.shape1=0.5 # Jeffreys prior

# Fraction of eggs from one or more genotyped parents
p &lt;- dual.mark.transmission(p.adults)$p

# PDF for relative connectivity
D &lt;- d.rel.conn.dists.func(damselfish.lods$real.children,
                           d.unmarked,d.marked,p,
                           prior.shape1=prior.shape1)

# Estimate most probable value for relative connectivity
phi.mx &lt;- optim.rel.conn.dists(damselfish.lods$real.children,
                                    d.unmarked,d.marked,p)$phi

# Estimate 95% confidence interval for relative connectivity
Q &lt;- q.rel.conn.dists.func(damselfish.lods$real.children,
                           d.unmarked,d.marked,p,
                           prior.shape1=prior.shape1)

# Plot it up
phi &lt;- seq(0,1,0.001)
plot(phi,D(phi),type="l",
     xlim=c(0,0.1),
     main="PDF for relative connectivity",
     xlab=expression(phi),
     ylab="Probability density")

abline(v=phi.mx,col="green",lty="dashed")
abline(v=Q(c(0.025,0.975)),col="red",lty="dashed")
</code></pre>


</div>