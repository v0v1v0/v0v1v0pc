<div class="container">

<table style="width: 100%;"><tr>
<td>nLogLike</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Penalized negative log-likelihood</h2>

<h3>Description</h3>

<p>Computes the penalized negative log-likelihood using the forward algorithm as described in Adam <em>et al</em>. (2019). Not intended to be run by the user (internal function, called by the function <code>fitMod</code>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">nLogLike(parvect,x,N,stationary,lambda,sup,m,inflation)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>parvect</code></td>
<td>
<p>Vector of working parameters (as returned by <code>pn2pw</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Vector of observed counts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Integer, number of states.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stationary</code></td>
<td>
<p>Logical, determines whether the initial distribution of the Markov chain underlying the observed counts is the stationary distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Vector of length <code>N</code> which contains the smoothing parameters associated with the different state-dependent distributions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sup</code></td>
<td>
<p>Integer, determines the upper bound of the support of the state-dependent distributions. If <code>NULL</code>, then the maximum of <code>x</code> is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>Integer, order of the difference penalties.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inflation</code></td>
<td>
<p>Count probabilities to be excluded from penalization (e.g. in the presence of zero-inflation).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Numeric, the penalized negative log-likelihood.
</p>


<h3>References</h3>

<p>Adam, T., Langrock, R., and Wei√ü, C.H. (2019): Penalized Estimation of Flexible Hidden Markov Models for Time Series of Counts. arXiv:<a href="https://arxiv.org/pdf/1901.03275.pdf">https://arxiv.org/pdf/1901.03275.pdf</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># importing example data
x = read.table("http://www.hmms-for-time-series.de/second/data/earthquakes.txt")$V2
# computing the penalized negative log-likelihood
parvect = pn2pw(N=2,probs=cbind(dpois(x=0:41,lambda=14),dpois(x=0:41,lambda=26)),
gamma=matrix(c(0.95,0.05,0.05,0.95),ncol=2),delta=NULL,stationary=TRUE)
lambda = rep(10^4,2)
nLogLike(parvect=parvect,x=x,N=2,stationary=TRUE,lambda=lambda,sup=41,m=3,inflation=FALSE)
</code></pre>


</div>