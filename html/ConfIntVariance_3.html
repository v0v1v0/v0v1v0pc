<div class="container">

<table style="width: 100%;"><tr>
<td>varwci</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
varwci
</h2>

<h3>Description</h3>

<p>Surround the univariate variance estimator of the function var with a
confidence interval, not assuming normality
</p>


<h3>Usage</h3>

<pre><code class="language-R">varwci(x, conf.level=0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A one-dimensional numeric vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>The confidence level for the confidence
interval. Defaults to 0.95</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a vector with two entries: the lower and the upper bound of the
confidence interval, and the following attributes:
</p>

<dl>
<dt>point.estimator</dt>
<dd>
<p>The usual sample variance at the center of the interval</p>
</dd>
<dt>conf.level</dt>
<dd>
<p>The confidence level used</p>
</dd>
<dt>var.SampleVariance</dt>
<dd>
<p>The estimated variance of the sample variance</p>
</dd>
</dl>
<h3>Warning </h3>

<p>On very small sample sizes, the result is NA because there is insufficient information on the variance estimation
</p>


<h3>Note</h3>

<p>The underlying theory is that of U-statistics. See Hoeffding 1948.
</p>


<h3>Author(s)</h3>

<p>Mathias Fuchs
</p>


<h3>References</h3>

<p>http://dx.doi.org/10.1080/15598608.2016.1158675 and https://mathiasfuchs.de/b3.html
</p>


<h3>Examples</h3>

<pre><code class="language-R">##
## Example: throwing a dice
## 

# throw a dice 100 times
s &lt;- sample(6, 100, replace=TRUE)

# the standard point estimator for the variance
print(var(s))

# contains the true value 2.9166 with a probability of 95 percent.
print(varwci(s))

##
## Check the coverage probability of the confidence interval
##

                                        # True quantities that do not depend on n
trueMeanOfDice &lt;- mean(1:6)
trueVarianceOfDice &lt;- mean((1:6)^2) - trueMeanOfDice^2

## see package description for more details
                                        # number of times we draw a
                                        # sample and compute a confidence interval
N &lt;- 1e4
trueValueCovered &lt;- rep(NA, N)
for (i in 1:N) {
    if (i %% 1e3 == 0) print(i)
                                        # throw a dice 100 times
    x &lt;- sample(6, 100, replace=TRUE)
                                        # compute our confidence interval
    ci &lt;- varwci(x)
                                        # We know that the true variance
                                        # of the dice is 91/6 - 49/4 = 2.916666...
                                        # did the confidence interval contain the correct value?
    trueValueCovered[i] &lt;- (trueVarianceOfDice &gt; ci[1] &amp;&amp; trueVarianceOfDice &lt; ci[2])
}

                                        # Result of simulation study: should be close to 0.95
print(mean(trueValueCovered))
</code></pre>


</div>