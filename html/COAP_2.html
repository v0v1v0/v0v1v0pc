<div class="container">

<table style="width: 100%;"><tr>
<td>RR_COAP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit the COAP model</h2>

<h3>Description</h3>

<p>Fit the covariate-augmented overdispersed Poisson factor model
</p>


<h3>Usage</h3>

<pre><code class="language-R">RR_COAP(
  X_count,
  multiFac = rep(1, nrow(X_count)),
  Z = matrix(1, nrow(X_count), 1),
  rank_use = 5,
  q = 15,
  epsELBO = 1e-05,
  maxIter = 30,
  verbose = TRUE,
  joint_opt_beta = FALSE,
  fast_svd = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X_count</code></td>
<td>
<p>a count matrix, the observed count matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>multiFac</code></td>
<td>
<p>an optional vector, the normalization factor for each unit; default as full-one vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>an optional matrix, the covariate matrix; default as a full-one column vector if there is no additional covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rank_use</code></td>
<td>
<p>an optional integer, specify the rank of the regression coefficient matrix; default as 5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>an optional string, specify the number of factors; default as 15.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsELBO</code></td>
<td>
<p>an optional positive vlaue, tolerance of relative variation rate of the envidence lower bound value, defualt as '1e-5'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxIter</code></td>
<td>
<p>the maximum iteration of the VEM algorithm. The default is 30.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>a logical value, whether output the information in iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>joint_opt_beta</code></td>
<td>
<p>a logical value, whether use the joint optimization method to update bbeta. The default is <code>FALSE</code>, which means using the separate optimization method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fast_svd</code></td>
<td>
<p>a logical value, whether use the fast SVD algorithm in the update of bbeta; default is <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>None
</p>


<h3>Value</h3>

<p>return a list including the following components: (1) H, the predicted factor matrix; (2) B, the estimated loading matrix; (3) bbeta, the estimated low-rank large coefficient matrix; (4) invLambda, the inverse of the estimated variances of error; (5) H0, the factor matrix; (6) ELBO: the ELBO value when algorithm stops; (7) ELBO_seq: the sequence of ELBO values.
</p>


<h3>References</h3>

<p>Liu, W. and Q. Zhong (2024). High-dimensional covariate-augmented overdispersed poisson factor model. arXiv preprint arXiv:2402.15071.
</p>


<h3>See Also</h3>

<p>None
</p>


<h3>Examples</h3>

<pre><code class="language-R">n &lt;- 300; p &lt;- 100
d &lt;- 20; q &lt;- 6; r &lt;- 3
datlist &lt;- gendata_simu(n=n, p=p, d=20, q=q, rank0=r)
str(datlist)
fitlist &lt;- RR_COAP(X_count=datlist$X, Z = datlist$Z, q=6, rank_use=3)
str(fitlist)
</code></pre>


</div>