<div class="container">

<table style="width: 100%;"><tr>
<td>EMPIRsim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate a Bivariate Empirical Copula</h2>

<h3>Description</h3>

<p><em>EXPERIMENTAL</em>â€”Perform a simulation on a <em>bivariate empirical copula</em> to produce the random variates <code class="reqn">U</code> and <code class="reqn">V</code> and return an <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> <code>data.frame</code> of them.  The method is more broadly known as <em>conditional simulation method</em>. This function is an empirical parallel to <code>simCOP</code> that is used for parametric copulas. If circumstances require conditional simulation of <code class="reqn">V{\mid}U</code>, then function <code>EMPIRsimv</code>, which produces a vector of <code class="reqn">V</code> from a fixed <code class="reqn">u</code>, should be used.
</p>
<p>For the usual situation in which an individual <code class="reqn">u</code> during the simulation loops is not a value aligned on the grid, then the bounding conditional quantile functions are solved for each of the <code class="reqn">n</code> simulations and the following interpolation is made by
</p>
<p style="text-align: center;"><code class="reqn">v = \frac{v_1/w_1 + v_2/w_2}{1/w_1 + 1/w_2}\mbox{,}</code>
</p>

<p>which states that that the weighted mean is computed. The values <code class="reqn">v_1</code> and <code class="reqn">v_2</code> are ordinates of the conditional quantile function for the respective grid lines to the left and right of the <code class="reqn">u</code> value. The values <code class="reqn">w_1</code> <code class="reqn">=</code> <code class="reqn">u - u^\mathrm{left}_\mathrm{grid}</code> and <code class="reqn">w_2</code> <code class="reqn">=</code> <code class="reqn">u^\mathrm{right}_\mathrm{grid} - u</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">EMPIRsim(n=100, empgrid=NULL, kumaraswamy=FALSE, na.rm=TRUE, keept=FALSE,
                graphics=TRUE, ploton=TRUE, points=TRUE, snv=FALSE,
                infsnv.rm=TRUE, trapinfsnv=.Machine$double.eps, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>A sample size, default is 100;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>empgrid</code></td>
<td>
<p>Gridded empirical copula from <code>EMPIRgrid</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kumaraswamy</code></td>
<td>
<p>A logical to trigger Kumaraswamy distribution smoothing of the conditional quantile function that is passed to <code>EMPIRgridderinv</code>. The Kumaraswamy distribution is a distribution having support <code class="reqn">[0,1]</code> with an explicit quantile function and takes the place of a Beta distribution (see <span class="pkg">lmomco</span> function <code>quakur()</code> for more details);</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>A logical to toggle the removal of <code>NA</code> entries on the returned <code>data.frame</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keept</code></td>
<td>
<p>Keep the <code class="reqn">t</code> uniform random variable for the simulation as the last column in the returned <code>data.frame</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>graphics</code></td>
<td>
<p>A logical that will disable graphics by setting <code>ploton</code> and <code>points</code> to <code>FALSE</code> and overriding whatever their settings were;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ploton</code></td>
<td>
<p>A logical to toggle on the plot;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>points</code></td>
<td>
<p>A logical to actually draw the simulations by the <code>points()</code> function in <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>snv</code></td>
<td>
<p>A logical to convert the <code class="reqn">\{u,v\}</code> to standard normal scores (variates) both for the optional graphics and the returned <code>data.frame</code>. Joe (2014) advocates extensively for use of normal scores, which is in  contrast to Nelsen (2006) who does not;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>infsnv.rm</code></td>
<td>
<p>A logical that will quietly strip out any occurrences of <code class="reqn">u = \{0,1\}</code> or <code class="reqn">v = \{0,1\}</code> from the simulations because these are infinity in magnitude when converted to standard normal variates is to occur. Thus, this logical only impacts logic flow when <code>snv</code> is <code>TRUE</code>. The <code>infsnv.rm</code> is mutually exclusive from <code>trapinfsnv</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trapinfsnv</code></td>
<td>
<p>If <code>TRUE</code> and presumably small, the numerical value of this argument (<code class="reqn">\eta</code>) is used to replace <code class="reqn">u = \{0,1\}</code> and <code class="reqn">v = \{0,1\}</code> with <code class="reqn">u(0) =  v(0) = \eta</code> or <code class="reqn">u(1) = v(1) = 1 - \eta</code> as appropriate when conversion to standard normal variates is to occur. The setting of <code>trapinfsnv</code> only is used if <code>snv</code> is <code>TRUE</code> and <code>infsnv.rm</code> is <code>FALSE</code>; and</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to pass to the <code>points()</code> function in <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> <code>data.frame</code> of the simulated values is returned.
</p>


<h3>Author(s)</h3>

<p>W.H. Asquith</p>


<h3>See Also</h3>

<p><code>EMPIRgrid</code>, <code>EMPIRgridderinv</code>,  <code>EMPIRsimv</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
# See other examples under EMPIRsimv

## Not run: 
pdf("EMPIRsim_experiment.pdf")
  nsim &lt;- 5000
  para &lt;- list(alpha=0.15, beta=0.65,
               cop1=PLACKETTcop, cop2=PLACKETTcop, para1=0.005, para2=1000)
  set.seed(1)
  uv &lt;- simCOP(n=nsim, cop=composite2COP, para=para, snv=TRUE,
               pch=16, col=rgb(0,0,0,.2))
  mtext("A highly complex simulated bivariate relation")
  # set.seed(1) # try not resetting the seed
  uv.grid &lt;- EMPIRgrid(para=uv, deluv=0.025)

  uv2 &lt;- EMPIRsim(n=nsim, empgrid=uv.grid, kumaraswamy=FALSE, snv=TRUE,
                  col=rgb(1,0,0,0.1), pch=16)
  mtext("Resimulation without Kumaraswamy smoothing")

  uv3 &lt;- EMPIRsim(n=nsim, empgrid=uv.grid, kumaraswamy=TRUE, snv=TRUE,
                  col=rgb(1,0,0,0.1),pch=16)
  mtext("Resimulation but using the Kumaraswamy Distribution for smoothing")
dev.off()#
## End(Not run)
</code></pre>


</div>