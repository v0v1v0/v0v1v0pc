<div class="container">

<table style="width: 100%;"><tr>
<td>macrocaic</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Comparative analysis using independent contrasts on species richness data.</h2>

<h3>Description</h3>

<p>Macroevolutionary hypotheses about correlates of species richness require testing in a phylogenetic framework in order to avoid phylogenetic autocorrelation. Independent contrasts as described by Felsenstein (1985) are appropriate for explanatory variables in such models but not for species richness as the response variable. This function implements two methods for calculating species richness constrasts described by Agapow and Isaac (2002) and originally implemented in the program MacroCAIC.
</p>


<h3>Usage</h3>

<pre><code class="language-R">macrocaic(formula, data, phy, names.col, macroMethod = "RRD", 
          stand.contr = TRUE, robust=Inf, ref.var = NULL, node.depth = NULL, 
          macroMinSize = 3, equal.branch.length = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A formula describing a linear model predicting species richness.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame containing the variables to be used in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phy</code></td>
<td>
<p>An object of class 'phylo'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>names.col</code></td>
<td>
<p>A name identifying a column in <code>data</code> that contains the tip labels from <code>phy</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>macroMethod</code></td>
<td>
<p>One of either "RRD" or "PDI" (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stand.contr</code></td>
<td>
<p>A logical flag indicating whether to standardize the contrasts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust</code></td>
<td>
<p>A threshold value of studentized residuals to exclude from the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ref.var</code></td>
<td>
<p>Identifies a predictor variable used for determining the direction of contrasts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>node.depth</code></td>
<td>
<p>A positive integer greater than 1 used to restrict the model to contrasts with a node depth less than or equal to the specified depth. Tips have a depth of 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>macroMinSize</code></td>
<td>
<p>A positive integer giving the minimum species richness at a node for contrasts to be included in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>equal.branch.length</code></td>
<td>
<p>If set to 'TRUE' then all branch lengths are set to 2.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The 'macrocaic' function fits a regression to the formula provided using 'crunch' contrasts for continuous explanatory variables and species richness contrasts for the response. The species richness contrasts are either the relative rate difference (RRD) or proportion dominance index (PDI):
</p>
<p style="text-align: center;"><code class="reqn">RRD = \ln\left(\frac{N_1}{N_2}\right)</code>
</p>

<p>RRD = ln(N_1/N_2)
</p>
<p style="text-align: center;"><code class="reqn">PDI = \left(\frac{N_1}{N_1+N_2}\right)-0.5</code>
</p>

<p>PDI = (N_1/(N_1 + N_2))-0.5
</p>
<p>The values <code class="reqn">N_1</code> and <code class="reqn">N_2</code> are the species richness of the two daughter nodes and <code class="reqn">N_1</code> is the species richness of the clade with the larger value of the reference variable. Species richness contrasts are not calculated at polytomies. Nodal values for species richness are calculated as the sum of the richness of the daughter nodes.
</p>


<h3>Value</h3>

<p>A object of class 'caic'.
</p>


<h3>Author(s)</h3>

<p>David Orme</p>


<h3>References</h3>

<p>Felsenstein, J.  (1985).  Phylogenies and the comparative method.  Am. Nat.  125, 1-15
Agapow, P.-M. and Isaac, N. J. B. (2002) MacroCAIC: correlates of species richness. Diversity &amp; Distributions, 8, 41-43
Isaac, N., Agapow, P., Harvey, P., and Purvis, A. (2003). Phylogenetically nested com- parisons for testing correlates of species richness: A simulation study of continuous variables. Evolution, 57(1):18-26.
</p>


<h3>See Also</h3>

<p><code>caic-class</code> for 'caic' object structure and methods.</p>


<h3>Examples</h3>

<pre><code class="language-R">data(IsaacEtAl)
primates &lt;- comparative.data(primates.tree, primates.data, binomial, na.omit=FALSE)
primatesBodySize &lt;- macrocaic(species.rich ~ body.mass, data=primates)
summary(primatesBodySize)

</code></pre>


</div>