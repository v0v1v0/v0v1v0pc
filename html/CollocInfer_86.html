<div class="container">

<table style="width: 100%;"><tr>
<td>ProfileObjective</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Profile Estimation with Collocation Inference</h2>

<h3>Description</h3>

<p> Profile estimation and objective functions for collocation estimation of parameters in continuous-time
stochastic processes.  </p>


<h3>Usage</h3>

<pre><code class="language-R">Profile.GausNewt(pars,times,data,coefs,lik,proc,in.meth="nlminb",
      control.in=NULL,active=1:length(pars),
      control=list(reltol=1e-6,maxit=50,maxtry=15,trace=1))

ProfileSSE(pars,allpars,times,data,coefs,lik,proc,in.meth='nlminb',
      control.in=NULL,active=1:length(pars),dcdp=NULL,oldpars=NULL,
      use.nls=TRUE,sgn=1)
      
ProfileErr(pars,allpars,times,data,coefs,lik,proc,in.meth = "house",
      control.in=NULL,sgn=1,active=1:length(allpars))

ProfileDP(pars,allpars,times,data,coefs,lik,proc,in.meth = "house",
      control.in=NULL,sgn=1,sumlik=1,active=1:length(allpars))

ProfileList(pars,allpars,times,data,coefs,lik,proc,in.meth = "house",
      control.in=NULL,sgn=1,active=1:length(allpars))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pars</code></td>
<td>
<p> Initial values of parameters to be estimated processes. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allpars</code></td>
<td>
<p> Full parameter vector including <code>pars</code>. Assignment <code>allpars[active] = pars</code> is always made.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>
<p> Vector observation times for the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>  Matrix of observed data values. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefs</code></td>
<td>
<p> Vector giving the current estimate of the coefficients in the spline. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lik</code></td>
<td>
 <p><code>lik</code> object defining the observation process. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proc</code></td>
<td>
 <p><code>proc</code> object defining the state process. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>in.meth</code></td>
<td>
<p> Inner optimization function currently one of 'nlminb', 'MaxNR', 'optim' or 'house'. The last calls <code>SplineEst.NewtRaph</code>.
This is fast but has poor convergence.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control.in</code></td>
<td>
<p> Control object for inner optimization function. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sgn</code></td>
<td>
<p> Is the minimizing (1) or maximizing (0)? </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>active</code></td>
<td>
<p> Incides indicating which parameters of <code>pars</code> should be estimated; defaults to all of them.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>oldpars</code></td>
<td>
<p> Starting parameter values for the Q-function in the EM algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dcdp</code></td>
<td>
<p> Estimate for the gradient of the optimized coefficients with respect to parameters; used internally.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.nls</code></td>
<td>
<p> In ProfileSSE, is 'nls' being used in the outer-optimization?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sumlik</code></td>
<td>
<p> In ProfileDP and ProfileDP.AllPar; should the gradient be given for each observation, or summed over them? </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p> A list giving control parameters for Newton-Raphson optimization. It should contain
</p>

<ul>
<li>
<p>reltol Relative tollerance criterion for the gradient and improvement before termination. 
</p>
</li>
<li>
<p>maxit Maximum number of iterations. 
</p>
</li>
<li>
<p>maxtry Maximum number of halving-steps to try before declaring no improvement is possible. 
</p>
</li>
<li>
<p>trace How much iteration history to output; 0 surpresses all output, a positive value outputs parameters and improvement at each
iteration. 
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Details</h3>

 <p><code>Profile.GausNewt</code> provides a simple implementation of Gauss-Newton optimization and may
not result in optimized values that are as good as other optimizers in <code>R</code>.
</p>
<p>When  <code>Profile.GausNewt</code> is not being used, <code>ProfileSEE</code> and <code>ProfileERR</code> create the
following temporary files:
</p>

<ul>
<li>
<p>counter.tmpThe number of halving-steps taken on the current optimization step.
</p>
</li>
<li>
<p>curcoefs.tmpThe current estimates of the coefficients.
</p>
</li>
<li>
<p>optcoefs.tmpThe optimal estimates of the coefficients in the iteration history.  </p>
</li>
</ul>
<p>These need to be removed manually when the optimization is finished. <code>optcoefs.tmp</code> will contain
the optimal value of <code>coefs</code> for plotting the estimated trajectories.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Profile.GausNewt</code></td>
<td>
<p>Output of a simple Gaus-Newton iteration to optimizing the objective function when the
observation likelihood takes the form of a sum of squared errors. Returns a list with the following elements:
</p>

<ul>
<li>
<p>pars The optimized value of the parameters.
</p>
</li>
<li>
<p>in.res The result of the inner optimization.
</p>
</li>
<li>
<p>value The value of the optimized sum of squared errors.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ProfileSSE</code></td>
<td>
<p>Output for the outer optimization when the observation likelihood is given by squared error. This is a list
with the following elements
</p>

<ul>
<li>
<p>value The value of the outer optimization criterion.
</p>
</li>
<li>
<p>gradient The derivative of <code>f</code> with respect to <code>pars</code>.
</p>
</li>
<li>
<p>coefs The optimized value of <code>coefs</code> for the current value of <code>pars</code>.
</p>
</li>
<li>
<p>dcdp The derivative of the optimized value of <code>coefs</code> at the current value of <code>pars</code>.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ProfileErr</code></td>
<td>
<p>The outer optimization criterion in the general case: the value of the observation likelihood at the profiled
estimates of <code>coefs</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ProfileDP</code></td>
<td>
<p>The derivative of <code>ProfileErr</code> with respect to <code>allpars[active]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ProfileList</code></td>
<td>
<p>Returns the results of ProfileErr and ProfileDP as a list with elements <code>value</code> and <code>gradient</code></p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>outeropt</code>, <code>Profile.LS</code>, <code>Profile.multinorm</code>, <code>LS.setup</code>, <code>multinorm.setup</code></p>


</div>