<div class="container">

<table style="width: 100%;"><tr>
<td>princomp.aplus</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Principal component analysis for amounts in log geometry</h2>

<h3>Description</h3>

<p>A principal component analysis is done in the Aitchison geometry
(i.e. ilt-transform). Some gimics simplify the
interpretation of the computed components as perturbations of amounts.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'aplus'
princomp(x,...,scores=TRUE,center=attr(covmat,"center"),
                           covmat=var(x,robust=robust,giveCenter=TRUE),
                           robust=getOption("robust"))
## S3 method for class 'princomp.aplus'
print(x,...)
## S3 method for class 'princomp.aplus'
plot(x,y=NULL,..., npcs=min(10,length(x$sdev)),
               type=c("screeplot","variance","biplot","loadings","relative"),
               main=NULL,scale.sdev=1)
## S3 method for class 'princomp.aplus'
predict(object,newdata,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an aplus dataset (for princomp) or a result from
princomp.aplus</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>not used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scores</code></td>
<td>
<p>a logical indicating whether scores should be computed or not</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npcs</code></td>
<td>
<p>the number of components to be drawn in the scree plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of the plot: <code>"screeplot"</code> is a lined screeplot,
<code>"variance"</code> is a boxplot-like screeplot, <code>"biplot"</code> is a
biplot, <code>"loadings"</code> displays the loadings as a 
<code>barplot.acomp</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.sdev</code></td>
<td>
<p>the multiple of sigma to use when plotting the loadings</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>title of the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>a fitted princomp.aplus object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>another amount dataset of class aplus</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to pass to internally-called functions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covmat</code></td>
<td>
<p>provides the covariance matrix to be used for the
principle component analysis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p>provides the  be used for the computation of scores</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust</code></td>
<td>
<p>Gives the robustness type for the calculation of the
covariance matrix. See <code>var.rmult</code> for details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>As a metric euclidean space, the positive real space described in
<code>aplus</code> has its own
principal component analysis, that can be performed either in terms of the
covariance matrix or the correlation matrix. However, since all parts in a composition 
or in an amount vector share a natural scaling, they do not need the 
standardization (which in fact would produce a loss of important information). 
For this reason, <code>princomp.aplus</code> works on the covariance matrix.
<br>
To aid the interpretation we added some extra functionality to a
normal <code>princomp(ilt(x))</code>. First of all the result contains as
additional information the amount representation of
returned vectors in the space of the data: the center as an amount
<code>Center</code>, and the loadings in terms of amounts to perturbe
with, either positively
(<code>Loadings</code>) or negatively (<code>DownLoadings</code>). The Up- and
DownLoadings are normalized to the number of parts  
and not to one to simplify the interpretation. A value of about one
means no change in the specific component. 
<br>
The plot routine provides screeplots (<code>type = "s"</code>,<code>type=
    "v"</code>), biplots (<code>type = "b"</code>), plots of the effect of
loadings (<code>type = "b"</code>) in <code>scale.sdev*sdev</code>-spread, and
loadings of pairwise (log-)ratios (<code>type = "r"</code>).
<br>
The interpretation of a screeplot does not differ from ordinary
screeplots. It shows the eigenvalues of the covariance matrix, which
represent the portions of variance explained by the principal
components. 
<br>
The interpretation of the the biplot uses, additionally to the
classical one, a compositional concept: The
differences between two arrowheads can be interpreted as log-ratios
between the two components represented by the arrows. 
<br>
The amount loading plot is introduced with this
package. The loadings of all component can be seen as an orthogonal basis
in the space of <code>ilt</code>-transformed data. These vectors are displayed by a barplot with
their corresponding amounts. A portion of one means no change of this
part. This is equivalent to a zero loading in a real principal component analysis. 
<br>
The loadings plot can work in two different modes. If
<code>scale.sdev</code> is set to <code>NA</code> it displays the amount vector
being represented by the unit vector of loadings in the ilt-transformed space. If
<code>scale.sdev</code> is numeric we use this amount vector scaled by the
standard deviation of the respective component. 
<br>
The relative plot displays the <code>relativeLoadings</code> as a
barplot. The deviation from a unit bar shows the effect of each principal component 
on the respective ratio. The
interpretation of the ratios plot may only be done in an Aitchison-compositional framework 
(see <code>princomp.acomp</code>).  
</p>


<h3>Value</h3>

<p><code>princomp</code> gives an object of type
<code>c("princomp.acomp","princomp")</code> with the following content:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>sdev</code></td>
<td>
<p>the standard deviation of the principal components</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loadings</code></td>
<td>
<p>the matrix of variable loadings (i.e., a matrix which
columns contain the eigenvectors). This is of class
<code>"loadings"</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p>the ilt-transformed vector of means used to center the dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Center</code></td>
<td>
<p>the <code>aplus</code> vector of means used to center the dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>the scaling applied to each variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.obs</code></td>
<td>
<p>number of observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scores</code></td>
<td>
<p>if <code>scores = TRUE</code>, the scores of the supplied data
on the principal components. Scores are coordinates in a basis given by the principal
components and thus not compositions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>not clearly understood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Loadings</code></td>
<td>
<p>vectors of amounts that represent a perturbation with the
vectors represented by the loadings of each of the factors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DownLoadings</code></td>
<td>
<p>vectors of amounts that represent a perturbation with the
inverses of the vectors represented by the loadings of each of the
factors</p>
</td>
</tr>
</table>
<p><code>predict</code> returns a matrix of scores of the observations in the
<code>newdata</code> dataset
<br>.
The other routines are mainly called for their side effect of plotting or
printing and return the object <code>x</code>.   
</p>


<h3>Author(s)</h3>

<p>K.Gerald v.d. Boogaart <a href="http://www.stat.boogaart.de">http://www.stat.boogaart.de</a></p>


<h3>See Also</h3>

<p><code>ilt</code>,<code>aplus</code>, <code>relativeLoadings</code> 
<code>princomp.acomp</code>, <code>princomp.rplus</code>,
<code>barplot.aplus</code>, <code>mean.aplus</code>,
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(SimulatedAmounts)
pc &lt;- princomp(aplus(sa.lognormals5))
pc
summary(pc)
plot(pc)           #plot(pc,type="screeplot")
plot(pc,type="v")
plot(pc,type="biplot")
plot(pc,choice=c(1,3),type="biplot")
plot(pc,type="loadings")
plot(pc,type="loadings",scale.sdev=-1) # Downward
plot(pc,type="relative",scale.sdev=NA) # The directions
plot(pc,type="relative",scale.sdev=1) # one sigma Upward 
plot(pc,type="relative",scale.sdev=-1) # one sigma Downward
biplot(pc)
screeplot(pc)
loadings(pc)
relativeLoadings(pc,mult=FALSE)
relativeLoadings(pc)
relativeLoadings(pc,scale.sdev=1)
relativeLoadings(pc,scale.sdev=2)

pc$Loadings
pc$DownLoadings
barplot(pc$Loadings)
pc$sdev^2
cov(predict(pc,sa.lognormals5))
</code></pre>


</div>