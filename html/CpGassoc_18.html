<div class="container">

<table style="width: 100%;"><tr>
<td>design</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Create full and reduced design matrices for the cpg.assoc function.
</h2>

<h3>Description</h3>

<p>Designed to be used by <code>cpg.assoc</code> and <code>cpg.perm</code>. Creates a full and reduced design matrices.
</p>


<h3>Usage</h3>

<pre><code class="language-R">design(covariates, indep, chip.id, random)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>covariates</code></td>
<td>

<p>A data frame consisting of the covariates of interest. covariates can also be a matrix if it is a model matrix minus the intercept column. 
It can also be a vector if there is only one covariate of interest.
If no covariates must be specified as <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indep</code></td>
<td>

<p>A vector containing the main variable of interest.  <code>cpg.assoc</code> will evaluate the association between indep and the beta values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chip.id</code></td>
<td>

<p>An optional vector containing chip or batch identities. If specified, <code>chip.id</code> will be included as a factor in the model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random</code></td>
<td>

<p>Is the model going to be a mixed effects. If so, <code>chip.id</code> will not be included in the design matrices.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list containing the full and reduced design matrices.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>full </code></td>
<td>
<p>The full design matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reduced </code></td>
<td>
<p>The reduced design matrix.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The <code>design</code> function  is designed to be used exclusively by the <code>cpg.assoc</code> and <code>cpg.perm</code> functions.
</p>


<h3>Author(s)</h3>

<p>Barfield, R.; Kilaru,V.; Conneely, K.<br>
Maintainer: R. Barfield: &lt;barfieldrichard8@gmail.com&gt;
</p>


<h3>See Also</h3>

<p><code>cpg.assoc</code>
<code>cpg.perm</code>
<code>cpg.work</code>
<code>plot.cpg</code>
<code>scatterplot</code>
<code>cpg.combine</code>
<code>manhattan</code>
<code>plot.cpg.perm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(samplecpg,samplepheno,package="CpGassoc")
#Example where there are covariates:
covar&lt;-data.frame(samplepheno$weight,samplepheno$Distance)
test&lt;-design(covar,samplepheno$SBP,samplepheno$chip,FALSE)
dim(test$full)
dim(test$reduced)
test$reduced[1:5,1:5]
test$full[1:5,1:5]
#When no covariates or chip.id:
test2&lt;-design(NULL,samplepheno$SBP,NULL,FALSE)
dim(test2$full)
dim(test2$reduced)
</code></pre>


</div>