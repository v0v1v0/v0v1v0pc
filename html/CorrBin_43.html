<div class="container">

<table style="width: 100%;"><tr>
<td>SO.mc.est</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Order-restricted MLE assuming marginal compatibility</h2>

<h3>Description</h3>

<p><code>SO.mc.est</code> computes the nonparametric maximum likelihood estimate of
the distribution of the number of responses in a cluster <code class="reqn">P(R=r|n)</code> under
a stochastic ordering constraint. Umbrella ordering can be specified using
the <code>turn</code> parameter.
</p>


<h3>Usage</h3>

<pre><code class="language-R">SO.mc.est(cbdata, turn = 1, control = soControl())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cbdata</code></td>
<td>
<p>an object of class <code>CBData</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>turn</code></td>
<td>
<p>integer specifying the peak of the umbrella ordering (see
Details). The default corresponds to a non-decreasing order.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>an optional list of control settings, usually a call to
<code>soControl</code>.  See there for the names of the settable control
values and their effect.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Two different algorithms: EM and ISDM are implemented. In general, ISDM (the
default) should be faster, though its performance depends on the tuning
parameter <code>max.directions</code>: values that are too low or too high slow the
algorithm down.
</p>
<p><code>SO.mc.est</code> allows extension to an umbrella ordering: <code class="reqn">D_1 \geq^{st}
\cdots \geq^{st} D_k \leq^{st} \cdots \leq^{st} D_n</code> by specifying the value of <code class="reqn">k</code> as the <code>turn</code>
parameter. This is an experimental feature, and at this point none of the
other functions can handle umbrella orderings.
</p>


<h3>Value</h3>

<p>A list with components:
</p>
<p>Components <code>Q</code> and <code>D</code> are unlikely to be needed by the user.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>MLest</code></td>
<td>
<p>data frame with the maximum likelihood estimates of
<code class="reqn">P(R_i=r|n)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q</code></td>
<td>
<p>numeric matrix; estimated weights for the mixing distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>numeric matrix; directional derivative of the log-likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>the achieved value of the log-likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>converge</code></td>
<td>
<p>a 2-element vector with the achieved relative error and
the performed number of iterations</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Aniko Szabo, aszabo@mcw.edu
</p>


<h3>References</h3>

<p>Szabo A, George EO. (2010) On the Use of Stochastic Ordering to
Test for Trend with Clustered Binary Data. <em>Biometrika</em> 97(1), 95-108.
</p>


<h3>See Also</h3>

<p><code>soControl</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
 data(shelltox)
 ml &lt;- SO.mc.est(shelltox, control=soControl(eps=0.01, method="ISDM"))
 attr(ml, "converge")
 
 require(lattice)
 panel.cumsum &lt;- function(x,y,...){
   x.ord &lt;- order(x)
   panel.xyplot(x[x.ord], cumsum(y[x.ord]), ...)}

 xyplot(Prob~NResp|factor(ClusterSize), groups=Trt, data=ml, type="s",
      panel=panel.superpose, panel.groups=panel.cumsum,
      as.table=TRUE, auto.key=list(columns=4, lines=TRUE, points=FALSE),
      xlab="Number of responses", ylab="Cumulative Probability R(R&gt;=r|N=n)",
      ylim=c(0,1.1), main="Stochastically ordered estimates\n with marginal compatibility")

</code></pre>


</div>