<div class="container">

<table style="width: 100%;"><tr>
<td>genotype_probabilities</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate genotype probabilities for a target person</h2>

<h3>Description</h3>

<p>For a chosen individual within a specified family, calculate the person's
conditional genotype probabilities, given the family's phenotypes and
relationship structure
</p>


<h3>Usage</h3>

<pre><code class="language-R">genotype_probabilities(target, fam, geno_freq, trans, penet, monozyg = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>
<p>The individual identifier (an element of <code>fam$indiv</code>)
of the person in the pedigree <code>fam</code> whose genotype probabilities are being
sought.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fam</code></td>
<td>
<p>A data frame specifying the family's relationship structure,
with rows corresponding to people and columns
corresponding to the following variables (other variables can be included
but will be ignored), which will be coerced to <code>character</code> type:
</p>

<ul>
<li> <p><code>indiv</code>, an identifier for each individual person, with no duplicates
in <code>fam</code>.
</p>
</li>
<li> <p><code>mother</code>, the individual identifier of each person's mother, or missing
(<code>NA</code>) for founders.
</p>
</li>
<li> <p><code>father</code>, the individual identifier of each person's father, or missing
(<code>NA</code>) for founders.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>geno_freq</code></td>
<td>
<p>A vector of strictly positive numbers that sum to <code>1</code>.
If the possible genotypes of the underlying genetic model are
<code>1:length(geno_freq)</code> then <code>geno_freq[j]</code> is interpreted as the population
frequency of genotype <code>j</code>.
For certain genetic models that often occur in applications, these genotype
frequencies can be calculated by <code>geno_freq_monogenic</code>,
<code>geno_freq_phased</code>, etc.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trans</code></td>
<td>
<p>An <code>ngeno^2</code> by <code>ngeno</code> matrix of non-negative numbers whose rows
all sum to <code>1</code>, where <code>ngeno = length(geno_freq)</code> is the number of possible
genotypes.  The rows of <code>trans</code> correspond to joint parental
genotypes and the columns correspond to offspring genotypes.
If the possible genotypes are <code>1:length(geno_freq)</code> then the element
<code>trans[ngeno * gm + gf - ngeno, go]</code> is interpreted as the conditional
probability that a person has genotype <code>go</code>, given that his or her
biological mother and father have genotypes <code>gm</code> and <code>gf</code>, respectively.
For certain genetic models that often occur in applications,
this transmission matrix can be calculated by <code>trans_monogenic</code>,
<code>trans_phased</code>, etc.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penet</code></td>
<td>
<p>An <code>nrow(fam)</code> by <code>length(geno_freq)</code> matrix of non-negative
numbers. The element <code>penet[i,j]</code> is interpreted as the conditional
probability (or probability density) of the phenotype of the person
corresponding to row <code>i</code> of <code>fam</code>, given that his or her genotype is <code>j</code>
(where the possible genotypes are <code>1:length(geno_freq)</code>).
Note that genotype data can be incorporated into <code>penet</code> by regarding
observed genotypes as part of the phenotype, i.e. by regarding observed
genotypes as (possibly noisy) measurements of the underlying true genotypes.
For example, if the observed genotype of person <code>i</code> is <code>1</code>
(and if genotype measurement error is negligible) then <code>penet[i,j]</code>
should be <code>0</code> for <code>j != 1</code> and <code>penet[i,1]</code> should be the same as if
person <code>i</code> were ungenotyped.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>monozyg</code></td>
<td>
<p>An optional list that can be used to specify genetically
identical persons, such as monozygotic twins, monozygotic triplets,
a monozygotic pair within a set of dizygotic triplets, etc.
Each element of the list should be a vector containing the individual
identifiers of a group of genetically identical persons, e.g. if <code>fam</code>
contains a set of monozygotic twins (and no other genetically identical
persons) then <code>monozyg</code> will be a list
with one element, and that element will be a vector of length two containing
the individual identifiers of the twins.  The order of the list
and the orders of its elements do not affect the output of the function.
Each group of genetically identical persons should contain two or more
persons, the groups should not overlap, and all persons in each group must
have the same (non-missing) parents.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The genotype probabilities are calculated by essentially the same algorithm
as <code>pedigree_loglikelihood</code>;
see there for details.  The genotype probabilities only depend on the
connected component of the pedigree that contains <code>target</code>, so the
function first restricts <code>fam</code> and <code>penet</code> to the rows corresponding to this
connected component.  For example, if <code>fam</code> is the union of two
unrelated families then this function will restrict to the subfamily
containing <code>target</code> before performing the calculation.
</p>


<h3>Value</h3>

<p>A vector of length <code>length(geno_freq)</code>, whose <code>j</code>th element is
the conditional probability that the target person has genotype <code>j</code>,
given the family's relationship structure and phenotypes.  A vector of <code>NA</code>s
will be returned if a row of <code>penet</code> consists entirely of zeroes or if
the pedigree is impossible for any other reason
(after restricting <code>fam</code> and <code>penet</code> to the connected component of
the pedigree containing <code>target</code>).
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Read in some sample data
data("dat_small", "penet_small")
str(dat_small)
str(penet_small)

# Calculate the genotype probabilities for individual "ora008" in the family "ora"
w &lt;- which(dat_small$family == "ora")
fam &lt;- dat_small[w, -1]
penet &lt;- penet_small[w, ]
monozyg &lt;- list(c("ora024", "ora027"))  # ora024 and ora027 are identical twins
trans &lt;- trans_monogenic(2)
geno_freq &lt;- geno_freq_monogenic(p_alleles = c(0.9, 0.1))
genotype_probabilities(target = "ora008", fam, geno_freq, trans, penet, monozyg)

</code></pre>


</div>