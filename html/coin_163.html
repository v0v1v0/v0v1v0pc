<div class="container">

<table style="width: 100%;"><tr>
<td>pvalue-methods</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Computation of the <code class="reqn">p</code>-Value, Mid-<code class="reqn">p</code>-Value, <code class="reqn">p</code>-Value
Interval and Test Size</h2>

<h3>Description</h3>

<p>Methods for computation of the <code class="reqn">p</code>-value, mid-<code class="reqn">p</code>-value, <code class="reqn">p</code>-value
interval and test size.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'PValue'
pvalue(object, q, ...)
## S4 method for signature 'NullDistribution'
pvalue(object, q, ...)
## S4 method for signature 'ApproxNullDistribution'
pvalue(object, q, ...)
## S4 method for signature 'IndependenceTest'
pvalue(object, ...)
## S4 method for signature 'MaxTypeIndependenceTest'
pvalue(object, method = c("global", "single-step",
                          "step-down", "unadjusted"),
       distribution = c("joint", "marginal"),
       type = c("Bonferroni", "Sidak"), ...)

## S4 method for signature 'NullDistribution'
midpvalue(object, q, ...)
## S4 method for signature 'ApproxNullDistribution'
midpvalue(object, q, ...)
## S4 method for signature 'IndependenceTest'
midpvalue(object, ...)

## S4 method for signature 'NullDistribution'
pvalue_interval(object, q, ...)
## S4 method for signature 'IndependenceTest'
pvalue_interval(object, ...)

## S4 method for signature 'NullDistribution'
size(object, alpha, type = c("p-value", "mid-p-value"), ...)
## S4 method for signature 'IndependenceTest'
size(object, alpha, type = c("p-value", "mid-p-value"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>an object from which the <code class="reqn">p</code>-value, mid-<code class="reqn">p</code>-value, <code class="reqn">p</code>-value
interval or test size can be computed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>

<p>a numeric, the quantile for which the <code class="reqn">p</code>-value, mid-<code class="reqn">p</code>-value or
<code class="reqn">p</code>-value interval is computed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>a character, the method used for the <code class="reqn">p</code>-value computation: either
<code>"global"</code> (default), <code>"single-step"</code>, <code>"step-down"</code> or
<code>"unadjusted"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distribution</code></td>
<td>

<p>a character, the distribution used for the computation of adjusted
<code class="reqn">p</code>-values: either <code>"joint"</code> (default) or <code>"marginal"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p><code>pvalue()</code>: a character, the type of <code class="reqn">p</code>-value adjustment when the
marginal distributions are used: either <code>"Bonferroni"</code> (default) or
<code>"Sidak"</code>.

<code>size()</code>: a character, the type of rejection region used when computing
the test size: either <code>"p-value"</code> (default) or <code>"mid-p-value"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>a numeric, the nominal significance level <code class="reqn">\alpha</code> at which the test size
is computed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>further arguments (currently ignored).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The methods <code>pvalue</code>, <code>midpvalue</code>, <code>pvalue_interval</code> and
<code>size</code> compute the <code class="reqn">p</code>-value, mid-<code class="reqn">p</code>-value, <code class="reqn">p</code>-value
interval and test size, respectively.
</p>
<p>For <code>pvalue()</code>, the global <code class="reqn">p</code>-value (<code>method = "global"</code>) is
returned by default and is given with an associated 99% confidence interval
when resampling is used to determine the null distribution (which for maximum
statistics may be true even in the asymptotic case).
</p>
<p>The familywise error rate (FWER) is always controlled under the global null
hypothesis, i.e., in the <em>weak</em> sense, implying that the smallest
adjusted <code class="reqn">p</code>-value is valid without further assumptions.  Control of the
FWER under any partial configuration of the null hypotheses, i.e., in the
<em>strong</em> sense, as is typically desired for multiple tests and
comparisons, requires that the <em>subset pivotality</em> condition holds
(Westfall and Young, 1993, pp. 42–43; Bretz, Hothorn and Westfall, 2011,
pp. 136–137).  In addition, for methods based on the joint distribution of
the test statistics, failure of the <em>joint exchangeability</em> assumption
(Westfall and Troendle, 2008; Bretz, Hothorn and Westfall, 2011, pp. 129–130)
may cause excess Type I errors.
</p>
<p>Assuming <em>subset pivotality</em>, single-step or <em>free</em> step-down
adjusted <code class="reqn">p</code>-values using max-<code class="reqn">T</code> procedures are obtained by setting
<code>method</code> to <code>"single-step"</code> or <code>"step-down"</code>, respectively.  In
both cases, the <code>distribution</code> argument specifies whether the adjustment
is based on the joint distribution (<code>"joint"</code>) or the marginal
distributions (<code>"marginal"</code>) of the test statistics.  For procedures
based on the marginal distributions, Bonferroni- or Šidák-type
adjustment can be specified through the <code>type</code> argument by setting it to
<code>"Bonferroni"</code> or <code>"Sidak"</code>, respectively.
</p>
<p>The <code class="reqn">p</code>-value adjustment procedures based on the joint distribution of the
test statistics fully utilizes distributional characteristics, such as
discreteness and dependence structure, whereas procedures using the marginal
distributions only incorporate discreteness.  Hence, the joint
distribution-based procedures are typically more powerful.  Details regarding
the single-step and <em>free</em> step-down procedures based on the joint
distribution can be found in Westfall and Young (1993); in particular, this
implementation uses Equation 2.8 with Algorithm 2.5 and 2.8, respectively.
Westfall and Wolfinger (1997) provide details of the marginal
distributions-based single-step and <em>free</em> step-down procedures.  The
generalization of Westfall and Wolfinger (1997) to arbitrary test statistics,
as implemented here, is given by Westfall and Troendle (2008).
</p>
<p>Unadjusted <code class="reqn">p</code>-values are obtained using <code>method = "unadjusted"</code>.
</p>
<p>For <code>midpvalue()</code>, the global mid-<code class="reqn">p</code>-value is given with an
associated 99% mid-<code class="reqn">p</code> confidence interval when resampling is used to
determine the null distribution.  The two-sided mid-<code class="reqn">p</code>-value is computed
according to the minimum likelihood method (Hirji <em>et al.</em>, 1991).
</p>
<p>The <code class="reqn">p</code>-value interval <code class="reqn">(p_0, p_1]</code> obtained by
<code>pvalue_interval()</code> was proposed by Berger (2000, 2001), where the upper
endpoint <code class="reqn">p_1</code> is the conventional <code class="reqn">p</code>-value and the mid-point, i.e.,
<code class="reqn">p_{0.5}</code>, is the mid-<code class="reqn">p</code>-value.  The lower endpoint <code class="reqn">p_0</code>
is the smallest <code class="reqn">p</code>-value attainable if no conservatism attributable to
the discreteness of the null distribution is present.  The length of the
<code class="reqn">p</code>-value interval is the null probability of the observed outcome and
provides a data-dependent measure of conservatism that is completely
independent of the nominal significance level.
</p>
<p>For <code>size()</code>, the test size, i.e., the actual significance level, at the
nominal significance level <code class="reqn">\alpha</code> is computed using either the rejection
region corresponding to the <code class="reqn">p</code>-value (<code>type = "p-value"</code>, default)
or the mid-<code class="reqn">p</code>-value (<code>type = "mid-p-value"</code>).  The test size is, in
contrast to the <code class="reqn">p</code>-value interval, a data-independent measure of
conservatism that depends on the nominal significance level.  A test size
smaller or larger than the nominal significance level indicates that the test
procedure is conservative or anti-conservative, respectively, at that
particular nominal significance level.  However, as pointed out by Berger
(2001), even when the actual and nominal significance levels are identical,
conservatism may still affect the <code class="reqn">p</code>-value.
</p>


<h3>Value</h3>

<p>The <code class="reqn">p</code>-value, mid-<code class="reqn">p</code>-value, <code class="reqn">p</code>-value interval or test size
computed from <code>object</code>.  A numeric vector or matrix.
</p>


<h3>Note</h3>

<p>The mid-<code class="reqn">p</code>-value, <code class="reqn">p</code>-value interval and test size of asymptotic
permutation distributions or exact permutation distributions obtained by the
split-up algorithm is reported as <code>NA</code>.
</p>
<p>In versions of <span class="pkg">coin</span> prior to 1.1-0, a min-<code class="reqn">P</code> procedure computing
Šidák single-step adjusted <code class="reqn">p</code>-values accounting for
discreteness was available when specifying <code>method = "discrete"</code>.  This
was made <strong>defunct</strong> in version 1.2-0 due to the introduction of a more
general max-<code class="reqn">T</code> version of the same algorithm.
</p>


<h3>References</h3>

<p>Berger, V. W.  (2000).  Pros and cons of permutation tests in clinical trials.
<em>Statistics in Medicine</em> <b>19</b>(10), 1319–1328.
<a href="https://doi.org/10.1002/%28SICI%291097-0258%2820000530%2919%3A10%3C1319%3A%3AAID-SIM490%3E3.0.CO%3B2-0">doi:10.1002/(SICI)1097-0258(20000530)19:10&lt;1319::AID-SIM490&gt;3.0.CO;2-0</a>
</p>
<p>Berger, V. W.  (2001).  The <code class="reqn">p</code>-value interval as an inferential tool.
<em>The Statistician</em> <b>50</b>(1), 79–85.  <a href="https://doi.org/10.1111/1467-9884.00262">doi:10.1111/1467-9884.00262</a>
</p>
<p>Bretz, F., Hothorn, T. and Westfall, P.  (2011).  <em>Multiple Comparisons
Using R</em>.  Boca Raton: CRC Press.
</p>
<p>Hirji, K. F., Tan, S.-J. and Elashoff, R. M.  (1991).  A quasi-exact test for
comparing two binomial proportions.  <em>Statistics in Medicine</em>
<b>10</b>(7), 1137–1153.  <a href="https://doi.org/10.1002/sim.4780100713">doi:10.1002/sim.4780100713</a>
</p>
<p>Westfall, P. H. and Troendle, J. F.  (2008).  Multiple testing with minimal
assumptions.  <em>Biometrical Journal</em> <b>50</b>(5), 745–755.
<a href="https://doi.org/10.1002/bimj.200710456">doi:10.1002/bimj.200710456</a>
</p>
<p>Westfall, P. H. and Wolfinger, R. D.  (1997).  Multiple tests with discrete
distributions.  <em>The American Statistician</em> <b>51</b>(1), 3–8.
<a href="https://doi.org/10.1080/00031305.1997.10473577">doi:10.1080/00031305.1997.10473577</a>
</p>
<p>Westfall, P. H. and Young, S. S.  (1993).  <em>Resampling-Based Multiple
Testing: Examples and Methods for <code class="reqn">p</code>-Value Adjustment</em>.  New York: John
Wiley &amp; Sons.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Two-sample problem
dta &lt;- data.frame(
    y = rnorm(20),
    x = gl(2, 10)
)

## Exact Ansari-Bradley test
(at &lt;- ansari_test(y ~ x, data = dta, distribution = "exact"))
pvalue(at)
midpvalue(at)
pvalue_interval(at)
size(at, alpha = 0.05)
size(at, alpha = 0.05, type = "mid-p-value")


## Bivariate two-sample problem
dta2 &lt;- data.frame(
    y1 = rnorm(20) + rep(0:1, each = 10),
    y2 = rnorm(20),
    x = gl(2, 10)
)

## Approximative (Monte Carlo) bivariate Fisher-Pitman test
(it &lt;- independence_test(y1 + y2 ~ x, data = dta2,
                         distribution = approximate(nresample = 10000)))

## Global p-value
pvalue(it)

## Joint distribution single-step p-values
pvalue(it, method = "single-step")

## Joint distribution step-down p-values
pvalue(it, method = "step-down")

## Sidak step-down p-values
pvalue(it, method = "step-down", distribution = "marginal", type = "Sidak")

## Unadjusted p-values
pvalue(it, method = "unadjusted")


## Length of YOY Gizzard Shad (Hollander and Wolfe, 1999, p. 200, Tab. 6.3)
yoy &lt;- data.frame(
    length = c(46, 28, 46, 37, 32, 41, 42, 45, 38, 44,
               42, 60, 32, 42, 45, 58, 27, 51, 42, 52,
               38, 33, 26, 25, 28, 28, 26, 27, 27, 27,
               31, 30, 27, 29, 30, 25, 25, 24, 27, 30),
    site = gl(4, 10, labels = as.roman(1:4))
)

## Approximative (Monte Carlo) Fisher-Pitman test with contrasts
## Note: all pairwise comparisons
(it &lt;- independence_test(length ~ site, data = yoy,
                         distribution = approximate(nresample = 10000),
                         xtrafo = mcp_trafo(site = "Tukey")))

## Joint distribution step-down p-values
pvalue(it, method = "step-down") # subset pivotality is violated
</code></pre>


</div>