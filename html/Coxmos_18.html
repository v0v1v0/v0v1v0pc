<div class="container">

<table style="width: 100%;"><tr>
<td>cv.splsdrcox_dynamic</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cross validation sPLS-DRCOX</h2>

<h3>Description</h3>

<p>The function cv.splsdrcox_dynamic conducts a cross-validation for the sPLS-DRCOX model,
which is a specialized model tailored for survival analysis. The function aims to optimize the model's
performance by determining the best number of PLS components and variables through cross-validation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cv.splsdrcox_dynamic(
  X,
  Y,
  max.ncomp = 8,
  vector = NULL,
  n_run = 3,
  k_folds = 10,
  x.center = TRUE,
  x.scale = FALSE,
  remove_near_zero_variance = TRUE,
  remove_zero_variance = TRUE,
  toKeep.zv = NULL,
  remove_variance_at_fold_level = FALSE,
  remove_non_significant_models = FALSE,
  remove_non_significant = FALSE,
  alpha = 0.05,
  MIN_NVAR = 10,
  MAX_NVAR = 1000,
  n.cut_points = 5,
  MIN_AUC_INCREASE = 0.01,
  EVAL_METHOD = "AUC",
  w_AIC = 0,
  w_c.index = 0,
  w_AUC = 1,
  w_BRIER = 0,
  times = NULL,
  max_time_points = 15,
  MIN_AUC = 0.8,
  MIN_COMP_TO_CHECK = 3,
  pred.attr = "mean",
  pred.method = "cenROC",
  fast_mode = FALSE,
  max.iter = 200,
  MIN_EPV = 5,
  return_models = FALSE,
  returnData = FALSE,
  PARALLEL = FALSE,
  verbose = FALSE,
  seed = 123
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Numeric matrix or data.frame. Explanatory variables. Qualitative variables must be
transform into binary variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Numeric matrix or data.frame. Response variables. Object must have two columns named as
"time" and "event". For event column, accepted values are: 0/1 or FALSE/TRUE for censored and event
observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.ncomp</code></td>
<td>
<p>Numeric. Maximum number of PLS components to compute for the cross validation
(default: 8).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vector</code></td>
<td>
<p>Numeric vector. Used for computing best number of variables. As many values as
components have to be provided. If vector = NULL, an automatic detection is perform (default: NULL).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_run</code></td>
<td>
<p>Numeric. Number of runs for cross validation (default: 3).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k_folds</code></td>
<td>
<p>Numeric. Number of folds for cross validation (default: 10).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.center</code></td>
<td>
<p>Logical. If x.center = TRUE, X matrix is centered to zero means (default: TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.scale</code></td>
<td>
<p>Logical. If x.scale = TRUE, X matrix is scaled to unit variances (default: FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remove_near_zero_variance</code></td>
<td>
<p>Logical. If remove_near_zero_variance = TRUE, near zero variance
variables will be removed (default: TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remove_zero_variance</code></td>
<td>
<p>Logical. If remove_zero_variance = TRUE, zero variance variables will
be removed (default: TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>toKeep.zv</code></td>
<td>
<p>Character vector. Name of variables in X to not be deleted by (near) zero variance
filtering (default: NULL).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remove_variance_at_fold_level</code></td>
<td>
<p>Logical. If remove_variance_at_fold_level = TRUE, (near) zero
variance will be removed at fold level (default: FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remove_non_significant_models</code></td>
<td>
<p>Logical. If remove_non_significant_models = TRUE,
non-significant models are removed before computing the evaluation. A non-significant model is a
model with at least one component/variable with a P-Value higher than the alpha cutoff.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remove_non_significant</code></td>
<td>
<p>Logical. If remove_non_significant = TRUE, non-significant
variables/components in final cox model will be removed until all variables are significant by
forward selection (default: FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Numeric. Numerical values are regarded as significant if they fall below the
threshold (default: 0.05).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MIN_NVAR</code></td>
<td>
<p>Numeric. Minimum range size for computing cut points to select the best number of
variables to use (default: 10).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MAX_NVAR</code></td>
<td>
<p>Numeric. Maximum range size for computing cut points to select the best number of
variables to use (default: 1000).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.cut_points</code></td>
<td>
<p>Numeric. Number of cut points for searching the optimal number of variables.
If only two cut points are selected, minimum and maximum size are used. For MB approaches as many
as n.cut_points^n.blocks models will be computed as minimum (default: 5).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MIN_AUC_INCREASE</code></td>
<td>
<p>Numeric. Minimum improvement between different cross validation models to
continue evaluating higher values in the multiple tested parameters. If it is not reached for next
'MIN_COMP_TO_CHECK' models and the minimum 'MIN_AUC' value is reached, the evaluation stops (default: 0.01).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EVAL_METHOD</code></td>
<td>
<p>Character. If EVAL_METHOD = "AUC", AUC metric will be use to compute the best
number of variables. In other case, c-index metric will be used (default: "AUC").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w_AIC</code></td>
<td>
<p>Numeric. Weight for AIC evaluator. All weights must sum 1 (default: 0).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w_c.index</code></td>
<td>
<p>Numeric. Weight for C-Index evaluator. All weights must sum 1 (default: 0).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w_AUC</code></td>
<td>
<p>Numeric. Weight for AUC evaluator. All weights must sum 1 (default: 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w_BRIER</code></td>
<td>
<p>Numeric. Weight for BRIER SCORE evaluator. All weights must sum 1 (default: 0).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>
<p>Numeric vector. Time points where the AUC will be evaluated. If NULL, a maximum of
'max_time_points' points will be selected equally distributed (default: NULL).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_time_points</code></td>
<td>
<p>Numeric. Maximum number of time points to use for evaluating the model
(default: 15).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MIN_AUC</code></td>
<td>
<p>Numeric. Minimum AUC desire to reach cross-validation models. If the minimum is
reached, the evaluation could stop if the improvement does not reach an AUC higher than adding the
'MIN_AUC_INCREASE' value (default: 0.8).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MIN_COMP_TO_CHECK</code></td>
<td>
<p>Numeric. Number of penalties/components to evaluate to check if the AUC
improves. If for the next 'MIN_COMP_TO_CHECK' the AUC is not better and the 'MIN_AUC' is meet, the
evaluation could stop (default: 3).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred.attr</code></td>
<td>
<p>Character. Way to evaluate the metric selected. Must be one of the following:
"mean" or "median" (default: "mean").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred.method</code></td>
<td>
<p>Character. AUC evaluation algorithm method for evaluate the model performance.
Must be one of the following: "risksetROC", "survivalROC", "cenROC", "nsROC", "smoothROCtime_C",
"smoothROCtime_I" (default: "cenROC").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fast_mode</code></td>
<td>
<p>Logical. If fast_mode = TRUE, for each run, only one fold is evaluated simultaneously.
If fast_mode = FALSE, for each run, all linear predictors are computed for test observations. Once
all have their linear predictors, the evaluation is perform across all the observations together
(default: FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.iter</code></td>
<td>
<p>Numeric. Maximum number of iterations for PLS convergence (default: 200).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MIN_EPV</code></td>
<td>
<p>Numeric. Minimum number of Events Per Variable (EPV) you want reach for the final
cox model. Used to restrict the number of variables/components can be computed in final cox models.
If the minimum is not meet, the model cannot be computed (default: 5).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_models</code></td>
<td>
<p>Logical. Return all models computed in cross validation (default: FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnData</code></td>
<td>
<p>Logical. Return original and normalized X and Y matrices (default: TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PARALLEL</code></td>
<td>
<p>Logical. Run the cross validation with multicore option. As many cores as your
total cores - 1 will be used. It could lead to higher RAM consumption (default: FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical. If verbose = TRUE, extra messages could be displayed (default: FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Number. Seed value for performing runs/folds divisions (default: 123).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The cv.splsdrcox_dynamic function is designed to perform cross-validation for the sPLS-DRCOX model,
a specialized model for survival analysis. The function's primary objective is to identify the
optimal number of PLS components and variables that yield the best model performance.
</p>
<p>The function accepts both numeric matrices and data frames for explanatory (X) and response (Y)
variables. It is essential to ensure that qualitative variables in X are transformed into binary
format. The response variable Y should have two columns: "time" and "event". The event column
should contain binary values, where 0/1 or FALSE/TRUE represent censored and event observations,
respectively.
</p>
<p>The cross-validation process is controlled by several parameters, including the maximum number of
PLS components (max.ncomp), the number of runs (n_run), and the number of folds (k_folds). The
function also provides options for data preprocessing, such as centering and scaling of the X matrix,
and removal of variables with near-zero or zero variance.
</p>
<p>Significance testing is incorporated into the model evaluation process. Users can specify the alpha
threshold (alpha) for determining significance. Non-significant models or variables can be optionally
removed from the evaluation based on user-defined criteria.
</p>
<p>The function also offers flexibility in model evaluation metrics. Users can choose between different
metrics such as AUC, AIC, C-Index, and Brier Score. The importance of each metric in the evaluation
can be controlled using weights (w_AIC, w_c.index, w_AUC, w_BRIER).
</p>
<p>For computational efficiency, the function provides an option to run the cross-validation in parallel
(PARALLEL). Additionally, verbose logging can be enabled to display extra messages during the execution.
</p>


<h3>Value</h3>

<p>Instance of class "Coxmos" and model "cv.sPLS-DRCOX-Dynamic".
<code>best_model_info</code>: A data.frame with the information for the best model.
<code>df_results_folds</code>: A data.frame with fold-level information.
<code>df_results_runs</code>: A data.frame with run-level information.
<code>df_results_comps</code>: A data.frame with component-level information (for cv.coxEN, EN.alpha
information).
</p>
<p><code>lst_models</code>: If return_models = TRUE, return a the list of all cross-validated models.
<code>pred.method</code>: AUC evaluation algorithm method for evaluate the model performance.
</p>
<p><code>opt.comp</code>: Optimal component selected by the best_model.
<code>opt.nvar</code>: Optimal number of variables selected by the best_model.
</p>
<p><code>plot_AIC</code>: AIC plot by each hyper-parameter.
<code>plot_c_index</code>: C-Index plot by each hyper-parameter.
<code>plot_BRIER</code>: Brier Score plot by each hyper-parameter.
<code>plot_AUC</code>: AUC plot by each hyper-parameter.
</p>
<p><code>class</code>: Cross-Validated model class.
</p>
<p><code>lst_train_indexes</code>: List (of lists) of indexes for the observations used in each run/fold
for train the models.
<code>lst_test_indexes</code>: List (of lists) of indexes for the observations used in each run/fold
for test the models.
</p>
<p><code>time</code>: time consumed for running the cross-validated function.
</p>


<h3>Author(s)</h3>

<p>Pedro Salguero Garcia. Maintainer: pedsalga@upv.edu.es
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("X_proteomic")
data("Y_proteomic")
set.seed(123)
index_train &lt;- caret::createDataPartition(Y_proteomic$event, p = .5, list = FALSE, times = 1)
X_train &lt;- X_proteomic[index_train,1:20]
Y_train &lt;- Y_proteomic[index_train,]
cv.splsdrcox_dynamic_model &lt;- cv.splsdrcox_dynamic(X_train, Y_train, max.ncomp = 1, vector = NULL,
n_run = 1, k_folds = 2, x.center = TRUE, x.scale = TRUE)
</code></pre>


</div>