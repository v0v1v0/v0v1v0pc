<div class="container">

<table style="width: 100%;"><tr>
<td>em.cat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
EM algorithm for incomplete categorical data
</h2>

<h3>Description</h3>

<p>Finds ML estimate or posterior mode of cell probabilities under
the saturated multinomial model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">em.cat(s, start, prior=1, showits=TRUE, maxits=1000,
eps=0.0001)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>

<p>summary list of an incomplete categorical dataset produced by
the function <code>prelim.cat</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>

<p>optional starting value of the parameter. This is an array with
dimensions <code>s$d</code> whose elements sum to one. The default starting value
is a uniform array (equal probabilities in all cells). If structural
zeros appear in the table, <code>start</code> should contain zeros in those
positions and nonzero (e.g. uniform) values elsewhere. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>

<p>optional vector of hyperparameters for a Dirichlet prior distribution.
The default is a uniform prior distribution (all hyperparameters = 1)
on the cell probabilities, which will result in maximum likelihood
estimation. If structural zeros appear in the table, a prior should be
supplied with <code>NA</code>s in those cells.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showits</code></td>
<td>

<p>if <code>TRUE</code>, reports the iterations of EM so the user can monitor
the progress of the algorithm.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxits</code></td>
<td>

<p>maximum number of iterations performed. The algorithm will stop if the
parameter still has not converged after this many iterations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>

<p>convergence criterion. This is the largest proportional change in an
expected cell count from one iteration to the next.  Any expected
cell count that drops below 1E-07 times the average cell probability
(1/number of non-structural zero cells) is set to zero during the
iterations.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>array of dimension <code>s$d</code> containing the ML estimate or posterior mode,
assuming that EM  has converged by <code>maxits</code> iterations.
</p>


<h3>Note</h3>

<p>If zero cell counts occur in the observed-data table, the maximum
likelihood estimate may not be unique, and the algorithm may converge
to different stationary values depending on the starting value. Also,
if zero cell counts occur in the observed-data table, the ML estimate
may lie on the boundary of the parameter space. Supplying a prior with
hyperparameters greater than one will give a unique posterior mode in
the interior of the parameter space. Estimated probabilities for
structural zero cells will always be zero.
</p>


<h3>References</h3>

<p>Schafer (1996)  <em>Analysis of Incomplete Multivariate Data.</em>
Chapman &amp; Hall, Section 7.3.
</p>


<h3>See Also</h3>

<p><code>prelim.cat</code>, <code>ecm.cat</code>, <code>logpost.cat</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(crimes)
crimes
s &lt;- prelim.cat(crimes[,1:2],crimes[,3])     # preliminary manipulations
thetahat &lt;- em.cat(s)                        # mle under saturated model
logpost.cat(s,thetahat)                      # loglikelihood at thetahat
</code></pre>


</div>