<div class="container">

<table style="width: 100%;"><tr>
<td>clme</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Constrained Inference for Linear Mixed Effects Models</h2>

<h3>Description</h3>

<p>Constrained inference for linear fixed or mixed
effects models using distribution-free bootstrap methodology
</p>


<h3>Usage</h3>

<pre><code class="language-R">clme(
  formula,
  data = NULL,
  gfix = NULL,
  constraints = list(),
  tsf = lrt.stat,
  tsf.ind = w.stat.ind,
  mySolver = "LS",
  all_pair = FALSE,
  verbose = c(FALSE, FALSE, FALSE),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula expression. The constrained effect must come before any unconstrained 
covariates on the right-hand side of the expression. The constrained effect should 
be an ordered factor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data frame containing the variables in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gfix</code></td>
<td>
<p>optional vector of group levels for residual variances. Data should be sorted by this value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constraints</code></td>
<td>
<p>optional list containing the constraints. See Details for further information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tsf</code></td>
<td>
<p>function to calculate the test statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tsf.ind</code></td>
<td>
<p>function to calculate the test statistic for individual constrats. See Details for further information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mySolver</code></td>
<td>
<p>solver to use in isotonization (passed to <code>activeSet</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>all_pair</code></td>
<td>
<p>logical, whether all pairwise comparisons should be considered (constraints will be ignored).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>optional. Vector of 3 logicals. The first causes printing of iteration step, the second two are passed as the <code>verbose</code> argument to the functions <code>minque</code> and <code>clme_em</code>, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>space for additional arguments.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If any random effects are included, the function computes MINQUE estimates of variance components. After, 
<code>clme_em</code> is run to obtain the observed values. If <code>nsim</code>&gt;0, a bootstrap test is performed
using <code>resid_boot</code>.
For the argument <code>levels</code> the first list element should be the column index (in <code>data</code>) of the
constrained effect. The second element should be the true order of the levels.
</p>


<h3>Value</h3>

<p>The output of <code>clme</code> is an object of the class <code>clme</code>, which is list with elements:
</p>
    
<ul>
<li>
<p><code>theta</code> estimates of <code class="reqn">\theta</code> coefficients
</p>
</li>
<li>
<p><code>theta</code> estimates of <code class="reqn">\theta_0</code> coefficients under the null hypothesis
</p>
</li>
<li>
<p><code>ssq</code> estimate of residual variance(s), <code class="reqn">\sigma^{2}_{i}</code>.
</p>
</li>
<li>
<p><code>tsq</code> estimate of random effects variance component(s), <code class="reqn">\tau^{2}_{i}</code>.
</p>
</li>
<li>
<p><code>cov.theta</code> the unconstrained covariance matrix of <code class="reqn">\theta</code>
</p>
</li>
<li>
<p><code>ts.glb</code> test statistic for the global hypothesis.
</p>
</li>
<li>
<p><code>ts.ind</code> test statistics for each of the constraints.
</p>
</li>
<li>
<p><code>mySolver</code> the solver used for isotonization.
</p>
</li>
<li>
<p><code>constraints</code> list containing the constraints (<code>A</code>) and the contrast for the global test (<code>B</code>).
</p>
</li>
<li>
<p><code>dframe</code> data frame containing the variables in the model.
</p>
</li>
<li>
<p><code>residuals</code> matrix containing residuals. For mixed models three types of residuals are given. 
</p>
</li>
<li>
<p><code>random.effects</code> estimates of random effects. 
</p>
</li>
<li>
<p><code>gfix</code> group sample sizes for residual variances. 
</p>
</li>
<li>
<p><code>gran</code> group sizes for random effect variance components. 
</p>
</li>
<li>
<p><code>gfix_group</code> group names for residual variances. 
</p>
</li>
<li>
<p><code>formula</code> the formula used in the model. 
</p>
</li>
<li>
<p><code>call</code> the function call. 
</p>
</li>
<li>
<p><code>order</code> list describing the specified or estimated constraints.
</p>
</li>
<li>
<p><code>P1</code> the number of constrained parameters.
</p>
</li>
<li>
<p><code>nsim</code> the number of bootstrap simulations used for inference.
</p>
</li>
</ul>
<h3>Note</h3>

<p>The argument <code>constraints</code> is a list containing the order restrictions. The elements are 
<code>order</code>, <code>node</code>, <code>decreasing</code>, <code>A</code>, and <code>B</code>, though not all are necessary.
The function can calculate the last two for default orders (simple, umbrella, or simple tree). For
default orders, <code>constraints</code> should be a list containing any subset of <code>order</code>, 
<code>node</code>, and <code>descending</code>. See Figure 1 from Jelsema \&amp; Peddada (2016); the 
pictured <code>node</code> of the simple tree orders (middle column) is 1, and the <code>node</code> for the
umbrella orders (right column) is 3. These may be vectors (e.g. order=('simple','umbrella') ).
If any of these three are missing, the function will test for all possible values of the missing 
element(s), excluding simple tree.
</p>
<p>For non-default orders, the elements <code>A</code> and <code>B</code> should be provided. <code>A</code> is an
<code class="reqn">r \times2</code> matrix (where r is the number of linear constraints, <code class="reqn">0 &lt; r</code>. 
Each row should contain two indices, the first element is the index of the lesser coefficient, the 
second element is the index of the greater coefficient. So a row of <code class="reqn">(1,2)</code> corresponds
to the constraint <code class="reqn">\theta_1 \leq \theta_2</code>, and a row <code class="reqn">(4,3)</code> 
corresponds to the constraint <code class="reqn">\theta_4 \leq \theta_3</code>, etc. Element <code>B</code>
should hold similar contrasts, specifically those needed for calculating the Williams' type test 
statistic (<code>B</code> is only needed if <code>tsf=w.stat</code>)
The argument <code>tsf</code> is a function to calculate the desired test statistic. The default function 
calculates likelihood ratio type test statistic. A Williams type test statistic, which is the maximum 
of the test statistic over the constraints in <code>constraints\$B</code>, is also available, and custom 
functions may be defined. See <code>w.stat</code> for details.
By default, homogeneity of variances is assumed for residuals (e.g., <code>gfix</code> does not define groups)
and for each random effect. 
Some values can be passed to <code>clme</code> that are not used in this function. For instance, 
<code>seed</code> and <code>nsim</code> can each be passed as an argument here, and <code>summary.clme</code> will
use these values.
</p>


<h3>References</h3>

<p>Jelsema, C. M. and Peddada, S. D. (2016). 
CLME: An R Package for Linear Mixed Effects Models under Inequality Constraints. 
<em>Journal of Statistical Software</em>, 75(1), 1-32. doi:10.18637/jss.v075.i01
</p>


<h3>Examples</h3>

<pre><code class="language-R">data( rat.blood )
cons &lt;- list(order="simple", decreasing=FALSE, node=1 )

clme.out &lt;- clme(mcv ~ time + temp + sex + (1|id), data=rat.blood , 
                 constraints=cons, seed=42, nsim=10 )

</code></pre>


</div>