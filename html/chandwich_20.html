<div class="container">

<table style="width: 100%;"><tr>
<td>profile_loglik</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Profile loglikelihood</h2>

<h3>Description</h3>

<p>Calculates the profile loglikelihood for a subset of the model parameters.
This function is provided primarily so that it can be called by
<code>conf_intervals</code> and <code>conf_region</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">profile_loglik(
  object,
  prof_pars = NULL,
  prof_vals = NULL,
  init = NULL,
  type = c("vertical", "cholesky", "spectral", "none"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of class <code>"chandwich"</code> returned by
<code>adjust_loglik</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prof_pars</code></td>
<td>
<p>A vector specifying the subset of the (unfixed) parameters
over which to profile. Can be either a numeric vector, specifying indices
of the components of the <strong>full</strong> parameter vector, or a character
vector of parameter names, which must be a subset of those supplied in
<code>par_names</code> in the call to <code>adjust_loglik</code> that produced
<code>object</code>.
</p>
<p><code>prof_pars</code> must not have any parameters in common with
<code>attr(object, "fixed_pars")</code>.  <code>prof_pars</code> must not contain
all of the unfixed parameters, i.e. there is no point in profiling over
all of the unfixed parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prof_vals</code></td>
<td>
<p>A numeric vector.  Values of the parameters in
<code>prof_pars</code>.  If <code>prof_vals = NULL</code> then the MLEs stored
in <code>object</code> of the parameters <code>prof_pars</code> are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>A numeric vector of initial estimates of the values of the
parameters that are not fixed and are not in <code>prof_pars</code>.
Should have length <code>attr(object, "p_current") - length(prof_pars)</code>.
If <code>init</code> is <code>NULL</code> or is of the wrong length then the
relevant components from the MLE stored in <code>object</code> are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>A character scalar.  The argument <code>type</code> to the function
returned by <code>adjust_loglik</code>, that is, the type of adjustment
made to the independence loglikelihood function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed to <code>optim</code>.
These may include <code>gr</code>, <code>method</code>, <code>lower</code>, <code>upper</code>
or <code>control</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A numeric vector of length 1.  The value of the profile
loglikelihood.  The returned object has the attribute <code>"free_pars"</code>
giving the optimal values of the parameters that remain after the
parameters <code>prof_pars</code> and <code>attr(object, "fixed_pars")</code> have
been removed from the full parameter vector.  If there are no such
parameters, which happens if an attempt is made to profile over
<em>all</em> non-fixed parameters, then this attribute is not present and
the value returned is calculated using the function <code>object</code>.
</p>


<h3>See Also</h3>

<p><code>adjust_loglik</code> to adjust a user-supplied
loglikelihood function.
</p>
<p><code>conf_intervals</code> for confidence intervals for
individual parameters.
</p>
<p><code>conf_region</code> for a confidence region for
a pair of parameters.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># -------------------------- GEV model, owtemps data -----------------------
# ------------ following Section 5.2 of Chandler and Bate (2007) -----------

gev_loglik &lt;- function(pars, data) {
  o_pars &lt;- pars[c(1, 3, 5)] + pars[c(2, 4, 6)]
  w_pars &lt;- pars[c(1, 3, 5)] - pars[c(2, 4, 6)]
  if (isTRUE(o_pars[2] &lt;= 0 | w_pars[2] &lt;= 0)) return(-Inf)
  o_data &lt;- data[, "Oxford"]
  w_data &lt;- data[, "Worthing"]
  check &lt;- 1 + o_pars[3] * (o_data - o_pars[1]) / o_pars[2]
  if (isTRUE(any(check &lt;= 0))) return(-Inf)
  check &lt;- 1 + w_pars[3] * (w_data - w_pars[1]) / w_pars[2]
  if (isTRUE(any(check &lt;= 0))) return(-Inf)
  o_loglik &lt;- log_gev(o_data, o_pars[1], o_pars[2], o_pars[3])
  w_loglik &lt;- log_gev(w_data, w_pars[1], w_pars[2], w_pars[3])
  return(o_loglik + w_loglik)
}

# Initial estimates (method of moments for the Gumbel case)
sigma &lt;- as.numeric(sqrt(6 * diag(var(owtemps))) / pi)
mu &lt;- as.numeric(colMeans(owtemps) - 0.57722 * sigma)
init &lt;- c(mean(mu), -diff(mu) / 2, mean(sigma), -diff(sigma) / 2, 0, 0)

# Log-likelihood adjustment of the full model
par_names &lt;- c("mu[0]", "mu[1]", "sigma[0]", "sigma[1]", "xi[0]", "xi[1]")
large &lt;- adjust_loglik(gev_loglik, data = owtemps, init = init,
                       par_names = par_names)

# Profile loglikelihood for xi1, evaluated at xi1 = 0
profile_loglik(large, prof_pars = "xi[1]", prof_vals = 0)

# Model with xi1 fixed at 0
medium &lt;- adjust_loglik(larger = large, fixed_pars = "xi[1]")
# Profile loglikelihood for xi0, evaluated at xi0 = -0.1
profile_loglik(medium, prof_pars = "xi[0]", prof_vals = -0.1)
</code></pre>


</div>