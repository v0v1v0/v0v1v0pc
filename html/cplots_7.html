<div class="container">

<table style="width: 100%;"><tr>
<td>cmhist</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multi-class Stacked Circular Histogram and Rose Diagram</h2>

<h3>Description</h3>

<p>Function <code>cmhist</code> can be used to plot 2-dimensional 
histograms and rose diagrams for circular data with multiple classes. 
The histograms are stacked to avoid any overlap.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cmhist(
  value,
  class,
  nbins = 36,
  radius = 1/sqrt(base::pi),
  area.prop = TRUE,
  prob = TRUE,
  proportion = FALSE,
  total.area = 1,
  nlabels = 4,
  cols = NULL,
  borders = NULL,
  m = NA,
  xlim = NULL,
  ylim = NULL,
  main = NULL,
  type = c("null", "compass", "clock"),
  x.legend = "bottomright",
  y.legend = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>a numeric vector storing angular values between 0 and 2 pi,
or an object that can be coerced to.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>class</code></td>
<td>
<p>a character vector specifying the group the <code>value</code>
belongs to. It needs to have the same length as <code>value</code>,
otherwise it is repeated to the length of <code>value</code>. The order of
plotting from the innermost to the outermost depends on the order of
their appearance in <code>class</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbins</code></td>
<td>
<p>the number of bins of the circular histogram. Internally,
it is rounded to a multiple of 4.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>radius</code></td>
<td>
<p>the radius of the reference circle.  If <code>radius = 0</code>,
a rose diagram is produced; if <code>radius &gt; 0</code>, a circular histogram
is produced outside the reference circle.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>area.prop</code></td>
<td>
<p>logical; if <code>TRUE</code>, an area-proportional
transformation is applied; if <code>FALSE</code>, a height-proportional
transformationis applied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>logical; if <code>TRUE</code>, the circular histogram graphic is a
representation of probability densities; if <code>FALSE</code>, a
representation of frequencies.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proportion</code></td>
<td>
<p>logical; if <code>TRUE</code>, the frequencies are scaled by
the proportion of each class, so that the total area under bars is
unity; if <code>FALSE</code>, each class is considered as a separate
distribution and has area of unity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>total.area</code></td>
<td>
<p>a positive number specifying the total area under all the
histograms. If <code>total.area = NULL</code>, no scaling is applied, the
plot is in the original scale. If <code>area.prop = TRUE</code>, the total area 
is automatically unity without scaling.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlabels</code></td>
<td>
<p>integer, for the number of levels to be plotted; if
<code>0</code>, no label is plotted.  The larger the number is, the more
accurate the plot will be.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cols</code></td>
<td>
<p>the colors to fill the bars, with the same order as the
class.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>borders</code></td>
<td>
<p>the colors of the border around the bars.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>the number of points within each bin to plot the circular
histogram. The larger the number is, the smoother the plot looks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>numeric vectors of length 2, giving the x coordinates
ranges.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>numeric vectors of length 2, giving the y coordinates
ranges.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>the main title (on top)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>the type of circular data, one of the values <code>"null"</code>,
<code>"compass"</code> or <code>"clock"</code>.  If <code>"null"</code>, no special
lables plotted for directions. If <code>"compass"</code>, the four cardinal
directions are printed inside the reference circle. If <code>"clock"</code>,
labels for 24 hours are printed inside the reference circle.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.legend</code></td>
<td>
<p>x coordinate to plot the legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.legend</code></td>
<td>
<p>y coordinate to plot the legend.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>No return value
</p>


<h3>Author(s)</h3>

<p>Danli Xu &lt;dxu452@aucklanduni.ac.nz&gt;, Yong Wang &lt;yongwang@auckland.ac.nz&gt;
</p>


<h3>References</h3>

<p>Xu, D. and Wang, Y. (2020). Area-proportional Visualization for
Circular Data. <em>Journal of Computational and Graphical
Statistics</em>, <b>29</b>, 351-357.
</p>


<h3>See Also</h3>

<p><code>chist</code>, <code>cmdensity</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load the dataset
library(circular)
data("pigeons", package = "circular")
x = pigeons[,2] / 180 * pi
y = pigeons[,1]

# stacked circular histograms
cmhist(x, y)             # area-proportional 
cmhist(x, y, area=FALSE) # height-proportional

</code></pre>


</div>