<div class="container">

<table style="width: 100%;"><tr>
<td>fcount</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Efficiently Count Observations by Group
</h2>

<h3>Description</h3>

<p>A much faster replacement for <code>dplyr::count</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fcount(x, ..., w = NULL, name = "N", add = FALSE,
      sort = FALSE, decreasing = FALSE)

fcountv(x, cols = NULL, w = NULL, name = "N", add = FALSE,
        sort = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a data frame or list-like object, including 'grouped_df' or 'indexed_frame'. Atomic vectors or matrices can also be passed, but will be sent through <code>qDF</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>for <code>fcount</code>: names or sequences of columns to count cases by - passed to <code>fselect</code>. For <code>fcountv</code>: further arguments passed to <code>GRP</code> (such as <code>decreasing</code>, <code>na.last</code>, <code>method</code>, <code>effect</code> etc.). Leaving this empty will count on all columns. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cols</code></td>
<td>
<p>select columns to count cases by, using column names, indices, a logical vector or a selector function (e.g. <code>is_categorical</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>a numeric vector of weights, may contain missing values. In <code>fcount</code> this can also be the (unquoted) name of a column in the data frame. <code>fcountv</code> also supports a single character name. <em>Note</em> that the corresponding argument in <code>dplyr::count</code> is called <code>wt</code>, but <em>collapse</em> has a global default for weights arguments to be called <code>w</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>character. The name of the column containing the count or sum of weights. <code>dplyr::count</code> it is called <code>"n"</code>, but <code>"N"</code> is more consistent with the rest of <em>collapse</em> and <em>data.table</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p><code>TRUE</code> adds the count column to <code>x</code>. Alternatively <code>add = "group_vars"</code> (or <code>add = "gv"</code> for parsimony) can be used to retain only the variables selected for counting in <code>x</code> and the count.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sort, decreasing</code></td>
<td>
<p>arguments passed to <code>GRP</code> affecting the order of rows in the output (if <code>add = FALSE</code>), and the algorithm used for counting. In general, <code>sort = FALSE</code> is faster unless data is already sorted by the columns used for counting.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If <code>x</code> is a list, an object of the same type as <code>x</code> with a column (<code>name</code>) added at the end giving the count. Otherwise, if <code>x</code> is atomic, a data frame returned from <code>qDF(x)</code> with the count column added. By default (<code>add = FALSE</code>) only the unique rows of <code>x</code> of the columns used for counting are returned.
</p>


<h3>See Also</h3>

<p><code>GRPN</code>, <code>fnobs</code>, <code>fndistinct</code>, Fast Grouping and Ordering, Collapse Overview
</p>


<h3>Examples</h3>

<pre><code class="language-R">fcount(mtcars, cyl, vs, am)
fcountv(mtcars, cols = .c(cyl, vs, am))
fcount(mtcars, cyl, vs, am, sort = TRUE)
fcount(mtcars, cyl, vs, am, add = TRUE)
fcount(mtcars, cyl, vs, am, add = "group_vars")

## With grouped data
mtcars |&gt; fgroup_by(cyl, vs, am) |&gt; fcount()
mtcars |&gt; fgroup_by(cyl, vs, am) |&gt; fcount(add = TRUE)
mtcars |&gt; fgroup_by(cyl, vs, am) |&gt; fcount(add = "group_vars")

## With indexed data: by default counting on the first index variable
wlddev |&gt; findex_by(country, year) |&gt; fcount()
wlddev |&gt; findex_by(country, year) |&gt; fcount(add = TRUE)
# Use fcountv to pass additional arguments to GRP.pdata.frame,
# here using the effect argument to choose a different index variable
wlddev |&gt; findex_by(country, year) |&gt; fcountv(effect = "year")
wlddev |&gt; findex_by(country, year) |&gt; fcountv(add = "group_vars", effect = "year")

</code></pre>


</div>