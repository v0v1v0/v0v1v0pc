<div class="container">

<table style="width: 100%;"><tr>
<td>sumexact, cumsumexact</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Basic Sum Operations without Round-off Errors</h2>

<h3>Description</h3>

<p>Functions for performing basic sum operations without round-off errors
</p>


<h3>Usage</h3>

<pre><code class="language-R">  sumexact(..., na.rm = FALSE)
  cumsumexact(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>numeric vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>numeric vector(s), numbers or other objects to be summed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>logical. Should missing values be removed?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>All three functions use full precision summation using multiple doubles for 
intermediate values. The sum of numbers x &amp; y is a=x+y with error term 
b=error(a+b). That way a+b is equal exactly x+y, so sum of 2 numbers is stored
as 2 or fewer values, which when added would under-flow. By extension sum of n 
numbers is calculated with intermediate results stored as array of numbers 
that can not be added without introducing an error. Only final result is 
converted to a single number
</p>


<h3>Value</h3>

<p>Function <code>sumexact</code> returns single number. Function <code>cumsumexact</code> 
returns vector of the same length as <code>x</code>. 
</p>


<h3>Author(s)</h3>

<p>Jarek Tuszynski (SAIC) <a href="mailto:jaroslaw.w.tuszynski@saic.com">jaroslaw.w.tuszynski@saic.com</a> based on
code by Vadim Ogranovich, which is based on algorithms described in 
references, pointed out by Gabor Grothendieck. 
</p>


<h3>References</h3>

<p>Round-off error correction is based on:
Shewchuk, Jonathan, <em>Adaptive Precision Floating-Point Arithmetic and Fast Robust Geometric Predicates</em>
</p>
<p>McCullough, D.B., (1998) <em>Assessing the Reliability of Statistical 
Software, Part I</em>, The American Statistician, Vol. 52 No.
</p>
<p>McCullough, D.B., (1999) <em>Assessing the Reliability of Statistical 
Software, Part II</em>, The American Statistician, Vol. 53 No 2
</p>
<p>NIST Statistical Reference Datasets (StRD) website 
</p>


<h3>See Also</h3>

       
<ul>
<li> <p><code>sum</code> is faster but not error-save version of 
<code>sumexact</code>
</p>
</li>
<li> <p><code>cumsum</code> is equivalent to <code>cumsumexact</code>
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">  x = c(1, 1e20, 1e40, -1e40, -1e20, -1)
  a = sum(x);         print(a)
  b = sumexact(x);    print(b)
  stopifnot(b==0)
  a = cumsum(x);      print(a)
  b = cumsumexact(x); print(b)
  stopifnot(b[6]==0)
</code></pre>


</div>