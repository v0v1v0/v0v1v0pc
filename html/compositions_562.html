<div class="container">

<table style="width: 100%;"><tr>
<td>pwlr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Pairwise log ratio transform</h2>

<h3>Description</h3>

<p>Compute the pairwise log ratio transform of a (dataset of)
composition(s), and its inverse.
</p>


<h3>Usage</h3>

<pre><code class="language-R">      pwlr( x, as.rmult=FALSE, as.data.frame=!as.rmult, ...)
      pwlrInv( z, orig=gsi.orig(z))
  </code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a composition, not necessarily closed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>the pwlr-transform of a composition, thus a [D(D-1)/2]-dimensional
real vector, or a matrix with such many columns</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>as.rmult</code></td>
<td>
<p>logical; should the output be produced as an rmult object?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>as.data.frame</code></td>
<td>
<p>logical; should be as a data.frame? if both are false, rmult will be taken</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>currently unused</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>orig</code></td>
<td>
<p>the original composition, to check consistency and recover component names</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The pwlr-transform maps a composition in the $D$-part Aitchison-simplex
isometrically to a $D(D-1)/2$ dimensonal euclidian vector, computing each possible 
logratio (accounting for the fact that $log(A/B)=-log(B/A)$, and therefore only one of 
them is necessary). The data can then
be analysed in this transformation by multivariate
analysis tools not relying on the invertibility of the covariance function. 
The interpretation of
the results is relatively simple, since each component captures the behaviour of the 
simple ratio between two party. However redundance between them is extremely high, 
and any of  <code>alr</code>, <code>clr</code> or <code>ilr</code> transformations 
may be preferred in most applications.<br></p>
<p>The pairwise logratio transform is given by
</p>
<p style="text-align: center;"><code class="reqn"> pwlr(x)_{ij} := \ln\frac{x_i}{x_j}  </code>
</p>
<p>.
</p>
<p>The inverse requires some explanation, because of the redundance between pwlr scores. 
Note that for any three components $A,B,C$ it holds that $log(A/C)=log(A/B)+log(B/C)$.
So, any vector of $D(D-1)/2$ coefficients will not be necessarily a valid pwlr-transformed 
composition: if these coefficients do not satisfy that kind of relations, the vector is, 
strictly speaking, not a pwlr and should not be inverted. Nevertheless, the function gives 
a least-squares inversion, as proposed by Tolosana-Delgado and von Eynatten (2009).
</p>


<h3>Value</h3>

<p><code>pwlr</code> gives the pairwise log ratio transform; accepts a compositional dataset
<code>pwlrInv</code> gives a closed composition with the given wplr-transform; accepts a dataset
</p>


<h3>Author(s)</h3>

<p>R. Tolosana-Delgado <a href="http://www.stat.boogaart.de">http://www.stat.boogaart.de</a></p>


<h3>References</h3>

<p>Aitchison, J. (1986) <em>The Statistical Analysis of Compositional
Data</em> Monographs on Statistics and Applied Probability. Chapman &amp;
Hall Ltd., London (UK). 416p.
</p>
<p>Tolosana-Delgado, R. and H. von Eynatten (2009); Grain-size control 
on petrographic composition of sediments: compositional regression 
and rounded zeroes. <em>Mathematical Geosciences</em>: 41(8): 869-886. 
doi: <a href="https://doi.org/10.1007/s11004-009-9216-6">10.1007/s11004-009-9216-6</a>.
</p>


<h3>See Also</h3>

<p><code>clr</code>,<code>alr</code>,<code>apt</code>,
<a href="https://ima.udg.edu/Activitats/CoDaWork03/">https://ima.udg.edu/Activitats/CoDaWork03/</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">(tmp &lt;- pwlr(c(1,2,3)))
pwlrInv(tmp)
</code></pre>


</div>