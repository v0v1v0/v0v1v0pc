<div class="container">

<table style="width: 100%;"><tr>
<td>gsi.varwithlosts</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Internal function: computes variance of compositional data set with missing/zero values</h2>

<h3>Description</h3>

<p>Computes an unbiased estimate of the variance of a compositional data set with some missing and zero values.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gsi.varwithlosts(x,giveCenter=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>data set of the classes in <code>compositions</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>giveCenter</code></td>
<td>
<p>a logical. If TRUE the function reports the mean as
an attribute "center" to the result.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A variance matrix using all the observed information, where some of its 
components have been downweighted to account for the missing values. 
ATTENTION: function quite slow. It will be called directly by <code>var.acomp</code> 
and similar generic functions only if <code>na.action</code> is set to <code>na.pass</code>.
</p>


<h3>Note</h3>

<p>Do not use gsi.* functions directly since they are internal
functions of the package.</p>


<h3>Author(s)</h3>

<p>R. Tolosana-Delgado, K.Gerald v.d. Boogaart <a href="http://www.stat.boogaart.de">http://www.stat.boogaart.de</a></p>


<h3>References</h3>

<p>van den Boogaart, K. G., R. Tolosana-Delgado, and M. Bren (2006) Concepts 
for handling of zeros and missing values in compositional data, In: 
<em>2006 Annual Conference of the International Association for Mathematical 
Geology (IAMG)</em>, Universit\'e de Li\'ege, Belgium.
</p>
<p>Bren, M., R. Tolosana-Delgado, and K.G. van den Boogaart (2008) News
from compositions, the R package. In:  Daunis-i-Estadella, J. and
Mart\'in-Fern\'a ndez, J.A. (Eds.)
<em>Proceedings of the 3rd International Workshop on Compositional Data Analysis</em>,
Universitat de Girona, Spain. <a href="https://ima.udg.edu/Activitats/CoDaWork03/">https://ima.udg.edu/Activitats/CoDaWork03/</a><br></p>


<h3>Examples</h3>

<pre><code class="language-R"># generates a 3-part compositional data set with missings
A &lt;- matrix(c(0.5,0.3,0.1, 0.3,0.2,0, 0.1, 0, 0.75),nrow=3)
Mvar &lt;- 2*ilrvar2clr(A)
Mcenter &lt;- acomp(c(1,5,2,3))
x &lt;- rnorm.acomp(100,Mcenter,Mvar) 
colnames(x)&lt;-c("A","B","C","D")
# eliminate 20 values completely at random
 slost &lt;- sample(1:length(x), size=30)
 x[slost] &lt;- 0
# compute the variance with losts
#print(vr &lt;- gsi.varwithlosts(cdt(x)))
# compare with Mvar
</code></pre>


</div>