<div class="container">

<table style="width: 100%;"><tr>
<td>files2SpectraObject</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Import Data into a Spectra Object</h2>

<h3>Description</h3>

<p>These functions import data into a <code>Spectra</code> object.  For "csv-like" files they use
<code>read.table</code>, so they are very flexible in regard to file formatting.
<span class="pkg">Be sure to see the ... argument below for important details you need to provide.</span>
<code>files2SpectraObject</code> can also read JCAMP-DX files and will do so if <code>fileExt</code> is
any of <code>"dx"</code>, <code>"DX"</code>, <code>"jdx"</code> or <code>"JDX"</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">files2SpectraObject(
  gr.crit = NULL,
  gr.cols = "auto",
  freq.unit = "no frequency unit provided",
  int.unit = "no intensity unit provided",
  descrip = "no description provided",
  fileExt = "\\.(csv|CSV)$",
  out.file = "mydata",
  debug = FALSE,
  ...
)

matrix2SpectraObject(
  gr.crit = NULL,
  gr.cols = c("auto"),
  freq.unit = "no frequency unit provided",
  int.unit = "no intensity unit provided",
  descrip = "no description provided",
  in.file = NULL,
  out.file = "mydata",
  chk = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>gr.crit</code></td>
<td>
<p>Group Criteria.  A vector of character strings which will be
searched for among the file/sample names in order to assign an individual
spectrum to group membership. This is done using grep, so characters
like "." (period/dot) do not have their literal meaning (see below).
Warnings are issued if there are file/sample names that don't match entries in
<code>gr.crit</code> or there are entries in <code>gr.crit</code> that don't match any file names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gr.cols</code></td>
<td>
<p>Group Colors.  See <code>colorSymbol</code> for some options. One of the following:
</p>

<ul>
<li>
<p> Legacy behavior and the default: The word <code>"auto"</code>, in which case up to 8 colors will
be automatically assigned from package <code>RColorBrewer Set1</code>.
</p>
</li>
<li> <p><code>"Col7"</code>. A unique set of up to 7 colorblind-friendly colors is used.
</p>
</li>
<li> <p><code>"Col8"</code>. A unique set of up to 8 colors is used.
</p>
</li>
<li> <p><code>"Col12"</code>. A mostly paired set of up to 12 colors is used.
</p>
</li>
<li>
<p> A vector of acceptable color designations with the same length as <code>gr.crit</code>.
</p>
</li>
</ul>
<p>Colors will be assigned one for one, so the first element of
<code>gr.crit</code> is assigned the first element of <code>gr.col</code> and so forth.  For <code>Col12</code>
you should pay careful attention to the order of <code>gr.crit</code> in order to match up colors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freq.unit</code></td>
<td>
<p>A character string giving the units of the x-axis
(frequency or wavelength).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>int.unit</code></td>
<td>
<p>A character string giving the units of the y-axis (some sort
of intensity).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>descrip</code></td>
<td>
<p>A character string describing the data set that will be stored.  This string is used
in some plots so it is recommended that its length be less than about 40 characters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fileExt</code></td>
<td>
<p>A character string giving the extension of the files to be
processed. <code>regex</code> strings can be used.  For instance, the default
finds files with either <code>".csv"</code> or <code>".CSV"</code> as the extension.
Matching is done via a grep process, which is greedy.  See also the
"Advanced Tricks" section.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out.file</code></td>
<td>
<p>A file name.  The completed object of S3 class <code>Spectra</code> will be written
to this file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>debug</code></td>
<td>
<p>Logical. Applies to <code>files2SpectraObject</code> only.
Set to <code>TRUE</code> for troubleshooting when an error
is thrown during import.  In addition, values of 1-5 will work
when importing a JCAMP-DX file via <code>fileExt = "\.jdx"</code> etc.  These
will be passed through to the <code>readJDX</code> function.
See there for much more info on importing JCAMP-DX files.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments to be passed to <code>read.table</code>,
<code>list.files</code> or <code>readJDX</code>; see the "Advanced Tricks" section.
For <code>read.table</code>, <span class="pkg">You MUST supply values for <code>sep</code>, <code>dec</code> and <code>header</code> consistent
with your file structure, unless they are the same as the defaults for <code>read.table</code></span>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>in.file</code></td>
<td>
<p>Character.  Applies to <code>matrix2SpectraObject</code> only.
Input file name, including extension.  Can be a vector of file names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chk</code></td>
<td>
<p>Logical. Applies to <code>matrix2SpectraObject</code> only.
Should the <code>Spectra</code> object be checked for integrity?  If you are having trouble
importing your data, set this to <code>FALSE</code> and do <code>str(your object)</code> to troubleshoot.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A object of class <code>Spectra</code>.  An <em>unnamed</em> object
of S3 class <code>Spectra</code> is also written to <code>out.file</code>.  To
read it back into the workspace, use <code>new.name &lt;- loadObject(out.file)</code>
(<code>loadObject</code> is package <span class="pkg">R.utils</span>).
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>files2SpectraObject()</code>: Import data from separate csv files
</p>
</li>
<li> <p><code>matrix2SpectraObject()</code>: Import a matrix of data
</p>
</li>
</ul>
<h3>files2SpectraObject</h3>

<p><code>files2SpectraObject</code> acts on all files in the current working
directory with the specified <code>fileExt</code> so there should be no
extra files of that type hanging around (except see next paragraph).
The first column should contain the frequency values and the second column the intensity values. The
files may have a header or not (supply <code>header = TRUE/FALSE</code> as
necessary).  The frequency column is assumed to be the same in all files.
</p>
<p>If <code>fileExt</code> contains any of <code>"dx"</code>, <code>"DX"</code>, <code>"jdx"</code> or
<code>"JDX"</code>, then the files will be processed by <code>readJDX</code>.
Consider setting <code>debug = TRUE</code>, or <code>debug = 1</code> etc for this format, as there are many
options for JCAMP, and many are untested. See <code>readJDX</code> for options and
known limitations.
</p>


<h3>matrix2SpectraObject</h3>

<p>This function takes one or more csv-like files, containing frequencies in the first
column, and samples in additional columns, and processes it into a
<code>Spectra</code> object.  The file MUST have a header row which includes
the sample names.  There need not be a header for the first (frequency)
column.  If more than one file given, they must all have the same frequency entries.
</p>


<h3>gr.crit and Sample Name Gotchas</h3>

<p>The matching of <code>gr.crit</code> against the sample file names
(in <code>files2SpectraObject</code>) or column headers/sample names
(in <code>matrix2SpectraObject</code>) is done one at
a time, in order, using grep.  While powerful, this has the potential to lead
to some "gotchas" in certain cases, noted below.
</p>
<p>Your file system may allow file/sample names which <code>R</code> will not like, and will
cause confusing behavior.  File/sample names become variables in <code>ChemoSpec</code>, and <code>R</code>
does not like things like "-" (minus sign or hyphen) in file/sample names.  A hyphen
is converted to a period (".") if found, which is fine for a variable name.
However, a period in <code>gr.crit</code> is interpreted from the grep point of view,
namely a period matches any single character.  At this point, things may behave
very differently than one might hope.  See <code>make.names</code> for allowed
characters in <code>R</code> variables and make sure your file/sample names comply.
</p>
<p>The entries in <code>gr.crit</code> must be
mutually exclusive.  For example, if you have files with names like
"Control_1" and "Sample_1" and use <code>gr.crit = c("Control", "Sample")</code>
groups will be assigned as you would expect.  But, if you have file names
like "Control_1_Shade" and "Sample_1_Sun" you can't use <code>gr.crit =
c("Control",</code> <code>"Sample"</code>, <code>"Sun"</code>, <code>"Shade")</code> because each criteria is grepped in
order, and the "Sun/Shade" phrases, being last, will form the basis for your
groups.  Because this is a grep process, you can get around this by using
regular expressions in your <code>gr.crit</code> argument to specify the desired
groups in a mutually exclusive manner.  In this second example, you could
use <code>gr.crit = c("Control(.*)Sun"</code>, <code>"Control(.*)Shade"</code>, <code>"Sample(.*)Sun"</code>,
<code>"Sample(.*)Shade")</code> to have your groups assigned based upon both phrases in
the file names.
</p>
<p>To summarize, <code>gr.crit</code> is used as a grep pattern, and the file/sample names
are the target.  Make sure your file/sample names comply with <code>make.names</code>.
</p>
<p>Finally, samples whose names are not matched using <code>gr.crit</code> are still
incorporated into the <code>Spectra</code> object, but they are not
assigned a group or color. Therefore they don't plot, but they do take up space in a
plot!  A warning is issued in these cases, since one wouldn't normally want
a spectrum to be orphaned this way.
</p>
<p>All these problems can generally be identified by running <code>sumSpectra</code>
once the data is imported.
</p>


<h3>Advanced Tricks</h3>

<p>The ... argument can be used to pass any argument to <code>read.table</code> or <code>list.files</code>.
This includes the possibility of passing arguments that will cause trouble later, for instance
<code>na.strings</code> in <code>read.table</code>.  While one might successfully read in data with <code>NA</code>,
it will eventually cause problems.  The intent of this feature is to allow one to recurse
a directory tree containing the data, and/or to specify a starting point other than the current
working directory.  So for instance if the current working directory is not the directory containing
the data files, you can use <code>path = "my_path"</code> to point to the desired top-level
directory, and <code>recursive = TRUE</code> to work your way through a set of subdirectories.  In addition,
if you are reading in JCAMP-DX files, you can pass arguments to <code>readJDX</code> via ..., e.g. <code>SOFC = FALSE</code>.
Finally, while argument <code>fileExt</code> appears to be a file extension (from its
name and the description elsewhere), it's actually just a grep pattern that you can apply
to any part of the file name if you know how to construct the proper pattern.
</p>


<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University).
</p>


<h3>See Also</h3>

<p>Additional documentation at <a href="https://bryanhanson.github.io/ChemoSpec/">https://bryanhanson.github.io/ChemoSpec/</a>,
as well as <code>updateGroups</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# This example assumes the graphics output is set to ggplot2 (see ?GraphicsOptions).
library("ggplot2")

wd &lt;- getwd() # save current location
setwd(tempdir())

# Grab an included file &amp; move to a temporary directory
tf &lt;- system.file("extdata/PCRF.jdx", package = "ChemoSpec")
chk &lt;- file.copy(from = tf, to = basename(tf))

# Now read in the file, summarize and plot
spec &lt;- files2SpectraObject(
  gr.crit = "PCRF", freq.unit = "ppm", int.unit = "intensity",
  descrip = "test import", fileExt = "\\.jdx")
sumSpectra(spec)
p &lt;- plotSpectra(spec, lab.pos = 3.5, main = "Reduced Fat Potato Chip")
p &lt;- p + ggtitle("Reduced Fat Potato Chip")
p

setwd(wd) # restore working directory

## End(Not run)

</code></pre>


</div>