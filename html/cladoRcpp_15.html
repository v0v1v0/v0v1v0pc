<div class="container">

<table style="width: 100%;"><tr>
<td>rcpp_calc_splitlikes_using_COOweights_columnar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate the split likelihoods using <code>COO_weights_columnar</code>
</h2>

<h3>Description</h3>

<p>Calculates the split likelihoods using <code>COO_weights_columnar</code>, i.e. the weights as produced by
<code>rcpp_calc_anclikes_sp_COOweights_faster</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rcpp_calc_splitlikes_using_COOweights_columnar(Rcpp_leftprobs,
  Rcpp_rightprobs, COO_weights_columnar, Rsp_rowsums, printmat = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Rcpp_leftprobs</code></td>
<td>
<p>Probabilities of the states at the base of the left descendant branch</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rcpp_rightprobs</code></td>
<td>
<p>Probabilities of the states at the base of the right descendant branch</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>COO_weights_columnar</code></td>
<td>
<p>Transition probability matrix in COO-like format as 4 columns: 
ancestral index, left index, right index, conditional probability given ancestral states.
(assuming likelihood of descendants is 1). Indexes are 0-based.
Keep in mind that cladogenesis matrices exclude the null state
(a range of 0 areas), so if your states list starts with the 
null range (as is typical/default in DEC-style models)
then to get the R 1-based state indices requires e.g. 
COO_weights_columnar[[1]] + 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rsp_rowsums</code></td>
<td>
<p>A vector of size (numstates)  giving the sum of the relative probabilites of 
each combination of descendant states, assuming the probabilities of the left- and right-states are 
all equal (set to 1). This is thus the sum of the weights, and dividing by this normalization vector 
means that the each row of the speciation probability matrix will sum to 1.  Default assumes the 
weights sum to 1 but this is not usually the case. Rsp_rowsums need only be calculated once per 
tree+model combination, stored, and then re-used for each node in the tree, yielding significant 
time savings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>printmat</code></td>
<td>
<p>Should the probability matrix output be printed to screen? (useful for debugging, but 
can be dramatically slow in R.app for some reason for even moderate numbers of states; perhaps 
overrunning the line length...)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>splitlikes</code> Vector of the probabilities of each allowed split
</p>


<h3>Author(s)</h3>

<p>Nicholas Matzke <a href="mailto:matzke@berkeley.edu">matzke@berkeley.edu</a>
</p>


<h3>See Also</h3>

<p><code>rcpp_calc_anclikes_sp</code>
#bibliography /Dropbox/_njm/__packages/cladoRcpp_setup/cladoRcpp_refs.bib
@cite Matzke_2013
@cite Matzke_2014
</p>


<h3>Examples</h3>

<pre><code class="language-R"># For the basic logic of a probablistic cladogenesis model, see
?rcpp_calc_anclikes_sp

# For examples of running the functions, see the comparison of all functions at:
# ?cladoRcpp

</code></pre>


</div>