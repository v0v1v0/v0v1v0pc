<div class="container">

<table style="width: 100%;"><tr>
<td>qua.regressCOP2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Perform Quantile Regression using a Copula by Numerical Derivative Method for U with respect to V</h2>

<h3>Description</h3>

<p>Perform <em>quantile regression</em> (Nelsen, 2006, pp. 217â€“218) using a copula by numerical derivatives of the copula (<code>derCOPinv2</code>). If <code class="reqn">X</code> and <code class="reqn">Y</code> are random variables having quantile functions <code class="reqn">x(F)</code> and <code class="reqn">y(G)</code> and letting <code class="reqn">x=\tilde{x}(y)</code> denote a solution to <code class="reqn">\mathrm{Pr}[X \le x\mid Y = y] = F</code>, where <code class="reqn">F</code> is a nonexceedance probability. Then the curve <code class="reqn">x=\tilde{x}(y)</code> is the quantile regression curve of <code class="reqn">U</code> or <code class="reqn">X</code> with respect to  <code class="reqn">V</code> or <code class="reqn">Y</code>, respectively. If <code class="reqn">F=1/2</code>, then <em>median regression</em> is performed (<code>med.regressCOP2</code>). Using copulas, the quantile regression is expressed as
</p>
<p style="text-align: center;"><code class="reqn">\mathrm{Pr}[X \le x\mid Y = y] = \mathrm{Pr}[U \le F(x) \mid V = F] = \mathrm{Pr}[U \le u\mid V = F] = \frac{\delta \mathbf{C}(u,v)}{\delta v}\mbox{,}</code>
</p>

<p>where <code class="reqn">v = G(y)</code> and <code class="reqn">u = F(x)</code>. The general algorithm is
</p>

<ol>
<li>
<p> Set <code class="reqn">\delta \mathbf{C}(u,v)/\delta v = F</code>,
</p>
</li>
<li>
<p> Solve the regression curve <code class="reqn">u = \tilde{u}(v)</code> (provided by <code>derCOPinv2</code>), and
</p>
</li>
<li>
<p> Replace <code class="reqn">u</code> by <code class="reqn">x(u)</code> and <code class="reqn">v</code> by <code class="reqn">y(v)</code>.
</p>
</li>
</ol>
<p>The last step is optional as step two produces the regression in probability space, which might be desired, and step 3 actually transforms the probability regressions into the quantiles of the respective random variables.
</p>


<h3>Usage</h3>

<pre><code class="language-R">qua.regressCOP2(f=0.5, v=seq(0.01,0.99, by=0.01), cop=NULL, para=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>A single value of nonexceedance probability <code class="reqn">F</code> to perform regression at and defaults to median regression <code class="reqn">F=1/2</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>Nonexceedance probability <code class="reqn">v</code> in the <code class="reqn">Y</code> direction;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cop</code></td>
<td>
<p>A copula function;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>para</code></td>
<td>
<p>Vector of parameters or other data structure, if needed, to pass to the copula; and</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to pass.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> <code>data.frame</code> of the regressed probabilities of <code class="reqn">U</code> and <code class="reqn">V=v</code> is returned.
</p>


<h3>Author(s)</h3>

<p>W.H. Asquith</p>


<h3>References</h3>

<p>Nelsen, R.B., 2006, An introduction to copulas: New York, Springer, 269 p.
</p>


<h3>See Also</h3>

<p><code>med.regressCOP2</code>, <code>derCOPinv2</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Use a positively associated Plackett copula and perform quantile regression
theta &lt;- 0.10
R &lt;- qua.regressCOP2(cop=PLACKETTcop, para=theta) # 50th percentile regression
plot(R$U,R$V, type="l", lwd=6, xlim=c(0,1), ylim=c(0,1), col=8)
lines((1+(theta-1)*R$V)/(theta+1),R$V, col=4, lwd=1) # theoretical for Plackett,
# compare the theoretical form to that in qua.regressCOP---just switch terms around
# because of symmetry
R &lt;- qua.regressCOP2(f=0.90, cop=PLACKETTcop, para=theta) # 90th-percentile regression
lines(R$U,R$V, col=2, lwd=2)
R &lt;- qua.regressCOP2(f=0.10, cop=PLACKETTcop, para=theta) # 10th-percentile regression
lines(R$U,R$V, col=2, lty=2)
mtext("Quantile Regression U wrt V for Plackett copula")#
## End(Not run)
</code></pre>


</div>