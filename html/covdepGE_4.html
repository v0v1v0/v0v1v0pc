<div class="container">

<table style="width: 100%;"><tr>
<td>generateData</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate Covariate-Dependent Data</h2>

<h3>Description</h3>

<p>Generate a <code class="reqn">1</code>-dimensional extraneous covariate
and <code class="reqn">p</code>-dimensional Gaussian data with a precision matrix that varies as
a continuous function of the extraneous covariate. This data is distributed
similar to that used in the simulation study from (1)
</p>


<h3>Usage</h3>

<pre><code class="language-R">generateData(p = 5, n1 = 60, n2 = 60, n3 = 60, Z = NULL, true_precision = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>positive integer; number of variables in the data matrix. <code>5</code> by
default</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n1</code></td>
<td>
<p>positive integer; number of observations in the first interval.
<code>60</code> by default</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n2</code></td>
<td>
<p>positive integer; number of observations in the second interval.
<code>60</code> by default</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n3</code></td>
<td>
<p>positive integer; number of observations in the third interval.
<code>60</code> by default</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p><code>NULL</code> or numeric vector; extraneous covariate values for each
observation. If <code>NULL</code>, <code>Z</code> will be generated from a uniform distribution on
each of the intervals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>true_precision</code></td>
<td>
<p><code>NULL</code> OR list of matrices of dimension
<code class="reqn">p \times p</code>; true precision matrix for each observation. If
<code>NULL</code>, the true precision matrices will be generated dependent on <code>Z</code>.
<code>NULL</code> by default</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns list with the following values:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a <code>(n1 + n2 + n3)</code> <code class="reqn">\times p</code> numeric matrix, where
the <code class="reqn">i</code>-th row is drawn from a <code class="reqn">p</code>-dimensional Gaussian with mean
<code class="reqn">0</code> and precision matrix <code>true_precision[[i]]</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>a <code>(n1 + n2 + n3)</code> <code class="reqn">\times 1</code> numeric matrix, where
the <code class="reqn">i</code>-th entry is the extraneous covariate <code class="reqn">z_i</code> for
observation <code class="reqn">i</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>true_precision</code></td>
<td>
<p>list of <code>n1 + n2 + n3</code> matrices of dimension
<code class="reqn">p \times p</code>; the <code class="reqn">i</code>-th matrix is the precision matrix for
the <code class="reqn">i</code>-th observation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interval</code></td>
<td>
<p>vector of length <code>n1 + n2 + n3</code>; interval assignments
for each of the observations, where the <code class="reqn">i</code>-th entry is the interval
assignment for the <code class="reqn">i</code>-th observation</p>
</td>
</tr>
</table>
<h3>Extraneous Covariate</h3>

<p>If <code>Z = NULL</code>, then the generation of <code>Z</code> is as follows:
</p>
<p>The first <code>n1</code> observations have <code class="reqn">z_i</code> from from a uniform
distribution on the interval <code class="reqn">(-3, -1)</code> (the first interval).
</p>
<p>Observations <code>n1 + 1</code> to <code>n1 + n2</code> have <code class="reqn">z_i</code> from from a uniform
distribution on the interval <code class="reqn">(-1, 1)</code> (the second interval).
</p>
<p>Observations <code>n1 + n2 + 1</code> to <code>n1 + n2 + n3</code> have <code class="reqn">z_i</code> from a
uniform distribution on the interval <code class="reqn">(1, 3)</code> (the third interval).
</p>


<h3>Precision Matrices</h3>

<p>If <code>true_precision = NULL</code>, then the generation of the true precision
matrices is as follows:
</p>
<p>All precision matrices have <code class="reqn">2</code> on the diagonal and <code class="reqn">1</code> in the
<code class="reqn">(2, 3)/ (3, 2)</code> positions.
</p>
<p>Observations in the first interval have a <code class="reqn">1</code> in the
<code class="reqn">(1, 2) / (1, 2)</code> positions, while observations in the third interval
have a <code class="reqn">1</code> in the <code class="reqn">(1, 3)/ (3, 1)</code> positions.
</p>
<p>Observations in the second interval have <code class="reqn">2</code> entries that vary as a
linear function of their extraneous covariate. Let
<code class="reqn">\beta = 1/2</code>. Then, the <code class="reqn">(1, 2)/(2, 1)</code> positions for
the <code class="reqn">i</code>-th observation in the second interval are
<code class="reqn">\beta\cdot(1 - z_i)</code>, while the <code class="reqn">(1, 3)/ (3, 1)</code>
entries are <code class="reqn">\beta\cdot(1 + z_i)</code>.
</p>
<p>Thus, as <code class="reqn">z_i</code> approaches <code class="reqn">-1</code> from the right, the associated
precision matrix becomes more similar to the matrix for observations in the
first interval. Similarly, as <code class="reqn">z_i</code> approaches <code class="reqn">1</code> from the left,
the matrix becomes more similar to the matrix for observations in the third
interval.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library(ggplot2)

# get the data
set.seed(12)
data &lt;- generateData()
X &lt;- data$X
Z &lt;- data$Z
interval &lt;- data$interval
prec &lt;- data$true_precision

# get overall and within interval sample sizes
n &lt;- nrow(X)
n1 &lt;- sum(interval == 1)
n2 &lt;- sum(interval == 2)
n3 &lt;- sum(interval == 3)

# visualize the distribution of the extraneous covariate
ggplot(data.frame(Z = Z, interval = as.factor(interval))) +
  geom_histogram(aes(Z, fill = interval), color = "black", bins = n %/% 5)

# visualize the true precision matrices in each of the intervals

# interval 1
matViz(prec[[1]], incl_val = TRUE) +
  ggtitle(paste0("True precision matrix, interval 1, observations 1,...,", n1))

# interval 2 (varies continuously with Z)
cat("\nInterval 2, observations ", n1 + 1, ",...,", n1 + n2, sep = "")
int2_mats &lt;- prec[interval == 2]
int2_inds &lt;- c(5, n2 %/% 2, n2 - 5)
lapply(int2_inds, function(j) matViz(int2_mats[[j]], incl_val = TRUE) +
         ggtitle(paste("True precision matrix, interval 2, observation", j + n1)))

# interval 3
matViz(prec[[length(prec)]], incl_val = TRUE) +
  ggtitle(paste0("True precision matrix, interval 3, observations ",
                 n1 + n2 + 1, ",...,", n1 + n2 + n3))

# fit the model and visualize the estimated graphs
(out &lt;- covdepGE(X, Z))
plot(out)

# visualize the posterior inclusion probabilities for variables (1, 3) and (1, 2)
inclusionCurve(out, 1, 2)
inclusionCurve(out, 1, 3)

## End(Not run)
</code></pre>


</div>