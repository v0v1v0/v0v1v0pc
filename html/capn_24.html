<div class="container">

<table style="width: 100%;"><tr>
<td>vaprox</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculating V-approximation coefficients</h2>

<h3>Description</h3>

<p>The function provides the V-approximation coefficients of the defined Chebyshev polynomials in <code>aproxdef</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">vaprox(aproxspace, sdata)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>aproxspace</code></td>
<td>
<p>An approximation space defined by <code>aproxdef</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdata</code></td>
<td>
<p>A data.frame or matrix of [stock,sdot,benefit]=[<code class="reqn">\mathbf{S}</code>,<code class="reqn">\mathbf{\dot{S}}</code>,<code class="reqn">W</code>]</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The V-approximation is finding the shadow price of <code class="reqn">i</code>-th stock, <code class="reqn">p_{i}</code> for <code class="reqn">i=1,\cdots,d</code>
from the relation:<br><br><code class="reqn">\delta V = W(\mathbf{S}) + p_{1}\dot{s}_{1} + p_{2}\dot{s}_{2} + \cdots + p_{d}\dot{s}_{d}</code>,<br><br>
where <code class="reqn">\delta</code> is the given discount rate, <code class="reqn">V</code> is the intertemporal welfare function, <code class="reqn">\mathbf{S} = (s_{1}, s_{2}, \cdots, s_{d})</code> is a vector of stocks, <code class="reqn">W(\mathbf{S})</code> is the net benefits accruing to society,
and <code class="reqn">\dot{s}_{i}</code> is the growth of stock <code class="reqn">s_{i}</code>. By the definition of the shadow price, we know:<br><br><code class="reqn">p_{i} = \frac{\partial V}{\partial s_{i}}</code>.<br><br>
Consider approximation <code class="reqn">V(\mathbf{S}) = \mathbf{\mu}(\mathbf{S})\mathbf{\beta}</code>, <code class="reqn">\mathbf{\mu}(\mathbf{S})</code>
is Chebyshev polynomials and <code class="reqn">\mathbf{\beta}</code> is their coeffcients.
Then, <code class="reqn">p_{i} = \mathbf{\mu}_{s_{i}}(\mathbf{S})\mathbf{\beta}</code> by the orthogonality of Chebyshev basis.
Adopting the properties above, we can get the unknown coefficient vector <code class="reqn">\beta</code> from:<br><br><code class="reqn">\delta \mathbf{\mu}(\mathbf{S})\mathbf{\beta} = W(\mathbf{S}) + \displaystyle \sum_{i=1}^{d} diag (\dot{s}_{i}) \mathbf{\mu}_{s_{i}}(\mathbf{S})\mathbf{\beta}</code>, and thus,<br><br><code class="reqn">\beta = \left( \delta \mathbf{\mu}(\mathbf{S}) - \displaystyle \sum_{i=1}^{d} diag (\dot{s}_{i}) \mathbf{\mu}_{s_{i}}(\mathbf{S}) \right)^{-1} W(\mathbf{S}) </code>.<br><br>
In a case of over-determined (more nodes than approaximation degrees),<br><br><code class="reqn">\beta = \left( \left( \delta \mathbf{\mu}(\mathbf{S}) - \displaystyle diag (\dot{s}_{i}) \sum_{i=1}^{d} \mathbf{\mu}_{s_{i}}(\mathbf{S}) \right)^{T}
\left( \delta \mathbf{\mu}(\mathbf{S}) - \displaystyle \sum_{i=1}^{d} diag (\dot{s}_{i}) \mathbf{\mu}_{s_{i}}(\mathbf{S}) \right) \right)^{-1}</code> <br><code class="reqn">\times \left( \delta \mathbf{\mu}(\mathbf{S}) - \displaystyle \sum_{i=1}^{d} diag (\dot{s}_{i}) \mathbf{\mu}_{s_{i}}(\mathbf{S}) \right)^{T} W(\mathbf{S}) </code>.<br><br>
For more detils see Fenichel and Abbott (2014), Fenichel et al. (2016), and Yun et al. (2017).
</p>


<h3>Value</h3>

<p>A list of approximation resuts: deg, lb, ub, delta, and coefficients. Use <code>results$item</code> <br> (or <code>results[["item"]]</code>) to import each result item.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>degree</code></td>
<td>
<p>degree of Chebyshev polynomial</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lowerB</code></td>
<td>
<p>lower bound of Chebyshev nodes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upperB</code></td>
<td>
<p>upper bound of Chebyshev nodes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>discount rate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficient</code></td>
<td>
<p>Chebyshev polynomial coefficients</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Fenichel, Eli P. and Joshua K. Abbott. (2014) "<a href="http://www.journals.uchicago.edu/doi/abs/10.1086/676034">Natural Capital: From Metaphor to Measurement</a>."
<em>Journal of the Association of Environmental Economists</em>. 1(1/2):1-27.<br>
Fenichel, Eli P., Joshua K. Abbott, Jude Bayham, Whitney Boone, Erin M. K. Haacker, and Lisa Pfeiffer. (2016) "<a href="http://www.pnas.org/content/113/9/2382">Measuring the Value of Groundwater and Other Forms of Natural Capital</a>."
<em>Proceedings of the National Academy of Sciences</em>.113:2382-2387.<br>
Yun, Seong Do, Barbara Hutniczak, Joshua K. Abbott, and Eli P. Fenichel. (2017) "Ecosystem Based Management and the Welath of Ecosystems" <em>Proceedings of the National Academy of Sciences</em>. (forthcoming).
</p>


<h3>See Also</h3>

<p><code>aproxdef, vsim</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## 1-D Reef-fish example: see Fenichel and Abbott (2014)
data("GOM")
nodes &lt;- chebnodegen(param$nodes,param$lowerK,param$upperK)
simuDataV &lt;- cbind(nodes,sdot(nodes,param),profit(nodes,param))
Aspace &lt;- aproxdef(param$order,param$lowerK,param$upperK,param$delta)
vC &lt;- vaprox(Aspace,simuDataV)

## 2-D Prey-Predator example
data("lvdata")
aproxdeg &lt;- c(20,20)
lower &lt;- c(0.1,0.1)
upper &lt;- c(1.5,1.5)
delta &lt;- 0.03
lvspace &lt;- aproxdef(aproxdeg,lower,upper,delta)
vaproxc &lt;- vaprox(lvspace,lvaproxdata)
</code></pre>


</div>