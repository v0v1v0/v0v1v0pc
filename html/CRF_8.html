<div class="container">

<table style="width: 100%;"><tr>
<td>crf.update</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Update CRF potentials</h2>

<h3>Description</h3>

<p>Update node and edge potentials of CRF model
</p>


<h3>Usage</h3>

<pre><code class="language-R">crf.update(
  crf,
  node.fea = NULL,
  edge.fea = NULL,
  node.ext = NULL,
  edge.ext = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>crf</code></td>
<td>
<p>The CRF</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>node.fea</code></td>
<td>
<p>The node features matrix with dimension <code>(n.nf, n.nodes)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edge.fea</code></td>
<td>
<p>The edge features matrix with dimension <code>(n.ef, n.edges)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>node.ext</code></td>
<td>
<p>The extended information of node features</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edge.ext</code></td>
<td>
<p>The extended information of edge features</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function updates <code>node.pot</code> and <code>edge.pot</code> of CRF model by using 
the current values of parameters and features.
</p>
<p>There are two ways to model the relationship between parameters and features.
The first one exploits the special structure of features to reduce the memory
usage. However it may not suitable for all circumstances. The other one is more 
straighforward by explicitly specifying the coefficients of each parameter to
calculate the potentials, and may use much more memory. Two approaches can be
used together.
</p>
<p>The first way uses the objects <code>node.par</code> and <code>edge.par</code> to define
the structure of features and provides the feature information in variables
<code>node.fea</code> and <code>edge.fea</code>. The second way directly provides the
feature information in variables <code>node.ext</code> and <code>edge.ext</code> without
any prior assumption on feature structure. <code>node.ext</code> is a list and
each element has the same structure as <code>node.pot</code>. <code>edge.ext</code> is
a list and each element has the same structure as <code>edge.pot</code>.
</p>
<p>In detail, the node potential is updated as follows:
</p>
<p style="text-align: center;"><code class="reqn">
node.pot[n,i] = exp( \sum_{f} par[node.par[n,i,f]] * node.fea[f,n] + \sum_{k} par[k] * node.ext[[k]][n,i] )
</code>
</p>

<p>and the edge potential is updated as follows:
</p>
<p style="text-align: center;"><code class="reqn">
edge.pot[[e]][i,j] = exp( \sum_{f} par[edge.par[[e]][i,j,f]] * edge.fea[f,e] + \sum_{k} par[k] * edge.ext[[k]][[e]][i,j] )
</code>
</p>



<h3>Value</h3>

<p>This function will directly modify the CRF and return the same CRF.
</p>


<h3>See Also</h3>

<p><code>crf.nll</code>, <code>train.crf</code>
</p>


</div>