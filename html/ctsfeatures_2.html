<div class="container">

<table style="width: 100%;"><tr>
<td>calculate_features</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Computes several features associated with a categorical time series</h2>

<h3>Description</h3>

<p><code>calculate_features</code> computes several features associated with a
categorical time series or between a categorical and a real-valued time series
</p>


<h3>Usage</h3>

<pre><code class="language-R">calculate_features(series, n_series = NULL, lag = 1, type = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>series</code></td>
<td>
<p>An object of type <code>tsibble</code> (see R package <code>tsibble</code>), whose column named Value
contains the values of the corresponding CTS. This column must be of class <code>factor</code> and its levels
must be determined by the range of the CTS.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_series</code></td>
<td>
<p>A real-valued time series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lag</code></td>
<td>
<p>The considered lag (default is 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>String indicating the feature one wishes to compute.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Assume we have a CTS of length <code class="reqn">T</code> with range <code class="reqn">\mathcal{V}=\{1, 2, \ldots, r\}</code>,
<code class="reqn">\overline{X}_t=\{\overline{X}_1,\ldots, \overline{X}_T\}</code>, with <code class="reqn">\widehat{p}_i</code>
being the natural estimate of the marginal probability of the <code class="reqn">i</code>th
category, and <code class="reqn">\widehat{p}_{ij}(l)</code> being the natural estimate of the joint probability
for categories <code class="reqn">i</code> and <code class="reqn">j</code> at lag l, <code class="reqn">i,j=1, \ldots, r</code>. Assume also that
we have a real-valued time series of length <code class="reqn">T</code>, <code class="reqn">\overline{Z}_t=\{\overline{Z}_1,\ldots, \overline{Z}_T\}</code>.
The function computes the following quantities depending on the argument
<code>type</code>:
</p>

<ul>
<li>
<p>If <code>type=gini_index</code>, the function computes the
estimated gini index, <code class="reqn">\widehat{g}=\frac{r}{r-1}(1-\sum_{i=1}^{r}\widehat{p}_i^2)</code>.
</p>
</li>
<li>
<p>If <code>type=entropy</code>, the function computes the
estimated entropy, <code class="reqn">\widehat{e}=\frac{-1}{\ln(r)}\sum_{i=1}^{r}\widehat{p}_i\ln \widehat{p}_i</code>.
</p>
</li>
<li>
<p>If <code>type=chebycheff_dispersion</code>, the function computes the
estimated chebycheff dispersion, <code class="reqn">\widehat{c}=\frac{r}{r-1}(1-\max_i\widehat{p}_i)</code>.
</p>
</li>
<li>
<p>If <code>type=gk_tau</code>, the function computes the
estimated Goodman and Kruskal's tau, <code class="reqn">\widehat{\tau}(l)=\frac{\sum_{i,j=1}^{r}\frac{\widehat{p}_{ij}(l)^2}{\widehat{p}_j}-\sum_{i=1}^r\widehat{p}_i^2}{1-\sum_{i=1}^r\widehat{p}_i^2}</code>.
</p>
</li>
<li>
<p>If <code>type=gk_lambda</code>, the function computes the
estimated Goodman and Kruskal's lambda, <code class="reqn">\widehat{\lambda}(l)=\frac{\sum_{j=1}^{r}\max_i\widehat{p}_{ij}(l)-\max_i\widehat{p}_i}{1-\max_i\widehat{p}_i}</code>.
</p>
</li>
<li>
<p>If <code>type=uncertainty_coefficient</code>, the function computes the
estimated uncertainty coefficient, <code class="reqn">\widehat{u}(l)=-\frac{\sum_{i, j=1}^{r}\widehat{p}_{ij}(l)\ln\big(\frac{\widehat{p}_{ij}(l)}{\widehat{p}_i\widehat{p}_j}\big)}{\sum_{i=1}^{r}\widehat{p}_i\ln \widehat{p}_i}</code>.
</p>
</li>
<li>
<p>If <code>type=pearson_measure</code>, the function computes the
estimated Pearson measure, <code class="reqn">\widehat{X}_T^2(l)=T\sum_{i,j=1}^{r}\frac{(\widehat{p}_{ij}(l)-\widehat{p}_i\widehat{p}_j)^2}{\widehat{p}_i\widehat{p}_j}</code>.
</p>
</li>
<li>
<p>If <code>type=phi2_measure</code>, the function computes the
estimated Phi2 measure, <code class="reqn">\widehat{\Phi}^2(l)=\frac{\widehat{X}_T^2(l)}{T}</code>.
</p>
</li>
<li>
<p>If <code>type=sakoda_measure</code>, the function computes the
estimated Sakoda measure, <code class="reqn">\widehat{p}^*(l)=\sqrt{\frac{r\widehat{\Phi}^2(l)}{(r-1)(1+\widehat{\Phi}^2(l))}}</code>.
</p>
</li>
<li>
<p>If <code>type=cramers_vi</code>, the function computes the
estimated Cramer's vi, <code class="reqn">\widehat{v}(l)=\sqrt{\frac{1}{r-1}\sum_{i,j=1}^r\frac{(\widehat{p}_{ij}(l)-\widehat{p}_i\widehat{p}_j)^2}{\widehat{p}_i\widehat{p}_j}}</code>.
</p>
</li>
<li>
<p>If <code>type=cohens_kappa</code>, the function computes the
estimated Cohen's kappa, <code class="reqn">\widehat{\kappa}(l)=\frac{\sum_{j=1}^{r}(\widehat{p}_{jj}(l)-\widehat{p}_j^2)}{1-\sum_{i=1}^r\widehat{p}_i^2}</code>.
</p>
</li>
<li>
<p>If <code>type=total_correlation</code>, the function computes the
the estimated sum <code class="reqn">\widehat{\Psi}(l)=\frac{1}{r^2}\sum_{i,j=1}^{r}\widehat{\psi}_{ij}(l)^2</code>,
where <code class="reqn">\widehat{\psi}_{ij}(l)</code> is the estimated correlation
<code class="reqn">\widehat{Corr}(Y_{t, i}, Y_{t-l, j})</code>, <code class="reqn">i,j=1,\ldots,r</code>, being <code class="reqn">\overline{\boldsymbol Y}_t=\{\overline{\boldsymbol Y}_1, \ldots, \overline{\boldsymbol Y}_T\}</code>,
with <code class="reqn">\overline{\boldsymbol Y}_k=(\overline{Y}_{k,1}, \ldots, \overline{Y}_{k,r})^\top</code>, the
binarized time series of <code class="reqn">\overline{X}_t</code>.
</p>
</li>
<li>
<p>If <code>type=spectral_envelope</code>, the function computes the
estimated spectral envelope.
</p>
</li>
<li>
<p>If <code>type=total_mixed_correlation_1</code>, the function computes the
estimated total mixed l-correlation given by
</p>
<p style="text-align: center;"><code class="reqn">\widehat{\Psi}_1(l)=\frac{1}{r}\sum_{i=1}^{r}\widehat{\psi}_{i}(l)^2,</code>
</p>
<p> where
<code class="reqn">\widehat{\psi}_{i}(l)=\widehat{Corr}(Y_{t,i}, Z_{t-l})</code>, being <code class="reqn">\overline{\boldsymbol Y}_t=\{\overline{\boldsymbol Y}_1, \ldots, \overline{\boldsymbol Y}_T\}</code>,
with <code class="reqn">\overline{\boldsymbol Y}_k=(\overline{Y}_{k,1}, \ldots, \overline{Y}_{k,r})^\top</code>, the
binarized time series of <code class="reqn">\overline{X}_t</code>.
</p>
</li>
<li>
<p>If <code>type=total_mixed_correlation_2</code>, the function computes the
estimated total mixed q-correlation given by
</p>
<p style="text-align: center;"><code class="reqn">\widehat{\Psi}_2(l)=\frac{1}{r}\sum_{i=1}^{r}\int_{0}^{1}\widehat{\psi}^\rho_{i}(l)^2d\rho,</code>
</p>
<p> where
<code class="reqn">\widehat{\psi}_{i}^\rho(l)=\widehat{Corr}\big(Y_{t,i}, I(Z_{t-l}\leq q_{Z_t}(\rho)) \big)</code>, being <code class="reqn">\overline{\boldsymbol Y}_t=\{\overline{\boldsymbol Y}_1, \ldots, \overline{\boldsymbol Y}_T\}</code>,
with <code class="reqn">\overline{\boldsymbol Y}_k=(\overline{Y}_{k,1}, \ldots, \overline{Y}_{k,r})^\top</code>, the
binarized time series of <code class="reqn">\overline{X}_t</code>, <code class="reqn">\rho \in (0, 1)</code> a probability
level, <code class="reqn">I(\cdot)</code> the indicator function and <code class="reqn">q_{Z_t}</code> the quantile
function of the corresponding real-valued process.
</p>
</li>
</ul>
<h3>Value</h3>

<p>The corresponding feature.
</p>


<h3>Author(s)</h3>

<p>Ángel López-Oriona, José A. Vilar
</p>


<h3>References</h3>


<p>Weiß CH, Göb R (2008).
“Measuring serial dependence in categorical time series.”
<em>AStA Advances in Statistical Analysis</em>, <b>92</b>, 71–89.
</p>



<h3>Examples</h3>

<pre><code class="language-R">sequence_1 &lt;- GeneticSequences[which(GeneticSequences$Series==1),]
uc &lt;- calculate_features(series = sequence_1, type = 'uncertainty_coefficient' )
# Computing the uncertainty coefficient
# for the first series in dataset GeneticSequences
se &lt;- calculate_features(series = sequence_1, type = 'spectral_envelope' )
# Computing the spectral envelope
# for the first series in dataset GeneticSequences
</code></pre>


</div>