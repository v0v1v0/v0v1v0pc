<div class="container">

<table style="width: 100%;"><tr>
<td>hdi.ancestralCauchy</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Highest (Posterior) Density Interval</h2>

<h3>Description</h3>

<p>This function takes an object of class <code>ancestralCauchy</code>, result of function
<code>ancestral</code> or <code>increment</code>, and find the Highest (Posterior) Density Interval 
of reconstructed states for given nodes.
It relies on function <code>hdi</code> from package <code>HDInterval</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'ancestralCauchy'
hdi(object, credMass = 0.95, allowSplit = TRUE, node, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of class <code>ancestralCauchy</code>, result of function
<code>ancestral</code> or <code>increment</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>credMass</code></td>
<td>
<p>a scalar between 0 and 1 specifying the mass within the credible interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allowSplit</code></td>
<td>
<p>if FALSE and the proper HDI is discontinuous,
a single credible interval is returned, but this is not HDI.
See <code>hdi</code> for details. Default to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>node</code></td>
<td>
<p>the vector of nodes where to plot the ancestral reconstruction.
Can be missing, in which case all the nodes reconstructed in the <code>ancestralCauchy</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed to <code>plot</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function relies on the <code>density</code> method of the <code>hdi</code> function.
Package <code>HDInterval</code> must be loaded in the workspace for this
function to work.
See documentation of this functions for more details on the definition and
computation of the HDI.
</p>
<p>The density is obtained on the grid of values defined by the 
<code>ancestralCauchy</code> object, which defaults to 100 values.
See details in the documentation of the 
<code>ancestral</code> and <code>increment</code> functions.
</p>
<p>NOTE: if the grid of values is too coarse (if it has too few values),
then the result can be a poor approximation.
Please make sure to use an appropriate grid in the reconstruction to 
get meaningful results (see example).
</p>


<h3>Value</h3>

<p>A named list. Each item of the list is named after a node,
and contains the HDI interval of the node, in the same format
as in <code>hdi</code>: 
a vector of length 2 or a 2-row matrix with the lower and upper limits of the HDI, 
with an attribute <code>credMass</code>.
If <code>allowSplit=TRUE</code>, the matrix has a row for each component of a discontinuous HDI 
and columns for begin and end.
It has an additional attribute "height" giving the probability density at the limits of the HDI.
</p>


<h3>See Also</h3>

<p><code>plot.ancestralCauchy</code>, <code>ancestral</code>, <code>increment</code>, <code>fitCauchy</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Lizard dataset
data(lizards)
attach(lizards)
# Fit CP
fit_CP &lt;- fitCauchy(phy, svl, model = "cauchy", method = "reml")
# Reconstruct increments for some branches
inc &lt;- increment(fit_CP, node = c(142, 151), n_cores = 1)
# HDI
library(HDInterval)
inc_int &lt;- hdi(inc)
plot(inc, intervals = inc_int, type = "l")
# HDI of edge ending at node 142 is unimodal
inc_int[["142"]]
# HDI of edge ending at node 151 is bimodal
inc_int[["151"]]
# If the grid is coarse, the result is meaningless
inc &lt;- increment(fit_CP, node = c(151), n_cores = 1, n_values = 10)
inc_int &lt;- hdi(inc)
plot(inc, intervals = inc_int, type = "l")

</code></pre>


</div>