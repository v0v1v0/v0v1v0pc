<div class="container">

<table style="width: 100%;"><tr>
<td>R6_hype</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Hyperparameter optimization</h2>

<h3>Description</h3>

<p>Hyperparameter optimization
</p>
<p>Hyperparameter optimization
</p>


<h3>Public fields</h3>

<div class="r6-fields">

<dl>
<dt><code>X</code></dt>
<dd>
<p>Data frame of inputs that have been evaluated or will be evaluated
next.</p>
</dd>
<dt><code>Z</code></dt>
<dd>
<p>Output at X</p>
</dd>
<dt><code>runtime</code></dt>
<dd>
<p>The time it took to evaluate each row of X</p>
</dd>
<dt><code>parnames</code></dt>
<dd>
<p>Names of the parameters</p>
</dd>
<dt><code>parlowerraw</code></dt>
<dd>
<p>Lower bounds for each parameter on raw scale</p>
</dd>
<dt><code>parupperraw</code></dt>
<dd>
<p>Upper bounds for each parameter on raw scale</p>
</dd>
<dt><code>parlowertrans</code></dt>
<dd>
<p>Lower bounds for each parameter on transformed scale</p>
</dd>
<dt><code>paruppertrans</code></dt>
<dd>
<p>Upper bounds for each parameter on transformed scale</p>
</dd>
<dt><code>parlist</code></dt>
<dd>
<p>List of all parameters</p>
</dd>
<dt><code>modlist</code></dt>
<dd>
<p>A list with details about the model. The user shouldn't
ever edit this directly.</p>
</dd>
<dt><code>ffexp</code></dt>
<dd>
<p>An ffexp R6 object used to run the experiment and store
the results.</p>
</dd>
<dt><code>eval_func</code></dt>
<dd>
<p>The function we evaluate.</p>
</dd>
<dt><code>extract_output_func</code></dt>
<dd>
<p>A function that takes in the output from
'eval_func' and returns the value we are trying to minimize.</p>
</dd>
<dt><code>par_all_cts</code></dt>
<dd>
<p>Are all the parameters continuous?</p>
</dd>
<dt><code>verbose</code></dt>
<dd>
<p>How much should be printed? 0 is none, 1 is standard,
2 is more, 5+ is a lot</p>
</dd>
</dl>
</div>


<h3>Active bindings</h3>

<div class="r6-active-bindings">

<dl>
<dt><code>mod</code></dt>
<dd>
<p>Gaussian process model used to predict what the output will be.</p>
</dd>
</dl>
</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-hype-new"><code>R6_hype$new()</code></a>
</p>
</li>
<li> <p><a href="#method-hype-add_data"><code>R6_hype$add_data()</code></a>
</p>
</li>
<li> <p><a href="#method-hype-add_X"><code>R6_hype$add_X()</code></a>
</p>
</li>
<li> <p><a href="#method-hype-add_LHS"><code>R6_hype$add_LHS()</code></a>
</p>
</li>
<li> <p><a href="#method-hype-convert_trans_to_raw"><code>R6_hype$convert_trans_to_raw()</code></a>
</p>
</li>
<li> <p><a href="#method-hype-convert_raw_to_trans"><code>R6_hype$convert_raw_to_trans()</code></a>
</p>
</li>
<li> <p><a href="#method-hype-change_par_bounds"><code>R6_hype$change_par_bounds()</code></a>
</p>
</li>
<li> <p><a href="#method-hype-add_EI"><code>R6_hype$add_EI()</code></a>
</p>
</li>
<li> <p><a href="#method-hype-fit_mod"><code>R6_hype$fit_mod()</code></a>
</p>
</li>
<li> <p><a href="#method-hype-run_all"><code>R6_hype$run_all()</code></a>
</p>
</li>
<li> <p><a href="#method-hype-run_EI_for_time"><code>R6_hype$run_EI_for_time()</code></a>
</p>
</li>
<li> <p><a href="#method-hype-plot"><code>R6_hype$plot()</code></a>
</p>
</li>
<li> <p><a href="#method-hype-pairs"><code>R6_hype$pairs()</code></a>
</p>
</li>
<li> <p><a href="#method-hype-plotorder"><code>R6_hype$plotorder()</code></a>
</p>
</li>
<li> <p><a href="#method-hype-plotX"><code>R6_hype$plotX()</code></a>
</p>
</li>
<li> <p><a href="#method-hype-plotXorder"><code>R6_hype$plotXorder()</code></a>
</p>
</li>
<li> <p><a href="#method-hype-plotinteractions"><code>R6_hype$plotinteractions()</code></a>
</p>
</li>
<li> <p><a href="#method-hype-print"><code>R6_hype$print()</code></a>
</p>
</li>
<li> <p><a href="#method-hype-best_params"><code>R6_hype$best_params()</code></a>
</p>
</li>
<li> <p><a href="#method-hype-update_mod_userspeclist"><code>R6_hype$update_mod_userspeclist()</code></a>
</p>
</li>
<li> <p><a href="#method-hype-clone"><code>R6_hype$clone()</code></a>
</p>
</li>
</ul>
<hr>
<a id="method-hype-new"></a>



<h4>Method <code>new()</code>
</h4>

<p>Create hype R6 object.
</p>


<h5>Usage</h5>

<div class="r"><pre>R6_hype$new(
  eval_func,
  ...,
  X0 = NULL,
  Z0 = NULL,
  n_lhs,
  extract_output_func,
  verbose = 1,
  model = "GauPro",
  covtype = "matern5_2",
  nugget.estim = TRUE
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>eval_func</code></dt>
<dd>
<p>The function used to evaluate new points.</p>
</dd>
<dt><code>...</code></dt>
<dd>
<p>Hyperparameters to optimize over.</p>
</dd>
<dt><code>X0</code></dt>
<dd>
<p>Data frame of initial points to run, or points already
evaluated. If already evaluated, give in outputs in "Z0"</p>
</dd>
<dt><code>Z0</code></dt>
<dd>
<p>Evaluated outputs at "X0".</p>
</dd>
<dt><code>n_lhs</code></dt>
<dd>
<p>The number that should initially be run using
a maximin Latin hypercube.</p>
</dd>
<dt><code>extract_output_func</code></dt>
<dd>
<p>A function that takes in the output from
'eval_func' and returns the value we are trying to minimize.</p>
</dd>
<dt><code>verbose</code></dt>
<dd>
<p>How much should be printed? 0 is none, 1 is standard,
2 is more, 5+ is a lot</p>
</dd>
<dt><code>model</code></dt>
<dd>
<p>What package to fit the Gaussian process model with.
Either "GauPro" or "DiceKriging"/"DK".</p>
</dd>
<dt><code>covtype</code></dt>
<dd>
<p>Covariance/correlation/kernel function for the GP model.</p>
</dd>
<dt><code>nugget.estim</code></dt>
<dd>
<p>Should the nugget be estimated when fitting
the GP model?</p>
</dd>
</dl>
</div>


<hr>
<a id="method-hype-add_data"></a>



<h4>Method <code>add_data()</code>
</h4>

<p>Add data to the experiment results.
</p>


<h5>Usage</h5>

<div class="r"><pre>R6_hype$add_data(X, Z)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>X</code></dt>
<dd>
<p>Data frame with names matching the input parameters</p>
</dd>
<dt><code>Z</code></dt>
<dd>
<p>Output at rows of X matching the experiment output.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-hype-add_X"></a>



<h4>Method <code>add_X()</code>
</h4>

<p>Add new inputs to run. This allows the user to specify
what they want run next.
</p>


<h5>Usage</h5>

<div class="r"><pre>R6_hype$add_X(X)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>X</code></dt>
<dd>
<p>Data frame with names matching the input parameters.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-hype-add_LHS"></a>



<h4>Method <code>add_LHS()</code>
</h4>

<p>Add new input points using a maximin
Latin hypercube.
Latin hypercubes are usually more spacing than randomly picking points.
</p>


<h5>Usage</h5>

<div class="r"><pre>R6_hype$add_LHS(n, just_return_df = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>n</code></dt>
<dd>
<p>Number of points to add.</p>
</dd>
<dt><code>just_return_df</code></dt>
<dd>
<p>Instead of adding to experiment, should
it just return the new set of values?</p>
</dd>
</dl>
</div>


<hr>
<a id="method-hype-convert_trans_to_raw"></a>



<h4>Method <code>convert_trans_to_raw()</code>
</h4>

<p>Convert parameters from transformed scale to raw scale.
</p>


<h5>Usage</h5>

<div class="r"><pre>R6_hype$convert_trans_to_raw(Xtrans)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>Xtrans</code></dt>
<dd>
<p>Parameters on the transformed scale</p>
</dd>
</dl>
</div>


<hr>
<a id="method-hype-convert_raw_to_trans"></a>



<h4>Method <code>convert_raw_to_trans()</code>
</h4>

<p>Convert parameters from raw scale to transformed scale.
</p>


<h5>Usage</h5>

<div class="r"><pre>R6_hype$convert_raw_to_trans(Xraw)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>Xraw</code></dt>
<dd>
<p>Parameters on the raw scale</p>
</dd>
</dl>
</div>


<hr>
<a id="method-hype-change_par_bounds"></a>



<h4>Method <code>change_par_bounds()</code>
</h4>

<p>Change lower/upper bounds of a parameter
</p>


<h5>Usage</h5>

<div class="r"><pre>R6_hype$change_par_bounds(parname, lower, upper)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>parname</code></dt>
<dd>
<p>Name of the parameter</p>
</dd>
<dt><code>lower</code></dt>
<dd>
<p>New lower bound. Leave empty if not changing.</p>
</dd>
<dt><code>upper</code></dt>
<dd>
<p>New upper bound. Leave empty if not changing.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-hype-add_EI"></a>



<h4>Method <code>add_EI()</code>
</h4>

<p>Add new inputs to run using the expected information
criteria
</p>


<h5>Usage</h5>

<div class="r"><pre>R6_hype$add_EI(
  n,
  covtype = NULL,
  nugget.estim = NULL,
  model = NULL,
  eps,
  just_return = FALSE,
  calculate_at
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>n</code></dt>
<dd>
<p>Number of points to add.</p>
</dd>
<dt><code>covtype</code></dt>
<dd>
<p>Covariance function to use for the Gaussian process
model.</p>
</dd>
<dt><code>nugget.estim</code></dt>
<dd>
<p>Should a nugget be estimated?</p>
</dd>
<dt><code>model</code></dt>
<dd>
<p>Which package should be used to fit the model and
calculate the EI? Use "DK" for DiceKriging or "GauPro" for GauPro.</p>
</dd>
<dt><code>eps</code></dt>
<dd>
<p>Exploration parameter. The minimum amount of improvement
you care about.</p>
</dd>
<dt><code>just_return</code></dt>
<dd>
<p>Just return the EI info, don't actually add the
points to the design.</p>
</dd>
<dt><code>calculate_at</code></dt>
<dd>
<p>Calculate the EI at a specific point.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-hype-fit_mod"></a>



<h4>Method <code>fit_mod()</code>
</h4>

<p>Fit model to the data collected so far
</p>


<h5>Usage</h5>

<div class="r"><pre>R6_hype$fit_mod(covtype = NULL, nugget.estim = NULL, model = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>covtype</code></dt>
<dd>
<p>Covariance function to use for the Gaussian process
model.</p>
</dd>
<dt><code>nugget.estim</code></dt>
<dd>
<p>Should a nugget be estimated?</p>
</dd>
<dt><code>model</code></dt>
<dd>
<p>Which package should be used to fit the model and
calculate the EI? Use "DK" for DiceKriging or "GauPro" for GauPro.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-hype-run_all"></a>



<h4>Method <code>run_all()</code>
</h4>

<p>Run all unevaluated input points.
</p>


<h5>Usage</h5>

<div class="r"><pre>R6_hype$run_all(...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>...</code></dt>
<dd>
<p>Passed into ‘ffexp$run_all'. Can set ’parallel=TRUE'
to evaluate multiple points simultaneously as long as all needed
variables have been passed to 'varlist'</p>
</dd>
</dl>
</div>


<hr>
<a id="method-hype-run_EI_for_time"></a>



<h4>Method <code>run_EI_for_time()</code>
</h4>

<p>Add points using the expected information criteria,
evaluate them, and repeat until a specified amount of time has passed.
</p>


<h5>Usage</h5>

<div class="r"><pre>R6_hype$run_EI_for_time(
  sec,
  batch_size,
  covtype = "matern5_2",
  nugget.estim = TRUE,
  verbose = 0,
  model = "GauPro",
  eps = 0,
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>sec</code></dt>
<dd>
<p>Number of seconds to run for. It will go over this time
limit, finish the current iteration, then stop.</p>
</dd>
<dt><code>batch_size</code></dt>
<dd>
<p>Number of points to run at once.</p>
</dd>
<dt><code>covtype</code></dt>
<dd>
<p>Covariance function to use for the Gaussian process
model.</p>
</dd>
<dt><code>nugget.estim</code></dt>
<dd>
<p>Should a nugget be estimated?</p>
</dd>
<dt><code>verbose</code></dt>
<dd>
<p>Verbose parameter to pass to ffexp$</p>
</dd>
<dt><code>model</code></dt>
<dd>
<p>Which package should be used to fit the model and
calculate the EI? Use "DK" for DiceKriging or "GauPro" for GauPro.</p>
</dd>
<dt><code>eps</code></dt>
<dd>
<p>Exploration parameter. The minimum amount of improvement
you care about.</p>
</dd>
<dt><code>...</code></dt>
<dd>
<p>Passed into 'ffexp$run_all'.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-hype-plot"></a>



<h4>Method <code>plot()</code>
</h4>

<p>Make a plot to summarize the experiment.
</p>


<h5>Usage</h5>

<div class="r"><pre>R6_hype$plot()</pre></div>


<hr>
<a id="method-hype-pairs"></a>



<h4>Method <code>pairs()</code>
</h4>

<p>Plot pairs of inputs and output
</p>


<h5>Usage</h5>

<div class="r"><pre>R6_hype$pairs()</pre></div>


<hr>
<a id="method-hype-plotorder"></a>



<h4>Method <code>plotorder()</code>
</h4>

<p>Plot the output of the points evaluated in order.
</p>


<h5>Usage</h5>

<div class="r"><pre>R6_hype$plotorder()</pre></div>


<hr>
<a id="method-hype-plotX"></a>



<h4>Method <code>plotX()</code>
</h4>

<p>Plot the output as a function of each input.
</p>


<h5>Usage</h5>

<div class="r"><pre>R6_hype$plotX(
  addlines = TRUE,
  addEIlines = TRUE,
  covtype = NULL,
  nugget.estim = NULL,
  model = NULL
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>addlines</code></dt>
<dd>
<p>Should prediction mean and 95% interval be plotted?</p>
</dd>
<dt><code>addEIlines</code></dt>
<dd>
<p>Should expected improvement lines be plotted?</p>
</dd>
<dt><code>covtype</code></dt>
<dd>
<p>Covariance function to use for the Gaussian process
model.</p>
</dd>
<dt><code>nugget.estim</code></dt>
<dd>
<p>Should a nugget be estimated?</p>
</dd>
<dt><code>model</code></dt>
<dd>
<p>Which package should be used to fit the model and
calculate the EI? Use "DK" for DiceKriging or "GauPro" for GauPro.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-hype-plotXorder"></a>



<h4>Method <code>plotXorder()</code>
</h4>

<p>Plot each input in the order they were chosen.
Colored by quality.
</p>


<h5>Usage</h5>

<div class="r"><pre>R6_hype$plotXorder()</pre></div>


<hr>
<a id="method-hype-plotinteractions"></a>



<h4>Method <code>plotinteractions()</code>
</h4>

<p>Plot the 2D plots from inputs to the output.
All other variables are held at their values for the best input.
</p>


<h5>Usage</h5>

<div class="r"><pre>R6_hype$plotinteractions(covtype = "matern5_2", nugget.estim = TRUE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>covtype</code></dt>
<dd>
<p>Covariance function to use for the Gaussian process
model.</p>
</dd>
<dt><code>nugget.estim</code></dt>
<dd>
<p>Should a nugget be estimated?</p>
</dd>
</dl>
</div>


<hr>
<a id="method-hype-print"></a>



<h4>Method <code>print()</code>
</h4>

<p>Print details of the object.
</p>


<h5>Usage</h5>

<div class="r"><pre>R6_hype$print(...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>...</code></dt>
<dd>
<p>not used</p>
</dd>
</dl>
</div>


<hr>
<a id="method-hype-best_params"></a>



<h4>Method <code>best_params()</code>
</h4>

<p>Returns the best parameters
evaluated so far.
</p>


<h5>Usage</h5>

<div class="r"><pre>R6_hype$best_params()</pre></div>


<hr>
<a id="method-hype-update_mod_userspeclist"></a>



<h4>Method <code>update_mod_userspeclist()</code>
</h4>

<p>Updates the specifications for the GP model.
</p>


<h5>Usage</h5>

<div class="r"><pre>R6_hype$update_mod_userspeclist(
  model = NULL,
  covtype = NULL,
  nugget.estim = NULL
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>model</code></dt>
<dd>
<p>What package to fit the Gaussian process model with.
Either "GauPro" or "DiceKriging"/"DK".</p>
</dd>
<dt><code>covtype</code></dt>
<dd>
<p>Covariance/correlation/kernel function for the GP model.</p>
</dd>
<dt><code>nugget.estim</code></dt>
<dd>
<p>Should the nugget be estimated when fitting
the GP model?</p>
</dd>
</dl>
</div>


<hr>
<a id="method-hype-clone"></a>



<h4>Method <code>clone()</code>
</h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>R6_hype$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt>
<dd>
<p>Whether to make a deep clone.</p>
</dd>
</dl>
</div>




<h3>Examples</h3>

<pre><code class="language-R">
# Have df output, but only use one value from it
h1 &lt;- hype(
  eval_func = function(a, b) {data.frame(c=a^2+b^2, d=1:2)},
  extract_output_func = function(odf) {odf$c[1]},
  a = par_unif('a', -1, 2),
  b = par_unif('b', -10, 10),
  n_lhs = 10
)
h1$run_all()
h1$add_EI(n = 1)
h1$run_all()
#system.time(h1$run_EI_for_time(sec=3, batch_size = 1))
#system.time(h1$run_EI_for_time(sec=3, batch_size = 3))
h1$plotorder()
h1$plotX()
</code></pre>


</div>