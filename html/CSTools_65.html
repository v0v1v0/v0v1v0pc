<div class="container">

<table style="width: 100%;"><tr>
<td>RFSlope</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>RainFARM spectral slopes from an array (reduced version)</h2>

<h3>Description</h3>

<p>This function computes spatial spectral slopes from an array,
to be used for RainFARM stochastic precipitation downscaling method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">RFSlope(
  data,
  kmin = 1,
  time_dim = NULL,
  lon_dim = "lon",
  lat_dim = "lat",
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Array containing the spatial precipitation fields to downscale.
The input array is expected to have at least two dimensions named "lon" and 
"lat" by default (these default names can be changed with the <code>lon_dim</code> 
and <code>lat_dim</code> parameters) and one or more dimensions over which to 
average the slopes, which can be specified by parameter <code>time_dim</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kmin</code></td>
<td>
<p>First wavenumber for spectral slope (default <code>kmin=1</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time_dim</code></td>
<td>
<p>String or character array with name(s) of dimension(s)
(e.g. "ftime", "sdate", "member" ...) over which to compute spectral slopes.
If a character array of dimension names is provided, the spectral slopes
will be computed as an average over all elements belonging to those dimensions.
If omitted one of c("ftime", "sdate", "time")  is searched and the first one
with more than one element is chosen.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lon_dim</code></td>
<td>
<p>Name of lon dimension ("lon" by default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lat_dim</code></td>
<td>
<p>Name of lat dimension ("lat" by default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>is an integer that indicates the number of cores for parallel 
computations using multiApply function. The default value is one.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>RFSlope() returns spectral slopes using the RainFARM convention
(the logarithmic slope of k*|A(k)|^2 where A(k) are the spectral amplitudes).
The returned array has the same dimensions as the input array,
minus the dimensions specified by <code>lon_dim</code>, <code>lat_dim</code> and <code>time_dim</code>.
</p>


<h3>Author(s)</h3>

<p>Jost von Hardenberg - ISAC-CNR, <a href="mailto:j.vonhardenberg@isac.cnr.it">j.vonhardenberg@isac.cnr.it</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Example for the 'reduced' RFSlope function 
# Create a test array with dimension 8x8 and 20 timesteps, 
# 3 starting dates and 20 ensemble members.
pr &lt;- 1:(4*3*8*8*20)
dim(pr) &lt;- c(ensemble = 4, sdate = 3, lon = 8, lat = 8, ftime = 20)
# Compute the spectral slopes ignoring the wavenumber
# corresponding to the largest scale (the box)
slopes &lt;- RFSlope(pr, kmin = 2, time_dim = 'ftime')
</code></pre>


</div>