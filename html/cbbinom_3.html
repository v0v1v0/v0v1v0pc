<div class="container">

<table style="width: 100%;"><tr>
<td>cbbinom</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The Continuous Beta-Binomial Distribution</h2>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation for
a continuous analog to the beta-binomial distribution with parameters <code>size</code>
<code>alpha</code> and <code>beta</code>. The usage and help pages are modeled
on the d-p-q-r families of functions for the commonly-used distributions
in the <code>stats</code> package.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dcbbinom(
  x,
  size,
  alpha = 1,
  beta = 1,
  ncp = 0,
  log = FALSE,
  tol = 1e-06,
  max_iter = 10000L
)

pcbbinom(
  q,
  size,
  alpha = 1,
  beta = 1,
  ncp = 0,
  lower.tail = TRUE,
  log.p = FALSE,
  tol = 1e-06,
  max_iter = 10000L
)

qcbbinom(
  p,
  size,
  alpha = 1,
  beta = 1,
  ncp = 0,
  lower.tail = TRUE,
  log.p = FALSE,
  p_tol = 1e-06,
  p_max_iter = 10000L,
  root_tol = 1e-06,
  root_max_iter = 10000L
)

rcbbinom(
  n,
  size,
  alpha = 1,
  beta = 1,
  ncp = 0,
  p_tol = 1e-06,
  p_max_iter = 10000L,
  root_tol = 1e-06,
  root_max_iter = 10000L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, q</code></td>
<td>
<p>vector of quantiles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>number of trials (zero or more).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha, beta</code></td>
<td>
<p>non-negative parameters of the Beta distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncp</code></td>
<td>
<p>non-centrality parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log, log.p</code></td>
<td>
<p>logical; if TRUE, probabilities p are given as log(p).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol, max_iter</code></td>
<td>
<p>arguments passed on to <code>gen_hypergeo</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>
<p>logical; if TRUE (default), probabilities are
<code class="reqn">P[X \le x]</code>, otherwise, <code class="reqn">P[X &gt; x]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>vector of probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_tol, p_max_iter</code></td>
<td>
<p>same as <code>tol</code>, <code>max_iter</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>root_tol, root_max_iter</code></td>
<td>
<p>arguments passed on to <code>uniroot</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations. If <code>length(n) &gt; 1</code>, the length
is taken to be the number required.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Derived from the continuous binomial distribution (Ilienko 2013), the continuous beta-binomial
distribution is defined as:
</p>
<p style="text-align: center;"><code class="reqn">P(x|n,\alpha,\beta)=\int_0^1\frac{B_{1-p}(n+1-x,x)}{B(n+1-x,x)}\frac{p^{\alpha-1}(1-p)^{\beta-1}}{B(\alpha,\beta)}dp,</code>
</p>

<p>where <code class="reqn">x</code> is the quantile, <code class="reqn">n</code> is the size, <code class="reqn">B_p(a,b)=\int_0^p{u^{a-1}(1-u)^{b-1}du}</code>
is the incomplete beta function.
</p>
<p>When simplified, the distribution becomes:
</p>
<p style="text-align: center;"><code class="reqn">P(x|n,\alpha,\beta)=\frac{\Gamma(n+1)B(n+1-x+\beta,\alpha)}{\Gamma(x)\Gamma(n+2-x)B(\alpha,\beta)}{}_3F_2(a;b;z),</code>
</p>

<p>where <code class="reqn">{}_3F_2(a;b;z)</code> is generalized hypergeometric function, <code class="reqn">a=\{1-x,n+1-x,n+1-x+\beta\}</code>,
<code class="reqn">b=\{n+2-x,n+1-x+\alpha+\beta\}</code>, <code class="reqn">z=1</code>.
</p>
<p>Heuristically speaking, this distribution spreads the standard probability mass
at integer <code>x</code> to the interval <code>[x, x + 1]</code> in a continuous manner.
As a result, the distribution looks like a smoothed version of the standard,
discrete beta-binomial but shifted slightly to the right. The support of the continuous
beta-binomial is <code>[0, size + 1]</code>, and the mean is approximately
<code>size * alpha / (alpha + beta) + 1/2</code>.
</p>
<p>Supplying <code>ncp</code> moves the support of beta-binomial to <code>[ncp, size + 1 + ncp]</code>, e.g.
for the continuous beta-binomial with non-shifted mean, use <code>ncp = -0.5</code>.
</p>


<h3>Value</h3>

<p><code>dcbbinom</code> gives the density, <code>pcbbinom</code> the distribution function,
<code>qcbbinom</code> the quantile function, and <code>rcbbinom</code> generates random deviates.
</p>
<p>Invalid arguments will result in return value <code>NaN</code>, with a warning.
</p>
<p>The length of the result is determined by <code>n</code> for <code>rcbbinom</code>,
and is the maximum of the lengths of the numerical arguments for the other functions.
</p>
<p>The numerical arguments other than <code>n</code> are recycled to the length of the result.
Only the first elements of the logical arguments are used.
</p>


<h3>Numerical computation of the density function</h3>

<p>For simplicity, the density function is computed numerically through differentiation.
To achieve higher numerical resolution (given that <code class="reqn">d\ln{u}/du&gt;1,0&lt;u&lt;1</code>), it is computed as:
</p>
<p style="text-align: center;"><code class="reqn">p(x|n,\alpha,\beta)=\frac{\partial{P(x|n,\alpha,\beta)}}{\partial{x}}=\frac{\partial\exp[\ln{P(x|n,\alpha,\beta)}]}{\partial{x}}</code>
</p>

<p>When simplified, it becomes:
</p>
<p style="text-align: center;"><code class="reqn">p(x|n,\alpha,\beta)=\frac{\partial\exp[\ln{P(x|n,\alpha,\beta)}]}{\partial\ln{P(x|n,\alpha,\beta)}}\frac{\partial\ln{P(x|n,\alpha,\beta)}}{\partial{x}}=\frac{\partial\ln{P(x|n,\alpha,\beta)}}{\partial{x}}P(x|n,\alpha,\beta),</code>
</p>

<p>where the first term is computed numerically and the second term is the distribution function.
</p>


<h3>Note</h3>

<p>Change log:
</p>

<ul><li>
<p>0.1.0 Xiurui Zhu - Initiate the function.
</p>
</li></ul>
<h3>References</h3>

<p>Ilienko, Andreii (2013). Continuous counterparts of Poisson and binomial
distributions and their properties. Annales Univ. Sci. Budapest., Sect. Comp.
39: 137-147. <a href="http://ac.inf.elte.hu/Vol_039_2013/137_39.pdf">http://ac.inf.elte.hu/Vol_039_2013/137_39.pdf</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Density function
dcbbinom(x = 5, size = 10, alpha = 2, beta = 4)
# Distribution function
(test_val &lt;- pcbbinom(q = 5, size = 10, alpha = 2, beta = 4))
# Quantile function
qcbbinom(p = test_val, size = 10, alpha = 2, beta = 4)
# Random generation
set.seed(1111L)
rcbbinom(n = 10L, size = 10, alpha = 2, beta = 4)
</code></pre>


</div>