<div class="container">

<table style="width: 100%;"><tr>
<td>WS.Corr.Mixed.SAS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Estimate within-subject (test-retest) correlations based on a mixed-effects model using the SAS proc MIXED output.
</h2>

<h3>Description</h3>

<p>This function allows for the estimation of the within-subject correlations using a general and flexible modeling approach that allows at the same time to capture hierarchies in the data, the presence of covariates, and the derivation of correlation estimates. The output of proc MIXED (SAS) is used as the input for this function. Confidence intervals for the correlations based on the Delta method are provided.
</p>


<h3>Usage</h3>

<pre><code class="language-R">WS.Corr.Mixed.SAS(Model, D, Sigma2, Asycov, Rho, Tau2, Alpha=0.05, Time)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Model</code></td>
<td>
<p>The type of model that should be fitted. <code>Model=1</code>: random intercept model, <code>Model=2</code>: random intercept and serial correlation, and <code>Model=3</code>: random intercept,  slope, and serial correlation. Default <code>Model=1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>The <code class="reqn">D</code> matrix of the fitted model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma2</code></td>
<td>
<p>The residual variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Asycov</code></td>
<td>
<p>The asymptotic correlation matrix of covariance parameter estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rho</code></td>
<td>
<p>The <code class="reqn">\rho</code> component of the fitted model which determines the matrix <code class="reqn">H_{i}</code>, <code class="reqn">\rho(|t_{ij}-t_{ik}|)</code>. This component is only needed when serial correlation is involved, i.e., when Model <code class="reqn">2</code> or <code class="reqn">3</code> used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tau2</code></td>
<td>
<p>The <code class="reqn">\tau^2</code> component of the fitted model. This component is only needed when serial correlation is involved (i.e., when Model <code class="reqn">2</code> or <code class="reqn">3</code> used), <code class="reqn">\varepsilon_{2} \sim N(0, \tau^2 H_{i}))</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Alpha</code></td>
<td>
<p>The <code class="reqn">\alpha</code>-level to be used in the computation of the Confidence Intervals around the within-subject correlation. The Confidence Intervals are based on the Delta method. Default <code>Alpha=0.05</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Time</code></td>
<td>
<p>The time points available in the dataset on which the analysis was conducted.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Model</code></td>
<td>
<p>The type of model that was fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>The estimated within-subject correlations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Alpha</code></td>
<td>
<p>The <code class="reqn">\alpha</code>-level used to computed the Confidence Intervals around <code class="reqn">R</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI.Upper</code></td>
<td>
<p>The upper bounds of the confidence intervals (Delta-method based).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI.Lower</code></td>
<td>
<p>The lower bounds of the confidence intervals (Delta-method based).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Time</code></td>
<td>
<p>The time values in the dataset.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Wim Van der Elst, Geert Molenberghs, Ralf-Dieter Hilgers, &amp; Nicole Heussen
</p>


<h3>References</h3>

<p>Van der Elst, W., Molenberghs, G., Hilgers, R., &amp; Heussen, N. (2015). Estimating the reliability of repeatedly measured endpoints based on linear mixed-effects models. A tutorial. <em>Submitted.</em>
</p>


<h3>See Also</h3>

<p><code>WS.Corr.Mixed</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Open data 
data(Example.Data)

# Estimate R and Delta method-based CI 
# based on SAS output of fitted Model 2

# First specify asycov matrix
Asy_mat &lt;- matrix(c(129170, -10248, -12.0814, -74.8605,
                    -10248, 25894, 21.0976, -50.1059,
                    -12.0814, 21.0976, 0.07791, 1.2120,
                    -74.8605, -50.1059, 1.212, 370.65), nrow = 4)
Model2_SAS &lt;-  WS.Corr.Mixed.SAS(Model="Model 2", 
D=500.98, Tau2=892.97, Rho=3.6302, Sigma2=190.09, 
Asycov = Asy_mat, Time=c(1:45))                               
summary(Model2_SAS)
plot(Model2_SAS)
</code></pre>


</div>