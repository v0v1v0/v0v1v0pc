<div class="container">

<table style="width: 100%;"><tr>
<td>data_sim_copula</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate bivariate time-to-event times based on specific copula and marginal distributions</h2>

<h3>Description</h3>

<p>To generate a sample of subjects with two correlated event times based on specific copula and marginal models
</p>


<h3>Usage</h3>

<pre><code class="language-R">data_sim_copula(n, copula, eta, dist, baseline, var_list, COV_beta, x1, x2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>sample size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>copula</code></td>
<td>
<p>types of copula, including <code>"Clayton"</code>, <code>"Gumbel"</code>,
<code>"Frank"</code>, <code>"AMH"</code>, <code>"Joe"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta</code></td>
<td>
<p>copula parameter <code class="reqn">\eta</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>
<p>marginal distributions, including <code>"Weibull"</code>,
<code>"Gompertz"</code>, <code>"Loglogistic"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>baseline</code></td>
<td>
<p>marginal distribution parameters.
For <code>Weibull</code> and <code>Loglogistic</code>, it shall be <code class="reqn">\lambda</code> (scale) and <code class="reqn">k</code> (shape);
for <code>Gompertz</code>, it shall be <code class="reqn">a</code> (shape) and <code class="reqn">b</code> (rate)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var_list</code></td>
<td>
<p>a vector of covariate names;
assume the same covariates for two margins</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>COV_beta</code></td>
<td>
<p>a vector of regression coefficients corresponding to <code>var_list</code>;
assume the same coefficients between two margins</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x1</code></td>
<td>
<p>a data frame of covariates for margin 1; it shall have n rows,
with columns corresponding to the <code>var_list</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x2</code></td>
<td>
<p>a data frame of covariates for margin 2</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The parametric generator functions of copula functions are list below:
</p>
<p>The Clayton copula has a generator </p>
<p style="text-align: center;"><code class="reqn">\phi_{\eta}(t) = (1+t)^{-1/\eta},</code>
</p>

<p>with <code class="reqn">\eta &gt; 0</code> and Kendall's <code class="reqn">\tau = \eta/(2+\eta)</code>.
</p>
<p>The Gumbel copula has a generator </p>
<p style="text-align: center;"><code class="reqn">\phi_{\eta}(t) = \exp(-t^{1/\eta}),</code>
</p>

<p>with <code class="reqn">\eta \geq 1</code> and Kendall's <code class="reqn">\tau = 1 - 1/\eta</code>.
</p>
<p>The Frank copula has a generator </p>
<p style="text-align: center;"><code class="reqn">\phi_{\eta}(t) = -\eta^{-1}\log \{1+e^{-t}(e^{-\eta}-1)\},</code>
</p>

<p>with <code class="reqn">\eta \geq 0</code> and Kendall's <code class="reqn">\tau = 1+4\{D_1(\eta)-1\}/\eta</code>,
in which <code class="reqn">D_1(\eta) = \frac{1}{\eta} \int_{0}^{\eta} \frac{t}{e^t-1}dt</code>.
</p>
<p>The AMH copula has a generator </p>
<p style="text-align: center;"><code class="reqn">\phi_{\eta}(t) = (1-\eta)/(e^{t}-\eta),</code>
</p>

<p>with <code class="reqn">\eta \in [0,1)</code> and Kendall's <code class="reqn">\tau =  1-2\{(1-\eta)^2 \log (1-\eta) + \eta\}/(3\eta^2)</code>.
</p>
<p>The Joe copula has a generator </p>
<p style="text-align: center;"><code class="reqn">\phi_{\eta}(t) = 1-(1-e^{-t})^{1/\eta},</code>
</p>

<p>with <code class="reqn">\eta \geq 1</code> and Kendall's <code class="reqn">\tau = 1 - 4 \sum_{k=1}^{\infty} \frac{1}{k(\eta k+2)\{\eta(k-1)+2\}}</code>. <br></p>
<p>The marginal survival distributions are listed below:
</p>
<p>The Weibull (PH) survival distribution is </p>
<p style="text-align: center;"><code class="reqn">\exp \{-(t/\lambda)^k  e^{Z^{\top}\beta}\},</code>
</p>

<p>with <code class="reqn">\lambda &gt; 0</code> as scale and <code class="reqn">k &gt; 0</code> as shape.
</p>
<p>The Gompertz (PH) survival distribution is </p>
<p style="text-align: center;"><code class="reqn">\exp \{-\frac{b}{a}(e^{at}-1) e^{Z^{\top}\beta}\},</code>
</p>

<p>with <code class="reqn">a &gt; 0</code> as shape and <code class="reqn">b &gt; 0</code> as rate
</p>
<p>The Loglogistic (PO) survival distribution is </p>
<p style="text-align: center;"><code class="reqn">\{1+(t/\lambda)^{k} e^{Z^{\top}\beta} \}^{-1},</code>
</p>

<p>with <code class="reqn">\lambda &gt; 0</code> as scale and <code class="reqn">k &gt; 0</code> as shape.
</p>


<h3>Value</h3>

<p>a data frame of bivariate time-to-event data with covariates
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(CopulaCenR)
set.seed(1)
dat &lt;- data_sim_copula(n = 500, copula = "Clayton", eta = 3,
                       dist = "Weibull", baseline = c(0.1,2),
                       var_list = c("var1", "var2"),
                       COV_beta = c(0.1, 0.1),
                       x1 = cbind(rnorm(500, 6, 2),
                                  rbinom(500, 1, 0.5)),
                       x2 =  cbind(rnorm(500, 6, 2),
                                   rbinom(500, 1, 0.5)))
plot(x = dat$time[dat$ind == 1], y = dat$time[dat$ind == 2],
     xlab = expression(t[1]), ylab = expression(t[2]),
     cex.axis = 1, cex.lab = 1.3)
</code></pre>


</div>