<div class="container">

<table style="width: 100%;"><tr>
<td>BEI_EMWeighting</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Computing the weighted ensemble means for SFSs.</h2>

<h3>Description</h3>

<p>This function implements the computation to obtain the weighted
ensemble means for SFSs using a normalized weights array,
</p>


<h3>Usage</h3>

<pre><code class="language-R">BEI_EMWeighting(var_exp, aweights, time_dim_name = "time", memb_dim = "member")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>var_exp</code></td>
<td>
<p>Variable (e.g. precipitation, temperature, NAO index)
array from a SFS with at least dimensions (time, member) for a spatially 
aggregated variable or dimensions (time, member, lat, lon) for a spatial 
variable, as 'time' the spatial dimension by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aweights</code></td>
<td>
<p>Normalized weights array with at least dimensions 
(time, member), when 'time' is the temporal dimension as default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time_dim_name</code></td>
<td>
<p>A character string indicating the name of the 
temporal dimension, by default 'time'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>memb_dim</code></td>
<td>
<p>A character string indicating the name of the 
member dimension, by default 'member'.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>BEI_EMWeighting() returns an array with at least one or three 
dimensions depending if the variable is spatially aggregated variable 
(as e.g. NAO index)(time) or it is spatial variable (as e.g. precipitation 
or temperature) (time, lat, lon), containing the ensemble means computing
with weighted members.
</p>


<h3>Author(s)</h3>

<p>Eroteida Sanchez-Garcia - AEMET, <a href="mailto:esanchezg@aemet.es">esanchezg@aemet.es</a>
</p>


<h3>References</h3>

<p>Regionally improved seasonal forecast of precipitation through Best
estimation of winter NAO, Sanchez-Garcia, E. et al.,
Adv. Sci. Res., 16, 165174, 2019, doi: <a href="https://doi.org/10.5194/asr-16-165-2019">10.5194/asr-16-165-2019</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Example 1 
var_exp &lt;- 1 : (2 * 3 * 4)
dim(var_exp) &lt;- c(time = 2, dataset = 3, member = 4)
aweights &lt;- runif(24, min = 0.001, max = 0.999)
dim(aweights) &lt;- c(time = 2, dataset = 3, member = 4)
res &lt;- BEI_EMWeighting(var_exp, aweights)

# Example 2 
var_exp &lt;- 1 : (2 * 4 * 2 * 3)
dim(var_exp) &lt;- c(time = 2, member = 4, lat = 2, lon = 3)
aweights &lt;- c(0.2, 0.1, 0.3, 0.4, 0.1, 0.2, 0.4, 0.3)
dim(aweights) &lt;- c(time = 2, member = 4)
res &lt;- BEI_EMWeighting(var_exp, aweights)

</code></pre>


</div>