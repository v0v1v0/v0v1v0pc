<div class="container">

<table style="width: 100%;"><tr>
<td>qua.regressCOP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Perform Quantile Regression using a Copula by Numerical Derivative Method for V with respect to U</h2>

<h3>Description</h3>

<p>Perform <em>quantile regression</em> (Nelsen, 2006, pp. 217â€“218) using a copula by numerical derivatives of the copula (<code>derCOPinv</code>). If <code class="reqn">X</code> and <code class="reqn">Y</code> are random variables having quantile functions <code class="reqn">x(F)</code> and <code class="reqn">y(G)</code> and letting <code class="reqn">y=\tilde{y}(x)</code> denote a solution to <code class="reqn">\mathrm{Pr}[Y \le y\mid X = x] = F</code>, where <code class="reqn">F</code> is a nonexceedance probability. Then the curve <code class="reqn">y=\tilde{y}(x)</code> is the quantile regression curve of <code class="reqn">V</code> or <code class="reqn">Y</code> with respect to <code class="reqn">U</code> or <code class="reqn">X</code>, respectively. If <code class="reqn">F=1/2</code>, then <em>median regression</em> is performed (<code>med.regressCOP</code>). Using copulas, the quantile regression is expressed as
</p>
<p style="text-align: center;"><code class="reqn">\mathrm{Pr}[Y \le y\mid X = x] = \mathrm{Pr}[V \le G(y) \mid U = F(x)] = \mathrm{Pr}[V \le v\mid U = v] = \frac{\delta \mathbf{C}(u,v)}{\delta u}\mbox{,}</code>
</p>

<p>where <code class="reqn">v = G(y)</code> and <code class="reqn">u = F(x)</code>. The general algorithm is
</p>

<ol>
<li>
<p> Set <code class="reqn">\delta \mathbf{C}(u,v)/\delta u = F</code>,
</p>
</li>
<li>
<p> Solve the regression curve <code class="reqn">v = \tilde{v}(u)</code> (provided by <code>derCOPinv</code>), and
</p>
</li>
<li>
<p> Replace <code class="reqn">u</code> by <code class="reqn">x(u)</code> and <code class="reqn">v</code> by <code class="reqn">y(v)</code>.
</p>
</li>
</ol>
<p>The last step is optional as step two produces the regression in probability space, which might be desired, and step 3 actually transforms the probability regressions into the quantiles of the respective random variables.
</p>


<h3>Usage</h3>

<pre><code class="language-R">qua.regressCOP(f=0.5, u=seq(0.01,0.99, by=0.01), cop=NULL, para=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>A single value of nonexceedance probability <code class="reqn">F</code> to perform regression at and defaults to median regression <code class="reqn">F=1/2</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>Nonexceedance probability <code class="reqn">u</code> in the <code class="reqn">X</code> direction;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cop</code></td>
<td>
<p>A copula function;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>para</code></td>
<td>
<p>Vector of parameters or other data structure, if needed, to pass to the copula; and</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to pass.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> <code>data.frame</code> of the regressed probabilities of <code class="reqn">V</code> and provided <code class="reqn">U=u</code> values is returned.
</p>


<h3>Author(s)</h3>

<p>W.H. Asquith</p>


<h3>References</h3>

<p>Nelsen, R.B., 2006, An introduction to copulas: New York, Springer, 269 p.
</p>


<h3>See Also</h3>

<p><code>med.regressCOP</code>, <code>derCOPinv</code>, <code>qua.regressCOP.draw</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Use a positively associated Plackett copula and perform quantile regression
theta &lt;- 10
R &lt;- qua.regressCOP(cop=PLACKETTcop, para=theta) # 50th percentile regression

plot(R$U,R$V, type="l", lwd=6, xlim=c(0,1), ylim=c(0,1), col=8)
lines(R$U,(1+(theta-1)*R$U)/(theta+1), col=4, lwd=1) # theoretical for Plackett, see
#                                                             (Nelsen, 2006, p. 218)
R &lt;- qua.regressCOP(f=0.90, cop=PLACKETTcop, para=theta) # 90th-percentile regression
lines(R$U,R$V, col=2, lwd=2)
R &lt;- qua.regressCOP(f=0.10, cop=PLACKETTcop, para=theta) # 10th-percentile regression
lines(R$U,R$V, col=3, lty=2)
mtext("Quantile Regression V wrt U for Plackett copula")#
## End(Not run)

## Not run: 
# Use a composite copula with two Placketts with compositing parameters alpha and beta.
para &lt;- list(cop1=PLACKETTcop, cop2=PLACKETTcop,
             para1=0.04, para2=5, alpha=0.9, beta=0.6)
plot(c(0,1),c(0,1), type="n", lwd=3,
     xlab="U, NONEXCEEDANCE PROBABILITY", ylab="V, NONEXCEEDANCE PROBABILITY")
# Draw the regression of V on U and then U on V (wrtV=TRUE)
qua.regressCOP.draw(cop=composite2COP, para=para, ploton=FALSE)
qua.regressCOP.draw(cop=composite2COP, para=para, wrtV=TRUE, lty=2, ploton=FALSE)
mtext("Composition of Two Plackett Copulas and Quantile Regression")#
## End(Not run)

## Not run: 
# Use a composite copula with two Placketts with compositing parameters alpha and beta.
para &lt;- list(cop1=PLACKETTcop,  cop2=PLACKETTcop,
             para1=0.34, para2=50, alpha=0.63, beta=0.47)
D &lt;- simCOP(n=3000, cop=composite2COP, para=para, cex=0.5)
qua.regressCOP.draw(cop=composite2COP, para=para, ploton=FALSE)
qua.regressCOP.draw(cop=composite2COP, para=para, wrtV=TRUE, lty=2, ploton=FALSE)
level.curvesCOP(cop=composite2COP, para=para, ploton=FALSE)
mtext("Composition of Two Plackett Copulas, Level Curves, Quantile Regression")

para &lt;- list(cop1=PLACKETTcop,  cop2=PLACKETTcop, # Note the singularity
             para1=0, para2=500, alpha=0.63, beta=0.47)
D &lt;- simCOP(n=3000, cop=composite2COP, para=para, cex=0.5)
qua.regressCOP.draw(cop=composite2COP, para=para, ploton=FALSE)
qua.regressCOP.draw(cop=composite2COP, para=para, wrtV=TRUE, lty=2, ploton=FALSE)
level.curvesCOP(cop=composite2COP, para=para, ploton=FALSE)
mtext("Composition of Two Plackett Copulas, Level Curves, Quantile Regression")

pdf("quantile_regression_test.pdf")
for(i in 1:10) {
  para &lt;- list(cop1=PLACKETTcop, cop2=PLACKETTcop, alpha=runif(1), beta=runif(1),
               para1=10^runif(1,min=-4,max=0), para2=10^runif(1,min=0,max=4))
  txts &lt;- c("Alpha=",    round(para$alpha,    digits=4),
            "; Beta=",   round(para$beta,     digits=4),
            "; Theta1=", round(para$para1[1], digits=5),
            "; Theta2=", round(para$para2[1], digits=2))

  D &lt;- simCOP(n=3000, cop=composite2COP, para=para, cex=0.5, col=3)
  mtext(paste(txts, collapse=""))
  qua.regressCOP.draw(f=c(seq(0.05, 0.95, by=0.05)),
                      cop=composite2COP, para=para, ploton=FALSE)
  qua.regressCOP.draw(f=c(seq(0.05, 0.95, by=0.05)),
                      cop=composite2COP, para=para, wrtV=TRUE, ploton=FALSE)
  level.curvesCOP(cop=composite2COP, para=para, ploton=FALSE)
}
dev.off() # done
## End(Not run)
</code></pre>


</div>