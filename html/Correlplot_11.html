<div class="container">

<table style="width: 100%;"><tr>
<td>FitRDeltaQSym</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Approximation of a correlation matrix with column adjustment and symmetric low rank factorization</h2>

<h3>Description</h3>

<p>Program <code>FitRDeltaQSym</code> calculates a low rank factorization for a correlation matrix. It adjusts for column effects, and the approximation is therefore asymmetric.  
</p>


<h3>Usage</h3>

<pre><code class="language-R">FitRDeltaQSym(R, W = NULL, nd = 2, eps = 1e-10, delta = 0, q = colMeans(R),
              itmax.inner = 1000, itmax.outer = 1000, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>A correlation matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p>A weight matrix (optional)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nd</code></td>
<td>
<p>The rank of the low rank approximation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>The convergence criterion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>Initial value for the scalar adjustment (zero by default)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>Initial values for the column adjustments (random by default)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>itmax.inner</code></td>
<td>
<p>Maximum number of iterations for the inner loop of the algorithm</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>itmax.outer</code></td>
<td>
<p>Maximum number of iterations for the outer loop of the algorithm</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Print information or not</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Program <code>FitRDeltaQSym</code> implements an iterative algorithm for the low rank factorization of the correlation matrix. It decomposes the correlation matrix as R = delta J + 1 q' + G G' + E. The approximation of R is ultimately asymmetric, but the low rank factorization used for biplotting (G G') is symmetric. 
</p>


<h3>Value</h3>

<p>A list object with fields:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>The final scalar adjustment</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rhat</code></td>
<td>
<p>The final approximation to the correlation matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>The matrix of biplot vectors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rmse</code></td>
<td>
<p>The root mean squared error</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>The final column adjustments</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Jan Graffelman (jan.graffelman@upc.edu) </p>


<h3>References</h3>

<p>Graffelman, J. and De Leeuw, J. (2023) Improved approximation and visualization of the correlation matrix. The American Statistician pp. 1â€“20. Available online as latest article  <a href="https://doi.org/10.1080/00031305.2023.2186952">doi:10.1080/00031305.2023.2186952</a>
</p>


<h3>See Also</h3>

<p><code>wAddPCA,ipSymLS,Keller</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(HeartAttack)
X &lt;- HeartAttack[,1:7]
X[,7] &lt;- log(X[,7])
colnames(X)[7] &lt;- "logPR"
R &lt;- cor(X)
W &lt;- matrix(1, 7, 7)
diag(W) &lt;- 0
out.sym &lt;- FitRDeltaQSym(R, W, eps=1e-6) 
Rhat &lt;- out.sym$Rhat
</code></pre>


</div>