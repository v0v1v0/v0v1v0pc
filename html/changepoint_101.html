<div class="container">

<table style="width: 100%;"><tr>
<td>decision</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Decision Function - Only intended for developer use.
</h2>

<h3>Description</h3>

<p>Uses the function parameters to decide if a proposed changepoint is a true changepoint or due to random variability.  Test is conducted using the user specified penalty.
</p>
<p>This function is called by <code>cpt.mean</code>, <code>cpt.var</code> and <code>cpt.meanvar</code> when <code>method="AMOC"</code>.  This is not intended for use by regular users of the package.  It is exported for developers to call directly for speed increases or to fit alternative cost functions.
</p>
<p>WARNING: No checks on arguments are performed!
</p>


<h3>Usage</h3>

<pre><code class="language-R">decision(tau,null,alt=NA,penalty="MBIC",n=0,diffparam=1,pen.value=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>

<p>A numeric value or vector specifying the proposed changepoint location(s).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null</code></td>
<td>

<p>The value of the null test statistic.  If tau is a vector, so is null.  If the test statistic is already known (i.e. doesn't have null and alternative components), replace the null argument with the test statistic.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alt</code></td>
<td>

<p>The value of the alternative test statistic (at tau).  If tau is a vector, so is alt.  If the test statistic is already known, then it is used in replacement of the null argument and the alternative should not be specified (default NA to account for this)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty</code></td>
<td>

<p>Choice of "None", "SIC", "BIC", "MBIC", AIC", "Hannan-Quinn", "Asymptotic" and "Manual" penalties.  If Manual is specified, the manual penalty is contained in the pen.value parameter. If Asymptotic is specified, the theoretical type I error is contained in the pen.value parameter. The predefined penalties listed DO count the changepoint as a parameter, postfix a 0 e.g."SIC0" to NOT count the changepoint as a parameter.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>The length of the original data, required to give sensible "no changepoint" output.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diffparam</code></td>
<td>

<p>The difference in the number of parameters in the null and alternative hypotheses, required for the SIC, BIC, AIC, Hanna-Quinn and possibly Manual penalties.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pen.value</code></td>
<td>

<p>The theoretical type I error e.g.0.05 when using the Asymptotic penalty.  The value of the penalty when using the Manual penalty option - this can be a numeric value or text giving the formula to use.  Available variables are, n=length of original data, null=null likelihood, alt=alternative likelihood, tau=proposed changepoint, diffparam=difference in number of alternatve and null parameters.  
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is used to test whether tau is a true changepoint or not.  This test uses the null-alternative as the test statistic and performs the test where the null hypothesis is no change point and the alternative hypothesis is a single changepoint at tau.  The test is (null-alt)&gt;=penalty, if TRUE then the changepoint is deemed a true changepoint, if FALSE then n (length of data) is returned.
</p>
<p>If the test statistic is already known then it replaces the null value and the alternative is not required (default NA).  In this case the test is null&gt;=penalty, if TRUE then the changepoint is deemed a true changepoint, if FALSE then n (length of data) is returned.
</p>
<p>This function is exported for developer use only.  It does not perform any checks on inputs and is included for convenience and speed for those who are developing their own cost functions.
</p>


<h3>Value</h3>

<p>A list is returned with two elements, cpt and pen.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>cpt</code></td>
<td>
<p> If tau is a single value then a single value is returned: Either the value of the true changepoint location or n (length of data) if no changepoint is found.
</p>
<p>If tau is a vector of length m then a vector of length m is returned:Each element is either the value of the true changepoint location or n (length of data) if no changepoint is found.  The first element is for the first value of tau and the final element is for the final value of tau.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pen</code></td>
<td>
<p>The numeric value of the penalty used for the test(s).</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Rebecca Killick
</p>


<h3>References</h3>

<p>SIC/BIC: Schwarz, G. (1978) Estimating the Dimension of a Model, <em>The Annals of Statistics</em> <b>6(2)</b>, 461–464
</p>
<p>MBIC: Zhang, N. R. and Siegmund, D. O. (2007) A Modified Bayes Information Criterion with Applications to the Analysis of Comparative Genomic Hybridization Data. <em>Biometrics</em> <b>63</b>, 22-32.
</p>
<p>AIC: Akaike, H. (1974) A new look at the statistical model identification, <em>Automatic Control, IEEE Transactions on</em> <b>19(6)</b>, 716–723
</p>
<p>Hannan-Quinn: Hannan, E. J. and B. G. Quinn (1979) The Determination of the Order of an Autoregression, <em>Journal of the Royal Statistical Society, B</em> <b>41</b>, 190–195
</p>


<h3>See Also</h3>

<p><code>cpt.mean</code>,<code>cpt.var</code>,<code>cpt.meanvar</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Example of finding a change
out=c(100,765.1905,435.6529) # tau, null, alt
decision(out[1],out[2],out[3],penalty="SIC",n=200,diffparam=1) # returns 100 as a true changepoint

# Example of no change found
out=c(53,-22.47768,-24.39894) # tau, null, alt
decision(out[1],out[2],out[3],penalty="Manual",n=200,diffparam=1,pen.value="2*log(n)")
</code></pre>


</div>