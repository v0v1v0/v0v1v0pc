<div class="container">

<table style="width: 100%;"><tr>
<td>logDensityTipsCauchy</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Log Density of a Cauchy Process</h2>

<h3>Description</h3>

<p>Compute the log density of the vector of trait at the tips of the phylogenetic tree, 
assuming a Cauchy process.
</p>


<h3>Usage</h3>

<pre><code class="language-R">logDensityTipsCauchy(
  tree,
  tipTrait,
  root.value = NULL,
  disp,
  method = c("reml", "random.root", "fixed.root"),
  rootTip = NULL,
  do_checks = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>a phylogenetic tree of class <code>phylo</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tipTrait</code></td>
<td>
<p>a names vector of tip trait values, with names matching the tree labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>root.value</code></td>
<td>
<p>the root starting value of the process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>disp</code></td>
<td>
<p>the dispersion value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the method used to compute the likelihood.
One of <code>reml</code> (the default), <code>fixed.root</code> or <code>random.root</code>.
See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rootTip</code></td>
<td>
<p>the tip used to re-root the tree, when the REML method is used.
If <code>NULL</code>, the tip with the smallest distance to all the others is used (see Details).
Ignored in <code>method != "reml"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do_checks</code></td>
<td>
<p>if <code>FALSE</code>, the entry parameters are not checked for consistency.
This can be useful when doing multiple calls to the function, as in numerical optimization.
Default to <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The parameters of the Cauchy Process (CP)
are <code>disp</code>, the dispersion of the process,
and <code>root.value</code>, the starting value of the process at the root (for <code>method="fixed.root"</code>).
</p>
<p>The model assumes that each increment of the trait <code class="reqn">X</code> on a branch going from node <code class="reqn">k</code> to <code class="reqn">l</code> 
follows a Cauchy distribution, with a dispersion proportional to the length <code class="reqn">t_l</code> of the branch:
</p>
<p style="text-align: center;"><code class="reqn">X_l - X_k \sim \mathcal{C}(0, \mbox{disp} \times t_l).</code>
</p>

<p>The <code>method</code> argument specifies the type of likelihood that is computed:
</p>

<dl>
<dt>
<code>method="reml"</code>:</dt>
<dd> 
<p>the dispersion parameter is fitted using the REML criterion,
obtained by re-rooting the tree to one of the tips.
The default tip used to reroot the tree is:
<code>rootTip = which.min(colSums(cophenetic.phylo(tree)))</code>.
Any tip can be used, but this default empirically proved to be the most robust numerically;
</p>
</dd>
<dt>
<code>method="random.root"</code>:</dt>
<dd> 
<p>the root value is assumed to be a random Cauchy variable, centered at <code>root.value=0</code>,
and with a dispersion <code>disp_root = disp * root.edge</code>;
</p>
</dd>
<dt>
<code>method="fixed.root"</code>:</dt>
<dd> 
<p>the model is fitted conditionally on the root value <code>root.value</code>,
i.e. with a model where the root value is fixed and inferred from the data.
</p>
</dd>
</dl>
<h3>Value</h3>

<p>the log density value.
</p>


<h3>See Also</h3>

<p><code>fitCauchy</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">phy &lt;- ape::rphylo(5, 0.1, 0)
dat &lt;- rTraitCauchy(n = 1, phy = phy, model = "cauchy", parameters = list(root.value = 0, disp = 1))
logDensityTipsCauchy(phy, dat, 0, 1, method = "fixed.root")

</code></pre>


</div>