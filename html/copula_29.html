<div class="container">

<table style="width: 100%;"><tr>
<td>An</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Nonparametric Rank-based Estimators of the Pickands Dependence Function</h2>

<h3>Description</h3>

<p>Bivariate and multivariate versions of the nonparametric rank-based
estimators of the Pickands dependence function <code class="reqn">A</code>, studied in
Genest and Segers (2009) and Gudendorf and Segers (2011).
</p>


<h3>Usage</h3>

<pre><code class="language-R">An.biv(x, w, estimator = c("CFG", "Pickands"), corrected = TRUE,
       ties.method = eval(formals(rank)$ties.method))
An(x, w, ties.method = eval(formals(rank)$ties.method))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> a data matrix that will be transformed to
pseudo-observations. If <code>An.biv</code> is called, <code>x</code> has to
have two columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p> if <code>An.biv</code> is called, a vector of points in [0,1]
where to evaluate the estimated bivariate Pickands dependence
function. If the multivariate estimator <code>An</code> is used instead,
<code>w</code> needs to be a matrix with the same number of columns as
<code>x</code> whose lines are elements of the multivariate unit simplex
(see the last reference).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimator</code></td>
<td>
<p>specifies which nonparametric rank-based estimator
of the unknown Pickands dependence function to use in the bivariate
case; can be either
<code>"CFG"</code>(Capéraà-Fougères-Genest) or
<code>"Pickands"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corrected</code></td>
<td>
<p> TRUE means that the bivariate estimators will be
corrected to ensure that their value at 0 and 1 is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ties.method</code></td>
<td>
<p><code>character</code> string specifying how ranks
should be computed if
there are ties in any of the coordinate samples of <code>x</code>; passed
to <code>pobs</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>More details can be found in the references.
</p>


<h3>Value</h3>

<p><code>An.biv()</code> returns a vector containing the values of the
estimated Pickands dependence function at the points in <code>w</code> (and
is the same as former <code>Anfun()</code>).
</p>
<p>The function <code>An</code> computes simultaneously the three corrected
multivariate estimators studied in Gudendorf and Segers (2011) at the
points in <code>w</code> and retuns a list whose components are
</p>
<table>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p> values of the Pickands estimator at the points in <code>w</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CFG</code></td>
<td>
<p> values of the CFG estimator at the points in <code>w</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>HT</code></td>
<td>
<p> values of the Hall-Tajvidi estimator at the points in <code>w</code>.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>C. Genest and J. Segers (2009).
Rank-based inference for bivariate extreme-value copulas.
<em>Annals of Statistics</em> <b>37</b>, 2990–3022.
</p>
<p>G. Gudendorf and J. Segers (2011). Nonparametric estimation of
multivariate extreme-value copulas. <em>Journal of Statistical
Planning and Inference</em> <b>142</b>, 3073–3085.
</p>


<h3>See Also</h3>

<p><code>evCopula</code>, <code>A</code>, and <code>evTestA</code>.
Further, <code>evTestC</code>, <code>evTestK</code>,
<code>exchEVTest</code>, and <code>gofEVCopula</code>. </p>


<h3>Examples</h3>

<pre><code class="language-R">## True Pickands dependence functions
curve(A(gumbelCopula(4   ), x), 0, 1)
curve(A(gumbelCopula(2   ), x), add=TRUE, col=2)
curve(A(gumbelCopula(1.33), x), add=TRUE, col=3)

## CFG estimator
curve(An.biv(rCopula(1000, gumbelCopula(4   )), x), lty=2, add=TRUE)
curve(An.biv(rCopula(1000, gumbelCopula(2   )), x), lty=2, add=TRUE, col=2)
curve(An.biv(rCopula(1000, gumbelCopula(1.33)), x), lty=2, add=TRUE, col=3)

## Pickands estimator
curve(An.biv(rCopula(1000, gumbelCopula(4   )), x, estimator="Pickands"),
      lty=3, add=TRUE)
curve(An.biv(rCopula(1000, gumbelCopula(2   )), x, estimator="Pickands"),
      lty=3, add=TRUE, col=2)
curve(An.biv(rCopula(1000, gumbelCopula(1.33)), x, estimator="Pickands"),
      lty=3, add=TRUE, col=3)

legend("bottomleft",  paste0("Gumbel(", format(c(4, 2, 1.33)),")"),
       lwd=1, col=1:3, bty="n")
legend("bottomright", c("true", "CFG est.", "Pickands est."), lty=1:3, bty="n")

## Relationship between An.biv and An
u &lt;- c(runif(100),0,1) # include 0 and 1
x &lt;- rCopula(1000, gumbelCopula(4))
r &lt;- An(x, cbind(1-u, u))
all.equal(r$CFG, An.biv(x, u))
all.equal(r$P, An.biv(x, u, estimator="Pickands"))

## A trivariate example
x &lt;- rCopula(1000, gumbelCopula(4, dim = 3))
u &lt;- matrix(runif(300), 100, 3)
w &lt;- u / apply(u, 1, sum)
r &lt;- An(x, w)

## Endpoint corrections are applied
An(x, cbind(1, 0, 0))
An(x, cbind(0, 1, 0))
An(x, cbind(0, 0, 1))

</code></pre>


</div>