<div class="container">

<table style="width: 100%;"><tr>
<td>gofTstat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Goodness-of-fit Test Statistics</h2>

<h3>Description</h3>

<p><code>gofTstat()</code> computes various goodness-of-fit test statistics
typically used in <code>gofCopula(*, simulation = "pb")</code>.
<code>gofT2stat()</code> computes the two-sample goodness of fit test
statistic of Rémillard and Scaillet (2009).
</p>


<h3>Usage</h3>

<pre><code class="language-R">gofTstat(u, method = c("Sn", "SnB", "SnC", "AnChisq", "AnGamma"),
         useR = FALSE, ...)
gofT2stat(u1, u2, useR = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p><code class="reqn">n\times d</code>-matrix of values in <code class="reqn">[0,1]</code>,
supposedly independent uniform observations in the
hypercube, that is, <code class="reqn">U_i \sim U[0,1]^d</code>, i.i.d.,
for <code class="reqn">i \in \{1,\dots,n\}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u1, u2</code></td>
<td>
<p><code class="reqn">n\times d</code>-matrices of copula samples
to be compare against. The two matrices must have an equal number
of columns <code class="reqn">d</code> but can differ in <code class="reqn">n</code> (number of rows).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a <code>character</code> string specifying the
goodness-of-fit test statistic to be used, which has to be one (or a unique
abbreviation) of
</p>

<dl>
<dt><code>"Sn"</code></dt>
<dd>
<p>for computing the test statistic
<code class="reqn">S_n</code> from Genest,
Rémillard, Beaudoin (2009).</p>
</dd>
<dt><code>"SnB"</code></dt>
<dd>
<p>for computing the test statistic
<code class="reqn">S_n^{(B)}</code> from Genest,
Rémillard, Beaudoin (2009).</p>
</dd>
<dt><code>"SnC"</code></dt>
<dd>
<p>for computing the test statistic
<code class="reqn">S_n^{(C)}</code> from Genest et al. (2009).</p>
</dd>
<dt><code>"AnChisq"</code></dt>
<dd>
<p>Anderson-Darling test statistic for
computing (supposedly) <code class="reqn">\mathrm{U}[0,1]</code>-distributed
(under <code class="reqn">H_0</code>) random variates via the distribution function
of the chi-square distribution with <code class="reqn">d</code>
degrees of freedom. To be more precise, the Anderson-Darling
test statistc of the variates
</p>
<p style="text-align: center;"><code class="reqn">\chi_d^2\Bigl(\sum_{j=1}^d(\Phi^{-1}(u_{ij}))^2\Bigr)</code>
</p>

<p>is computed (via <code>ADGofTest::ad.test</code>), where
<code class="reqn">\Phi^{-1}</code> denotes the quantile function
of the standard normal distribution function,
<code class="reqn">\chi_d^2</code> denotes the distribution function
of the chi-square distribution with <code class="reqn">d</code> degrees of freedom,
and <code class="reqn">u_{ij}</code> is the <code class="reqn">j</code>th component in the <code class="reqn">i</code>th row
of <code>u</code>.</p>
</dd>
<dt><code>"AnGamma"</code></dt>
<dd>
<p>similar to <code>method="AnChisq"</code> but
based on the variates
</p>
<p style="text-align: center;"><code class="reqn">\Gamma_d\Bigl(\sum_{j=1}^d(-\log u_{ij})\Bigr),</code>
</p>

<p>where <code class="reqn">\Gamma_d</code> denotes the distribution
function of the gamma distribution with shape parameter <code class="reqn">d</code>
and shape parameter one	(being equal to an
Erlang(<code class="reqn">d</code>) distribution function).</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useR</code></td>
<td>
<p>logical indicating whether an <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> or C implementation is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments passed for computing the different
test statistics.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>These functions should be used with care. The different test statistics
were implemented (partly) for different purposes and goodness-of-fit
tests and should be used only with knowledge about such tests (see the
references for more details).
</p>


<h3>Value</h3>

<p>The value of the test statistic, a <code>numeric</code>.
</p>


<h3>References</h3>

<p>Genest, C., Rémillard, B., and Beaudoin, D. (2009),
Goodness-of-fit tests for copulas: A review and a power study
<em>Insurance: Mathematics and Economics</em> <b>44</b>, 199–213.
</p>
<p>Rosenblatt, M. (1952),
Remarks on a Multivariate Transformation,
<em>The Annals of Mathematical Statistics</em> <b>23</b>, 3, 470–472.
</p>
<p>Hering, C. and Hofert, M. (2014),
Goodness-of-fit tests for Archimedean copulas in high dimensions,
<em>Innovations in Quantitative Risk Management</em>.
</p>
<p>Hofert, M., Mächler, M., and McNeil, A. J. (2012).
Likelihood inference for Archimedean copulas in high dimensions
under known margins. <em>Journal of Multivariate Analysis</em>
<b>110</b>, 133–150.
</p>
<p>Rémillard, B. and Scaillet, O. (2009).
Testing for equality between two copulas.
<em>Journal of Multivariate Analysis</em>
<b>100</b>, 377–386.
</p>


<h3>See Also</h3>

<p><code>gofCopula()</code> for goodness-of-fit tests where (some of)
the test statistics of <code>gofTstat()</code> are used.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## generate data
cop &lt;- archmCopula("Gumbel", param=iTau(gumbelCopula(), 0.5), dim=5)
set.seed(1)
U &lt;- rCopula(1000, cop)

## compute Sn (as is done in a parametric bootstrap, for example)
Uhat &lt;- pobs(U) # pseudo-observations
u &lt;- cCopula(Uhat, copula = cop) # Rosenblatt transformed data (with correct copula)
gofTstat(u, method = "Sn", copula = cop) # compute test statistic Sn; requires copula argument
</code></pre>


</div>