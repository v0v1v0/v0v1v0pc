<div class="container">

<table style="width: 100%;"><tr>
<td>monodr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Restoration of monotonicity respecting using adaptive interpolation of
Huang (2017)</h2>

<h3>Description</h3>

<p>Restoration of monotonicity respecting for dynamic regression
models such as quantile regression model, Aalen's additive hazards model,
and dynamic survival models of Peng and Huang (2007, <em>Biometrika</em>,
pp 719–733).</p>


<h3>Usage</h3>

<pre><code class="language-R">monodr(origrc,zch,initau=0.5,taus=numeric(0))</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>origrc</code></td>
<td>
<p>(piecewise-constant) original regression coefficient.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zch</code></td>
<td>
<p>collection of covariate values for which the monotonicity
is enforced. In the presence of intercept in "origrc", unity element needs
to be included. "zch" could be the original covariate matrix. However,
using its convext hull, if readily available, may be computationally more
efficient.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initau</code></td>
<td>
<p>starting tau value from which monotonicity-respecting is
restored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taus</code></td>
<td>
<p>(increasing) tau values at which quantile coefficient is
of interest.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>airc</code></td>
<td>
<p>regression coefficient after adaptive interpolation: each
column corresponds to an interpolating point (the intercept is followed by
slope coefficients, and final element is tau, the probability index.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bt</code></td>
<td>
<p>adaptively interpolated coefficient at taus, only available if taus
is specified.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Huang, Y. (2017) Restoration of monotonicity respecting in dynamic regression. <em>Journal of the American Statistical Association</em> 112, 613–622.</p>


<h3>Examples</h3>

<pre><code class="language-R">## run the example in cequre first
num &lt;- 200
beta &lt;- c(.5, .5)
cvt.1 &lt;- as.numeric(runif(num)&lt;0.5)
cvt.2 &lt;- runif(num)
resid &lt;- rexp(num)
tres &lt;- 1-exp(-resid)
event.t &lt;- log(resid)+beta[1]*cvt.1*ifelse(tres&lt;.4,tres/.4,1)+beta[2]*cvt.2
censr.t &lt;- log(runif(num, 0, 5))
x &lt;- pmin(event.t, censr.t)
dlt &lt;- as.numeric(event.t&lt;=censr.t)
fit &lt;- cequre(x,dlt,cbind(cvt.1,cvt.2),taus=.1*seq(1,7,2),res=200)

## resotration of monotonicity respecting
zch &lt;- matrix(c(1,1,1,1,0,0,1,1,0,1,0,1),ncol=3)
mfit &lt;- monodr(fit$curve,zch,initau=fit$tau.bnd/2,taus=.1*seq(1,7,2))
</code></pre>


</div>