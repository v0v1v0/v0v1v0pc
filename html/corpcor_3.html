<div class="container">

<table style="width: 100%;"><tr>
<td>cor2pcor</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute Partial Correlation from Correlation Matrix â€“ and Vice Versa</h2>

<h3>Description</h3>

<p><code>cor2pcor</code> computes the pairwise 
<em>partial</em> correlation coefficients from either a correlation 
or a covariance matrix. 
</p>
<p><code>pcor2cor</code> takes either a partial correlation matrix or 
a partial covariance matrix as input,
and computes from it the corresponding correlation matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cor2pcor(m, tol)
pcor2cor(m, tol)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>covariance matrix or (partial) correlation matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>tolerance - singular values larger than
tol are considered non-zero (default value:
<code>tol = max(dim(m))*max(D)*.Machine$double.eps</code>).
This parameter is needed for  the singular
value decomposition on which <code>pseudoinverse</code> is based.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The partial
correlations are the negative standardized concentrations (which in 
turn are the off-diagonal elements of the inverse correlation or 
covariance matrix).  In graphical Gaussian models the partial 
correlations represent the 
direct interactions between two variables, conditioned on all
remaining variables.
</p>
<p>In the above functions the <code>pseudoinverse</code> is employed
for inversion - hence even singular covariances (with some
zero eigenvalues) may be used.  However, a better option may be to
estimate a positive definite covariance matrix using 
<code>cov.shrink</code>.
</p>
<p>Note that for efficient computation of partial correlation coefficients from 
data  <code>x</code> it is advised to use  <code>pcor.shrink(x)</code>  and <em>not</em> 
<code>cor2pcor(cor.shrink(x))</code>.
</p>


<h3>Value</h3>

<p>A matrix with the pairwise partial correlation coefficients
(<code>cor2pcor</code>) or with pairwise
correlations (<code>pcor2cor</code>).
</p>


<h3>Author(s)</h3>

<p>Korbinian Strimmer (<a href="https://strimmerlab.github.io">https://strimmerlab.github.io</a>).
</p>


<h3>References</h3>

<p>Whittaker J. 1990.  Graphical Models in Applied Multivariate Statistics.
John Wiley, Chichester.
</p>


<h3>See Also</h3>

<p><code>decompose.invcov</code>, <code>pcor.shrink</code>, <code>pseudoinverse</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R"># load corpcor library
library("corpcor")

# covariance matrix
m.cov = rbind(
 c(3,1,1,0),
 c(1,3,0,1),
 c(1,0,2,0),
 c(0,1,0,2)
)
m.cov


# corresponding correlation matrix
m.cor.1 = cov2cor(m.cov)
m.cor.1

# compute partial correlations (from covariance matrix)
m.pcor.1 = cor2pcor(m.cov)
m.pcor.1

# compute partial correlations (from correlation matrix)
m.pcor.2 = cor2pcor(m.cor.1)
m.pcor.2



zapsmall( m.pcor.1 ) == zapsmall( m.pcor.2 )

# backtransformation
m.cor.2 = pcor2cor(m.pcor.1)
m.cor.2
zapsmall( m.cor.1 ) == zapsmall( m.cor.2 )

</code></pre>


</div>