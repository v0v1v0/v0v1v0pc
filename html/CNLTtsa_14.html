<div class="container">

<table style="width: 100%;"><tr>
<td>smooth.over.scale</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Function to perform smoothing over scale of spectral quantities
</h2>

<h3>Description</h3>

<p>This function uses simple averaging or smoothing splines to smooth spectra over scale
</p>


<h3>Usage</h3>

<pre><code class="language-R">smooth.over.scale(x, det1, det2, lre, lreA, scale.range = NULL, Arange = NULL, 
Jstar = 20, splines = FALSE, positive = FALSE, dfS = 10, interpolate = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A vector corrsponding to the sampling grid of the component of a univariate series, or both components of a bivariate series with identical sampling grids.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>det1</code></td>
<td>
<p>A list of (real or imaginary parts of) the component 1 detail coefficients from a CNLT decomposition, such as from the output of <code>cnlt.biv</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>det2</code></td>
<td>
<p>A list of (real or imaginary parts of) the component 2 detail coefficients from a CNLT decomposition, such as from the output of <code>cnlt.biv</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lre</code></td>
<td>
<p>A list of scales (removed integral lengths) corresponding to <span class="env">det</span> from a CNLT decomposition, such as from the output of <code>cnlt.biv</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lreA</code></td>
<td>
<p>A list of asymmetry values from a CNLT decomposition, such as from the output of <code>cnlt.biv</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.range</code></td>
<td>
<p>An optional two-vector specifying the range of scales to be considered in the resulting output spectrum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Arange</code></td>
<td>
<p>An optional two-vector specifying whether the values used in forming the output spectrum should be limited to those from a specific range of asymmetry values,  
see Sanderson (2010), chapter 6.2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Jstar</code></td>
<td>
<p>The number of artificial scales in the output spectrum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>splines</code></td>
<td>
<p>An indicator variable whether smoothing splines should be used for the scale-based smoothing, or simple averaging (<code>splines = FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>positive</code></td>
<td>
<p>An indicator variable whether the smoothing should ensure that the resulting output is positive or not (e.g. for spectra).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dfS</code></td>
<td>
<p>An argument, if <code>splines = TRUE</code>, specifying the number of degrees of freedom for the smoothing spline.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interpolate</code></td>
<td>
<p>An indicator variable for whether interpolation should be used in the smoothing spline method for predicting values outside the range of the data.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For a univariate series or a bivariate series where the two components have the same sampling grids, the co- /quadrature periodogram values are first formed. 
They are then smoothed over scale (per timepoint), to give spectral values corresponding to equal artificial levels by setting <span class="env">Jstar</span> and optionally 
<span class="env">scale.range</span>.  
</p>


<h3>Value</h3>

<p>A list with the following components:<br></p>
<table>
<tr style="vertical-align: top;">
<td><code>spec</code></td>
<td>
<p>A matrix of dimension <code>Jstar x length(x)</code> corrsponding to a periodogram / co-periodogram / quadrature periodogram.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mscale</code></td>
<td>
<p>A vector of scales (of length <span class="env">Jstar</span>) corresponding to the rows of the spectrum <code>spec</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jean Hamilton, Matt Nunes
</p>


<h3>References</h3>

<p>Hamilton, J., Nunes, M. A., Knight, M. I. and Fryzlewicz, P. (2018) Complex-valued wavelet lifting and applications.
<em>Technometrics</em>, <b>60</b> (1), 48-60, DOI 10.1080/00401706.2017.1281846.
</p>


<h3>See Also</h3>

<p><code>cnlt.spec.SG</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">x&lt;-sort(runif(100))

y &lt;-sin(2*pi*(1/25)*x) + sin(2*pi*(1/50)*x)

## Not run: 
xy.dec&lt;-cnlt.univ(x,y,P=300)

# compute the real part of the spectrum (real details^2) and smooth over scale
ReS &lt;- smooth.over.scale(x, sapply(xy.dec$det1,Re), sapply(xy.dec$det1,Re), xy.dec$lre, 
xy.dec$lreA, positive = TRUE)

## End(Not run)

</code></pre>


</div>