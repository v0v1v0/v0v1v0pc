<div class="container">

<table style="width: 100%;"><tr>
<td>coincident_profile</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Coincident Profile</h2>

<h3>Description</h3>

<p>Returns the coincident profile developed by Martinez et al. (2016).
The ideal result is finding the maximum p-value for the lag = 0; otherwise
maximum p-value for negative lags suggest leading from x to y, or maximum
p-value for positive lags suggest leading from y to x.
</p>


<h3>Usage</h3>

<pre><code class="language-R">coincident_profile(x, y, frequ = 12, MLag = 6, nvar1 = "name.x",
  nvar2 = "name.y", print.graf = FALSE, iyear = 1,
  lyear = numeric(), imonth = 12, lmonth = numeric(),
  tit1 = "Title.x", tit2 = "Title.y", tit3 = "Title.x.y")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Univariate time series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Univariate time series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frequ</code></td>
<td>
<p>Frequency of x and y. x and y must have the same frequency</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MLag</code></td>
<td>
<p>Maximum lag for the coincident profile</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nvar1</code></td>
<td>
<p>Name of x</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nvar2</code></td>
<td>
<p>Name of y</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.graf</code></td>
<td>
<p>If TRUE returns a panel 2x2 where the superior panel has both
plots of x and y with their turning points (maximums black dots lines and minimums red dots lines).
The inferior left panel has the matplot of x and y standardized, respectively (x-mean(x))/sd(x).
The inferior right panel has the coincident profile where <em>TP</em> shows the number
of turning points used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iyear</code></td>
<td>
<p>The year of the first observation. A single number</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lyear</code></td>
<td>
<p>The year of the last observation. A single number</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>imonth</code></td>
<td>
<p>The amount of months for the first year. A single number</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lmonth</code></td>
<td>
<p>The amount of months for the last year. A single number</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tit1</code></td>
<td>
<p>Title for the plot x</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tit2</code></td>
<td>
<p>Title for the plot y</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tit3</code></td>
<td>
<p>Title for the plot x and y</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The main output contains two objects: the coincident
profile (Profile) and both the lag which has the highest probability and
the number of turning points considered to the calculus of the
coincident profile (MainLag).
</p>


<h3>Value</h3>

<p>The coincident profile
</p>


<h3>Author(s)</h3>

<p>Wilmer O Martinez R
</p>


<h3>References</h3>

<p>Martinez, W and Nieto, Fabio H and Poncela, P (2016)
"Choosing a dynamic common factor as a coincident index",
<em>Statistics and Probability Letters</em>, (109), 89-98.
<a href="http://dx.doi.org/10.1016/j.spl.2015.11.008">http://dx.doi.org/10.1016/j.spl.2015.11.008</a>.
</p>
<p>Banerji, A., (1999)
"The lead profile and others non-parametrics tools to evaluate survey
series as leading indicators",
<em>Survey Data for Industry, Research and Economic Policy,
selected papers presented at the 24th CIRET Conference, Willington, New Zealand.</em>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(123)
w &lt;- seq(-3, 7, length.out = 100)
x1 &lt;- sin(pi*w)+rnorm(100,0,0.1)
x2 &lt;- sin(pi*w-0.1)+rnorm(100,0,0.1)
coincident_profile(x1, x2, 4, 5, "name.x", "name.y", TRUE, 1991, 2015, 4, 4)

# In this example x leads y three periods
set.seed(123)
w &lt;- seq(-3, 7, length.out = 100)
x &lt;- sin(pi*w)+rnorm(100,0,0.1)
y &lt;- sin(pi*w-1)+rnorm(100,0,0.1)
coincident_profile(x, y, 4, 6, "name.x", "name.y", TRUE, 1991, 2015, 4, 4)
</code></pre>


</div>