<div class="container">

<table style="width: 100%;"><tr>
<td>fit.FMMSNC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Fitting Finite Mixture of Multivariate Distributions.
</h2>

<h3>Description</h3>

<p>It adjusts a finite mixture of censored and/or missing multivariate distributions (FM-MC). These are the Skew-normal, normal and Student-t multivariate distributions. It uses a EM-type algorithm for iteratively computing maximum likelihood estimates of the parameters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit.FMMSNC(cc, LI, LS, y, mu = NULL, Sigma = NULL, shape = NULL, pii = NULL,
nu = NULL, g = NULL, get.init = TRUE, criteria = TRUE, family = "SN", error = 1e-05,
iter.max = 350, uni.Gama = FALSE, kmeans.param = NULL, cal.im = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cc</code></td>
<td>

<p>vector of censoring indicators. For each observation it takes 0 if non-censored, 1 if censored.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LI</code></td>
<td>

<p>the matrix of lower limits of dimension <code class="reqn">n</code>x<code class="reqn">p</code>. See details section.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LS</code></td>
<td>

<p>the matrix of upper limits of dimension <code class="reqn">n</code>x<code class="reqn">p</code>. See details section.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>the response matrix with dimension <code class="reqn">n</code>x<code class="reqn">p</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>

<p>a list with <code class="reqn">g</code> entries, where each entry represents location parameter per group, being a vector of dimension. <code class="reqn">p</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>

<p>a list with <code class="reqn">g</code> entries, where each entry represents a scale parameter per group, a matrix with dimension. <code class="reqn">p</code>x<code class="reqn">p</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape</code></td>
<td>

<p>a list with <code class="reqn">g</code> entries, where each entry represents a skewness parameter, being a vector of dimension <code class="reqn">p</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pii</code></td>
<td>

<p>a vector of weights for the mixture (dimension of the number <code class="reqn">g</code> of clusters). Must sum to one!
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>

<p>the degrees of freedom for the Student-t distribution case, being a vector with dimension <code class="reqn">g</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>

<p>number of mixture components.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>get.init</code></td>
<td>

<p>Logical, <code>TRUE</code> or <code>FALSE</code>. If (<code>get.init==TRUE</code>) the function computes the initial values, otherwise (<code>get.init==FALSE</code>) the user should enter the initial values manually.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criteria</code></td>
<td>

<p>Logical, <code>TRUE</code> or <code>FALSE</code>. It indicates if likelihood-based criteria selection methods (AIC, BIC and EDC) are computed for comparison purposes.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>

<p>distribution family to be used. Available distributions are the Skew-normal ("SN"), normal ("Normal") or Student-t ("t") distribution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>error</code></td>
<td>

<p>relative error for stopping criterion of the algorithm. See details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter.max</code></td>
<td>

<p>the maximum number of iterations of the EM algorithm.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uni.Gama</code></td>
<td>

<p>Logical, <code>TRUE</code> or <code>FALSE</code>. If <code>uni.Gama==TRUE</code>, the scale matrices per group are considered to be equals.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kmeans.param</code></td>
<td>

<p>a list with alternative parameters for the kmeans function when generating initial values. List by default is
<code>list(iter.max = 10, n.start = 1, algorithm = "Hartigan-Wong")</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cal.im</code></td>
<td>

<p>Logical, <code>TRUE</code> or <code>FALSE</code>. If <code>cal.im==TRUE</code>, the information matrix is calculated and the standard errors are reported.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The information matrix is calculated with respect to the entries of
the square root matrix of Sigma, this using the Empirical information matrix. Disclaimer: User must be careful since the inference is asymptotic, so it must be used for decent sample sizes. Stopping criterion is <code>abs((loglik/loglik-1))&lt;epsilon</code>.
</p>


<h3>Value</h3>

<p>It returns a list that depending of the case, it returns one or more of the following objects:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>a list with <code class="reqn">g</code> components, where each component is a vector with dimension <code class="reqn">p</code> containing the estimated values of the location parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>a list with <code class="reqn">g</code> components, where each component is a matrix with dimension <code class="reqn">p</code>x<code class="reqn">p</code> containing the estimated values of the scale matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gamma</code></td>
<td>
<p>a list with <code class="reqn">g</code> components, where each component is a matrix with dimension <code class="reqn">p</code>x<code class="reqn">p</code> containing the estimated values of the <code class="reqn">Gamma</code> scale matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape</code></td>
<td>
<p>a list with <code class="reqn">g</code> components, where each component is a vector with dimension <code class="reqn">p</code> containing the estimated values of the skewness parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p>a vector with one element containing the value of the degreees of freedom <code class="reqn">nu</code> parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pii</code></td>
<td>
<p>a vector with <code class="reqn">g</code> elements containing the estimated values of the weights <code class="reqn">pii</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Zij</code></td>
<td>
<p>a <code class="reqn">n</code> x <code class="reqn">p</code> matrix containing the estimated weights values of the subjects for each group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yest</code></td>
<td>
<p>a <code class="reqn">n</code> x <code class="reqn">p</code> matrix containing the estimated values of <code class="reqn">y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MI</code></td>
<td>
<p>a list with the standard errors for all parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logLik</code></td>
<td>
<p>the log-likelihood value for the estimated parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aic</code></td>
<td>
<p>the AIC criterion value for the estimated parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bic</code></td>
<td>
<p>the BIC criterion value for the estimated parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edc</code></td>
<td>
<p>the EDC criterion value for the estimated parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>number of iterations until the EM algorithm converges.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>a <code class="reqn">n</code> x <code class="reqn">p</code> matrix containing the classification for the subjects to each group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>time in minutes until the EM algorithm converges.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The <code>uni.Gama</code> parameter refers to the <code class="reqn">\Gamma</code> matrix for the Skew-normal distribution, while for the normal and student-t distribution, this parameter refers to the <code class="reqn">\Sigma</code> matrix.
</p>


<h3>Author(s)</h3>

<p>Francisco H. C. de Alencar <a href="mailto:hildemardealencar@gmail.com">hildemardealencar@gmail.com</a>,
Christian E. Galarza <a href="mailto:cgalarza88@gmail.com">cgalarza88@gmail.com</a>,
Victor Hugo Lachos <a href="mailto:hlachos@uconn.edu">hlachos@uconn.edu</a> and
Larissa A. Matos <a href="mailto:larissam@ime.unicamp.br">larissam@ime.unicamp.br</a>
</p>
<p>Maintainer: Francisco H. C. de Alencar <a href="mailto:hildemardealencar@gmail.com">hildemardealencar@gmail.com</a>
</p>


<h3>References</h3>

<p>Cabral, C. R. B., Lachos, V. H., &amp; Prates, M. O. (2012). Multivariate mixture modeling using skew-normal independent distributions. Computational Statistics &amp; Data Analysis, 56(1), 126-142.
</p>
<p>Prates, M. O., Lachos, V. H., &amp; Cabral, C. (2013). mixsmsn: Fitting finite mixture of scale mixture of skew-normal distributions. Journal of Statistical Software, 54(12), 1-20.
</p>
<p>C.E. Galarza, L.A. Matos, D.K. Dey &amp; V.H. Lachos. (2019) On Moments of Folded and Truncated Multivariate Extended Skew-Normal Distributions. Technical report. ID 19-14. University of Connecticut.
</p>
<p>F.H.C. de Alencar, C.E. Galarza, L.A. Matos &amp; V.H. Lachos. (2019) Finite Mixture Modeling of Censored and Missing Data Using the Multivariate Skew-Normal Distribution. echnical report. ID 19-31. University of Connecticut.
</p>


<h3>See Also</h3>

<p><code>rMSN</code>, <code>rMMSN</code> and <code>rMMSN.contour</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">mu          &lt;- Sigma &lt;- shape &lt;- list()
mu[[1]]     &lt;- c(-3,-4)
mu[[2]]     &lt;- c(2,2)
Sigma[[1]]  &lt;- matrix(c(3,1,1,4.5), 2,2)
Sigma[[2]]  &lt;- matrix(c(2,1,1,3.5), 2,2)
shape[[1]]  &lt;- c(-2,2)
shape[[2]]  &lt;- c(-3,4)
nu          &lt;- c(0,0)
pii         &lt;- c(0.6,0.4)
percen &lt;- c(0.1,0.2)
n &lt;- 200
g &lt;- 2
seed &lt;- 654678

set.seed(seed)
test = rMMSN(n = n, pii = pii,mu = mu,Sigma = Sigma,shape = shape,
percen = percen, each = TRUE, family = "SN")

Zij &lt;- test$G
cc &lt;- test$cc
y &lt;- test$y

## left censoring ##
LI &lt;-cc
LS &lt;-cc
LI[cc==1]&lt;- -Inf
LS[cc==1]&lt;- y[cc==1]


#full analysis may take a few seconds more...

test_fit.cc0 = fit.FMMSNC(cc, LI, LS, y, mu=mu,
Sigma = Sigma, shape=shape, pii = pii, g = 2, get.init = FALSE,
criteria = TRUE, family = "Normal", error = 0.0001,
iter.max = 200, uni.Gama = FALSE, cal.im = FALSE)


test_fit.cc = fit.FMMSNC(cc, LI, LS, y, mu=mu,
Sigma = Sigma, shape=shape, pii = pii, g = 2, get.init = FALSE,
criteria = TRUE, family = "SN", error = 0.00001,
iter.max = 350, uni.Gama = FALSE, cal.im = TRUE)

## missing data ##
pctmiss &lt;- 0.2 # 20% of missing data in the whole data
missing &lt;- matrix(runif(n*g), nrow = n) &lt; pctmiss
y[missing] &lt;- NA

cc &lt;- matrix(nrow = n,ncol = g)
cc[missing] &lt;- 1
cc[!missing] &lt;- 0

LI &lt;- cc
LS &lt;-cc
LI[cc==1]&lt;- -Inf
LS[cc==1]&lt;- +Inf

test_fit.mis = fit.FMMSNC(cc, LI, LS, y, mu=mu,
Sigma = Sigma, shape=shape, pii = pii, g = 2, get.init = FALSE,
criteria = TRUE, family = "SN", error = 0.00001,
iter.max = 350, uni.Gama = FALSE, cal.im = TRUE)

</code></pre>


</div>