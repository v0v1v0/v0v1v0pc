<div class="container">

<table style="width: 100%;"><tr>
<td>detectChangePoint</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Detect a Single Change Point in a Sequence</h2>

<h3>Description</h3>

<p>This function is used to detect a single change point in a sequence of observations using the Change Point Model (CPM) framework for sequential (Phase II) change detection. The observations are processed in order, starting with the first, and a decision is made after each observation whether a change point has occurred. If a change point is detected, the function returns with no further observations being processed. A full description of the CPM framework can be found in the papers cited in the reference section.
</p>
<p>For a fuller overview of this function including a description of the CPM framework and examples of how to use the various functions, please consult the package manual "Parametric and Nonparametric Sequential Change Detection in R: The cpm Package" available from www.gordonjross.co.uk
</p>


<h3>Usage</h3>

<pre><code class="language-R">     detectChangePoint(x, cpmType, ARL0=500, startup=20, lambda=NA) 
     </code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A vector containing the univariate data stream to be processed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cpmType</code></td>
<td>
<p>The type of CPM which is used. With the exception of the FET, these CPMs are all implemented in their two sided forms,
and are able to detect both increases and decreases in the parameters monitored. Possible arguments are: 
</p>

<ul>
<li> <p><code>Student</code>: Student-t test statistic, as in [Hawkins et al, 2003]. Use to detect mean changes in a Gaussian sequence.
</p>
</li>
<li> <p><code>Bartlett</code>: Bartlett test statistic, as in [Hawkins and Zamba, 2005]. Use to detect variance changes in a Gaussian sequence.
</p>
</li>
<li> <p><code>GLR</code>: Generalized Likelihood Ratio test statistic, as in [Hawkins and Zamba, 2005b]. Use to detect both mean and variance changes in a Gaussian sequence.
</p>
</li>
<li> <p><code>Exponential</code>: Generalized Likelihood Ratio test statistic for the Exponential distribution, as in [Ross, 2013]. Used to detect changes in the parameter of an Exponentially distributed sequence.
</p>
</li>
<li> <p><code>GLRAdjusted</code> and <code>ExponentialAdjusted</code>: Identical to the GLR and Exponential statistics, except with the finite-sample correction discussed in [Ross, 2013] which can lead to more powerful change detection.
</p>
</li>
<li> <p><code>FET</code>: Fishers Exact Test statistic, as in [Ross and Adams, 2012b]. Use to detect parameter changes in a Bernoulli sequence.
</p>
</li>
<li> <p><code>Mann-Whitney</code>: Mann-Whitney test statistic, as in [Ross et al, 2011]. Use to detect location shifts in a stream with a (possibly unknown) non-Gaussian distribution.
</p>
</li>
<li> <p><code>Mood</code>: Mood test statistic, as in [Ross et al, 2011]. Use to detect scale shifts in a stream with a (possibly unknown) non-Gaussian distribution.
</p>
</li>
<li> <p><code>Lepage</code>: Lepage test statistics in [Ross et al, 2011]. Use to detect location and/or shifts in a stream with a (possibly unknown) non-Gaussian distribution.
</p>
</li>
<li> <p><code>Kolmogorov-Smirnov</code>: Kolmogorov-Smirnov test statistic, as in [Ross et al 2012]. Use to detect arbitrary changes in a stream with a (possibly unknown) non-Gaussian distribution.
</p>
</li>
<li> <p><code>Cramer-von-Mises</code>: Cramer-von-Mises test statistic, as in [Ross et al 2012]. Use to detect arbitrary changes in a stream with a (possibly unknown) non-Gaussian distribution.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ARL0</code></td>
<td>
<p>Determines the <code class="reqn">ARL_0</code> which the CPM should have, which corresponds to the average number of observations before a false positive occurs, assuming that the sequence does not undergo a change. Because the thresholds of the CPM are computationally expensive to estimate, the package contains pre-computed values of the thresholds corresponding to several common values of the <code class="reqn">ARL_0</code>. This means that only certain  values for the <code class="reqn">ARL_0</code> are allowed. Specifically, the <code class="reqn">ARL_0</code> must have one of the following values: 370, 500, 600, 700, ..., 1000, 2000, 3000, ..., 10000, 20000, ..., 50000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>startup</code></td>
<td>
<p>The number of observations after which monitoring begins. No change points will be flagged during this startup period. This must be set to at least 20.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>A smoothing parameter which is used to reduce the discreteness of the test statistic when using the FET CPM. See [Ross and Adams, 2012b] in the References section for more details on how this parameter is used.  Currently the package only contains sequences of ARL0 thresholds corresponding to lambda=0.1 and lambda=0.3, so using other values will result in an error. If no value is specified, the default value will be 0.1.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The sequence of observations which was processed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>changeDetected</code></td>
<td>
<p>TRUE if any <code class="reqn">D_t</code> exceeds the value of <code class="reqn">h_t</code> associated with the chosen <code class="reqn">ARL_0</code>, otherwise FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>detectionTime</code></td>
<td>
<p>The observation after which the change point was detected, defined as the first observation after which <code class="reqn">D_t</code> exceeded the test threshold. If no change is detected, this will be equal to 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>changePoint</code></td>
<td>
<p>The best estimate of the change point location. If the change is detected after the <code class="reqn">t^{th}</code> observation, then the change estimate is the value of <code class="reqn">k</code> which maximises <code class="reqn">D_{k,t}</code>. If no change is detected, this will be equal to 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ds</code></td>
<td>
<p>The sequence of maximised <code class="reqn">D_t</code> statistics, starting from the first observation until the  observation after which the change point was detected</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Gordon J. Ross <a href="mailto:gordon@gordonjross.co.uk">gordon@gordonjross.co.uk</a></p>


<h3>References</h3>

<p>Hawkins, D. , Zamba, K. (2005) – A Change-Point Model for a Shift in Variance, <em>Journal of Quality Technology</em>, 37, 21-31
</p>
<p>Hawkins, D. , Zamba, K. (2005b) – Statistical Process Control for Shifts in Mean or Variance Using a Changepoint Formulation, <em>Technometrics</em>, 47(2), 164-173
</p>
<p>Hawkins, D., Qiu, P., Kang, C. (2003) – The Changepoint Model for Statistical Process Control, <em>Journal of Quality Technology</em>, 35, 355-366. 
</p>
<p>Ross, G. J., Tasoulis, D. K., Adams, N. M. (2011) – A Nonparametric Change-Point Model for Streaming Data, <em>Technometrics</em>, 53(4)
</p>
<p>Ross, G. J., Adams, N. M. (2012) – Two Nonparametric Control Charts for Detecting Arbitary Distribution Changes, <em>Journal of Quality Technology</em>, 44:102-116
</p>
<p>Ross, G. J., Adams, N. M. (2013) – Sequential Monitoring of a Proportion, <em>Computational Statistics</em>, 28(2)
</p>
<p>Ross, G. J., (2014) – Sequential Change Detection in the Presence of Unknown Parameters, <em>Statistics and Computing</em> 24:1017-1030
</p>
<p>Ross, G. J., (2015) – Parametric and Nonparametric Sequential Change Detection in R: The cpm Package, <em>Journal of Statistical Software</em>, forthcoming
</p>


<h3>See Also</h3>

<p><code>processStream, detectChangePointBatch</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">     ## Use a Student-t CPM to detect a mean shift in a stream of Gaussian 
     ## random variables which occurs after the 100th observation
     x &lt;- c(rnorm(100,0,1),rnorm(1000,1,1))
     detectChangePoint(x,"Student",ARL0=500,startup=20)


     ## Use a Mood CPM to detect a scale shift in a stream of Student-t 
     ## random variables which occurs after the 100th observation
     x &lt;- c(rt(100,5),rt(100,5)*2)
     detectChangePoint(x,"Mood",ARL0=500,startup=20)

     ## Use a FET CPM to detect a parameter shift in a stream of Bernoulli 
     ##observations. In this case, the lambda parameter acts to reduce the 
     ##discreteness of the test statistic.
     x &lt;- c(rbinom(100,1,0.2), rbinom(1000,1,0.5))
     detectChangePoint(x,"FET",ARL0=500,startup=20,lambda=0.3)
     </code></pre>


</div>