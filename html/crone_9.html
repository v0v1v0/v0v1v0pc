<div class="container">

<table style="width: 100%;"><tr>
<td>fousynth</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>From structure factors to density using Fourier synthesis</h2>

<h3>Description</h3>

<p>Given a set of structure factors, separately as a vector of amplitudes 
and a vector of phases in degrees, corresponding to a set of 1D
Miller indices, the length of the 1D unit cell, the set of Miller indices
and the number of grid points used to calculate the 1D density, this
function calculates the 1D density corresponding to the given structure
factors.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fousynth(a, Fmod, Fpha, hidx, N)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>A real number. The unit cell side length.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Fmod</code></td>
<td>
<p>A vector of real numbers. The structure factors' amplitudes
corresponding to the 1D density to be calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Fpha</code></td>
<td>
<p>A vector of real numbers. The structure factors' phases
(in degrees) corresponding to the 1D density to be calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hidx</code></td>
<td>
<p>A vector of integer numbers. The set of 1D Miller indices
corresponding to the set of structure factors F.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>An integer number. The number of grid points used to calculate the
1D density.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A vector of N real numbers representing the calculated 1D density at
each of the regular N grid points.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># First create the crystal structure (in P1)
a &lt;- 10
SG &lt;- "P1"
x0 &lt;- c(1,4,6.5)
Z &lt;- c(8,26,6)
B &lt;- c(18,20,17)
occ &lt;- c(1,1,1)
sdata &lt;- standardise_sdata(a,SG,x0,Z,B,occ)

# Enough Fourier components (Miller indices)
hidx &lt;- 0:20

# Compute the structure factors
ftmp &lt;- strufac(hidx,sdata)

# Number of grid points
N &lt;- 1000

# Density
rtmp &lt;- fousynth(a,ftmp$Fmod,ftmp$Fpha,hidx,N)

# Density plot in the unit cell
x &lt;- rtmp$x
rho &lt;- rtmp$rr
plot(x,rho,type="l",xlab="x",ylab=expression(rho))
</code></pre>


</div>