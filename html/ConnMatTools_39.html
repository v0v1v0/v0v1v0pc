<div class="container">

<table style="width: 100%;"><tr>
<td>r.marked.egg.fraction</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimates of fraction of eggs marked accounting for variability in 
reproductive output</h2>

<h3>Description</h3>

<p>This function estimates the fraction of eggs "marked" at a site (where the 
"mark" could be micro-chemical or genetic) taking into account uncertainty in
female (and potentially male in the case of dual genetic mark transmission) 
reproductive output. It generates a set of potential values for the fraction 
of eggs marked assuming that reproductive output of each marked or unmarked 
mature individual is given by a random variable drawn from a single 
probability distribution with known mean and standard deviation (or 
equivalently coefficient of variation) <strong>and</strong> that the numbers 
of marked and unmarked individuals are large enough that the central limit 
theorem applies and, therefore, their collective reproductive outputs are 
reasonably well described by a gamma distribution whose mean and standard 
deviation are appropriately scaled based on the number of individual 
reproducers.  The function also returns the total egg production 
corresponding to each fraction of marked eggs, needed for estimating absolute
connectivity values (i.e., elements of the connectivity matrix needed for 
assessing population persistence).
</p>


<h3>Usage</h3>

<pre><code class="language-R">r.marked.egg.fraction(
  n,
  n.females,
  n.marked.females = round(n.females * p.marked.females),
  mean.female = 1,
  cv.female,
  dual = FALSE,
  male.uncert = FALSE,
  n.males = n.females,
  n.marked.males = tryCatch(round(n.males * p.marked.males), error = function(e)
    n.marked.females),
  mean.male = mean.female,
  cv.male = cv.female,
  p.marked.females,
  p.marked.males = p.marked.females
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of random values to estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.females</code></td>
<td>
<p>Total number of mature females in the population</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.marked.females</code></td>
<td>
<p>Number of marked females in population</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.female</code></td>
<td>
<p>Mean egg production of each mature female. Defaults to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv.female</code></td>
<td>
<p>Coefficient of variation of reproductive output of an 
individual mature female</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dual</code></td>
<td>
<p>Logical variable. If <code>TRUE</code>, then the fraction of marked 
eggs is calculated assuming dual (male and female) mark transmission. 
Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>male.uncert</code></td>
<td>
<p>Logical variable. If <code>TRUE</code>, then variability in male
sperm output is also taken into account when estimating the number of 
marked eggs. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.males</code></td>
<td>
<p>Total number of mature males in the population. Only used if 
<code>dual=TRUE</code>. Defaults to being equal to <code>n.females</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.marked.males</code></td>
<td>
<p>Number of marked males in population. Only used if 
<code>dual=TRUE</code>. Defaults to being equal to <code>n.marked.females</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.male</code></td>
<td>
<p>Mean sperm production of each mature male. Only used if 
<code>dual=TRUE</code> and <code>male.uncert=TRUE</code>. Defaults to being equal to 
<code>mean.female</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv.male</code></td>
<td>
<p>Coefficient of variation of reproductive output of an 
individual mature male. Only used if <code>dual=TRUE</code> and 
<code>male.uncert=TRUE</code>. Defaults to being equal to <code>cv.female</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.marked.females</code></td>
<td>
<p>Fraction of marked females in population. Can be 
supplied instead of <code>n.marked.females</code>. Ignored if 
<code>n.marked.females</code> is given.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.marked.males</code></td>
<td>
<p>Fraction of marked males in population. Can be supplied
instead of <code>n.marked.males</code>. Only used if <code>dual=TRUE</code>. Ignored if
<code>n.marked.males</code> is given.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the following elements: </p>
<dl>
<dt>p</dt>
<dd>
<p>Vector of 
length <code>n</code> with estimates for fraction of marked 
eggs</p>
</dd>
<dt>eggs</dt>
<dd>
<p>Vector of length <code>n</code> with estimates for total egg 
production</p>
</dd>
<dt>marked.eggs</dt>
<dd>
<p>Vector of length <code>n</code> with estimates for 
total number of marked eggs produced</p>
</dd>
<dt>sperm</dt>
<dd>
<p>Only returned if 
<code>dual=TRUE</code>. If <code>male.uncert=FALSE</code>, then a scalar equal to 
<code>n.males</code>. Otherwise, a vector of length <code>n</code> with estimates for 
total sperm production</p>
</dd>
<dt>marked.sperm</dt>
<dd>
<p>Only returned if 
<code>dual=TRUE</code>. If <code>male.uncert=FALSE</code>, then a scalar equal to 
<code>n.marked.males</code>. Otherwise, a vector of length <code>n</code> with
estimates for total marked sperm production</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>David M. Kaplan <a href="mailto:dmkaplan2000@gmail.com">dmkaplan2000@gmail.com</a>
</p>


<h3>References</h3>

<p>Kaplan DM, Cuif M, Fauvelot C, Vigliola L, Nguyen-Huu T, Tiavouane J and Lett C 
(in press) Uncertainty in empirical estimates of marine larval connectivity. 
ICES Journal of Marine Science. doi:10.1093/icesjms/fsw182.
</p>


<h3>See Also</h3>

<p>Other connectivity estimation: 
<code>d.rel.conn.beta.prior()</code>,
<code>d.rel.conn.dists.func()</code>,
<code>d.rel.conn.finite.settlement()</code>,
<code>d.rel.conn.multinomial.unnorm()</code>,
<code>d.rel.conn.multiple()</code>,
<code>d.rel.conn.unif.prior()</code>,
<code>dual.mark.transmission()</code>,
<code>optim.rel.conn.dists()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(ConnMatTools)

n.females &lt;- 500
n.marked.females &lt;- 100
p.marked.females &lt;- n.marked.females/n.females
mn &lt;- 1
cv &lt;- 1
# Numbers of males and marked males and variance in male sperm production
# assumed the same as values for females

# Random values from distribution of pure female mark transmission
F=r.marked.egg.fraction(1000,n.females=n.females,n.marked.females=n.marked.females,
                        mean.female=mn,cv.female=cv)

# Random values from distribution of dual female-male mark transmission, but
# fraction of marked eggs only depends on fraction of marked males
Fm=r.marked.egg.fraction(1000,n.females=n.females,n.marked.females=n.marked.females,
                        mean.female=mn,cv.female=cv,dual=TRUE,male.uncert=FALSE)

# Random values from distribution of dual female-male mark transmission, with
# fraction of marked eggs depending on absolute marked and unmarked sperm output
FM=r.marked.egg.fraction(1000,n.females=n.females,n.marked.females=n.marked.females,
                         mean.female=mn,cv.female=cv,dual=TRUE,male.uncert=TRUE)

# Plot of pure female mark transmission
hist(F$p,50,main="Female mark transmission",
     xlab="Fraction of marked eggs",
     ylab="Frequency")

# Female+male mark transmission, but no variability in male mark transmission
h &lt;- hist(Fm$p,50,main="Female+male mark transmission, no male uncert.",
          xlab="Fraction of marked eggs",
          ylab="Frequency")
hh &lt;- hist((1-p.marked.females)*F$p + p.marked.females,
           breaks=c(-Inf,h$breaks,Inf),plot=FALSE)
lines(hh$mids,hh$counts,col="red")

# Plot of pure female mark transmission
h &lt;- hist(FM$p,50,plot=FALSE)
hh &lt;- hist(Fm$p,
           breaks=c(-Inf,h$breaks,Inf),plot=FALSE)
plot(h,ylim=c(0,1.1*max(hh$counts,h$counts)),
     main="Female+Male mark transmission, male uncert.",
     xlab="Fraction of marked eggs",
     ylab="Frequency")
lines(hh$mids,hh$counts,col="red")
</code></pre>


</div>