<div class="container">

<table style="width: 100%;"><tr>
<td>normFit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit a normalization model</h2>

<h3>Description</h3>

<p>Fit the parameters for normalization of a metabolomics data set.
</p>


<h3>Usage</h3>

<pre><code class="language-R">normFit(
  object,
  method,
  one = "Succinate_d4",
  factors = NULL,
  lg = TRUE,
  fitfunc = lm,
  formula = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an <code>ExpressionSet</code> or a <code>matrix</code> (with
samples as   columns) in which case the <code>standards</code> must be
passed on via <code>...</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>chosen normalization method</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>one</code></td>
<td>
<p>single internal standard to use for normalization</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>factors</code></td>
<td>
<p>column names in the pheno data slot describing the
biological factors. Or a design matrix directly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lg</code></td>
<td>
<p>logical indicating that the data should be log
transformed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitfunc</code></td>
<td>
<p>the function that creates the model fit for
normalization, must use the same interfaces as <code>lm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>if fitfunc has formula interface or not</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>passed on to <code>standardsFit</code>, <code>standards</code>,
analytes</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Normalization is first done by fitting a model and then applying
that model either to new data or the same data using
<code>normPred</code>. Five different methods are implemented.
</p>

<dl>
<dt>t1</dt>
<dd>
<p>divide by row-means of the <code class="reqn">L_2</code>  scaled internal standards</p>
</dd>
<dt>one</dt>
<dd>
<p>divide by value of a single, user defined, internal standard</p>
</dd>
<dt>totL2</dt>
<dd>
<p>divide by the square of sums of the full dataset</p>
</dd>
<dt>nomis</dt>
<dd>
<p>See Sysi-Aho et al.</p>
</dd>
<dt>crmn</dt>
<dd>
<p>See Redestig et al.</p>
</dd>
</dl>
<h3>Value</h3>

<p>a normalization model
</p>


<h3>Author(s)</h3>

<p>Henning Redestig
</p>


<h3>References</h3>

<p>Sysi-Aho, M.; Katajamaa, M.; Yetukuri, L. &amp; Oresic,
M. Normalization method for metabolomics data using optimal
selection of multiple internal standards. BMC Bioinformatics,
2007, 8, 93
</p>
<p>Redestig, H.; Fukushima, A.; Stenlund, H.; Moritz, T.; Arita, M.;
Saito, K. &amp; Kusano, M.  Compensation for systematic
cross-contribution improves normalization of mass spectrometry
based metabolomics data Anal Chem, 2009, 81, 7974-7980
</p>


<h3>See Also</h3>

<p><code>normPred</code>, <code>standards</code>, <code>model.matrix</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(mix)
nfit &lt;- normFit(mix, "crmn", factors="type", ncomp=3)
slplot(sFit(nfit)$fit$pc, scol=as.integer(mix$runorder))
## same thing
Y &lt;- exprs(mix)
G &lt;- model.matrix(~-1+mix$type)
isIS &lt;- fData(mix)$tag == 'IS'
nfit &lt;- normFit(Y, "crmn", factors=G, ncomp=3, standards=isIS)
slplot(sFit(nfit)$fit$pc, scol=as.integer(mix$runorder))
</code></pre>


</div>