<div class="container">

<table style="width: 100%;"><tr>
<td>factor.analysis</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Factor analysis</h2>

<h3>Description</h3>

<p>The main function for factor analysis with potentially high dimensional variables.
Here we implement some recent algorithms that is optimized for the high dimensional problem where
the number of samples n is less than the number of variables p.
</p>


<h3>Usage</h3>

<pre><code class="language-R">factor.analysis(Y, r, method = c("ml", "pc", "esa"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>data matrix, a n*p matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>number of factors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>algorithm to be used</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The three methods are quasi-maximum likelihood (ml),
principal component analysis (pc),
and factor analysis using an early stopping criterion (esa).
</p>
<p>The ml is iteratively solved the Expectation-Maximization algorithm
using the PCA solution as the initial value.
See Bai and Li (2012) and for more details. For the esa method, see
Owen and Wang (2015) for more details.
</p>


<h3>Value</h3>

<p>a list of objects
</p>

<dl>
<dt>Gamma</dt>
<dd>
<p>estimated factor loadings</p>
</dd>
<dt>Z</dt>
<dd>
<p>estimated latent factors</p>
</dd>
<dt>Sigma</dt>
<dd>
<p>estimated noise variance matrix</p>
</dd>
</dl>
<h3>References</h3>


<p>Bai, J. and Li, K. (2012). Statistical analysis of factor models of high dimension. <em>The Annals of Statistics 40</em>, 436-465.
Owen, A. B. and Wang, J. (2015). Bi-cross-validation for factor analysis. <em>arXiv:1503.03515</em>.

</p>


<h3>See Also</h3>

<p><code>fa.pc</code>, <code>fa.em</code>, <code>ESA</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## a factor model
n &lt;- 100
p &lt;- 1000
r &lt;- 5
Z &lt;- matrix(rnorm(n * r), n, r)
Gamma &lt;- matrix(rnorm(p * r), p, r)
Y &lt;- Z %*% t(Gamma) + rnorm(n * p)

## to check the results, verify the true factors are in the linear span of the estimated factors.
pc.results &lt;- factor.analysis(Y, r = 5, "pc")
sapply(summary(lm(Z ~ pc.results$Z)), function(x) x$r.squared)

ml.results &lt;- factor.analysis(Y, r = 5, "ml")
sapply(summary(lm(Z ~ ml.results$Z)), function(x) x$r.squared)

esa.results &lt;- factor.analysis(Y, r = 5, "esa")
sapply(summary(lm(Z ~ esa.results$Z)), function(x) x$r.squared)

</code></pre>


</div>