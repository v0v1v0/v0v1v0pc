<div class="container">

<table style="width: 100%;"><tr>
<td>sysabs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Locate systematic absences</h2>

<h3>Description</h3>

<p>Given an mX3 matrix of Miller indices, this function returns
those indices corresponding to valid reflections, i.e. to
reflections which are not systematic absences.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sysabs(hkl, SG)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>hkl</code></td>
<td>
<p>An mX3 matrix or a data frame whose rows are the
three integers corresponding to the Miller
indices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SG</code></td>
<td>
<p>A character. The extended Hermann-Mauguin symbol
of the crystallographic space group.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Crystallography symmetry forces constraints on data from
x-ray diffraction. One of these constraints consists in the
full cancellation of reflections with certain Miller indices.
It is said that the reflection with that specific Miller index
is systematically absent. For example, in data corresponding
to a crystal with space group C 2, general reflections like
(h,k,l) must obey h+k=2n (even number). Thus, the Miller
indices (2,3,1) are a systematic absence because 2+3=5 (odd).
</p>


<h3>Value</h3>

<p>idx A vector of integers corresponding to the
position, in the array <code>mhkl</code>, in which the
Miller indices ARE NOT systematically absent.
The position of systematically-absent reflections
can be found using !idx.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># C 2 monoclinic space group (special setting)
csym &lt;- cryst_symm(15,set=5)
print(csym$SG)

# Create a full data frame of Miller indices
hkl &lt;- expand.grid(H=-4:4,K=-4:4,L=-4:4)

# Index corresponding to valid reflections
# (not systematic absences)
idx &lt;- sysabs(hkl,csym$SG)

# Indices for all reflections
fulldx &lt;- 1:length(hkl[,1])

# Index corresponding to systematic absences
jdx &lt;- fulldx[-idx]

# A couple of systematic absences
hkl[jdx[1:2],]

</code></pre>


</div>