<div class="container">

<table style="width: 100%;"><tr>
<td>caresid</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Correspondence Analysis plot with visualization of significant associations based on chi-square standardized residuals</h2>

<h3>Description</h3>

<p>Performs a Correspondence Analysis (CA) on a contingency table and creates a scatterplot
of the row and column points on the selected dimensions. Optionally, the function
can add segments to the plot to visualize significant associations between row and column
categories on the basis of positive (unadjusted) standardized residuals larger than a given threshold. The
segments can be optionally labelled with the corresponding residual value.<br>
Visit this <a href="https://drive.google.com/file/d/1Z3jhiNgVk7jjhlwnNgH9aspnZxlLe_km/view?usp=share_link">LINK</a> to access the package's vignette.<br></p>


<h3>Usage</h3>

<pre><code class="language-R">caresid(
  cross.tab,
  dim1 = 1,
  dim2 = 2,
  segments = FALSE,
  category = NULL,
  mult.comp = FALSE,
  label.residuals = FALSE,
  residual.label.size = 2,
  dot.size = 1,
  dot.label.size = 2.5,
  axis.label.size = 9,
  square = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cross.tab</code></td>
<td>
<p>A dataframe representing the input contingency table.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dim1</code></td>
<td>
<p>The first dimension to plot (default is 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dim2</code></td>
<td>
<p>The second dimension to plot (default is 2).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>segments</code></td>
<td>
<p>Logical. If TRUE, add segments to the plot to connect row to column
points (or viceversa) with positive standardized residuals larger than a given threshold
(default is FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>category</code></td>
<td>
<p>Character vector. If provided, only add segments from that/those row (or column) category(ies)
to the column (or row) categories where the corresponding standardised residuals are
positive and larger than a given threshold. If NULL (default) all the categories are considered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mult.comp</code></td>
<td>
<p>Logical. If TRUE, adjust the residuals' significance threshold for multiple comparisons using
Sidak's method (default is FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label.residuals</code></td>
<td>
<p>Logical. If TRUE, the value of the positive standardised residual will be shown as a label
at the midpoint of every segment (default is FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residual.label.size</code></td>
<td>
<p>Numeric. The size of the residuals' label (default is 2).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dot.size</code></td>
<td>
<p>Numeric. The size of the scatterplot's points (default is 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dot.label.size</code></td>
<td>
<p>Numeric. The size of the points' label (default is 2.5).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis.label.size</code></td>
<td>
<p>Numeric. The size of the axis labels (default is 9).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>square</code></td>
<td>
<p>Logical. If TRUE, set the ratio of y to x to 1 (default is FALSE).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If the <code>segment</code> argument is <code>FALSE</code> (default), a regular symmetric CA biplot is rendered.
</p>
<p>If the <code>segment</code> argument is <code>TRUE</code>, the function adds segments to the plot to connect
row and column points with positive (unadjusted) standardized residuals larger than a given threshold, indicating
a significant association. The threshold is 1.96 if <code>mult.comp</code> is <code>FALSE</code>, and is
adjusted for multiple comparisons if <code>mult.comp</code> is <code>TRUE</code>.
</p>
<p>In the latter case, the threshold for significant residuals is calculated using the Sidak's method.
It is based on an adjusted 0.05 alpha level which is calculated as <code>1-(1 - 0.05)^(1/(nr*nc))</code>,
where <code>nr</code> and <code>nc</code> are the number of rows and columns in the table respectively.
The adjusted alpha is then converted to a critical two-tailed z value (see Beasley-Schumacker 1995).<br></p>
<p>Please note, all the visualised associations (if any) are significant at least at alpha 0.05.<br></p>
<p>Optionally, the residual segments can be labelled with the corresponding residual value by setting
the <code>label.residuals</code> to <code>TRUE</code>.<br></p>
<p>The idea of connecting points in a CA plot based on the value of standardized residuals can serve
to visually highlight certain associations in your data. However, please note that while this function can help
visualize the associations in the contingency table, it does not replace other formal approaches for the
interpretation of the CA scatterplot and formal statistical tests for assessing the
significance and strength of the association.
</p>


<h3>Value</h3>

<p>A list with two elements: </p>

<ul>
<li>
<p><code>stand.residuals</code> contains the unadjusted standardized residuals for all cells.
</p>
</li>
<li>
<p><code>resid.sign.thres</code> contains the threshold used to determine significant residuals.
</p>
</li>
</ul>
<h3>References</h3>

<p>Beasley TM and Schumacker RE (1995), Multiple Regression Approach to Analyzing
Contingency Tables: Post Hoc and Planned Comparison Procedures,
The Journal of Experimental Education, 64(1): 86, 89.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Create a toy dataset (famous Eye-color Hair-color dataset)

mytable &lt;- structure(list(BLACK_H = c(68, 20, 15, 5),
BROWN_H = c(119, 84, 54, 29),
RED_H = c(26, 17, 14, 14),
BLOND_H = c(7, 94, 10, 16)),
class = "data.frame",
row.names = c("Brown_E", "Blue_E", "Hazel_E", "Green_E"))

# EXAMPLE 1
# Run the function:

result &lt;- caresid(mytable, segments=TRUE)


# EXAMPLE 2
# As above, but adjusting for multiple comparisons:

result &lt;- caresid(mytable, segments=TRUE, mult.comp=TRUE)


# EXAMPLE 3
# As in the first example, but selecting only 2 row categories;
# residual labels are shown:

result &lt;- caresid(mytable, segments=TRUE, category=c("Brown_E", "Green_E"), label.residuals=TRUE)


</code></pre>


</div>