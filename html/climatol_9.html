<div class="container">

<table style="width: 100%;"><tr>
<td>dahgrid</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Interpolation of normalized homogeneous data on a predefined grid</h2>

<h3>Description</h3>

<p>Homogenized data generated by <code>homogen</code> are normalized and
interpolated on a grid provided by the user at every time step, and saved
into a NetCDF file.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dahgrid(varcli, anyi, anyf, anyip=anyi, anyfp=anyf, grid, idp=2.0,
obsonly=TRUE, nmax=Inf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>varcli</code></td>
<td>
<p>Short name of the studied climatic variable, as in the data
file name.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>anyi</code></td>
<td>
<p>Initial year of the homogenized data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>anyf</code></td>
<td>
<p>Final year of the homogenized data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>anyip</code></td>
<td>
<p>First year of the desired reference period. (The reference period defaults to the whole period of the data).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>anyfp</code></td>
<td>
<p>Last year of the desired reference period.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>Grid on which interpolations must be performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>idp</code></td>
<td>
<p>Power of the inverse distance weights (2 by default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obsonly</code></td>
<td>
<p>Do not interpolate estimated missing data. (<code>TRUE</code> by
default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nmax</code></td>
<td>
<p>Maximum number of nearest stations to use (all by default).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Homogenized data are read from the binary file ‘<span class="file">VRB_ANYI-ANYF.rda</span>’
generated by <code>homogen</code>. Only series reconstructed from their
longest homogeneous sub-period are retained, and they are normalized by their
means (and standard deviations, if <code>std=3</code>), computed for the selected
reference period (or for the whole period of the data, by default).
</p>
<p>Unless <code>obsonly</code> is set to <code>FALSE</code>, data that were missing in the
observed series are deleted to avoid interpolation of already interpolated
data.
</p>
<p>Finally, the normalized homogeneous data are interpolated on the predefined
grid for every time step using an inverse distance weight method, and the
resulting grids are stored in a NetCDF file named ‘<span class="file">VRB_ANYIP-ANYFP.nc</span>’,
including grids of the reference means (and standard deviations, if applied).
</p>
<p>The user must provide the grid as an object of class SpatialPixel, as in this
example defining a grid from 40N,3E to 43N,7E with a resolution of 0.1
degrees:
</p>
<p><code>grid &lt;- expand.grid(x=seq(3,7,.1),y=seq(40,43,.1))</code><br><code>library(sp)</code><br><code>coordinates(grid) &lt;- ~ x+y</code>
</p>
<p>The resolution of this grid need not be too high, but adjusted to the spatial
density of the available series. However, a higher resolution will produce
smoother maps when plotted.
</p>
<p>The user may be more interested in obtaining grids of absolute values, rather
than normalized. This can be achieved simply by undoing the normalization on
the grids with the help of the provided grids of reference means and standard
deviations. However, the resulting grids will only be the product of a
geometrical interpolation, and will not reflect the influence of orography
and other physiographic effects on the studied climatic variable. Therefore,
it is more advisable to derive better reference grids of means (and standard
deviations, if needed) by applying a geostatistical model to the reference
means (provided in the file ‘<span class="file">VRB_ANYIP-ANYFP_means.csv</span>’ with their
corresponding coordinates).
</p>
<p>This better quality climatic maps will probably have a higher resolution than
that of the grids of the NetCDF file provided by this function. In that case,
these normalized grids must be interpolated to the grid of the
geostatistically derived climatic maps before undoing the normalization to
obtain the final maps of absolute values at all or selected time-steps of the
studied period.
</p>


<h3>See Also</h3>

<p><code>homogen</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## Set a temporal working directory and write input files:
wd &lt;- tempdir()
wd0 &lt;- setwd(wd)

## Copy an example file of homogenization results:
file.copy(exampleFiles('Temp_1991-2000.rda'),'.')

## Now run the example:
## (very coarse grid (3x2 points) to run in less than the 10 seconds CRAN limit)
grd &lt;- expand.grid(x=seq(-2.8,-2.4,.2),y=seq(38.86,39.06,.2))
sp::coordinates(grd) &lt;- ~ x+y
dahgrid('Temp',1991,2000,grid=grd)

## Return to user's working directory:
setwd(wd0)

## Input and output files can be found in directory:
print(wd)
</code></pre>


</div>