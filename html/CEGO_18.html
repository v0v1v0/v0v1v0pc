<div class="container">

<table style="width: 100%;"><tr>
<td>correctionKernelMatrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Correction of a Kernel (Correlation) Matrix</h2>

<h3>Description</h3>

<p>Convert a non-PSD kernel matrix with chosen approach so that it becomes a PSD matrix.
Optionally, the resulting matrix is enforced to have values between -1 and 1 and a diagonal of 1s, with the <code>repair</code> parameter.
That means, it is (optionally) converted to a valid correlation matrix.
Essentially, this is a combination of <code>correctionDefinite</code> with <code>repairConditionsCorrelationMatrix</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">correctionKernelMatrix(mat, method = "flip", repair = TRUE, tol = 1e-08)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mat</code></td>
<td>
<p>symmetric kernel matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>string that specifies method for correction: spectrum clip <code>"clip"</code>, spectrum flip <code>"flip"</code>, nearest definite matrix <code>"near"</code>, spectrum square<code>"square"</code>, spectrum diffusion <code>"diffusion"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>repair</code></td>
<td>
<p>boolean, whether or not to use condition repair, so that elements between -1 and 1, and the diagonal values are 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>torelance value. Eigenvalues between <code>-tol</code> and <code>tol</code> are assumed to be zero.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>list with corrected kernel matrix <code>mat</code>, <code>isPSD</code> (boolean, whether original matrix was PSD), transformation matrix <code>A</code>,
the matrix of eigenvectors (<code>U</code>) and the transformation vector (<code>a</code>)
</p>


<h3>References</h3>

<p>Martin Zaefferer and Thomas Bartz-Beielstein. (2016). Efficient Global Optimization with Indefinite Kernels. Parallel Problem Solving from Nature-PPSN XIV. Accepted, in press. Springer.
</p>


<h3>See Also</h3>

<p><code>correctionDefinite</code>, <code>repairConditionsCorrelationMatrix</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">x &lt;- list(c(2,1,4,3),c(2,4,3,1),c(4,2,1,3),c(4,3,2,1),c(1,4,3,2))
D &lt;- distanceMatrix(x,distancePermutationInsert)
K &lt;- exp(-0.01*D)
is.PSD(K) #matrix should not be PSD
K &lt;- correctionKernelMatrix(K)$mat
is.PSD(K) #matrix should now be CNSD
K
</code></pre>


</div>