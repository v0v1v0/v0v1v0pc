<div class="container">

<table style="width: 100%;"><tr>
<td>WBS.univar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Wild binary segmentation for univariate mean change points detection.</h2>

<h3>Description</h3>

<p>Perform wild binary segmentation for univariate mean change points detection.
</p>


<h3>Usage</h3>

<pre><code class="language-R">WBS.univar(y, s, e, Alpha, Beta, delta = 2, level = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A <code>numeric</code> vector of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>A <code>integer</code> scalar of starting index.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>e</code></td>
<td>
<p>A <code>integer</code> scalar of ending index.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Alpha</code></td>
<td>
<p>A <code>integer</code> vector of starting indices of random intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Beta</code></td>
<td>
<p>A <code>integer</code> vector of ending indices of random intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>A positive <code>integer</code> scalar of minimum spacing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>Should be fixed as 0.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of <code>class</code> "BS", which is a <code>list</code> with the following structure:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>A vector of estimated change point locations (sorted in strictly increasing order).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Dval</code></td>
<td>
<p>A vector of values of CUSUM statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Level</code></td>
<td>
<p>A vector representing the levels at which each change point is detected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Parent</code></td>
<td>
<p>A matrix with the starting indices on the first row and the ending indices on the second row.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Haotian Xu
</p>


<h3>References</h3>

<p>Wang, Yu and Rinaldo (2020) &lt;doi:10.1214/20-EJS1710&gt;.
</p>


<h3>See Also</h3>

<p><code>thresholdBS</code> for obtaining change points estimation, <code>tuneBSunivar</code> for a tuning version.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(0)
cpt_true = c(20, 50, 170)
y = rnorm(300) + c(rep(0,20),rep(2,30),rep(0,120),rep(2,130))
intervals = WBS.intervals(M = 300, lower = 1, upper = length(y))
temp = WBS.univar(y, 1, length(y), intervals$Alpha, intervals$Beta, delta = 5)
plot.ts(y)
points(x = tail(temp$S[order(temp$Dval)],4),
       y = y[tail(temp$S[order(temp$Dval)],4)], col = "red")
WBS_result = thresholdBS(temp, tau = 4)
print(WBS_result$BS_tree, "value")
plot(WBS_result$BS_tree)
print(WBS_result$BS_tree_trimmed, "value")
plot(WBS_result$BS_tree_trimmed)
cpt_hat = sort(WBS_result$cpt_hat[,1]) # the threshold tau is specified to be 4
Hausdorff.dist(cpt_hat, cpt_true)
cpt_LR = local.refine.univar(cpt_hat, y)
Hausdorff.dist(cpt_LR, cpt_true)
</code></pre>


</div>