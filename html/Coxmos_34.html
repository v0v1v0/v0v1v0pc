<div class="container">

<table style="width: 100%;"><tr>
<td>getTestKM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>getTestKM</h2>

<h3>Description</h3>

<p>This function computes and visualizes the Kaplan-Meier survival curve for a given
test dataset, utilizing the cutoff derived from the original model. The function offers
flexibility in terms of the type of Kaplan-Meier estimation, whether it's based on the linear
predictor, PLS components, or original variables.
</p>


<h3>Usage</h3>

<pre><code class="language-R">getTestKM(
  model,
  X_test,
  Y_test,
  cutoff,
  type = "LP",
  ori_data = TRUE,
  BREAKTIME = NULL,
  n.breaks = 20,
  title = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Coxmos model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X_test</code></td>
<td>
<p>Numeric matrix or data.frame. Explanatory variables for test data (raw format).
Qualitative variables must be transform into binary variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y_test</code></td>
<td>
<p>Numeric matrix or data.frame. Response variables for test data. Object must have two
columns named as "time" and "event". For event column, accepted values are: 0/1 or FALSE/TRUE for
censored and event observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p>Numeric. Cutoff value to split the observations into two groups. Recommended to
compute optimal cutoff value with getAutoKM() function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Character. Kaplan Meier for complete model linear predictor ("LP"), for PLS components
("COMP") or for original variables ("VAR") (default: LP).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ori_data</code></td>
<td>
<p>Logical. Compute the Kaplan-Meier plot with the raw-data or the normalize-data to
compute the best cut-point for splitting the data into two groups. Only used when type = "VAR"
(default: TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BREAKTIME</code></td>
<td>
<p>Numeric. Size of time to split the data into "total_time / BREAKTIME + 1" points.
If BREAKTIME = NULL, "n.breaks" is used (default: NULL).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.breaks</code></td>
<td>
<p>Numeric. If BREAKTIME is NULL, "n.breaks" is the number of time-break points to
compute (default: 20).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>Character. Kaplan-Meier plot title (default: NULL).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>getTestKM</code> function is designed to evaluate the survival probabilities of a test dataset
based on a pre-trained Coxmos model. The function ensures that the test times are consistent with
the training times. Depending on the specified <code>type</code>, the function can compute the Kaplan-Meier
curve using:
</p>

<ul>
<li>
<p> The complete model's linear predictor (<code>LP</code>).
</p>
</li>
<li>
<p> The PLS components (<code>COMP</code>).
</p>
</li>
<li>
<p> The original variables (<code>VAR</code>).
</p>
</li>
</ul>
<p>For the <code>LP</code> type, the function predicts scores for the <code>X_test</code> and subsequently predicts the
linear predictor using these scores. For the <code>COMP</code> type, the function predicts scores for each
component in the model and computes the Kaplan-Meier curve for each. For the <code>VAR</code> type, the
function computes the Kaplan-Meier curve for each variable in the test dataset.
</p>
<p>The function also provides the flexibility to compute the Kaplan-Meier plot using raw data or
normalized data, which can be useful for determining the optimal cut-point for data segmentation.
The time intervals for the Kaplan-Meier estimation can be defined using either the <code>BREAKTIME</code> or
<code>n.breaks</code> parameters.
</p>
<p>The resulting Kaplan-Meier plot provides a visual representation of the survival probabilities
over time, segmented based on the specified cutoff. This allows for a comprehensive evaluation of
the test dataset's survival characteristics in the context of the original model.
</p>


<h3>Value</h3>

<p>Depending on the specified <code>type</code> parameter, the function returns:
</p>

<ul>
<li> <p><code>LP</code>: A ggplot object visualizing the Kaplan-Meier survival curve based on the linear predictor, segmented by the specified cutoff.
</p>
</li>
<li> <p><code>COMP</code>: A list of ggplot objects, where each plot represents the Kaplan-Meier survival curve for a specific PLS component in the model, segmented by the respective cutoffs.
</p>
</li>
<li> <p><code>VAR</code>: A list of ggplot objects, where each plot visualizes the Kaplan-Meier survival curve for a specific variable in the test dataset, segmented by the respective cutoffs.
</p>
</li>
</ul>
<p>Each plot provides a visual representation of the survival probabilities over time, allowing for a comprehensive evaluation of the test dataset's survival characteristics in the context of the original model.
</p>


<h3>Author(s)</h3>

<p>Pedro Salguero Garcia. Maintainer: pedsalga@upv.edu.es
</p>


<h3>References</h3>

<p>Kaplan EL, Kaplan EL, Meier P (1958).
“Nonparametric Estimation from Incomplete Observations.”
<em>Journal of the American Statistical Association</em>.
<a href="https://doi.org/10.1007/978-1-4612-4380-9_25">doi:10.1007/978-1-4612-4380-9_25</a>, <a href="https://link.springer.com/chapter/10.1007/978-1-4612-4380-9_25">https://link.springer.com/chapter/10.1007/978-1-4612-4380-9_25</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("X_proteomic")
data("Y_proteomic")
set.seed(123)
index_train &lt;- caret::createDataPartition(Y_proteomic$event, p = .5, list = FALSE, times = 1)
X_train &lt;- X_proteomic[index_train,1:50]
Y_train &lt;- Y_proteomic[index_train,]
X_test &lt;- X_proteomic[-index_train,1:50]
Y_test &lt;- Y_proteomic[-index_train,]
splsicox.model &lt;- splsicox(X_train, Y_train, n.comp = 2, penalty = 0.5, x.center = TRUE,
x.scale = TRUE)
KMresult = getAutoKM(type = "LP", model = splsicox.model)
cutoff &lt;- getCutoffAutoKM(result = KMresult)
getTestKM(splsicox.model, X_test, Y_test, cutoff)
</code></pre>


</div>