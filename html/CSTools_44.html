<div class="container">

<table style="width: 100%;"><tr>
<td>EnsClustering</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Ensemble clustering</h2>

<h3>Description</h3>

<p>This function performs a clustering on members/starting dates
and returns a number of scenarios, with representative members for each of 
them. The clustering is performed in a reduced EOF space.
</p>


<h3>Usage</h3>

<pre><code class="language-R">EnsClustering(
  data,
  lat,
  lon,
  time_moment = "mean",
  numclus = NULL,
  lon_lim = NULL,
  lat_lim = NULL,
  variance_explained = 80,
  numpcs = NULL,
  time_percentile = 90,
  time_dim = NULL,
  cluster_dim = "member",
  verbose = T
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A matrix of dimensions 'dataset member sdate ftime lat lon' 
containing the variables to be analysed. Latitudinal dimension accepted 
names: 'lat', 'lats', 'latitude', 'y', 'j', 'nav_lat'. Longitudinal 
dimension accepted names: 'lon', 'lons','longitude', 'x', 'i', 'nav_lon'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lat</code></td>
<td>
<p>Vector of latitudes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lon</code></td>
<td>
<p>Vector of longitudes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time_moment</code></td>
<td>
<p>Decides the moment to be applied to the time dimension. Can 
be either 'mean' (time mean), 'sd' (standard deviation along time) or 'perc' 
(a selected percentile on time). If 'perc' the keyword 'time_percentile' is 
also used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numclus</code></td>
<td>
<p>Number of clusters (scenarios) to be calculated. If set to NULL
the number of ensemble members divided by 10 is used, with a minimum of 2 
and a maximum of 8.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lon_lim</code></td>
<td>
<p>List with the two longitude margins in 'c(-180,180)' format.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lat_lim</code></td>
<td>
<p>List with the two latitude margins.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variance_explained</code></td>
<td>
<p>variance (percentage) to be explained by the set of 
EOFs. Defaults to 80. Not used if numpcs is specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numpcs</code></td>
<td>
<p>Number of EOFs retained in the analysis (optional).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time_percentile</code></td>
<td>
<p>Set the percentile in time you want to analyse (used 
for 'time_moment = "perc").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time_dim</code></td>
<td>
<p>String or character array with name(s) of dimension(s) over 
which to compute statistics. If omitted c("ftime", "sdate", "time") are 
searched in this order.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster_dim</code></td>
<td>
<p>Dimension along which to cluster. Typically "member" or 
"sdate". This can also be a list like c("member", "sdate").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical for verbose output</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with elements <code>$cluster</code> (cluster assigned for each member),
<code>$freq</code> (relative frequency of each cluster), <code>$closest_member</code>
(representative member for each cluster), <code>$repr_field</code> (list of fields for
each representative member), <code>composites</code> (list of mean fields for each 
cluster), <code>$lon</code> (selected longitudes of output fields), <code>$lat</code> 
(selected longitudes of output fields).
</p>


<h3>Author(s)</h3>

<p>Federico Fabiano - ISAC-CNR, <a href="mailto:f.fabiano@isac.cnr.it">f.fabiano@isac.cnr.it</a>
</p>
<p>Ignazio Giuntoli - ISAC-CNR, <a href="mailto:i.giuntoli@isac.cnr.it">i.giuntoli@isac.cnr.it</a>
</p>
<p>Danila Volpi - ISAC-CNR, <a href="mailto:d.volpi@isac.cnr.it">d.volpi@isac.cnr.it</a>
</p>
<p>Paolo Davini - ISAC-CNR, <a href="mailto:p.davini@isac.cnr.it">p.davini@isac.cnr.it</a>
</p>
<p>Jost von Hardenberg - ISAC-CNR, <a href="mailto:j.vonhardenberg@isac.cnr.it">j.vonhardenberg@isac.cnr.it</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">exp &lt;- array(abs(rnorm(1152))*275, dim = c(dataset = 1, member = 4, 
                                          sdate = 6, ftime = 3, 
                                          lat = 4, lon = 4))
lon &lt;- seq(0, 3)
lat &lt;- seq(48, 45)
res &lt;- EnsClustering(exp, lat = lat, lon = lon, numclus = 2,
                    cluster_dim = c("member", "dataset", "sdate"))

</code></pre>


</div>