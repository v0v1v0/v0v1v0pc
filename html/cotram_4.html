<div class="container">

<table style="width: 100%;"><tr>
<td>cotram</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Count Transformation Models
</h2>

<h3>Description</h3>

<p>Likelihood-based count transformation models for fully parameterised discrete conditional
distribution functions. The link function governing the interpretation of the predictor 
can be chosen and results in discrete hazard ratios, odds ratios, reverse time
hazard ratios or conditional expectation of transformed counts.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cotram(formula, data, method = c("logit", "cloglog", "loglog", "probit"),
       log_first = TRUE, prob = 0.9, subset, weights, offset, cluster,
       na.action = na.omit, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class <code>"formula"</code>: a symbolic description 
of the model structure to be fitted.  The details of model
specification are given under <code>tram</code> and in the package vignette.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame, list or environment (or object
coercible by <code>as.data.frame</code> to a data frame) containing the
variables in the model.  If not found in <code>data</code>, the
variables are taken from <code>environment(formula)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>character specifying the choice of the link function,
mapping the transformation function into probabilities. Available choices
include the logit, complementary log-log, log-log or probit link. 
The different link functions govern the interpretation of the linear
predictor. Details of the interpretation can be found in the 
package vignette.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>probability giving the quantile of the response defining the upper
limit of the support of a smooth Bernstein polynomial (with the lower limit
being set to 0). If a vector of two probabilites is specified, the corresponding
quantiles of the response define the lower and upper limit of the support, 
respectively. Note, that the support is rounded to integer values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log_first</code></td>
<td>
<p>logical; if <code>TRUE</code>, a Bernstein polynomial is
defined on the log-scale for (y + 1).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be
used in the fitting process.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>an optional vector of weights to be used in the fitting
process.  Should be <code>NULL</code> or a numeric vector. If present,
the weighted log-likelihood is maximised.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>this can be used to specify an _a priori_ known component to
be included in the linear predictor during fitting.  This
should be <code>NULL</code> or a numeric vector of length equal to the
number of cases.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>optional factor with a cluster ID employed for computing
clustered covariances.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function which indicates what should happen when the data
contain <code>NA</code>s.  The default is set to <code>na.omit</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to <code>tram</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Likelihood-based estimation of a fully parameterised conditional discrete
distribution function for count data, while ensuring interpretability of
the linear predictors. The models are defined with a negative shift term 
relating positive predictors to larger values of the conditional mean. 
For the model with logistic or cloglog link <code>exp(-coef())</code>
is the multiplicative change of discrete odds-ratios or hazard ratios. For 
the model with loglog link <code>exp(coef())</code> is the multiplicative change of
the reverse time hazard ratios. Applying a transformation model with probit link
<code>coef()</code> gives the conditional expectation of the transformed counts,
with transformation function estimated from data.
</p>


<h3>Value</h3>

<p>An object of class <code>cotram</code> and <code>tram</code>, with corresponding <code>coef</code>,
<code>vcov</code>, <code>logLik</code>, <code>summary</code>, 
<code>print</code>, <code>plot</code> and <code>predict</code> methods.
</p>


<h3>References</h3>

<p>Sandra Siegfried, Torsten Hothorn (2020), Count Transformation Models,
<em>Methods in Ecology and Evolution</em>, <b>11</b>(7), 818–827,
<a href="https://doi.org/10.1111/2041-210X.13383">doi:10.1111/2041-210X.13383</a>.
</p>
<p>Torsten Hothorn, Lisa Möst, Peter Bühlmann (2018), Most Likely
Transformations, <em>Scandinavian Journal of Statistics</em>, <b>45</b>(1),
110–134, <a href="https://doi.org/10.1111/sjos.12291">doi:10.1111/sjos.12291</a>.
</p>
<p>Torsten Hothorn (2020), Most Likely Transformations: The mlt Package, 
<em>Journal of Statistical Software</em>, <b>92</b>(1), 1–68,
<a href="https://doi.org/10.18637/jss.v092.i01">doi:10.18637/jss.v092.i01</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
  op &lt;- options(digits = 2)

  data("birds", package = "TH.data")
  cotram(SG5 ~ AOT + AFS + GST + DBH + DWC + LOG, data = birds)

  options(op)

</code></pre>


</div>