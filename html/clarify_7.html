<div class="container">

<table style="width: 100%;"><tr>
<td>plot.clarify_est</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plotting and inference for <code>clarify_est</code> objects</h2>

<h3>Description</h3>

<p><code>summary()</code> tabulates the estimates and confidence intervals and (optionally) p-values from a <code>clarify_est</code> object. <code>confint()</code> computes confidence intervals. <code>plot()</code> plots the "posterior" distribution of estimates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'clarify_est'
plot(
  x,
  parm,
  ci = TRUE,
  level = 0.95,
  method = "quantile",
  reference = FALSE,
  ncol = 3,
  ...
)

## S3 method for class 'clarify_est'
summary(object, parm, level = 0.95, method = "quantile", null = NA, ...)

## S3 method for class 'clarify_est'
confint(object, parm, level = 0.95, method = "quantile", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>parm</code></td>
<td>
<p>a vector of the names or indices of the estimates to plot. If unspecified, all estimates will be displayed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>
<p><code>logical</code>; whether to display confidence interval limits for the estimates. Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>the confidence level desired. Default is .95 for 95% confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the method used to compute p-values and confidence intervals. Can be <code>"wald"</code> to use a Normal approximation or <code>"quantile"</code> to use the simulated sampling distribution (default). See Details. Abbreviations allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reference</code></td>
<td>
<p><code>logical</code>; whether to overlay a normal density reference distribution over the plots. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncol</code></td>
<td>
<p>the number of columns used when wrapping multiple plots; default is 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>for <code>plot()</code>, further arguments passed to <code>ggplot2::geom_density()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object, x</code></td>
<td>
<p>a <code>clarify_est</code> object; the output of a call to <code>sim_apply()</code> or its wrappers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null</code></td>
<td>
<p>the values of the parameters under the null hypothesis for the p-value calculations. Should have length equal to the number of quantities estimated, or one, in which case it will be recycled, or it can be a named vector with just the names of quantities for which null values are to be set. Set values to <code>NA</code> to omit p-values for those quantities. When all values are <code>NA</code>, the default, no p-values are produced.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>summary()</code> uses the estimates computed from the original model as its estimates and uses the simulated parameters for inference only, in line with the recommendations of Rainey (2023).
</p>
<p>When <code>method = "wald"</code>, the standard deviation of the simulation estimates is used as the standard error, which is used in the z-statistics and the confidence intervals. The p-values and confidence intervals are valid only when the sampling distribution of the resulting statistic is normal (which can be assessed using <code>plot()</code>). When <code>method = "quantile"</code>, the confidence interval is calculated using the quantiles of the simulation estimates corresponding to <code>level</code>, and the p-value is calculated as twice the proportion of simulation estimates less than or greater than <code>null</code>, whichever is smaller; this is equivalent to inverting the confidence interval but is only truly valid when the true sampling distribution is only a location shift from the sampling distribution under the null hypothesis and should therefore be interpreted with caution. Using <code style="white-space: pre;">⁠"method = "quantile"⁠</code> (the default) is recommended because the confidence intervals will be valid even if the sampling distribution is not Normally distributed. The precision of the p-values and confidence intervals depends on the number of simulations requested (the value of <code>n</code> supplied to <code>sim()</code>).
</p>
<p>The plots are produced using <code>ggplot2::geom_density()</code> and can be customized with <span class="pkg">ggplot2</span> functions. When <code>reference = TRUE</code>, a reference Normal distribution is produced using the empirical mean and standard deviation of the simulated values. A blue references line is plotted at the median of the simulated values. For Wald-based inference to be valid, the reference distribution should overlap with the empirical distribution, in which case the quantile-based and Wald-based intervals should be similar. For quantile-based inference to be valid, the median of the estimates should overlap with the estimated value; this is a necessary but not sufficient condition, though.
</p>


<h3>Value</h3>

<p>For <code>summary()</code>, a <code>summary.clarify_est</code> object, which is a matrix containing the coefficient estimates, standard errors, test statistics, p-values, and confidence intervals. Not all columns will be present depending on the arguments supplied to <code>summary()</code>.
</p>
<p>For <code>confint()</code>, a matrix containing the confidence intervals for the requested quantities.
</p>
<p>For <code>plot()</code>, a <code>ggplot</code> object.
</p>


<h3>References</h3>

<p>Rainey, C. (2023). A careful consideration of CLARIFY: Simulation-induced bias in point estimates of quantities of interest. <em>Political Science Research and Methods</em>, 1–10. <a href="https://doi.org/10.1017/psrm.2023.8">doi:10.1017/psrm.2023.8</a>
</p>


<h3>See Also</h3>


<ul><li> <p><code>sim_apply()</code> for applying a function to each set of simulated coefficients
</p>
</li></ul>
<h3>Examples</h3>

<pre><code class="language-R">data("lalonde", package = "MatchIt")
fit &lt;- glm(I(re78 &gt; 0) ~ treat + age + race + nodegree + re74,
          data = lalonde)

s &lt;- sim(fit, n = 100)

# Compute average marginal means for `treat`
est &lt;- sim_ame(s, var = "treat", verbose = FALSE)
coef(est)

# Compute average marginal effects on risk difference
# (RD) and risk ratio (RR) scale
est &lt;- transform(est,
                 RD = `E[Y(1)]` - `E[Y(0)]`,
                 RR = `E[Y(1)]` / `E[Y(0)]`)

# Compute confidence intervals and p-values,
# using given null values for computing p-values
summary(est, null = c(`RD` = 0, `RR` = 1))

# Same tests using normal approximation and alternate
# syntax for `null`
summary(est, null = c(NA, NA, 0, 1),
        normal = TRUE)

# Plot the RD and RR with a reference distribution
plot(est, parm = c("RD", "RR"), reference = TRUE,
     ci = FALSE)

# Plot the RD and RR with quantile confidence bounds
plot(est, parm = c("RD", "RR"), ci = TRUE)

</code></pre>


</div>