<div class="container">

<table style="width: 100%;"><tr>
<td>psepolar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Pseudo-Polar Representation of Bivariate Data</h2>

<h3>Description</h3>

<p>Kiriliouk <em>et al.</em> (2016, pp. 358–360) describe a <em>pseudo-polar</em> representation of bivariate data as a means to explore right-tail extremal dependency between the variables. Let <code class="reqn">(X_i, Y_i)</code> (real values) or <code class="reqn">(U_i, V_i)</code> (as probabilities) for <code class="reqn">i = 1, \ldots, n</code> be a bivariate sample of size <code class="reqn">n</code>. When such data are transformed into a “unit-Pareto” scale by
</p>
<p style="text-align: center;"><code class="reqn">\widehat{X}^\star_i = n/(n+1-R_{X,i}) \mbox{\ and\ } \widehat{Y}^\star_i = n/(n+1-R_{Y,i})\mbox{,}</code>
</p>

<p>where <code class="reqn">R</code> is <code>rank()</code>, then letting each <em>component sum</em> or <em>pseudo-polar radius</em> be defined as
</p>
<p style="text-align: center;"><code class="reqn">\widehat{S}_i = \widehat{X}^\star_i + \widehat{Y}^\star_i\mbox{,}</code>
</p>

<p>and each respective <em>pseudo-polar angle</em> be defined as 
</p>
<p style="text-align: center;"><code class="reqn">\widehat{W}_i = \widehat{X}^\star_i / (\widehat{X}^\star_i + \widehat{Y}^\star_i) = \widehat{X}^\star_i / \widehat{S}_i\mbox{,}</code>
</p>

<p>a pseudo-polar representation is available for study.
</p>
<p>A scatter plot of <code class="reqn">\widehat{W}_i</code> (horizontal) versus <code class="reqn">\widehat{S}_i</code> (vertical) will depict a <em>pseudo-polar plot</em> of the data. Kiriliouk <em>et al.</em> (2016) approach the pseudo-polar concept as a means to study extremal dependency in the sense of what are the contributions of the <code class="reqn">X</code> and <code class="reqn">Y</code> to their sum conditional on the sum being large. The <em>largeness</em> of <code class="reqn">\widehat{S}_i</code> is assessed by its empirical cumulative distribution function and a threshold <code class="reqn">S_f</code> stemming from <code class="reqn">f</code> as a nonexceedance probability <code class="reqn">f \in [0,1]</code>.
</p>
<p>A density plot of the <code class="reqn">\widehat{W}_i</code> is a representation of extremal dependence. If the density plot shows low density for pseudo-polar angles away from 0 and 1 or bimodality on the edges then weak extremal dependency is present. If the density is substantial and uniform away from the the angles 0 and 1 or if the density peaks near <code class="reqn">\widehat{W} \approx 0.5</code> then extremal dependency is strong.
</p>


<h3>Usage</h3>

<pre><code class="language-R">psepolar(u, v=NULL, f=0.90, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>Nonexceedance probability <code class="reqn">u</code> in the <code class="reqn">X</code> direction (actually the ranks are used so this can be a real-value argument as well);</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>Nonexceedance probability <code class="reqn">v</code> in the <code class="reqn">Y</code> direction  (actually the ranks are used so this can be a real-value argument as well) and if <code>NULL</code> then <code>u</code> is treated as a two column <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> <code>data.frame</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>The nonexceedance probability of the distal <code class="reqn">\widehat{S}</code> to flag in <code>Shat_ge_Sf</code> column of the output; and</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to pass to the <code>dat2bernqua()</code> function of the <span class="pkg">lmomco</span> package.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> <code>data.frame</code> is returned in the <code>table</code> element and the <code class="reqn">S_f</code> is in the <code>Sf</code> element.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>U</code></td>
<td>
<p>An echo of the <code>u</code> input;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p>An echo of the <code>v</code> input;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xstar</code></td>
<td>
<p>The <code class="reqn">\widehat{X}^\star_i</code> (Kiriliouk <em>et al.</em>, 2016, eq. 17.8, p. 359);</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ystar</code></td>
<td>
<p>The <code class="reqn">\widehat{Y}^\star_i</code> (Kiriliouk <em>et al.</em>, 2016, eq. 17.8, p. 359);</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FXhat1</code></td>
<td>
<p>The <code class="reqn">F_{X,i} = 1 - 1/X^\star_i</code>, which is the inverse of Kiriliouk <em>et al.</em> (2016, eq. 17.1, p. 354);</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FYhat1</code></td>
<td>
<p>The <code class="reqn">F_{Y,i} = 1 - 1/Y^\star_i</code>, which is the inverse of Kiriliouk <em>et al.</em> (2016, eq. 17.1, p. 354);</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FXhat3</code></td>
<td>
<p>The <code class="reqn">F_{3,X,i} = (R_{X,i} - 0.5)/n</code> corresponding to the “3” alternative identified by Kiriliouk <em>et al.</em> (2016, p. 365);</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FYhat3</code></td>
<td>
<p>The <code class="reqn">F_{3,Y,i} = (R_{Y,i} - 0.5)/n</code> corresponding to the “3” alternative identified by Kiriliouk <em>et al.</em> (2016, p. 365);</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>What</code></td>
<td>
<p>The <code class="reqn">\widehat{W}_i</code> (Kiriliouk <em>et al.</em>, 2016, eq. 17.9, p. 359);</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Shat</code></td>
<td>
<p>The <code class="reqn">\widehat{S}_i</code> (Kiriliouk <em>et al.</em>, 2016, eq. 17.9, p. 359); and</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Shat_ge_Sf</code></td>
<td>
<p>A logical on whether the <code class="reqn">\widehat{S}_i</code> are larger than <code class="reqn">S_f</code>.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The default of <code>f=0.90</code> means that the upper 90th percentile of the component sum will be identified in the output. This percentile is computed by the Bernstein empirical distribution function provided by the <span class="pkg">lmomco</span> package through the <code>dat2bernqua()</code> function. Suggested arguments for <code>...</code> are <code>poly.type="Bernstein"</code> and <code>bound.type="Carv"</code> though the former is redundant because it is the default of <code>dat2bernqua()</code>.
</p>


<h3>Author(s)</h3>

<p>William Asquith <a href="mailto:william.asquith@ttu.edu">william.asquith@ttu.edu</a></p>


<h3>References</h3>

<p>Kiriliouk, Anna, Segers, Johan, Warchoł, Michał, 2016, Nonparameteric estimation of extremal dependence: <em>in</em> Extreme Value Modeling and Risk Analysis, D.K. Dey and Jun Yan <em>eds.</em>, Boca Raton, FL, CRC Press, ISBN 978–1–4987–0129–7.
</p>


<h3>See Also</h3>

<p><code>spectralmeas</code>, <code>stabtaildepf</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
pse &lt;- psepolar(simCOP(n=799, cop=PARETOcop, para=4.3,graphics=FALSE),bound.type="Carv")
pse &lt;- pse$table # The Pareto copula has right-tail extreme dependency
plot(1/(1-pse$U), 1/(1-pse$V), col=pse$Shat_ge_Sf+1, lwd=0.8, cex=0.5, log="xy", pch=16)
plot(pse$What, pse$Shat, log="y", col=pse$Shat_ge_Sf+1, lwd=0.8, cex=0.5, pch=16)
plot(density(pse$What[pse$Shat_ge_Sf]), pch=16, xlim=c(0,1)) # then try the
# non-right tail extremal copula PSP as cop=PSP in the above psepolar() call.
## End(Not run)
</code></pre>


</div>