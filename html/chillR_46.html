<div class="container">

<table style="width: 100%;"><tr>
<td>handle_dwd_old</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>List, download or convert to chillR format data from the Deutscher Wetterdienst database</h2>

<h3>Description</h3>

<p><em>This function is deprecated and will disappear soon.</em> Please refer to the
<code>handle_dwd</code> function for the most current functionality.
</p>


<h3>Usage</h3>

<pre><code class="language-R">handle_dwd_old(
  action,
  location = NA,
  time_interval = c(19160101, Date2YEARMODA(Sys.Date())),
  station_list = NULL,
  stations_to_choose_from = 25,
  drop_most = TRUE,
  end_at_present = TRUE,
  add.DATE = FALSE,
  quiet = FALSE,
  add_station_name = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>action</code></td>
<td>
<p>is a character string to decide on 3 modes of action for the function.</p>

<ul>
<li>
<p><em>'list_stations'</em> returns a data frame with the information on weather stations that
are to the location defined by <code>number_of_stations</code> and <code>location</code> parameters.
</p>
</li>
<li>
<p><em>'download_weather'</em> retrieves the records for one or more weather stations defined
in the <code>location</code> parameter.
</p>
</li>
<li>
<p>If the input is a data frame previously downloaded with the mode <em>'download_weather'</em>,
the function will format the data frame using the chillR structure.</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>location</code></td>
<td>
<p>accepts a numeric vector with two or three elements representing the longitude,
latitude, and elevation of a given place or a vector of character strings representing the ID
of the weather stations of interest.
If <code>action = 'list_stations'</code>, <code>location</code> requires the coordinates of the place and
optionally the elevation. This vector can be named or not. Valid names are:
<code>'y'</code>, <code>'Y'</code>, <code>'latitude'</code>, <code>'lat'</code>, <code>'Latitude'</code>, <code>'Lat'</code>,
<code>'LATITUDE'</code>, <code>'LAT'</code> for latitude, <code>'x'</code>,
<code>'X'</code>, <code>'longitude'</code>, <code>'long'</code>, <code>'Longitude'</code>, <code>'Long'</code>,
<code>'LONGITUDE'</code>, <code>'LONG'</code> for longitude, and <code>'z'</code>, <code>'Z'</code>, <code>'elevation'</code>,
<code>'elev'</code>, <code>'Elevation'</code>, <code>'Elev'</code>, <code>'ELEVATION'</code>,
<code>'ELEV'</code> for elevation. If <code>action = 'download_weather'</code>, <code>location</code> accepts
the ID of the station as character string.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time_interval</code></td>
<td>
<p>numeric vector with two elements, specifying the start and end date
of the period of interest. Only required when running in <code>'list_stations'</code> or
<code>'download_weather'</code> mode. Unlike other functions from the handle family,
<code>handle_dwd</code> allows specifying the date in <code>YEARMODA</code> format. Default is set to
<code>19160101</code> (the earliest date on record) and the current date.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>station_list</code></td>
<td>
<p>accepts a data frame if the list of weather stations has already been
downloaded. The list can be passed to the function through this argument. This can save a bit
of time, since it can take a bit of time to download the list, which can have several
<code>MB</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stations_to_choose_from</code></td>
<td>
<p>if the location is specified by geographic coordinates,
this argument 
determines the number of nearby stations in the list that is returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop_most</code></td>
<td>
<p>boolean variable indicating if most columns should be dropped from the
file if a list of data frames is provided to the <code>action</code> argument. If set to
<code>TRUE</code> (the default), only essential columns for running <code>chillR</code> functions are
retained.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>end_at_present</code></td>
<td>
<p>boolean variable indicating whether the interval of interest
should end on the present day, rather than extending until the end of the year specified
under <code>time_interval[2]</code> (if <code>time_interval[2]</code> is the current year).
<strong>DEPRECATED</strong> in this function since <code>time_interval</code> already allows specifying
the present day.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.DATE</code></td>
<td>
<p>is a boolean parameter to be passed to <code>make_all_day_table</code>
if <code>action</code> is a collection of outputs (in the form of list) from the function in the
downloading format.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>
<p>is a boolean parameter to be passed to
<code>download.file</code> if <code>action = "download_weather"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add_station_name</code></td>
<td>
<p>is a boolean parameter to include the name of the respective weather
station in the resulting data frame in case the function is used in the downloading or
formatting mode.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function accesses the
<a href="https://www.dwd.de/EN/climate_environment/cdc/cdc_node_en.html">Deutscher
Wetterdienst database</a> and allows to:</p>
<ul>
<li>
<p>1) list a number of weather
stations that are close to a specific position (geographic coordinates) </p>
</li>
<li>
<p>2) obtain
weather data for one or more weather stations through the station ID </p>
</li>
<li>
<p>3) 'clean' and
'format' downloaded data, so the records can easily be used in other chillR functions</p>
</li>
</ul>
<h3>Value</h3>

<p>If <code>action = 'list_stations'</code>, the function returns a data frame with
<code>'stations_to_choose_from'</code> rows and 9 columns. This data frame contains information
about the weather stations (Latitude, Longitude, among others). If
<code>action = 'download_weather'</code>, the function returns a list of length according to the
length of the <code>location</code> parameter. Each list, is a list of two elements; a data frame
containing the data downloaded from the database and character string representing the
respective database ('dwd'). If the <code>action</code> is provided with the list generated by
the function in the downloading mode, the function will return a list of data frames structured
according to the chillR format. If <code>drop_most</code> is set to <code>TRUE</code>, the function will
keep only the relevant variables.
</p>


<h3>Note</h3>

<p>Many databases have data quality flags, which may sometimes indicate that data aren't reliable.
These are not considered by this function!
</p>


<h3>Author(s)</h3>

<p>Eduardo Fernandez and Eike Luedeling
</p>


<h3>References</h3>

<p>Fernandez, E., Whitney, C., and Luedeling, E. 2020. The importance of chill model selection
- A multi-site analysis. European Journal Of Agronomy 119: 126103
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# The following lines may take longer than required to pass the
# CRAN checks. Please, un-comment them to run the example

# stations &lt;- handle_dwd_old(action = "list_stations", 
#                        location = c(latitude = 53.5373, longitude = 9.6397),
#                        time_interval = c(20000101, 20101231),
#                        stations_to_choose_from = 25)
                     
# data &lt;- handle_dwd_old(action = "download_weather",
#                     location = stations[1 : 3, "Station_ID"],
#                     time_interval = c(20000101, 20020601),
#                     stations_to_choose_from = 25,
#                     station_list = stations,
#                     drop_most = TRUE, 
#                     add.DATE = FALSE,
#                     quiet = TRUE,
#                     add_station_name = FALSE)

# data_modified &lt;- handle_dwd_old(data, add.DATE = TRUE, drop_most = TRUE)
           
</code></pre>


</div>