<div class="container">

<table style="width: 100%;"><tr>
<td>Confidence interval for the percentage of variance retained by the first k components</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Confidence interval for the percentage of variance retained by the first <code class="reqn">\kappa</code> components
</h2>

<h3>Description</h3>

<p>Confidence interval for the percentage of variance retained by the first <code class="reqn">\kappa</code> components.
</p>


<h3>Usage</h3>

<pre><code class="language-R">eigci(x, k, alpha = 0.05, B = 1000, graph = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>A numerical matrix with more rows than columns.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>

<p>The number of principal components to use.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>This is the significance level. Based on this, an <code class="reqn">(1-\alpha)\%</code> confidence interval will be computed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>

<p>The number of bootstrap samples to generate.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>graph</code></td>
<td>

<p>Should the plot of the bootstrap replicates appear? Default value is TRUE.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The algorithm is taken by Mardia Kent and Bibby (1979, pg. 233â€“234). The percentage retained by the fist <code class="reqn">\kappa</code> principal components denoted by <code class="reqn">\hat{\psi}</code> is equal to
</p>
<p style="text-align: center;"><code class="reqn">
\hat{\psi}=\frac{ \sum_{i=1}^{\kappa}\hat{\lambda}_i }{\sum_{j=1}^p\hat{\lambda}_j },
</code>
</p>

<p>where <code class="reqn">\hat{\psi}</code> is asymptotically normal with mean <code class="reqn">\psi</code> and variance
</p>
<p style="text-align: center;"><code class="reqn">
\tau^2 = \frac{2}{\left(n-1\right)\left(tr\pmb{\Sigma} \right)^2}\left[ \left(1-\psi\right)^2\left(\lambda_1^2+...+\lambda_k^2\right)+
\psi^2\left(\lambda_{\kappa+1}^2+...\lambda_p^2\right) \right],
</code>
</p>

<p>where
<code class="reqn">a=\left( \lambda_1^2+...+\lambda_k^2\right)/\left( \lambda_1^2+...+\lambda_p^2\right)</code>
and <code class="reqn">\text{tr}\pmb{\Sigma}^2=\lambda_1^2+...+\lambda_p^2</code>.
</p>
<p>The bootstrap version provides an estimate of the bias, defined as <code class="reqn">\hat{\psi}_{boot}-\hat{\psi}</code> and confidence intervals calculated via the percentile method and via the standard (or normal) method Efron and Tibshirani (1993). The funciton gives the option to perform bootstrap.
</p>


<h3>Value</h3>

<p>A list including:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>res</code></td>
<td>

<p>If B=1 (no bootstrap) a vector with the esimated percentage of variance due to the first <code class="reqn">k</code> components, <code class="reqn">\hat{\psi}</code> and its associated asymptotic <code class="reqn">(1-\alpha)\%</code> confidence interval.
If B&gt;1 (bootstrap) a vector with: the esimated percentage of variance due to the first <code class="reqn">k</code> components, <code class="reqn">\hat{\psi}</code>, its bootstrap estimate and its bootstrap estimated bias.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>

<p>This appears if B&gt;1 (bootstrap). The standard bootstrap and the empirical bootstrap <code class="reqn">(1-\alpha)\%</code> confidence interval for <code class="reqn">\psi</code>.
</p>
</td>
</tr>
</table>
<p>Futher, if B&gt;1 and "graph" was set equal to TRUE, a histogram with the bootstrap <code class="reqn">\hat{\psi}</code> values, the observed <code class="reqn">\hat{\psi}</code> value and its bootstrap estimate.
</p>


<h3>Author(s)</h3>

<p>Michail Tsagris.
</p>
<p>R implementation and documentation: Michail Tsagris <a href="mailto:mtsagris@uoc.gr">mtsagris@uoc.gr</a>.
</p>


<h3>References</h3>

<p>Mardia K.V., Kent, J.T. and Bibby, J.M. (1979). Multivariate Analysis.
London: Academic
Press.
</p>
<p>Efron B. and Tibshirani R. J. (1993). An introduction to the bootstrap.
Chapman &amp; Hall/CRC.
</p>


<h3>See Also</h3>

<p><code>pc.choose
</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">x &lt;- as.matrix(iris[, 1:4])
eigci(x, k = 2, B = 1)
</code></pre>


</div>