<div class="container">

<table style="width: 100%;"><tr>
<td>crrs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Competing Risks Regression for Stratified Data
</h2>

<h3>Description</h3>

<p>Regression modeling of subdistribution hazards for stratified right censored data 
</p>
<p>Two types of stratification are addressed :
Regularly stratified: small number of large groups (strata) of subjects
Highly stratified: large number of small groups (strata) of subjects
</p>


<h3>Usage</h3>

<pre><code class="language-R">
crrs(ftime, fstatus, cov1, cov2, strata, 
tf, failcode=1, cencode=0,
ctype=1, 
subsets, na.action=na.omit, 
gtol=1e-6, maxiter=10,init)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>strata</code></td>
<td>
<p>stratification covariate
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ctype</code></td>
<td>
<p>1 if estimating censoring dist within strata (regular stratification), 
2 if estimating censoring dist across strata (highly stratification)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ftime</code></td>
<td>

<p>vector of failure/censoring times
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fstatus</code></td>
<td>

<p>vector with a unique code for each failure type and a separate code for
censored observations 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov1</code></td>
<td>

<p>matrix (nobs x ncovs) of fixed covariates (either cov1, cov2, or both
are required)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov2</code></td>
<td>

<p>matrix of covariates that will be multiplied by functions of time; 
if used, often these covariates would also appear in cov1
to give a prop hazards effect plus a time interaction
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tf</code></td>
<td>

<p>functions of time.  A function that takes a vector of times as
an argument and returns a matrix whose jth column is the value of 
the time function corresponding to the jth column of cov2 evaluated
at the input time vector.  
At time <code>tk</code>, the model includes the term <code>cov2[,j]*tf(tk)[,j]</code> as a covariate.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>failcode</code></td>
<td>

<p>code of fstatus that denotes the failure type of interest
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cencode</code></td>
<td>

<p>code of fstatus that denotes censored observations
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subsets</code></td>
<td>

<p>a logical vector specifying a subset of cases to include in the
analysis
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>

<p>a function specifying the action to take for any cases missing any of
ftime, fstatus, cov1, cov2, cengroup, or subset.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gtol</code></td>
<td>

<p>iteration stops when a function of the gradient is <code>&lt; gtol</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>

<p>maximum number of iterations in Newton algorithm (0 computes
scores and var at <code>init</code>, but performs no iterations)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>

<p>initial values of regression parameters (default=all 0)
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Fits the stratified extension of the Fine and Gray model (2011).  
This model directly assesses the effect of covariates on the subdistribution 
of a particular type of failure in a competing risks setting.  
</p>


<h3>Value</h3>

<p>Returns a list of class crr, with components (see crr for details)
</p>
<table>
<tr style="vertical-align: top;">
<td><code>$coef</code></td>
<td>
<p>the estimated regression coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$loglik</code></td>
<td>
<p>log pseudo-liklihood evaluated at <code>coef</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$score</code></td>
<td>
<p>derivitives of the log pseudo-likelihood evaluated at <code>coef</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$inf</code></td>
<td>
<p>-second derivatives of the log pseudo-likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$var</code></td>
<td>
<p>estimated variance covariance matrix of coef</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$res</code></td>
<td>
<p>matrix of residuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$uftime</code></td>
<td>
<p>vector of unique failure times</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$bfitj</code></td>
<td>
<p>jumps in the Breslow-type estimate of the underlying
sub-distribution cumulative hazard (used by predict.crr())</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$tfs</code></td>
<td>
<p>the tfs matrix (output of tf(), if used)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$converged</code></td>
<td>
<p>TRUE if the iterative algorithm converged</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$call</code></td>
<td>
<p>The call to crr</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$n</code></td>
<td>
<p>The number of observations used in fitting the model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$n.missing</code></td>
<td>
<p>The number of observations removed from the input data
due to missing values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$loglik.null</code></td>
<td>
<p>The value of the log pseudo-likelihood when all the
coefficients are 0</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Bingqing Zhou, <a href="mailto:bingqing.zhou@yale.edu">bingqing.zhou@yale.edu</a></p>


<h3>References</h3>

<p>Zhou B, Latouche A, Rocha V, Fine J. (2011). Competing Risks Regression for Stratified Data.
Biometrics. 67(2):661-70.
</p>


<h3>See Also</h3>

<p>cmprsk</p>


<h3>Examples</h3>

<pre><code class="language-R">##
#using fine and gray model
#crr(ftime=center$ftime, fstatus=center$fstatus, 
#cov1=cbind(center$fm,center$cells))
#
# High Stratification: ctype=2
# Random sub-sample 
data(center)
cov.test&lt;-cbind(center$fm,center$cells)
crrs(ftime=center[,1],fstatus=center[,2],
cov1=cov.test,
strata=center$id,ctype=2)

</code></pre>


</div>