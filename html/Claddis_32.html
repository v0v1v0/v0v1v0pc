<div class="container">

<table style="width: 100%;"><tr>
<td>drop_time_tip</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Drop tips from a time-scaled tree</h2>

<h3>Description</h3>

<p>Drop tips from a time-scaled tree and update root.time accordingly
</p>


<h3>Usage</h3>

<pre><code class="language-R">drop_time_tip(time_tree, tip_names, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>time_tree</code></td>
<td>
<p>A time-scaled tree in phylo format where branch lengths are durations and where a <code>$root.time</code> value indicates the root age.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tip_names</code></td>
<td>
<p>A vector of tip names to be pruned from the tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional options to be passed to <code>ape::drop.tip</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>(NB: This function is designed to only cope with trees containing at least three tips.)
</p>
<p>Usually ape formatted trees are pruned with the drop.tip function in ape. However, trees time-scaled using either the <code>paleotree</code> or <code>strap</code> packages have an additional important component, the root age (<code>$root.time</code>) that may need updating when tips are removed. (See fix_root_time.) Thus this function is a modified version of drop.tip that also performs the fix_root_time step.
</p>
<p>Note that <code>dropPaleoTip</code> in the <code>paleotree</code> package performs the exact same function, but is not called here to reduce the number of dependencies for <code>Claddis</code>.
</p>


<h3>Value</h3>

<p>Returns a tree (phylo object) with pruned tips and corrected <code>$root.time</code>.
</p>


<h3>Author(s)</h3>

<p>Graeme T. Lloyd <a href="mailto:graemetlloyd@gmail.com">graemetlloyd@gmail.com</a>
</p>


<h3>See Also</h3>

<p>fix_root_time
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Create a simple four-taxon tree with branch lengths:
tree &lt;- ape::read.tree(text = "(A:1,(B:1,(C:1,D:1):1):1);")

# Set root age as 20 Ma:
tree$root.time &lt;- 20

# Now prune taxon A:
pruned_tree &lt;- ape::drop.tip(phy = tree, tip = "A")

# Show that drop.tip has not updated the tree's root time:
pruned_tree$root.time

# Use the function to fix the root time:
pruned_tree &lt;- drop_time_tip(time_tree = tree, tip_names = "A")

# Show that the root time is now fixed (19 Ma):
pruned_tree$root.time

</code></pre>


</div>