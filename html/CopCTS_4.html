<div class="container">

<table style="width: 100%;"><tr>
<td>selectCopC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The selection of copula function</h2>

<h3>Description</h3>

<p>Among a list of copulas, select the one that gives the estimates
closest to the empirical copula function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">selectCopC(cop.type=c("Clayton","Gaussian","Gumbel","Joe","Frank"),
Yc,d,delta,nIS=500,jumps=NULL,MARGIN=NULL,...,intervals=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cop.type</code></td>
<td>
<p>a Kx1 vector containing the candidate copulas,
where K = length(cop.type) is the number of candidate copulas.
There are currently five available copula funcitons,
including Clayton copula, Gaussian copula, Gumbel copula, Joe copula and Frank copula.
Select each by specifying a vector consisting of at least one element from
c("Clayton","Gaussian","Gumbel","Joe","Frank").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Yc</code></td>
<td>
<p>the Nx1 vector of observed responses
that are subject to lower detection limit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>the lower detection limit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>the Nx1 vector of censoring indicator
with 1 indicating uncensored and 0 indicating left censored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nIS</code></td>
<td>
<p>the size for sequential importance sampling.
The default is 500.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jumps</code></td>
<td>
<p>the Nx1 vector indicating whether
each time t is a start of a new time series, which is deemed to be
independent from the previous series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MARGIN</code></td>
<td>
<p>the marginal distribution of the latent time series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters for the marginal distribution of the latent time series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intervals</code></td>
<td>
<p>a 2xK matrix specifying
the lower and upper bound for the copula parameter of each candidate copula, where K is the number
of candidate copulas.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>selectCopC</code> returns a list of components including
</p>
<table>
<tr style="vertical-align: top;">
<td><code>paras</code></td>
<td>
<p>a Kx1 vector containing the estimated copula parameters for each candidate copula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>likelihoods</code></td>
<td>
<p>a Kx1 vector containing
the negative log-likelihood value corresponding to the estimated copula parameter
for each candidate copula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estCop</code></td>
<td>
<p>a list containing the estimated copula object for each candidate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L2distance</code></td>
<td>
<p>a Kx1 vector containing the L2 distance between each copula
with estimated copula parameter
and the empirical copula function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Selected</code></td>
<td>
<p>The selected copula object.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Li, F., Tang, Y. and Wang, H. (2018) Copula-based Semiparametric Analysis for Time Series Data with Detection Limits, technical report.
</p>


<h3>See Also</h3>

<p><code>estCopC</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">### Example with simulated data
set.seed(20)
Y = genLatentY("Clayton",1,30,MARGIN.inv = qt,df=3)
d = -1
Yc = pmax(d,Y)
delta = (Y&gt;d)
selectCopC(cop.type=c("Clayton","Frank"),Yc = Yc,d = d,delta = delta,nIS=50)
### Example with water data
attach(water)
Yc = TNH3[1:30]
delta = Delta[1:30]
jumps = Indep[1:30]
set.seed(1)
intv.Gaussian = c(-1,1)
intv.Clayton = c(0,20)
intv.Frank = c(0,15)
intervals = cbind(intv.Gaussian,intv.Clayton,intv.Frank)
cop.type = c("Gaussian","Clayton","Frank")
selCopC &lt;- selectCopC(cop.type=cop.type,Yc=Yc,d=0.02,
            delta=delta,nIS = 50,jumps=jumps,intervals=intervals)
selCopC$Selected
</code></pre>


</div>