<div class="container">

<table style="width: 100%;"><tr>
<td>check.homog</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
<code class="reqn">Z</code> Homogeneity Check
</h2>

<h3>Description</h3>

<p>Checks whether the constraint function <code class="reqn">h(\cdot)</code> satisfies
a necessary condition for <code class="reqn">Z</code> homogeneity.
</p>


<h3>Usage</h3>

<pre><code class="language-R">check.homog(h.fct, Z, tol = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>h.fct</code></td>
<td>
<p>An <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> function object, indicating the constraint function
<code class="reqn">h(\cdot)</code> for <code class="reqn">Z</code> homogeneity check.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>Population (aka strata) matrix <code class="reqn">Z</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>The pre-set tolerance with which <code>norm(diff)</code> is to be compared
with.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The main idea:
</p>
<p><code class="reqn">h(\cdot)</code> is <code class="reqn">Z</code> homogeneous if <code class="reqn">h(Diag(Z\gamma)x) = G(\gamma)h(x)</code>, where
<code class="reqn">G</code> is a diagonal matrix with <code class="reqn">\gamma</code> elements raised to some power.
</p>
<p>As a check,  if <code class="reqn">h(\cdot)</code> is homogeneous then
</p>
<p style="text-align: center;"><code class="reqn">h(Diag(Z\gamma) x_{1}) / h(Diag(Z\gamma) x_{2}) = h(x_{1}) / h(x_{2});</code>
</p>

<p>That is, </p>
<p style="text-align: center;"><code class="reqn">\texttt{diff} = h(Diag(Z\gamma) x_{1}) h(x_{2}) - h(Diag(Z\gamma) x_{2}) h(x_{1}) = 0.</code>
</p>
<p> Here, the division and multiplication are taken element-wise.
</p>
<p>This program randomly generates <code>gamma</code>, <code>x1</code>, and <code>x2</code>, and
computes <code>norm(diff)</code>. It returns a warning if <code>norm(diff)</code> is
too far from <code class="reqn">0</code>.
</p>


<h3>Value</h3>

<p><code>check.homog</code> returns a character string <code>chk</code> that states whether
<code class="reqn">h(\cdot)</code> is <code class="reqn">Z</code> homogeneous. If <code>chk = ""</code>, it means that based on the necessary condition, we cannot state that <code class="reqn">h(\cdot)</code> is not <code class="reqn">Z</code> homogeneous.
</p>


<h3>Author(s)</h3>

<p>Joseph B. Lang
</p>


<h3>References</h3>

<p>Lang, J. B. (2004) Multinomial-Poisson homogeneous models for contingency tables, <em>Annals of Statistics</em>, <b>32</b>, 340â€“383.
</p>


<h3>See Also</h3>

<p><code>check.zero.order.homog</code>, <code>mph.fit</code>, <code>check.HLP</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># EXAMPLE 1
h.fct &lt;- function(m) {m[1] - m[2]}
Z &lt;- matrix(c(1, 1), nrow = 2)
check.homog(h.fct, Z)

# EXAMPLE 2
h.fct.2 &lt;- function(m) {m[1]^2 - m[2]}
Z &lt;- matrix(c(1, 1), nrow = 2)
check.homog(h.fct.2, Z)
</code></pre>


</div>