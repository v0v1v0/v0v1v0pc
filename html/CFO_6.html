<div class="container">

<table style="width: 100%;"><tr>
<td>CFO2d.next</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Determinate the dose level for the next cohort in the two-dimensional calibration-free odds (2dCFO) design for phase I trials.</h2>

<h3>Description</h3>

<p>In the 2dCFO design for phase I trials, the function is used to determine the dose movement based on the toxicity outcomes of the enrolled cohorts.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CFO2d.next(target, cys, cns, currdose, 
       prior.para = list(alp.prior = target, bet.prior = 1 - target), 
       cutoff.eli = 0.95, early.stop = 0.95, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>
<p>the target DLT rate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cys</code></td>
<td>
<p>a matrix of the number of DLTs observed for each dose combination.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cns</code></td>
<td>
<p>a matrix of the number of patients allocated to each dose combination.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>currdose</code></td>
<td>
<p>a vector of the current dose indices in the horizontal and vertical direction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior.para</code></td>
<td>
<p>the prior parameters for a beta distribution, where set as <code>list(alp.prior = target, bet.prior = 1 - target)</code>
by default, <code>alp.prior</code> and <code>bet.prior</code> represent the parameters of the prior distribution for
the true DLT rate at any dose level. This prior distribution is specified as Beta(<code>alpha.prior</code>, <code>beta.prior</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff.eli</code></td>
<td>
<p>the cutoff to eliminate overly toxic doses for safety. We recommend
the default value of <code>cutoff.eli = 0.95</code> for general use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>early.stop</code></td>
<td>
<p>the threshold value for early stopping. The default value <code>early.stop = 0.95</code>
generally works well.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>an integer to be set as the seed of the random number generator for reproducible results. The default value is set to <code>NULL</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In the 2dCFO design, decision-making within the two-dimensional toxicity probability space is conducted by performing two independent one-dimensional
CFO analyses along both the horizontal and vertical axes (Wang et al. 2023).
</p>


<h3>Value</h3>

<p>The <code>CFO2d.next()</code> function returns a list with the following components:
</p>

<ul>
<li>
<p> target: the target DLT rate.
</p>
</li>
<li>
<p> cys: a 3 by 3 matrix of the number of DLT observed for each dose combination at and around the current dose.
</p>
</li>
<li>
<p> cns: a 3 by 3 matrix of the number of patients allocated to each dose combination at and around the current dose.
</p>
</li>
<li>
<p> decision: a vector of length 2 representing the recommended decisions for vertical and horizontal
directions, and <code>stop</code> indicates stopping the experiment.
</p>
</li>
<li>
<p> currdose: the current dose combination.
</p>
</li>
<li>
<p> nextdose: the recommended dose combination for the next cohort. <code>nextdose = (99, 99)</code> indicates that the trial is
terminated due to early stopping.
</p>
</li>
<li>
<p> overtox: the situation regarding which positions experience over-toxicity. The dose level indicated
by <code>overtox</code> and all the dose levels above experience over-toxicity. <code>overtox = NA</code> signifies that the
occurrence of over-toxicity did not happen.
</p>
</li>
</ul>
<h3>Note</h3>

<p>When the current dose level is the lowest or highest (i.e., at the boundary), the parts in <code>cys</code> and
<code>cns</code> where there is no data are filled with <code>NA</code>. <br>
The dose level indicated by <code>overtox</code> and all the dose levels above experience over-toxicity, and these dose levels will be eliminated.
</p>


<h3>Author(s)</h3>

<p>Jialu Fang, Wenliang Wang, Ninghao Zhang, and Guosheng Yin
</p>


<h3>References</h3>

<p>Jin H, Yin G (2022). CFO: Calibration-free odds design for phase I/II clinical trials.
<em>Statistical Methods in Medical Research</em>, 31(6), 1051-1066. <br>
Wang W, Jin H, Zhang Y, Yin G (2023). Two-dimensional calibration-free odds (2dCFO)
design for phase I drug-combination trials. <em>Frontiers in Oncology</em>, 13, 1294258.
</p>


<h3>Examples</h3>

<pre><code class="language-R">cns &lt;- matrix(c(3, 3, 0,
                0, 6, 0,
                0, 0, 0), 
              nrow = 3, ncol = 3, byrow = TRUE)

cys &lt;- matrix(c(0, 1, 0,
                0, 2, 0,
                0, 0, 0), 
              nrow = 3, ncol = 3, byrow = TRUE)
currdose &lt;- c(2,3)
decision &lt;- CFO2d.next(target = 0.3, cys, cns, currdose = currdose, seed = 1)
summary(decision)
</code></pre>


</div>