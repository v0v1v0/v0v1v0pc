<div class="container">

<table style="width: 100%;"><tr>
<td>compute_beta_table</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function to compute beta table</h2>

<h3>Description</h3>

<p>This function takes segmented data and per base pileup of tumor and matched
normal of a sample as input and associates a beta value to each genomic segment.
</p>


<h3>Usage</h3>

<pre><code class="language-R">compute_beta_table(seg_tb, pileup_tumor, pileup_normal,
  min_coverage = 20, min_required_snps = 10, min_af_het_snps = 0.2,
  max_af_het_snps = 0.8, n_digits = 3, n_cores = 1, plot_stats = F,
  debug = F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>seg_tb</code></td>
<td>
<p>data.frame in <a href="http://software.broadinstitute.org/software/igv/SEG">SEG format</a>. Rows
report per segment log2 ratio
numeric value. CLONETv2 inteprets first column as sample name, columns two
to four as genomic coordinates (chromosome, start location, and end
location), column five is not used, and column six is the log2 ratio
returned by segmentation algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pileup_tumor, pileup_normal</code></td>
<td>
<p>data.frame reporting pileup of SNPs in
tumor and normal samples respectively. First row contains column names and
subsequent rows report the pileup of a specific genomic positions. Required
information for each genomic position includes
chromosome,    position,    allelic fraction, and    coverage. Required column names
are chr, pos, af, and cov</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_coverage</code></td>
<td>
<p>minimum number of reads for considering a pileup position
valid (default=20)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_required_snps</code></td>
<td>
<p>minimum number of snps to call beta for a segment
(default=10)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_af_het_snps</code></td>
<td>
<p>minimum allowed allelic fraction of a SNP genomic
position (default=0.2)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_af_het_snps</code></td>
<td>
<p>maximum allowed allelic fraction of a SNP genomic
position (default=0.8)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_digits</code></td>
<td>
<p>number of digits in the output table  (default=3)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_cores</code></td>
<td>
<p>number of available cores for computation (default=1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_stats</code></td>
<td>
<p>plot summary statistics of the computed beta table (default=F)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>debug</code></td>
<td>
<p>return extra columns for debugging (default=F)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A data.frame that extends input seg_tb with columns beta, nsnp, cov,
n_beta. Moreover, CLONETv2 renames colums of seg_tb as sample, chr,
start, end, XYZ, log2, with XYZ being the original name of column five
As for seg_tb, each raw of the output table represents a genomic
segments. For each raw,  the value of beta is the proportion of neutral
reads in the segment, while nsnp and cov represents respectively the number
of informative SNPs and the mean coverage of the given segment. The value
n_beta is the proportion of neutral reads in the normal sample. The value
of n_beta should be 1 as in normal samples parental chromosomes are equally
represented. Values lower than 1 of n_beta could indicate the presence of germline CNVs
or sequencing errors.
</p>


<h3>Author(s)</h3>

<p>Davide Prandi, Alessandro Romanel
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Compue beta table with default parameters
bt_toy &lt;- compute_beta_table(seg_tb_toy, pileup_tumor_toy, pileup_normal_toy)
</code></pre>


</div>