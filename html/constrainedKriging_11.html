<div class="container">

<table style="width: 100%;"><tr>
<td>covmodel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create isotropic covariance model
</h2>

<h3>Description</h3>

<p>Function to generate isotropic covariance models, or add an
isotropic covariance model to an existing isotropic model.</p>


<h3>Usage</h3>

<pre><code class="language-R">covmodel(modelname, mev, nugget,variance, scale, parameter, add.covmodel)

## S3 method for class 'covmodel'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>modelname</code></td>
<td>
<p>a character scalar with the name of an isotropic
covariance model, see <em>Details</em> for a list of implemented models.  A
call of <code>covmodel()</code> without any function argument displays a table
with all available models and their parameters, see <em>Examples</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mev</code></td>
<td>
<p>a numeric scalar, variance of the measurement error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nugget</code></td>
<td>
<p>a numeric scalar, variance of microstructure white noise
process with range smaller than the minimal distance between any
pair of support data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variance</code></td>
<td>
<p>a numeric scalar, partial sill of the covariance model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>a numeric scalar, scale ("range") parameter of the covariance
model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameter</code></td>
<td>
<p>a numeric vector of further covariance parameters, missing
for some model like <code>nugget</code>, <code>spherical</code> or <code>gauss</code>, etc,
see <em>Details</em>.  If a model has several extra parameters, say
<code>a</code>, <code>b</code>, ...  then they must be given as <code>c(a, b, ...)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.covmodel</code></td>
<td>
<p>an object of the class <code>covmodel</code> that is added to
the covariance model defined by <code>modelname</code> (see examples)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a covariance model generated by <code>covmodel</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further printing arguments</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The name and parametrisation of the covariance models originate from the
function <code>CovarianceFct</code> of the archived package <span class="pkg">RandomFields</span>,
version 2.0.71.
</p>
<p>The following isotropic covariance functions are implemented (equations
taken from help page of function <code>CovarianceFct</code> of archived package
<span class="pkg">RandomFields</span>, version 2.0.71, note that the variance and range
parameters are equal to 1 in the following formulae and <code class="reqn">h</code> is the
lag distance.):
</p>

<ul>
<li> <p><code>bessel</code>
</p>
<p style="text-align: center;"><code class="reqn">C(h)=2^a \Gamma(a+1)h^{-a} J_a(h)</code>
</p>

<p>For a 2-dimensional region, the parameter <code class="reqn">a</code> must be greater than
or equal to 0.
</p>
</li>
<li> <p><code>cauchy</code>
</p>
<p style="text-align: center;"><code class="reqn">C(h)=\left(1+h^2\right)^{-a}</code>
</p>

<p>The parameter <code class="reqn">a</code> must be positive.
</p>
</li>
<li> <p><code>cauchytbm</code>
</p>
<p style="text-align: center;"><code class="reqn">C(h)= (1+(1-b/3)h^a)(1+h^a)^{(-b/a-1)}</code>
</p>

<p>The parameter <code class="reqn">a</code> must be in (0,2] and  <code class="reqn">b</code>
positive.
The model is valid for 3 dimensions.
It allows for simulating random fields where
fractal dimension and Hurst coefficient can be chosen
independently.
</p>
</li>
<li> <p><code>circular</code>
</p>
<p style="text-align: center;"><code class="reqn">C(h)=
      \left(1-\frac 2\pi
      \left(h \sqrt{1-h^2} +
      \arcsin(h)\right)\right)
      1_{[0,1]}(h)</code>
</p>

<p>This isotropic covariance function is valid only for dimensions
less than or equal to 2.
</p>
</li>
<li> <p><code>constant</code>
</p>
<p style="text-align: center;"><code class="reqn">C(h)=1</code>
</p>

</li>
<li> <p><code>cubic</code>
</p>
<p style="text-align: center;"><code class="reqn">C(h)=(1- 7h^2+8.75h^3-3.5h^5+0.75 h^7)1_{[0,1]}(h)</code>
</p>

<p>This model is valid only for dimensions less than or equal to 3.
It is a 2 times differentiable covariance functions with compact
support.
</p>
</li>
<li> <p><code>dampedcosine</code> (hole effect model)
</p>
<p style="text-align: center;"><code class="reqn">C(h)= e^{-a h} \cos(h)</code>
</p>

<p>This model is valid for 2 dimensions iff <code class="reqn">a \ge 1</code>.
</p>
</li>
<li> <p><code>exponential</code>
</p>
<p style="text-align: center;"><code class="reqn">C(h)=e^{-h}</code>
</p>

<p>This model is a special case of the <code>whittle</code> model
(for <code class="reqn">a=0.5</code>)
and the <code>stable</code> model (for <code class="reqn">a = 1</code>).
</p>
</li>
<li> <p><code>gauss</code>
</p>
<p style="text-align: center;"><code class="reqn">C(h)=e^{-h^2}</code>
</p>

<p>This model is a special case of the <code>stable</code> model
(for <code class="reqn">a=2</code>).
See <code>gneiting</code> for an alternative model that does not have
the disadvantages of the Gaussian model.
</p>
</li>
<li> <p><code>gencauchy</code> (generalised <code>cauchy</code>)
</p>
<p style="text-align: center;"><code class="reqn">C(h)= \left(1+h^a\right)^{(-b/a)}</code>
</p>

<p>The parameter <code class="reqn">a</code> must be in (0,2] and <code class="reqn">b</code>
positive.
This model allows for random fields where
fractal dimension and Hurst coefficient can be chosen
independently.
</p>
</li>
<li> <p><code>gengneiting</code> (generalised <code>gneiting</code>)
If <code class="reqn">a=1</code> and let <code class="reqn">\beta = b+1</code> then
</p>
<p style="text-align: center;"><code class="reqn">C(h)=\left(1+\beta h\right) (1-h)^{\beta}
      1_{[0,1]}(h)</code>
</p>

<p>If <code class="reqn">a=2</code>  and let <code class="reqn">\beta = b+2</code> then
</p>
<p style="text-align: center;"><code class="reqn">C(h)=\left(1+\beta h+\left(\beta ^2-1\right)h^2/3\right)
      (1-h)^{\beta}  1_{[0,1]}(h)</code>
</p>

<p>If <code class="reqn">a=3</code>   and let <code class="reqn">\beta = b+3</code> then
</p>
<p style="text-align: center;"><code class="reqn">C(h)=\left(1+\beta h+\left(2\beta ^2-3\right)\frac{h^2}{5}
      +\left(\beta ^2-4\right)\beta \frac{h^3}{15}\right)(1-h)^{\beta}
      1_{[0,1]}(h)</code>
</p>

<p>The parameter <code class="reqn">a</code> is a positive integer; here only the
cases <code class="reqn">a=1, 2, 3</code> are implemented.
For two dimensional regions the parameter <code class="reqn">b</code> must greater than or equal to
<code class="reqn">(2 + 2a +1)/2</code>.
</p>
</li>
<li> <p><code>gneiting</code>
</p>
<p style="text-align: center;"><code class="reqn">C(h)=\left(1 + 8 sh + 25 (sh)^2 + 32
      (sh)^3\right)(1-sh)^8 1_{[0,1]}(sh)</code>
</p>

<p>where
<code class="reqn">s=0.301187465825</code>.
This  covariance function is valid only for dimensions less
than or equal to 3.
It is a 6 times differentiable covariance functions with compact
support.
It is an alternative to the <code>gaussian</code> model since
its graph is visually hardly distinguishable from the graph of
the Gaussian model, but possesses neither the mathematical and nor the
numerical disadvantages of the Gaussian model.
</p>
</li>
<li> <p><code>hyperbolic</code>
</p>
<p style="text-align: center;"><code class="reqn">C(h)= c^{-b}(K_{b}(a c))^{-1}
      ( c^2 + h^2 )^{b/2}
      K_{b}(
      a [ c^2 + h^2 ]^{1/2} )</code>
</p>

<p>The parameters are such that<br><code class="reqn">c\ge0</code>,  <code class="reqn">a&gt;0</code>  and
<code class="reqn">b&gt;0,\quad</code>
or<br><code class="reqn">c&gt;0</code>,  <code class="reqn">a&gt;0</code>  and  <code class="reqn">b=0,\quad</code>
or<br><code class="reqn">c&gt;0</code>,  <code class="reqn">a\ge0</code>, and   <code class="reqn">b&lt;0</code>.<br>
Note that this class is over-parametrised; always one
of the three parameters
<code class="reqn">a</code>, <code class="reqn">c</code>, and scale
can be eliminated in the formula.
</p>
</li>
<li> <p><code>lgd1</code> (local-global distinguisher)
</p>
<p style="text-align: center;"><code class="reqn">C(h)=
      1-\frac{\beta}{a+b}|h|^{a}, |h|\le 1 \qquad \hbox{and} \qquad
      \frac{a}{a+b}|h|^{-b}, |h|&gt; 1
    </code>
</p>

<p>Here <code class="reqn">b&gt;0</code> and <code class="reqn">a</code> msut be in
<code class="reqn">(0,0.5]</code>.
The random field has for 2-dimensional regions fractal dimension
<code class="reqn">3 - a/2</code>
and Hurst coefficient <code class="reqn">1 -b/2</code> for
<code class="reqn">b \in (0,1]</code>
</p>
</li>
<li> <p><code>matern</code>
</p>
<p style="text-align: center;"><code class="reqn">C(h)= 2^{1-a} \Gamma(a)^{-1}
       (\sqrt{2 a} h)^a K_a(\sqrt{2 a}h)</code>
</p>

<p>The parameter <code class="reqn">a</code> must be positive.
This is the model of choice if the smoothness of a random field is to
be parametrised: if <code class="reqn">a &gt; m</code> then the
graph is <code class="reqn">m</code> times differentiable.
</p>
</li>
<li> <p><code>nugget</code>
</p>
<p style="text-align: center;"><code class="reqn">C(h)=1_{[0]}(h)</code>
</p>

</li>
<li> <p><code>penta</code>
</p>
<p style="text-align: center;"><code class="reqn">C(h)= \left(1 - \frac{22}3 h^2 +33 h^4 -
      \frac{77}2 h^5 + \frac{33}2
      h^7 -\frac{11}2 h^9 + \frac 56 h^{11}
      \right)1_{[0,1]}(h)</code>
</p>

<p>valid only for dimensions less than or equal to 3.
This is a 4 times differentiable covariance functions with compact
support.
</p>
</li>
<li> <p><code>power</code>
</p>
<p style="text-align: center;"><code class="reqn">C(h)= (1-h)^a 1_{[0,1]}(h)</code>
</p>

<p>This covariance function is valid for 2 dimensions iff
<code class="reqn">a \ge 1.5</code>.
For <code class="reqn">a=1</code> we get the well-known triangle (or tent)
model, which is valid on the real line, only.
</p>
</li>
<li> <p><code>qexponential</code>
</p>
<p style="text-align: center;"><code class="reqn">C(h)= ( 2 e^{-h} - a e^{-2x} ) / ( 2 - a )</code>
</p>

<p>The parameter <code class="reqn">a</code> must be in <code class="reqn">[0,1]</code>.
</p>
</li>
<li> <p><code>spherical</code>
</p>
<p style="text-align: center;"><code class="reqn">C(h)=\left(1- 1.5 h+0.5 h^3\right) 1_{[0,1]}(h)</code>
</p>

<p>This  covariance function is valid only for dimensions
less than or equal to 3.
</p>
</li>
<li> <p><code>stable</code>
</p>
<p style="text-align: center;"><code class="reqn">C(h)=\exp\left(-h^a\right)</code>
</p>

<p>The parameter <code class="reqn">a</code> must be in <code class="reqn">(0,2]</code>.
See <code>exponential</code> and <code>gaussian</code> for special cases.
</p>
</li>
<li> <p><code>wave</code>
</p>
<p style="text-align: center;"><code class="reqn">C(h)=\frac{\sin h}{h}, \quad h&gt;0 \qquad \hbox{and } \qquad C(0)=1</code>
</p>

<p>This isotropic covariance function is valid only for dimensions less
than or equal to 3.
It is a special case of the <code>bessel</code> model
(for <code class="reqn">a=0.5</code>).
</p>
</li>
<li> <p><code>whittle</code>
</p>
<p style="text-align: center;"><code class="reqn">C(h) = 2^{1-a} \Gamma(a)^{-1} h^a
      K_a(h)</code>
</p>

<p>The parameter <code class="reqn">a</code> must be positive.
This is the model of choice if the smoothness of a random field is to
be parametrised: if <code class="reqn">a &gt; m</code> then the
graph is <code class="reqn">m</code> times differentiable.
</p>
</li>
</ul>
<p>The default values of the arguments
<code>mev</code>,
<code>nugget</code>,
<code>variance</code> and <code>scale</code> are eq 0.
</p>


<h3>Value</h3>

<p>an object of the class <code>covmodel</code> that defines a covariance model.
</p>


<h3>Author(s)</h3>

<p>Christoph Hofer, <a href="mailto:christoph.hofer@alumni.ethz.ch">christoph.hofer@alumni.ethz.ch</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># table with all available covariance models and their
# parameters
covmodel()

# exponential model without a measurement error and without a nugget,
# partial sill = 10, scale  parameter = 15
covmodel(modelname = "exponential", variance = 10, scale = 15)

# exponential model with a measurement error ( mev = 0.5) and a
# nugget (nugget = 2.1), exponential partial  sill (variance = 10)
# and scale parameter = 15
covmodel(modelname = "exponential", mev  = 0.5, nugget = 2.1,
variance = 10, scale = 15)
</code></pre>


</div>