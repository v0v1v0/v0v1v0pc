<div class="container">

<table style="width: 100%;"><tr>
<td>datacggm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create a Dataset from a Conditional Gaussian Graphical Model with Censored and/or Missing Values</h2>

<h3>Description</h3>

<p>‘The <code>datacggm</code>’ function is used to create a dataset from a conditional Gaussian graphical model with censored and/or missing values.
</p>


<h3>Usage</h3>

<pre><code class="language-R">datacggm(Y, lo = -Inf, up =  +Inf, X = NULL, control = list(maxit = 1.0E+4,
         thr = 1.0E-4))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>a <code class="reqn">(n\times p)</code>-dimensional matrix; each row is an observation from a conditional Gaussian graphical model with censoring vectors <code>lo</code> and <code>up</code>. Missing-at-random values are recorded as ‘<code>NA</code>’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lo</code></td>
<td>
<p>the lower censoring vector; <code>lo[j]</code> is used to specify the lower censoring value for the random variable <code class="reqn">Y_j</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>up</code></td>
<td>
<p>the upper censoring vector; <code>up[j]</code> is used to specify the upper censoring value for the random variable <code class="reqn">Y_j</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>an optional <code class="reqn">(n\times q)</code>-dimensional data frame of predictors. If missing (default), a dataset from a Gaussian graphical model is returned otherwise a dataset from a conditional Gaussian graphical model is returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a named list used to pass the arguments to the EM algorithm (see below for more details). The components are:
</p>

<ul>
<li> <p><code>maxit</code>: maximum number of iterations. Default is <code>1.0E+4</code>.
</p>
</li>
<li> <p><code>thr</code>: threshold for the convergence. Default value is <code>1.0E-4</code>.</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function ‘<code>datacggm</code>’ returns an <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> object of class ‘<code>datacggm</code>’, that is a named list containing the elements needed to fit a conditional graphical LASSO (cglasso) model to datasets with censored and/or missing values.
</p>
<p>A set of specific method functions are developed to decsribe data with censored/missing values. For example, the method function ‘<code>print.datacggm</code>’  prints out the left and right-censored values using the following rules: a right-censored value is labeled adding the symbol ‘<code>+</code>’ at the end of the value, whereas the symbol ‘<code>-</code>’ is used for the left-censored values (see examples below). The summary statistics can be obtained using the method function ‘<code>summary.datacggm</code>’. The matrices <code>Y</code> and <code>X</code> are extracted from a <code>datacggm</code> object using the function ‘<code>getMatrix</code>’.
</p>
<p>For each column of the matrix ‘<code>Y</code>’, mean and variance are estimated using a standard EM-algorithm based on the assumption of a Gaussian distribution. ‘<code>maxit</code>’ and ‘<code>thr</code>’ are used to set the number of iterations and the threshold for convergence, respectively. Marginal means and variances can be extracted using the accessor functions ‘<code>ColMeans</code>’ and ‘<code>ColVars</code>’, respectively. Furthermore, the plotting functions ‘<code>hist.datacggm</code>’ and ‘<code>qqcnorm</code>’ can be used to inspect the marginal distribution of each column of the matrix ‘<code>Y</code>’.
</p>
<p>The status indicator matrix, denoted by <code>R</code>, can be extracted by using the function <code>event</code>. The entries of this matrix specify the status of an observation using the following code:
</p>

<ul>
<li> <p>‘<code>R[i, j] =  0</code>’ means that the <code class="reqn">y_{ij}</code> is inside the open interval <code>(lo[j], up[j])</code>;
</p>
</li>
<li> <p>‘<code>R[i, j] = -1</code>’ means that the <code class="reqn">y_{ij}</code> is a left-censored value;
</p>
</li>
<li> <p>‘<code>R[i, j] = +1</code>’ means that the <code class="reqn">y_{ij}</code> is a right-censored value;
</p>
</li>
<li> <p>‘<code>R[i, j] = +9</code>’ means that the <code class="reqn">y_{ij}</code> is a missing value.
</p>
</li>
</ul>
<p>See below for the other functions related to an object of class ‘<code>datacggm</code>’.
</p>


<h3>Value</h3>

<p>‘<code>datacggm</code>’ returns an <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> object of S3 class “<code>datacggm</code>”, that is, a nested named list containing the
following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>the <code class="reqn">(n\times p)</code>-dimensional matrix <code>Y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>the <code class="reqn">(n\times q)</code>-dimensional data frame <code>X</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Info</code></td>
<td>


<ul>
<li> <p><code>lo:</code> the lower censoring vector;
</p>
</li>
<li> <p><code>up:</code> the upper censoring vector;
</p>
</li>
<li> <p><code>R:</code> the status indicator matrix encoding the censored/missing values (mainly for internal purposes);
</p>
</li>
<li> <p><code>order:</code> an integer vector used for the ordering of the matrices <code>Y</code> and <code>X</code> (for internal purposes only);
</p>
</li>
<li> <p><code>Pattern:</code> a matrix encoding the information about the the patterns of censored/missing values (for internal purposes only);
</p>
</li>
<li> <p><code>ym:</code> the estimated marginal means of the random variables <code class="reqn">Y_j</code>;
</p>
</li>
<li> <p><code>yv:</code> the estimated marginal variances of the random variables <code class="reqn">Y_j</code>;
</p>
</li>
<li> <p><code>n:</code> the sample size;
</p>
</li>
<li> <p><code>p:</code> the number of response variables;
</p>
</li>
<li> <p><code>q:</code> the number of columns of the data frame <code>X</code>.
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Luigi Augugliaro (<a href="mailto:luigi.augugliaro@unipa.it">luigi.augugliaro@unipa.it</a>)</p>


<h3>References</h3>

<p>Augugliaro L., Sottile G., Wit E.C., and Vinciotti V. (2023) &lt;<a href="https://doi.org/10.18637/jss.v105.i01">doi:10.18637/jss.v105.i01</a>&gt;.
cglasso: An R Package for Conditional Graphical Lasso Inference with Censored and Missing Values.
<em>Journal of Statistical Software</em> <b>105</b>(1), 1–58.
</p>
<p>Augugliaro, L., Sottile, G., and Vinciotti, V. (2020a) &lt;<a href="https://doi.org/10.1007/s11222-020-09945-7">doi:10.1007/s11222-020-09945-7</a>&gt;.
The conditional censored graphical lasso estimator.
<em>Statistics and Computing</em> <b>30</b>, 1273–1289.
</p>
<p>Augugliaro, L., Abbruzzo, A., and Vinciotti, V. (2020b) &lt;<a href="https://doi.org/10.1093/biostatistics/kxy043">doi:10.1093/biostatistics/kxy043</a>&gt;.
<code class="reqn">\ell_1</code>-Penalized censored Gaussian graphical model.
<em>Biostatistics</em> <b>21</b>, e1–e16.
</p>


<h3>See Also</h3>

<p>Related to the <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> objects of class “<code>datacggm</code>” there are the accessor functions, <code>rowNames</code>, <code>colNames</code>, <code>getMatrix</code>, <code>ColMeans</code>, <code>ColVars</code>, <code>upper</code>, <code>lower</code>, <code>event</code>, <code>qqcnorm</code> and the method functions <code>is.datacggm</code>, <code>dim.datacggm</code>, <code>summary.datacggm</code> and <code>hist.datacggm</code>. The function <code>rcggm</code> can be used to simulate a dataset from a conditional Gaussian graphical model whereas <code>cglasso</code> is the model fitting function devoted to the l1-penalized censored Gaussian graphical model.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(123)

# a dataset from a right-censored Gaussian graphical model
n &lt;- 100L
p &lt;- 3L
Y &lt;- matrix(rnorm(n * p), n, p)
up &lt;- 1
Y[Y &gt;= up] &lt;- up
Z &lt;- datacggm(Y = Y, up = up)
Z

# a dataset from a  conditional censored Gaussian graphical model
n &lt;- 100L
p &lt;- 3L
q &lt;- 2
Y &lt;- matrix(rnorm(n * p), n, p)
up &lt;- 1
lo &lt;- -1
Y[Y &gt;= up] &lt;- up
Y[Y &lt;= lo] &lt;- lo
X &lt;- matrix(rnorm(n * q), n, q)
Z &lt;- datacggm(Y = Y, lo = lo, up = up, X = X)
Z

# a dataset from a  conditional censored Gaussian graphical model 
# and with missing-at-random values
n &lt;- 100L
p &lt;- 3L
q &lt;- 2
Y &lt;- matrix(rnorm(n * p), n, p)
NA.id &lt;- matrix(rbinom(n * p, 1L, 0.01), n, p)
Y[NA.id == 1L] &lt;- NA
up &lt;- 1
lo &lt;- -1
Y[Y &gt;= up] &lt;- up
Y[Y &lt;= lo] &lt;- lo
X &lt;- matrix(rnorm(n * q), n, q)
Z &lt;- datacggm(Y = Y, lo = lo, up = up, X = X)
Z
</code></pre>


</div>