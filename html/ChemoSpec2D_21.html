<div class="container">

<table style="width: 100%;"><tr>
<td>plotLoadings2D</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot Loadings from a PARAFAC, MIA or POP Analysis of a Spectra2D Object</h2>

<h3>Description</h3>

<p>Computes (if necessary) and plots loadings from a PARAFAC, MIA or POP analysis of a
<code>Spectra2D</code> object. The loadings matrix has has dimensions
F1 x F2 and is a 2D pseudo-spectrum.  A reference spectrum may also be drawn.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotLoadings2D(
  spectra,
  so,
  load = 1,
  ref = NULL,
  load_lvls = NULL,
  ref_lvls = NULL,
  load_cols = NULL,
  ref_cols = NULL,
  plot = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>spectra</code></td>
<td>
<p>An object of S3 class <code>Spectra2D</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>so</code></td>
<td>
<p>("Score Object") One of the following:
</p>

<ul>
<li>
<p> An object of class <code>mia</code> produced by
function <code>miaSpectra2D</code>.
</p>
</li>
<li>
<p> An object of class <code>pfac</code> produced by
function <code>pfacSpectra2D</code>.
</p>
</li>
<li>
<p> An object of class <code>pop</code> produced by
function <code>popSpectra2D</code>.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>load</code></td>
<td>
<p>An integer specifying the loading to plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ref</code></td>
<td>
<p>An integer giving the spectrum in <code>spectra</code> to use
as a reference spectrum, which is plotted behind the loadings.
Defaults to <code>NULL</code> which does not plot a reference spectrum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>load_lvls</code></td>
<td>
<p>A vector specifying the contour levels
for the loadings pseudo-spectrum.
If <code>NULL</code>, values are computed using <code>calcLvls</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ref_lvls</code></td>
<td>
<p>A vector specifying the levels at which to compute contours
for the reference spectrum.
If <code>NULL</code>, values are computed using <code>calcLvls</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>load_cols</code></td>
<td>
<p>A vector specifying the colors for the contours in the laoding spectrum.
If <code>NULL</code>, defaults to a scheme of values
running from blue (low) to red (high), centered on green (zero).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ref_cols</code></td>
<td>
<p>A vector specifying the colors for the contours in the reference
spectrum. If <code>NULL</code>, set to gray.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>Logical.  Shall a plot be made?  Plotting large data sets can be slow.
Run the function with <code>plot = FALSE</code>, then use <code>inspectLvls</code>
to figure out desirable levels, then set <code>plot = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters to be passed to plotting functions.  For instance
<code>showGrid = TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The modified <code>Spectra2D</code> object is returned invisibly.
The loadings matrix will be appended with a sample of name of Loadings_x where
<code>x = load</code>. Side effect is a plot.
</p>


<h3>Scale</h3>

<p>You can view the color scale for the plot via <code>showScale</code>.
</p>


<h3>Levels &amp; Colors</h3>

<p>The number of levels and colors must match, and they are used 1 for 1.  If you
provide <code>n</code> colors, and no levels, the automatic calculation of levels may return
a number of levels other than <code>n</code>, in which case the function will override your colors and
assign new colors for the number of levels it computed (with a message).  To get
exactly what you want, specify both levels and colors in equal numbers.  Function
<code>inspectLvls</code> can help you choose appropriate levels.
</p>


<h3>Overlaying Spectra</h3>

<p>If you specify more than one spectrum to plot, e.g. <code>which = c(1,2)</code>, then
arguments <code>lvls</code> and <code>cols</code> must be lists of levels and colors, one list
element for each spectrum to be plotted (if specified at all).  Two convenience functions exist to
make this process easier: <code>LofL</code> and <code>LofC</code>. See the examples.
</p>


<h3>Author(s)</h3>

<p>Bryan A. Hanson, DePauw University.
</p>


<h3>See Also</h3>

<p>Please see <code>pfacSpectra2D</code>, <code>miaSpectra2D</code> or
<code>popSpectra2D</code> for examples.
</p>


</div>