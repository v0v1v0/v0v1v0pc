<div class="container">

<table style="width: 100%;"><tr>
<td>coca</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cluster-Of-Clusters Analysis</h2>

<h3>Description</h3>

<p>This function allows to do Cluster-Of-Clusters Analysis on a binary matrix
where each column is a clustering of the data, each row corresponds to a data
point and the element in position (i,j) is equal to 1 if data point i belongs
to cluster j, 0 otherwise.
</p>


<h3>Usage</h3>

<pre><code class="language-R">coca(
  moc,
  K = NULL,
  maxK = 6,
  B = 1000,
  pItem = 0.8,
  hclustMethod = "average",
  choiceKmethod = "silhouette",
  ccClMethod = "kmeans",
  ccDistHC = "euclidean",
  maxIterKM = 1000,
  savePNG = FALSE,
  fileName = "coca",
  verbose = FALSE,
  widestGap = FALSE,
  dunns = FALSE,
  dunn2s = FALSE,
  returnAllMatrices = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>moc</code></td>
<td>
<p>N X C data matrix, where C is the total number of clusters
considered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>Number of clusters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxK</code></td>
<td>
<p>Maximum number of clusters considered for the final clustering if
K is not known. Default is 6.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>Number of iterations of the Consensus Clustering step.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pItem</code></td>
<td>
<p>Proportion of items sampled at each iteration of the Consensus
Cluster step.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hclustMethod</code></td>
<td>
<p>Agglomeration method to be used by the hclust function to
perform hierarchical clustering on the consensus matrix. Can be "single",
"complete", "average", etc. For more details please see ?stats::hclust.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>choiceKmethod</code></td>
<td>
<p>Method used to choose the number of clusters if K is
NULL, can be either "AUC" (area under the curve, work in progress) or
"silhouette". Default is "silhouette".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ccClMethod</code></td>
<td>
<p>Clustering method to be used by the Consensus Clustering
algorithm (CC). Can be either "kmeans" for k-means clustering or "hclust" for
hiearchical clustering. Default is "kmeans".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ccDistHC</code></td>
<td>
<p>Distance to be used by the hiearchical clustering algorithm
inside CC. Can be "pearson" (for 1 - Pearson correlation), "spearman" (for 1-
Spearman correlation), or any of the distances provided in stats::dist()
(i.e. "euclidean", "maximum", "manhattan", "canberra", "binary" or
"minkowski"). Default is "euclidean".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxIterKM</code></td>
<td>
<p>Number of iterations for the k-means clustering algorithm.
Default is 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>savePNG</code></td>
<td>
<p>Boolean. Save plots as PNG files. Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fileName</code></td>
<td>
<p>If <code>savePNG</code> is TRUE, this is the string containing (the
first part of) the name of the output files. Can be used to specify the
folder path too. Default is "coca". The ".png" extension is automatically
added to this string.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Boolean.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>widestGap</code></td>
<td>
<p>Boolean. If TRUE, compute also widest gap index to choose
best number of clusters. Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dunns</code></td>
<td>
<p>Boolean. If TRUE, compute also Dunn's index to choose best
number of clusters. Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dunn2s</code></td>
<td>
<p>Boolean. If TRUE, compute also alternative Dunn's index to
choose best number of clusters. Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnAllMatrices</code></td>
<td>
<p>Boolean. If TRUE, return consensus matrices for all
considered values of K. Default is FALSE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>This function returns a list containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>consensusMatrix</code></td>
<td>
<p>a symmetric matrix where the element in position
(i,j) corresponds to the proportion of times that items i and j have been
clustered together and a vector of cluster labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clusterLabels</code></td>
<td>
<p>the final cluster labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>the final number of clusters. If provided by the user, this is
the same as the input. Otherwise, this is the number of clusters selected via
the requested method (see argument <code>choiceKmethod</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>consensusMatrices</code></td>
<td>
<p>if returnAllMatrices = TRUE, this array
also returned, containing the consensus matrices obtained for each of the
numbers of clusters considered by the algorithm.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Alessandra Cabassi <a href="mailto:alessandra.cabassi@mrc-bsu.cam.ac.uk">alessandra.cabassi@mrc-bsu.cam.ac.uk</a>
</p>


<h3>References</h3>

<p>The Cancer Genome Atlas, 2012. Comprehensive molecular
portraits of human breast tumours. Nature, 487(7407), pp.61â€“70.
</p>
<p>Cabassi, A. and Kirk, P. D. W. (2019). Multiple kernel learning
for integrative consensus clustering of 'omic datasets. arXiv preprint.
arXiv:1904.07701.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load data
data &lt;- list()
data[[1]] &lt;- as.matrix(read.csv(system.file("extdata", "dataset1.csv",
package = "coca"), row.names = 1))
data[[2]] &lt;- as.matrix(read.csv(system.file("extdata", "dataset2.csv",
package = "coca"), row.names = 1))
data[[3]] &lt;- as.matrix(read.csv(system.file("extdata", "dataset3.csv",
package = "coca"), row.names = 1))

# Build matrix of clusters
outputBuildMOC &lt;- buildMOC(data, M = 3, K = 5, distances = "cor")

# Extract matrix of clusters
moc &lt;- outputBuildMOC$moc

# Do Cluster-Of-Clusters Analysis
outputCOCA &lt;- coca(moc, K = 5)

# Extract cluster labels
clusterLabels &lt;- outputCOCA$clusterLabels

</code></pre>


</div>