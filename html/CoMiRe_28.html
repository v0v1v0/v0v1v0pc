<div class="container">

<table style="width: 100%;"><tr>
<td>post.pred.check</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Posterior predictive check plot</h2>

<h3>Description</h3>

<p>A plot for an object of <code>classCoMiRe</code> class. The plot is a goodness-of-fit assessment of CoMiRe model. 
Since Version 0.8 if <code>z</code> is provided into the <code>fit</code> object, an error message is returned.
If <code>family = 'continuous'</code>, a smoothed empirical estimate of F(a|x) = pr(y &lt; a | x) is computed from the observed data (black line) 
and from some of the data sets simulated from the posterior predictive distribution in  the <code>fit</code> object (grey lines).
If <code>family = 'binary'</code>, a smoothed empirical estimate of the proportion of events (black line) and of the smoothed empirical 
proportion of data simulated from the posterior predictive distribution in the <code>fit</code> object (grey lines). 
In the x axis are reported the observed exposures.
</p>


<h3>Usage</h3>

<pre><code class="language-R">post.pred.check(y, x, fit, mcmc, J=10, H=10, a, max.x=max(x), 
xlim=c(0, max(x)), bandwidth = 20, oneevery = 20)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>numeric vector for the response used in <code>comire.gibbs</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>numeric vector for the covariate relative to the dose of exposure used in <code>comire.gibbs</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>the output of <code>comire.gibbs</code> opportunely trasformed in <code>classCoMiRe</code> class</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcmc</code></td>
<td>
<p>a list giving the MCMC parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>J</code></td>
<td>
<p>parameter controlling the number of elements of the I-spline basis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>
<p>total number of components in the mixture at <code class="reqn">x_0</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>threshold of clinical interest to compute the F(a|x,z)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.x</code></td>
<td>
<p>maximum value allowed for x</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>numeric vectors of length 2, giving the x coordinates ranges for the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bandwidth</code></td>
<td>
<p>the kernel bandwidth smoothing parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>oneevery</code></td>
<td>
<p>integer number representing how many MCMC draws to plot in the posterior predictive check. It draws one sample every <code>oneevery</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Antonio Canale, Arianna Falcioni
</p>


<h3>Examples</h3>

<pre><code class="language-R">{
data(CPP)
attach(CPP)

n &lt;- NROW(CPP)
J &lt;- H &lt;- 10

premature &lt;- as.numeric(gestage&lt;=37)

mcmc &lt;- list(nrep=5000, nb=2000, thin=5, ndisplay=4)

## too few iterations to be meaningful. see below for safer and more comprehensive results

mcmc &lt;- list(nrep=10, nb=2, thin=1, ndisplay=4) 

prior &lt;- list(mu.theta=mean(gestage), k.theta=10, eta=rep(1, J)/J, 
              alpha=rep(1,H)/H, a=2, b=2, J=J, H=H)
              
fit.dummy &lt;- comire.gibbs(gestage, dde, family="continuous", 
                     mcmc=mcmc, prior=prior, seed=1, max.x=180)
                     
post.pred.check(y = gestage, x = dde, fit = fit.dummy, mcmc = mcmc, J = 10, H = 10, a = 37, 
                max.x = max(dde), xlim = c(0,150), oneevery = 4)
                

## safer procedure with more iterations (it may take some time)

mcmc &lt;- list(nrep=5000, nb=2000, thin=5, ndisplay=4)

## Fit the model for continuous y 

prior &lt;- list(mu.theta=mean(gestage), k.theta=10, eta=rep(1, J)/J, 
              alpha=rep(1,H)/H, a=2, b=2, J=J, H=H)
              
fit1 &lt;- comire.gibbs(gestage, dde, family="continuous", 
                     mcmc=mcmc, prior=prior, seed=5, max.x=180)

post.pred.check(y = gestage, x = dde, fit = fit1, mcmc = mcmc, J = 10, H = 10, a = 37, 
                max.x = max(dde), xlim = c(0,150))


}
</code></pre>


</div>