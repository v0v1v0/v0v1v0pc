<div class="container">

<table style="width: 100%;"><tr>
<td>plot.cglasso</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot Method for ‘<code>cglasso</code>’ Object</h2>

<h3>Description</h3>

<p>‘The <code>plot.cglasso</code>’ function produces plots to study the coefficient paths of fitted cglasso models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'cglasso'
plot(x, what = c("Theta", "diag(Theta)", "b0", "B"), 
     penalty = ifelse(x$nrho &gt;= x$nlambda, "rho", "lambda"), given = NULL,
     GoF = AIC, add.labels, matplot.arg1, matplot.arg2, labels.arg, abline.arg,
     mtext.arg, save.plot, grdev = pdf, grdev.arg, digits = 4L, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> object of class ‘<code>cglasso</code>’, that is, the output of the fitting function <code>cglasso</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>what</code></td>
<td>
<p>a character or a formula specifying the required plot. If <code>what</code> is a character, then it is used to specify the conditional coefficient path. Allowed descriptors are: ‘<code>Theta</code>’, the off-diagonal entries of the precision matrix, ‘<code>diag(Theta)</code>’, the diagonal entries of the precision matrix, ‘<code>b0</code>’, the intercepts of the conditional models, or equivalently the expected values of the response variables, and ‘<code>B</code>’, the regression coefficients. Optionally, ‘<code>what</code>’ can be a model formula (see sections Description and Examples for more details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty</code></td>
<td>
<p>optional character argument used to specify the tuning parameter needed to plot the conditional coefficient path. Allowed descriptors are ‘<code>rho</code>’ and ‘<code>lambda</code>’. This argument can be omitted if <code>what</code> is a model formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>given</code></td>
<td>
<p>an optional vector of integers identifying the conditioning values of the second tuning parameter to be used for the  coefficient profile plots of the parameters identified by the input ‘<code>what</code>’ across their corresponding tuning parameter. This argument is required only if ‘<code>what</code>’ is a character, otherwise it can be omitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GoF</code></td>
<td>
<p>a valid goodness-of-fit function, such as <code>AIC.cglasso</code> and <code>BIC.cglasso</code>, or an <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> object of class ‘<code>GoF</code>’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.labels</code></td>
<td>
<p>logical value. Should labels be added to the plot?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>matplot.arg1</code></td>
<td>
<p>a named list with the graphical parameters used to plot the paths of the estimates identified by ‘<code>GoF</code>’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>matplot.arg2</code></td>
<td>
<p>a named list with the graphical parameters used to plot the paths of the remaining estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels.arg</code></td>
<td>
<p>a named list with the graphical parameters used to plot the labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abline.arg</code></td>
<td>
<p>a named list with the graphical parameters used to plot the line identifying the optimal tuning parameter value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mtext.arg</code></td>
<td>
<p>a named list with the graphical parameters used to plot the text reported on the third axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save.plot</code></td>
<td>
<p>a logical variable or a string specifying the path of the directory where plots will be saved. Letting ‘<code>save.plot = TRUE</code>’, the required plots will be saved as external files inside the current working directory. User can save these files on a specific working directory passing the absolute path through the argument <code>save.plot</code>. On exit, working directory will be always set the previous one.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grdev</code></td>
<td>
<p>the graphics device used to save the required histograms on external files. See ‘<code>device</code>’ for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grdev.arg</code></td>
<td>
<p>additional parameters passed to the graphics device specified by ‘<code>grdev</code>’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>number of digits used to print the value of the second tuning parameter identified by ‘<code>given</code>’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to the chosen goodness-of-fit function, such as ‘<code>AIC</code>’ or ‘<code>BIC</code>’.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>plot.cglasso</code> produces the coefficient profile plot. The output depends both on the type of fitted model and on the setting of the three main arguments, <code>what</code>, <code>penalty</code> and <code>given</code>. Below we give more details.
</p>
<p>If the model fitting function <code>cglasso</code> is used to fit an l1-penalized censored Gaussian graphical model (see first part in Section Example), then the user can specify only the main argument ‘<code>what</code>’, whereas ‘<code>penalty</code>’ and ‘<code>given</code>’ can be omitted. If ‘<code>penalty</code>’ is specified, then it must be equal to “<code>rho</code>”. The main argument ‘<code>what</code>’ is used to specify the estimator that is plotted on the <code class="reqn">y</code>-axis. In this case, it must be equal to one of the following descriptors:
</p>

<ul>
<li> <p>“<code>Theta</code>”: the path of the estimated partial correlation coefficients is returned;
</p>
</li>
<li> <p>“<code>diag(Theta)</code>”: the path of the diagonal entries of the estimated  precision matrix is returned;
</p>
</li>
<li> <p>“<code>b0</code>”: the path of the estimated  expected values of the response variables is returned;
</p>
</li>
</ul>
<p>If a l1-penalized conditional censored Gaussian graphical model is fitted (see second part in Section Example), then all the main arguments can be used. In this case:
</p>

<ol>
<li> <p>‘<code>what</code>’ must be equal to one of the following descriptors:
</p>

<ul>
<li> <p>“<code>Theta</code>”: the path of the off-diagonal entries of the estimated precision matrix is returned;
</p>
</li>
<li> <p>“<code>diag(Theta)</code>”: the path of the estimated partial correlation coefficients is returned;
</p>
</li>
<li> <p>“<code>b0</code>”: the path of the estimated intercepts is returned;
</p>
</li>
<li> <p>“<code>B</code>”: the path of the estimated regression coefficients is returned for each response variable;
</p>
</li>
</ul>
</li>
<li> <p>‘<code>penalty</code>’ is used to specify the tuning parameter that is reported on the <code class="reqn">x</code>-axis and it must be equal to one of the following descriptors:
</p>

<ul>
<li> <p>“<code>rho</code>”: the tuning parameter used to penalize the precision matrix;
</p>
</li>
<li> <p>“<code>lambda</code>”: the tuning parameter used to penalize the regression coefficient matrix;
</p>
</li>
</ul>
</li>
<li> <p>‘<code>given</code>’ is an optional vector of integers used to specify the values of the second tuning parameter. For instance, letting <code>what = "Theta"</code>, <code>penalty = "rho"</code> and <code>given = 1</code> then <code>plot.cglasso</code> returns the plot of the estimated partial correlation coefficients versus the <code class="reqn">\rho</code>-values and given the first value of the used <code class="reqn">\lambda</code>-values. If <code>given</code> is left unspecified then a sequence of conditional profile plot is returned, a plot for each value of the second tuning parameter. 
</p>
</li>
</ol>
<p>Optionally, the user can specify a conditional profile plot using a model formula with the following template:
</p>
<p>‘<code>what ~ penalty | given</code>’
</p>
<p>For instance, the previous plot can be specified using the following model formula
</p>
<p>‘<code>Theta ~ rho | 1</code>’
</p>
<p>In this case, the arguments <code>penalty</code> and <code>given</code> must be left unspecified whereas <code>what</code> is used for the model formula (see also examples below).
</p>
<p>The optional argument <code>GoF</code> can be used to identify the non-zero estimates by the output of a goodness-of-fit function, such as <code>AIC.cglasso</code> and <code>BIC.cglasso</code>. In this case, a vertical red dashed line is used the identify the optimal value of the tuning parameter reported on the <code class="reqn">x</code>-axis, whereas the path of the identified non-zero estimates is drawn using a solid black line; the remaining paths are drawn using gray dashed lines. This option is disabled if we let ‘<code>GoF = NULL</code>’, when all the paths are drawn usign solid black lines.
</p>


<h3>Author(s)</h3>

<p>Luigi Augugliaro (<a href="mailto:luigi.augugliaro@unipa.it">luigi.augugliaro@unipa.it</a>)</p>


<h3>References</h3>

<p>Augugliaro L., Sottile G., Wit E.C., and Vinciotti V. (2023) &lt;<a href="https://doi.org/10.18637/jss.v105.i01">doi:10.18637/jss.v105.i01</a>&gt;.
cglasso: An R Package for Conditional Graphical Lasso Inference with Censored and Missing Values.
<em>Journal of Statistical Software</em> <b>105</b>(1), 1–58.
</p>
<p>Augugliaro, L., Abbruzzo, A., and Vinciotti, V. (2020a) &lt;<a href="https://doi.org/10.1093/biostatistics/kxy043">doi:10.1093/biostatistics/kxy043</a>&gt;.
<code class="reqn">\ell_1</code>-Penalized censored Gaussian graphical model.
<em>Biostatistics</em> <b>21</b>, e1–e16.
</p>
<p>Augugliaro, L., Sottile, G., and Vinciotti, V. (2020b) &lt;<a href="https://doi.org/10.1007/s11222-020-09945-7">doi:10.1007/s11222-020-09945-7</a>&gt;.
The conditional censored graphical lasso estimator.
<em>Statistics and Computing</em> <b>30</b>, 1273–1289.
</p>
<p>Friedman, J.H., Hastie, T., and Tibshirani, R. (2008) &lt;<a href="https://doi.org/10.1093/biostatistics/kxm045">doi:10.1093/biostatistics/kxm045</a>&gt;.
Sparse inverse covariance estimation with the graphical lasso.
<em>Biostatistics</em> <b>9</b>, 432–441.
</p>
<p>Stadler, N. and Buhlmann, P. (2012) &lt;<a href="https://doi.org/10.1007/s11222-010-9219-7">doi:10.1007/s11222-010-9219-7</a>&gt;.
Missing values: sparse inverse covariance estimation and an extension to sparse regression.
<em>Statistics and Computing</em> <b>22</b>, 219–235.
</p>


<h3>See Also</h3>

<p><code>cglasso</code>, <code>AIC.cglasso</code> and <code>BIC.cglasso</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(123)

################################################################################
# Model 1: censored glasso estimator (Augugliaro \emph{and other}, 2020a)
# Y ~ N(0, Sigma) and probability of left/right censored values equal to 0.05
################################################################################
n &lt;- 100L
p &lt;- 10L
rho &lt;- 0.3
Sigma &lt;- outer(1L:p, 1L:p, function(i, j) rho^abs(i - j))
Z &lt;- rcggm(n = n, Sigma = Sigma, probl = 0.05, probr = 0.05)
out &lt;- cglasso(. ~ ., data = Z)

# coefficient profile plot of the off-diagonal entries of the precision matrix
plot(out, what = "Theta")
# the same as
#plot(out, what = "Theta", penalty = "rho")

# the output of a goodness-of-fit function can be used to identify the 
# non-zero estimates
plot(out, what = "Theta", GoF = BIC)

# letting 'GoF = NULL' the previous option is disabled
plot(out, what = "Theta", GoF = NULL)

# coefficient profile plot of the diagonal entries of the precision matrix
plot(out, what = "diag(Theta)")

# coefficient profile plot of the expected values of the response variables
plot(out, what = "b0")

################################################################################
# Model 2: conditional censored glasso estimator (Augugliaro \emph{and other}, 2020b)
# Y ~ N(b0 + XB, Sigma)  and probability of left/right censored values equal to 0.05
################################################################################
n &lt;- 100L
p &lt;- 10L
q &lt;- 5L
b0 &lt;- runif(p)
B &lt;- matrix(runif(q * p), nrow = q, ncol = p)
X &lt;- matrix(rnorm(n * q), nrow = n, ncol = q)
rho &lt;- 0.3
Sigma &lt;- outer(1L:p, 1L:p, function(i, j) rho^abs(i - j))
Z &lt;- rcggm(n = n, b0 = b0, X = X, B = B, Sigma = Sigma, probl = 0.05, probr = 0.05)
out &lt;- cglasso(. ~ ., data = Z)

# conditional profile plot of the estimater partial correlation coefficients versus
# the used values of the tunin parameter rho and given the first lambda-value
plot(out, what = "Theta", penalty = "rho", given = 1L)
out$lambda[1L]

lambda.id &lt;- c(2, 4)
plot(out, what = "Theta", penalty = "rho", given = lambda.id)
out$lambda[lambda.id]

# in this case a sequence of ten conditional profile plots is returned, tha is a 
# plot for each lambda-value.
plot(out, what = "Theta", penalty = "rho")

# optionally, the user can specify the conditional profile plots using the model
# formula
plot(out, what = Theta ~ rho | lambda.id)
lambda.id

plot(out, what = Theta ~ rho)

# the output of a goodness-of-fit function can be used to identify the 
# non-zero estimates
plot(out, what = Theta ~ rho | 10, GoF = BIC)

# letting 'GoF = NULL' the previous option is disabled
plot(out, what = Theta ~ rho | 10, GoF = NULL)
</code></pre>


</div>