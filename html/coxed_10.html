<div class="container">

<table style="width: 100%;"><tr>
<td>coxed.gam.tvc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Predict expected durations using the GAM method with time-varying covariates</h2>

<h3>Description</h3>

<p>This function is called by <code>coxed</code> and is not intended to be used by itself.
</p>


<h3>Usage</h3>

<pre><code class="language-R">coxed.gam.tvc(cox.model, newdata = NULL, k = -1, coef = NULL,
  b.ind = NULL, warn = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cox.model</code></td>
<td>
<p>The output from a Cox proportional hazards model estimated
with the <code>coxph</code> function in the <code>survival</code> package
or with the <code>cph</code> function in the <code>rms</code>
package</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>An optional data frame in which to look for variables with
which to predict. If omitted, the fitted values are used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>The number of knots in the GAM smoother. The default is -1, which
employs the <code>choose.k</code> function from the <code>mgcv</code> package
to choose the number of knots</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef</code></td>
<td>
<p>A vector of new coefficients to replace the <code>coefficients</code> attribute
of the <code>cox.model</code>. Used primarily for bootstrapping, to recalculate durations
using new coefficients derived from a bootstrapped sample.
If <code>NULL</code>, the original coefficients are employed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b.ind</code></td>
<td>
<p>A vector of observation numbers to pass to the estimation sample to construct
the a bootstrapped sample with replacement</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warn</code></td>
<td>
<p>If <code>TRUE</code>, displays warnings, and if <code>FALSE</code> suppresses them</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function employs the GAM method of generating expected durations described
in Kropko and Harden (2018). See <code>coxed.gam</code> for details.  This code
replicates the code for <code>cox.gam</code>, but works with data whose structure allows time-varying
covariates, and requires using the <code>time2</code> argument of the <code>Surv</code> function.
This function requires the data to be reported as cumulative durations. The GAM model is fit using
the ending times for each interval and using only the non-censored observations. Expected durations
are drawn from this GAM as with <code>coxed.gam</code>.
</p>


<h3>Value</h3>

<p>Returns a list containing the following components:
</p>

<table>
<tr>
<td style="text-align: left;">
<code>exp.dur</code> </td>
<td style="text-align: left;"> A vector of predicted mean durations for the estimation sample
if <code>newdata</code> is omitted, or else for the specified new data.  </td>
</tr>
<tr>
<td style="text-align: left;">
<code>gam.model</code> </td>
<td style="text-align: left;"> Output from the <code>gam</code> function in which the durations
are fit against the exponentiated linear predictors from the Cox model.</td>
</tr>
<tr>
<td style="text-align: left;">
<code>gam.data</code> </td>
<td style="text-align: left;"> Fitted values and confidence intervals from the GAM model.</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jonathan Kropko &lt;jkropko@virginia.edu&gt; and Jeffrey J. Harden &lt;jharden2@nd.edu&gt;
</p>


<h3>References</h3>

<p>Kropko, J. and Harden, J. J. (2018). Beyond the Hazard Ratio: Generating Expected
Durations from the Cox Proportional Hazards Model. <em>British Journal of Political Science</em>
<a href="https://doi.org/10.1017/S000712341700045X">https://doi.org/10.1017/S000712341700045X</a>
</p>


<h3>See Also</h3>

<p><code>gam</code>, <code>coxed</code>, <code>coxed.gam</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">bs.surv &lt;- Surv(time = boxsteffensmeier$start, time2 = boxsteffensmeier$te,
     event = boxsteffensmeier$cut_hi)
bs.cox &lt;- coxph(bs.surv ~ ec + dem + south + iv, data = boxsteffensmeier, method = "breslow")
summary(bs.cox)

ed &lt;- coxed.gam.tvc(bs.cox)
ed$exp.dur
</code></pre>


</div>