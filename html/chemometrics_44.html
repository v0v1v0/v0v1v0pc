<div class="container">

<table style="width: 100%;"><tr>
<td>prm_dcv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Repeated double-cross-validation for robust PLS</h2>

<h3>Description</h3>

<p>Performs a careful evaluation by repeated double-CV for robust PLS, called
PRM (partial robust M-estimation).
</p>


<h3>Usage</h3>

<pre><code class="language-R">prm_dcv(X,Y,a=10,repl=10,segments0=4,segments=7,segment0.type="random",
  segment.type="random",sdfact=2,fairct=4,trim=0.2,opt="median",plot.opt=FALSE, ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>predictor matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>response variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>number of PLS components</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>repl</code></td>
<td>
<p>Number of replicattion for the double-CV</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>segments0</code></td>
<td>
<p>the number of segments to use for splitting into training and 
test data, or a list with segments (see <code>mvrCv</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>segments</code></td>
<td>
<p>the number of segments to use for selecting the optimal number if 
components, or a list with segments (see <code>mvrCv</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>segment0.type</code></td>
<td>
<p>the type of segments to use.  Ignored if 'segments0' is a list</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>segment.type</code></td>
<td>
<p>the type of segments to use.  Ignored if 'segments' is a list</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdfact</code></td>
<td>
<p>factor for the multiplication of the standard deviation for
the determination of the optimal number of components, see 
<code>mvr_dcv</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fairct</code></td>
<td>
<p>tuning constant, by default fairct=4</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trim</code></td>
<td>
<p>trimming percentage for the computation of the SEP</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opt</code></td>
<td>
<p>if "l1m" the mean centering is done by the l1-median,
otherwise if "median", by the coordinate-wise median</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.opt</code></td>
<td>
<p>if TRUE a plot will be generated that shows the selection of the
optimal number of components for each step of the CV</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In this cross-validation (CV) scheme, the optimal number of components is determined 
by an additional CV in the training set, and applied to the test set. The procedure 
is repeated repl times. The optimal number of components is the model with the 
smallest number of components which is still in the range of the MSE+sdfact*sd(MSE), 
where MSE and sd are taken from the minimum.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>estimated regression coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>estimated regression intercept</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resopt</code></td>
<td>
<p>array [nrow(Y) x ncol(Y) x repl] with residuals using optimum number 
of components</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predopt</code></td>
<td>
<p>array [nrow(Y) x ncol(Y) x repl] with predicted Y using optimum 
number of components</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optcomp</code></td>
<td>
<p>matrix [segments0 x repl] optimum number of components for each 
training set</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residcomp</code></td>
<td>
<p>array [nrow(Y) x ncomp x repl] with residuals using optimum number 
of components</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred</code></td>
<td>
<p>array [nrow(Y) x ncol(Y) x ncomp x repl] with predicted Y for all 
numbers of components</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SEPall</code></td>
<td>
<p>matrix [ncomp x repl] with SEP values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SEPtrim</code></td>
<td>
<p>matrix [ncomp x repl] with trimmed SEP values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SEPcomp</code></td>
<td>
<p>vector of length ncomp with trimmed SEP values; use the element 
afinal for the optimal trimmed SEP</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>afinal</code></td>
<td>
<p>final optimal number of components</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SEPopt</code></td>
<td>
<p>trimmed SEP over all residuals using optimal number of components</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Peter Filzmoser &lt;P.Filzmoser@tuwien.ac.at&gt; </p>


<h3>References</h3>

<p> K. Varmuza and P. Filzmoser: Introduction to Multivariate Statistical 
Analysis in Chemometrics. CRC Press, Boca Raton, FL, 2009. </p>


<h3>See Also</h3>

<p><code>mvr</code></p>


<h3>Examples</h3>

<pre><code class="language-R">data(NIR)
X &lt;- NIR$xNIR[1:30,]      # first 30 observations - for illustration
y &lt;- NIR$yGlcEtOH[1:30,1] # only variable Glucose
NIR.Glc &lt;- data.frame(X=X, y=y)
res &lt;- prm_dcv(X,y,a=3,repl=2)
</code></pre>


</div>