<div class="container">

<table style="width: 100%;"><tr>
<td>linkd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function to impute missing agreement patterns and then to link data</h2>

<h3>Description</h3>

<p>Function to impute missing agreement patterns and then to link data
</p>


<h3>Usage</h3>

<pre><code class="language-R">linkd(d, initial_m = NULL, initial_u = NULL, p_init = 0.5,
  fixed_col = NULL, alg = "m")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>Matrix of agreement patterns with final column counting the number of times that pattern was observed.  See Details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial_m</code></td>
<td>
<p>starting probabilities for per-field agreement in record pairs, both records being generated from the same individual.  Defaults to NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial_u</code></td>
<td>
<p>starting probabilities for per-field agreement in record pairs, with the two records being generated from differing individuals  Defaults to NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_init</code></td>
<td>
<p>starting probability that both records for a randomly selected record pair is associated with the same individual</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed_col</code></td>
<td>
<p>vector indicating columns that are not to be updated in initial EM algorithm.  Useful if good prior estimates of the mis-match probabilities.  See details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alg</code></td>
<td>
<p>character; see Details</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>d</code> is a numeric matrix with N rows corresponding to N record pairs, and L+1 columns the first L of which show the field agreement patterns observed over the record pairs, and the last column the total number of times that pattern was observed in the database.  The code 0 is used for a field that differs for two record, 1 for a field that agrees, and 2 for a missing field. <code>fixed_col</code> indicates the components of the <code>u</code> vector (per field probabilities of agreement for 2 records from differing individuals) that are not to be updated when applying the EM algorithm to estimate components of the Feligi Sunter model.  <code>alg</code> has four possible values.  The default <code>'m'</code> fits a log-linear model for the agreement counts only within the record pairs that corresponds to the same individual, <code>'b'</code> fits differing log-linear models for the 2 clusters, <code>'i'</code> corresponds to the original Feligi Sunter algorithm, with probabilities estimated via the EM algorithm, <code>'a'</code> fits all the previously listed models
</p>


<h3>Value</h3>

<p>A list, the first component is a matrix -  the posterior probabilities of being a true match is the last column, the second component are the fitted models used to generate the predicted probabilities
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Simulate data
m_probs &lt;- rep(0.8,6)
u_probs &lt;- rep(0.2,6)
means_match &lt;- -1*qnorm(1-m_probs)
means_mismatch &lt;- -1*qnorm(1-u_probs)
missingprobs &lt;- rep(.2,6)
thedata &lt;- do_sim(cor_match=0.2,cor_mismatch=0,nsample=10^4,pi_match=.5,
m_probs=rep(0.8,5),u_probs=rep(0.2,5),missingprobs=rep(0.4,5))
colnames(thedata) &lt;- c(paste("V",1:5,sep="_"),"count")
output &lt;- linkd(thedata)
output$fitted_probs
</code></pre>


</div>