<div class="container">

<table style="width: 100%;"><tr>
<td>expectation-methods</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extraction of the Expectation, Variance and Covariance of the Linear
Statistic</h2>

<h3>Description</h3>

<p>Methods for extraction of the expectation, variance and covariance of the
linear statistic.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'IndependenceLinearStatistic'
expectation(object, partial = FALSE, ...)
## S4 method for signature 'IndependenceTest'
expectation(object, partial = FALSE, ...)

## S4 method for signature 'Variance'
variance(object, ...)
## S4 method for signature 'CovarianceMatrix'
variance(object, ...)
## S4 method for signature 'IndependenceLinearStatistic'
variance(object, partial = FALSE, ...)
## S4 method for signature 'IndependenceTest'
variance(object, partial = FALSE, ...)

## S4 method for signature 'CovarianceMatrix'
covariance(object, ...)
## S4 method for signature 'IndependenceLinearStatistic'
covariance(object, invert = FALSE, partial = FALSE, ...)
## S4 method for signature 'QuadTypeIndependenceTestStatistic'
covariance(object, invert = FALSE, partial = FALSE, ...)
## S4 method for signature 'IndependenceTest'
covariance(object, invert = FALSE, partial = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>an object from which the expectation, variance or covariance of the linear
statistic can be extracted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>partial</code></td>
<td>

<p>a logical indicating that the partial result for each block should be
extracted.  Defaults to <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>invert</code></td>
<td>

<p>a logical indicating that the Moore-Penrose inverse of the covariance should
be extracted.  Defaults to <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>further arguments (currently ignored).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The methods <code>expectation</code>, <code>variance</code> and <code>covariance</code> extract
the expectation, variance and covariance, respectively, of the linear
statistic.
</p>
<p>For tests of conditional independence within blocks, the partial result for
each block is obtained by setting <code>partial = TRUE</code>.
</p>


<h3>Value</h3>

<p>The expectation, variance or covariance of the linear statistic extracted from
<code>object</code>.  A matrix or array.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Example data
dta &lt;- data.frame(
    y = gl(3, 2),
    x = sample(gl(3, 2))
)

## Asymptotic Cochran-Mantel-Haenszel Test
ct &lt;- cmh_test(y ~ x, data = dta)

## The linear statistic, i.e., the contingency table...
(T &lt;- statistic(ct, type = "linear"))

## ...and its expectation...
(mu &lt;- expectation(ct))

## ...and variance...
(sigma &lt;- variance(ct))

## ...and covariance...
(Sigma &lt;- covariance(ct))

## ...and its inverse
(SigmaPlus &lt;- covariance(ct, invert = TRUE))

## The standardized contingency table...
(T - mu) / sqrt(sigma)

## ...is identical to the standardized linear statistic
statistic(ct, type = "standardized")

## The quadratic form...
U &lt;- as.vector(T - mu)
U %*% SigmaPlus %*% U

## ...is identical to the test statistic
statistic(ct, type = "test")
</code></pre>


</div>