<div class="container">

<table style="width: 100%;"><tr>
<td>crrstep</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Stepwise regression for competing risks regression</h2>

<h3>Description</h3>

<p>Performs forward and backward stepwise regression for the Fine &amp; Gray regression model in competing risks. Procedure uses AIC, BIC and BICcr as selection criteria. BICcr has a penalty of k = log(n*), where n* is the number of Type I events.
</p>


<h3>Usage</h3>

<pre><code class="language-R">crrstep(formula, scope.min = ~1, etype, ..., subset, 
data, direction = c("backward", "forward"), 
criterion = c("AIC", "BICcr", "BIC"), crr.object = FALSE, 
trace = TRUE, steps = 100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>

<p>formula object where LHS is failure time and RHS is linear predictors; intercept ‘1’ should always be included.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scope.min</code></td>
<td>

<p>formula object denoting final model for backward selection and starting model for forward selection.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>etype</code></td>
<td>

<p>integer variable that denotes type of failure for each person.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>variables passed to ‘crr’ function; two key variables are <em>failcode</em> and <em>cencode</em>; see below in <code>Description</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>

<p>subset of data to be used for model selection.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>data-frame containing all the variables. Only complete cases are used in the analysis, i.e. rows of dataframe with missing values in any of the predictors are deleted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>direction</code></td>
<td>

<p>forward or backward direction for model selection.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>

<p>selection criterion; default is AIC.  BIC uses log(n) as penalty, where ‘n’ is total sample size, and BICcr uses log(n*) as the penalty where n* is the number of primary events.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crr.object</code></td>
<td>

<p>logical variable indicating whether to return final ‘crr’ object.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>

<p>logical indicating whether to display stepwise model selection process.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>steps</code></td>
<td>

<p>maximum number of steps in stepwise selection.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Based on the existing code of stepAIC in the MASS package. Variables passed to 'crr' function include two key variables: <em>failcode</em> and <em>cencode</em>. <em>failcode</em> is an integer value that denotes primary failure, and <em>cencode</em> is an integer denoting censoring event.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>variables</code></td>
<td>
<p>Variables in the final model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>The estimated coefficients of the variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>std.errors</code></td>
<td>
<p>Standard errors of the estimated coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.lik</code></td>
<td>
<p>The partial log-likelihood of the model</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Ravi Varadhan &amp; Deborah Kuk.
</p>


<h3>References</h3>

<p>Fine, J. P. and Gray, R. J. (1999). A proportional hazards model for
the subdistribution of a competing risk. Journal of the American Statistical
Association.
</p>
<p>Volinsky, C. T. and Raftery, A. E. (2000). Bayesian information criterion
for censored survival models. Biometrics.
</p>
<p>Kuk, D. and Varadhan, R. (2013). Model selection in competing risks regression. <em>Statistics in Medicine</em>. 
</p>


<h3>See Also</h3>

<p><code>crr</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(123)
n &lt;- 500
ftime &lt;- rexp(n)
fstatus &lt;- sample(0:2,n,replace=TRUE)
cov1 &lt;- matrix(runif(5*n),nrow=n)
x61 &lt;- as.factor(sample(3, size=n, rep=TRUE))
x71 &lt;- as.factor(sample(5, size=n, rep = TRUE))
cov1 &lt;- cbind(cov1, x61, x71)
dimnames(cov1)[[2]] &lt;- c('x1','x2','x3','x4','x5', 'x6', 'x7')
formula1 &lt;- ftime ~ x1 + x2 + x3 + x4 + x5 + as.factor(x6) + as.factor(x7) 

crrstep(formula1, , fstatus, data = as.data.frame(cov1), direction = "backward", criterion = "BIC")

ans2 &lt;- crrstep(formula1, , fstatus, data = as.data.frame(cov1), direction = "forward", 
		failcode=2, criterion = "AIC")
ans2

</code></pre>


</div>