<div class="container">

<table style="width: 100%;"><tr>
<td>resource_update</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Update a resource</h2>

<h3>Description</h3>

<p>This function can be used to update a resource's file attachment
and "extra" metadata fields. Any update will also set the metadata key
"last_updated". Other metadata, such as name or description, are not updated.
</p>
<p>The new file must exist on a local path. R objects have to be written to a
file, e.g. using <code>tempfile()</code> - see example.
</p>
<p>For convenience, CKAN base url and API key default to the global options,
which are set by <code>ckanr_setup</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">resource_update(
  id,
  path = NULL,
  extras = list(),
  url = get_default_url(),
  key = get_default_key(),
  as = "list",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>(character) Resource ID to update (required)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>path</code></td>
<td>
<p>(character) Local path of the file to upload (optional)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extras</code></td>
<td>
<p>(list) - the resources' extra metadata fields (optional)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>url</code></td>
<td>
<p>Base url to use. Default: https://data.ontario.ca/ See
also <code>ckanr_setup</code> and <code>get_default_url</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>key</code></td>
<td>
<p>A privileged CKAN API key, Default: your key set with
<code>ckanr_setup</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>as</code></td>
<td>
<p>(character) One of list (default), table, or json. Parsing with
table option uses <code>jsonlite::fromJSON(..., simplifyDataFrame = TRUE)</code>,
which attempts to parse data to data.frame's when possible, so the result
can vary from a vector, list or data.frame. (required)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Curl args passed on to <code>verb-POST</code> (optional)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The HTTP response from CKAN, formatted as list (default), table,
or JSON.
</p>


<h3>References</h3>

<p>http://docs.ckan.org/en/latest/api/index.html#ckan.logic.action.create.resource_create
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
ckanr_setup(url = "https://demo.ckan.org/", key = getOption("ckan_demo_key"))

# Get file
path &lt;- system.file("examples", "actinidiaceae.csv", package = "ckanr")

# Create package, then a resource within that package
(res &lt;- package_create("newpackage10"))
(xx &lt;- resource_create(package_id = res$id,
                       description = "my resource",
                       name = "bears",
                       upload = path,
                       rcurl = "http://google.com"
))

# Modify dataset, here lowercase strings in one column
dat &lt;- read.csv(path, stringsAsFactors = FALSE)
dat$Family &lt;- tolower(dat$Family)
newpath &lt;- tempfile(fileext = ".csv")
write.csv(dat, file = newpath, row.names = FALSE)

# Upload modified dataset
## Directly from output of resource_create
resource_update(xx, path=newpath)

## or from the resource id
resource_update(xx$id, path=newpath)

## optionally include extra tags
resource_update(xx$id, path=newpath,
                extras = list(some="metadata"))
                
# Update a resource's extra tags
## add extra tags without uploading a new file
resource_update(id,
                extras = list(some="metadata"))

## or remove all extra tags
resource_update(id, extras = list())                 

#######
# Using default settings
ckanr_setup(url = "http://demo.ckan.org/", key = "my-demo-ckan-org-api-key")
path &lt;- system.file("examples", "actinidiaceae.csv", package = "ckanr")
resource_update(id="an-existing-resource-id", path = path)

# Using an R object written to a tempfile, and implicit CKAN URL and API key
write.csv(data &lt;- installed.packages(), path &lt;- tempfile(fileext = ".csv"))
ckanr_setup(url = "http://demo.ckan.org/", key = "my-demo-ckan-org-api-key")
resource_update(id="an-existing-resource-id", path = path)

# Testing: see ?ckanr_setup to set default test CKAN url, key, package id
ckanr_setup(test_url = "http://my-ckan.org/",
            test_key = "my-ckan-api-key",
            test_did = "an-existing-package-id",
            test_rid = "an-existing-resource-id")
resource_update(id = get_test_rid(),
                path = system.file("examples",
                                   "actinidiaceae.csv",
                                   package = "ckanr"),
                key = get_test_key(),
                url = get_test_url())

# other file formats
## html
path &lt;- system.file("examples", "mapbox.html", package = "ckanr")

# Create package, then a resource within that package
(res &lt;- package_create("mappkg"))
(xx &lt;- resource_create(package_id = res$id,
                       description = "a map, yay",
                       name = "mapyay",
                       upload = path,
                       rcurl = "http://google.com"
))
browseURL(xx$url)

# Modify dataset, here lowercase strings in one column
dat &lt;- readLines(path)
dat &lt;- sub("-111.06", "-115.06", dat)
newpath &lt;- tempfile(fileext = ".html")
cat(dat, file = newpath, sep = "\n")

# Upload modified dataset
## Directly from output of resource_create
(xxx &lt;- resource_update(xx, path=newpath))
browseURL(xxx$url)

## End(Not run)
</code></pre>


</div>