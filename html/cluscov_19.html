<div class="container">

<table style="width: 100%;"><tr>
<td>linrclus</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Linear regression via coordinate descent with covariate clustering</h2>

<h3>Description</h3>

<p>Covariate assignment to k clusters using the coordinate descent algorithm. This
function is a wrapper for the <code>C</code> function <code>linreg_coord_clus</code>
</p>


<h3>Usage</h3>

<pre><code class="language-R">linrclus(Y, X, k, coefs, clus, clusmns, nC = 1, x = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>vector of outcome variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>matrix of covariates. Should not include 1's for the intercept</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>number of clusters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefs</code></td>
<td>
<p>vector of coefficients as starting values. Should not include the intercept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clus</code></td>
<td>
<p>vector of covariate cluster assignments as starting values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clusmns</code></td>
<td>
<p>vector k cluster parameter centers</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nC</code></td>
<td>
<p>first nC-1 covariates in X not to cluster. Must be at least 1 for the intercept</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a logical for returning the design matrix</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>clus cluster assignments
</p>
<p>coefs vector of coefficients as starting values
</p>
<p>clusmns vector of cluster means
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(14) #Generate data
N = 1000; (bets = rep(-2:2,4)); p = length(bets); X = matrix(rnorm(N*p),N,p)
Y = cbind(1,X)%*%matrix(c(0.5,bets),ncol = 1)
begin_v&lt;- rep(NA,p)
for (j in 1:p) {
 begin_v[j] = stats::coef(lm(Y~X[,j]))[2]
}
set.seed(12); klus_obj&lt;- kmeans(begin_v,centers = 5)
linrclus(Y,X,k=5,coefs=c(0,begin_v),clus=klus_obj$cluster,clusmns=klus_obj$centers)
</code></pre>


</div>