<div class="container">

<table style="width: 100%;"><tr>
<td>cramer_vonmises</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cramér-von-Mises criterion</h2>

<h3>Description</h3>

<p>Calculate the Cramér-von-Mises criterion
with a p-value (via parametric bootstrapping) to assess the goodness of fit
of a parametric copula compared to the empirical copula of the data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cramer_vonmises(
  copula,
  theta,
  x,
  n_bootstrap = 1000,
  parameters = NULL,
  optim.method = "L-BFGS-B",
  optim.control = list(maxit = 100)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>copula</code></td>
<td>
<p><span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> object of class '<code>cyl_copula</code>' or
'<code>Copula</code>' (package '<span class="pkg">copula</span>'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>numeric vector of angles
(measurements of a circular variable) or "circular" component of pseudo-observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>numeric vector of step lengths
(measurements of a linear variable) or "linear" component of pseudo-observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_bootstrap</code></td>
<td>
<p>integer number of bootstrap replicates. If
<code>n_bootstrap</code> is smaller than 1, no p-value is calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameters</code></td>
<td>
<p>vector of character strings
holding the names of the parameters to be optimized when using the bootstrap
procedure.
These can be any parameters in <code>copula@parameters</code>. Default is to
optimize the first 2 parameters. <code>parameters</code> has no effect if <code>copula</code>
is of class '<code>Copula</code>' (package '<span class="pkg">copula</span>'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optim.method</code></td>
<td>
<p>character string, optimizer used in
<code>optim()</code>, can be
<code>"Nelder-Mead"</code>, <code>"BFGS"</code>, <code>"CG"</code>, <code>"L-BFGS-B"</code>,
<code>"SANN"</code>, or <code>"Brent"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optim.control</code></td>
<td>
<p>list of additional controls passed to
<code>optim()</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Cramér-von Misses criterion is calculated as the sum of the squared
differences between the empirical copula and the parametric copula, <code>copula</code>,
evaluated at the pseudo-observations obtained from <code>theta</code> and <code>x</code>.
If the bootstrap procedure is used, a random sample is drawn from <code>copula</code>
and converted to pseudo-observations. A new (set of) copula parameter(s) is then
fit to those pseudo-observations using maximum likelihood (function
<code>cylcop::fit_cylcop_ml()</code>).
</p>


<h3>Value</h3>

<p>A list of length 2 containing the Cramér-von Mises criterion and the p-value.
</p>


<h3>References</h3>

<p>Genest C, Rémillard B (2008).
“Validity of the parametric bootstrap for goodness-of-fit testing in semiparametric models.”
<em>Annales de l'Institut Henri Poincaré, Probabilités et Statistiques</em>, <b>44</b>(6), 1096 – 1127.
<a href="https://doi.org/10.1214/07-AIHP148">doi:10.1214/07-AIHP148</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1234)
sample &lt;- rcylcop(100,cyl_cubsec(0.1, 0.1))

opt_cop &lt;- fit_cylcop_ml(copula = cyl_quadsec(),
  theta = sample[,1],
  x = sample[,2],
  parameters = "a",
  start = 0
)$copula
cramer_vonmises(opt_cop,
  theta = sample[,1],
  x = sample[,2],
  n_bootstrap=5)

</code></pre>


</div>