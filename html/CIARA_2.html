<div class="container">

<table style="width: 100%;"><tr>
<td>CIARA_gene</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>CIARA_gene</h2>

<h3>Description</h3>

<p>The gene expression is binarized (1/0) if the value in a given cell is
above/below the median. Each of cell with its first K nearest neighbors
defined a local region. If there are at least <em>local_region</em> enriched
in 1 according to <em>fisher.test</em>, then the gene is defined as highly
localized and a final p value is assigned to it. The final p value is the
minimum of the p values from all the enriched local regions. If there are no
enriched local regions, then the p value by default is set to 1
</p>


<h3>Usage</h3>

<pre><code class="language-R">CIARA_gene(
  norm_matrix,
  knn_matrix,
  gene_expression,
  p_value = 0.001,
  odds_ratio = 2,
  local_region = 1,
  approximation = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>norm_matrix</code></td>
<td>
<p>Norm count matrix (n_genes X n_cells).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knn_matrix</code></td>
<td>
<p>K-nearest neighbors matrix (n_cells X n_cells).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gene_expression</code></td>
<td>
<p>numeric vector with the gene expression (length equal
to n_cells). The gene expression is binarized (equal to 0/1 in the cells
where the value is below/above the median)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_value</code></td>
<td>
<p>p value returned by the function <em>fisher.test</em> with
parameter alternative = "g"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>odds_ratio</code></td>
<td>
<p>odds_ratio returned by the function <em>fisher.test</em>
with parameter alternative = "g"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>local_region</code></td>
<td>
<p>Integer. Minimum number of local regions (cell with its
knn neighbours) where the binarized gene expression is enriched in 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>approximation</code></td>
<td>
<p>Logical.For a given gene, the fisher test is run in the
local regions of only the cells where the binarized gene expression is 1.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>List with one element corresponding to the p value of the gene.
</p>


<h3>Author(s)</h3>

<p>Gabriele Lubatti <a href="mailto:gabriele.lubatti@helmholtz-muenchen.de">gabriele.lubatti@helmholtz-muenchen.de</a>
</p>


<h3>See Also</h3>

<p><a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/fisher.test">https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/fisher.test</a>
</p>


</div>