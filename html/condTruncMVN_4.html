<div class="container">

<table style="width: 100%;"><tr>
<td>rcmvtruncnorm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Random Sample from Conditional Truncated Multivariate Normal</h2>

<h3>Description</h3>

<p>Randomly samples from conditional truncated multivariate normal distribution variate, <strong>Y|X</strong>, where <strong>Z = (X, Y)</strong> is the fully joint multivariate normal distribution with <code>mean</code>, covariance matrix <code>sigma</code>, and truncated between <code>lower</code> and <code>upper</code>.  See the vignette for more information.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rcmvtruncnorm(
  n,
  mean,
  sigma,
  lower,
  upper,
  dependent.ind,
  given.ind,
  X.given,
  init = rep(0, length(mean)),
  burn = 10L,
  thin = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of random samples desired (sample size).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p>the mean vector for Z of length of n</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>the symmetric and positive-definite covariance matrix of dimension n x n of Z.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>a vector of lower bounds of length n that truncate Z</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>a vector of upper bounds of length n that truncate Z</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dependent.ind</code></td>
<td>
<p>a vector of integers denoting the indices of dependent variable Y.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>given.ind</code></td>
<td>
<p>a vector of integers denoting the indices of conditioning variable X.  If specified as integer vector of length zero or left unspecified, the unconditional density is returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X.given</code></td>
<td>
<p>a vector of reals denoting the conditioning value of X. This should be of the same length as <code>given.ind</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>initial value used for random generation of truncated multivariate normal in a Gibbs sampler. Default: A vector of zeros, equal to the number of components. For details, see tmvmixnorm::<code>rtmvn</code>().</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn</code></td>
<td>
<p>the burn-in, which is the number of initial iterations to be discarded. Default: 10. Passed to <code>rtmvn</code>().</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>
<p>thinning lag (default as <code>1</code>).</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Uses <code>rtmvn</code> from the <strong>tmvmixnorm</strong> package to find the random variate.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Generate 2 random numbers from X2,X3,X5|X2,X4 ~ N_3(1, Sigma)
# truncated between -10 and 10.
d &lt;- 5
rho &lt;- 0.9
Sigma &lt;- matrix(0, nrow = d, ncol = d)
Sigma &lt;- rho^abs(row(Sigma) - col(Sigma))

set.seed(2342)
rcmvtruncnorm(2,
  mean = rep(1, d),
  sigma = Sigma,
  lower = rep(-10, d),
  upper = rep(10, d),
  dependent.ind = c(2, 3, 5),
  given.ind = c(1, 4), X.given = c(1, -1)
)

# Example 2: Generate two random numbers from
# X1|X2, X3, X4, X5 ~ N(1, Sigma) truncated between -10 and 10.
set.seed(2342)
rcmvtruncnorm(2,
  mean = rep(1, d),
  sigma = Sigma,
  lower = rep(-10, d),
  upper = rep(10, d),
  dependent.ind = 1,
  given.ind = 2:5, X.given = c(1, -1, 1, -1)
)
</code></pre>


</div>