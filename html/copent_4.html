<div class="container">

<table style="width: 100%;"><tr>
<td>cpd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Single change point detection with copula entropy based two-sample test </h2>

<h3>Description</h3>

<p>Single change point detection with copula entropy based two-sample test.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cpd(x,thd=0.13,n=15,k=3,dt=2,ncores=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> data with each row as a sample of d-dimensional random variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thd</code></td>
<td>
<p> threshold of the statistic of two-sample test for detecting a change point, default = 0.13</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p> the argument used by two-sample test, default = 15</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p> kth nearest neighbour, default = 3</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dt</code></td>
<td>
<p> the type of distance between samples, 1 for Eclidean distance; 2 for Maximum distance. default = 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p> number of cores to be used for parallel computing, default = 0 for all the cores</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This program involves detecting single change point in univariate or multivariate time series data with copula entropy based two-sample test. It was proposed in Ma (2024), in which a group of two-sample tests are performed on time series data and the change point is considered to be associated with the maximum of the statistics of all the tests. 
</p>
<p>The argument <b>x</b> is for the data with each row as a sample of d-dimensional random variables. The argument <b>thd</b> is for the threshold of the statistic of two-sample test for detecting a change point. If the maximum of the statistics of all the two-sample tests is below the threshold, no change point is detected. The argument <b>n</b> is the argument used by the two-sample test function <code>tst</code>. The argument <b>k</b> and <b>dt</b> is used in the kNN method for estimating entropy. <b>k</b> is for the kth nearest neighbour (default = 3) and <b>dt</b> is for the type of distance between samples which has currently two value options (1 for Eclidean distance, and 2(default) for Maximum distance). The argument <b>ncores</b> is for the number of cores to be used for parallel computing. If the default 0 is used, then all the cores will be used.
</p>


<h3>Value</h3>

<p>The function returns a list containing
</p>
<table>
<tr style="vertical-align: top;">
<td><code>stats</code></td>
<td>
<p>the estimated statistics of all the two-sample tests</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxstat</code></td>
<td>
<p>the maximum of the estimated statistics</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos</code></td>
<td>
<p>the change point detected</p>
</td>
</tr>
</table>
<h3>References</h3>

 
<p>Ma, Jian. Change Point Detection with Copula Entropy based Two-Sample Test. arXiv preprint arXiv:2403.07892, 2024.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
x = c(rnorm(15,0,1),rnorm(15,0,10))
cpd(x,thd=0.15,ncores=2)

</code></pre>


</div>