<div class="container">

<table style="width: 100%;"><tr>
<td>permutest.coca</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Permutation test for predictive co-correspondence analysis
models</h2>

<h3>Description</h3>

<p>A permutation test for predictive co-correspondence analysis models to
assess the significance of each CoCA ordination axes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'coca'
permutest(x, R0 = NULL, permutations = 99,
               n.axes = x$n.axes, verbose = TRUE, ...)



## S3 method for class 'permutest.coca'
summary(object, ...)



</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> an object of class <code>"predcoca"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R0</code></td>
<td>
<p> row weights to use in the analysis. If missing, the
default, these are determined from <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>permutations</code></td>
<td>
<p> the number of permutations to perform.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.axes</code></td>
<td>
<p> The number of axes to test. Defaults to the number of
axes stated in <code>x$n.axes</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>if <code>TRUE</code>, the default, print information on the
progress of the permutation test procedure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p> an object of class <code>"permutest.coca"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments to be passed to other methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>An alternative approach to cross-validation (see
<code>crossval</code>) to select the number of axes to retain in a
predictive co-correspondence analysis is to test the statistical
significance of each ordination axis using permutation tests.
</p>
<p>The test statistic used is the <em>F</em>-ratio based on the fit of the
first axis to the response data (ter Braak and Smilauer 2002). The
second and subsequent axes are tested by treating previous axes as
co-variables.
</p>
<p>To be precise, this approach does not test the significance of SIMPLS
axes, but those of NIPALS-PLS axes (ter Braak and de Jong 1998).
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>pval </code></td>
<td>
<p>a vector of <em>P</em>-values for each ordination axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>permstat </code></td>
<td>
<p>a vector of values for the test statistic for each axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>total.inertia </code></td>
<td>
<p>the total inertia in the response matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inertia </code></td>
<td>
<p>a vector containing the <em>residualised</em>
inertia. This is the total inertia in the response <em>after</em>
removing the inertia explained by all previous axes. For the first
CoCA axis this is, by definition, the total inertia in the
response.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitax </code></td>
<td>
<p>a vector containing the amount of inertia in the
response matrix explained by each ordination axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pcent.fit </code></td>
<td>
<p>a vector containing the fit of each axis to the
response as a percentage of the total inertia (variance).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.axes </code></td>
<td>
<p>the number of axes in the ordination.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call </code></td>
<td>
<p>the matched call.</p>
</td>
</tr>
</table>
<h3>Warning</h3>

<p>This function is <b>slow</b>. Beware setting argument
<code>permutations</code> higher than the default. Determine how long it
takes for the default 99 permutations to complete before going crazy
and asking for thousands of permutations - you've been warned, have a
good book to hand.
</p>


<h3>Note</h3>

<p>Argument <code>R0</code> is provided for compatibility with the original
MATLAB code. The R usage paradigm makes this argument redundant in the
current code and it may be invalid to supply different row weights
(<code class="reqn">R_0</code>) as <code>R0</code>. This argument will likely be removed in future
versions.
</p>


<h3>Author(s)</h3>

<p>Gavin L. Simpson, based on Matlab code by C.J.F. ter Braak and
A.P. Schaffers.</p>


<h3>References</h3>

<p>ter Braak, C.J.F. and de Jong, S. (1998) The objective function of
partial least squares regression. <em>Journal of Chemometrics</em>
<b>12</b>, 41–54.
</p>
<p>ter Braak, C.J.F and Schaffers, A.P. (2004) Co-Correspondence
Analysis: a new ordination method to relate two community
compositions. <em>Ecology</em> <b>85(3)</b>, 834–846.
</p>
<p>ter Braak, C.J.F. and Smilauer, P. (2002) <em>Canoco reference manual
and CanoDraw for Windows user's guide: software for canonical
community ordination. Version 4.5</em>. New York: Microcomputer Power.
</p>


<h3>See Also</h3>

<p><code>coca</code>, for the model fitting function,
<code>crossval</code>, for a leave-one-out cross-validation
procedure, which is the preferred way to select axes in a predictive
co-correspondence analysis.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## load some data
data(beetles)
data(plants)

## log transform the bettle data
beetles &lt;- log(beetles + 1)
## predictive CoCA using SIMPLS and formula interface
bp.pred &lt;- coca(beetles ~ ., data = plants)

## should retain only the useful PLS components for a parsimonious model

## Leave-one-out crossvalidation - this takes a while
crossval(beetles, plants)
## so 2 axes are sufficient


## permutation test
## (Testing the first 2 axes &amp; only 25 perms for speed.)
bp.perm &lt;- permutest(bp.pred, permutations = 25, n.axes = 2)
bp.perm


</code></pre>


</div>