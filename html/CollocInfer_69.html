<div class="container">

<table style="width: 100%;"><tr>
<td>ParsMatch</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate of Parameters from Smooth</h2>

<h3>Description</h3>

<p> Objective function and derivatives to estimate parameters with a fixed smooth.  </p>


<h3>Usage</h3>

<pre><code class="language-R">ParsMatchOpt(pars,coefs,proc,active=1:length(pars),meth='nlminb',control=list())

ParsMatchErr(pars,coefs,proc,active=1:length(pars),allpars,sgn=1)

ParsMatchDP(pars,coefs,proc,active=1:length(pars),allpars,sgn=1)

ParsMatchList(pars,coefs,proc,active=1:length(pars),allpars,sgn=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pars</code></td>
<td>
<p> Initial values of parameters to be estimated processes. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefs</code></td>
<td>
<p> Vector giving the current estimate of the coefficients in the spline. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proc</code></td>
<td>
 <p><code>proc</code> object defining the state process. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>active</code></td>
<td>
<p> Incides indicating which parameters of <code>allpar</code> should be estimated; defaults to all of them.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allpars</code></td>
<td>
<p>  Vector of all parameters, the assignment <code>allpar[active]=pars</code> is made initially.   </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sgn</code></td>
<td>
<p> Is the minimizing (1) or maximizing (0)? </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meth</code></td>
<td>
<p> Optimization function currently one of 'nlminb', 'MaxNR', 'optim' or 'trust'. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p> Control object for optimization function. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>These routines fix the estimated states at the value given by <code>coefs</code>
and estimate <code>pars</code> to maximize agreement between the fixed state and the objective
given by the <code>proc</code> object.
</p>
<p>A number of optimization routines have been implemented in <code>FitMatchOpt</code>, some experimentation is advised.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ParsMatchOpt</code></td>
<td>
<p>A list containing:
</p>

<ul>
<li>
<p>parsThe entire parameter vector after optimization.
</p>
</li>
<li>
<p>resThe output of the optimization routine.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ParsMatchErr</code></td>
<td>
<p>The value of the process likelihood at the current estimated states.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ParsMatchDP</code></td>
<td>
<p>The derivative fo <code>ParsMatchErr</code> with respect to <code>pars[active]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ParsMatchList</code></td>
<td>
<p>A list with entries <code>value</code> and <code>gradient</code> given by the output
of <code>ParsMatchErr</code> and <code>ParsMatchDP</code> respectively.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>FitMatchErr</code>, <code>SplineCoefsErr</code>, <code>inneropt</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
data(FhNdata)

###############################
####  Basis Object      #######
###############################

knots = seq(0,20,0.2)
norder = 3
nbasis = length(knots) + norder - 2
range = c(0,20)

bbasis = create.bspline.basis(range=range(FhNtimes),nbasis=nbasis,
	norder=norder,breaks=knots)


# Initial values for coefficients will be obtained by smoothing

DEfd = smooth.basis(FhNtimes,FhNdata,fdPar(bbasis,1,0.5))   # Smooth to estimate
                                                            # coefficients first
coefs = DEfd$fd$coefs
colnames(coefs) = FhNvarnames



#################################
### Initial Parameter Guesses ###
#################################

profile.obj = LS.setup(pars=FhNpars,coefs=coefs,fn=make.fhn(),basisvals=bbasis,
    lambda=1000,times=FhNtimes)
lik = profile.obj$lik
proc= profile.obj$proc

pres = ParsMatchOpt(FhNpars,coefs,proc)

npars = pres$pars
</code></pre>


</div>