<div class="container">

<table style="width: 100%;"><tr>
<td>gof</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compositional Goodness of fit test</h2>

<h3>Description</h3>

<p>Goodness of fit tests for compositional data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">acompGOF.test(x,...)
acompNormalGOF.test(x,...,method="etest")
## S3 method for class 'formula'
acompGOF.test(formula, data,...,method="etest")
## S3 method for class 'list'
acompGOF.test(x,...,method="etest")
gsi.acompUniformityGOF.test(x,samplesize=nrow(x)*20,R=999)
acompTwoSampleGOF.test(x,y,...,method="etest",data=NULL)
          </code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a dataset of compositions (acomp)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a dataset of compositions (acomp)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samplesize</code></td>
<td>
<p>number of observations in a reference sample
specifying the distribution to compare with. Typically substantially
larger than the sample under investigation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>The number of replicates to compute the distribution
of the test statistic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Selecting a method to be used. Currently only "etest"
for using an energy test is supported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to the methods</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an anova model formula defining groups in the dataset </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>unused</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The compositional goodness of fit testing problem is essentially a
multivariate goodness of fit test. However there is a lack of
standardized multivariate goodness of fit tests in R. Some can be found in
the <code>energy</code>-package.
</p>
<p>In principle there is only one test behind the Goodness of fit tests
provided here, a two sample test with test statistic.
</p>
<p style="text-align: center;"><code class="reqn">\frac{\sum_{ij} k(x_i,y_i)}{\sqrt{\sum_{ij} k(x_i,x_i)\sum_{ij} k(y_i,y_i)}}</code>
</p>

<p>The idea behind that statistic is to measure the cos of an angle
between the distributions in a scalar product given by
</p>
<p style="text-align: center;"><code class="reqn">
  (X,Y)=E[k(X,Y)]=E[\int K(x-X)K(x-Y) dx]
  </code>
</p>

<p>where k and K are Gaussian kernels with different spread. The bandwith
is actually the standarddeviation of k.<br>
The other goodness of fit tests against a specific distribution are
based on estimating the parameters of the distribution, simulating a
large dataset of that distribution and apply the two sample goodness
of fit test. 
</p>
<p>For the moment, this function covers: two-sample tests, uniformity tests and additive
logistic normality tests. Dirichlet distribution tests will be included soon.
</p>


<h3>Value</h3>

<p>A classical <code>"htest"</code> object
</p>
<table>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p>The name of the dataset as specified</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a name for the test used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>an empty string</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replicates</code></td>
<td>
<p>a dataset of p-value distributions under the
Null-Hypothesis got from
nonparametric bootstrap</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>The p.value computed for this test</p>
</td>
</tr>
</table>
<h3>Missing Policy</h3>

<p>Up to now the tests can not handle missings. 
</p>


<h3>Author(s)</h3>

<p>K.Gerald v.d. Boogaart <a href="http://www.stat.boogaart.de">http://www.stat.boogaart.de</a></p>


<h3>References</h3>

<p>Aitchison, J. (1986) <em>The Statistical Analysis of Compositional
Data</em> Monographs on Statistics and Applied Probability. Chapman &amp;
Hall Ltd., London (UK). 416p.<br></p>


<h3>See Also</h3>

<p><code>fitDirichlet</code>,<code>rDirichlet</code>, <code>runif.acomp</code>,
<code>rnorm.acomp</code>, 
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
x &lt;- runif.acomp(100,4)
y &lt;- runif.acomp(100,4)

erg &lt;- acompTwoSampleGOF.test(x,y)
#continue
erg
unclass(erg)
erg &lt;- acompGOF.test(x,y)


x &lt;- runif.acomp(100,4)
y &lt;- runif.acomp(100,4)
dd &lt;- replicate(1000,acompGOF.test(runif.acomp(100,4),runif.acomp(100,4))$p.value)
hist(dd)

dd &lt;- replicate(1000,acompGOF.test(runif.acomp(20,4),runif.acomp(100,4))$p.value)
hist(dd)
dd &lt;- replicate(1000,acompGOF.test(runif.acomp(10,4),runif.acomp(100,4))$p.value)

hist(dd)
dd &lt;- replicate(1000,acompGOF.test(runif.acomp(10,4),runif.acomp(400,4))$p.value)
hist(dd)
dd &lt;- replicate(1000,acompGOF.test(runif.acomp(400,4),runif.acomp(10,4),bandwidth=4)$p.value)
hist(dd)


dd &lt;- replicate(1000,acompGOF.test(runif.acomp(20,4),runif.acomp(100,4)+acomp(c(1,2,3,1)))$p.value)

hist(dd)

# test uniformity

attach("gsi") # the uniformity test is only available as an internal function
x &lt;- runif.acomp(100,4)
gsi.acompUniformityGOF.test.test(x)

dd &lt;- replicate(1000,gsi.acompUniformityGOF.test.test(runif.acomp(10,4))$p.value)
hist(dd)
detach("gsi")


## End(Not run)
</code></pre>


</div>