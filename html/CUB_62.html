<div class="container">

<table style="width: 100%;"><tr>
<td>loglikCUB</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Log-likelihood function for CUB models</h2>

<h3>Description</h3>

<p>Compute the log-likelihood value of a CUB model fitting given data, with or without covariates to
explain the feeling and uncertainty components, or for extended CUB models with shelter effect.
</p>


<h3>Usage</h3>

<pre><code class="language-R">loglikCUB(ordinal,m,param,Y=0,W=0,X=0,shelter=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>Number of ordinal categories</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>Vector of parameters for the specified CUB model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Matrix of selected covariates to explain the uncertainty component (default: no covariate is included
in the model)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p>Matrix of selected covariates to explain the feeling component (default: no covariate is included
in the model)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Matrix of selected covariates to explain the shelter effect (default: no covariate is included
in the model)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shelter</code></td>
<td>
<p>Category corresponding to the shelter choice (default: no shelter effect is included in the
model)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If no covariate is included in the model, then <code>param</code> should be given in the form <code class="reqn">(\pi,\xi)</code>.
More generally, it should have the form <code class="reqn">(\bold{\beta,\gamma)}</code> where,
respectively, <code class="reqn">\bold{\beta}</code> and <code class="reqn">\bold{\gamma}</code> are the vectors of
coefficients explaining the uncertainty and the feeling components, with length NCOL(Y)+1 and
NCOL(W)+1 to account for an intercept term in the first entry. When shelter effect is considered, <code>param</code> corresponds
to the first possibile parameterization and hence should be given as <code>(pai1,pai2,csi)</code>.
No missing value should be present neither
for <code>ordinal</code> nor for covariate matrices: thus, deletion or imputation procedures should be preliminarily run.
</p>


<h3>See Also</h3>

<p><code>logLik</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Log-likelihood of a CUB model with no covariate
m&lt;-9; n&lt;-300
pai&lt;-0.6; csi&lt;-0.4
ordinal&lt;-simcub(n,m,pai,csi)
param&lt;-c(pai,csi)
loglikcub&lt;-loglikCUB(ordinal,m,param)
##################################
## Log-likelihood of a CUB model with covariate for uncertainty
data(relgoods)
m&lt;-10
naord&lt;-which(is.na(relgoods$Physician))
nacov&lt;-which(is.na(relgoods$Gender))
na&lt;-union(naord,nacov)
ordinal&lt;-relgoods$Physician[-na]; Y&lt;-relgoods$Gender[-na]
bbet&lt;-c(-0.81,0.93); ccsi&lt;-0.2
param&lt;-c(bbet,ccsi)
loglikcubp0&lt;-loglikCUB(ordinal,m,param,Y=Y)
#######################
## Log-likelihood of a CUB model with covariate for feeling
data(relgoods)
m&lt;-10
naord&lt;-which(is.na(relgoods$Physician))
nacov&lt;-which(is.na(relgoods$Gender))
na&lt;-union(naord,nacov)
ordinal&lt;-relgoods$Physician[-na]; W&lt;-relgoods$Gender[-na]
pai&lt;-0.44; gama&lt;-c(-0.91,-0.7)
param&lt;-c(pai,gama)
loglikcub0q&lt;-loglikCUB(ordinal,m,param,W=W)
#######################
## Log-likelihood of a CUB model with covariates for both parameters
data(relgoods)
m&lt;-10
naord&lt;-which(is.na(relgoods$Walking))
nacovpai&lt;-which(is.na(relgoods$Gender))
nacovcsi&lt;-which(is.na(relgoods$Smoking))
na&lt;-union(naord,union(nacovpai,nacovcsi))
ordinal&lt;-relgoods$Walking[-na]
Y&lt;-relgoods$Gender[-na]; W&lt;-relgoods$Smoking[-na]
bet&lt;-c(-0.45,-0.48); gama&lt;-c(-0.55,-0.43)
param&lt;-c(bet,gama)
loglikcubpq&lt;-loglikCUB(ordinal,m,param,Y=Y,W=W)
#######################
### Log-likelihood of a CUB model with shelter effect
m&lt;-7; n&lt;-400
pai&lt;-0.7; csi&lt;-0.16; delta&lt;-0.15
shelter&lt;-5
ordinal&lt;-simcubshe(n,m,pai,csi,delta,shelter)
pai1&lt;- pai*(1-delta); pai2&lt;-1-pai1-delta
param&lt;-c(pai1,pai2,csi)
loglik&lt;-loglikCUB(ordinal,m,param,shelter=shelter)
</code></pre>


</div>