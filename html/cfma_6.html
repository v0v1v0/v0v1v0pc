<div class="container">

<table style="width: 100%;"><tr>
<td>FMA.concurrent.boot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Functional mediation analysis under concurrent regression model with point-wise bootstrap confidence interval
</h2>

<h3>Description</h3>

<p> This function performs functional mediation regression under the concurrent model with given tuning parameter. Point-wise confidence bands are obtained from bootstrap.
</p>


<h3>Usage</h3>

<pre><code class="language-R">FMA.concurrent.boot(Z, M, Y, intercept = TRUE, basis = NULL, Ld2.basis = NULL, 
    basis.type = c("fourier"), nbasis = 3, timeinv = c(0, 1), timegrids = NULL, 
    lambda.m = 0.01, lambda.y = 0.01, sims = 1000, boot = TRUE, 
    boot.ci.type = c("bca", "perc"), conf.level = 0.95, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p> a data matrix. <code>Z</code> is the treatment trajectory in the mediation analysis. The number of rows is the number of subjects, and the number of columns is the number of measured time points.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p> a data matrix. <code>M</code> is the mediator trajectory in the mediation analysis. The number of rows is the number of subjects, and the number of columns is the number of measured time points.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p> a data matrix. <code>Y</code> is the outcome trajectory in the mediation analysis. The number of rows is the number of subjects, and the number of columns is the number of measured time points.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p> a logic variable. Default is <code>TRUE</code>, an intercept term is included in the regression model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basis</code></td>
<td>
<p> a data matrix. Basis function used in the functional data analysis. The number of columns is the number of basis function considered. If <code>basis = NULL</code>, Fourier basis functions will be generated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ld2.basis</code></td>
<td>
<p> a data matrix. The second derivative of the basis function. The number of columns is the number of basis function considered. If <code>Ld2.basis = NULL</code>, the second derivative of Fourier basis functions will be generated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basis.type</code></td>
<td>
<p> a character of basis function type. Default is Fourier basis (<code>basis.type = "fourier"</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbasis</code></td>
<td>
<p> an integer, the number of basis function included. If <code>basis</code> is provided, this argument will be ignored.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timeinv</code></td>
<td>
<p> a numeric vector of length two, the time interval considered in the analysis. Default is (0,1).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timegrids</code></td>
<td>
<p> a numeric vector of time grids of measurement. If <code>timegrids = NULL</code>, it is assumed the between measurement time interval is constant.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.m</code></td>
<td>
<p> a numeric value of the tuning parameter in the mediator model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.y</code></td>
<td>
<p> a numeric value of the tuning parameter in the outcome model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sims</code></td>
<td>
<p> an integer indicating the number of simulations for inference.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot</code></td>
<td>
<p> a logical value, indicating whether or not bootstrap should be used. Default is <code>TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot.ci.type</code></td>
<td>
<p> a character of confidence interval method. <code>boot.ci.type = "bca"</code> bias corrected confidence interval; <code>boot.ci.type = "perc"</code> percentile confidence interval.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p> a number of significance level. Default is 0.95.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p> a logical value, indicating whether print out bootstrap replications.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p> The concurrent mediation model is
</p>
<p style="text-align: center;"><code class="reqn">M(t)=Z(t)\alpha(t)+\epsilon_{1}(t),</code>
</p>

<p style="text-align: center;"><code class="reqn">Y(t)=Z(t)\gamma(t)+M(t)\beta(t)+\epsilon_{2}(t),</code>
</p>

<p>where <code class="reqn">\alpha(t)</code>, <code class="reqn">\beta(t)</code>, <code class="reqn">\gamma(t)</code> are coefficient curves. The model coefficient curves are estimated by minimizing the penalized <code class="reqn">L_{2}</code>-loss.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>a list of output for <code class="reqn">\alpha</code> estimate
</p>
<p><code>coefficients</code>: the result of the coefficient estimates corresponding to the basis function
</p>
<p><code>curve</code>: the point-wise estimate of the coefficient curve
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>: a list of output for <code class="reqn">\gamma</code> estimate
</p>
<p><code>coefficients</code>: the result of the coefficient estimates corresponding to the basis function
</p>
<p><code>curve</code>: the point-wise estimate of the coefficient curve
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>a list of output for <code class="reqn">\beta</code> estimate
</p>
<p><code>coefficients</code>: the result of the coefficient estimates corresponding to the basis function
</p>
<p><code>curve</code>: the point-wise estimate of the coefficient curve
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>IE</code></td>
<td>
<p>a list of output for indirect effect estimate
</p>
<p><code>coefficients</code>: the result of the coefficient estimates corresponding to the basis function
</p>
<p><code>curve</code>: the point-wise estimate of the coefficient curve
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DE</code></td>
<td>
<p>a list of output for direct effect estimate
</p>
<p><code>coefficients</code>: the result of the coefficient estimates corresponding to the basis function
</p>
<p><code>curve</code>: the point-wise estimate of the coefficient curve
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Yi Zhao, Johns Hopkins University, <a href="mailto:zhaoyi1026@gmail.com">zhaoyi1026@gmail.com</a>;
</p>
<p>Xi Luo, Brown University <a href="mailto:xi.rossi.luo@gmail.com">xi.rossi.luo@gmail.com</a>; 
</p>
<p>Martin Lindquist, Johns Hopkins University, <a href="mailto:mal2053@gmail.com">mal2053@gmail.com</a>; 
</p>
<p>Brian Caffo, Johns Hopkins University, <a href="mailto:bcaffo@gmail.com">bcaffo@gmail.com</a>
</p>


<h3>References</h3>

<p>Zhao et al. (2017). <em>Functional Mediation Analysis with an Application to Functional Magnetic Resonance Imaging Data.</em> arXiv preprint arXiv:1805.06923.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
##################################################
# Concurrent functional mediation model
data(env.concurrent)
Z&lt;-get("Z",env.concurrent)
M&lt;-get("M",env.concurrent)
Y&lt;-get("Y",env.concurrent)


# consider Fourier basis
fit.boot&lt;-FMA.concurrent.boot(Z,M,Y,intercept=FALSE,timeinv=c(0,300))

##################################################
</code></pre>


</div>