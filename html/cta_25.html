<div class="container">

<table style="width: 100%;"><tr>
<td>nested_Xsq_robust</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Nested <code class="reqn">X</code>-Squared Statistic Based CIs (Robust)
</h2>

<h3>Description</h3>

<p>Constructs confidence intervals (CIs), based on the nested <code class="reqn">X^2</code> statistic, for estimands in contingency tables subject to equality constraints.
</p>


<h3>Usage</h3>

<pre><code class="language-R">nested_Xsq_robust(y, strata, fixed.strata, h0.fct, h0.fct.deriv,
                  S0.fct, S0.fct.deriv, max.mph.iter, step,
                  change.step.after, y.eps, iter.orig, norm.diff.conv,
                  norm.score.conv, max.score.diff.iter, S.space.H0,
                  tol.psi, tol, max.iter, cut.off, delta, adj.epsilon,
                  iter.robust.max, iter.robust.eff)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Observed table counts in the contingency table(s), in vector form.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strata</code></td>
<td>
<p>Vector of the same length as <code>y</code> that gives the stratum
membership identifier.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed.strata</code></td>
<td>
<p>The object that gives information on which stratum (strata) has
(have) fixed sample sizes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h0.fct</code></td>
<td>
<p>The constraint function <code class="reqn">h_{0}(\cdot)</code> with respect to <code class="reqn">m</code>, where
<code class="reqn">m = E(Y)</code>, the vector of expected table counts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h0.fct.deriv</code></td>
<td>
<p>The <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> function object that computes analytic derivative of the
transpose of the constraint function <code class="reqn">h_{0}(\cdot)</code> with respect to
<code class="reqn">m</code>. If <code>h0.fct.deriv</code> is not specified or
<code>h0.fct.deriv = NULL</code>, numerical derivatives will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S0.fct</code></td>
<td>
<p>The estimand function <code class="reqn">S_{0}(\cdot)</code> with respect to <code class="reqn">m</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S0.fct.deriv</code></td>
<td>
<p>The <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> function object that computes analytic derivative of the estimand function <code class="reqn">S_{0}(\cdot)</code> with respect to
<code class="reqn">m</code>. If <code>S0.fct.deriv</code> is not
specified or <code>S0.fct.deriv = NULL</code>, numerical derivatives
will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.mph.iter, step, change.step.after, y.eps, iter.orig, norm.diff.conv,
norm.score.conv, max.score.diff.iter</code></td>
<td>
<p>The parameters used in <code>mph.fit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S.space.H0</code></td>
<td>
<p>Restricted estimand space of <code class="reqn">S(\cdot)</code> under <code class="reqn">H_{0}</code>, i.e.
subject to the imposed equality constraints along with sampling
constraints.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol.psi, tol, max.iter</code></td>
<td>
<p>The parameters used in the three stopping criteria in solving for the roots to the test-inversion equation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cut.off</code></td>
<td>
<p><code>qchisq(cc, 1)</code>. i.e. The chi-square cutoff, with <code class="reqn">1</code>
df, based on the significance level <code>1-cc</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>The constant <code class="reqn">\delta</code> that is in expressions of the moving critical
values within each sliding quadratic step.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adj.epsilon, iter.robust.max, iter.robust.eff</code></td>
<td>
<p>The parameters used in the robustifying procedure.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>nested_Xsq_robust</code> returns a list, which includes two objects. The first object is a <code class="reqn">1</code>-by-<code class="reqn">2</code> matrix which displays two endpoints of the confidence interval based on the nested <code class="reqn">X^2</code> statistic. For the second object, it includes the warning message that occurs during construction of the confidence
interval if the robustifying procedure is evoked: <code>"nested.Xsq.CI: Adjustment used. Not on original data.\n"</code>. If the robustifying procedure is not evoked, the second object is <code>NULL</code>.
</p>


<h3>Author(s)</h3>

<p>Qiansheng Zhu
</p>


<h3>References</h3>

<p>Zhu, Q. (2020) "On improved confidence intervals for parameters of discrete distributions." PhD dissertation, University of Iowa.
</p>


<h3>See Also</h3>

<p><code>nested_Xsq_nr</code>, <code>f.psi</code>, <code>ci.table</code>
</p>


</div>