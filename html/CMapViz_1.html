<div class="container">

<table style="width: 100%;"><tr>
<td>bubble_plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bubble plot of CMap output table</h2>

<h3>Description</h3>

<p>This function allows the user to represent the Connectivity Map (CMap) result table (broadinstitute)
under the form of a bubble plot representing statistics and cell lines:
- each drug is represented along the y axis according to its enrichment value
- each drug is represented along the x axis according to the cell line tested and
within the cell line according to batch specificity (0-50
</p>


<h3>Usage</h3>

<pre><code class="language-R">bubble_plot(path, plot, enrichment, abs.enrich.cutoff=NULL, n.rep.cutoff=NULL ,
        jittering=FALSE, return.gg.table= FALSE, output_path = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>path</code></td>
<td>
<p>path of the excel file (permutated results)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>what data to plot: molecules only (plot="molecules") or molecules by cell lines batch (plot="cell.lines")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>enrichment</code></td>
<td>
<p>whether to plot positive or negative enrichment</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abs.enrich.cutoff</code></td>
<td>
<p>minimum value of enrichment to include a batch</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.rep.cutoff</code></td>
<td>
<p>minimum number of replicates to include a batch (default=NULL)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jittering</code></td>
<td>
<p>whether apply jittering to the values to avoid points overlap</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.gg.table</code></td>
<td>
<p>table prepared for ggplot, allows the user to customize the graphical representation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output_path</code></td>
<td>
<p>path for the experiment output folder, returns data table and figure (default=NULL)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>ggplot object - bubble plot
</p>


<h3>Examples</h3>

<pre><code class="language-R">file.path &lt;- system.file("extdata", "example.xls", package = "CMapViz")
#display results by cell lines, with negative enrichment (absolute cutoff: 0.5), and at least n=5.
#molecule position with respect of dotted line is the specificity of the molecule itself:
#left side of dotted line if specificity &lt; 50 or right side of dotted line if specificity &gt; 50 )
bubble_plot(file.path,
    plot = "cell.lines", enrichment = "negative", abs.enrich.cutoff = 0.5,
    n.rep.cutoff = 5, output_path = NULL
)
</code></pre>


</div>