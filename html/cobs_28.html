<div class="container">

<table style="width: 100%;"><tr>
<td>qbsks2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Quantile B-Spline with Fixed Knots</h2>

<h3>Description</h3>

<p>Compute B-spline coefficients for regression quantile B-spline with
stepwise knots selection and quantile B-spline with fixed knots
<b>regression spline</b>, using Ng (1996)'s algorithm.
</p>


<h3>Usage</h3>

<pre><code class="language-R">qbsks2(x,y,w,pw, knots,nknots, degree,Tlambda, constraint, ptConstr,
      maxiter, trace, nrq,nl1, neqc, tau, select.lambda,
      ks, do.select, knots.add, repeat.delete.add, ic, print.mesg,
      give.pseudo.x = TRUE,
      rq.tol = 1e-8, tol.kn = 1e-6, tol.0res = 1e-6, print.warn, nk.start)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>numeric vector, sorted increasingly, the abscissa values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>numeric, same length as <code>x</code>, the observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>numeric vector of weights, same length as <code>x</code>, as in
<code>cobs</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pw</code></td>
<td>
<p>penalty weights vector ... ...</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>knots</code></td>
<td>
<p>numeric vector of knots of which <code>nknots</code> will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nknots</code></td>
<td>
<p>number of <code>knots</code> to be used.</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>degree</code></td>
<td>
<p>integer specifying polynomial degree; must be 1 or 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tlambda</code></td>
<td>
<p>(vector of) smoothing parameter(s) <code class="reqn">\lambda</code>, see
<code>drqssbc2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constraint</code></td>
<td>
<p>string (or empty) specifying the global constraints;
see <code>cobs</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ptConstr</code></td>
<td>
<p><code>list</code> of <b>p</b>oin<b>t</b>wise constraints.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>non-negative integer: maximal number of iterations,
passed to <code>drqssbc2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>integer or logical indicating the tracing level of the
<em>underlying</em> algorithms; not implemented (due to lack of trace
in quantreg ...)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrq,nl1,neqc</code></td>
<td>
<p>integers specifying dimensionalities, directly
passed to <code>drqssbc2</code>, see there.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>desired quantile level (in interval <code class="reqn">(0,1)</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>select.lambda</code></td>
<td>
<p>passed to <code>drqssbc2</code>, see there.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ks</code></td>
<td>
<p>number used as offset in SIC/AIC/BIC.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do.select</code></td>
<td>
<p>logical indicating if knots shall be selected
(instead of used as specified).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knots.add, repeat.delete.add</code></td>
<td>
<p>logicals, see <code>cobs</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ic</code></td>
<td>
<p>information criterion to use, see <code>cobs</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.mesg</code></td>
<td>
<p>an integer indicating how <code>qbsks2()</code> should
print message about its current stages.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>give.pseudo.x</code></td>
<td>
<p>logical indicating if the pseudo design matrix
<code class="reqn">\tilde{X}</code> should be returned (as <em>sparse</em> matrix).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rq.tol</code></td>
<td>
<p>numeric convergence tolerance for the interior point
algorithm called from <code>rq.fit.sfnc()</code> or
<code>rq.fit.sfn()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol.kn</code></td>
<td>
<p>“tolerance” for shifting the outer knots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol.0res</code></td>
<td>
<p>tolerance passed to <code>drqssbc2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.warn</code></td>
<td>
<p>flag indicating if and how much warnings and
information is to be printed; currently just passed to
<code>drqssbc2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nk.start</code></td>
<td>
<p>number of starting knots used in automatic knot selection.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is an auxiliary function for <code>cobs(*, lambda = 0)</code>,
possibly interesting on its own.  This documentation is currently sparse; read
the source code!
</p>


<h3>Value</h3>

<p>a list with components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coef</code></td>
<td>
<p>..</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fidel</code></td>
<td>
<p>..</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>dimensionality of model fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ifl</code></td>
<td>
<p>integer “flag”; the return code.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>icyc</code></td>
<td>
<p>integer of length 2, see <code>cobs</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knots</code></td>
<td>
<p>the vector of inner knots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nknots</code></td>
<td>
<p>the number of inner knots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nvar</code></td>
<td>
<p>the number of “variables”, i.e. unknowns including
constraints.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>the penalty factor, chosen or given.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pseudo.x</code></td>
<td>
<p>the pseudo design matrix <code class="reqn">X</code>, as returned from
<code>drqssbc2</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Pin Ng; this help page: Martin Maechler.</p>


<h3>References</h3>

<p>Ng, P. (1996)
An Algorithm for Quantile Smoothing Splines,
<em>Computational Statistics &amp; Data Analysis</em> <b>22</b>, 99–118.
</p>
<p>See also the <em>references</em> in <code>cobs</code>.
</p>


<h3>See Also</h3>

<p>the main function <code>cobs</code>; further
<code>drqssbc2</code> which is called from <code>qbsks2()</code>.
</p>


</div>