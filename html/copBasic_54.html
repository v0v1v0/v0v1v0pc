<div class="container">

<table style="width: 100%;"><tr>
<td>footCOP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The Spearman Footrule of a Copula</h2>

<h3>Description</h3>

<p>Compute the measure of association known as the <em>Spearman Footrule</em> <code class="reqn">\psi_\mathbf{C}</code> (Nelsen <em>et al.</em>, 2001, p. 281), which is defined as
</p>
<p style="text-align: center;"><code class="reqn">\psi_\mathbf{C} = \frac{3}{2}\mathcal{Q}(\mathbf{C},\mathbf{M}) - \frac{1}{2}\mbox{,}</code>
</p>

<p>where <code class="reqn">\mathbf{C}(u,v)</code> is the copula, <code class="reqn">\mathbf{M}(u,v)</code> is the <em>Fréchet–Hoeffding upper bound</em> (<code>M</code>), and <code class="reqn">\mathcal{Q}(a,b)</code> is a <em>concordance function</em> (<code>concordCOP</code>) (Nelsen, 2006, p. 158). The <code class="reqn">\psi_\mathbf{C}</code> in terms of a single integration pass on the copula is
</p>
<p style="text-align: center;"><code class="reqn">\psi_\mathbf{C} = 1 - \int_{\mathcal{I}^2} |u-v|\,\mathrm{d}\mathbf{C}(u,v) = 6 \int_0^1 \mathbf{C}(u,u)\,\mathrm{d}u - 2\mbox{.}</code>
</p>


<p>Note, Nelsen <em>et al.</em> (2001) use <code class="reqn">\phi_\mathbf{C}</code> but that symbol is taken in <span class="pkg">copBasic</span> for the <em>Hoeffding Phi</em> (<code>hoefCOP</code>), and Spearman Footrule does not seem to appear in Nelsen (2006). From the definition, Spearman Footrule only depends on the <em>primary diagnonal</em> (alt. <em>main diagonal</em>, Genest <em>et al.</em>, 2010) of the copula, <code class="reqn">\mathbf{C}(t,t)</code> (<code>diagCOP</code>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">footCOP(cop=NULL, para=NULL, by.concordance=FALSE, as.sample=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cop</code></td>
<td>
<p>A copula function;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>para</code></td>
<td>
<p>Vector of parameters or other data structure, if needed, to pass to the copula;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by.concordance</code></td>
<td>
<p>Instead of using the single integral to compute <code class="reqn">\psi_\mathbf{C}</code>, use the concordance function method implemented through <code>concordCOP</code>; and</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>as.sample</code></td>
<td>
<p>A logical controlling whether an optional <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> <code>data.frame</code> in <code>para</code> is used to compute the <code class="reqn">\hat\psi</code> (see <b>Note</b>); and</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to pass, which are dispatched to the copula function <code>cop</code> and possibly <code>concordCOP</code>, such as <code>brute</code> or <code>delta</code> used by that function.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The value for <code class="reqn">\psi_\mathbf{C}</code> is returned.
</p>


<h3>Note</h3>

<p>Conceptually, the sample Spearman Footrule is a standardized sum of the absolute difference in the ranks (Genest <em>et al.</em>, 2010). The sample <code class="reqn">\hat\psi</code> is
</p>
<p style="text-align: center;"><code class="reqn">\hat\psi = 1 - \frac{3}{n^2 - 1}\sum_{i=1}^n |R_i - S_i|\mbox{,}</code>
</p>

<p>where <code class="reqn">R_i</code> and <code class="reqn">S_i</code> are the respective ranks of <code class="reqn">X</code> and <code class="reqn">Y</code> and <code class="reqn">n</code> is sample size. The sampling variance of <code class="reqn">\hat\psi</code> under <em>assumption of independence</em> between <code class="reqn">X</code> and <code class="reqn">Y</code> is
</p>
<p style="text-align: center;"><code class="reqn">\mathrm{var}(\hat\psi) = \frac{2n^2 + 7}{5(n+1)(n-1)^2}\mbox{.}</code>
</p>

<p>Genest <em>et al.</em> (2010, p. 938) say that prior literature shows that in small samples, Spearman Footrule is less variable than the well-known <em>Spearman Rho</em> (<code>rhoCOP</code>). For a copula having continuous partial derivatives, then as <code class="reqn">n \rightarrow \infty</code>, the quantity <code class="reqn">(\hat\psi - \psi_\mathbf{C})\sqrt{n} \sim \mathrm{Normal}(0, \mathrm{var}(\gamma_\mathbf{C}))</code>. Genest <em>et al.</em> (2010) show variance of <code class="reqn">\hat\psi</code> for the <em>independence copula</em> (<code class="reqn">\mathbf{C}(u,v) = \mathbf{\Pi}(u,v)</code>) (<code>P</code>) as <code class="reqn">\mathrm{var}(\psi_\mathbf{C}) = 2/5</code>. For comparison, the <em>Gini Gamma</em> for independence is larger at <code class="reqn">\mathrm{var}(\gamma_\mathbf{C}) = 2/3</code> (see <code>giniCOP</code> <b>Note</b>). Genest <em>et al.</em> (2010) also present additional material for estimation of the distribution <code class="reqn">\hat\psi</code> variance for conditions of dependence based on copulas. In Genest <em>et al.</em> independence and two examples of dependence (p. 941), <code class="reqn">\mathrm{var}(\hat\gamma) &gt; \mathrm{var}(\hat\psi)</code>, but those authors do not appear to remark on whether this inequality holds for all copula.
</p>


<h3>Author(s)</h3>

<p>W.H. Asquith</p>


<h3>References</h3>

<p>Genest, C., Nešlehová, J., and Ghorbal, N.B., 2010, Spearman's footrule and Gini's gamma—A review with complements: Journal of Nonparametric Statistics, v. 22, no. 8, pp. 937–954, <a href="https://doi.org/10.1080/10485250903499667">doi:10.1080/10485250903499667</a>.
</p>
<p>Nelsen, R.B., 2006, An introduction to copulas: New York, Springer, 269 p.
</p>
<p>Nelsen, R.B., Quesada-Molina, J.J., Rodríguez-Lallena, J.A., Úbeda-Flores, M., 2001, Distribution functions of copulas—A class of bivariate probability integral transforms: Statistics and Probability Letters, v. 54, no. 3, pp. 277–282, <a href="https://doi.org/10.1016/S0167-7152%2801%2900060-8">doi:10.1016/S0167-7152(01)00060-8</a>.
</p>


<h3>See Also</h3>

<p><code>blomCOP</code>, <code>giniCOP</code>, <code>hoefCOP</code>,
<code>rhoCOP</code>, <code>tauCOP</code>,  <code>wolfCOP</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  footCOP(cop=PSP)                      # 0.3177662
# footCOP(cop=PSP, by.concordance=TRUE) # 0.3178025

## Not run: 
n &lt;- 2000; UV &lt;- simCOP(n=n, cop=GHcop, para=2.3, graphics=FALSE)
footCOP(para=UV, as.sample=TRUE)                  # 0.5594364 (sample version)
footCOP(cop=GHcop, para=2.3)                      # 0.5513380 (copula integration)
footCOP(cop=GHcop, para=2.3, by.concordance=TRUE) # 0.5513562 (concordance function)
# where the later issued warnings on the integration
## End(Not run)

## Not run: 
set.seed(1); nsim &lt;- 1000
varFTunderIndpendence &lt;- function(n) {
  (2*n^2 + 7) / (5*(n+1)*(n-1)^2) # Genest et al. (2010)
}
ns &lt;- c(10, 15, 20, 25, 50, 75, 100)
plot(min(ns):max(ns), varFTunderIndpendence(10:max(ns)), type="l",
     xlab="Sample size", ylab="Variance of Sample Estimator", col="salmon4")
mtext("Sample Spearman Footrule Under Independence", col="salmon4")
for(n in ns) {
  sFT &lt;- vector(length=nsim)
  for(i in seq_len(nsim)) {
    uv &lt;- simCOP(n=n, cop=P, para=2, graphics=FALSE)
    sFT[i] &lt;- footCOP(para=uv, as.sample=TRUE)
  }
  varFT &lt;- varFTunderIndpendence(n)
  zz &lt;- round(c(n, mean(sFT), var(sFT), varFT), digits=6)
  names(zz) &lt;- c("n", "mean_sim", "var_sim", "var_Genest")
  print(zz)
  points(n, zz[3], cex=2, pch=21, col="salmon4", bg="salmon1")
} # results show proper implementation and Genest et al. (2010, sec. 3) 
## End(Not run)
</code></pre>


</div>