<div class="container">

<table style="width: 100%;"><tr>
<td>boot.cgaim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Boostrap CGAIM</h2>

<h3>Description</h3>

<p>Generates bootstrap replicates of a <code>cgaim</code> object.
</p>


<h3>Usage</h3>

<pre><code class="language-R">boot.cgaim(object, boot.type = c("residuals", "wild", "pairs"),
  bsamples = NULL, B = 100, l = 1, nc = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A <code>cgaim</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot.type</code></td>
<td>
<p>The type of bootstrap to perform. Currently
available type are <code>"residuals"</code>, <code>"wild"</code> and 
<code>"pairs"</code>. See details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bsamples</code></td>
<td>
<p>A numerical matrix of observation indices specifying 
bootstrap samples.
Rows indicate observations and columns bootstrap samples.
If <code>NULL</code> (the default), samples are generated internally.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>Number of bootstrap samples to generate when <code>bsamples = NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l</code></td>
<td>
<p>Block length for block-bootstrap. Samples are generated by
resampling block of observation of length <code>l</code>. The classical
bootstrap corresponds to <code>l = 1</code> (the default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nc</code></td>
<td>
<p>Positive integer. If <code>nc &gt; 1</code>, the function is parallelized with <code>nc</code> indicating the number of cores to use.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function fits the <code>cgaim</code> on bootstrap samples.
It is called internally by the <code>confint.cgaim</code> function, but can also be
called directly to generate various statistics.
</p>
<p>Three types of bootstrap are currently implemented. <code>"residuals"</code> 
(the default) resamples the residuals in <code>object</code> to then be added to fitted values, creating alternative response vectors. The <code>cgaim</code> is then fitted on these newly generated y values with the original x. <code>"wild"</code> is
similar except that residuals are multiplied by random draws from a
standard normal distribution before being added to fitted values. 
<code>"pairs"</code> resamples directly pairs of y and x to create 
bootstrap samples.
</p>
<p>Bootstrap samples can either be prespecified by the user through
<code>bsamples</code> or generated internally. In the former case, 
the columns of <code>bsamples</code> indicate the number of replications <code>B</code> and
the rows should match the original number of observations. Internally
generated bootstrap samples are controlled by the number of replications
<code>B</code> and block length <code>l</code>, implementing block bootstrap.
The latter is particularly recommended for time series data.
</p>
<p>As fitting a large number of <code>cgaim</code> models can be computationally
intensive, the function can be run in parallel, using the 
<code>doParallel</code> package. This can be done by setting the
argument <code>nc</code> to a value greater than 1, controlling the number
of cores used in parallelization.
</p>


<h3>Value</h3>

<p>A <code>boot.cgaim</code> object with components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>boot</code></td>
<td>
<p>The bootstrap result. A list that includes all
<code>B</code> replications of <code>alpha</code>, <code>beta</code>, <code>gfit</code> and
<code>indexfit</code> organized in arrays.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs</code></td>
<td>
<p>The original <code>object</code> passed to the function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samples</code></td>
<td>
<p>The bootstrap samples. A matrix with indices 
corresponding to original observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot.type</code></td>
<td>
<p>The type of bootstrap performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>The number of bootstrap replications.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l</code></td>
<td>
<p>The block length for block bootstrap.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R"># A simple CGAIM
n &lt;- 200
x1 &lt;- rnorm(n)
x2 &lt;- x1 + rnorm(n)
z &lt;- x1 + x2
y &lt;- z + rnorm(n)
df1 &lt;- data.frame(y, x1, x2) 
ans &lt;- cgaim(y ~ g(x1, x2, acons = list(monotone = 1)), data = df1)

# Use function to compute confidence intervals (B should be increased)
set.seed(1989) 
boot1 &lt;- boot.cgaim(ans, B = 10)
ci1 &lt;- confint(boot1)

# Produces the same result as
set.seed(1989)
ci2 &lt;- confint(ans, type = "boot", B = 10)

# Create sampling beforehand
bsamp &lt;- matrix(sample(1:n, n * 10, replace = TRUE), n)
boot2 &lt;- boot.cgaim(ans, bsamples = bsamp)

# Parallel computing (two cores)

boot3 &lt;- boot.cgaim(ans, nc = 2)


</code></pre>


</div>