<div class="container">

<table style="width: 100%;"><tr>
<td>phylo.d.subset</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculates the phylogenetic D statistic across clades within a phylogeny</h2>

<h3>Description</h3>

<p>Calculates the D value, a measure of phylogenetic signal in a binary trait, and tests the estimated D value for significant departure from both random association and the clumping expected under a Brownian evolution threshold model. Does this across clades within a phylogeny.
</p>


<h3>Usage</h3>

<pre><code class="language-R">phylo.d.subset(data, phy, names.col, binvar, permut = 1000, rnd.bias=NULL, 
	           min.tips=1, max.tips=length(data$phy$tip.label), min.nodes=1, 
			   max.nodes=data$phy$Nnode, verbose=FALSE)
## S3 method for class 'phylo.d.subset'
print(x, ...)
## S3 method for class 'phylo.d.subset'
summary(object, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A 'comparative.data' or 'data.frame' object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phy</code></td>
<td>
<p>An object of class 'phylo', required when data is not a 'comparative.data' object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>names.col</code></td>
<td>
<p>A name specifying the column in 'data' that matches rows to tips in 'phy', required when data is not a 'comparative.data' object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binvar</code></td>
<td>
<p>The name of the variable in <code>data</code> holding the binary variable of interest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>permut</code></td>
<td>
<p>Number of permutations to be used in the randomisation test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rnd.bias</code></td>
<td>
<p>An optional name of a variable in <code>data</code> holding probability weights to bias the generation of the random distribution. See 'destails'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical; do you want to know how many clades are being assessed, and see when each is being assessed?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.tips</code></td>
<td>
<p>The minimum number of tips a clade should have for it to have a D value calculated. Defaults to 1 (i.e. no limit).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.tips</code></td>
<td>
<p>The maximum number of species a clade should have for it to have a D value calculated. Defaults to the number of species in the whole phylogeny (i.e. no limit).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.nodes</code></td>
<td>
<p>The minimum number of nodes a clade should have for it to have a D value calculated. Defaults to 1 (i.e. no limit).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.nodes</code></td>
<td>
<p>The maximum number of nodes a clade should have for it to have a D value calculated. Defaults to the number of nodes in the whole phylogeny (i.e. no limit).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class 'phylo.d.subset'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of class 'phylo.d.subset'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to print and summary methods</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A wrapper function for <code>phylo.d</code>, calculating D values for clades within a given dataset. These clades can be filtered according to the number of species and nodes using the arguments above. See <code>phylo.d</code> for more details on the method itself.
</p>
<p>Any clades for which there is no variation in the binary variable have <code>NA</code> values for all of the below slots.</p>


<h3>Value</h3>

<p>Returns an object of class 'phylo.d.subset', which is a list of the following:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>raw</code></td>
<td>
<p>A list of the raw output from <code>phylo.d</code> for each clade</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DEstimate</code></td>
<td>
<p>A vector of the estimated D values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pval1</code></td>
<td>
<p>A vector of p values, giving the result of testing whether D is significantly different from one, for each clade</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pval0</code></td>
<td>
<p>A vector of p values, giving the result of testing whether D is significantly different from zero, for each clade</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phy.depth</code></td>
<td>
<p>A numeric vector giving the age of the clade for which each value was calculated</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Susanne Fritz (SFritz@bio.ku.dk), Will Pearse and  David Orme</p>


<h3>References</h3>

<p>Fritz, S. A. and Purvis, A. (2010). Selectivity in mammalian extinction risk and threat types: a new measure of phylogenetic signal strength in binary traits. Conservation Biology, 24(4):1042-1051.</p>


<h3>Examples</h3>

<pre><code class="language-R">data(BritishBirds)
BritishBirds &lt;- comparative.data(BritishBirds.tree, BritishBirds.data, binomial)
# Look at big clades only
## Not run: 
bigClades &lt;- phylo.d.subset(BritishBirds, binvar=Red_list, verbose=TRUE, min.tips=10, min.nodes=5)
print(bigClades)

## End(Not run)
</code></pre>


</div>