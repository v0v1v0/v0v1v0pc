<div class="container">

<table style="width: 100%;"><tr>
<td>calc_sc3_stability_cluster</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate single SC3 stability</h2>

<h3>Description</h3>

<p>Calculate the SC3 stability index for a single cluster in a set of
clusterings. The index varies from 0 to 1, where 1 suggests that a cluster is
more stable across resolutions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">calc_sc3_stability_cluster(clusterings, res, cluster)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>clusterings</code></td>
<td>
<p>numeric matrix containing clustering information, each
column contains clustering at a separate resolution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res</code></td>
<td>
<p>resolution of the cluster to calculate stability for</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>index of the cluster to calculate stability for</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This index was originally introduced in the <code>SC3</code> package for clustering
single-cell RNA-seq data. Clusters are awarded increased stability if they
share the same samples as a cluster at another resolution and penalised at
higher resolutions. We use a slightly different notation to describe the
score but the results are the same:
</p>
<p style="text-align: center;"><code class="reqn">
  s(c_{k, i}) =
  \frac{1}{size(L) + 1}
  \sum_{l \in L}
    \sum_{j \in N_l}
      \frac{size(c_{k, i} \cap c_{l, j})}{size(c_{l, j}) * size(N_l) ^ 2}
</code>
</p>

<p>Where:
</p>

<ul>
<li> <p><code style="white-space: pre;">⁠c_{x, y}⁠</code> is cluster <code>y</code> at resolution <code>x</code>
</p>
</li>
<li> <p><code>k</code> is the resolution of the cluster we want to score
</p>
</li>
<li> <p><code>i</code> is the index of the cluster we want to score
</p>
</li>
<li> <p><code>L</code> is the set of all resolutions except <code>k</code>
</p>
</li>
<li> <p><code>l</code> is a resolution in <code>L</code>
</p>
</li>
<li> <p><code>N_l</code> is the set of clusters at resolution <code>l</code> that share samples with
<code style="white-space: pre;">⁠c_{k, i}⁠</code>
</p>
</li>
<li> <p><code>j</code> is a cluster in <code>N_l</code>
</p>
</li>
</ul>
<h3>Value</h3>

<p>SC3 stability index
</p>


<h3>See Also</h3>

<p>The documentation for the <code>calculate_stability</code> function in the
SC3 package
</p>


</div>