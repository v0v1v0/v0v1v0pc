<div class="container">

<table style="width: 100%;"><tr>
<td>foursail</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Optimized R implementation of foursail (4SAIL)</h2>

<h3>Description</h3>

<p>The foursail (or 4SAIL) radiative transfer model is commonly used to simulate bidirectional 
reflectance distribution functions within vegetation canopies. Foursail (4SAIL) refers 
to "Scattering by Arbitrary Inclined Leaves" in a 4-stream model. The four-streams represents 
the scattering and absorption of upward, downward and two directional radiative fluxes with 
four linear differential equations in a 1-D canopy. The model was initially developed by
Verhoef (1984), who extended work by Suits (1971) 4-steam model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">foursail(rho, tau, bgr, param)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>input leaf reflectance from 400-2500nm (can be measured or modeled)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>input leaf transmittance from 400-2500nm (can be measured or modeled)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bgr</code></td>
<td>
<p>background reflectance. Usual input is
soil reflectance spectra from 400-2500nm (can be measured or modeled)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>A named vector of SAIL parameter values (note: program ignores case):
</p>

<ul>
<li>
<p> [1] = Leaf angle distribution function parameter a (LIDFa)
</p>
</li>
<li>
<p> [2] = Leaf angle distribution function parameter b (LIDFb)
</p>
</li>
<li>
<p> [3] = Leaf angle distribution function type (see ?lidfFun)
</p>
</li>
<li>
<p> [4] = Leaf area index (LAI)
</p>
</li>
<li>
<p> [5] = Hot spot effect parameter (hspot)
</p>
</li>
<li>
<p> [6] = Solar zenith angle (tts)
</p>
</li>
<li>
<p> [7] = Observer zenith angle (tto)
</p>
</li>
<li>
<p> [8] = Sun-sensor azimuth angle (psi)
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Value</h3>

<p>spectra matrixwith 4 reflectance factors and canopy transmission 
for wavelengths 400 to 2500nm:
</p>

<ul>
<li>
<p> [1] = bi-hemispherical reflectance (rddt). White-sky albedo: the reflectance of the canopy
under diffuse illumination. The BRDF integrated over all viewing and illumination directions.  
</p>
</li>
<li>
<p> [2] = hemispherical directional reflectance (rsdt). Black-sky albedo: reflectance of a surface
under direct light without a diffuse component. It is the integral of the BRDF over all viewing
directions.
</p>
</li>
<li>
<p> [3] = directional hemispherical reflectance (rdot). Diffuse reflectance in the vieweing
direction. 
</p>
</li>
<li>
<p> [4] = bi-directional reflectance (rsot). The ratio of reflected radiance in the viewing direction
to the incoming radiant flux in the solar direction. 
</p>
</li>
<li>
<p> [5] = Canopy transmission of diffuse light through the canopy (taud).
</p>
</li>
<li>
<p> [6] = transmission of direct light through the canopy (taus).
</p>
</li>
</ul>
<h3>References</h3>

<p>Suits, G.H., 1971. The calculation of the directional reflectance of a 
vegetative canopy. Remote Sens. Environ. 2, 117-125.
</p>
<p>Verhoef, W. (1984). Light scattering by leaf layers with application to 
canopy reflectance modeling: The SAIL model. Remote Sens. Environ. 16, 125-141.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## lower-level implementation example
## see ?fRTM for the typical mode of simulation
## e.g. fRTM(rho~prospectd+foursail) 

## 1) get parameters
params&lt;-getDefaults(rho~prospectd+foursail) 
## getDefaults("foursail") will also work
bestpars&lt;-params$foursail$best
## ensure the vector is named
names(bestpars) &lt;- rownames(params$foursail)

## 2) get leaf reflectance and transmission 
rt&lt;-fRTM(rho+tau~prospectd)

## 3) get soil reflectance to model background reflectance
data(soil)

## a linear mixture soil model 
bgRef&lt;- bestpars["psoil"]*soil[,"drySoil"] + (1-bestpars["psoil"])*soil[,"wetSoil"]

## 4) run 4SAIL
foursail(rt[,"rho"],rt[,"tau"],bgRef,bestpars)

</code></pre>


</div>