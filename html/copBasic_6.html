<div class="container">

<table style="width: 100%;"><tr>
<td>bicoploc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Analog to Line of Organic Correlation by Copula Diagonal</h2>

<h3>Description</h3>

<p><em>HIGHLY EXPERIMENTAL AND SUBJECT TO OVERHAUL OR REMOVAL</em>—Compute an analog to the <em>line of organic correlation</em> (<em>reduced major axis</em>) using the <em>diagonal</em> of a copula.
</p>
<p style="text-align: center;"><code class="reqn">\mathrm{Pr}[U \le u, V \le v] = \mathbf{C}(u,v) = f\mbox{.}</code>
</p>

<p>The primary diagonal is defined as
</p>
<p style="text-align: center;"><code class="reqn">\mathbf{\delta}_\mathbf{C}(t) = \mathbf{C}(t,t) = f\mbox{.}</code>
</p>

<p>Two diagnostic plots can be plotted by the arguments available for this function. The plot for <code class="reqn">(U,V)</code> coordinate nonexceedance probability domain along with the analyses involving the copula diagonal inversion comes first, which is followed by that for <code class="reqn">(X,Y)</code> coordinate domain along with the well-known line of organic correlation by the method of L-moments and such a “line” (could be a curve) by copula diagonal inversion.
</p>
<p>This much infrastructure written for flexibility in how a copula would interact for the purpose of estimation with moment preservation. The simple <code class="reqn">u = v</code> might be sufficient but let us have some flexibility.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bicoploc(xp, yp=NULL, xout=NA, xpara=NULL, ypara=NULL, dtypex="nor", dtypey="nor",
         ctype=c("weibull", "hazen", "bernstein", "checkerboard"), kumaraswamy=TRUE,
         plotuv=TRUE, plotxy=TRUE, adduv=FALSE, addxy=FALSE, snv=FALSE, limout=TRUE,
         autoleg=TRUE, xleg="topleft", yleg=NULL, rugxy=TRUE, ruglwd=0.5,
         xlim=NULL, ylim=NULL, titleuv="", titlexy="", titlecex=1,
         a=0, ff=pnorm(seq(-5, +5, by=0.1)), locdigits=6,
         paracop=TRUE, verbose=TRUE, x=NULL, y=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xp</code></td>
<td>
<p>Numeric vector giving paired data points of <code class="reqn">X</code>. If this is a matrix or data frame, then the first and second columns are extracted for the <code>xp</code> and <code>yp</code> internall;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yp</code></td>
<td>
<p>Optional numeric vector giving paired data points of <code class="reqn">Y</code> depending on the composition of <code>x</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xout</code></td>
<td>
<p>An optional set of numeric values specifying where interpolation through the diagonal inversion is to take place;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xpara</code></td>
<td>
<p>An <span class="pkg">lmomco</span> package parameter object for the <code class="reqn">X</code> variable, which if not provided will trigger an method of L-moment parameter estimation for the distribution <code>dtypex</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ypara</code></td>
<td>
<p>An <span class="pkg">lmomco</span> package parameter object for the <code class="reqn">Y</code> variable, which if not provided will trigger an method of L-moment parameter estimation for the distribution <code>dtypey</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dtypex</code></td>
<td>
<p>The <span class="pkg">lmomco</span> package distribution abbreviations (see <code>lmomco::dist.list()</code>) for the <code class="reqn">X</code> variable. If this argument is set <code>NULL</code> and <code>xpara</code> is given with an element of <code>type</code>, then that distribution type is assigned internally to <code>dtypex</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dtypey</code></td>
<td>
<p>The <span class="pkg">lmomco</span> package distribution abbreviations (see <code>lmomco::dist.list()</code>) for the <code class="reqn">Y</code> variable; If this argument is set <code>NULL</code> and <code>xpara</code> is given with an element of <code>type</code>, then that distribution type is assigned internally to <code>dtypex</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ctype</code></td>
<td>
<p>Argument of the same name for the empirical copula for dispatch to <code>EMPIRcop</code>. The <code>1/n</code> form is disabled for <code>bicoploc</code> operations based on limited experiments. The first letter of the argument's value is extracted, converted to upper case, and used as the plotting character in the two diagnostic plots;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kumaraswamy</code></td>
<td>
<p>A logical to trigger Kumaraswamy distribution smoothing of the copula diagonal inversion from the <em>empricial copula</em>. The Kumaraswamy distribution is a distribution having support <code class="reqn">[0,1]</code> with an explicit quantile function and takes the place of a Beta distribution (see <span class="pkg">lmomco</span> function <code>quakur()</code> for more details). The smoothing by Kumaraswamy will provide a continuous real number on the interval, which should insure no flat-lining as one rolls on to or off off the discrete interval provided by the empirical copula for expected sample sizes of the operations anticipated for the <code>bicoploc</code> function;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotuv</code></td>
<td>
<p>A logical to trigger plotting of the analyses in the <code class="reqn">(U,V)</code> coordinate nonexceedance probability domain along with the analyses involving the copula diagonal inversion. If set true, then <code>adduv</code> is set false internally;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotxy</code></td>
<td>
<p>A logical to trigger plotting of the analyses in the <code class="reqn">(X,Y)</code> coordinate domain along with the well-known line of organic correlation by the method of L-moments and such a “line”  (could be a curve) by copula diagonal inversion. If set true, then <code>addxy</code> is set false internally;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adduv</code></td>
<td>
<p>A logical when set true will not call the <code>plot()</code> function for <code class="reqn">(U,V)</code> coordinate nonexceedance probability domain but the other graphical operations of lines and points will be called;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>addxy</code></td>
<td>
<p>A logical when set true will not call the <code>plot()</code> function for <code class="reqn">(X,Y)</code> coordinate domain but the other graphical operations of lines and points will be called;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>snv</code></td>
<td>
<p>A logical when set true will plot the <code class="reqn">(U,V)</code> coordinate nonexceedance probability domain in units of standard normal variates;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>limout</code></td>
<td>
<p>A logical when set true will plot the <code class="reqn">(X,Y)</code> coordinate domain with horizontal and vertical axis limits inflated to the <code>xout</code> and <code class="reqn">Y</code> predictions;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>autoleg</code></td>
<td>
<p>A logical when set will draw a legend for the plots if the plots are requested;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xleg</code></td>
<td>
<p>The value to become the argument <code>x</code> in the <code>legend()</code> call. The default setting is based on general assumption that this <code>bicoploc()</code> function is to be more commonly used in positive assocation circumstances between <code class="reqn">X</code> and <code class="reqn">Y</code> (positive Spearman Rho);</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yleg</code></td>
<td>
<p>The value to become the argument <code>y</code> in the <code>legend()</code> call;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rugxy</code></td>
<td>
<p>Call <code>rug()</code> plotting operations on the <code class="reqn">X</code> and <code class="reqn">Y</code> values used in the parameter estimation of the parametric marginal distributions using the <code>xp</code> and <code>yp</code>, unless either or both have been overridden for the contents in <code>x</code> and (or) <code>y</code> arguments;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ruglwd</code></td>
<td>
<p>The line wide passed into <code>rug()</code>. Because plotting of small and large sample sizes can make it difficult in the smaller samples to see the line, it is judged useful to explicitly have this setting as an declared argument;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>A numeric vector that if precisely of length 2 and no missing values therein, will override the horizontal limits of the <code>plotxy</code> plot of the <code class="reqn">(X,Y)</code> domain. Otherwise, the contents of <code>xlim</code>, if not null, are inserted into a range computation for the limits to apply;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>A numeric vector that if precisely of length 2 and no missing values therein, will override the vertical limits of the <code>plotxy</code> plot of the <code class="reqn">(X,Y)</code> domain. Otherwise, the contents of <code>ylim</code>, if not null, are inserted into a range computation for the limits to apply;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>titleuv</code></td>
<td>
<p>An optional title for the <code class="reqn">(U,V)</code> domain plot;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>titlexy</code></td>
<td>
<p>An optional title for the <code class="reqn">(X,Y)</code> domain plot;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>titlecex</code></td>
<td>
<p>The character expansion factor for the titles;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>Value for the plotting-position formula for <code>lmomco::pp()</code>, default is <code>a=0</code>, which specifies <em>Weibull plotting positions</em>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ff</code></td>
<td>
<p>The nonexceedance joint probability of of the copula diagonal from which inversion computes the marginal nonexceedance probability values for <code class="reqn">u=v=t</code> as <code class="reqn">\mathbf{C}(t,t) = f</code> where <code>ff</code> is the variable notation for the joint probability <code class="reqn">f</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>locdigits</code></td>
<td>
<p>Number of digits for rounding exclusive to the <code>loc</code> data frame produced in the returned list. The reasoning for this setting is that the expected application in practical circumstances will have discipline knowledge of the rounding depth suitable;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>paracop</code></td>
<td>
<p>A logical trigging the use of the parametric asymmetric copula fit by numerical optimization to the <code class="reqn">(U,V)</code> domain of the data (see <b>Details</b>);</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Show messages of incremental progress with a incremental counter on the message;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Numeric vector of <code class="reqn">X</code> values to be used in parameter estimation of the marginal parametric distribution if <code>xpara=NULL</code> and these values are internally replaced with <code>xp</code> (paired <code class="reqn">X</code>) if not otherwise specified. This provides the ability to insert an alternative and presumably longer vector of the entire <code class="reqn">X</code> sample without the restriction of individual values paired to the <code class="reqn">Y</code>. A feature unique to providing the <code>x</code> is that missing values can be and are removed on the fly prior to parameter estimation of the marginal distribution. The <code>x</code> can be specific independent of <code>y</code> or even at all for either. Absolutely no provision is made that <code>x</code> can be a matrix or data frame holding the <code>y</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Numeric vector of <code class="reqn">Y</code> values to be used in parameter estimation of the marginal parametric distribution if <code>ypara=NULL</code> and these values are internally replaced with <code>yp</code> (paired <code class="reqn">Y</code>) if not otherwise specified. This provides the ability to insert an alternative and presumably longer vector of the entire <code class="reqn">Y</code> sample without the restriction of individual values paired to the <code class="reqn">X</code>. A feature unique to providing the <code>y</code> is that missing values can be and are removed on the fly prior to parameter estimation of the marginal distribution. The <code>x</code> can be specific independent of <code>y</code> or even at all for either; and</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to pass.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><em>ON THE USE OF AN PARAMETRIC ASYMMETRIC COPULA</em>—
</p>


<h3>Value</h3>

<p>Lists, vectors, and data frames for the computations and predictions are returned.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>organic</code></td>
<td>
<p>A list containing a data frame of the predictions for <code>xout</code> by the conventional LOC (<code>locpair</code>) (see also <code>locsols$lmrloc</code>), the estimates by the L-moments of the parameters of the marginal distributions (<code>locpara</code>), the estimates by copula diagonal with Kumaraswamy smoothing (if requested) (<code>bicoploc</code>), and the predictions based solely on the empirical copula approximation for the diagonal (<code>bicoploc_emp</code>). The <code>bicoploc</code> and <code>bicoploc_emp</code> are equal to each other if Kumaraswamy was not used. The <code>bicoploc</code> is intended to be the official output from the <code>bicoploc()</code> function. The furthest right column is <code>bicoploc_cop</code> and represents the predicting values using a parametric copula as fit to the <code class="reqn">(U,V)</code> domain mapped into the <code class="reqn">(X,Y)</code> domain as explained elsewhere in this documentation or sources;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>locsols</code></td>
<td>
<p>A list of solutions to the LOC based (1) (<code>locpair</code>) on the conventional definition on the paired data (<code>xp</code> and <code>yp</code>) with the finiteness check previously described by <code>lmomco::lmrloc()</code> and (2) (<code>locpara</code>) the LOC solution <em>not on the paired data</em> but extractable from the L-moments of the parameters for the marginal distributions. Certain permutations of available features will either have the two L-moment solutions equal, or just the slopes equal, or differing in both intercept and slope. The <code>lmrloc</code> list contains both L-moment and product moment estimation of the LOC to adhere precisely to <code>lmomco::lmrloc()</code> output;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xpara</code></td>
<td>
<p>The parameters of the marginal distribution in <code class="reqn">X</code> either as given in <code>xpara</code>, as estimated from <code>xp</code>, or estimated from <code>x</code> by the method of L-moments through the <span class="pkg">lmomco</span> package;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ypara</code></td>
<td>
<p>The parameters of the marginal distribution in <code class="reqn">Y</code> either as given in <code>ypara</code>, as estimated from <code>yp</code>, or estimated from <code>y</code> by the method of L-moments through the <span class="pkg">lmomco</span> package;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>faqs</code></td>
<td>
<p>A named vector containing some numerical facts about the operations and principally the requisite sample sizes involved are reported here;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>faqscop</code></td>
<td>
<p>A named vector containing some numerical facts about the operations involving the fitting of the parametric asymmetric copula (Plackett by default) to the <code class="reqn">(U,V)</code> domain; and</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diag</code></td>
<td>
<p>A data frame containing information on the copula diagonal including the joint probability column <code>jtprob</code> (the <code>ff</code> as stand in for <code class="reqn">C(t,t) = f</code>), the <code class="reqn">u=v=t</code> in column <code>uv</code> by the Kumaraswamy smooth (if requested), and the solely empirical copula version in column <code>uv_emp</code>. If the Kumaraswamy smooth is not used, then <code>uv</code> and <code>uv_emp</code> will be equal to each other. The furthest right column is <code>uv_cop</code> and represents the values using a parametric copula as fit to the <code class="reqn">(U,V)</code> domain as explained elsewhere in this documentation or sources.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The use of a copula diagonal inversion for purposes of a line of organic correlation analog within the text-book literature and elsewhere is unknown to the developers (December 2023).
</p>
<p>Though <code>bicoploc</code> has extensive logic for working through the copula diagonal, if we know the parent distribution and we just have the marginal probabilities equal to each other (the diagonal), then we recover the moments of <code class="reqn">Y</code> simply with <code class="reqn">u = v</code>:
</p>
<pre>
  library(lmomco)
  ff    &lt;- c(0.0001, seq(0.001, 0.999, by=0.001), 0.9999)
  xpara &lt;- lmomco::vec2par(c(3, 0.6, -0.4), type="pe3")
  ypara &lt;- lmomco::vec2par(c(3, 0.4, +0.6), type="pe3")
  xx &lt;-   rlmomco(100000,  xpara)
  yy &lt;- approx(qlmomco(ff, xpara), qlmomco(ff, ypara), xout=xx)$y
  lmr2par(yy, type="aep4")$para
  #        mu     sigma     gamma
  # 2.9972742 0.3993914 0.5980866
</pre>


<h3>Author(s)</h3>

<p>W.H. Asquith</p>


<h3>References</h3>

<p>Kruskal, W.H., 1953, On the uniqueness of the line of organic correlation: Biometrics, vol. 9, no. 1, pp. 47–58, <a href="https://doi.org/10.2307/3001632">doi:10.2307/3001632</a>.
</p>


<h3>See Also</h3>

<p><code>diagCOPatf</code></p>


<h3>Examples</h3>

<pre><code class="language-R"># paracop set to FALSE in these examples for speed
set.seed(4); nsim &lt;- 50
X  &lt;- rnorm(nsim, mean=3, sd=0.6)
Y  &lt;- rnorm(nsim, mean=0, sd=0.2)
zz &lt;- bicoploc(X,Y, xout=c(2.5, 3.5, 4), dtypex="nor", dtypey="nor",   paracop=FALSE)
# cor(X,Y, method="spearman") # +0.0785114 POSITIVE

set.seed(1); nsim &lt;- 50
X  &lt;- rnorm(nsim, mean=3, sd=0.6)
Y  &lt;- rnorm(nsim, mean=0, sd=0.2)
zz &lt;- bicoploc(X,Y, xout=c(2.5, 3.5, 4), dtypex="nor", dtypey="nor",   paracop=FALSE)
# cor(X,Y, method="spearman") # -0.1351741 NEGATIVE

set.seed(1); nsim &lt;- 50
X  &lt;-           rnorm(nsim, mean=3, sd=0.6)
Y  &lt;- 0.843*X + rnorm(nsim, mean=0, sd=0.2)
zz &lt;- bicoploc(X,Y, xout=c(2.5, 3.5, 4), dtypex="nor", dtypey="nor",   paracop=FALSE)
# cor(X,Y, method="spearman") # for nsim=1E6 RHO=0.92367

set.seed(1); nsim &lt;- 50
X  &lt;-           lmomco::rlmomco(nsim, lmomco::vec2par(c(3, 0.6, +0.5), type="pe3"))
Y  &lt;- 0.3*X^2 + lmomco::rlmomco(nsim, lmomco::vec2par(c(0, 0.4, 0),    type="pe3"))
zz &lt;- bicoploc(X,Y, xout=c(2.5, 3.5, 4.5), dtypex="nor", dtypey="nor", paracop=FALSE)
# cor(X,Y, method="spearman") # for nsim=1E6 RHO=0.92366

set.seed(1); nsim &lt;- 50
X  &lt;-           lmomco::rlmomco(nsim, lmomco::vec2par(c(3, 0.6, +0.5), type="pe3"))
Y  &lt;- 0.3*X^2 + lmomco::rlmomco(nsim, lmomco::vec2par(c(0, 0.4, 0),    type="pe3"))
zz &lt;- bicoploc(X,Y, xout=c(2.5, 3.5, 4.5), dtypex="gev", dtypey="gev", paracop=FALSE)

## Not run: 
########################################################################################
# Image 800 samples in X and Y and though created as pairs, let us assume only
# 50 are actually paired for purposes of demonstration of specified parameters
# and (or) alternative x and y vectors providing the larger sample.
set.seed(1); nsim &lt;- 800; npair &lt;- 50
X  &lt;-           lmomco::rlmomco(nsim, lmomco::vec2par(c(3, 0.6, +0.5), type="pe3"))
Y  &lt;- 0.3*X^2 + rnorm(nsim, mean=0, sd=0.3)
ix &lt;- sample(seq_len(nsim), npair, replace=FALSE)
Xp &lt;- X[ix]; Yp &lt;- Y[ix]; dtypex &lt;- "gev"; dtypey &lt;- "gev"
xpara &lt;- lmomco::lmr2par(X, type=dtypex); ypara &lt;- lmomco::lmr2par(Y, type=dtypey)

# The next two bicoploc() calls produce identical results except for the density
# of data points along the axes for the rug plots. Ultimately, the same parameter
# estimates for the margins exists for both calls. The plotuv is disabled so that
# the user can tab between the two plotxy plots and see that they are the same.
zz &lt;- bicoploc(Xp,Yp, xout=c(2.5, 3.5, 4.5), ruglwd=0.9, plotuv=FALSE,
               xpara=xpara, ypara=ypara, dtypex=NULL, dtypey=NULL)
mtext("Example of specific xpara and ypara from larger sample", line=0.5)

zz &lt;- bicoploc(Xp,Yp, xout=c(2.5, 3.5, 4.5), ruglwd=0.9, plotuv=FALSE,
               xpara=xpara, ypara=ypara, dtypex=NULL, dtypey=NULL, x=X, y=Y)
mtext("Example of specific xpara and ypara from larger sample", line=0.5) #
## End(Not run)

## Not run: 
########################################################################################
set.seed(1); nsim &lt;- 50
UV &lt;- rCOP(nsim, cop=breveCOP, para=list(cop=W, alpha=0, beta=0))
X  &lt;- qnorm(UV[,1], mean=3, sd=0.6)
Y  &lt;- qnorm(UV[,2], mean=2, sd=0.2)
zz &lt;- bicoploc(X,Y, xout=c(1.5, 2.5, 3.5, 4), dtypex="nor", dtypey="nor")

set.seed(1); nsim &lt;- 50
UV &lt;- rCOP(nsim, cop=breveCOP, para=list(cop=W, alpha=0, beta=0.5))
X  &lt;- qnorm(UV[,1], mean=3, sd=0.6)
Y  &lt;- qnorm(UV[,2], mean=2, sd=0.2)
zz &lt;- bicoploc(X,Y, xout=c(1.5, 2.5, 3.5, 4), dtypex="nor", dtypey="nor")

set.seed(1); nsim &lt;- 50
UV &lt;- rCOP(nsim, cop=breveCOP, para=list(cop=M_N5p12b, para=3, alpha=0, beta=0.5))
X  &lt;- qnorm(UV[,1], mean=3, sd=0.6)^2
Y  &lt;- qnorm(UV[,2], mean=2, sd=0.2)
zz &lt;- bicoploc(X,Y, xout=c(1.5, 2.5, 3.5, 4), ylim=c(1,2.5),
                    xleg="bottomleft", dtypex="aep4", dtypey="nor")

# A TRUE COUNTER EXAMPLE? Are the 1-v operations not sufficient depending on
# rotation? Is the secondary diagonal of a copula useful? Is there something wrong
# with the reflection operations as implemented at the end of November 2023?
# Should negatives be turned into positives by reversing Y within the internal logic?
# The solution current at end of November 2023 seems proper.
set.seed(1); nsim &lt;- 500
para &lt;- list(cop1=W, para1=4, cop2=GHcop, para2=c(30,.6, .9), alpha=0, beta=0.1)
UV &lt;- rCOP(nsim, cop=composite2COP, para=para)
X  &lt;- -qexp(UV[,1], rate=10)+0.1 # Or the problem is a reflected exponential but the
Y  &lt;- qnorm(UV[,2], mean=2, sd=0.2)  # exp version in lmomco can not handle
zz &lt;- bicoploc(X,Y, xout=c(-0.05, 0, 0.2), dtypex="exp", dtypey="nor")
# Possibly, try another distribution.
zz &lt;- bicoploc(X,Y, xout=c(-0.3, -0.2, 0), ylim=c(1,4), dtypex="aep4", dtypey="nor") #
## End(Not run)

## Not run: 
########################################################################################
set.seed(1); nsim &lt;- 200; npair &lt;- 30
para &lt;- list(cop=PLcop, para=80, alpha=0.3, beta=0.05)
UV &lt;- rCOP(nsim, cop=composite1COP, para=para, resamv01=TRUE)
X  &lt;- lmomco::qlmomco(UV[,1], lmomco::vec2par(c(3, 0.6, +0.4), type="pe3"))
Y  &lt;- lmomco::qlmomco(UV[,2], lmomco::vec2par(c(3, 0.4, +0.0), type="pe3"))
ix &lt;- sample(seq_len(nsim), npair, replace=FALSE)
Xp &lt;- X[ix]; Yp &lt;- Y[ix]; dtypex &lt;- "pe3"; dtypey &lt;- "pe3"
xpara &lt;- lmomco::lmr2par(X, type=dtypex); ypara &lt;- lmomco::lmr2par(Y, type=dtypey)
plot(10^X, 10^Y, log="xy", las=1, pch=21, lwd=0.8, col="black", bg="white",
                 xlab="SOME RISK PHENOMENON IN X-DIRECTION",
                 ylab="SOME RISK PHENOMENON IN Y-DIRECTION")
xout &lt;- c(1.5, 2.5, 3.5, 4)
xlim &lt;- c(1.5, 4.5); ylim &lt;- c(1.8, 5.0)
zz &lt;- bicoploc(Xp,Yp, xout=xout,xpara=xpara,ypara=ypara,  xlim=xlim,ylim=ylim)

zz &lt;- bicoploc(Xp,Yp, xout=xout,xpara=xpara,ypara=ypara,  xlim=xlim,ylim=ylim,x=X,y=Y)
zz &lt;- bicoploc(Xp,Yp, xout=xout,dtypex="pe3",dtypey="pe3",xlim=xlim,ylim=ylim,x=X,y=Y)

zz &lt;- bicoploc(X, Y,  xout=xout,dtypex="pe3",dtypey="pe3",xlim=xlim,ylim=ylim)#
## End(Not run)
</code></pre>


</div>