<div class="container">

<table style="width: 100%;"><tr>
<td>cv.KLR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>K-fold cross-validation for Kernel Logistic Regression</h2>

<h3>Description</h3>

<p>The function performs k-fold cross validation for kernel logistic regression to estimate tuning parameters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cv.KLR(X, y, K = 5, lambda = seq(0.001, 0.2, 0.005), kernel = c("matern",
  "exponential")[1], nu = 1.5, power = 1.95, rho = seq(0.05, 0.5, 0.05))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>input for <code>KLR</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>input for <code>KLR</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>a positive integer specifying the number of folds. The default is 5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>a vector specifying lambda values at which CV curve will be computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel</code></td>
<td>
<p>input for <code>KLR</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p>input for <code>KLR</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>input for <code>KLR</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>rho value at which CV curve will be computed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function performs the k-fold cross-valibration for a kernel logistic regression. The CV curve is computed at the values of the tuning parameters assigned by <code>lambda</code> and <code>rho</code>. The number of fold is given by <code>K</code>.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>value of <code>lambda</code> that gives minimum CV error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>value of <code>rho</code> that gives minimum CV error.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Chih-Li Sung &lt;iamdfchile@gmail.com&gt;
</p>


<h3>See Also</h3>

<p><code>KLR</code> for performing a kernel logistic regression with given <code>lambda</code> and <code>rho</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(calibrateBinary)

set.seed(1)
np &lt;- 10
xp &lt;- seq(0,1,length.out = np)
eta_fun &lt;- function(x) exp(exp(-0.5*x)*cos(3.5*pi*x)-1) # true probability function
eta_x &lt;- eta_fun(xp)
yp &lt;- rep(0,np)
for(i in 1:np) yp[i] &lt;- rbinom(1,1, eta_x[i])

x.test &lt;- seq(0,1,0.001)
etahat &lt;- KLR(xp,yp,x.test)

plot(xp,yp)
curve(eta_fun, col = "blue", lty = 2, add = TRUE)
lines(x.test, etahat, col = 2)

#####   cross-validation with K=5    #####
##### to determine the parameter rho #####

cv.out &lt;- cv.KLR(xp,yp,K=5)
print(cv.out)

etahat.cv &lt;- KLR(xp,yp,x.test,lambda=cv.out$lambda,rho=cv.out$rho)

plot(xp,yp)
curve(eta_fun, col = "blue", lty = 2, add = TRUE)
lines(x.test, etahat, col = 2)
lines(x.test, etahat.cv, col = 3)

</code></pre>


</div>