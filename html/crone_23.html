<div class="container">

<table style="width: 100%;"><tr>
<td>standardise_fdata</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Standardise reflections data</h2>

<h3>Description</h3>

<p>This function output a list with fields needed by most of the
functions dealing with structure factors. It is the equivalent
of the function <cite>standardise_sdata</cite>, used to prepare atomic
structures data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">standardise_fdata(a, SG, hidx, Fobs = NULL, sigFobs = NULL,
  Fp = NULL, sigFp = NULL, Fm = NULL, sigFm = NULL,
  Phiobs = NULL, Phicalc = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>Real numeric. Unit cell length in angstroms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SG</code></td>
<td>
<p>SG 2-letters character string. There are only two symmetries
possible when working within 1D crystallography, P1 (no 
symmetry) and P-1 (inversion through the origin). SG can be 
either "P1" or "P-1".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hidx</code></td>
<td>
<p>Real numeric array. 1D unique (positive in the 1D context)
Miller indices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Fobs</code></td>
<td>
<p>Real numeric array. Amplitudes of structure factors.
If Fp and Fm are not NULL and Fobs is NULL, then Fobs are calculated
as averages of Fp and Fm. If both Fp, Fm and Fobs are included, input
Fobs are used, instead of Fp and Fm averages.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigFobs</code></td>
<td>
<p>Real numeric array. Errors associated with Fobs. If
sigFobs = NULL, errors are estimated from Fp and Fm. Default is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Fp</code></td>
<td>
<p>Real numeric vector. Amplitudes of the positive 
component of Friedel (or Bijvoet) pairs (F+). Default is NULL,
i.e. no Fp included.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigFp</code></td>
<td>
<p>Real numeric vector. Errors associated with Fp. Default
is NULL, i.e. no sigFp included.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Fm</code></td>
<td>
<p>Real numeric vector. Amplitudes of the negative 
component of Friedel (or Bijvoet) pairs (F-). Default is NULL,
i.e. no Fm included.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigFm</code></td>
<td>
<p>Real numeric vector. Errors associated with Fm. Default
is NULL, i.e. no sigFm included.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Phiobs</code></td>
<td>
<p>Real numeric array. Phases (in degrees) of structure 
factors obtained with one of the methods used for structure solution.
Default is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Phicalc</code></td>
<td>
<p>Real numeric array. Phases (in degrees) of structure 
factors calculated from the correct 1D structure. They are normally 
used to check correctness of Phiobs. Default is NULL.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A named list with a variable number of elements. Some of them
are always included; others are not:
</p>

<ul>
<li>
<p>a    Real numeric. Unit cell length in angstroms. Always 
included.
</p>
</li>
<li>
<p>SG.   Spacegroup 2-letters character string. There are only two 
symmetries possible when working within 1D 
crystallography, P1 (no symmetry) and P-1 (inversion 
through the origin). SG can be either "P1" or "P-1". 
Always included.
</p>
</li>
<li>
<p>hidx. Real numeric array. 1D unique (positive in the 1D context) 
Miller indices. Always included.
</p>
</li>
<li>
<p>Fobs.      Real numeric array. Amplitudes of observed structure 
factors. Not always included.
</p>
</li>
<li>
<p>sigFobs.   Real numeric array. Errors associated with Fobs. Not 
always included.
</p>
</li>
<li>
<p>Fp.        Real numeric vector. Amplitudes of the positive 
component of Friedel (or Bijvoet) pairs (F+). Not
always included.
</p>
</li>
<li>
<p>sigFp.     Real numeric vector. Errors associated with Fp. 
Not always included.
</p>
</li>
<li>
<p>Fm.        Real numeric vector. Amplitudes of the negative 
component of Friedel (or Bijvoet) pairs (F-). Not always
included.
</p>
</li>
<li>
<p>sigFm.     Real numeric vector. Errors associated with Fm. Not
always included.
</p>
</li>
<li>
<p>Phiobs.    Real numeric array. Phases (in degrees) of structure 
factors obtained with one of the methods used for 
structure solution. Not always included.
</p>
</li>
<li>
<p>Phicalc.   Real numeric array. Phases (in degrees) of structure 
factors calculated from the correct 1D structure. 
They are normally used to check correctness of 
Phiobs. Not always included.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R"># Create an arbitrary structure with a heavy atom (Fe)
a &lt;- 20
SG &lt;- "P1"
x0 &lt;- c(1,2,6,16)
Z &lt;- c(6,8,26,7)
B &lt;- c(8,7,5,8)
occ &lt;- c(1,1,1,1)
sdata &lt;- standardise_sdata(a,SG,x0,Z,B,occ)

# Miller indices, from -5 to 5 (to include negatives for anomalous)
hidx &lt;- -5:5

# Experimental structure factors with anomalous contribution
# (lambda = 1.74) for creating Fm and Fp. Errors only due to
# photons fluctuations.
set.seed(9195)   # For demo purposes.
ltmp &lt;- sfobs(hidx,sdata,ntrialP=10,anoflag=TRUE,lbda=1.74)

# Fp and sigFp (Miller indices from 1 to 5)
isel &lt;- 1:5
idx &lt;- match(isel,hidx)
Fp &lt;- ltmp$F[idx]
sigFp &lt;- ltmp$sF[idx]

# Fm and sigFm
isel &lt;- (-1):(-5)
idx &lt;- match(isel,hidx)
Fm &lt;- ltmp$F[idx]
sigFm &lt;- ltmp$sF[idx]

# Now only positive Miller indices
hidx &lt;- 1:5

# Create standardised data for reciprocal space
fdata &lt;- standardise_fdata(a,SG,hidx,Fp=Fp,sigFp=sigFp,
         Fm=Fm,sigFm=sigFm)
         
# Fp and Fm
print(fdata$Fp)
print(fdata$sigFp)
print(fdata$Fm)
print(fdata$sigFm)

# Fobs and sigFobs automatically created
print(fdata$Fobs)
print(fdata$sigFobs)

# Structure factors without anomalous data for the same structure
hidx &lt;- 1:5
set.seed(9195)   # For demo purposes.
ltmp &lt;- sfobs(hidx,sdata,ntrialP=10)
Fobs &lt;- ltmp$F
sigFobs &lt;- ltmp$sF
fdata &lt;- standardise_fdata(a,SG,hidx,Fobs=Fobs,sigFobs=sigFobs)
print(fdata)

</code></pre>


</div>