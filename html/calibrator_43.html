<div class="container">

<table style="width: 100%;"><tr>
<td>p.page4</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>A postiori probability of hyperparameters</h2>

<h3>Description</h3>

<p>Function to determine a postiori probability of hyperparameters
<code class="reqn">\rho</code>, <code class="reqn">\lambda</code> and <code class="reqn">\psi_2</code>,
given observations and <code class="reqn">\psi_1</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">p.page4(D1, D2, H1, H2, V, y, z, E.theta, Edash.theta, extractor, include.prior=FALSE,
lognormally.distributed=FALSE, return.log=FALSE, phi)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>D1</code></td>
<td>
<p>Matrix of code run points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D2</code></td>
<td>
<p>Matrix of observation points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H1</code></td>
<td>
<p>Basis function (vectorized)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H2</code></td>
<td>
<p>Regression function for D2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p>Covariance matrix; default value of <code>NULL</code> results in
the function evaluating it (but this takes a long time, so supply
<code>V</code> if known)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Vector of code outputs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>Vector of observation values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>E.theta</code></td>
<td>
<p>Expectation over theta</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Edash.theta</code></td>
<td>
<p>Expectation over theta WRT <code class="reqn">E'</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extractor</code></td>
<td>
<p>Function to extract independent variables and
parameters from D1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include.prior</code></td>
<td>
<p>Boolean, with <code>TRUE</code>
meaning to include the prior PDF for <code class="reqn">\theta</code> and default
value of <code>FALSE</code> meaning to return the likelihood multiplied by an
undetermined constant</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lognormally.distributed</code></td>
<td>
<p>Boolean with <code>TRUE</code> meaning to assume
lognormality.  See <code>prob.psi1</code> for details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.log</code></td>
<td>
<p>Boolean, with default <code>FALSE</code> meaning to return
the probability, and <code>TRUE</code> meaning to return the (natural)
logarithm of the probability (which is useful when considering very
small probabilities)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>Hyperparameters</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Robin K. S. Hankin</p>


<h3>References</h3>


<ul>
<li>
<p>M. C. Kennedy and A. O'Hagan 2001. <em>Bayesian
calibration of computer models</em>.  Journal of the Royal Statistical
Society B, 63(3) pp425-464
</p>
</li>
<li>
<p>M. C. Kennedy and A. O'Hagan 2001.  <em>Supplementary details on
Bayesian calibration of computer models</em>, Internal report, University
of Sheffield.  Available at
<a href="http://www.tonyohagan.co.uk/academic/ps/calsup.ps">http://www.tonyohagan.co.uk/academic/ps/calsup.ps</a>
</p>
</li>
<li>
<p>R. K. S. Hankin 2005. <em>Introducing BACCO, an R bundle for
Bayesian analysis of computer code output</em>, Journal of Statistical
Software, 14(16)
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>W2</code></p>


<h3>Examples</h3>

<pre><code class="language-R">data(toys)

p.page4(D1=D1.toy, D2=D2.toy, H1=H1.toy, H2=H2.toy, V=NULL, y=y.toy,
z=z.toy,E.theta=E.theta.toy, Edash.theta=Edash.theta.toy, extractor=extractor.toy, phi=phi.toy)

## Now compare the above value with p.page4() calculated with phi
## differing only in psi2:

phi.toy.new &lt;- phi.change(phi.fun=phi.fun.toy, old.phi = phi.toy, psi2=c(8,8,8))

p.page4(D1=D1.toy, D2=D2.toy, H1=H1.toy, H2=H2.toy, V=V.toy, y=y.toy, z=z.toy,
E.theta=E.theta.toy, Edash.theta=Edash.theta.toy,
extractor=extractor.toy, phi=phi.toy.new)
## different!

</code></pre>


</div>