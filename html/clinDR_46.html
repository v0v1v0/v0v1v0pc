<div class="container">

<table style="width: 100%;"><tr>
<td>RandEmax</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Random data constructor function for emaxsim creating random parameters
for an Emax model for continuous or binary data.</h2>

<h3>Description</h3>

<p>Creates a list object that contains inputs and a function to create
simulated data sets for emaxsim.  Data sets are created by
generating random parameters from beta or log-normal distributions for 
a 3/4 parameter Emax model. For binary data, the Emax model is on the logit scale
and then back-transformed. <code>RandEmax</code> is deprecated.  
See <code>randomEmax</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">RandEmax(n, doselev, 
	parmEmax,
	parmE0,
	p50,
	parmED50=c(3,0.79,0.6),
	parmLambda=c(3.03,18.15,0,6),
	resSD,
	dfSD=Inf,
	binary=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Sample size for each dose group. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>doselev</code></td>
<td>
<p>Dose levels (including 0 for placebo) included in the
study corresponding to <code>n</code>.  Must be in increasing order.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parmEmax</code></td>
<td>
<p>Vector with mean and standard deviation for a random
normal Emax</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parmE0</code></td>
<td>
<p>Vector with mean and standard deviation for a random
normal intercept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p50</code></td>
<td>
<p>The predicted ED50</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parmED50</code></td>
<td>
<p>  The log(ED50) is generated from a t-distribution
with <code>df=parmED50[1]</code>, <code>mean=log(p50)+parmED50[2]</code>, 
and <code>scale=parmED50[3]</code>.
The default values are taken from the reference below.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parmLambda</code></td>
<td>
<p>For a beta distributed sigmoid lambda, a vector with
(df1,df2,lower bound, upper bound).  For a hyperbolic model, lambda=1.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resSD</code></td>
<td>
<p>Standard deviation for residuals within each dose (normal data only)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dfSD</code></td>
<td>
<p>If a finite value is specified, the within-dose group SD is randomly
generated from resSD times sqrt(dfSD/chisquare(dfSD))), which is the form of a posterior
distribution for a SD based on a existing sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binary</code></td>
<td>
<p>When <code>TRUE</code>, <code>0/1</code> data are generated from the
Emax model, which is computed on the logit scale and then 
backtransformed to yield proportions.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>All parameters are independent.  Normal data are
generated from the dose response curves with homogeneous-variance
normal residuals.  Binary data are 0/1 generated from Bernoulli 
distributions with proportions computed by transforming the Emax
model output from the logit to proportion scale.  
Default values are based on recommendations in
</p>
<p>Thomas, N., Sweeney, K., and Somayaji, V. (2014).  Meta-analysis 
of clinical dose response in a large drug development portfolio.  
&lt;doi:10.1080/19466315.2014.924876&gt;
</p>


<h3>Value</h3>

<p>A list of length <code>2</code>.  
The first element is itself a list named <code>genP</code> that contains named elments
<code>n</code>, <code>resSD</code>, <code>dfSD</code>, <code>doselev</code>, <code>dose</code>,  
<code>binary</code> and the
elements <code>parmE0</code>, <code>p50</code>, <code>parmED50</code>, <code>parmEmax</code>, 
and <code>parmLambda</code>. 
which are specific to <code>RandEmax</code>.  The second
element is a function named <code>genFun</code> that takes
<code>genP</code> as input and returns a list with named elements <code>meanlev</code>, 
<code>parm</code>, <code>resSD</code>, <code>y</code>.  
</p>


<h3>Author(s)</h3>

<p> Neal Thomas </p>


<h3>See Also</h3>

 <p><code>emaxsim</code>, <code>FixedMean</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">simParm&lt;-RandEmax(n=c(99,95,98,94,98,98),doselev=c(0,5,10,25,50,150),
         parmE0=c(-2.6,2.5),p50=25,parmEmax=c(-1.25,2),resSD=3.88)
</code></pre>


</div>