<div class="container">

<table style="width: 100%;"><tr>
<td>varianceGraph.cgOneFactorFit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Equal Variance Graphs assessment of cgOneFactorFit object
</h2>

<h3>Description</h3>

<p>Graph residuals of a cgOneFactorFit object to assess equal variance assumption
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'cgOneFactorFit'
varianceGraph(fit, trend = NULL, cgtheme = TRUE,
 device = "single", ...)  
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fit </code></td>
<td>

<p>A fit object of class <code>cgOneFactorFit</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trend </code></td>
<td>

<p>Add a trend line. When set to the default <code>NULL</code>, the addition
of a trend line depends on the following: When there is no censored
data,  a trend will be added with the <code>lowess</code> smoother.
If any censored data residuals are present,
then at least 7 groups are needed in the fit
for a trend line to be added with the <span class="pkg">VGAM</span>::<code>vgam</code> smoothing
spline.
Otherwise, group means are estimated
and connected. The values of <code>FALSE</code> and <code>TRUE</code> override
this. See Details section below.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cgtheme </code></td>
<td>

<p>When set to the default <code>TRUE</code>, ensures a trellis device is active with
limited color scheme. Namely <code>background</code>,
<code>strip.shingle</code>, and <code>strip.background</code> are each set to <code>"white"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>device </code></td>
<td>
<p>Can be one of three values:
</p>

<dl>
<dt><code>"single"</code></dt>
<dd>
<p>The default, which will put all graphs on the same
device page. For example, when resistant &amp; robust and classical
least squares are present and <code>model="both"</code> (the default),
a 2 x 1 paneled graph will be created.</p>
</dd>
<dt><code>"multiple"</code></dt>
<dd>
<p>Relevant only when resistant &amp; robust and classical
least squares are present and <code>model="both"</code> (the default) or 
<code>model="extended"</code>. In
those cases, a new graphics device is generated to hold the resistant &amp; robust
version, as a single-paneled graph, 
and the classical least squares version is on the previous device.
If <code>model="extended"</code>, then
a second new graphics device is generated to hold the unweighted
resistant &amp; robust residuals, as another single-paneled graph.</p>
</dd>
<dt><code>"ask"</code></dt>
<dd>
<p>Relevant only when resistant &amp; robust and classical
least squares are present and <code>model="both"</code> (the default) or
<code>model="extended"</code>. In
that case, each are portrayed as a single-paneled graph, with the
<code>ask=TRUE</code> argument specified in <code>par</code> so that
the user input confirmation is needed before the graphs are
drawn.
</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>... </code></td>
<td>

<p>Additional arguments. Two are currently valid: 
</p>

<dl>
<dt>
<code>model</code> </dt>
<dd>
<p>For <code>cgOneFactorFit</code> <code>fit</code> objects that have 
classical least squares <code>lm()</code> or resistant &amp; robust
<code>rlm()</code> fits, the following argument values are possible:
</p>

<dl>
<dt><code>"both"</code></dt>
<dd>
<p>Graphs of the residuals from both the ordinary 
classical least squares and resistant &amp; robust fits are
plotted. This is the default when both fits are present in
the <code>cgOneFactorFit</code> object specified in the <code>fit</code>
argument. If the resistant &amp; robust fit is not available,
this value is not relevant.
</p>
</dd>
<dt><code>"olsonly"</code></dt>
<dd>
<p>Only a graph of the residuals from
the ordinary 
classical least squares <code>olsfit</code> fit is performed.
</p>
</dd>
<dt>
<code>"rronly"</code> or <code>"rrwtdonly"</code>
</dt>
<dd>
<p>Only a graph of the 
weighted residuals from 
the resistant and
robust <code>rrfit</code> fit is plotted.
</p>
</dd>
<dt><code>"rrunwtdonly"</code></dt>
<dd>
<p>Only a graph of the unweighted 
residuals from 
the resistant and
robust <code>rrfit</code> fit is plotted.
</p>
</dd>
</dl>
<p>For other possible <code>cgOneFactorFit</code> fit slots such as
accelerated failure time or unequal variance models, the <code>model</code>
argument is not relevant, and the appropriate graph will
be plotted for these model types.
</p>
</dd>
</dl>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The graph plots the square root of the absolute value of the residuals against
the fitted value. The square root spacing on the y-axis has tick marks
in the fitted scale.  The notion of using the squared root of the absolute residuals is
attributed to John Tukey.
</p>
<p>The values are automatically jittered to minimize overlapping points.
For censored data, left-censored values are shown as a shallow "V",
which is actually just a rotated downward "&lt;" sign. Similarly, right-censored
values are shown as a deeper "^", which is a rotated upward "&gt;" sign.
</p>
<p>For the <code>trend</code> argument, an added trend line when censored data residuals
are present needs to be interpreted cautiously. When there are 7 or more
groups, a cubic smoothing spline based on <span class="pkg">VGAM</span>::<code>vgam</code>
is fit; otherwise, the group means of the residuals are estimated with
an accelerated failure time model and then just connected. If "too many"
censored data values are present, the line may be withheld and
warnings will be issued, or if forced with <code>line=TRUE</code>, for
example, may appear nonsensical.
</p>
<p>The heading for the graph is taken from the <code>cgOneFactorData</code> object,
which <code>prepareCGOneFactorData</code> sets from its <code>analysisname</code> 
argument.
</p>
<p>The label for the Y-axis is taken from the <code>cgOneFactorData</code> object,
which <code>prepareCGOneFactorData</code> sets from its <code>endptname</code> 
argument.
</p>
<p>The number of decimal places printed in the ticks on the Y-axis is taken
from the <code>cgOneFactorData</code> object,
which <code>prepareCGOneFactorData</code> sets from its <code>digits</code> 
argument.
</p>
<p>The minimum and maximum values from the range of the absolute valued residuals are
respectively labeled in the bottom and top left corners of the graph
region.
</p>
<p>If group labels along the x-axis seem to overlap in the standard
horizontal form, they will be rotated 45 degrees.
</p>


<h3>Value</h3>

<p><code>varianceGraph.cgOneFactorFit</code> returns
an invisible <code>NULL</code>. The main purpose is the side
effect of graphing to the current device.
</p>


<h3>Note</h3>

<p>Contact <a href="mailto:cg@billpikounis.net">cg@billpikounis.net</a> for bug reports, questions,
concerns, and comments. 
</p>


<h3>Author(s)</h3>

<p>Bill Pikounis [aut, cre, cph], John Oleynick [aut], Eva Ye [ctb]
</p>


<h3>Examples</h3>

<pre><code class="language-R">## From running examples of cgOneFactorData objects
data(canine)
canine.data &lt;- prepareCGOneFactorData(canine, format="groupcolumns",
                                      analysisname="Canine",
                                      endptname="Prostate Volume",
                                      endptunits=expression(plain(cm)^3),
                                      digits=1, logscale=TRUE, refgrp="CC")
canine.fit &lt;- fit(canine.data)

varianceGraph(canine.fit)

varianceGraph(canine.fit, model="olsonly")


gmcsfcens.data &lt;- prepareCGOneFactorData(gmcsfcens, format="groupcolumns",
                                         analysisname="cytokine",
                                         endptname="GM-CSF (pg/ml)",
                                         logscale=TRUE,
                                         digits=1)

gmcsfcens.fit &lt;- fit(gmcsfcens.data, type="aft")

varianceGraph(gmcsfcens.fit, trend=TRUE)

varianceGraph(gmcsfcens.fit) ## will yield a warning message why no line
                             ## is graphed

varianceGraph(gmcsfcens.fit, trend=FALSE)





</code></pre>


</div>