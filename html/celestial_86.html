<div class="container">

<table style="width: 100%;"><tr>
<td>planck</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Planck's Law and Related Functions
</h2>

<h3>Description</h3>

<p>Functions related to Planck's Law of thermal radiation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cosplanckLawRadFreq(nu,Temp=2.725)
cosplanckLawRadWave(lambda,Temp=2.725)
cosplanckLawEnFreq(nu,Temp=2.725)
cosplanckLawEnWave(lambda,Temp=2.725)
cosplanckLawRadFreqN(nu,Temp=2.725)
cosplanckLawRadWaveN(lambda,Temp=2.725)
cosplanckPeakFreq(Temp=2.725)
cosplanckPeakWave(Temp=2.725)
cosplanckSBLawRad(Temp=2.725)
cosplanckSBLawRad_sr(Temp=2.725)
cosplanckSBLawEn(Temp=2.725)
cosplanckLawRadPhotEnAv(Temp=2.725)
cosplanckLawRadPhotN(Temp=2.725)
cosplanckCMBTemp(z,Temp=2.725)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>

<p>The frequency of radiation in Hertz (Hz).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>

<p>The wavelength of radiation in metres (m).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Temp</code></td>
<td>

<p>The absolute temperature of the system in Kelvin (K).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>

<p>Redshift, where z must be &gt; -1 (can be a vector).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The functions with <code>Rad</code> in the name are related the spectral radiance form of Planck's Law (typically designated I or B), whilst those with <code>En</code> are related to the spectral energy density form of Planck's Law (u), where <code class="reqn">u=4\pi I/c</code>.
</p>
<p>To calculate the number of photons in a mode we simply use <code class="reqn">E=h\nu=h c / \lambda</code>.
</p>
<p>Below h is the Planck constant, <code class="reqn">k_B</code> is the Boltzmann constant, c is the speed-of-light in a vacuum and <code class="reqn">\sigma</code> is the Stefan-Boltzmann constant.
</p>
<p><code>cosplanckLawRadFreq</code> is the spectral radiance per unit frequency version of Planck's Law, defined as:
</p>
<p style="text-align: center;"><code class="reqn">B_\nu(\nu,T) = I_\nu(\nu,T) = \frac{2 h \nu^3}{c^2} \frac{1}{e^{h \nu / k_B T}-1}</code>
</p>

<p><code>cosplanckLawRadWave</code> is the spectral radiance per unit wavelength version of Planck's Law, defined as:
</p>
<p style="text-align: center;"><code class="reqn">B_\lambda(\lambda,T) = I_\lambda(\lambda,T) = \frac{2 h c^2}{\lambda^5} \frac{1}{e^{h c / \lambda k_B T}-1}</code>
</p>

<p><code>cosplanckLawRadFreqN</code> is the number of photons per unit frequency, defined as:
</p>
<p style="text-align: center;"><code class="reqn">B_\nu(\nu,T) = I_\nu(\nu,T) = \frac{2 \nu^2}{c^2} \frac{1}{e^{h \nu / k_B T}-1}</code>
</p>

<p><code>cosplanckLawRadWaveN</code> is the number of photons per unit wavelength, defined as:
</p>
<p style="text-align: center;"><code class="reqn">B_\lambda(\lambda,T) = I_\lambda(\lambda,T) = \frac{2 c}{\lambda^4} \frac{1}{e^{h c / \lambda k_B T}-1}</code>
</p>

<p><code>cosplanckLawEnFreq</code> is the spectral energy density per unit frequency version of Planck's Law, defined as:
</p>
<p style="text-align: center;"><code class="reqn">u_\nu(\nu,T) = \frac{8 \pi h \nu^3}{c^3} \frac{1}{e^{h\nu/k_B T}-1}</code>
</p>

<p><code>cosplanckLawEnWave</code> is the spectral energy density per unit wavelength version of Planck's Law, defined as:
</p>
<p style="text-align: center;"><code class="reqn">u_\lambda(\lambda,T) = \frac{8 \pi h c}{\lambda^5} \frac{1}{e^{h c / \lambda k_B T}-1}</code>
</p>

<p><code>cosplanckPeakFreq</code> gives the location in frequency of the peak of <code class="reqn">I_\nu(\nu,T)</code>, defined as:
</p>
<p style="text-align: center;"><code class="reqn">\nu_{peak} = 2.821 k_B T</code>
</p>

<p><code>cosplanckPeakWave</code> gives the location in wavelength of the peak of <code class="reqn">I_\lambda(\lambda,T)</code>, defined as:
</p>
<p style="text-align: center;"><code class="reqn">\lambda_{peak} = 4.965 k_B T</code>
</p>

<p><code>cosplanckSBLawRad</code> gives the emissive power (or radiant exitance) version of the Stefan-Boltzmann Law, defined as:
</p>
<p style="text-align: center;"><code class="reqn">j^* = \sigma T^4</code>
</p>

<p><code>cosplanckSBLawRad_sr</code> gives the spectral radiance version of the Stefan-Boltzmann Law, defined as:
</p>
<p style="text-align: center;"><code class="reqn">L = \sigma T^4/\pi</code>
</p>

<p><code>cosplanckSBLawEn</code> gives the energy density version of the Stefan-Boltzmann Law, defined as:
</p>
<p style="text-align: center;"><code class="reqn">\epsilon = 4 \sigma T^4 / c</code>
</p>

<p>Notice that <code class="reqn">j^*</code> and L merely differ by a factor of <code class="reqn">\pi</code>, i.e. L is per steradian.
</p>
<p><code>cosplanckLawRadPhotEnAv</code> gives the average energy of the emitted black body photon, defined as:
</p>
<p style="text-align: center;"><code class="reqn">&lt;E_{phot}&gt; = 3.729282 \times 10^{-23} T</code>
</p>

<p><code>cosplanckLawRadPhotN</code> gives the total number of photons produced by black body per metre squared per second per steradian, defined as:
</p>
<p style="text-align: center;"><code class="reqn">N_{phot} = 1.5205 \times 10^{15} T^3 / \pi</code>
</p>

<p>Various confidence building sanity checks of how to use these functions are given in the Examples below.
</p>


<h3>Value</h3>

<p>Planck's Law in terms of spectral radiance:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>cosplanckLawRadFreq</code></td>
<td>

<p>The power per steradian per metre squared per unit frequency for a black body (W.sr<code class="reqn">^{-1}</code>.m<code class="reqn">^{-2}</code>.Hz<code class="reqn">^{-1}</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cosplanckLawRadWave</code></td>
<td>

<p>The power per steradian per metre squared per unit wavelength for a black body (W.sr<code class="reqn">^{-1}</code>.m<code class="reqn">^{-2}</code>.m<code class="reqn">^{-1}</code>).
</p>
</td>
</tr>
</table>
<p>Planck's Law in terms of spectral energy density:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>cosplanckLawEnFreq</code></td>
<td>

<p>The energy per metre cubed per unit frequency for a black body (J.m<code class="reqn">^{-3}</code>.Hz<code class="reqn">^{-1}</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cosplanckLawEnWave</code></td>
<td>

<p>The energy per metre cubed per unit wavelength for a black body (J.m<code class="reqn">^{-3}</code>.m<code class="reqn">^{-1}</code>).
</p>
</td>
</tr>
</table>
<p>Photon counts:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>cosplanckLawRadFreqN</code></td>
<td>

<p>The number of photons per steradian per metre squared per second per unit frequency for a black body (photons.sr<code class="reqn">^{-1}</code>.m<code class="reqn">^{-2}</code>.s<code class="reqn">^{-1}</code>.Hz<code class="reqn">^{-1}</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cosplanckLawRadWaveN</code></td>
<td>

<p>The number of photonsper steradian per metre squared per second per unit wavelength for a black body (photons.sr<code class="reqn">^{-1}</code>.m<code class="reqn">^{-2}</code>.s<code class="reqn">^{-1}</code>.m<code class="reqn">^{-1}</code>).
</p>
</td>
</tr>
</table>
<p>Peak locations (via Wien's displacement law):
</p>
<table>
<tr style="vertical-align: top;">
<td><code>cosplanckPeakFreq</code></td>
<td>

<p>The frequency location of the radiation peak for a black body as found in <code>cosplanckLawRadFreq</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cosplanckPeakWave</code></td>
<td>

<p>The wavelength location of the radiation peak for a black body as found in <code>cosplanckLawRadWave</code>.
</p>
</td>
</tr>
</table>
<p>Stefan-Boltzmann Law:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>cosplanckSBLawRad</code></td>
<td>

<p>Total energy radiated per metre squared per second across all wavelengths for a black body (W.m<code class="reqn">^{-2}</code>). This is the emissive power version of the Stefan-Boltzmann Law.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cosplanckSBLawRad_sr</code></td>
<td>

<p>Total energy radiated per metre squared per second per steradian across all wavelengths for a black body (W.m<code class="reqn">^{-2}</code>.sr<code class="reqn">^{-1}</code>). This is the radiance version of the Stefan-Boltzmann Law.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cosplanckSBLawEn</code></td>
<td>

<p>Total energy per metre cubed across all wavelengths for a black body (J.m<code class="reqn">^{-3}</code>). This is the energy density version of the Stefan-Boltzmann Law.
</p>
</td>
</tr>
</table>
<p>Photon properties:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>cosplanckLawRadPhotEnAv</code></td>
<td>

<p>Average black body photon energy (J).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cosplanckLawRadPhotN</code></td>
<td>

<p>Total number of photons produced by black body per metre squared per second per steradian (m<code class="reqn">^{-2}</code>.s<code class="reqn">^{-1}</code>.sr<code class="reqn">^{-1}</code>).
</p>
</td>
</tr>
</table>
<p>Cosmic Microwave Background:
</p>
<table><tr style="vertical-align: top;">
<td><code>cosplanckCMBTemp</code></td>
<td>

<p>The temperaure of the CMB at redshift z.
</p>
</td>
</tr></table>
<h3>Author(s)</h3>

<p>Aaron Robotham
</p>


<h3>References</h3>

<p>Marr J.M., Wilkin F.P., 2012, AmJPh, 80, 399
</p>


<h3>See Also</h3>

<p><code>cosgrow</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Classic example for different temperature stars:

waveseq=10^seq(-7,-5,by=0.01)
plot(waveseq, cosplanckLawRadWave(waveseq,5000),
log='x', type='l', xlab=expression(Wavelength / m),
ylab=expression('Spectral Radiance' / W*sr^{-1}*m^{-2}*m^{-1}), col='blue')
lines(waveseq, cosplanckLawRadWave(waveseq,4000), col='green')
lines(waveseq, cosplanckLawRadWave(waveseq,3000), col='red')
legend('topright', legend=c('3000K','4000K','5000K'), col=c('red','green','blue'), lty=1)

#CMB now:

plot(10^seq(9,12,by=0.01), cosplanckLawRadFreq(10^seq(9,12,by=0.01)),
log='x', type='l', xlab=expression(Frequency / Hz),
ylab=expression('Spectral Radiance' / W*sr^{-1}*m^{-2}*Hz^{-1}))
abline(v=cosplanckPeakFreq(),lty=2)

plot(10^seq(-4,-1,by=0.01), cosplanckLawRadWave(10^seq(-4,-1,by=0.01)),
log='x', type='l', xlab=expression(Wavelength / m),
ylab=expression('Spectral Radiance' / W*sr^{-1}*m^{-2}*m^{-1}))
abline(v=cosplanckPeakWave(),lty=2)

#CMB at surface of last scattering:

TempLastScat=cosplanckCMBTemp(1100) #Note this is still much cooler than our Sun!

plot(10^seq(12,15,by=0.01), cosplanckLawRadFreq(10^seq(12,15,by=0.01),TempLastScat),
log='x', type='l', xlab=expression(Frequency / Hz),
ylab=expression('Spectral Radiance' / W*sr^{-1}*m^{-2}*Hz^{-1}))
abline(v=cosplanckPeakFreq(TempLastScat),lty=2)

plot(10^seq(-7,-4,by=0.01), cosplanckLawRadWave(10^seq(-7,-4,by=0.01),TempLastScat),
log='x', type='l', xlab=expression(Wavelength / m),
ylab=expression('Spectral Radiance' / W*sr^{-1}*m^{-2}*m^{-1}))
abline(v=cosplanckPeakWave(TempLastScat),lty=2)

#Exact number of photons produced by black body:

cosplanckLawRadPhotN()

#We can get pretty much the correct answer through direct integration, i.e.:

integrate(cosplanckLawRadFreqN,1e8,1e12)
integrate(cosplanckLawRadWaveN,1e-4,1e-1)

#Stefan-Boltzmann Law:

cosplanckSBLawRad_sr()

#We can get (almost, some rounding is off) the same answer by multiplying
#the total number of photons produced by a black body per metre squared per
#second per steradian by the average photon energy:

cosplanckLawRadPhotEnAv()*cosplanckLawRadPhotN()

</code></pre>


</div>