<div class="container">

<table style="width: 100%;"><tr>
<td>canopy.sample.cluster</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
MCMC sampling in tree space with pre-clustering of SNAs
</h2>

<h3>Description</h3>

<p>To sample the posterior trees with pre-clustering step of SNAs. Major
function of Canopy.
</p>


<h3>Usage</h3>

<pre><code class="language-R">    canopy.sample.cluster(R, X, sna_cluster, WM, Wm, epsilonM, epsilonm, C=NULL,
                  Y, K, numchain, max.simrun, min.simrun, writeskip, projectname,
                  cell.line=NULL, plot.likelihood=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>

<p>alternative allele read depth matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>total read depth matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sna_cluster</code></td>
<td>

<p>cluster assignment for each mutation from the EM Binomial clustering
algorithm
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>WM</code></td>
<td>

<p>observed major copy number matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Wm</code></td>
<td>

<p>observed minor copy number matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilonM</code></td>
<td>

<p>observed standard deviation of major copy number (scalar input is
transformed into matrix)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilonm</code></td>
<td>

<p>observed standard deviation of minor copy number (scalar input is
transformed into matrix)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>

<p>CNA and CNA-region overlapping matrix, only needed if overlapping CNAs are
used as input</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>

<p>SNA and CNA-region overlapping matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>

<p>number of subclones (vector)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numchain</code></td>
<td>

<p>number of MCMC chains with random initiations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.simrun</code></td>
<td>

<p>maximum number of simutation iterations for each chain</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.simrun</code></td>
<td>

<p>minimum number of simutation iterations for each chain</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>writeskip</code></td>
<td>

<p>interval to store sampled trees</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>projectname</code></td>
<td>

<p>name of project</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cell.line</code></td>
<td>

<p>default to be FALSE, TRUE if input sample is cell line (no normal cell
contamination)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.likelihood</code></td>
<td>

<p>default to be TRUE, posterior likelihood plot generated for check of
convergence and selection of burnin and thinning in
<code>canopy.post</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>List of sampleed trees in subtree space with different number of subclones;
plot of posterior likelihoods in each subtree space generated (pdf format).</p>


<h3>Author(s)</h3>

<p>Yuchao Jiang <a href="mailto:yuchaoj@wharton.upenn.edu">yuchaoj@wharton.upenn.edu</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">    data(MDA231)
    R = MDA231$R; X = MDA231$X
    WM = MDA231$WM; Wm = MDA231$Wm
    epsilonM = MDA231$epsilonM; epsilonm = MDA231$epsilonm
    C = MDA231$C
    Y = MDA231$Y
    K = 3:6
    numchain = 20
    projectname = 'MDA231'
    # sampchain = canopy.sample.cluster(R = R, X = X, sna_cluster=c(1,2,3,4),
    #             WM = WM, Wm = Wm, epsilonM = epsilonM, 
    #             epsilonm = epsilonm, C = C, Y = Y, K = K, numchain = numchain, 
    #             max.simrun = 50000, min.simrun = 10000, writeskip = 200, 
    #             projectname = projectname, cell.line = TRUE, plot.likelihood = TRUE)
</code></pre>


</div>