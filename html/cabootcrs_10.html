<div class="container">

<table style="width: 100%;"><tr>
<td>covmat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extract a single 2 by 2 covariance matrix</h2>

<h3>Description</h3>

<p><code>covmat</code> extracts a 2 by 2 covariance matrix for one data point on two dimensions,
allowing the confidence ellipse to be plotted
</p>


<h3>Usage</h3>

<pre><code class="language-R">covmat(x, i, thing = "column", axis1 = 1, axis2 = 2, show = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class <code>cabootcrsresults</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>i</code></td>
<td>
<p>The number of the row or column, note that in MCA this will be the number of the variable category
(e.g. for p=3 variables with 5 categories each, column 8 is the 3rd category of the 2nd variable)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thing</code></td>
<td>
<p>Whether to extract the covariance matrix for the i-th
</p>

<dl>
<dt>"row"</dt>
<dd>
<p>row, or</p>
</dd>
<dt>"column"</dt>
<dd>
<p>column</p>
</dd>
</dl>
<p>Note that default is "column" as this is more convenient for MCA</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis1</code></td>
<td>
<p>First axis for which (co)variances are required</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis2</code></td>
<td>
<p>Second axis for which (co)variances are required</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show</code></td>
<td>
<p>If TRUE then print the extracted covariance matrix</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This can be used with the ellipse() package to add the confidence ellipse to a picture from another package<br></p>
<p>Example: confidence ellipse for row or column i on axes 1,2 from cabootcrs() output Results is:<br></p>
<p>lines( ellipse(x=covmat(Results,i,"row",1,2,FALSE),
centre=Results@Rowprinccoord[i,cbind(1,2)], npoints=1000),
cex=1, pch=".", col="blue")<br>
lines( ellipse(x=covmat(Results,i,"column",1,2,FALSE),
centre=Results@Colprinccoord[i,cbind(1,2)], npoints=1000),
cex=1, pch=".", col="blue")
</p>
<p>Note that <code>reflectaxes</code> will be needed if cabootcrs() and ca() axes
are reflected with respect to each other
</p>


<h3>Value</h3>

<p>An object of class <code>"matrix"</code> (square symmetric, 2 by 2)
</p>


<h3>See Also</h3>

<p><code>cabootcrs-package</code>, <code>cabootcrs</code>, <code>allvarscovs</code>,
<code>cabootcrsresults</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">results &lt;- cabootcrs(DreamData, showresults=FALSE)
row2covmataxes12 &lt;- covmat(results,2,"row")
col3covmataxes23 &lt;- covmat(results,3,"column",2,3)

## Not run: 

# There are now 3 variables with 5,4,3 categories, hence 12 columns
resultsmca &lt;- cabootcrs(DreamData223by3, catype="mca", showresults=FALSE)
row2covmataxes12mca &lt;- covmat(resultsmca,2,"column")
col3covmataxes23mca &lt;- covmat(resultsmca,8,"column",2,3)
newvarcat2covmataxes12mca &lt;- covmat(resultsmca,11,"column")


# Use ellipse() to put confidence regions around row points on a plot produced by ca().
# Note that reflectaxes() will be needed if cabootcrs() and ca() axes
# are reflected with respect to each other

library(ca)
library(ellipse)
TheData &lt;- DreamData
Results &lt;- cabootcrs(TheData, showresults=FALSE)
caResults &lt;- ca(TheData)
plot(caResults)
for (i in 1:dim(TheData)[1]) {
  lines( ellipse(x=covmat(Results,i,"row",1,2,FALSE),
                 centre=Results@Rowprinccoord[i,cbind(1,2)], npoints=1000),
        cex=1, pch=".", col="blue")
}

## End(Not run)

</code></pre>


</div>