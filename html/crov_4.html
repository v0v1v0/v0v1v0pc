<div class="container">

<table style="width: 100%;"><tr>
<td>mdcp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Monotonicity Direction Classification (MDC) procedure</h2>

<h3>Description</h3>

<p>Fits a constrained regression model for an ordinal response with ordinal predictors
and possibly others, Espinosa and Hennig (2019) &lt;DOI:10.1007/s11222-018-9842-2&gt;. The parameter estimates associated with an ordinal
predictor are constrained to be monotonic. If a monotonicity direction (isotonic or antitonic) is
not specified for an ordinal predictor (OP) by the user, then a constrained method to be indicated in the option <code>method</code> establishes it or the
approach that tries all possible combinations of monotonicity directions an the chooses the one with maximum likelihood.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mdcp(
  formula,
  data = NULL,
  tryAllMonoDir = FALSE,
  monoDir = NULL,
  CLS1 = 0.95,
  TLBS2 = 0.85,
  TLNS2 = 0.999,
  StepSizeCLS2 = 1e-04,
  method = NULL,
  monoTestSignLevel = 0.05,
  reltol = 1e-05,
  mu = 1e-04,
  outer.eps = 1e-05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A <code>formula</code> to be fitted with ordinal response, one or more ordinal predictors, and possibly one or more other predictors.
For ordinal response and ordinal predictors use ordered factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data.frame, list or environment (or object coercible by <code>as.data.frame</code> to a data.frame), containing the
variables in <code>formula</code>. Neither a matrix nor an array will be accepted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tryAllMonoDir</code></td>
<td>
<p>A logical value that indicates whether one model should be fitted for each one of the possible combinations of monotonicity
directions of the ordinal predictors' effects. Use <code>TRUE</code> if no constrained method is used in <code>method</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>monoDir</code></td>
<td>
<p>Vector with monotonicity directions for the ordinal predictors to be used as constraints. Possible values for <code>monoDir</code> are
<code>1</code>, <code>0</code> and <code>-1</code>. Use <code>1</code> for "isotonic" and <code>-1</code> for "antitonic". If the monotonicity direction of the prameters of an ordinal
predictor has to be estimated, then use <code>0</code>, which also allows to drop the monotonicity
assumption when <code>method</code> is not "MDCS3".
The order of the elements in <code>monoDir</code> must be the same as the order of the ordinal predictors in the object <code>formula</code>, i.e., the j-th element of <code>monoDir</code> must correspond to
the monotonicity direction of the j-th ordinal predictor in <code>formula</code>. For example,
<code>monoDir=c(0,-1,-1,1,0)</code> indicates that the monotonicity direction of the effects of
the first OP will be estimated; the monotonicity direction of the effects of the second and third OPs are antitonic;
the monotonicity direction of the effects of the fourth OP isotonic; and the monotonicity direction
of the effects of the fifth OP will also be estimated. If <code>tryAllMonoDir</code> and <code>monoDir</code> are not used (default option),
the monotonicity direction classification prodecure is executed on all of the ordinal predictors to find the monotonicity directions associated to the
model with the maximum log-likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CLS1</code></td>
<td>
<p>Numerical value for the confidence level to be used in the first step of the MDC procedure. This parameter is active if
<code>tryAllMonoDir</code> is not used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TLBS2</code></td>
<td>
<p>Numerical value for the tolerance level to be used in the second step of the MDC procedure over those ordinal
predictors classified as "Both" in the first step. This parameter is active if <code>tryAllMonoDir</code> and <code>monoDir</code> are not used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TLNS2</code></td>
<td>
<p>Numerical value for the tolerance level to be used in the second step of the MDC procedure over those ordinal
predictors classified as "None" in the first step. This parameter is active if <code>tryAllMonoDir</code> and <code>monoDir</code> are not used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>StepSizeCLS2</code></td>
<td>
<p>Numerical value for the magnitude in which the confidence levels will be increased or decreased during the second step of
the MDC procedure. This parameter is active if <code>tryAllMonoDir</code> and <code>monoDir</code> are not used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The type of constrained method to be used among <code>"MDCS1"</code>, <code>"MDCS2"</code>, <code>"MDCS3"</code>,
<code>"CMLEbonferroni"</code>, <code>"CMLEconfReg"</code>, and <code>"CMLEfiltered"</code>. Default value is <code>"MDCS3"</code>.
<code>"MDCS1"</code> uses the first step of the MDC procedure described in Espinosa, J. and Christian H. (2019)
to drop the monotonicity constraints on those ordinal predictors (OPs) classified as "both" or "none".
<code>"MDCS2"</code> uses the second step of the MDC procedure described in Espinosa, J. and Christian H. (2019)
to drop the monotonicity constraints on those OPs classified as "both" or "none".
<code>"MDCS3"</code> performs the three steps of the MDC procedure described in Espinosa, J. and Christian H. (2019)
and does not drop monotonicity constraints on the OPs, being the most restrictive method.
<code>"CMLEbonferroni"</code> tests the null hypothesis of monotonic effects for an OP as described in Espinosa, J. and Christian H. (2019)
and drops the monotonicity constraints on those OPs for which the monotonicity test rejects the null hypothesis.
<code>"CMLEconfReg"</code> tests the null hypothesis of monotonic effects for an OP based on the analysis of confidence regions
and drops the monotonicity constraints on those OPs for which the monotonicity test rejects the null hypothesis.
<code>"CMLEfiltered"</code> uses the first step of the MDC procedure described in Espinosa, J. and Christian H. (2019)
to drop the monotonicity constraints on those ordinal predictors (OPs) classified as "none".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>monoTestSignLevel</code></td>
<td>
<p>Significance level used when <code>method</code> is <code>"CMLEbonferroni"</code> or <code>"CMLEconfReg"</code>. Default value 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reltol</code></td>
<td>
<p>Passed to <code>constrOptim()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>Passed to <code>constrOptim()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outer.eps</code></td>
<td>
<p>Passed to <code>constrOptim()</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>MDCproc</code>: Data frame with the monotonicity direction classification (Isotonic, Antitonic, Both, or None) used for each
ordinal predictor in each one of the steps of the MDC procedure (S1, S2 and S3), together with their individual confidence levels (CL). If
<code>monoDir</code> is used, <code>MDCproc</code> shows the monotonicity directions in <code>monoDir</code>.
</p>
<p><code>estimates</code>: Vector of parameter estimates of the model.
</p>
<p><code>log.lik</code>: Value of the log-likelihood of the model.
</p>
<p><code>allModels</code>: Data frame with monotonicity directions, log-likelihood and parameter estimates of all models involved in the third step of the MDC
procedure. If parameter <code>monoDir</code> is used, <code>allModels</code> shows these results from the model with monotonicity directions
used in <code>monoDir</code> only. If parameter <code>tryAllMonoDir</code> is used, <code>allModels</code> shows these results from all the models according to all possible
combinations of monotonicity directions.
</p>
<p><code>constrOptimRes</code>: List with the outcomes provided by the function <code>constrOptim</code>.
</p>
<p><code>UMLE</code>: Vector with the parameter estimates of the unconstrained version of the model.
</p>
<p><code>UMLE_SE</code>: Vector with the standard errors of the unconstrained version of the model.
</p>
<p><code>q_cat_OrdPred</code>: Vector with the number of ordinal categories for each ordinal predictor. Values are displayed in the same order as the ordinal predictors are incorporated in <code>formula</code>.
</p>


<h3>References</h3>

<p>Espinosa, J., and Hennig, C. "A constrained regression model for an ordinal response
with ordinal predictors." Statistics and Computing 29.5 (2019): 869-890.
https://doi.org/10.1007/s11222-018-9842-2.
</p>


<h3>See Also</h3>

<p><code>monoTestBonf</code>,
<code>monoTestConfReg</code>,
<code>confRegUCRandUCCR</code>,
<code>confRegCCR</code>,
<code>plotCMLE</code>,
<code>constrOptim</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Ordinal predictors: EduLevel, IncQuint and Health,
mdcpExample &lt;- mdcp(QoL ~ EduLevel + Age + IncQuint + Gender + Health, data = crovData,
CLS1 = 0.95, TLBS2 = 0.90, TLNS2 = 0.99, StepSizeCLS2 = 0.0002)
mdcpExample$MDCproc
cbind("CMLE"=mdcpExample$estimates,"UMLE"=mdcpExample$UMLE)
mdcpExample$UMLE_SE
mdcpExample$log.lik
mdcpExample$allModels[1:6]
</code></pre>


</div>