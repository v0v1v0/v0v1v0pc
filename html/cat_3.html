<div class="container">

<table style="width: 100%;"><tr>
<td>bipf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Bayesian Iterative Proportional Fitting (BIPF)
</h2>

<h3>Description</h3>

<p>Markov-Chain Monte Carlo method for simulating posterior draws of cell
probabilities under a hierarchical loglinear model
</p>


<h3>Usage</h3>

<pre><code class="language-R">bipf(table,margins, prior=0.5, start, steps=1, showits=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>table </code></td>
<td>

<p>contingency table (array) to be fitted by a log-linear model. All
elements must be non-negative.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>margins </code></td>
<td>

<p>vector describing the marginal totals to be fitted. A margin
is described by the factors not summed over, and margins are separated
by zeros.  Thus c(1,2,0,2,3,0,1,3) would indicate fitting the (1,2),
(2,3), and (1,3) margins in a three-way table, i.e., the model of no
three-way association.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior </code></td>
<td>

<p>optional array of hyperparameters specifying a Dirichlet
prior distribution. The default is the Jeffreys prior (all
hyperparameters = .5). If structural zeros appear in <code>table</code>, a prior
should be supplied with hyperparameters set to <code>NA</code> for those cells.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start </code></td>
<td>

<p>starting value for the algorithm. The default is a uniform table.  If
structural zeros appear in <code>table</code>, <code>start</code> should contain zeros in
those cells and ones elsewhere.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>steps </code></td>
<td>

<p>number of cycles of Bayesian IPF to be performed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showits</code></td>
<td>

<p>if <code>TRUE</code>, reports the iterations so the user can monitor the progress
of the algorithm.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>array like <code>table</code>, but containing simulated cell probabilities that
satisfy the loglinear model. If the algorithm has converged, this will
be a draw from the actual posterior distribution of the parameters.
</p>


<h3>Note</h3>

<p>The random number generator seed must be set at least once by the
function <code>rngseed</code> before this function can be used.
</p>
<p>The starting value must lie in the interior of the parameter space.
Hence, caution should be used when using a maximum likelihood 
estimate (e.g., from <code>ipf</code>) as a starting value. Random zeros in a 
table may produce mle's with expected cell counts of zero, and any 
zero in a starting value is interpreted by <code>bipf</code> as a structural 
zero. This difficulty can be overcome by using as a starting value
calculated by <code>ipf</code> after adding a small positive constant (e.g.,
1/2) to each cell.
</p>


<h3>References</h3>

<p>Schafer (1996) <em>Analysis of Incomplete Multivariate Data.</em>
Chapman &amp; Hall,  Chapter 8.
</p>


<h3>See Also</h3>

<p><code>ipf</code> and <code>rngseed</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(HairEyeColor)                     # load data
m=c(1,2,0,1,3,0,2,3)                   # no three-way interaction
thetahat &lt;- ipf(HairEyeColor,margins=m,
            showits=TRUE)              # fit model
thetahat &lt;- ipf(HairEyeColor+.5,m)     # find an interior starting value 
rngseed(1234567)                       # set random generator seed
theta &lt;- bipf(HairEyeColor,m,
              start=thetahat,prior=0.5,
              steps=50)                # take 50 steps
</code></pre>


</div>