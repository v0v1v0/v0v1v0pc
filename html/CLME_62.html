<div class="container">

<table style="width: 100%;"><tr>
<td>w.stat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Williams' Type Test Statistic.</h2>

<h3>Description</h3>

<p>Calculates a Williams' type test statistic for a constrained linear mixed effects model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">w.stat(theta, cov.theta, B, A, ...)

w.stat.ind(theta, cov.theta, B, A, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>estimated coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov.theta</code></td>
<td>
<p>covariance matrix of the (unconstrained) coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>matrix to obtain the global contrast.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>matrix of linear constraints.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments, to enable custom test statistic functions.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See <code>create.constraints</code> for an example of <code>A</code>. Argument <code>B</code> is similar, but defines the global contrast for a Williams' type test statistic. This is the largest hypothesized difference in the constrained coefficients. So for an increasing simple order, the test statistic is the difference between the two extreme coefficients, <code class="reqn">\theta_1</code> and <code class="reqn">\theta_{p_1}</code>, divided by the standard error (unconstrained). For an umbrella order order, two contrasts are considered, <code class="reqn">\theta_1</code> to <code class="reqn">\theta_{s}</code>, and <code class="reqn">\theta_{p_1}</code> to <code class="reqn">\theta_{s}</code>, each divided by the appropriate unconstrained standard error. A general way to express this statistic is:
</p>
<p style="text-align: center;"><code class="reqn">W = max \theta_{B[i,2]} - \theta_{B[i,1]} / sqrt( VAR( \theta_{B[i,2]} - \theta_{B[i,1]} ) )</code>
</p>

<p>where the numerator is the difference in the constrained estimates, and the standard error in the denominator is based on the covariance matrix of the unconstrained estimates.
</p>
<p>The function <code>w.stat.ind</code> does the same, but uses the <code>A</code> matrix which defines all of the individual constraints, and returns a test statistic for each constraints instead of taking the maximum.
</p>


<h3>Value</h3>

<p>Output is a numeric value.
</p>


<h3>Note</h3>

<p>See <code>lrt.stat</code> for information on creating custom test statistics.
</p>


<h3>Examples</h3>

<pre><code class="language-R">theta  &lt;- exp(1:4/4)
th.cov &lt;- diag(4)
X1     &lt;- matrix( 0 , nrow=1 , ncol=4 )
const  &lt;- create.constraints( P1=4 , constraints=list(order='simple' ,
                                                    decreasing=FALSE) )

w.stat( theta , th.cov , const$B , const$A )

w.stat.ind( theta , th.cov , const$B , const$A )

</code></pre>


</div>