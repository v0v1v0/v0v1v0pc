<div class="container">

<table style="width: 100%;"><tr>
<td>find_same_col</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Find column with same non-positive values</h2>

<h3>Description</h3>

<p>The inverse matrix of a contrast matrix has a useful property
where, after removing the row corresponding to the intercept,
the reference level is the column index where each value in
that column is (1) the same and (2) less than or equal to 0.
</p>


<h3>Usage</h3>

<pre><code class="language-R">find_same_col(invmatrix)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>invmatrix</code></td>
<td>
<p>Inverse of the hypothesis matrix</p>
</td>
</tr></table>
<h3>Details</h3>

<p>For a contrast matrix generated from an expression <code>x</code>, with
number of levels n, consider the inverse matrices from
<code>solve(.contrasts_to_hypotheses(x))</code> below for different <code>x</code>:
</p>

<ul>
<li>
<p> contr.treatment: The first column contains all 0s, hence
the reference level is the first level
</p>
</li>
<li>
<p> contr.SAS: The last column contains all 0s, hence the
reference level is the last level
</p>
</li>
<li>
<p> scaled_sum_code: The first column contains all -1/n, hence
the reference level is the first level
</p>
</li>
<li>
<p> helmert_code: While the first column contains all negative
numbers, they are not the same EXCEPT if n=2
</p>
</li>
</ul>
<p>Note that "reference level" here is defined as a level from
which every other level is compared to via pairwise comparisons.
</p>


<h3>Value</h3>

<p>Integer index of the reference level, if there is
no reference level, NA is returned
</p>


</div>