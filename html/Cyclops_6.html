<div class="container">

<table style="width: 100%;"><tr>
<td>convertToCyclopsData</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Convert data from two data frames or ffdf objects into a CyclopsData object</h2>

<h3>Description</h3>

<p><code>convertToCyclopsData</code> loads data from two data frames or ffdf objects, and inserts it into a Cyclops data object.
</p>


<h3>Usage</h3>

<pre><code class="language-R">convertToCyclopsData(
  outcomes,
  covariates,
  modelType = "lr",
  timeEffectMap = NULL,
  addIntercept = TRUE,
  checkSorting = NULL,
  checkRowIds = TRUE,
  normalize = NULL,
  quiet = FALSE,
  floatingPoint = 64
)

## S3 method for class 'data.frame'
convertToCyclopsData(
  outcomes,
  covariates,
  modelType = "lr",
  timeEffectMap = NULL,
  addIntercept = TRUE,
  checkSorting = NULL,
  checkRowIds = TRUE,
  normalize = NULL,
  quiet = FALSE,
  floatingPoint = 64
)

## S3 method for class 'tbl_dbi'
convertToCyclopsData(
  outcomes,
  covariates,
  modelType = "lr",
  timeEffectMap = NULL,
  addIntercept = TRUE,
  checkSorting = NULL,
  checkRowIds = TRUE,
  normalize = NULL,
  quiet = FALSE,
  floatingPoint = 64
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>outcomes</code></td>
<td>
<p>A data frame or ffdf object containing the outcomes with predefined columns (see below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariates</code></td>
<td>
<p>A data frame or ffdf object containing the covariates with predefined columns (see below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modelType</code></td>
<td>
<p>Cyclops model type. Current supported types are "pr", "cpr", lr", "clr", or "cox"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timeEffectMap</code></td>
<td>
<p>A data frame or ffdf object containing the convariates that have time-varying effects on the outcome</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>addIntercept</code></td>
<td>
<p>Add an intercept to the model?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>checkSorting</code></td>
<td>
<p>(DEPRECATED) Check if the data are sorted appropriately, and if not, sort.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>checkRowIds</code></td>
<td>
<p>Check if all rowIds in the covariates appear in the outcomes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalize</code></td>
<td>
<p>String: Name of normalization for all non-indicator covariates (possible values: stdev, max, median)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>
<p>If true, (warning) messages are suppressed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>floatingPoint</code></td>
<td>
<p>Specified floating-point representation size (32 or 64)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>These columns are expected in the outcome object:
</p>

<table>
<tr>
<td style="text-align: left;">
<code style="white-space: pre;">⁠stratumId⁠</code>    </td>
<td style="text-align: left;">(integer) </td>
<td style="text-align: left;"> (optional) Stratum ID for conditional regression models </td>
</tr>
<tr>
<td style="text-align: left;">
<code style="white-space: pre;">⁠rowId⁠</code>  	</td>
<td style="text-align: left;">(integer) </td>
<td style="text-align: left;"> Row ID is used to link multiple covariates (x) to a single outcome (y) </td>
</tr>
<tr>
<td style="text-align: left;">
<code style="white-space: pre;">⁠y⁠</code>    </td>
<td style="text-align: left;">(real) </td>
<td style="text-align: left;"> The outcome variable </td>
</tr>
<tr>
<td style="text-align: left;">
<code style="white-space: pre;">⁠time⁠</code>    </td>
<td style="text-align: left;">(real) </td>
<td style="text-align: left;"> For models that use time (e.g. Poisson or Cox regression) this contains time </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: left;">        </td>
<td style="text-align: left;">(e.g. number of days) </td>
</tr>
<tr>
<td style="text-align: left;">
<code style="white-space: pre;">⁠weights⁠</code> </td>
<td style="text-align: left;">(real) </td>
<td style="text-align: left;"> (optional) Non-negative weights to apply to outcome </td>
</tr>
<tr>
<td style="text-align: left;">
<code style="white-space: pre;">⁠censorWeights⁠</code> </td>
<td style="text-align: left;">(real) </td>
<td style="text-align: left;"> (optional) Non-negative censoring weights for competing risk model; will be computed if not provided.
</td>
</tr>
</table>
<p>These columns are expected in the covariates object:
</p>

<table>
<tr>
<td style="text-align: left;">
<code style="white-space: pre;">⁠stratumId⁠</code>    </td>
<td style="text-align: left;">(integer) </td>
<td style="text-align: left;"> (optional) Stratum ID for conditional regression models </td>
</tr>
<tr>
<td style="text-align: left;">
<code style="white-space: pre;">⁠rowId⁠</code>  	</td>
<td style="text-align: left;">(integer) </td>
<td style="text-align: left;"> Row ID is used to link multiple covariates (x) to a single outcome (y) </td>
</tr>
<tr>
<td style="text-align: left;">
<code style="white-space: pre;">⁠covariateId⁠</code>    </td>
<td style="text-align: left;">(integer) </td>
<td style="text-align: left;"> A numeric identifier of a covariate  </td>
</tr>
<tr>
<td style="text-align: left;">
<code style="white-space: pre;">⁠covariateValue⁠</code>    </td>
<td style="text-align: left;">(real) </td>
<td style="text-align: left;"> The value of the specified covariate </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>These columns are expected in the timeEffectMap object:
</p>

<table>
<tr>
<td style="text-align: left;">
<code style="white-space: pre;">⁠covariateId⁠</code>    </td>
<td style="text-align: left;">(integer) </td>
<td style="text-align: left;"> A numeric identifier of the covariates that have time-varying effects on the outcome </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of type cyclopsData
</p>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>convertToCyclopsData(data.frame)</code>: Convert data from two <code>data.frame</code>
</p>
</li>
<li> <p><code>convertToCyclopsData(tbl_dbi)</code>: Convert data from two <code>Andromeda</code> tables
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">#Convert infert dataset to Cyclops format:
covariates &lt;- data.frame(stratumId = rep(infert$stratum, 2),
                         rowId = rep(1:nrow(infert), 2),
                         covariateId = rep(1:2, each = nrow(infert)),
                         covariateValue = c(infert$spontaneous, infert$induced))
outcomes &lt;- data.frame(stratumId = infert$stratum,
                       rowId = 1:nrow(infert),
                       y = infert$case)
#Make sparse:
covariates &lt;- covariates[covariates$covariateValue != 0, ]

#Create Cyclops data object:
cyclopsData &lt;- convertToCyclopsData(outcomes, covariates, modelType = "clr",
                                    addIntercept = FALSE)

#Fit model:
fit &lt;- fitCyclopsModel(cyclopsData, prior = createPrior("none"))

</code></pre>


</div>