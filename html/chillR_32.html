<div class="container">

<table style="width: 100%;"><tr>
<td>filter_temperatures</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Quality filter for temperature records</h2>

<h3>Description</h3>

<p>This function attempts to remove erroneous temperature readings. This is
tricky because of the wide range of errors that can occur, so this isn't
necessarily sufficient for problems of particular records.
</p>


<h3>Usage</h3>

<pre><code class="language-R">filter_temperatures(
  temp_file,
  remove_value = NA,
  running_mean_filter = NA,
  running_mean_length = 3,
  min_extreme = NA,
  max_extreme = NA,
  max_missing_in_window = 1,
  missing_window_size = 9
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>temp_file</code></td>
<td>
<p>file containing temperature data. Should have columns
c("Year","Month","Day","Temp" - and "Hour" for hourly data).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remove_value</code></td>
<td>
<p>numeric value indicating 'no data'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>running_mean_filter</code></td>
<td>
<p>deviation from a running mean over all temperature
data that identifies a value as an erroneous outlier.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>running_mean_length</code></td>
<td>
<p>number of records to be included in a running mean.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_extreme</code></td>
<td>
<p>lowest plausible temperature on the record. All lower ones are removed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_extreme</code></td>
<td>
<p>highest plausible temperature on the record. All higher ones are removed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_missing_in_window</code></td>
<td>
<p>maximum share of values (0..1) in a running window of size
missing_window_size around each value that can be missing. If this is exceeded, the value
is removed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>missing_window_size</code></td>
<td>
<p>size of the window used for checking for missing values.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>filtered temperature dataset, from which records identified as erroneous were removed.
</p>


<h3>Author(s)</h3>

<p>Eike Luedeling
</p>


<h3>Examples</h3>

<pre><code class="language-R">

weather&lt;-fix_weather(KA_weather[which(KA_weather$Year&gt;2009),])

hourtemps&lt;-stack_hourly_temps(weather, latitude=50.4)

filtered&lt;-filter_temperatures(hourtemps$hourtemps,remove_value=-99,
  running_mean_filter=3)

</code></pre>


</div>