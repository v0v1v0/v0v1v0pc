<div class="container">

<table style="width: 100%;"><tr>
<td>malware_hash</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Retrieves malware hash metadata from the Malware Hash Registry</h2>

<h3>Description</h3>

<p>The Malware Hash Registry (MHR) project is a look-up service similar to the
Team Cymru IP address to ASN mapping project. This project differs however,
in that you can query the service for a computed MD5 or SHA-1 hash of a file
and, if it is malware and the service knows about it, it returns the last
time it's seen it along with an approximate anti-virus detection percentage.
</p>


<h3>Usage</h3>

<pre><code class="language-R">malware_hash(hashes, timeout = getOption("timeout"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>hashes</code></td>
<td>
<p>vector of IPv4 address (character - dotted-decimal)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timeout</code></td>
<td>
<p>numeric: the timeout (in seconds) to be used for this connection.
Beware that some OSes may treat very large values as zero: however the
POSIX standard requires values up to 31 days to be supported.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>data frame of BGP Origin ASN lookup results
</p>

<ul>
<li> <p><code>sha1_md5</code> - hash queried for
</p>
</li>
<li> <p><code>last_known_timestamp</code> - last known GMT timestamp associated with that hash
</p>
</li>
<li> <p><code>detection_pct</code> - detection percentage across a mix of AV packages
</p>
</li>
</ul>
<p>If a socket connection cannot be made (i.e. a network problem on your
end or a service/network problem on their end), all columns will be
<code>NA</code>.
</p>


<h3>Note</h3>

<p>Attempting to enumerate the malware registry via the public service
interface is not only impractical, it is also strictly prohibited.
Contact Team Cymru if the public interface is insufficient for your
needs and we may be able to come up with alternative arrangement. Also,
A direct connection to TCP Port 43 (WHOIS) is required for most of these
API functions to work properly.
</p>


<h3>See Also</h3>

<p><a href="http://www.team-cymru.org/IP-ASN-mapping.html">http://www.team-cymru.org/IP-ASN-mapping.html</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
malware_hash(c("1250ac278944a0737707cf40a0fbecd4b5a17c9d",
               "7697561ccbbdd1661c25c86762117613",
               "cbed16069043a0bf3c92fff9a99cccdc",
               "e6dc4f4d5061299bc5e76f5cd8d16610",
               "e1112134b6dcc8bed54e0e34d8ac272795e73d74"))

## End(Not run)
</code></pre>


</div>