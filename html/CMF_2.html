<div class="container">

<table style="width: 100%;"><tr>
<td>CMF</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Collective Matrix Factorization</h2>

<h3>Description</h3>

<p>Learns the CMF model for a given collection of M matrices.
The code learns the parameters of a variational approximation for CMF,
and also computes predictions for indices specified in <code>test</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CMF(X, inds, K, likelihood, D, test = NULL, opts = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>List of input matrices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inds</code></td>
<td>
<p>A <code>length(X)</code> times 2 matrix that links dimensions of the
matrices in <code>X</code> to object sets. <code>inds[m, 1]</code> tells which
object set corresponds to the rows in matrix <code>X[[m]]</code>,
and <code>inds[m, 2]</code> tells the same for the columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>The number of factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>likelihood</code></td>
<td>
<p>A list of likelihood choices, one for each matrix in X.
Each entry should be a string with possible values of:
"gaussian", "bernoulli" or "poisson".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>A vector containing sizes of each object set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>A list of test matrices. If not NULL, the code will compute
predictions for these elements of the matrices. This duplicates
the functionality of <code>predictCMF()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opts</code></td>
<td>
<p>A list of options as given by <code>getCMFopts()</code>.
If set to <code>NULL</code>, the default values will be used.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The variational approximation is fully factorized over all of the model
parameters, including individual elements of the projection matrices.
The parameters for the projection matrices are updated jointly by
Newton-Raphson method, whereas the rest use closed-form updates.
</p>
<p>Note that the input data needs to be given in a specific sparse format.
See <code>matrix_to_triplets()</code> for details.
</p>
<p>The behavior of the algorithm can be modified via the <code>opts</code> parameter.
See <code>getCMFopts()</code> for details. Of particular interest are the elements
<code>useBias</code> and <code>method</code>.
</p>
<p>For full description of the output parameters, see the referred publication.
The notation in the code follows roughly the notation used in the paper.
</p>


<h3>Value</h3>

<p>A list of
</p>
<table>
<tr style="vertical-align: top;">
<td><code>U</code></td>
<td>
<p>A list of the mean parameters for the rank-K projection matrices,
one for each object set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covU</code></td>
<td>
<p>A list of the variance parameters for the rank-K projection
matrices, one for each object set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>A vector of the precision parameter means.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>A vector of the ARD parameter means.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cost</code></td>
<td>
<p>A vector of variational lower bound values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inds</code></td>
<td>
<p>The input parameter <code>inds</code> stored for further use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>errors</code></td>
<td>
<p>A vector containing root-mean-square errors for each
iteration, computed over the elements indicated by the
<code>test</code> parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bias</code></td>
<td>
<p>A list (of lists) storing the parameters of the row and
column bias terms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>The sizes of the object sets as given in the parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>The number of components as given in the parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Uall</code></td>
<td>
<p>Matrices of U joined into one sum(D) by K matrix, for
easier plotting of the results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>items</code></td>
<td>
<p>A list containing the running number for each item among
all object sets. This corresponds to rows of the <code>Uall</code>
matrix. Each part of the list contains a vector that has the
numbers for each particular object set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out</code></td>
<td>
<p>If test matrices were provided, returns the reconstructed data
sets. Otherwise returns <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>The number of input matrices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>likelihood</code></td>
<td>
<p>The likelihoods of the matrices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opts</code></td>
<td>
<p>The options used for running the code.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Arto Klami and Lauri VÃ¤re
</p>


<h3>References</h3>

<p>Arto Klami, Guillaume Bouchard, and Abhishek Tripathi.
Group-sparse embeddings in collective matrix factorization.
arXiv:1312.5921, 2014.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># See CMF-package for an example.

</code></pre>


</div>