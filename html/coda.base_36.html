<div class="container">

<table style="width: 100%;"><tr>
<td>pb_basis</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Isometric log-ratio basis based on Principal Balances.</h2>

<h3>Description</h3>

<p>Exact method to calculate the principal balances of a compositional dataset. Different methods to approximate the principal balances of a compositional dataset are also included.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pb_basis(
  X,
  method,
  constrained.complete_up = FALSE,
  cluster.method = "ward.D2",
  ordering = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>compositional dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>method to be used with Principal Balances. Methods available are: 'exact', 'constrained' or 'cluster'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constrained.complete_up</code></td>
<td>
<p>When searching up, should the algorithm try to find possible siblings for the current balance (TRUE) or build a parent directly forcing current balance to be part of the next balance (default: FALSE). While the first is more exhaustive and given better results the second is faster and can be used with highe dimensional datasets.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster.method</code></td>
<td>
<p>Method to be used with the hclust function (default: 'ward.D2') or any other method available in  hclust function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ordering</code></td>
<td>
<p>should the principal balances found be returned ordered? (first column, first
principal balance and so on)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>parameters passed to hclust function</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>matrix
</p>


<h3>References</h3>

<p>Martín-Fernández, J.A., Pawlowsky-Glahn, V., Egozcue, J.J., Tolosana-Delgado R. (2018).
Advances in Principal Balances for Compositional Data.
<em>Mathematical Geosciencies</em>, 50, 273-298.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)
X = matrix(exp(rnorm(5*100)), nrow=100, ncol=5)

# Optimal variance obtained with Principal components
(v1 &lt;- apply(coordinates(X, 'pc'), 2, var))
# Optimal variance obtained with Principal balances
(v2 &lt;- apply(coordinates(X,pb_basis(X, method='exact')), 2, var))
# Solution obtained using constrained method
(v3 &lt;- apply(coordinates(X,pb_basis(X, method='constrained')), 2, var))
# Solution obtained using Ward method
(v4 &lt;- apply(coordinates(X,pb_basis(X, method='cluster')), 2, var))

# Plotting the variances
barplot(rbind(v1,v2,v3,v4), beside = TRUE, ylim = c(0,2),
        legend = c('Principal Components','PB (Exact method)',
                   'PB (Constrained)','PB (Ward approximation)'),
        names = paste0('Comp.', 1:4), args.legend = list(cex = 0.8), ylab = 'Variance')

</code></pre>


</div>