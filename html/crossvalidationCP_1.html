<div class="container">

<table style="width: 100%;"><tr>
<td>crossvalidationCP-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cross-validation for change-point regression</h2>

<h3>Description</h3>

<p>Implements the cross-validation methodology from <cite>Pein and Shah (2021)</cite>. The approach can be customised by providing cross-validation criteria, estimators for the change-point locations and local parameters, and freely chosen folds. Pre-implemented estimators and criteria are available. It also includes our own implementation of the <abbr><span class="acronym">COPPS</span></abbr> procedure <cite>Zou et al. (2020)</cite>. By default, 5-fold cross-validation with ordered folds, absolute error loss, and least squares estimation for estimating the change-point locations is used.
</p>


<h3>Details</h3>

<p>The main function is <code>crossvalidationCP</code>. It selects among a list of parameters the one with the smallest cross-validation criterion for a given method. The user can freely choose the folds, the local estimator and the criterion. Several pre-implemented estimators and criteria are available. Estimators have to allow a list of parameters at the same time. One can use <code>convertSingleParam</code> to convert a function allowing only a single parameter to a function that allows a list of parameters.
</p>
<p>A ssimpler, but more limited access is given by the functions <code>VfoldCV</code>, <code>COPPS</code>, <code>CV1</code> and <code>CVmod</code>. <code>VfoldCV</code> performs V-fold cross-validation, where the tuning parameter is directly the number of change-points. <code>COPPS</code> implements the <abbr><span class="acronym">COPPS</span></abbr> procedure <cite>Zou et al. (2020)</cite>, i.e. 2-fold cross-validation with Order-Preserved Sample-Splitting and the tuning parameter being again the number of change-points. <code>CV1</code> and <code>CVmod</code> do the same, but with absolute error loss and the modified quadratic error loss, see (15) and (16) in <cite>Pein and Shah (2021)</cite>, instead of quadratic error loss.
</p>
<p>Note that <code>COPPS</code> can be problematic when larger changes occur at odd locations. For a detailed discussion, why standard quadratic error loss can lead to misestimation, see Section 2 in <cite>Pein and Shah (2021)</cite>. By default, we recommend to use absolute error loss and 5-fold cross-validation as offered by <code>VfoldCV</code>.
</p>
<p>So far only univariate data is supported, but support for multivariate data is planned.</p>


<h3>References</h3>

<p>Pein, F., and Shah, R. D. (2021) Cross-validation for change-point regression: pitfalls and solutions. <em>arXiv:2112.03220</em>.
</p>
<p>Zou, C., Wang, G., and Li, R. (2020) Consistent selection of the number of change-points via sample-splitting. <em>The Annals of Statistics</em>, <b>48</b>(1), 413â€“439.
</p>


<h3>See Also</h3>

<p><code>crossvalidationCP</code>, estimators, criteria, <code>convertSingleParam</code>, <code>VfoldCV</code>, <code>COPPS</code>, <code>CV1</code>, <code>CVmod</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># call with default parameters:
# 5-fold cross-validation with absolute error loss, least squares estimation,
# and possible parameters being 0 to 5 change-points
Y &lt;- rnorm(100)
(ret &lt;- crossvalidationCP(Y = Y))
# a simpler, but more limited access to it is offered by VfoldCV()
identical(VfoldCV(Y = Y), ret)

# more interesting data and more detailed output
set.seed(1L)
Y &lt;- c(rnorm(50), rnorm(50, 5), rnorm(50), rnorm(50, 5))
VfoldCV(Y = Y, output = "detailed")
# finds the correct change-points at 50, 100, 150
# (plus the start and end points 0 and 200)

# reducing the maximal number of change-points to 2
VfoldCV(Y = Y, Kmax = 2)

# crossvalidationCP is more flexible and allows a list of parameters
# here only 1 or 2 change-points are allowed
crossvalidationCP(Y = Y, param = as.list(1:2))

# reducing the number of folds to 3
ret &lt;- VfoldCV(Y = Y, V = 3L, output = "detailed")
# the same but with explicitly specified folds
identical(crossvalidationCP(Y = Y, folds = list(seq(1, 200, 3), seq(2, 200, 3), seq(3, 200, 3)),
                            output = "detailed"), ret)
                            
# 2-fold cross-validation with Order-Preserved Sample-Splitting
ret &lt;- crossvalidationCP(Y = Y, folds = "COPPS", output = "detailed")

# a simpler access to it is offered by CV1()
identical(CV1(Y = Y, output = "detailed"), ret)

# different criterion: quadratic error loss
ret &lt;- crossvalidationCP(Y = Y, folds = "COPPS", output = "detailed", criterion = criterionL2loss)

# same as COPPS procedure; as offered by COPPS()
identical(COPPS(Y = Y, output = "detailed"), ret)

# COPPS potentially fails to provide a good selection when large changes occur at odd locations
# Example 1 in (Pein and Shah, 2021), see Section 2.2 in this paper for more details
set.seed(1)
exampleY &lt;- rnorm(102, c(rep(10, 46), rep(0, 5), rep(30, 51)))
# misses one change-point
crossvalidationCP(Y = exampleY, folds = "COPPS", criterion = criterionL2loss) 

# correct number of change-points when modified criterion (or absolute error loss) is used
(ret &lt;- crossvalidationCP(Y = exampleY, folds = "COPPS", criterion = criterionMod)) 

# a simpler access to it is offered by CVmod() 
identical(CVmod(Y = exampleY), ret)

# manually given criterion; identical to criterionL1loss()
testCriterion &lt;- function(testset, estset, value = NULL, ...) {
  if (!is.null(value)) {
    return(sum(abs(testset - value)))
  }
  
  sum(abs(testset - mean(estset)))
}
identical(crossvalidationCP(Y = Y, criterion = testCriterion, output = "detailed"),
          crossvalidationCP(Y = Y, output = "detailed"))

# PELT as a local estimator instead of least squares estimation
# param must contain parameters that are acceptable for the given estimator
crossvalidationCP(Y = Y, estimator = pelt, output = "detailed",
                  param = list("SIC", "MBIC", 3 * log(length(Y))))

# argument minseglen of pelt specified in ...
crossvalidationCP(Y = Y, estimator = pelt, output = "detailed",
                  param = list("SIC", "MBIC", 3 * log(length(Y))), minseglen = 60)
</code></pre>


</div>