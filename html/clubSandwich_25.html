<div class="container">

<table style="width: 100%;"><tr>
<td>vcovCR.plm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cluster-robust variance-covariance matrix for a plm object.</h2>

<h3>Description</h3>

<p><code>vcovCR</code> returns a sandwich estimate of the variance-covariance matrix
of a set of regression coefficient estimates from a <code>plm</code>
object.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'plm'
vcovCR(
  obj,
  cluster,
  type,
  target,
  inverse_var,
  form = "sandwich",
  ignore_FE = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>Fitted model for which to calculate the variance-covariance matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>Optional character string, expression, or vector indicating
which observations belong to the same cluster. For fixed-effect models that
include individual effects or time effects (but not both), the cluster will
be taken equal to the included fixed effects if not otherwise specified.
Clustering on individuals can also be obtained by specifying the name of
the individual index (e.g., <code>cluster = "state"</code>) or <code>cluster =
"individual"</code>; clustering on time periods can be obtained by specifying the
name of the time index (e.g., <code>cluster = "year"</code>) or <code>cluster =
"time"</code>; if a group index is specified, clustering on groups (in which
individuals are nested) can be obtained by specifying the name of the group
index or <code>cluster = "group"</code>. For random-effects models, the cluster
will be taken equal to the included random effect identifier if not
otherwise specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Character string specifying which small-sample adjustment should 
be used, with available options <code>"CR0"</code>, <code>"CR1"</code>, <code>"CR1p"</code>,
<code>"CR1S"</code>, <code>"CR2"</code>, or <code>"CR3"</code>. See "Details" section of 
<code>vcovCR</code> for further information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>
<p>Optional matrix or vector describing the working
variance-covariance model used to calculate the <code>CR2</code> and <code>CR4</code>
adjustment matrices. By default, the target is taken to be an identity
matrix for fixed effect models or the estimated compound-symmetric
covariance matrix for random effects models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inverse_var</code></td>
<td>
<p>Optional logical indicating whether the weights used in 
fitting the model are inverse-variance. If not specified, <code>vcovCR</code> 
will attempt to infer a value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>Controls the form of the returned matrix. The default 
<code>"sandwich"</code> will return the sandwich variance-covariance matrix. 
Alternately, setting <code>form = "meat"</code> will return only the meat of the 
sandwich and setting <code>form = B</code>, where <code>B</code> is a matrix of 
appropriate dimension, will return the sandwich variance-covariance matrix 
calculated using <code>B</code> as the bread. <code>form = "estfun"</code> will return the 
(appropriately scaled) estimating function, the transposed crossproduct of 
which is equal to the sandwich variance-covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ignore_FE</code></td>
<td>
<p>Optional logical controlling whether fixed effects are
ignored when calculating small-sample adjustments in models where fixed
effects are estimated through absorption.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments available for some classes of objects.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>c("vcovCR","clubSandwich")</code>, which consists
of a matrix of the estimated variance of and covariances between the
regression coefficient estimates.
</p>


<h3>See Also</h3>

<p><code>vcovCR</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
if (requireNamespace("plm", quietly = TRUE)) withAutoprint({

  library(plm)
  # fixed effects
  data("Produc", package = "plm")
  plm_FE &lt;- plm(log(gsp) ~ log(pcap) + log(pc) + log(emp) + unemp,
                data = Produc, index = c("state","year","region"),
                effect = "individual", model = "within")
  vcovCR(plm_FE, type="CR2")
  vcovCR(plm_FE, type = "CR2", cluster = Produc$region) # clustering on region
  
  # random effects
  plm_RE &lt;- update(plm_FE, model = "random")
  vcovCR(plm_RE, type = "CR2")
  vcovCR(plm_RE, type = "CR2", cluster = Produc$region) # clustering on region
  
  # nested random effects
  plm_nested &lt;- update(plm_FE, effect = "nested", model = "random")
  vcovCR(plm_nested, type = "CR2") # clustering on region
})

pkgs_available &lt;- requireNamespace("plm", quietly = TRUE) &amp; requireNamespace("AER", quietly = TRUE)

if (pkgs_available) withAutoprint({
  # first differencing
  data(Fatalities, package = "AER")
  Fatalities &lt;- within(Fatalities, {
    frate &lt;- 10000 * fatal / pop
    drinkagec &lt;- cut(drinkage, breaks = 18:22, include.lowest = TRUE, right = FALSE)
    drinkagec &lt;- relevel(drinkagec, ref = 4)
  })

  plm_FD &lt;- plm(frate ~ beertax + drinkagec + miles + unemp + log(income),
                data = Fatalities, index = c("state", "year"),
                model = "fd")
  vcovHC(plm_FD, method="arellano", type = "sss", cluster = "group")
  vcovCR(plm_FD, type = "CR1S")
  vcovCR(plm_FD, type = "CR2")
  
})

</code></pre>


</div>