<div class="container">

<table style="width: 100%;"><tr>
<td>ic_par_copula</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Copula regression models with parametric margins for bivariate interval-censored data</h2>

<h3>Description</h3>

<p>Fits a copula model with parametric margins for bivariate interval-censored data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ic_par_copula(
  data,
  var_list,
  copula,
  m.dist = "Weibull",
  method = "BFGS",
  iter = 300,
  stepsize = 1e-05,
  hes = TRUE,
  control = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame; must have <code>id</code> (subject id), <code>ind</code> (1,2 for two units in each subject),
<code>Left</code> (0 if left-censoring), <code>Right</code> (Inf if right-censoring), <code>status</code> (0 for right-censoring,
1 for interval-censoring or left-censoring), and <code>covariates</code> by column.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var_list</code></td>
<td>
<p>the list of covariates to be fitted into the copula model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>copula</code></td>
<td>
<p>Types of copula model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m.dist</code></td>
<td>
<p>baseline marginal distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>optimization method (see ?optim); default is "BFGS";
also can be "Newton" (see ?nlm).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>number of iterations when method is <code>"Newton"</code>;
default is 300.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stepsize</code></td>
<td>
<p>size of optimization step when method is <code>"Newton"</code>;
default is 1e-5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hes</code></td>
<td>
<p>default is <code>TRUE</code> for hessian calculation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list of control parameters for methods other than <code>"Newton"</code>;
see <code>?optim</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The input data must be a data frame. with columns <code>id</code> (sample id),
<code>ind</code> (1,2 for the two units from the same id),
<code>Left</code> (0 if left-censoring), <code>Right</code> (Inf if right-censoring),
<code>status</code> (0 for right-censoring, 1 for interval-censoring or left-censoring),
and <code>covariates</code>. The function does not allow <code>Left</code> == <code>Right</code>. <br></p>
<p>The supported copula models are <code>"Clayton"</code>, <code>"Gumbel"</code>, <code>"Frank"</code>,
<code>"AMH"</code>, <code>"Joe"</code> and <code>"Copula2"</code>.
The <code>"Copula2"</code> model is a two-parameter copula model that incorporates <code>Clayton</code>
and <code>Gumbel</code> as special cases.
The parametric generator functions of copula functions are list below:
</p>
<p>The Clayton copula has a generator </p>
<p style="text-align: center;"><code class="reqn">\phi_{\eta}(t) = (1+t)^{-1/\eta},</code>
</p>

<p>with <code class="reqn">\eta &gt; 0</code> and Kendall's <code class="reqn">\tau = \eta/(2+\eta)</code>.
</p>
<p>The Gumbel copula has a generator </p>
<p style="text-align: center;"><code class="reqn">\phi_{\eta}(t) = \exp(-t^{1/\eta}),</code>
</p>

<p>with <code class="reqn">\eta \geq 1</code> and Kendall's <code class="reqn">\tau = 1 - 1/\eta</code>.
</p>
<p>The Frank copula has a generator </p>
<p style="text-align: center;"><code class="reqn">\phi_{\eta}(t) = -\eta^{-1}\log \{1+e^{-t}(e^{-\eta}-1)\},</code>
</p>

<p>with <code class="reqn">\eta \geq 0</code> and Kendall's <code class="reqn">\tau = 1+4\{D_1(\eta)-1\}/\eta</code>,
in which <code class="reqn">D_1(\eta) = \frac{1}{\eta} \int_{0}^{\eta} \frac{t}{e^t-1}dt</code>.
</p>
<p>The AMH copula has a generator </p>
<p style="text-align: center;"><code class="reqn">\phi_{\eta}(t) = (1-\eta)/(e^{t}-\eta),</code>
</p>

<p>with <code class="reqn">\eta \in [0,1)</code> and Kendall's <code class="reqn">\tau =  1-2\{(1-\eta)^2 \log (1-\eta) + \eta\}/(3\eta^2)</code>.
</p>
<p>The Joe copula has a generator </p>
<p style="text-align: center;"><code class="reqn">\phi_{\eta}(t) = 1-(1-e^{-t})^{1/\eta},</code>
</p>

<p>with <code class="reqn">\eta \geq 1</code> and Kendall's <code class="reqn">\tau = 1 - 4 \sum_{k=1}^{\infty} \frac{1}{k(\eta k+2)\{\eta(k-1)+2\}}</code>.
</p>
<p>The Two-parameter copula (Copula2) has a generator </p>
<p style="text-align: center;"><code class="reqn">\phi_{\eta}(t) = \{1/(1+t^{\alpha})\}^{\kappa},</code>
</p>

<p>with <code class="reqn">\alpha \in (0,1], \kappa &gt; 0</code> and Kendall's <code class="reqn">\tau = 1-2\alpha\kappa/(2\kappa+1)</code>. <br></p>
<p>The supported marginal distributions are <code>"Weibull"</code> (proportional hazards),
<code>"Gompertz"</code> (proportional hazards) and <code>"Loglogistic"</code> (proportional odds).
These marginal distributions are listed below
and we assume the same baseline parameters between two margins. <br></p>
<p>The Weibull (PH) survival distribution is </p>
<p style="text-align: center;"><code class="reqn">\exp \{-(t/\lambda)^k  e^{Z^{\top}\beta}\},</code>
</p>

<p>with <code class="reqn">\lambda &gt; 0</code> as scale and <code class="reqn">k &gt; 0</code> as shape.
</p>
<p>The Gompertz (PH) survival distribution is </p>
<p style="text-align: center;"><code class="reqn">\exp \{-\frac{b}{a}(e^{at}-1) e^{Z^{\top}\beta}\},</code>
</p>

<p>with <code class="reqn">a &gt; 0</code> as shape and <code class="reqn">b &gt; 0</code> as rate.
</p>
<p>The Loglogistic (PO) survival distribution is </p>
<p style="text-align: center;"><code class="reqn">\{1+(t/\lambda)^{k} e^{Z^{\top}\beta} \}^{-1},</code>
</p>

<p>with <code class="reqn">\lambda &gt; 0</code> as scale and <code class="reqn">k &gt; 0</code> as shape. <br></p>
<p>Optimization methods can be all methods (except <code>"Brent"</code>) from <code>optim</code>, such as
<code>"Nelder-Mead"</code>, <code>"BFGS"</code>, <code>"CG"</code>, <code>"L-BFGS-B"</code>, <code>"SANN"</code>.
Users can also use <code>"Newton"</code> (from <code>nlm</code>).
</p>


<h3>Value</h3>

<p>a <code>CopulaCenR</code> object summarizing the model.
Can be used as an input to general <code>S3</code> methods including
<code>summary</code>, <code>print</code>, <code>plot</code>, <code>lines</code>,
<code>coef</code>, <code>logLik</code>, <code>AIC</code>,
<code>BIC</code>, <code>fitted</code>, <code>predict</code>.
</p>


<h3>Source</h3>

<p>Tao Sun, Yi Liu, Richard J. Cook, Wei Chen and Ying Ding (2019).
Copula-based Score Test for Bivariate Time-to-event Data,
with Application to a Genetic Study of AMD Progression.
<em>Lifetime Data Analysis</em> 25(3), 546-568. <br>
Tao Sun and Ying Ding (In Press).
Copula-based Semiparametric Regression Model for Bivariate Data
under General Interval Censoring.
<em>Biostatistics</em>. DOI: 10.1093/biostatistics/kxz032.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># fit a Copula2-Weibull model
data(AREDS)
copula2_wb &lt;- ic_par_copula(data = AREDS, copula = "Copula2",
                  m.dist = "Weibull",
                  var_list = c("ENROLLAGE","rs2284665"))
summary(copula2_wb)
</code></pre>


</div>