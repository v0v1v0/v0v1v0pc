<div class="container">

<table style="width: 100%;"><tr>
<td>func.cl.ord</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Composite Likelihood Calculation for Spatial Ordinal Data</h2>

<h3>Description</h3>

<p><code>func.cl.ord</code> calculates the composite log-likelihood for spatial ordered probit models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">func.cl.ord(vec.yobs, mat.X, mat.lattice, radius, n.cat, vec.par)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>vec.yobs</code></td>
<td>
<p>a vector of observed responses for all N sites.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mat.X</code></td>
<td>
<p>regression (design) matrix, including intercepts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mat.lattice</code></td>
<td>
<p>a data matrix containing geographical information of sites. The <em>i</em> th row constitutes a set of geographical coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>radius</code></td>
<td>
<p>weight radius.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.cat</code></td>
<td>
<p>number of categories, at least 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vec.par</code></td>
<td>
<p>a vector of parameters consecutively as follows: a series of cutoffs (excluding -Inf, 0 and Inf) for latent responses, a vector of covariate parameters, a parameter 'sigmasq' modeling covariance matrix, 0&lt;=sigmasq&lt;=1, and a parameter 'rho' reflecting spatial correlation, abs(rho)&lt;=1.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>func.cl.ord</code> returns a list: number of categories, sum of weights, composite log-likelihood, a vector of scores, and a matrix of first-order partial derivatives for <code>vec.par</code>.
</p>


<h3>References</h3>

<p>Feng, Xiaoping, Zhu, Jun, Lin, Pei-Sheng, and Steen-Adams, Michelle M. (2014) Composite likelihood Estimation for Models of Spatial Ordinal Data and Spatial Proportional Data with Zero/One values. <em>Environmetrics</em> 25(8): 571â€“583.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# True parameter
vec.cutoff &lt;- 2; vec.beta &lt;- c(1, 2, 1, 0, -1); sigmasq &lt;- 0.8; rho &lt;- 0.6; radius &lt;- 5
vec.par &lt;- c(vec.cutoff, vec.beta, sigmasq, rho)

# Coordinate matrix
n.cat &lt;- 3; n.lati &lt;- 30; n.long &lt;- 30
n.site &lt;- n.lati * n.long
mat.lattice &lt;- cbind(rep(1:n.lati, n.long), rep(1:n.long, each=n.lati))
mat.dist &lt;- as.matrix(dist(mat.lattice, upper=TRUE, diag=TRUE))
mat.cov &lt;- sigmasq * rho^mat.dist

set.seed(1228)
# Generate regression (design) matrix with intercept
mat.X &lt;- cbind(rep(1, n.site),scale(matrix(rnorm(n.site*(length(vec.beta)-1)),nrow=n.site)))
vec.Z &lt;- t(chol(mat.cov)) %*% rnorm(n.site) + mat.X %*% vec.beta
vec.epsilon &lt;- diag(sqrt(1-sigmasq), n.site) %*% rnorm(n.site)
vec.ylat &lt;- as.numeric(vec.Z + vec.epsilon)

# Convert to the vector of observation
vec.yobs &lt;- func.obs.ord(vec.ylat, vec.alpha=c(-Inf,0,vec.cutoff,Inf))

# Using func.cl.ord()
ls &lt;- func.cl.ord(vec.yobs, mat.X, mat.lattice, radius, n.cat, vec.par)
ls$log.lkd

</code></pre>


</div>