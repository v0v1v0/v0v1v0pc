<div class="container">

<table style="width: 100%;"><tr>
<td>blocks-class</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Class "blocks"</h2>

<h3>Description</h3>

<p>A class for overlapped blocks of the time series associated with the given
spatial points specified through the function <code>couples</code>. Thus, it is
necessary to execute couples first and then blocks
</p>


<h3>Usage</h3>

<pre><code class="language-R">blocks(lb, ls, matdata, pardata1, pardata2, stpairs)

## S4 method for signature 'blocks'
boxplot(x, i, j, ...)

## S4 method for signature 'blocks'
show(object)

## S4 method for signature 'blocks'
x[i, j, drop = FALSE]

## S4 method for signature 'blocks'
summary(object, i, j)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>lb</code></td>
<td>
<p>integer, length of each block. The number of terms in each block
must be greater than 5 and smaller than the quarter part of the length of
each time series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ls</code></td>
<td>
<p>integer, number of overlapped data between two consecutive blocks.
The number of overlapped terms between two consecutive blocks must in the
interval <code class="reqn">[0, lb/2]</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>matdata</code></td>
<td>
<p>STFDF/STSDF or <code>data.frame</code>, which contains the
coordinates of the spatial points, the identification code of the spatial
points, the indentification code of the temporal points and the values of
the variable, typically output from <code>read.STdata</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pardata1</code></td>
<td>
<p>integer, it represents the column in which the spatial ID is
stored (if the spatio-temporal data set is given as data.frame) or the number
of variables in the STFDF/STSDF (if the data are given as a STFDF/STSDF)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pardata2</code></td>
<td>
<p>integer, it represents the column in which the values of the
variable are stored (if the spatio-temporal data set is given as data.frame)
or the slot in which the values of the variable of interest are stored
(if the data are given as a STFDF/STSDF). Note that for STFDF/STSDF the
argument is set, by default, equal to 1 if the number of variables is equal
to 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stpairs</code></td>
<td>
<p>object of class <code>couples</code>, containing the spatial
points and the corresponding temporal lags to be analyzed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>object of class <code>blocks</code> for methods <code>boxplot</code> and <code>extract</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>i</code></td>
<td>
<p>index specifying the block to be selected. If <code>i=0</code> all blocks are
selected automatically (option available only for <code>boxplot</code> and <code>summary</code>
methods)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>j</code></td>
<td>
<p>index specifying the spatial point to be selected. If <code>j=0</code> all
spatial points are selected automatically (option available only for <code>boxplot</code>
and <code>summary</code> methods)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>any arguments that will be passed to the panel plotting functions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>object of class <code>blocks</code> for methods <code>show</code> and <code>summary</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop</code></td>
<td>
<p>logical, the argument is set, by default, equal to <code>FALSE</code> to
preserve the structure of the object. It is advisable not to change this option</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A message informs the user of the number of blocks extracted
</p>


<h3>Slots</h3>


<dl>
<dt><code>mat.block</code></dt>
<dd>
<p>matrix of dimension (<em>lb</em> x <em>overall
number of blocks</em>); the columns of this matrix are associated with the
different blocks, of length equal to <code>lb</code>, that can be extracted
from the time series related to the selected spatial points
defined in the slot <code>stpairs</code> of <code>couples</code>, identified
as  <code>stpairs@sel.staz</code></p>
</dd>
<dt><code>array.block</code></dt>
<dd>
<p>array of dimension (<em>lb</em> x <em>number of
blocks for each selected spatial points</em> x <em>number of spatial points</em>).
In each table of this array, the overlapped blocks for each spatial location
are available</p>
</dd>
<dt><code>sel.staz</code></dt>
<dd>
<p>numeric or character; contains the ID codes of the selected
spatial points</p>
</dd>
</dl>
<h3>Note</h3>


<ul>
<li>
<p> "Error in matdata<code class="reqn">[, clvr]</code>: subscript out of bounds" appears if <code>pardata2</code>
does not exist in the argument <code>matdata</code>
</p>
</li>
<li>
<p> If "Error in matdata<code class="reqn">[, clvr]</code>" appears, no data for some of the
spatial points, specified in <code>stpairs</code>, are available. The user has to
go back to <code>couples</code> and revise the vector of the selected spatial points
(<code>sel.staz</code> and <code>sp.couples.in</code> arguments)
</p>
</li>
<li>
<p> A stop occurs if more than 75% of consecutive data are missing in the time
series, since a large number of missing values do not guarantee the reliability
of the tests
</p>
</li>
<li>
<p> A stop occurs if the length of the time series for each
spatial points is less than 29
</p>
</li>
<li>
<p> A message appears if the length of the time series for each
spatial point is greater than 29 and less than 89, since the length of the
time series is low and may not guarantee the reliability of the tests
</p>
</li>
<li>
<p> A stop occurs if more than 80% of consecutive data are missing in one
of the blocks, since the estimation of the covariance matrix is not reliable,
when a large number of missing values occur
</p>
</li>
<li>
<p> If, in the last block of each selected spatial point, more than 15%
of data are missing a warning message appears, since the estimation of the
covariance matrix, when a large number of missing values occurs, is not
reliable
</p>
</li>
<li>
<p> A warning message appears if the number of blocks, computed by fixing
<code>lb</code> and <code>ls</code>, is less than 5. It is convenient that the number of
blocks is close to the number of spatio-temporal comparisons defined in
<code>couples</code>. This avoids singolarity in computing test statistics
</p>
</li>
</ul>
<h3>References</h3>

<p>Cappello, C., De Iaco, S., Posa, D., 2018, Testing the type of
non-separability and some classes of space-time covariance function models.
Stochastic Environmental Research and Risk Assessment,
<b>32</b> 17–35
</p>
<p>Cappello, C., De Iaco, S., Posa, D., 2020, covatest: An R Package for
Selecting a Class of Space-Time Covariance Functions.
Journal of Statistical Software, <b>94(1)</b> 1–42.
</p>
<p>De Iaco, S., Palma, M., Posa, D., 2016. A general procedure for selecting a
class of fully symmetric space-time covariance functions.
Environmentrics, <b>27(4)</b> 212–224.
</p>
<p>Li, B., Genton, M.G., Sherman, M., 2007, A nonparametric assessment
of properties of spacetime covariance functions.
Journal of the American Statistical Association, <b>102</b> 736–744.
</p>


<h3>See Also</h3>

<p><code>couples</code>
</p>
<p><code>read.STdata</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># --start define the STFDF rr_13-- #
library(sp)
library(spacetime)
#library(gstat)
data(air)
ls()
if (!exists("rural")) rural = STFDF(stations, dates, data.frame(PM10 =
as.vector(air)))
rr = rural[,"2005::2010"]
unsel = which(apply(as(rr, "xts"), 2, function(x) all(is.na(x))))
r5to10 = rr[-unsel,]
rr_13 &lt;- r5to10[c("DEHE046","DESN049","DETH026","DENW063","DETH061","DEBY047",
"DENW065","DEUB029","DENW068","DENI019","DEHE051","DERP016","DENI051"),
"2005::2006"]
# --end define the STFDF rr_13-- #


sel.staz.sym &lt;- c("DERP016", "DENW065", "DEHE051", "DETH026", "DENW063", "DENI019",
"DENW068", "DEHE046", "DEUB029", "DEBY047", "DETH061", "DESN049")

sp.couples.in.sym &lt;- matrix(data = c("DERP016", "DENW065", "DEHE051", "DETH026",
"DENW063", "DENI019", "DENW068", "DEHE046", "DEUB029", "DEBY047", "DETH061", "DESN049"),
ncol = 2, byrow = TRUE)

t.couples.in.sym &lt;- c(1, 2)

couples.sym &lt;- couples(sel.staz = sel.staz.sym, sp.couples.in = sp.couples.in.sym,
t.couples.in = t.couples.in.sym, typetest = "sym", typecode = character())

block.sym &lt;- blocks(lb = 40, ls = 10, matdata = rr_13, pardata1 = 1, pardata2 = 1,
stpairs = couples.sym)

### methods for blocks
#1. show
block.sym

#2. [  extract
block.sym[1,] #select the 1st block of each spatial location
block.sym[,1] #select all blocks of the 1st spatial location
block.sym[1:2, 1:3] #select the first two blocks of the first 3 spatial locations

#3. summary
summary(block.sym, 1:2, 1:3) #to obtain the summary associated to the first
#two blocks of the first 3 spatial locations

summary(block.sym, 0, 1) #to obtain the summary associated to all blocks of
#the 1st spatial location

#4. boxplot
boxplot(block.sym, 1:5, 1:2) #boxplots of the first 5 blocks of associated to
#the first 2 spatial locations

boxplot(block.sym, 0 ,1) #boxplots of all blocks of associated to the 1st
#spatial location

</code></pre>


</div>