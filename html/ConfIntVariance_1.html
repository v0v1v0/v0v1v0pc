<div class="container">

<table style="width: 100%;"><tr>
<td>ConfIntVariance-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Confidence Interval for the Univariate Population Variance without Normality Assumption
</h2>

<h3>Description</h3>

<p>Surrounds the usual sample variance of a univariate numeric sample with a confidence interval for the population variance. This has been done so far only under the assumption that the underlying distribution is normal. Under the hood, this package implements the unique least-variance unbiased estimator of the variance of the sample variance, in a formula that is equivalent to estimating kurtosis and square of the population variance in an unbiased way and combining them according to the classical formula into an estimator of the variance of the sample variance. Both the sample variance and the estimator of its variance are U-statistics. By the theory of U-statistic, the resulting estimator is unique. See Fuchs, Krautenbacher (2016) &lt;doi:10.1080/15598608.2016.1158675&gt; and the references therein for an overview of unbiased estimation of variances of U-statistics.
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
<td style="text-align: left;">
Package: </td>
<td style="text-align: left;"> ConfIntVariance</td>
</tr>
<tr>
<td style="text-align: left;">
Type: </td>
<td style="text-align: left;"> Package</td>
</tr>
<tr>
<td style="text-align: left;">
Title: </td>
<td style="text-align: left;"> Confidence Interval for the Univariate Population Variance without Normality Assumption</td>
</tr>
<tr>
<td style="text-align: left;">
Version: </td>
<td style="text-align: left;"> 1.0.2</td>
</tr>
<tr>
<td style="text-align: left;">
Date: </td>
<td style="text-align: left;"> 2019-03-06</td>
</tr>
<tr>
<td style="text-align: left;">
Author: </td>
<td style="text-align: left;"> Mathias Fuchs</td>
</tr>
<tr>
<td style="text-align: left;">
Maintainer: </td>
<td style="text-align: left;"> Mathias Fuchs&lt;mathias@mathiasfuchs.de&gt;</td>
</tr>
<tr>
<td style="text-align: left;">
Description: </td>
<td style="text-align: left;"> Surrounds the usual sample variance of a univariate numeric sample with a confidence interval for the population variance. This has been done so far only under the assumption that the underlying distribution is normal. Under the hood, this package implements the unique least-variance unbiased estimator of the variance of the sample variance, in a formula that is equivalent to estimating kurtosis and square of the population variance in an unbiased way and combining them according to the classical formula into an estimator of the variance of the sample variance. Both the sample variance and the estimator of its variance are U-statistics. By the theory of U-statistic, the resulting estimator is unique. See Fuchs, Krautenbacher (2016) &lt;doi:10.1080/15598608.2016.1158675&gt; and the references therein for an overview of unbiased estimation of variances of U-statistics.</td>
</tr>
<tr>
<td style="text-align: left;">
License: </td>
<td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>Index of help topics:
</p>
<pre>
ConfIntVariance-package
                        Confidence Interval for the Univariate
                        Population Variance without Normality
                        Assumption
varwci                  varwci
</pre>
<p>A package providing one function varwci which is short for
"variance with confidence interval."
</p>


<h3>Author(s)</h3>

<p>Mathias Fuchs
Maintainer: Mathias Fuchs&lt;mathias@mathiasfuchs.de&gt;
</p>


<h3>References</h3>

<p>www.mathiasfuchs.de/b3.html
</p>


<h3>Examples</h3>

<pre><code class="language-R">
##
## Example: throwing a dice
## 

                                        # True quantities that do not depend on n
trueMeanOfDice &lt;- mean(1:6)


                                        # The true variance of the dice
                                        # This is the quantity that we
                                        # want to estimate by embracing
                                        # with a confidence interval
                                        # instead of just estimating
                                        # with a point estimator as is
                                        # done in the function var
trueVarianceOfDice &lt;- mean((1:6)^2) - trueMeanOfDice^2
trueFourthCentralMomentOfDice &lt;- mean(((1:6)-trueMeanOfDice)^4)

                                        # this requires some scribbling with paper and pencil
                                        # (or a study of Hoeffding 1948)
trueVarianceOfSampleVarianceOfDice &lt;- function(n) 
(trueFourthCentralMomentOfDice - trueVarianceOfDice^2 * (n-3)/(n-1))/n

##
## Simulation study: compute the coverage probability of
## the confidence interval by computing the probability
## that it contains the true value.
## We want that probability to be equal to the confidence level 0.95,
## not more and not less. (If it was higher, the test would be too conservative).
##

                                        # number of times we draw a
                                        # sample and compute a confidence interval
N &lt;- 1e4
trueValueCovered &lt;- sapply(
    1:N,
    function(i) {
                                        # throw a dice 100 times
        x &lt;- sample(6, 100, replace=TRUE)
                                        # compute our confidence interval
        ci &lt;- varwci(x)
                                        # We know that the true variance
                                        # of the dice is
                                        # 35/12 = 2.916666...
                                        # Record the boolean whether the
                                        # confidence interval contains
                                        # the true value.
        (35/12 &gt; ci[1] &amp;&amp; 35/12 &lt; ci[2])
    }
)

                                        # Result of simulation study:
                                        # Will be close to 0.95.
print(mean(trueValueCovered))

</code></pre>


</div>