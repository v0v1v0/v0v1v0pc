<div class="container">

<table style="width: 100%;"><tr>
<td>wAddPCA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Low-rank matrix approximation by weighted alternating least squares
</h2>

<h3>Description</h3>

<p>Function <code>wAddPCA</code> calculates a weighted least squares approximation of low rank to a given matrix. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">wAddPCA(x, w = matrix(1, nrow(x), ncol(x)), p = 2, add = "all", bnd = "opt",
        itmaxout = 1000, itmaxin = 1000, epsout = 1e-06, epsin = 1e-06,
	verboseout = TRUE, verbosein = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The data matrix to be approximated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>The weight matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>The dimensionality of the low-rank solution (2 by default)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>The additive adjustment to be employed. Can be "all" (default), "nul" (no adjustment),
"one" (adjustment by a single scalar), "row" (adjustment by a row) or "col" (adjustment by a
column).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bnd</code></td>
<td>
<p>Can be "opt" (default), "all", "row" or "col".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>itmaxout</code></td>
<td>
<p>Maximum number of iterations for the outer loop of the algorithm</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>itmaxin</code></td>
<td>
<p>Maximum number of iterations for the inner loop of the algorithm</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsout</code></td>
<td>
<p>Numerical criterion for convergence of the outer loop</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsin</code></td>
<td>
<p>Numerical criterion for convergence of the inner loop</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verboseout</code></td>
<td>
<p>Be verbose on the outer loop iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbosein</code></td>
<td>
<p>Be verbose on the inner loop iterations</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list object with fields:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>The left matrix (A) of the factorization X = AB'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>The right matrix (B) of the factorization X = AB'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>The product AB'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>The final value of the loss function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>Vector for rows used to construct rank 1 weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>Vector for columns used to construct rank 1 weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>The vector with row adjustments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>The vector with column adjustments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>itel</code></td>
<td>
<p>Iterations needed for convergence</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>The additive adjustment</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The low-rank approximation to <code>x</code></p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>jan@deleeuwpdx.net</p>


<h3>References</h3>

<p>Graffelman, J. and De Leeuw, J. (2023) Improved approximation and visualization of the correlation matrix. The American Statistician pp. 1â€“20. Available online as latest article  <a href="https://doi.org/10.1080/00031305.2023.2186952">doi:10.1080/00031305.2023.2186952</a>
</p>
<p>https://jansweb.netlify
</p>


<h3>See Also</h3>

<p><code>ipSymLS</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(HeartAttack)
X &lt;- HeartAttack[,1:7]
X[,7] &lt;- log(X[,7])
colnames(X)[7] &lt;- "logPR"
R &lt;- cor(X)
W &lt;- matrix(1, 7, 7)
diag(W) &lt;- 0
Wals.out &lt;- wAddPCA(R, W, add = "nul", verboseout = FALSE) 
Rhat &lt;- Wals.out$y
</code></pre>


</div>