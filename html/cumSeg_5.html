<div class="container">

<table style="width: 100%;"><tr>
<td>jumpoints</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Change point estimation in piecewise constant models
</h2>

<h3>Description</h3>

<p>Estimation of change points and model selection via generalized BIC and other criteria
</p>


<h3>Usage</h3>

<pre><code class="language-R">jumpoints(y, x, k = min(30, round(length(y)/10)), output = "2", 
    psi = NULL, round = TRUE, control = fit.control(), 
    selection = sel.control(), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>the observed (genomic) sequence supposed to have a piecewise constant mean function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>the ‘segmented’ variable, e.g. the genomic location. If missing simple indices 1,2,... n (length of <code>y</code>) are assumed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>

<p>the starting number of changepoints. It should be quite larger than the supposed number of 
(true) changepoints. This argument is ignored if starting values of the changepoints are specified via
<code>psi</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>

<p>which output should be produced? Possible values are <code>"1"</code>, <code>"2"</code>, or <code>"3"</code>; see Details
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi</code></td>
<td>

<p>numeric vector to indicate the starting values for the changepoints. When <code>psi=NULL</code> (default), <code>k</code> 
quantiles are assumed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>round</code></td>
<td>

<p>logical; should the values of the changepoints be rounded?
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>

<p>a list returned by <code>fit.control</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selection</code></td>
<td>

<p>a list returned by <code>sel.control</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>additional arguments.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The algorithm works by suitably transforming the observed responses to fit a continuous piecewise linear model.
Starting from <code>k</code> changepoints, a large number of changepoints is first estimated. This number will be (typically slightly) lower than <code>k</code> since some changepoints will be discarded during the iterative steps when taking non admissible values. If <code>output="1"</code>, <code>jumpoints</code> returns them which typically will be more than the actual ones. If <code>output="2"</code> the appropriate number of changepoints is 
selected via the criterion specified in argument <code>selection</code> via <code>sel.control</code> (e.g. BIC, MDL, ..). 
Finally if <code>output="3"</code>, the segmented algorithm is run again to try to improve the changepoint estimates returned by the previous step. 
</p>


<h3>Value</h3>

<p>A list including several components depending on the value of <code>output</code> <br></p>
<p>If <code>output="1"</code> the most relevant components are 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>fitted.values </code></td>
<td>
<p>the fitted values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.psi</code></td>
<td>
<p>the estimated number of changepoints</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est.means</code></td>
<td>
<p>the estimated means</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi</code></td>
<td>
<p>the estimated changepoints</p>
</td>
</tr>
</table>
<p><br></p>
<p>If <code>output="2"</code> the most relevant components are 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>fitted.values </code></td>
<td>
<p>the fitted values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.psi</code></td>
<td>
<p>the estimated number of changepoints</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>
<p>the values of the selection criterion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi</code></td>
<td>
<p>the estimated changepoints</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est.means</code></td>
<td>
<p>the estimated means</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi0</code></td>
<td>
<p>the estimated changepoints at ouput 1 (before applying the selection criterion)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est.means0</code></td>
<td>
<p>the estimated means at ouput 1 (before applying the selection criterion)</p>
</td>
</tr>
</table>
<p><br></p>
<p>If <code>output="3"</code> the most relevant components are those of output 2 but
</p>
<table>
<tr style="vertical-align: top;">
<td><code>psi0</code></td>
<td>
<p>the estimated changepoints at ouput 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi1</code></td>
<td>
<p>the estimated changepoints at ouput 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi</code></td>
<td>
<p>the estimated changepoints at ouput 3 (after applying again the segmented algorithm).</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Vito Muggeo
</p>


<h3>References</h3>

<p>Muggeo, V.M.R., Adelfio, G., Efficient change point detection for genomic sequences 
of continuous measurements, <em>Bioinformatics</em> <b>27</b>, 161-166.
</p>


<h3>See Also</h3>

<p><code>lars</code>, <code>sel.control</code>, <code>fit.control</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 
n&lt;-100
x&lt;-1:n/n
 
lp&lt;-I(x&gt;.1) -1*I(x&gt;.15)+.585*I(x&gt;.45)-.585*I(x&gt;.6) -I(x&gt;.9)
e&lt;-rnorm(n,0,.154)
y&lt;-lp+e #data

#fit the model without selecting the changepoints
o1&lt;-jumpoints(y,output="1")
plot(o1, typeL="l")
lines(lp, col=2) #true regression function
legend("topright", c("true","fit with output=1"),bty="n", col=c(2,1), lty=1)

#fit model and select the changepoints
o2&lt;-jumpoints(y,output="2")
par(mfrow=c(1,2))
plot(o2, what="c")
plot(o2, typeL="s")
lines(lp, col=3) #true regression function
legend("topright", c("true","fit with output=2"),bty="n", col=c(3,1), lty=1)

## End(Not run)
    </code></pre>


</div>