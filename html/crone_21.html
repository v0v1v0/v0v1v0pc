<div class="container">

<table style="width: 100%;"><tr>
<td>scafac</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Scattering factor for 1D gaussian atoms</h2>

<h3>Description</h3>

<p>Given unit cell length, atomic number, B factor, occupancy and Miller
index h, this function returns the corresponding value of the analytical
scattering factor calculated as Fourier transform of the 1D gaussian atom.
</p>


<h3>Usage</h3>

<pre><code class="language-R">scafac(h, a, Zj, occj, Bj = NULL, k = ksigma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>Real numeric. One or more 1D Miller indices. h can also have
non-integer values in between integer values. This enables plotting
of scattering curves.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>Real numeric. Length of 1D unit cell.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Zj</code></td>
<td>
<p>Integer numeric. Atomic number (e.g. Oxygen has Zj &lt;- 8)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>occj</code></td>
<td>
<p>Real numeric. Atomic occupancy, a real number between 0 and 1,
where 0 means that the atom is missing in the crystal and 1 means that
is present in all unit cells of the crystal.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Bj</code></td>
<td>
<p>Real numeric. This is the B factor associated with the thermal
vibration of the atom. It is measured in squared angstroms and it is
equal to 8*pi^2*sigma^2, where sigma is the gaussian atom width.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>A real number. It controls the standard deviation of the 
gaussian function describing the atom and, thus, the shape of the
associated peak. The standard deviation sigma is given by:
<code>sigma = k * sqrt(Z)</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A real numeric. The value of the scattering factor at the sprcified
Miller idex or corresponding real value.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Values for some Miller indices
h &lt;- 0:10
a &lt;- 20
Zj &lt;- 16
Bj &lt;- 18  # Roughly corresponding to sigma 0.23
occj &lt;- 1
fval &lt;- scafac(h,a,Zj,occj,Bj)
plot(h,fval,pch=16,xlab="Miller index",ylab="Scattering factor",
     ylim=c(0,16))

# Continuous resolution
h &lt;- seq(0,10,length=1000)
fval &lt;- scafac(h,a,Zj,occj,Bj)
points(h,fval,type="l",col=2)

# Scattering curve for a lighter atom
Zj &lt;- 8
fval &lt;- scafac(h,a,Zj,occj,Bj)
points(h,fval,type="l",col=3)

# Scattering curve for the same atom, just with smaller Bj (colder)
Bj &lt;- 10
fval &lt;- scafac(h,a,Zj,occj,Bj)
points(h,fval,type="l",col=4)
</code></pre>


</div>