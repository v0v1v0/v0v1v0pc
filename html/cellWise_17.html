<div class="container">

<table style="width: 100%;"><tr>
<td>DI</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Detection-Imputation algorithm
</h2>

<h3>Description</h3>

<p>The Detection-Imputation algorithm computes cellwise robust estimates of the center and covariance matrix of a data set <code>X</code>. The algorithm alternates between the detection of cellwise outliers and their imputation combined with re-estimation of the center and covariance matrix. By default, it starts by calling <code>checkDataSet</code> to clean the data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">DI(X, initEst = "DDCWcov", crit = 0.01, maxits = 10, quant = 0.99,
maxCol = 0.25, checkPars = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p><code>X</code> is the input data, and must be an <code class="reqn">n</code> by <code class="reqn">d</code> matrix or a data frame.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initEst</code></td>
<td>
<p>An initial estimator for the center and covariance matrix. Should be one of <code>"DDCWcov"</code> or <code>"TSGS"</code>, where the latter refers to the function GSE::TSGS. The default option <code>"DDCWcov"</code> uses the proposal of Raymaekers and Rousseeuw (2020)  which is much faster for increasing dimension. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crit</code></td>
<td>
<p>The algorithm converges when the subsequent estimates of the center and covariance matrix do not differ more than <code>crit</code> in squared Euclidean norm.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxits</code></td>
<td>
<p>Maximum number of DI-iterations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quant</code></td>
<td>
<p>The cutoff used to detect cellwise outliers.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxCol</code></td>
<td>
<p>The maximum number of cellwise outliers allowed in a column.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>checkPars</code></td>
<td>
<p>Optional list of parameters used in the call to
<code>checkDataSet</code>. The options are:
</p>

<ul>
<li> <p><code>coreOnly</code> <br>
If <code>TRUE</code>, skip the execution of checkDataset. Defaults to <code>FALSE</code>
</p>
</li>
<li>
<p><code>numDiscrete</code><br>
A column that takes on numDiscrete or fewer values
will be considered discrete and not retained in the cleaned data.
Defaults to <code class="reqn">5</code>.
</p>
</li>
<li> <p><code>fracNA</code>
Only retain columns and rows with fewer NAs than this fraction.
Defaults to <code class="reqn">0.15</code>.
</p>
</li>
<li>
<p><code>precScale</code> <br>
Only consider columns whose scale is larger than precScale.
Here scale is measured by the median absolute deviation.
Defaults to <code class="reqn">1e-12</code>.
</p>
</li>
<li> <p><code>silent</code><br>
Whether or not the function progress messages should be suppressed.
Defaults to <code>FALSE</code>.
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with components: <br></p>

<ul>
<li> <p><code>center</code> <br>
The final estimate of the center of the data.
</p>
</li>
<li> <p><code>cov</code> <br>
The final estimate of the covariance matrix.
</p>
</li>
<li> <p><code>nits</code> <br>
Number of DI-iterations executed to reach convergence.
</p>
</li>
<li> <p><code>Ximp</code> <br>
The imputed data.
</p>
</li>
<li> <p><code>indcells</code> <br>
Indices of the cells which were flagged in the analysis.
</p>
</li>
<li> <p><code>indNAs</code> <br>
Indices of the NAs in the data. 
</p>
</li>
<li> <p><code>Zres</code> <br>
Matrix with standardized cellwise residuals of the flagged cells. Contains zeroes in the unflagged cells.
</p>
</li>
<li> <p><code>Zres_denom</code> <br>
Denominator of the standardized cellwise residuals.
</p>
</li>
<li> <p><code>cellPaths</code> <br>
Matrix with the same dimensions as X, in which each row contains the path of least angle regression through the cells of that row, i.e. the order of the coordinates in the path (1=first, 2=second,...)
</p>
</li>
<li> <p><code>checkDataSet_out</code> <br>
Output of the call to <code>checkDataSet</code> which is used to clean the data.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>J. Raymaekers and P.J. Rousseeuw
</p>


<h3>References</h3>

<p>J. Raymaekers and P.J. Rousseeuw (2020). Handling cellwise outliers by sparse regression and robust covariance. <em>Journal of Data Science, Statistics, and Visualisation</em>. <a href="https://doi.org/10.52933/jdssv.v1i3.18">doi:10.52933/jdssv.v1i3.18</a>(link to open access pdf)
</p>


<h3>See Also</h3>

<p><code>cellHandler</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">mu &lt;- rep(0, 3)
Sigma &lt;- diag(3) * 0.1 + 0.9
X &lt;- MASS::mvrnorm(100, mu, Sigma)
DI.out &lt;- DI(X)
DI.out$cov
# For more examples, we refer to the vignette:
## Not run: 
vignette("DI_examples")

## End(Not run)
</code></pre>


</div>