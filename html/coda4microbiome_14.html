<div class="container">

<table style="width: 100%;"><tr>
<td>explore_lr_longitudinal</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>explore_lr_longitudinal</h2>

<h3>Description</h3>

<p>Explores the association of summary (integral) of each log-ratio trajectory with the outcome.
Summarizes the importance of each variable (taxa) as the aggregation of
the association measures of those log-ratios involving the variable. The output includes a plot
of the association of the log-ratio with the outcome where the variables (taxa) are ranked by importance
</p>


<h3>Usage</h3>

<pre><code class="language-R">explore_lr_longitudinal(
  x,
  y,
  x_time,
  subject_id,
  ini_time,
  end_time,
  showPlots = FALSE,
  decreasing = TRUE,
  covar = NULL,
  shownames = FALSE,
  maxrow = 15,
  maxcol = 15,
  showtitle = TRUE,
  mar = c(0, 0, 1, 0)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>abundance matrix or data frame in long format (several rows per individual)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>outcome (binary); data type: numeric, character or factor vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_time</code></td>
<td>
<p>observation times</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subject_id</code></td>
<td>
<p>subject id</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ini_time</code></td>
<td>
<p>initial time to be analyzed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>end_time</code></td>
<td>
<p>end time to be analyzed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showPlots</code></td>
<td>
<p>if TRUE, shows the plot (default = FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>decreasing</code></td>
<td>
<p>order of importance (default = TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covar</code></td>
<td>
<p>data frame with covariates (default = NULL)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shownames</code></td>
<td>
<p>if TRUE, shows the names of the variables in the rows of the plot (default = FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxrow</code></td>
<td>
<p>maximum number of rows to display in the plot (default = 15)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxcol</code></td>
<td>
<p>maximum number of columns to display in the plot (default = 15)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showtitle</code></td>
<td>
<p>logical, if TRUE, shows the title of the plot (default = TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mar</code></td>
<td>
<p>mar numerical vector of the form c(bottom, left, top, right) which gives the number of lines of margin to be specified on the four sides of the plot (default mar=c(0,0,1,0))</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>list with "max log-ratio","names max log-ratio","order of importance","name of most important variables","association log-ratio with y","top log-ratios plot"
</p>


<h3>Author(s)</h3>

<p>M. Calle - T. Susin
</p>


<h3>Examples</h3>

<pre><code class="language-R">
set.seed(123) # to reproduce the results

data(ecam_filtered, package = "coda4microbiome")   # load the data

x=x_ecam # microbiome abundance
x_time = metadata$day_of_life    # observation times
subject_id = metadata$studyid   # subject id
y= metadata$diet           # diet ("bd"= breast diet, "fd"=formula diet)
ini_time = 0
end_time = 90

ecam_logratios&lt;-explore_lr_longitudinal(x,y,x_time,subject_id,ini_time,end_time)

</code></pre>


</div>