<div class="container">

<table style="width: 100%;"><tr>
<td>ch_binned_MannWhitney</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compares two time periods of data using Mann-Whitney test</h2>

<h3>Description</h3>

<p>Compares two time periods of data using the Mann-Whitney test. 
Data are binned based upon a bin size, and data are extracted for two time periods 
and tests for change between two such periods
result can be passed to <code>ch_polar_plot</code> or <code>ch_decades_plot</code> 
for visualization.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ch_binned_MannWhitney(
  DF,
  step,
  range1,
  range2,
  ptest = 0.05,
  variable = "discharge",
  metadata = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>DF</code></td>
<td>
<p>A data frame of hydrometric data from <code>ch_read_ECDE_flows</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step</code></td>
<td>
<p>An integer indicating the degree of smoothing eg. 1, 5, 11.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range1</code></td>
<td>
<p>The first and last year of first period, as <code>c(first,last)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range2</code></td>
<td>
<p>The first and last year of second period, as <code>c(first,last)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ptest</code></td>
<td>
<p>The significance level default is <code>0.05</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variable</code></td>
<td>
<p>Name of variable. Default is <span class="option">discharge</span></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metadata</code></td>
<td>
<p>dataframe of station metadata, default is HYDAT_list</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>StationID</code></td>
<td>
<p>ID of station</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Station_lname</code></td>
<td>
<p>Name of station</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bin_width</code></td>
<td>
<p>Smoothing time step</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range1</code></td>
<td>
<p>First range of years</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range2</code></td>
<td>
<p>Second range of years</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_used</code></td>
<td>
<p>p_value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fail</code></td>
<td>
<p>TRUE if test failed due to missing values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bin_method</code></td>
<td>
<p>method used for binning</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test_method</code></td>
<td>
<p>Mann-Whitney U-statistic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>series</code></td>
<td>
<p>a data frame containing:</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>period</code></td>
<td>
<p>period numbers i.e. 1:365/step</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>period1</code></td>
<td>
<p>median values for each bin in period 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>period2</code></td>
<td>
<p>median values for each bin in period 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mwu</code></td>
<td>
<p>Mann-Whitney U-statistic for each bin between the two periods</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>probability of U-statistic for each period</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>code</code></td>
<td>
<p>significance codes for each bin</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Paul Whitfield
</p>


<h3>References</h3>

<p>Whitfield, P.H., Cannon, A.J., 2000. Recent variations in climate and 
hydrology in Canada. Canadian Water Resources Journal 25: 19-65.
</p>


<h3>See Also</h3>

<p><code>ch_polar_plot</code> <code>ch_polar_plot_prep</code> 
<code>ch_decades_plot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(HYDAT_list)
data(CAN05AA008)
# first example fails due to missing data in both periods
range1 &lt;- c(1960,1969)
range2 &lt;- c(1990,1999)
b_MW &lt;- ch_binned_MannWhitney(CAN05AA008, step = 5, range1, range2, ptest = 0.05)

range1 &lt;- c(1970,1979)
range2 &lt;- c(1990,1999)
b_MW &lt;- ch_binned_MannWhitney(CAN05AA008, step = 5, range1, range2, ptest = 0.05)

</code></pre>


</div>