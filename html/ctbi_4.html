<div class="container">

<table style="width: 100%;"><tr>
<td>ctbi.outlier</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>ctbi.outlier</h2>

<h3>Description</h3>

<p><b>Please cite</b> the following companion paper if you're using the <code>ctbi</code> package: Ritter, F.: Technical note: A procedure to clean, decompose, and aggregate time series, Hydrol. Earth Syst. Sci., 27, 349â€“361, https://doi.org/10.5194/hess-27-349-2023, 2023.
</p>
<p>Outliers in an univariate dataset <code>y</code> are flagged using an enhanced box plot rule (called <b>Logbox</b>, input: <code>coeff.outlier</code>) that is adapted to non-Gaussian data and keeps the type I error at <code class="reqn">\frac{0.1}{\sqrt{n}}</code> % (percentage of erroneously flagged outliers).
</p>
<p>The box plot rule flags data points as outliers if they are below <code class="reqn">L</code> or above <code class="reqn">U</code> using the sample quantile <code class="reqn">q</code>:
</p>
<p><code class="reqn">L = q(0.25)-\alpha \times (q(0.75)- q(0.25))</code>
</p>
<p><code class="reqn">U = q(0.75)+\alpha \times (q(0.75)- q(0.25))</code>
</p>
<p><b>Logbox</b> replaces the original <code class="reqn">\alpha = 1.5</code> constant of the box plot rule with <code class="reqn">\alpha = A \times \log(n)+B+\frac{C}{n}</code>. The variable <code class="reqn">n \geq 9</code> is the sample size, <code class="reqn">C = 36</code> corrects biases emerging in small samples, and <code class="reqn">A</code> and <code class="reqn">B</code> are automatically calculated on a predictor of the maximum tail weight defined as <code class="reqn">m_{*} = \max(m_{-},m_{+})-0.6165</code>.
</p>
<p>The two functions (<code class="reqn">m_{-}</code>,<code class="reqn">m_{+}</code>) are defined as:
</p>
<p><code class="reqn">m_{-} = \frac{q(0.875)- q(0.625)}{q(0.75)- q(0.25)}</code>
</p>
<p><code class="reqn">m_{+} = \frac{q(0.375)- q(0.125)}{q(0.75)- q(0.25)}</code>
</p>
<p>And finally, <code class="reqn">A = f_{A}(</code><code class="reqn">m_{*}</code><code class="reqn">)</code> and <code class="reqn">B = f_{B}(</code><code class="reqn">m_{*}</code><code class="reqn">)</code> with <code class="reqn">m_{*}</code> restricted to [0,2]. The functions <code class="reqn">(f_{A},f_{B})</code> are defined as:
</p>
<p><code class="reqn">f_{A}(x) = 0.2294\exp(2.9416x-0.0512x^{2}-0.0684x^{3})</code>
</p>
<p><code class="reqn">f_{B}(x) = 1.0585+15.6960x-17.3618x^{2}+28.3511x^{3}-11.4726x^{4}</code>
</p>
<p>Both functions have been calibrated on the Generalized Extreme Value and Pearson families.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ctbi.outlier(y, coeff.outlier = "auto")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>univariate data (numeric vector)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coeff.outlier</code></td>
<td>
<p>one of <code>coeff.outlier</code> = 'auto' (default value), <code>coeff.outlier</code> = 'gaussian', <code>coeff.outlier</code> = c(A,B,C) or <code>coeff.outlier</code> = <code>NA</code>. If <code>coeff.outlier</code> = 'auto', C = 36 and the coefficients A and B are calculated on <code class="reqn">m_{*}</code>. If <code>coeff.outlier</code> = 'gaussian', <code>coeff.outlier</code> = c(0.08,2,36), adapted to the Gaussian distribution. If <code>coeff.outlier</code> = <code>NA</code>, no outliers are flagged</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list that contains:
</p>
<p><b>xy</b>, a two columns data frame that contains the clean data (first column) and the outliers (second column)
</p>
<p><b>summary.outlier</b>, a vector that contains A, B, C, <code class="reqn">m_{*}</code>, the size of the residuals (n), and the lower and upper outlier threshold
</p>


<h3>Examples</h3>

<pre><code class="language-R">x &lt;- runif(30)
x[c(5,10,20)] &lt;- c(-10,15,30)
example1 &lt;- ctbi.outlier(x)
</code></pre>


</div>