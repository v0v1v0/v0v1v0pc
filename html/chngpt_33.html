<div class="container">

<table style="width: 100%;"><tr>
<td>sim.chngpt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Simulation Function
</h2>

<h3>Description</h3>

<p>Generate simulation datasets for change point Monte Carlo studies.
</p>


<h3>Usage</h3>

<pre><code class="language-R">
sim.chngpt (mean.model = c("thresholded", "thresholdedItxn",
 "quadratic", "quadratic2b", "cubic2b", "exp",
 "flatHyperbolic", "z2", "z2hinge", "z2segmented",
 "z2linear", "logistic"), threshold.type = c("NA",
 "M01", "M02", "M03", "M10", "M20", "M30", "M11",
 "M21", "M12", "M22", "M22c", "M31", "M13", "M33c",
 "hinge", "segmented", "upperhinge", "segmented2",
 "step", "stegmented"), b.transition = Inf, family =
 c("binomial", "gaussian"), x.distr = c("norm",
 "norm3", "norm6", "imb", "lin", "mix", "gam",
 "zbinary", "gam1", "gam2", "fixnorm", "unif"), e. =
 NULL, mu.x = 4.7, sd.x = NULL, sd = 0.3, mu.z = 0,
 alpha = NULL, alpha.candidate = NULL, coef.z =
 log(1.4), beta = NULL, beta.itxn = NULL,
 logistic.slope = 15, n, seed, weighted = FALSE,
 heteroscedastic = FALSE, ar = FALSE, verbose = FALSE)

sim.twophase.ran.inte(threshold.type, n, seed)

sim.threephase(n, seed, gamma = 1, e = 3, beta_e = 5, f = 7, beta_f = 2, coef.z = 1)



</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>threshold.type</code></td>
<td>

<p>string. Types of threshold effect to simulate, only applicable when label does not start with sigmoid.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>

<p>string. Glm family.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>n
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu.z</code></td>
<td>

<p>n
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>

<p>seed
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weighted</code></td>
<td>

<p>beta
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>

<p>beta
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef.z</code></td>
<td>

<p>numeric. Coefficient for z.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.itxn</code></td>
<td>

<p>numeric. Coefficient for z.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>numeric, intercept.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu.x</code></td>
<td>

<p>numeric
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd.x</code></td>
<td>

<p>numeric
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.model</code></td>
<td>

<p>numeric
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.distr</code></td>
<td>

<p>string. Possible values: norm (normal distribution), gam (gamma distribution). gam1 is a hack to allow e. be different
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>e.</code></td>
<td>

<p>e.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>Boolean
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b.transition</code></td>
<td>

<p>b.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd</code></td>
<td>

<p>b.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ar</code></td>
<td>

<p>autocorrelation
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha.candidate</code></td>
<td>

<p>Candidate values of alpha, used in code to determine alpha values
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>e</code></td>
<td>

<p>e
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_e</code></td>
<td>

<p>beta_e
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>

<p>f
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_f</code></td>
<td>

<p>beta_f
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logistic.slope</code></td>
<td>

<p>beta_f
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>

<p>beta_f
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>heteroscedastic</code></td>
<td>
<p>Boolean.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>mean.model, threshold.type and b.transition all affect mean models. 
</p>


<h3>Value</h3>

<p>A data frame with following columns: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>0/1 outcome</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>observed covariate that we are interested in</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.star</code></td>
<td>
<p>unobserved covariate that underlies x</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>additional covariate</p>
</td>
</tr>
</table>
<p>In addition, columns starting with 'w' are covariates that we also adjust in the model; columns starting with 'x' are covariates derived from x.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
seed=2
par(mfrow=c(2,2))
dat=sim.chngpt(mean.model="thresholded", threshold.type="hinge", family="gaussian", beta=0, n=200, 
    seed=seed, alpha=-1, x.distr="norm", e.=4, heteroscedastic=FALSE)
plot(y~z, dat)
dat=sim.chngpt(mean.model="thresholded", threshold.type="hinge", family="gaussian", beta=0, n=200, 
    seed=seed, alpha=-1, x.distr="norm", e.=4, heteroscedastic=TRUE)
plot(y~z, dat)
dat=sim.chngpt(mean.model="z2", threshold.type="hinge", family="gaussian", beta=1, n=200, 
    seed=seed, alpha=1, x.distr="norm", e.=4, heteroscedastic=FALSE)
plot(y~z, dat)
dat=sim.chngpt(mean.model="z2", threshold.type="hinge", family="gaussian", beta=1, n=200, 
    seed=seed, alpha=1, x.distr="norm", e.=4, heteroscedastic=TRUE)
plot(y~z, dat)

</code></pre>


</div>