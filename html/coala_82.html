<div class="container">

<table style="width: 100%;"><tr>
<td>feat_migration</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Feature: Migration/Gene Flow</h2>

<h3>Description</h3>

<p>This feature changes the migration rates at a given time point.
Per default, no migration between the population occurs, which corresponds
to a <code>rate</code> of <code>0</code>. Set it to a value greater than zero to
enable migration from one population to another.
</p>


<h3>Usage</h3>

<pre><code class="language-R">feat_migration(
  rate,
  pop_from = NULL,
  pop_to = NULL,
  symmetric = FALSE,
  time = "0",
  locus_group = "all"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>rate</code></td>
<td>
<p>The migration rate. Can be a numeric or a
<code>parameter</code>. The rate is specified as
<code class="reqn">4 * N0 * m</code>, where <code class="reqn">m</code> is the fraction of
<code>pop_to</code> that is replaced by migrants
from <code>pop_from</code> each generation (in forward time).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pop_from</code></td>
<td>
<p>The population from which the individuals leave.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pop_to</code></td>
<td>
<p>The population to which the individuals move.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>symmetric</code></td>
<td>
<p>Use the rate for all pairs of populations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>The time point at which the migration with the migration
rate is set. The rate applies to the time past warts
of the time point, until it is changed again.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>locus_group</code></td>
<td>
<p>The loci for which this features is used. Can either be
<code>"all"</code> (default), in which case the feature is used for simulating
all loci, or a numeric vector. In the latter case, the feature is only
used for the loci added in <code>locus_</code> commands  with the corresponding
index starting from 1 in order in which the commands where added to the
model. For example, if a model has
<code>locus_single(10) + locus_averaged(10, 11) + locus_single(12)</code> and
this argument is <code>c(2, 3)</code>, than the feature is used for all but
the first locus (that is locus 2 - 12).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When looking forward in time, a fraction of <code>pop_to</code> that is replaced
by migrants from <code>pop_from</code> each generation (see <code>rate</code>). When
looking backwards in time, ancestral lines in <code>pop_to</code> move to
<code>pop_from</code> with the given rate.
</p>


<h3>Value</h3>

<p>The feature, which can be added to a model created with
<code>coal_model</code> using <code>+</code>.
</p>


<h3>See Also</h3>

<p>For creating a model: <code>coal_model</code>
</p>
<p>Other features: 
<code>feat_growth()</code>,
<code>feat_ignore_singletons()</code>,
<code>feat_mutation()</code>,
<code>feat_outgroup()</code>,
<code>feat_pop_merge()</code>,
<code>feat_recombination()</code>,
<code>feat_selection()</code>,
<code>feat_size_change()</code>,
<code>feat_unphased()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Asymmetric migration between two populations:
model &lt;- coal_model(c(5, 5), 10) +
  feat_migration(0.5, 1, 2) +
  feat_migration(1.0, 2, 1) +
  feat_mutation(5) +
  sumstat_sfs()
simulate(model)

# Three populations that exchange migrations with equal
# rates at times more than 0.5 time units in the past:
model &lt;- coal_model(c(3, 4, 5), 2) +
  feat_migration(1.2, symmetric = TRUE, time = 0.5) +
  feat_mutation(5) +
  sumstat_sfs()
simulate(model)
</code></pre>


</div>