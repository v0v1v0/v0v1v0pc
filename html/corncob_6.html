<div class="container">

<table style="width: 100%;"><tr>
<td>contrastsTest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Identify differentially-abundant and differentially-variable taxa using contrasts</h2>

<h3>Description</h3>

<p>Identify differentially-abundant and differentially-variable taxa using contrasts
</p>


<h3>Usage</h3>

<pre><code class="language-R">contrastsTest(
  formula,
  phi.formula,
  contrasts_DA = NULL,
  contrasts_DV = NULL,
  data,
  link = "logit",
  phi.link = "logit",
  sample_data = NULL,
  taxa_are_rows = TRUE,
  filter_discriminant = TRUE,
  fdr_cutoff = 0.05,
  fdr = "fdr",
  inits = NULL,
  try_only = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class <code>formula</code> without the response: a symbolic description of the model to be fitted to the abundance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi.formula</code></td>
<td>
<p>an object of class <code>formula</code> without the response: a symbolic description of the model to be fitted to the dispersion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts_DA</code></td>
<td>
<p>List. Optional. Constructs a contrast matrix. List elements should be characters specifying contrasts in the parameters within <code>formula</code>. Note that this is only available with <code>"Wald"</code> value for <code>test</code>. Must include at least one of <code>contrasts_DA</code> or <code>contrasts_DV</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts_DV</code></td>
<td>
<p>List. Optional. Constructs a contrast matrix. List elements should be characters specifying contrasts in the parameters within <code>phi.formula</code>. Note that this is only available with <code>"Wald"</code> value for <code>test</code>. Must include at least one of <code>contrasts_DA</code> or <code>contrasts_DV</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame containing the OTU table, or <code>phyloseq</code> object containing the variables in the models</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>
<p>link function for abundance covariates, defaults to <code>"logit"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi.link</code></td>
<td>
<p>link function for dispersion covariates, defaults to <code>"logit"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample_data</code></td>
<td>
<p>Data frame or matrix. Defaults to <code>NULL</code>. If <code>data</code> is a data frame or matrix, this must be included as covariates/sample data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taxa_are_rows</code></td>
<td>
<p>Boolean. Optional. If <code>data</code> is a data frame or matrix, this indicates whether taxa are rows. Defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filter_discriminant</code></td>
<td>
<p>Boolean. Defaults to <code>TRUE</code>. If <code>FALSE</code>, discriminant taxa will not be filtered out.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fdr_cutoff</code></td>
<td>
<p>Integer. Defaults to <code>0.05</code>. Desired type 1 error rate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fdr</code></td>
<td>
<p>Character. Defaults to <code>"fdr"</code>. False discovery rate control method, see <code>p.adjust</code> for more options.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inits</code></td>
<td>
<p>Optional initializations for model fit using <code>formula</code> and <code>phi.formula</code> as rows of a matrix. Defaults to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>try_only</code></td>
<td>
<p>Optional numeric. Will try only the <code>try_only</code> taxa, specified either via numeric input or character taxa names. Useful for speed when troubleshooting. Defaults to <code>NULL</code>, testing all taxa.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Optional additional arguments for <code>bbdml</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function uses contrast matrices to test for differential abundance and differential variability using a Wald-type chi-squared test. To use a formula implementation, see <code>differentialTest</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>contrastsTest</code>. List with elements <code>p</code> containing the p-values for each contrast, <code>p_fdr</code> containing the p-values after false discovery rate control,  <code>significant_taxa</code> containing the taxa names of the statistically significant taxa,  <code>contrasts_DA</code> containing the contrast matrix for parameters associated with the abundance, <code>contrasts_DV</code> containing the contrast matrix for parameters associated with the dispersion, <code>discriminant_taxa_DA</code> containing the taxa for which at least one covariate associated with the abundance was perfectly discriminant, <code>discriminant_taxa_DV</code> containing the taxa for which at least one covariate associated with the dispersion was perfectly discriminant, and <code>data</code> containing the data used to fit the models.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# data frame example
data(soil_phylum_contrasts_sample)
data(soil_phylum_contrasts_otu)
da_analysis &lt;- contrastsTest(formula = ~ DayAmdmt,
                             phi.formula = ~ DayAmdmt,
                             contrasts_DA = list("DayAmdmt21 - DayAmdmt11",
                                                 "DayAmdmt22 - DayAmdmt21"),
                             data = soil_phylum_contrasts_otu,
                             sample_data = soil_phylum_contrasts_sample,
                             fdr_cutoff = 0.05,
                             try_only = 1:5)

# phyloseq example (only run if you have phyloseq installed)
## Not run: 
contrasts_phylo &lt;- phyloseq::phyloseq(phyloseq::sample_data(soil_phylum_contrasts_sample),
phyloseq::otu_table(soil_phylum_contrasts_otu, taxa_are_rows = TRUE))
da_analysis &lt;- contrastsTest(formula = ~ DayAmdmt,
                             phi.formula = ~ DayAmdmt,
                             contrasts_DA = list("DayAmdmt21 - DayAmdmt11",
                                                 "DayAmdmt22 - DayAmdmt21"),
                             data = contrasts_phylo,
                             fdr_cutoff = 0.05,
                             try_only = 1:5)

## End(Not run)

</code></pre>


</div>