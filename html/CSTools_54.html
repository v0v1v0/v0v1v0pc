<div class="container">

<table style="width: 100%;"><tr>
<td>PlotForecastPDF</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot one or multiple ensemble forecast pdfs for the same event</h2>

<h3>Description</h3>

<p>This function plots the probability distribution function of 
several ensemble forecasts. Separate panels are used to plot forecasts valid 
or initialized at different times or by different models or even at different 
locations. Probabilities for tercile categories are computed, plotted in 
colors and annotated. An asterisk marks the tercile with higher probabilities. 
Probabilities for extreme categories (above P90 and below P10) can also be 
included as hatched areas. Individual ensemble members can be plotted as 
jittered points. The observed value is optionally shown as a diamond.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PlotForecastPDF(
  fcst,
  tercile.limits,
  extreme.limits = NULL,
  obs = NULL,
  plotfile = NULL,
  title = "Set a title",
  var.name = "Varname (units)",
  fcst.names = NULL,
  add.ensmemb = c("above", "below", "no"),
  color.set = c("ggplot", "s2s4e", "hydro", "vitigeoss"),
  memb_dim = "member"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fcst</code></td>
<td>
<p>A dataframe or array containing all the ensember members for each 
forecast. If <code>'fcst'</code> is an array, it should have two labelled 
dimensions, and one of them should be <code>'members'</code>. If <code>'fcsts'</code> is 
a data.frame, each column shoul be a separate forecast, with the rows beeing 
the different ensemble members.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tercile.limits</code></td>
<td>
<p>An array or vector with P33 and P66 values that define 
the tercile categories for each panel. Use an array of dimensions 
(nforecasts,2) to  define different terciles for each forecast panel, or a 
vector with two elements to reuse the same tercile limits for all forecast 
panels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extreme.limits</code></td>
<td>
<p>(optional) An array or vector with P10 and P90 values 
that define the extreme categories for each panel. Use an array of 
(nforecasts,2) to define different extreme limits for each forecast panel, 
or a vector with two elements to reuse the same tercile limits for all 
forecast panels. (Default: extreme categories are not shown).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs</code></td>
<td>
<p>(optional) A vector providing the observed values for each forecast 
panel or a single value that will be reused for all forecast panels. 
(Default: observation is not shown).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotfile</code></td>
<td>
<p>(optional) A filename (pdf, png...) where the plot will be 
saved. (Default: the plot is not saved).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>A string with the plot title.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.name</code></td>
<td>
<p>A string with the variable name and units.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fcst.names</code></td>
<td>
<p>(optional) An array of strings with the titles of each 
individual forecast.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.ensmemb</code></td>
<td>
<p>Either to add the ensemble members <code>'above'</code> (default) 
or <code>'below'</code> the pdf, or not (<code>'no'</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color.set</code></td>
<td>
<p>A selection of predefined color sets: use <code>'ggplot'</code> 
(default) for blue/green/red, <code>'s2s4e'</code> for blue/grey/orange, 
<code>'hydro'</code> for yellow/gray/blue (suitable for precipitation and 
inflows) or the <code>"vitigeoss"</code> color set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>memb_dim</code></td>
<td>
<p>A character string indicating the name of the member 
dimension.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A ggplot object containing the plot.
</p>


<h3>Author(s)</h3>

<p>Llorenç Lledó <a href="mailto:llledo@bsc.es">llledo@bsc.es</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">fcsts &lt;- data.frame(fcst1 = rnorm(10), fcst2 = rnorm(10, 0.5, 1.2))
PlotForecastPDF(fcsts,c(-1,1))
</code></pre>


</div>