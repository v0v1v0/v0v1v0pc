<div class="container">

<table style="width: 100%;"><tr>
<td>GEM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Main function for GEM models</h2>

<h3>Description</h3>

<p>Main function to estimate and validate GEneralized Mixture models with uncertainty.
</p>


<h3>Usage</h3>

<pre><code class="language-R">GEM(Formula,family=c("cub","cube","ihg","cush"),data,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Formula</code></td>
<td>
<p>Object of class Formula. Response variable is the vector of ordinal observations - see Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>Character string indicating which class of GEM models to fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame (or object coercible by <code>as.data.frame</code> to a data frame)
containing the variables in the model. If missing, the variables are taken from <code>environment(Formula)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to be passed for the specification of the model. See details and examples.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>It is the main function for GEM models estimation, calling for the corresponding function for
the specified subclass. The number of categories <code>m</code> is internally retrieved but it is advisable to pass
it as an argument to the call if some category has zero frequency.<br>
If  <code>family="cub"</code>, then a CUB mixture model is fitted to the data to explain uncertainty,
feeling and possible shelter effect by further passing the extra argument <code>shelter</code> for the corresponding category.
Subjects' covariates can be included by specifying covariates matrices in the
Formula as <code>ordinal~Y|W|X</code>,  to explain uncertainty (Y), feeling (W) or shelter (X).  Notice that
covariates for shelter effect can be included only if specified for both feeling and uncertaint (GeCUB models). <br>
If <code>family="cube"</code>, then a CUBE mixture model (Combination of Uniform and Beta-Binomial) is fitted to the data
to explain uncertainty, feeling and overdispersion.   Subjects' covariates can be also included to explain the
feeling component or all the three components by  specifying covariates matrices in the Formula as
<code>ordinal~Y|W|Z</code> to explain uncertainty (Y), feeling (W) or
overdispersion (Z). An extra logical argument <code>expinform</code> indicates whether or not to use the expected or the
observed information matrix (default is FALSE). <br>
If <code>family="ihg"</code>, then an IHG model is fitted to the data. IHG models (Inverse Hypergeometric) are nested into
CUBE models (see the references below). The parameter <code class="reqn">\theta</code> gives the probability of observing
the first category and is therefore a direct measure of preference, attraction, pleasantness toward the
investigated item. This is the reason why <code class="reqn">\theta</code> is customarily referred to as the preference parameter of the
IHG model. Covariates for the preference parameter <code class="reqn">\theta</code> have to be specified in matrix form in the Formula as
<code>ordinal~U</code>. <br>
If <code>family="cush"</code>, then a CUSH model is fitted to the data (Combination of Uniform and SHelter effect).
The category corresponding to the inflation should be
passed via argument <code>shelter</code>. Covariates for the shelter parameter <code class="reqn">\delta</code>
are specified in matrix form Formula as <code>ordinal~X</code>. <br>
Even if no covariate is included in the model for a given component, the corresponding model matrix needs always
to be specified: in this case, it should be set to 0 (see examples below). Extra arguments include the maximum
number of iterations (<code>maxiter</code>, default: <code>maxiter</code>=500) for the optimization algorithm and
the required error tolerance (<code>toler</code>, default: <code>toler</code>=1e-6). <br>
Standard methods: <code>logLik()</code>, <code>BIC()</code>, <code>vcov()</code>, <code>fitted()</code>, <code>coef()</code>, <code>print()</code>, <code>summary()</code>
are implemented.<br>
The optimization procedure is run via <code>optim()</code> when required. If the estimated variance-covariance matrix is not positive definite, the function returns a
warning message and produces a matrix with NA entries.
</p>


<h3>Value</h3>

<p>An object of the class "GEM" is a list containing the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>estimates</code></td>
<td>
<p>Maximum likelihood estimates of parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>Log-likelihood function at the final estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varmat</code></td>
<td>
<p>Variance-covariance matrix of final estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niter</code></td>
<td>
<p>Number of executed iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BIC</code></td>
<td>
<p>BIC index for the estimated model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ordinal</code></td>
<td>
<p>Vector of ordinal responses on which the model has been fitted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>Processor time for execution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ellipsis</code></td>
<td>
<p>Retrieve the arguments passed to the call and extra arguments generated via the call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>Character string indicating the sub-class of the fitted model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>Returns the Formula of the call for the fitted model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>Returns the executed call</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>D'Elia A. (2003). Modelling ranks using the inverse hypergeometric distribution,
<em>Statistical Modelling: an International Journal</em>, <b>3</b>, 65–78 <br>
D'Elia A. and Piccolo D. (2005). A mixture model for preferences data analysis,
<em>Computational Statistics &amp; Data Analysis</em>,  <b>49</b>, 917–937 <br>
Capecchi S. and Piccolo D. (2017). Dealing with heterogeneity in ordinal responses,
<em>Quality and Quantity</em>, <b>51</b>(5), 2375–2393 <br>
Iannario M. (2014). Modelling Uncertainty and Overdispersion in Ordinal Data,
<em>Communications in Statistics - Theory and Methods</em>, <b>43</b>, 771–786 <br>
Piccolo D. (2015). Inferential issues for CUBE models with covariates,
<em>Communications in Statistics. Theory and Methods</em>, <b>44</b>(23), 771–786. <br>
Iannario M. (2015). Detecting latent components in ordinal data with overdispersion by means
of a mixture distribution, <em>Quality &amp; Quantity</em>, <b>49</b>, 977–987 <br>
Iannario M. and Piccolo D. (2016a). A comprehensive framework for regression models of ordinal data.
<em>Metron</em>, <b>74</b>(2), 233–252.<br>
Iannario M. and Piccolo D. (2016b). A generalized framework for modelling ordinal data.
<em>Statistical Methods and Applications</em>, <b>25</b>, 163–189.<br></p>


<h3>See Also</h3>

<p><code>logLik</code>, <code>coef</code>, <code>BIC</code>,  <code>makeplot</code>,
<code>summary</code>, <code>vcov</code>, <code>fitted</code>, <code>cormat</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(CUB)
## CUB models with no covariates
model&lt;-GEM(Formula(Walking~0|0|0),family="cub",data=relgoods)
coef(model,digits=5)     # Estimated parameter vector (pai,csi)
logLik(model)            # Log-likelihood function at ML estimates
vcov(model,digits=4)     # Estimated Variance-Covariance matrix
cormat(model)            # Parameter Correlation matrix
fitted(model)            # Fitted probability distribution
makeplot(model)
################
## CUB model with shelter effect
model&lt;-GEM(Formula(officeho~0|0|0),family="cub",shelter=7,data=univer)
BICshe&lt;-BIC(model,digits=4)
################
## CUB model with covariate for uncertainty
modelcovpai&lt;-GEM(Formula(Parents~Smoking|0|0),family="cub",data=relgoods)
fitted(modelcovpai)
makeplot(modelcovpai)
################
## CUB model with covariates for both uncertainty and feeling components
data(univer)
model&lt;-GEM(Formula(global~gender|freqserv|0),family="cub",data=univer,maxiter=50,toler=1e-2)
param&lt;-coef(model)
bet&lt;-param[1:2]      # ML estimates of coefficients for uncertainty covariate: gender
gama&lt;-param[3:4]     # ML estimates of coefficients for feeling covariate: lage
##################
## CUBE models with no covariates
model&lt;-GEM(Formula(MeetRelatives~0|0|0),family="cube",starting=c(0.5,0.5,0.1),
  data=relgoods,expinform=TRUE,maxiter=50,toler=1e-2)
coef(model,digits=4)       # Final ML estimates
vcov(model)
fitted(model)
makeplot(model)
summary(model)
##################
## IHG with covariates
modelcov&lt;-GEM(willingn~freqserv,family="ihg",data=univer)
omega&lt;-coef(modelcov)      ## ML estimates 
maxlik&lt;-logLik(modelcov)   ## 
makeplot(modelcov)
summary(modelcov)
###################
## CUSH models without covariate
model&lt;-GEM(Dog~0,family="cush",shelter=1,data=relgoods)
delta&lt;-coef(model)      # ML estimates of delta
maxlik&lt;-logLik(model)   # Log-likelihood at ML estimates
summary(model)
makeplot(model)
</code></pre>


</div>