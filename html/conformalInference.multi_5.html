<div class="container">

<table style="width: 100%;"><tr>
<td>conformal.multidim.jackplus</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multivariate Response Jackknife + Prediction Regions</h2>

<h3>Description</h3>

<p>Compute prediction regions using multivariate Jackknife + inference.
</p>


<h3>Usage</h3>

<pre><code class="language-R">conformal.multidim.jackplus(x, y, x0, train.fun, predict.fun, alpha = 0.1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The feature variables, a matrix n x p.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The matrix of multivariate responses (dimension n x q)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x0</code></td>
<td>
<p>The new points to evaluate, a matrix of dimension n0 x p.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>train.fun</code></td>
<td>
<p>A function to perform model training, i.e., to produce an
estimator of E(Y|X), the conditional expectation of the response variable
Y given features X. Its input arguments should be x: matrix of features,
and y: matrix of responses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predict.fun</code></td>
<td>
<p>A function to perform prediction for the (mean of the)
responses at new feature values. Its input arguments should be out: output
produced by train.fun, and newx: feature values at which we want to make
predictions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Miscoverage level for the prediction intervals, i.e., intervals
with coverage 1-alpha are formed. Default for alpha is 0.1.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The work is an extension of the univariate approach to jackknife +
inference to a multivariate context, exploiting the concept of depth measures.
</p>
<p>This function is based on the package future.apply to
perform parallelisation. If this package is not installed, then the function
will abort.
</p>


<h3>Value</h3>

<p>A list with length n0, giving the lower and upper bounds for each observation.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## One instance

n=50
p=3
q=2
mu=rep(0,p)
x = mvtnorm::rmvnorm(n, mu)
beta&lt;-sapply(1:q, function(k) c(mvtnorm::rmvnorm(1,mu)))
y = x%*%beta + t(mvtnorm::rmvnorm(q,1:n))
x0=matrix(x[n,],nrow=1)
y0=matrix(y[n,],nrow=1)
n0&lt;-nrow(y0)
funs=lm_multi()

sol&lt;-conformal.multidim.jackplus(x,y,x,train.fun = funs$train.fun,
                                      predict.fun = funs$predict.fun,alpha=0.05)

sol



</code></pre>


</div>