<div class="container">

<table style="width: 100%;"><tr>
<td>pseudobulk</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Form pseudobulks from single cells.</h2>

<h3>Description</h3>

<p>Sum up cells in count matrix <code>raw</code> for bulk RNA methods such as
DESeq2.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pseudobulk(raw, pseudobulk_id)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>raw</code></td>
<td>
<p>A matrix with raw UMI counts, cells in columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pseudobulk_id</code></td>
<td>
<p>A factor that identifies which cells should go to
which pseudobulk. Generate pseudobulk_ids with the pseudobulk_id function!</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A matrix where each column is a pseudobulk and each row a gene.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Create pseudobulk counts and coldata for DESeq2: 
coldata &lt;- data.frame(
  celltype = rep(c("X+Y-", "X+Y+", "X-Y+", "X-Y-"),
                 each = nrow(simulated_umis$embed)/4), # 4 cell types
  patient  = c("3", "500.", "*5", "/")
)
coldata$pseudobulk_id &lt;- pseudobulk_id(coldata)
counts &lt;- pseudobulk(simulated_umis$raw, coldata$pseudobulk_id)
# Use counts/coldata as input for DESeqDataSetFromMatrix (DESeq2).

</code></pre>


</div>