<div class="container">

<table style="width: 100%;"><tr>
<td>opt_lin_bw</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Find the Optimal Bandwidth for a Linear Kernel Density Estimate</h2>

<h3>Description</h3>

<p>This function wraps <code>stats::bw.ucv()</code>
and <code>stats::bw.nrd()</code> of the '<span class="pkg">stats</span>'
package, simplifying their inputs. For more control,
these '<span class="pkg">stats</span>' functions could be used directly.
</p>


<h3>Usage</h3>

<pre><code class="language-R">opt_lin_bw(x, method = c("cv", "nrd"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>numeric vector of linear measurements.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>character string describing the method used to find
the optimal bandwidth. Either <code>"cv"</code> (cross-validation),
or <code>"nrd"</code> (rule-of-thumb estimate).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The normal reference distribution (<code>nrd</code>) method involves
matching a normal distribution to the data using an empirical measure of spread.
The optimal bandwidth for that normal distribution can then be exactly calculated
by minimizing the mean integrated square error.
<code>method="cv"</code> finds the optimal bandwidth using unbiased cross-validation.
</p>


<h3>Value</h3>

<p>A numeric value, the optimized bandwidth.
</p>


<h3>See Also</h3>

<p><code>stats::bw.ucv()</code>,
<code>stats::bw.nrd()</code>
<code>opt_lin_bw()</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">require(graphics)
set.seed(123)
n &lt;- 1000

x &lt;- rweibull(n, shape = 10)
bw1 &lt;- opt_lin_bw(x = x, method="nrd")
bw2 &lt;- opt_lin_bw(x = x, method="cv")

dens1 &lt;- fit_steplength(x = x, parametric = FALSE, bandwidth = bw1)
dens2 &lt;- fit_steplength(x = x, parametric = FALSE, bandwidth = bw2)
true_dens &lt;- dweibull(seq(0,max(x),length.out = 200), shape = 10)

plot(seq(0,max(x),length.out = 200), true_dens, type = "l")
lines(dens1$x, dens1$y, col = "red")
lines(dens2$x, dens2$y, col = "green")

</code></pre>


</div>