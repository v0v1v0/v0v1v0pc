<div class="container">

<table style="width: 100%;"><tr>
<td>cmb.em</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Conditional mixture modeling by EM algorithm</h2>

<h3>Description</h3>

<p>Runs conditional mixture modeling and model-based clustering by EM algorithm (Expectation Maximization) for a prespecified variables conditioning order. Runs variable selection procedure (forward, backward or stepwise) to achieve a parsimonious mixture model.</p>


<h3>Usage</h3>

<pre><code class="language-R">cmb.em(x, order = NULL, l, K, method = "stepwise", id0 = NULL, n.em = 200, em.iter = 5,
EM.iter = 200, nk.min = NULL, max.spur=5, tol = 1e-06, silent = FALSE, Parallel = FALSE,
n.cores = 4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x </code></td>
<td>
<p> dataset matrix (n x p)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order </code></td>
<td>
<p> customized variables' conditioning order (length p)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l </code></td>
<td>
<p> order of polynomial regression model </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K </code></td>
<td>
<p> number of clusters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method </code></td>
<td>
<p>variable selection method (options 'stepwise', 'forward', 'backward' and 'none')</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id0 </code></td>
<td>
<p>initial membership vector (length n)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.em </code></td>
<td>
<p>number of short EM in an emEM procedure</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>em.iter </code></td>
<td>
<p>maximum number of iterations of short EM in an emEM procedure</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EM.iter </code></td>
<td>
<p> maximum number of EM iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nk.min</code></td>
<td>
<p>spurious output control</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.spur</code></td>
<td>
<p>number of trials</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>tolerance level</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>output control (TRUE/FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Parallel</code></td>
<td>
<p>parallel computing (TRUE/FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.cores</code></td>
<td>
<p>number of cores in parallel computing</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In conditional mixture modeling, each component is modeled by a product of conditional distributions with the means expressed by polynomial regression functions depending on other variables. Polynomial regression function order <code>l</code> and the number of clusters <code>K</code> are prespecified by user. The model's initialization can be determined by passing a group membership vector to the argument <code>id</code>, or obtained by the emEM algorithm (the default setting) in the function. There are two arguments related to the emEM procedure, the number of short EM <code>n.em</code> and maximum number of iterations for short EM <code>em.iter</code>. By default, the <code>n.em = 200</code> and <code>em.iter = 5</code>. The method of variable selection can be specified as <code>method = "stepwise", "forward", "backward", or "none"</code> where <code>method = none</code> means no parsimonious procedure conducted. During the model fitting and variable selection phases, EM algorithm will be applied multiple times, where options <code>EM.iter</code> and <code>tol</code> are stopping criteria of EM iteration. The spurious output control argument <code>nk.min</code>, by default <code>nk.min = (l x (p - 1) + 1) x 2</code>, can be set by user. When spurious output is obtained, <code>cmb.em</code> will be rerun. The maximum number of rerunning is <code>max.spur</code>. 
</p>
<p>Notation: n - sample size, l - order of polynomial regression model, K - number of mixture components.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>input dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>estimated regression models for each cluster (K x p matrix) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p> vector of estimated membership (length n)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p> estimated log likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BIC </code></td>
<td>
<p> Bayesian Information Criterion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pi   </code></td>
<td>
<p>vector of estimated mixing proportions (length K)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau </code></td>
<td>
<p> matrix of estimated posterior probabilities (n x K)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta </code></td>
<td>
<p> matrix of estimated regression parameters (K x (p + p(p-1)l/2) )</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s2 </code></td>
<td>
<p> matrix of estimated variance (K x p)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>applied conditioning order (length p)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_pars </code></td>
<td>
<p> number of model parameters</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Biernacki C., Celeux G., Govaert G. (2003). Choosing Starting Values for the EM Algorithm for Getting the Highest Likelihood in Multivariate Gaussian Mixture Models. <em>Computational Statistics and Data Analysis</em>, 41(3-4), pp. 561-575.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)
K &lt;- 3
l &lt;- 2
x &lt;- as.matrix(iris[,-5])
id.true &lt;- iris[,5]

# Run EM algorithm for fitting a conditioning mixture model 
obj &lt;- cmb.em(x = x, order = c(1,3,2,4), l, K, method = "stepwise", silent = FALSE,
Parallel = FALSE)
id.cmb &lt;- obj$id
table(id.true, id.cmb)
obj$BIC

</code></pre>


</div>