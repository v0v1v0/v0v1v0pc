<div class="container">

<table style="width: 100%;"><tr>
<td>binomTestCoveragePlot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Coverage Plots for Binomial Proportions</h2>

<h3>Description</h3>

<p>Generates plots for the actual coverage of a binomial proportion
using various types of confidence intervals. Plots the actual
coverage for a given sample size and stated nominal coverage <code class="reqn">1 -</code> <code>alpha</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  binomTestCoveragePlot(n,
                        alpha = 0.05,
                        intervalType = "Clopper-Pearson",
                        plo = 0,
                        phi = 1,
                        clo = 1 - 2 * alpha,
                        chi = 1,
                        points = 5 + floor(250 / n),
                        showTrueCoverage = TRUE,
                        gridCurves = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>sample size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>significance level for confidence interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intervalType</code></td>
<td>
<p>type of confidence interval used; either "Clopper-Pearson", "Wald", "Wilson-Score", "Jeffreys", "Agresti-Coull", "Arcsine", or "Blaker"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plo</code></td>
<td>
<p>lower limit for percentile (horizontal axis)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>upper limit for percentile (horizontal axis)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clo</code></td>
<td>
<p>lower limit for coverage (vertical axis)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chi</code></td>
<td>
<p>upper limit for coverage (vertical axis)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>points</code></td>
<td>
<p>number of points plotted in each segment of the plot; if default, varies with 'n' (see above)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showTrueCoverage</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), a solid red line will appear at <code class="reqn">1 -</code> <code>alpha</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gridCurves</code></td>
<td>
<p>logical; if <code>TRUE</code>, display acceptance curves in gray</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Generates an actual coverage plot for binomial proportions using
</p>

<ul>
<li>
<p> various types of confidence intervals, and
</p>
</li>
<li>
<p> various sample sizes.
</p>
</li>
</ul>
<p>When the function is called with default arguments,
</p>

<ul>
<li>
<p> the horizontal axis is the percentile at which the coverage is evaluated,
</p>
</li>
<li>
<p> the vertical axis is the actual coverage percentage at each percentile, that is,
the probability that the true value at a percentile is contained in the corresponding
confidence interval, and
</p>
</li>
<li>
<p> the solid red line is the stated coverage of <code class="reqn">1 -</code> <code>alpha</code>.
</p>
</li>
</ul>
<p>The actual coverage for a particular value of <code class="reqn">p</code>, the percentile of interest, is
</p>
<p style="text-align: center;"><code class="reqn">c(p) = \sum_{x=0}^n {I(x,p) {n \choose x} p^x (1-p)^{n-x}},</code>
</p>

<p>where <code class="reqn">I(x,p)</code> is an indicator function that determines whether a confidence interval covers <code class="reqn">p</code> when <code class="reqn">X = x</code>
(see Vollset, 1993).
</p>
<p>The binomial distribution with arguments <code>size</code> = <code class="reqn">n</code> and
<code>prob</code> = <code class="reqn">p</code> has probability mass function
</p>
<p style="text-align: center;"><code class="reqn">p(x) = {n \choose x} p^x (1-p)^{n-x}</code>
</p>

<p>for <code class="reqn">x = 0, 1, \ldots, n</code>.
</p>
<p>The algorithm for plotting the actual coverage begins by calculating all possible lower and upper        bounds associated with the confidence interval procedure specified by the <code>intervalType</code> argument.
These values are concatenated into a vector which is sorted. Negative values and values that exceed 1 are removed from this vector. These values are the breakpoints in the actual coverage function. The <code>points</code> argument gives the number of points plotted on each segment of the graph of the actual coverage.
</p>
<p>The <code>plo</code> and <code>phi</code> arguments can be used to expand or compress the plots horizontally.
</p>
<p>The <code>clo</code> and <code>chi</code> arguments can be used to expand or compress the plots vertically.
</p>
<p>By default, the <code>showTrueCoverage</code> argument plots a solid horizontal
red line at the height of the stated coverage. The actual coverage is
plotted with solid black lines for each segment of the actual coverage.
</p>
<p>The <code>gridCurves</code> argument is assigned a logical value which indicates whether the acceptance curves giving all possible actual coverage values should be displayed as gray curves.
</p>


<h3>Author(s)</h3>

<p>Hayeon Park (<a href="mailto:hpark031@gmail.com">hpark031@gmail.com</a>),
Larry Leemis (<a href="mailto:leemis@math.wm.edu">leemis@math.wm.edu</a>)
</p>


<h3>References</h3>

<p>Vollset, S.E. (1993). Confidence Intervals for a Binomial Proportion. Statistics in Medicine, 12, 809â€“824.
</p>


<h3>See Also</h3>

<p><code>dbinom</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  binomTestCoveragePlot(6)
  binomTestCoveragePlot(10, intervalType = "Wilson-Score", clo = 0.8)
  binomTestCoveragePlot(n = 100, intervalType = "Wald", clo = 0, chi = 1, points = 30)
  </code></pre>


</div>