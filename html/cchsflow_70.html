<div class="container">

<table style="width: 100%;"><tr>
<td>rec_with_table</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Recode with Table</h2>

<h3>Description</h3>

<p>Recode with Table is responsible for recoding values of a dataset based on
the specifications in variable_details.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rec_with_table(
  data,
  variables = NULL,
  database_name = NULL,
  variable_details = NULL,
  else_value = NA,
  append_to_data = FALSE,
  log = FALSE,
  notes = TRUE,
  var_labels = NULL,
  custom_function_path = NULL,
  attach_data_name = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A dataframe containing the variables to be recoded. Can also be a list of dataframes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variables</code></td>
<td>
<p>character vector containing variable names to recode or
a variables csv containing additional variable info</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>database_name</code></td>
<td>
<p>String, the name of the dataset containing the variables
to be recoded. Can also be a vector of strings if data is a list</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variable_details</code></td>
<td>
<p>A dataframe containing the specifications (rules)
for recoding.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>else_value</code></td>
<td>
<p>Value (string, number, integer, logical or NA) that is used
to replace any values that are outside the specified ranges
(no rules for recoding).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>append_to_data</code></td>
<td>
<p>Logical, if <code>TRUE</code> (default), recoded variables
will be appended to the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>Logical, if <code>FALSE</code> (default), a log of recoding will
not be printed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>notes</code></td>
<td>
<p>Logical, if <code>FALSE</code> (default), will not print the
content inside the 'Noteâ€œ column of the variable being recoded.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var_labels</code></td>
<td>
<p>labels vector to attach to variables in variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>custom_function_path</code></td>
<td>
<p>path to location of the function to load</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>attach_data_name</code></td>
<td>
<p>to attach name of database to end table</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <a href="https://github.com/Big-Life-Lab/cchsflow/blob/master/inst/extdata/variable_details.csv">variable_details</a>
dataframe needs the following variables to function:
</p>

<dl>
<dt>variable</dt>
<dd>
<p>name of new (mutated) variable that is recoded</p>
</dd>
<dt>toType</dt>
<dd>
<p>type the variable is being recoded to
<em>cat = categorical, cont = continuous</em></p>
</dd>
<dt>databaseStart</dt>
<dd>
<p>name of dataframe with original variables to be
recoded</p>
</dd>
<dt>variableStart</dt>
<dd>
<p>name of variable to be recoded</p>
</dd>
<dt>fromType</dt>
<dd>
<p>variable type of start variable.
<em>cat = categorical or factor variable</em>
<em>cont = continuous variable (real number or integer)</em></p>
</dd>
<dt>recTo</dt>
<dd>
<p>Value to recode to</p>
</dd>
<dt>recFrom</dt>
<dd>
<p>Value/range being recoded from</p>
</dd>
</dl>
<p>Each row in <em>variable_details</em> comprises one category in a
newly transformed variable. The rules for each category the new variable
are a string in <em>recFrom</em> and value in <em>recTo</em>.
These recode pairs are the same syntax as <em>sjmisc::rec()</em>,
except in <em>sjmisc::rec()</em> the pairs are a string for the function
attribute <em>rec =</em>, separated by '<em>=</em>'.
For example in <em>rec_w_table</em>
<em>variable_details$recFrom = 2; variable_details$recTo = 4</em>
is the same as <em>sjmisc::rec(rec = "2=4")</em>.
the pairs are obtained from the RecFrom and RecTo columns
</p>

<dl>
<dt>recode pairs</dt>
<dd>
<p>each recode pair is row. see above example
or <em>PBC-variableDetails.csv</em></p>
</dd>
<dt>multiple values</dt>
<dd>
<p>multiple old values that should be recoded into
a new single value may be separated with comma, e.g.
<em>recFrom = "1,2"; recTo = 1</em></p>
</dd>
<dt>value range</dt>
<dd>
<p>a value range is indicated by a colon, e.g.
<em>recFrom= "1:4"; recTo = 1</em> (recodes all values from 1 to 4 into 1)</p>
</dd>
<dt>value range for doubles</dt>
<dd>
<p>for double vectors (with fractional part),
all values within the specified range are recoded; e.g.
<em>recFrom = "1:2.5'; recTo = 1</em> recodes 1 to 2.5 into 1,
but 2.55 would not be recoded
(since it's not included in the specified range)</p>
</dd>
<dt>
<em>"min"</em> and <em>"max"</em>
</dt>
<dd>
<p>minimum and maximum values
are indicates by <em>min</em> (or <em>lo</em>) and <em>max</em> (or <em>hi</em>),
e.g. <em>recFrom = "min:4"; recTo = 1</em> (recodes all values from
minimum values of <em>x</em> to 4 into 1)</p>
</dd>
<dt><em>"else"</em></dt>
<dd>
<p>all other values, which have not been specified yet,
are indicated by <em>else</em>, e.g. <em>recFrom = "else"; recTo = NA</em>
(recode all other values (not specified in other rows) to "NA")</p>
</dd>
<dt><em>"copy"</em></dt>
<dd>
<p>the <em>"else"</em>-token can be combined with
<em>copy</em>, indicating that all remaining, not yet recoded values should
stay the same (are copied from the original value), e.g.
<em>recFrom = "else"; recTo = "copy"</em></p>
</dd>
<dt>
<em>NA</em>'s</dt>
<dd>
<p><em>NA</em> values are allowed both as old and
new value, e.g.
<em>recFrom "NA"; recTo = 1. or "recFrom = "3:5"; recTo = "NA"</em>
(recodes all NA into 1,
and all values from 3 to 5 into NA in the new variable)</p>
</dd>
</dl>
<h3>Value</h3>

<p>a dataframe that is recoded according to rules in variable_details.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(cchsflow)
bmi2001 &lt;- rec_with_table(
  data = cchs2001_p, c(
    "HWTGHTM",
    "HWTGWTK", "HWTGBMI_der"
  )
)

head(bmi2001)

bmi2011_2012 &lt;- rec_with_table(
  data = cchs2011_2012_p,  c(
    "HWTGHTM",
    "HWTGWTK", "HWTGBMI_der"
  )
)

tail(bmi2011_2012)

combined_bmi &lt;- bind_rows(bmi2001, bmi2011_2012)
head(combined_bmi)
tail(combined_bmi)
</code></pre>


</div>