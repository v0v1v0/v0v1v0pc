<div class="container">

<table style="width: 100%;"><tr>
<td>numerical_Hessian</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Numerical Computation of the Hessian Matrix
</h2>

<h3>Description</h3>

<p>Computes numerically the Hessian matrix of a given function for
all coordinates (<code>numerical_Hessian</code>), for a selected
direction (<code>numerical_Hessian_partial</code>) or the gradient
of a multivariate function (<code>numerical_gradient</code>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">numerical_Hessian(par, FUN, h=1e-05, gradient=FALSE,
       hessian=TRUE, diag_only=FALSE, ...)

numerical_Hessian_partial(par, FUN, h=1e-05, coordinate=1, ... )

numerical_gradient(par, FUN, h=1E-5, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>

<p>Parameter vector
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUN</code></td>
<td>

<p>Specified function with argument vector <code>x</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>

<p>Numerical differentiation parameter. Can be also a vector.
The increment in the numerical approximation of the derivative is
defined as <code class="reqn">h_i \max ( 1, \theta_i)</code> where <code class="reqn">\theta_i</code>
denotes the <code class="reqn">i</code>th parameter.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gradient</code></td>
<td>

<p>Logical indicating whether the gradient should be calculated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hessian</code></td>
<td>
<p>Logical indicating whether the Hessian
matrix should be calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diag_only</code></td>
<td>
<p>Logical indicating whether only the diagonal of the
hessian should be computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed to <code>FUN</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coordinate</code></td>
<td>
<p>Coordinate index for partial derivative</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Gradient vector or Hessian matrix or a list of both elements
</p>


<h3>See Also</h3>

<p>See the <span class="pkg">numDeriv</span> package and the
<code>mirt::numerical_deriv</code>
function from the <span class="pkg">mirt</span> package.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#############################################################################
# EXAMPLE 1: Toy example for Hessian matrix
#############################################################################

# define function
f &lt;- function(x){
     3*x[1]^3 - 4*x[2]^2 - 5*x[1]*x[2] + 10 * x[1] * x[3]^2 + 6*x[2]*sqrt(x[3])
}
# define point for evaluating partial derivatives
par &lt;- c(3,8,4)

#--- compute gradient
CDM::numerical_Hessian( par=par, FUN=f, gradient=TRUE, hessian=FALSE)
## Not run: 
mirt::numerical_deriv(par=par, f=f, gradient=TRUE)

#--- compute Hessian matrix
CDM::numerical_Hessian( par=par, FUN=f )
mirt::numerical_deriv(par=par, f=f, gradient=FALSE)
numerical_Hessian( par=par, FUN=f, h=1E-4 )

#--- compute gradient and Hessian matrix
CDM::numerical_Hessian( par=par, FUN=f, gradient=TRUE, hessian=TRUE)

## End(Not run)
</code></pre>


</div>