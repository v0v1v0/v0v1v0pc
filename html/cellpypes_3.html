<div class="container">

<table style="width: 100%;"><tr>
<td>evaluate_rule</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Evaluate rule to obtain positive / negative cells</h2>

<h3>Description</h3>

<p>The rule is defined by feature, operator and threshold.
</p>


<h3>Usage</h3>

<pre><code class="language-R">evaluate_rule(obj, feature, operator, threshold, overdispersion = 0.01)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>A cellpypes object, see section <strong>cellpypes Objects</strong> below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>feature</code></td>
<td>
<p>Character scalar naming the gene you'd like to threshold.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>operator</code></td>
<td>
<p>One of <code>c("&gt;","&lt;")</code>. Use "&gt;" for positive (CD3E+) and
"&lt;" for negative markers (MS4A1-).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>Numeric scalar with the expression threshold separating positive
from negative cells. Evaluate_rule expects a plain fraction, not CP10K
(while rule has the use_CP10K argument).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overdispersion</code></td>
<td>
<p>Defaults to 0.01, only change it if you know
what you are doing.
If set to 0, the NB simplifies to the Poisson distribution, and larger
values give more variance.
The 0.01 default value follows the recommendation by
Lause, Berens and Kobak (Genome Biology 2021) to use
<code>size=100</code> in pnbinom for typical data sets.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>logical vector stating for each cell whether the rule is true.
</p>


<h3>cellpypes Objects</h3>

<p>A cellpypes object is a list with four slots:
</p>

<dl>
<dt><code>raw </code></dt>
<dd>
<p>(sparse) matrix with genes in rows, cells in columns</p>
</dd>
<dt><code>totalUMI </code></dt>
<dd>
<p>the colSums of obj$raw</p>
</dd>
<dt><code>embed </code></dt>
<dd>
<p>two-dimensional embedding of the cells, provided as data.frame
or tibble with two columns and one row per cell.</p>
</dd>
<dt><code>neighbors </code></dt>
<dd>
<p>index matrix with one row per cell and k columns, where
k is the number of nearest neighbors (we recommend 15&lt;k&lt;100, e.g. k=50).
Here are two ways to get the neighbors index matrix:
</p>

<ul>
<li>
<p> Use <code>find_knn(featureMatrix)$idx</code>, where featureMatrix could be
principal components, latent variables or normalized genes (features in
rows, cells in columns).
</p>
</li>
<li>
<p> use <code>as(seurat@graphs[["RNA_nn"]], "dgCMatrix")&gt; .1</code> to extract
the kNN
graph computed on RNA. The <code>&gt; .1</code> ensures this also works with RNA_snn,
wknn/wsnn or any other
available graph â€“ check with <code>names(seurat@graphs)</code>.
</p>
</li>
</ul>
</dd>
</dl>
</div>