<div class="container">

<table style="width: 100%;"><tr>
<td>derCOPinv2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Numerical Derivative Inverse of a Copula for U with respect to V</h2>

<h3>Description</h3>

<p>Compute the inverse of a numerical partial derivative for <code class="reqn">U</code> with respect to <code class="reqn">V</code> of a copula, which is a <em>conditional quantile function</em> for nonexceedance probability <code class="reqn">t</code>, or
</p>
<p style="text-align: center;"><code class="reqn">t = c_v(u) = \mathbf{C}^{(-1)}_{1 \mid 2}(u \mid v) =  \frac{\delta \mathbf{C}(u,v)}{\delta v}\mbox{,}</code>
</p>

<p>and solving for <code class="reqn">u</code>. Nelsen (2006, pp. 13, 40–41) shows that this inverse is quite important for random variable generation using the <em>conditional distribution method</em>. This function is not vectorized and will not be so.
</p>


<h3>Usage</h3>

<pre><code class="language-R">derCOPinv2(cop=NULL, v, t, trace=FALSE,
           delv=.Machine$double.eps^0.50, para=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cop</code></td>
<td>
<p>A copula function;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>A single nonexceedance probability <code class="reqn">v</code> in the <code class="reqn">Y</code> direction;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>A single nonexceedance probability level <code class="reqn">t</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>A logical controlling a <code>message</code> on whether the signs on the <code>uniroot</code> are the same—this is helpful in exploring the numerical derivative limits of a given implementation of a copula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delv</code></td>
<td>
<p>The <code class="reqn">\Delta v</code> interval for the derivative;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>para</code></td>
<td>
<p>Vector of parameters or other data structure, if needed, to pass to <code>cop</code>; and</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to pass to the copula.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Value(s) for the derivative inverse are returned.
</p>


<h3>Author(s)</h3>

<p>W.H. Asquith</p>


<h3>References</h3>

<p>Nelsen, R.B., 2006, An introduction to copulas: New York, Springer, 269 p.
</p>


<h3>See Also</h3>

<p><code>derCOP2</code></p>


<h3>Examples</h3>

<pre><code class="language-R">u &lt;- runif(1); t &lt;- runif(1)
derCOPinv2(u,t, cop=W)   # perfect negative dependence
derCOPinv2(u,t, cop=P)   # independence
derCOPinv2(u,t, cop=M)   # perfect positive dependence
derCOPinv2(u,t, cop=PSP) # a parameterless copula example
## Not run: 
# Simulate 500 values from product (independent) copula
plot(NA,NA, type="n", xlim=c(0,1), ylim=c(0,1), xlab="U", ylab="V")
for(i in 1:500) {
   v &lt;- runif(1); t &lt;- runif(1)
   points(derCOPinv2(cop=P, v, t),v, cex=0.5, pch=16) # black dots
}
# Simulate 500 of a Frechet Family copula and note crossing singularities.
for(i in 1:500) {
   v &lt;- runif(1); t &lt;- runif(1)
   u &lt;- derCOPinv2(v, t, cop=FRECHETcop, para=list(alpha=0.7, beta=0.169))
   points(u,v, cex=2, pch=16, col=2) # red dots
} #
## End(Not run)
</code></pre>


</div>