<div class="container">

<table style="width: 100%;"><tr>
<td>CST_QuantileMapping</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Quantile Mapping for seasonal or decadal forecast data</h2>

<h3>Description</h3>

<p>This function is a wrapper of fitQmap and doQmap from package
'qmap' to be applied on the object of class 's2dv_cube'. The quantile mapping
adjustment between an experiment, typically a hindcast, and observation is 
applied to the experiment itself or to a provided forecast.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CST_QuantileMapping(
  exp,
  obs,
  exp_cor = NULL,
  sdate_dim = "sdate",
  memb_dim = "member",
  window_dim = NULL,
  method = "QUANT",
  na.rm = FALSE,
  ncores = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>exp</code></td>
<td>
<p>An object of class <code>s2dv_cube</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs</code></td>
<td>
<p>An object of class <code>s2dv_cube</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exp_cor</code></td>
<td>
<p>An object of class <code>s2dv_cube</code> in which the quantile 
mapping correction should be applied. If it is not specified, the correction
is applied in object 'exp'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdate_dim</code></td>
<td>
<p>A character string indicating the dimension name in which 
cross-validation would be applied when exp_cor is not provided. 'sdate' by 
default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>memb_dim</code></td>
<td>
<p>A character string indicating the dimension name where
ensemble members are stored in the experimental arrays. It can be NULL if 
there is no ensemble member dimension. It is set as 'member' by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>window_dim</code></td>
<td>
<p>A character string indicating the dimension name where 
samples have been stored. It can be NULL (default) in case all samples are 
used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A character string indicating the method to be used:'PTF', 
'DIST', 'RQUANT', 'QUANT', 'SSPLIN'. By default, the empirical quantile 
mapping 'QUANT' is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>A logical value indicating if missing values should be removed
(FALSE by default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>An integer indicating the number of cores for parallel 
computation using multiApply function. The default value is NULL (1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters to be used by the method choosen. See qmap 
package for details.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>s2dv_cube</code> containing the experimental data
after applying the quantile mapping correction.
</p>


<h3>Author(s)</h3>

<p>Nuria Perez-Zanon, <a href="mailto:nuria.perez@bsc.es">nuria.perez@bsc.es</a>
</p>


<h3>See Also</h3>

<p><code>fitQmap</code> and <code>doQmap</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Use synthetic data
exp &lt;- NULL
exp$data &lt;- 1 : c(1 * 3 * 5 * 4 * 3 * 2)
dim(exp$data) &lt;- c(dataset = 1, member = 3, sdate = 5, ftime = 4,
                  lat = 3, lon = 2)
class(exp) &lt;- 's2dv_cube'
obs &lt;- NULL
obs$data &lt;- 101 : c(100 + 1 * 1 * 5 * 4 * 3 * 2)
dim(obs$data) &lt;- c(dataset = 1, member = 1, sdate = 5, ftime = 4,
                  lat = 3, lon = 2)
class(obs) &lt;- 's2dv_cube'
res &lt;- CST_QuantileMapping(exp, obs)

</code></pre>


</div>