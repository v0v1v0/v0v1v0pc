<div class="container">

<table style="width: 100%;"><tr>
<td>ch_polar_plot_prep</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Creates a data structure to be passed to <code>ch_polar_plot</code>
</h2>

<h3>Description</h3>

<p>Could be used to move data from a different type of analysis different to 
the <code>ch_binned_MannWhitney</code> function which uses flows. The two series need to be of the 
same length and their length is related to the step size. For examples, 
for five day periods there will be 73 periods.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ch_polar_plot_prep(
  station,
  plot_title,
  step,
  x0,
  x1,
  stat,
  prob,
  test_s,
  variable = "discharge",
  bin_method = "unstated",
  test_method = "unstated",
  lline1 = "Period 1",
  lline2 = "Period 2",
  pvalue = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>station</code></td>
<td>
<p>Typically a station number</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_title</code></td>
<td>
<p>Polar plot title - usually a station name</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step</code></td>
<td>
<p>The number of days binned</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x0</code></td>
<td>
<p>Time series of length n for a single seasonal cycle</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x1</code></td>
<td>
<p>Time series of length n for a single seasonal cycle</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stat</code></td>
<td>
<p>Time series of length n for statistical test value for each bin</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>Time series of length n of probability of test value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test_s</code></td>
<td>
<p>Vector with values of -1, 0, 1 for significance, -1 negative, 
1 positive, 0 not significant</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variable</code></td>
<td>
<p>Name of variable plotted. Default is <span class="option">discharge</span></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bin_method</code></td>
<td>
<p>Default is <span class="option">unstated</span></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test_method</code></td>
<td>
<p>Default is <span class="option">unstated</span></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lline1</code></td>
<td>
<p>Names of first period, default is <span class="option">Period 1</span></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lline2</code></td>
<td>
<p>Names of second period, default is <span class="option">Period 2</span></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalue</code></td>
<td>
<p>Value of p used. Default is 0.05</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>StationID</code></td>
<td>
<p>ID of station</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Station_lname</code></td>
<td>
<p>Name of station</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variable</code></td>
<td>
<p>Name of variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bin_width</code></td>
<td>
<p>Smoothing time step in days</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range1</code></td>
<td>
<p>First range of years</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range2</code></td>
<td>
<p>Second range of years</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_used</code></td>
<td>
<p>p_value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fail</code></td>
<td>
<p>TRUE if test failed due to missing values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bin_method</code></td>
<td>
<p>Method used for binning</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test_method</code></td>
<td>
<p>Mann-Whitney U</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>series</code></td>
<td>
<p>A data frame containing six columns</p>
</td>
</tr>
</table>
<p>The <code>series</code> data frame contains 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>period</code></td>
<td>
<p>period numbers i.e. 1:365/step</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>period1</code></td>
<td>
<p>median values for each bin in period 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>period2</code></td>
<td>
<p>median values for each bin in period 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mwu</code></td>
<td>
<p>Mann Whitney U-statistic for each bin between the two periods</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>probability of U for each period</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>code</code></td>
<td>
<p>significance codes for each bin</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Paul Whitfield
</p>


<h3>References</h3>

<p>Whitfield, P.H. and A.J. Cannon. 2000. Polar plotting of seasonal hydrologic
and climatic data. Northwest Science 74: 76-80.
</p>
<p>Whitfield, P.H., Cannon, A.J., 2000. Recent variations in climate and hydrology
in Canada. Canadian Water Resources Journal 25: 19-65.
</p>


<h3>See Also</h3>

<p><code>ch_binned_MannWhitney</code> <code>ch_polar_plot</code>
</p>


</div>