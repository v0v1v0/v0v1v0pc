<div class="container">

<table style="width: 100%;"><tr>
<td>clme_resids</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Computes various types of residuals</h2>

<h3>Description</h3>

<p>Computes several types of residuals for objects of class <code>clme</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">clme_resids(formula, data, gfix = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula expression. The constrained effect(s) must come before any unconstrained covariates on the right-hand side of the expression. The first <code>ncon</code> terms will be assumed to be constrained.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data frame containing the variables in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gfix</code></td>
<td>
<p>optional vector of group levels for residual variances. Data should be sorted by this value.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For fixed-effects models <code class="reqn">Y = X\beta + \epsilon</code>, residuals are given as <code class="reqn">\hat{e} = Y - X\hat{\beta}</code>.
For mixed-effects models <code class="reqn">Y = X\beta + + U\xi + \epsilon</code>, three types of residuals are available.
<code class="reqn">PA = Y - X\hat{\beta}</code>\
<code class="reqn">SS = U\hat{\xi}</code>\
<code class="reqn">FM = Y - X\hat{\beta} - U\hat{\xi}</code>
</p>


<h3>Value</h3>

<p>List containing the elements <code>PA</code>, <code>SS</code>, <code>FM</code>, <code>cov.theta</code>, <code>xi</code>, <code>ssq</code>, <code>tsq</code>.
<code>PA</code>, <code>SS</code>, <code>FM</code> are defined above (for fixed-effects models, the residuals are only <code>PA</code>). Then <code>cov.theta</code> is the unconstrained covariance matrix of the fixed-effects coefficients, <code>xi</code> is the vector of random effect estimates, and <code>ssq</code> and <code>tsq</code> are unconstrained estimates of the variance components.
</p>


<h3>Note</h3>

<p>There are few error catches in these functions. If only the EM estimates are desired, 
users are recommended to run <code>clme</code> setting <code>nsim=0</code>.
</p>
<p>By default, homogeneous variances are assumed for the residuals and (if included) 
random effects. Heterogeneity can be induced using the arguments <code>Nks</code> and <code>Qs</code>,
which refer to the vectors <code class="reqn"> (n_{1}, n_{2}, \ldots, n_{k}) </code> and
<code class="reqn"> (c_{1}, c_{2}, \ldots, c_{q}) </code>, respectively. See 
<code>CLME-package</code> for further explanation the model and these values.
</p>
<p>See <code>w.stat</code> and <code>lrt.stat</code> for more details on using custom 
test statistics.
</p>


<h3>See Also</h3>

<p><code>CLME-package</code>
<code>clme</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data( rat.blood )
cons &lt;- list(order = "simple", decreasing = FALSE, node = 1 )

clme.out &lt;- clme_resids(mcv ~ time + temp + sex + (1|id), data = rat.blood )

## End(Not run)

</code></pre>


</div>