<div class="container">

<table style="width: 100%;"><tr>
<td>plot_goodnessOfFit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>plot_goodnessOfFit</h2>

<h3>Description</h3>

<p>Make goodness of fit plots to assess the model-fit and bias in residual distribution. The linear model is fit to the residual and plotted using geom_smooth(method=lm) in ggplot.<br><br>
Explanation of the terminologies in terms of PBPK model fitting to the time-course drug concentration measurements:
<br> "independent variable" is time
<br> "dependent variable" is the concentration.
<br> "Residual" is the difference between the measured concentration and the model simulation with the parameter fond by the CGNM.
<br> "m" is number of observations
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_goodnessOfFit(
  CGNM_result,
  plotType = 1,
  plotRank = c(1),
  independentVariableVector = NA,
  dependentVariableTypeVector = NA,
  absResidual = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>CGNM_result</code></td>
<td>
<p>(required input) <em>A list</em> stores the computational result from Cluster_Gauss_Newton_method() function in CGNM package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotType</code></td>
<td>
<p>(default: 1) <em>1,2 or 3</em><br> specify the kind of goodness of fit plot to create</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotRank</code></td>
<td>
<p>(default: c(1)) <em>a vector of integers</em><br> Specify which rank of the parameter to use for the goodness of fit plots. (e.g., if one wishes to use rank 1 to 100 then set it to be seq(1,100), or if one wish to use 88th rank parameters then set this as 88.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>independentVariableVector</code></td>
<td>
<p>(default: NA) <em>a vector of numerics of length m</em> <br> set independent variables that target values are associated with (e.g., time of the drug concentration measurement one is fitting PBPK model to) <br>(when this variable is set to NA, seq(1,m) will be used as independent variable when appropriate).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dependentVariableTypeVector</code></td>
<td>
<p>(default: NA) <em>a vector of text of length m</em> <br> when this variable is set (i.e., not NA) then the goodness of fit analyses is done for each variable type.  For example, if we are fitting the PBPK model to data with multiple dose arms, one can see the goodness of fit for each dose arm by specifying which dose group the observations are from.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>absResidual</code></td>
<td>
<p>(default: FALSE)  <em>TRUE or FALSE</em> If TRUE plot absolute values of the residual.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><em>A ggplot object</em> of the goodness of fit plot.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
model_analytic_function=function(x){

 observation_time=c(0.1,0.2,0.4,0.6,1,2,3,6,12)
 Dose=1000
 F=1

 ka=10^x[1]
 V1=10^x[2]
 CL_2=10^x[3]
 t=observation_time

 Cp=ka*F*Dose/(V1*(ka-CL_2/V1))*(exp(-CL_2/V1*t)-exp(-ka*t))

 log10(Cp)
}

observation=log10(c(4.91, 8.65, 12.4, 18.7, 24.3, 24.5, 18.4, 4.66, 0.238))

CGNM_result=Cluster_Gauss_Newton_method(
nonlinearFunction=model_analytic_function,
targetVector = observation,
initial_lowerRange = rep(0.01,3), initial_upperRange =  rep(100,3),
lowerBound=rep(0,3), ParameterNames = c("Ka","V1","CL"),
num_iter = 10, num_minimizersToFind = 100, saveLog = FALSE)

plot_goodnessOfFit(CGNM_result)
plot_goodnessOfFit(CGNM_result,
     independentVariableVector=c(0.1,0.2,0.4,0.6,1,2,3,6,12))
</code></pre>


</div>