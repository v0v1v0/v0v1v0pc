<div class="container">

<table style="width: 100%;"><tr>
<td>extract_subpopulations</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extract subpopulations.</h2>

<h3>Description</h3>

<p><code>extract_subpopulations</code> identifies clusters in the reference and
population sets and reports the frequency of points in each cluster for the
two sets.
</p>


<h3>Usage</h3>

<pre><code class="language-R">extract_subpopulations(population, reference, variables, k)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>population</code></td>
<td>
<p>tbl with grouping (metadata) and observation variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reference</code></td>
<td>
<p>tbl with grouping (metadata) and observation variables. Columns of <code>population</code> and <code>reference</code> should be identical.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variables</code></td>
<td>
<p>character vector specifying observation variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>scalar specifying number of clusters.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>list containing clusters centers (<code>subpop_centers</code>), two
normalized histograms specifying frequency of each clusters in population
and reference (<code>subpop_profiles</code>), and cluster prediction and distance to
the predicted cluster for all input data (<code>population_clusters</code> and
<code>reference_clusters</code>).
</p>


<h3>Examples</h3>

<pre><code class="language-R">data &lt;- tibble::tibble(
  Metadata_group = c(
    "control", "control", "control", "control",
    "experiment", "experiment", "experiment", "experiment"
  ),
  AreaShape_Area = c(10, 12, NA, 16, 8, 8, 7, 7),
  AreaShape_Length = c(2, 3, NA, NA, 4, 5, 1, 5)
)
variables &lt;- c("AreaShape_Area", "AreaShape_Length")
population &lt;- dplyr::filter(data, Metadata_group == "experiment")
reference &lt;- dplyr::filter(data, Metadata_group == "control")
extract_subpopulations(
  population = population,
  reference = reference,
  variables = variables,
  k = 3
)
</code></pre>


</div>