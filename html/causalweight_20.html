<div class="container">

<table style="width: 100%;"><tr>
<td>paneltestDML</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>paneltestDML: Overidentification test for ATET estimation in panel data</h2>

<h3>Description</h3>

<p>This function applies an overidentification test to assess if unconfoundedness of the treatments and conditional common trends as imposed in differences-in-differences jointly hold in panel data when evaluating the average treatment effect on the treated (ATET).
</p>


<h3>Usage</h3>

<pre><code class="language-R">paneltestDML(y1, y0, d, x, trim = 0.01, MLmethod = "lasso", k = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y1</code></td>
<td>
<p>Potential outcomes for the treated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y0</code></td>
<td>
<p>Potential outcomes for the non-treated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>Treatment group indicator (binary). Should not contain missing values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Covariates to be controlled for. Should not contain missing values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trim</code></td>
<td>
<p>Trimming threshold for discarding observations with too small propensity scores within any subgroup defined by the treatment group and time. Default is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MLmethod</code></td>
<td>
<p>Machine learning method for estimating nuisance parameters using the <code>SuperLearner</code> package. Must be one of <code>"lasso"</code> (default), <code>"randomforest"</code>, <code>"xgboost"</code>, <code>"svm"</code>, <code>"ensemble"</code>, or <code>"parametric"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Number of folds in k-fold cross-fitting. Default is 3.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The test statistic corresponds to the difference between the ATETs that are based on two distinct doubly robust score functions, namely that under unconfoundedness and that based on difference-in-differences under conditional common trends. Estimation in panel data is based on double machine learning and the function supports different machine learning methods to estimate nuisance parameters (conditional mean outcomes and propensity scores) as well as cross-fitting to mitigate overfitting.
ATETselobs and ATETdid equals zero.
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>est</code></td>
<td>
<p>Test statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>Standard error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval</code></td>
<td>
<p>P-value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntrimmed</code></td>
<td>
<p>Number of trimmed or dropped observations due to propensitiy scores below the threshold <code>trim</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pscore.xy0</code></td>
<td>
<p>Propensity score under unconfoundedness.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pscore.x</code></td>
<td>
<p>Propensity score under conditional common trends.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ATETselobs</code></td>
<td>
<p>ATET based on the selection on observables/unconfoundedness assumption.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seATETselobs</code></td>
<td>
<p>Standard error of the ATET based on the selection on observables/unconfoundedness assumption.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ATETdid</code></td>
<td>
<p>ATET based on difference-in-differences invoking the conditional common trends assumption.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seATETdid</code></td>
<td>
<p>Standard error of the ATET based on difference-in-differences invoking the conditional common trends assumption.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Huber, M., and Oe√ü, E.-M. (2024): "A joint test of unconfoundedness and common trends", arXiv preprint 2404.16961.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
n=1000
x=matrix(rnorm(n * 5), n, 5)
d=1*(x[,1]+2*rnorm(n)&gt;0)
t=rbinom(n, 1, 0.5)
y0=x[,1]+rnorm(n)
y1=y0+rnorm(n)
y=ifelse(t == 1, y1, y0)
# report p-value (note that unconfoundedness and common trends hold jointly)
paneltestDML(y1, y0, d, x)$pval
## End(Not run)
</code></pre>


</div>