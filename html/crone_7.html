<div class="container">

<table style="width: 100%;"><tr>
<td>expand_to_cell</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Expand content of asymmetric unit to whole unit cell</h2>

<h3>Description</h3>

<p>Atom positions, types, B factors and occupancies are duplicated if
input space group (SG) is P-1; otherwise they are left untouched
(space group P1). Value of the occupancy for special positions is
barely checked for values outside [0,1] range. Extra-care needed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">expand_to_cell(sdata, SG = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sdata</code></td>
<td>
<p>A named list, normally obtained through the use of
function <code>read_x</code>. The list names correspond to 
different object types:
</p>

<ul>
<li>
<p>a.     Real numeric. The size of the unit cell.
</p>
</li>
<li>
<p>SG.    Character string. Space group symbol; either "P1" 
or "P-1"
</p>
</li>
<li>
<p>x0.    Vector of real numerics indicating the expanded atomic
positions in the unit cell.
</p>
</li>
<li>
<p>Z.     Vector of integers indicating the expanded 
atomic numbers for all atoms in the unit cell.
</p>
</li>
<li>
<p>B.    Vector of real numerics indicating the expanded 
B factors for all atoms in the unit cell.
</p>
</li>
<li>
<p>occ.  Vector of real numerics indicating the expanded 
occupancies for all atoms in the unit cell.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SG</code></td>
<td>
<p>2-letters character string. There are only two symmetries
possible when working within 1D crystallography, P1 (no symmetry)
and P-1 (inversion through the origin). SG can be either "P1" or
"P-1" for this function. Default is NULL, in which case the space
group is assumed to be equal to the one of the input structure.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A named list with the following elements:
</p>

<ul>
<li>
<p>a.   Real numeric. The size of the unit cell.
</p>
</li>
<li>
<p>SG.  Character string. Name of the space group, either "P1"
or "P-1".
</p>
</li>
<li>
<p>x0. Vector of real numerics indicating the expanded atomic
positions in the unit cell.
</p>
</li>
<li>
<p>Z.  Vector of integers indicating the expanded atomic numbers
for all atoms in the unit cell.
</p>
</li>
<li>
<p>B.  Vector of real numerics indicating the expanded B factors
for all atoms in the unit cell.
</p>
</li>
<li>
<p>occ. Vector of real numerics indicating the expanded occupancies
for all atoms in the unit cell.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R"># Asymmetric unit includes 3 atoms between 0 and a/2
a &lt;- 10
SG &lt;- "P-1"
x0 &lt;- c(1,2,4)
Z &lt;- c(6,8,6)
B &lt;- c(1,1.2,1.1)
occ &lt;- c(1,1,0.8)
sdata &lt;- standardise_sdata(a,SG,x0,Z,B,occ)
ltmp &lt;- expand_to_cell(sdata)
print(ltmp)  # Positions, atomic numbers, etc. have doubled

# Nothing changes if imposed SG is "P1" (but you get a warning!)
ltmp &lt;- expand_to_cell(sdata,SG="P1")
print(ltmp)
</code></pre>


</div>