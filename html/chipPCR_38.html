<div class="container">

<table style="width: 100%;"><tr>
<td>CPP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Curve Pre-processor
</h2>

<h3>Description</h3>

<p><code>CPP</code> encompasses a set of functions to 
pre-process an amplification curve. The pre-processing includes options to 
normalize curve data, to remove background, to remove outliers
in the background range and to test if an amplification is significant.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'numeric,numeric'
CPP(x, y, smoother = TRUE, method = "savgol", 
				trans = FALSE, method.reg = "lmrob", 
				bg.outliers = FALSE, median = FALSE, 
				method.norm = "none", qnL = 0.03, amptest = FALSE, 
				manual = FALSE, nl = 0.08, bg.range = NULL, ...)

## S4 method for signature 'matrix,missing'
CPP(x, y, smoother = TRUE, method = "savgol", 
			       trans = FALSE, method.reg = "lmrob", 
			       bg.outliers = FALSE, median = FALSE, 
			       method.norm = "none", qnL = 0.03, amptest = FALSE, 
			       manual = FALSE, nl = 0.08, bg.range = NULL, ...)

## S4 method for signature 'data.frame,missing'
CPP(x, y, smoother = TRUE, 
				   method = "savgol", trans = FALSE, 
				   method.reg = "lmrob", bg.outliers = FALSE, 
				   median = FALSE, method.norm = "none", 
				   qnL = 0.03, amptest = FALSE, 
				   manual = FALSE, nl = 0.08, bg.range = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>is a vector containing the time or cycle values or a matrix or data frame
containing both time or cycle values and fluorescence.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>is a vector containing the fluorescence values. Omitted if 
<code>x</code> 
is a data frame or matrix.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smoother</code></td>
<td>

<p>logical parameter which indicates if smoother should be used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>a vector of names defining which smoothing method 
should be used. The Savitzky-Golay smoothing filter is the default 
smoother. Use "lowess" for LOWESS smoother (locally-weighted polynomial 
regression), "mova" for moving average, "savgol" for Savitzky-Golay 
smoothing filter, "smooth" for cubic spline smooth, "spline" for standard 
cubic spline smooth, "supsmu" for Friedman's SuperSmoother, "whit1" for 
weighted Whittaker smoothing with a first order finite difference penalty, 
"whit2" for weighted Whittaker smoothing with a second order finite 
difference penalty or "all" for all implemented smoothing algorithms. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trans</code></td>
<td>

<p>defines if the slope of the background range in a curve should be 
corrected by a linear regression.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method.reg</code></td>
<td>

<p>defines the method ("rfit", "lmrob", "rq") for the robust linear 
regression. If equal to "least", <code>CPP</code> uses linear regression.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bg.outliers</code></td>
<td>

<p>is a logical argument which to remove outliers in the background 
range.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>median</code></td>
<td>

<p>If set to TRUE, median is used instead of mean in outlier 
replacement.  The mean is used by default.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method.norm</code></td>
<td>

<p>is a argument to use a "none", "minm", "max", "lugn", or
"zscore" normalization.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qnL</code></td>
<td>

<p>is the quantile to be used for the quantile normalization.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>amptest</code></td>
<td>

<p>is a logical operator which is used to set a test for a positive 
amplification.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>manual</code></td>
<td>

<p>is used to test for a fixed threshold value of the background.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nl</code></td>
<td>

<p>is a value used as fixed threshold value for the background.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bg.range</code></td>
<td>

<p>is a <code>numeric</code> vector of length 2 pointing the background range.
If <code>NULL</code>, the background range is calculated by <code>bg.max</code> function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>dot operator for diverse arguments of 
<code>smoother</code> for details).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>CPP</code> uses the <code>bg.max</code> function to estimate automatically the start of the 
amplification process. In the background range there is often noise which 
makes it harder to determine a meaningful background value. Therefore 
<code>CPP</code> can optionally remove outliers by finding the 
value with largest difference from the mean as provided by the 
<code>rm.outlier</code> function. This function also tries to 
prevent calculations of non amplified signals. 
</p>
<p>The slope of the background range is often unequal to 
zero. By setting the parameter <code>trans</code> it is possible to apply a 
simple correction of the slope. Thereby either a robust linear regression 
by computing MM-type regression estimators, a nonparametric rank-based 
estimator or a standard linear regression model. Care is needed when 
using 
<code>trans</code> with time series (see <code>lm</code> for details).
</p>


<h3>Value</h3>

<p>A <code>list</code> where each element represents the pre-process data and parameters 
for the background region (BG) of a qPCR experiment.
</p>


<h3>Author(s)</h3>

<p>Stefan Roediger, Michal Burdukiewicz
</p>


<h3>See Also</h3>

 
<p>Normalization: <code>normalizer</code>
</p>
<p>Smoothing: <code>smoother</code>
</p>
<p>Robust linear regression: <code>lm.coefs</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Function to pre-process an amplification curve.
# Take a subset of the C17 data frame.
data(C17)
default.par &lt;- par(no.readonly = TRUE)
par(mfrow = c(2,1))
plot(NA, NA, xlab = "Time [sec]", ylab = "refMFI", 
     main = "HDA Raw Data", 
     xlim = c(0, 2500), ylim = c(0,1.1), pch = 20)
for (i in 3:5) {
  lines(C17[1:50, 1], C17[1:50, i], col = i - 2, 
	type = "b", pch = 20)
}

legend(50, 0.5, c("55 degrees Celsius", "60 degrees Celsius", "65 degrees Celsius"), 
	col = c(1,2,3), pch = rep(20,3))

# Use CPP to pre-process the data by removing the missing value and 
# normalization of the data
plot(NA, NA, xlab = "Time [sec]", ylab = "refMFI", 
     main = "Curve Pre-processor Applied to HDA Data", 
     xlim = c(0, 2500), ylim = c(0,1.1), pch = 20)
for (i in 3:5) {
  y.cpp &lt;- CPP(C17[2:50, 1], C17[2:50, i], method.norm = "minm", 
	      bg.outliers = TRUE)$y.norm
  lines(C17[2:50, 1], y.cpp, col = i - 2, 
	type = "b", pch = 20)
}
legend(50, 1, c("55 degrees Celsius", "60 degrees Celsius", "65 degrees Celsius"), 
	col = c(1,2,3), pch = rep(20,3))

par(default.par)
</code></pre>


</div>