<div class="container">

<table style="width: 100%;"><tr>
<td>writeDateTimeOriginal</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Write values to DateTimeOriginal tag in image metadata</h2>

<h3>Description</h3>

<p>This function assigns values to the DateTimeOriginal tag in image's EXIF
metadata using Exiftool. It can be used when the original DateTimeOriginal
values in the metadata were lost for whatever reason. In order to first read
the Date/Time values from the data fields in the images, see the function
<code>OCRdataFields</code>. After running <code>OCRdataFields</code> and checking
its output you can run <code>writeDateTimeOriginal</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">writeDateTimeOriginal(DateTimeOriginal, fileNames, parallel, overwrite = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>DateTimeOriginal</code></td>
<td>
<p>character. DateTimeOriginal values to write into
EXIF:DateTimeOriginal tag of the files in fileNames.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fileNames</code></td>
<td>
<p>character. Full file names (including directories) of
images to process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>A parallel cluster object. Specify if you wish to run this
function in parallel. Provide a cluster object (output of makeCluster()) -
optional.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overwrite</code></td>
<td>
<p>logical. Overwrite existing files (TRUE) or create new
files while saving the original data as jpg_original files as a backup
(FALSE)?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The first value in <code>DateTimeOriginal</code> will be assigned to the first
image in <code>fileNames</code>, and so on. Both <code>DateTimeOriginal</code> and
<code>fileNames</code> can be obtained from the output of
<code>OCRdataFields</code>.  <code>DateTimeOriginal</code> uses the standard
"YYYY-MM-SS HH:MM:SS"" notation. If the values extracted via
<code>OCRdataFields</code> are in a different format you'll need to
reformat them first. Please provide them as character. Also, before using
this function, make sure that the date/time values read by
<code>OCRdataFields</code> are correct (sometimes OCR misreads values, so
check carefully).
</p>
<p>Parallel processing is advised since the function is rather slow (due to
calling Exiftool separately on every, so about 1 second per image). If you
know how to batch-assign DateTimeOriginal values in one Exiftool call,
please let me know.
</p>
<p>The function only works on JPG images, not video files.
</p>


<h3>Value</h3>

<p>Invisible NULL. The actual output is the JPG images which now have a
DateTimeOriginal tag.
</p>


<h3>Author(s)</h3>

<p>Juergen Niedballa
</p>


<h3>See Also</h3>

<p><code>OCRdataFields</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">

## Not run: 
# dontrun is to avoid forcing users to install additional dependencies

wd_images_OCR &lt;- system.file("pictures/full_size_for_ocr", package = "camtrapR")

library(magick)

# define geometries
geometry1 &lt;- geometry_area(x_off = 0, y_off = 0, width = 183, height = 37)
geometry2 &lt;- geometry_area(x_off = 196, y_off = 0, width = 200, height = 17)
geometry3 &lt;- geometry_area(x_off = 447, y_off = 0, width = 63, height = 17)
geometry4 &lt;- geometry_area(x_off = 984, y_off = 0, width = 47, height = 17)
geometry5 &lt;- geometry_area(x_off = 0, y_off = 793, width = 320, height = 17)

# combine geometries into list
geometries &lt;- list(date = geometry1, 
                   time = geometry2, 
                   sequence_id = geometry3,
                   temperature = geometry4,
                   camera_model = geometry5)

df_image_data  &lt;- OCRdataFields(inDir = wd_images_OCR,
                                geometries = geometries, 
                                invert = TRUE)       
df_image_data



library(parallel)
library(lubridate)

# prepare DateTimeOriginal column (ymd_hms() automatically respects the PM indicator)
df_image_data$DateTimeOriginal &lt;- paste(df_image_data$date, df_image_data$time)
df_image_data$DateTimeOriginal &lt;- as.character(ymd_hms(df_image_data$DateTimeOriginal))

# create cluster (3 cores)
cl &lt;- makeCluster(3)

# assign new DateTimeOriginal
writeDateTimeOriginal(DateTimeOriginal = df_image_data$DateTimeOriginal,
                      fileNames = df_image_data$filename_full,
                      parallel = cl)
                      
stopCluster(cl)
                   

## End(Not run)



</code></pre>


</div>