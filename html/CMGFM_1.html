<div class="container">

<table style="width: 100%;"><tr>
<td>CMGFM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit the CMGFM model</h2>

<h3>Description</h3>

<p>Fit the covariate-augumented generalized factor model
</p>


<h3>Usage</h3>

<pre><code class="language-R">CMGFM(
  XList,
  Z,
  types,
  numvarmat,
  q = 15,
  Alist = NULL,
  init = c("LFM", "GFM", "random"),
  maxIter = 30,
  epsELBO = 1e-08,
  verbose = TRUE,
  add_IC_iter = FALSE,
  seed = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>XList</code></td>
<td>
<p>a list consisting of multiple matrices in which each matrix has the same type of values, i.e., continuous, or count, or binomial/binary values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>a matrix, the fixed-dimensional covariate matrix with control variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>types</code></td>
<td>
<p>a string vector, specify the variable type in each matrix in <code>XList</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numvarmat</code></td>
<td>
<p>a <code>length(types)</code>-by-d matrix, specify the number of variables in modalities that belong to the same type.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>an optional string, specify the number of factors; default as 15.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Alist</code></td>
<td>
<p>an optional vector, the offset for each unit; default as full-zero vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>an optional character, specify the method in initialization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxIter</code></td>
<td>
<p>the maximum iteration of the VEM algorithm. The default is 30.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsELBO</code></td>
<td>
<p>an optional positive value, tolerance of relative variation rate of the evidence lower bound value, default as '1e-8'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>a logical value, whether output the information in iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add_IC_iter</code></td>
<td>
<p>a logical value, add the identifiability condition in iterative algorithm or add it after algorithm converges; default as FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>an integer, set the random seed in initialization, default as 1;</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>None
</p>


<h3>Value</h3>

<p>return a list including the following components:
</p>

<ul>
<li> <p><code>betaf</code> - the estimated regression coefficient vector for each modality; 
</p>
</li>
<li> <p><code>Bf</code> - the estimated loading matrix for each modality; 
</p>
</li>
<li> <p><code>M</code> - the estimated modality-shared factor matrix; 
</p>
</li>
<li> <p><code>Xif</code> - the estimated modality-specified factor vector;
</p>
</li>
<li> <p><code>S</code> - the estimated covariance matrix of modality-shared latent factors;
</p>
</li>
<li> <p><code>Om</code> - the posterior variance of modality-specified latent factors;
</p>
</li>
<li> <p><code>muf</code> - the estimated intercept vector for each modality;
</p>
</li>
<li> <p><code>Sigmam</code> - the variance of modality-specified factors;
</p>
</li>
<li> <p><code>invLambdaf</code> - the inverse of the estimated variances of error for each modality.
</p>
</li>
<li> <p><code>ELBO</code> -  the ELBO value when algorithm stops;
</p>
</li>
<li> <p><code>ELBO_seq</code> - the sequence of ELBO values.
</p>
</li>
<li> <p><code>time_use</code> - the running time in model fitting;
</p>
</li>
</ul>
<h3>References</h3>

<p>None
</p>


<h3>See Also</h3>

<p>None
</p>


<h3>Examples</h3>

<pre><code class="language-R">pveclist &lt;- list('gaussian'=c(50, 150),'poisson'=c(50, 150),
   'binomial'=c(100,60))
q &lt;- 6
sigmavec &lt;- rep(1,3)
pvec &lt;- unlist(pveclist)
datlist &lt;- gendata_cmgfm(pveclist = pveclist, seed = 1, n = 300,d = 3,
                         q = q, rho = rep(1,length(pveclist)), rho_z=0.2,
                         sigmavec=sigmavec, sigma_eps=1)
XList &lt;- datlist$XList
Z &lt;- datlist$Z
numvarmat &lt;- datlist$numvarmat
types &lt;- datlist$types
rlist &lt;- CMGFM(XList, Z, types=types, numvarmat, q=q)
str(rlist)

</code></pre>


</div>