<div class="container">

<table style="width: 100%;"><tr>
<td>calibrate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calibration of Biplot and Scatterplot Axis</h2>

<h3>Description</h3>

<p>Routine for the calibration of any axis (variable vector) in a biplot or a scatterplot</p>


<h3>Usage</h3>

<pre><code class="language-R">calibrate(g,y,tm,Fr,tmlab=tm,tl=0.05,dt=TRUE,dp=FALSE,
    lm=TRUE,verb=TRUE,axislab="",reverse=FALSE,
    alpha=NULL,labpos=1,weights=diag(rep(1,length(y))),
    axiscol="blue",cex.axislab=0.75,graphics=TRUE,where=3,
    laboffset=c(0,0),m=matrix(c(0,0),nrow=1),markerpos=3,
    showlabel=TRUE,lwd=1,shiftvec=c(0,0),shiftdir="none",shiftfactor=1.05) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p> the vector to be calibrated (2 x 1). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p> the data vector corresponding to <code>g</code>, appropriately centred and/or standardized. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tm</code></td>
<td>
<p> the vector of tick marks, appropiately centred and/or scaled. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Fr</code></td>
<td>
<p> the coordinates of the rows markers in the biplot. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tmlab</code></td>
<td>
<p> a list or vector of tick mark labels. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tl</code></td>
<td>
<p> the tick length. By default, the tick markers have length 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dt</code></td>
<td>
<p> draw ticks. By default, ticks markers are drawn. Set dt=F in order to compute
calibration results without actually drawing the calibrated scale. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dp</code></td>
<td>
<p> drop perpendiculars. With dp=T perpendicular lines will be drawn from the row markers 
specified by Fr onto the calibrated axis. This is a graphical aid to read off the values in the
corresponding scale. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lm</code></td>
<td>
<p> label markers. By default, all tick marks are labelled. Setting lm=F turns off the labelling
of the tick marks. This allows for creating tick marks without labels. It is particularly useful for
creating finer scales of tickmarks without labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verb</code></td>
<td>
<p> verbose parameter (F=be quiet, T=show results). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axislab</code></td>
<td>
<p> a label for the calibrated axis. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reverse</code></td>
<td>
<p> puts the tick marks and tick mark labels on the other side of the axis. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p> a value for the calibration factor. This parameter should only be specified if
a calibration is required that is different from the one that is optimal for data recovery.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labpos</code></td>
<td>
<p> position of the label for the calibrated axis (1,2,3 or 4). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>laboffset</code></td>
<td>
<p> offset vector for the axis label. If specified, shifts the label by the specified amounts with respect to the current position. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p> a matrix of weights (optional).  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axiscol</code></td>
<td>
<p> color of the calibrated axis. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.axislab</code></td>
<td>
<p> character expansion factor for axis label and tick mark labels. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>graphics</code></td>
<td>
<p> do graphics or not (F=no graphical output, T=draws calibrated scale). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>where</code></td>
<td>
<p> label placement (1=beginning,2=middle,3=end). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p> vector of means. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>markerpos</code></td>
<td>
<p> position specifier for the tick mark labels (1,2,3 or 4). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showlabel</code></td>
<td>
<p> show axis label in graph (T) or not (F). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p> line with for the calibrated axis </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shiftvec</code></td>
<td>
<p> a shift vector for the calibrated axis ((0,0) by
default) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shiftdir</code></td>
<td>
<p> indicates in which direction the axis should be
shifted ("left","right" or "none"). This direction is w.r.t. vector <code>g</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shiftfactor</code></td>
<td>
<p> scalar by which the shift vector is stretched (or
shrunken). By default, the length of the shift vector is stretched
by 5 percent (<code>shiftfactor</code> = 1.05)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This program calibrates variable vectors in biplots and scatterplots, by drawing tick marks along 
a given the vector and labelling the tick marks with specified values. The optimal calibration is
found by (generalized) least squares. Non-optimal calibrations are possible by specifying a 
calibration factor (alpha).
</p>


<h3>Value</h3>

<p>Returns a list with calibration results
</p>
<table>
<tr style="vertical-align: top;">
<td><code>useralpha</code></td>
<td>
<p>calibration factor specified by the user</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optalpha</code></td>
<td>
<p>optimal calibration factor</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lengthoneunit</code></td>
<td>
<p>length in the plot of one unit in the scale of the calibrated variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gof</code></td>
<td>
<p>goodness of fit (as in regression)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gos</code></td>
<td>
<p>goodness of scale</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>coordinates of the tick markers</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ang</code></td>
<td>
<p>angle in degrees of the biplot axis with the positive
x-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shiftvec</code></td>
<td>
<p>the supplied or computed shift vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yt</code></td>
<td>
<p>fitted values for the variable according to the calibration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>e</code></td>
<td>
<p>errors according to the calibration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Fpr</code></td>
<td>
<p>coordinates of the projections of the row markers onto the calibrated axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Mn</code></td>
<td>
<p>coordinates of the tick marker end points</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Jan Graffelman <a href="mailto:jan.graffelman@upc.edu">jan.graffelman@upc.edu</a> </p>


<h3>References</h3>

<p>Gower, J.C. and Hand, D.J., (1996) Biplots. Chapman &amp; Hall, London
</p>
<p>Graffelman, J. and van Eeuwijk, F.A. (2005) Calibration of multivariate scatter plots for 
exploratory analysis of relations within and between sets of variables in genomic research
Biometrical Journal, 47(6) pp. 863-879.
</p>
<p>Graffelman, J. (2006) A guide to biplot calibration.
</p>


<h3>See Also</h3>

<p><code>biplot</code></p>


<h3>Examples</h3>

<pre><code class="language-R">x &lt;- rnorm(20,1)
y &lt;- rnorm(20,1)
x &lt;- x - mean(x)
y &lt;- y - mean(y)
z &lt;- x + y
b &lt;- c(1,1)
plot(x,y,asp=1,pch=19)
tm&lt;-seq(-2,2,by=0.5)
Calibrate.z &lt;- calibrate(b,z,tm,cbind(x,y),axislab="Z",graphics=TRUE)
</code></pre>


</div>