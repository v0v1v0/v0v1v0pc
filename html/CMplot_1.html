<div class="container">

<table style="width: 100%;"><tr>
<td>CMplot-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Circle Manhattan Plot 
</h2>

<h3>Description</h3>

<p>Manhattan plot, a type of scatter plot, was widely used to display the association results. However, it is usually time-consuming and laborious for a non-specialist user to write scripts and adjust parameters of an elaborate plot. Moreover, the ever-growing traits measured have necessitated the 
integration of results from different Genome-wide association study researches. Circle Manhattan Plot is the first open R package that can lay out Genome-wide association study P-value results in QQ-plot, both traditional rectangular patterns and novel circular ones. United in only one bull's eye style 
plot, association results from multiple traits can be compared interactively, thereby to reveal both similarities and differences between signals.
Additional functions include: highlight signals, a group of SNPs, chromosome visualization and candidate genes around SNPs.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CMplot(Pmap,col=c("#4197d8","#f8c120","#413496","#495226",
    "#d60b6f","#e66519","#d581b7","#83d3ad","#7c162c","#26755d"),
    bin.size=1e6,bin.breaks=NULL,LOG10=TRUE,pch=19,type="p",band=1,
    H=1.5,ylim=NULL,axis.cex=1,axis.lwd=1.5,lab.cex=1.5,lab.font=2,
    plot.type=c("m","c","q","d"),multracks=FALSE,
    multracks.xaxis=FALSE,multraits=FALSE,points.alpha=100L,r=0.3,
    cex=c(0.5,1,1),outward=FALSE,ylab=expression(-log[10](italic(p))), 
    ylab.pos=3,xticks.pos=1,mar=c(3,6,3,3),mar.between=0,threshold=NULL,
    threshold.col="red",threshold.lwd=1,threshold.lty=2,amplify=TRUE,
    signal.cex=1.5,signal.pch=19,signal.col=NULL,signal.line=2,
    highlight=NULL,highlight.cex=1,highlight.pch=19,highlight.type="p",
    highlight.col="red",highlight.text=NULL,highlight.text.col="black",
    highlight.text.cex=1,highlight.text.font=3,chr.labels=NULL,
    chr.border=FALSE,chr.labels.angle=0,chr.den.col="black",
    chr.pos.max=FALSE,cir.band=1,cir.chr=TRUE,cir.chr.h=1.5,
    cir.axis=TRUE,cir.axis.col="black",cir.axis.grid=TRUE,conf.int=TRUE,
    conf.int.col=NULL,file.output=TRUE,file.name="",file=c("jpg","pdf",
    "tiff","png"),dpi=300,height=NULL,width=NULL,main="",main.cex=1.5,
    main.font=2,legend.ncol=NULL,legend.cex=1,
    legend.pos=c("left","middle","right"),box=FALSE,verbose=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Pmap</code></td>
<td>

<p>a dataframe, the first column is the name of genomic markers, the second column is the chromosome, the third column is the physical position, and the remaining columns are the P-values of each trait.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>

<p>a vector or a matrix, the color for chromosomes. If it is a vector, all traits use the same colors, it means that the same chromosome is drew in the same color across traits, and the length of colors are not fixed (1, 2, 3 or more colors can be used), if the length of the "col" is shorter than the number of chromosomes, then colors will be applied circularly. If "col" is a matrix, the number of row of which must be equal to the number of traits, the columns are the colors that users want to use for different traits, thus the chromosomes of each trait can be plotted in different number of colors, the missing value can be replaced by NA. For example: col=matrix(c("grey30","grey60",NA,"red","blue","green","orange",NA,NA),3,3,byrow=T).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bin.size</code></td>
<td>

<p>a integer, the size of bin in bp for marker density plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bin.breaks</code></td>
<td>

<p>a vector, set the breaks for the legend of density plot, e.g., seq(min, max, step), the windows in which the number of markers is out of the this range will be plotted in the same colors with the min or max value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LOG10</code></td>
<td>

<p>logical, whether to change the p-value into log10(p-value) scale.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>

<p>a integer, the shape for the points, is the same with "pch" in &lt;plot&gt;.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>a character, could be "p" (point), "l" (cross line), "h" (vertical lines) and so on, is the same with "type" in &lt;plot&gt;.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>band</code></td>
<td>

<p>a number, the size of space between chromosomes, the default is 1 (if the band equals to 0, then there would be no space between chromosomes).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>

<p>a number, the height for each circle, each circle represents a trait, the default is 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>

<p>vector (c(min, max)) or list, CMplot will only plot the points among this interval, it can be vector or list, if it is a list, different traits can be assigned with different range at y-axis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis.cex</code></td>
<td>

<p>a number, controls the size of ticks labels of X/Y-axis and the ticks labels of axis for circle plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis.lwd</code></td>
<td>

<p>a number, controls the thickness of X/Y-axis lines and the thickness of axis for circle plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lab.cex</code></td>
<td>

<p>a number, controls the size of labels of X/Y-axis and the labels of chromosomes for circle plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lab.font</code></td>
<td>

<p>a number, controls the font of labels of all axis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.type</code></td>
<td>

<p>a character or vector, only "d", "c", "m", "q" can be used. if plot.type="d", SNP density will be plotted; if plot.type="c", only circle-Manhattan plot will be plotted; if plot.type="m",only Manhattan plot will be plotted; if plot.type="q",only Q-Q plot will be plotted; if plot.type=c("m","q"), Both Manhattan and Q-Q plots will be plotted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>multracks</code></td>
<td>

<p>a logical, if TRUE, all Manhattan plots will be drew in one file.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>multracks.xaxis</code></td>
<td>

<p>a logical, if TRUE, all the traits will be added x-axis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>multraits</code></td>
<td>

<p>a logical, if TRUE, all traits will be plotted in one axis, and output one file.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>points.alpha</code></td>
<td>

<p>a number, the transparency of point for multiple traits plot, ranges from '0' (fully transparent) to '255' (opaque).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>

<p>a number, the radius for the circle (the inside radius), the default is 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>

<p>a number or a vector, the size for the points, is the same with "size" in &lt;plot&gt;, and if it is a vector, the first number controls the size of points in circle plot(the default is 0.5), the second number controls the size of points in Manhattan plot (the default is 1), the third number controls the size of points in Q-Q plot (the default is 1)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outward</code></td>
<td>

<p>logical, if TRUE, all points will be plotted from inside to outside for circular Manhattan plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>

<p>a character, the labels for y axis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab.pos</code></td>
<td>

<p>the distance between ylab and yaxis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xticks.pos</code></td>
<td>

<p>the distance between labels of x ticks and x axis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mar</code></td>
<td>

<p>the size of white gaps around the plot, 4 values should be provided, indicating the direction of bottom, left, up, and right.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mar.between</code></td>
<td>

<p>the distance between multiple plots for multiple tracks Manhattan plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>

<p>a number or vector or list, the significant threshold. For example, the Bonfferoni adjustment method: threshold=0.01/nrow(Pmap), more than one significant line can be added on the plots; if it is a list, each trait can be assigned with different thresholds, if threshold=0 or NULL, then the threshold line will not be added.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold.col</code></td>
<td>

<p>a character or vector, the color for the line of threshold levels, it can also control the color of the diagonal line of QQplot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold.lwd</code></td>
<td>

<p>a number or vector, the width for the line of threshold levels, it can also control the thickness of the diagonal line of QQplot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold.lty</code></td>
<td>

<p>a number or vector, the type for the line of threshold levels, it can also control the type of the diagonal line of QQplot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>amplify</code></td>
<td>

<p>logical, CMplot can amplify the significant points, if TRUE, then the points bigger than the minimal significant level will be amplified, the default: amplify=TRUE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>signal.cex</code></td>
<td>

<p>a number, if amplify=TRUE, users can set the size of significant points.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>signal.pch</code></td>
<td>

<p>a number, if amplify=TRUE, users can set the shape of significant points.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>signal.col</code></td>
<td>

<p>a character, if amplify=TRUE, users can set the colour of significant points, if signal.col=NULL, then the colors of significant points will not be changed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>signal.line</code></td>
<td>

<p>a number, the thickness of the lines of significant SNPs cross the circle.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>highlight</code></td>
<td>

<p>a vector or list, names of SNPs which need to be highlighted. vector for single trait and list for multiple traits.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>highlight.cex</code></td>
<td>

<p>a vector or list, the size of points for SNPs which need to be highlighted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>highlight.pch</code></td>
<td>

<p>a vector or list, the pch of points for SNPs which need to be highlighted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>highlight.type</code></td>
<td>

<p>a vector or list, the type of points for SNPs which need to be highlighted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>highlight.col</code></td>
<td>

<p>a vector or list, the col of points for SNPs which need to be highlighted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>highlight.text</code></td>
<td>

<p>a vector or list, the text which would be added around the highlighted SNPs.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>highlight.text.col</code></td>
<td>

<p>a vector or list, the color for added text.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>highlight.text.cex</code></td>
<td>

<p>a value, the size for added text.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>highlight.text.font</code></td>
<td>

<p>text font for the highlighted SNPs.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chr.labels</code></td>
<td>

<p>a vector, the labels for the chromosomes of density plot and Manhattan plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chr.border</code></td>
<td>

<p>a logical, whether to plot the dot line between chromosomes.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chr.labels.angle</code></td>
<td>

<p>a value, rotate tick labels of x-axis for Manhattan plot (-90 &lt; chr.labels.angle &lt; 90).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chr.pos.max</code></td>
<td>

<p>logical, whether the physical positions of each chromosome contain the maximum length of the chromosome.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chr.den.col</code></td>
<td>

<p>a character or vector or NULL, the colour for the SNP density. If the length of parameter 'chr.den.col' is bigger than 1, SNP density that counts the number of SNP within given size ('bin.size') will be plotted around the circle. If chr.den.col=NULL, the density bar will not be attached on the bottom of manhattan plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cir.band</code></td>
<td>

<p>a number, the space between circles, the default is 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cir.chr</code></td>
<td>

<p>logical, a boundary that represents chromosomes will be plotted on the periphery of a circle, the default is TRUE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cir.chr.h</code></td>
<td>

<p>a number, the width for the boundary, if cir.chr=FALSE, then this parameter will be useless.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cir.axis</code></td>
<td>

<p>a logical, whether to add the axis of each circle.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cir.axis.col</code></td>
<td>

<p>a character, the color of the axis for circle.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cir.axis.grid</code></td>
<td>

<p>logical, whether to add axis grid line in circles.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.int</code></td>
<td>

<p>logical, whether to plot confidence interval on QQ-plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.int.col</code></td>
<td>

<p>character or vector, the color of confidence interval of QQplot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file.output</code></td>
<td>

<p>a logical, users can choose whether to output the plot results.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file.name</code></td>
<td>

<p>a character or vector, the names of output files.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>

<p>a character, users can choose the different output formats of plot, so for, "jpg", "pdf", "tiff", and "png" can be selected by users. The "png" format has a transparent background.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dpi</code></td>
<td>

<p>a number, the picture resolution for '.jpg', '.npg', and '.tiff' files. The default is 300.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>height</code></td>
<td>

<p>the height of output files.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>

<p>the width of output files.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>

<p>character of vector, the title of the plot for manhattan plot and qqplot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main.cex</code></td>
<td>

<p>size of title.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main.font</code></td>
<td>

<p>font of title.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.ncol</code></td>
<td>

<p>number of column for the legend of multiple traits manhattan plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.cex</code></td>
<td>

<p>set the size of the legend text of trait name.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.pos</code></td>
<td>

<p>control the legend position of trait name on the plot, three options "left", "middle", "right" are available.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>box</code></td>
<td>

<p>logical, this function draws a box around the current plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>whether to print the log information.
</p>
</td>
</tr>
</table>
<h3>Details</h3>


<table>
<tr>
<td style="text-align: left;">
Package: </td>
<td style="text-align: left;"> CMplot</td>
</tr>
<tr>
<td style="text-align: left;">
Type: </td>
<td style="text-align: left;"> Package</td>
</tr>
<tr>
<td style="text-align: left;">
Version: </td>
<td style="text-align: left;"> 4.5.1</td>
</tr>
<tr>
<td style="text-align: left;">
Date: </td>
<td style="text-align: left;"> 2024-01-15</td>
</tr>
<tr>
<td style="text-align: left;">
License: </td>
<td style="text-align: left;"> GPL(&gt;=2)</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>Note</h3>

<p>1: In the data "Pmap", autosome and heterosome can both exist simultaneously, and heterosome can also be replaced by a number. <br>
2: only when the amplify=TRUE, then the parameter signal.cex, signal.pch, signal.col will be efficacious. <br>
3: In the circle Manhattan plot, traits will be plotted from inside to outside, it means that the first trait occupies the innermost circle. <br></p>


<h3>Author(s)</h3>

<p>LiLin-Yin <br>
Maintainer: LiLin-Yin &lt;<b>ylilin@163.com</b>&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R">
#plot rectangular Manhattan only one trait with 10000 markers:
data(pig60K)                        
CMplot(pig60K[sample(1:nrow(pig60K), 10000),c(1:4)],plot.type="m",
	  threshold=c(0.01,0.05)/nrow(pig60K),threshold.col=c('red','orange'),
	  multracks=FALSE, multraits=FALSE, chr.den.col=NULL, file.output=FALSE)

################################################################################
#plot circular Manhattan for all traits with all markers:                      #
################################################################################
#data(pig60K)                                                                  #         
#CMplot(pig60K,col=c("gray30","gray60"),r=0.5,plot.type="c",                   # 
#   threshold=0.01/nrow(pig60K),signal.col=NULL,outward=TRUE)                  #
################################################################################

</code></pre>


</div>