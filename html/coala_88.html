<div class="container">

<table style="width: 100%;"><tr>
<td>feat_selection</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Feature: Selection</h2>

<h3>Description</h3>

<p>This feature adds selection to a model. Only one site per locus can be under
selection. Using this feature requires that <code>msms</code> is installed, see
<code>activate_msms</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">feat_selection(
  strength_AA = 0,
  strength_Aa = 0,
  strength_aa = 0,
  strength_A = NULL,
  population = "all",
  time,
  start = TRUE,
  start_frequency = 5e-04,
  Ne = 10000,
  position = 0.5,
  force_keep = TRUE,
  locus_group = "all"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>strength_AA</code></td>
<td>
<p>The selection strength for the selected homozygote.
The parameter is valid for the chosen population and the time further
past-wards from either time 0 on if <code>start = TRUE</code>, or from <code>time</code>
onwards. The same applies for <code>strength_Aa</code>, <code>strength_aa</code> and
<code>strength_A</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strength_Aa</code></td>
<td>
<p>The selection strength for the heterozygote.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strength_aa</code></td>
<td>
<p>The selection strength for the recessive homozygote.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strength_A</code></td>
<td>
<p>This sets the strength for the selected allele in a
haploid model or a diploid model with additive selection.
<code>strength_AA</code>, <code>strength_Aa</code>, <code>strength_aa</code>
are ignored when this is argument is given.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>population</code></td>
<td>
<p>The population in which the allele is selected. Can either
be <code>all</code> for all population, or the number of a population.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>The time at which the selection starts if <code>start == TRUE</code>
(looking forwards in time), or the time at which the selection strength
changes if <code>start == FALSE</code>. The new strength applies for the time
period further into the past in this case.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>Whether selection should start at this time point. At this time,
the selected allele is introduced in the population with an initial
starting frequency. This must be set to <code>TRUE</code> for exactly one
selection feature in the model. The values of <code>start_frequency</code>,
<code>Ne</code>, <code>position</code> and <code>force_keep</code> are used for the model.
You can add additional selection feature to the model to set the
selection strength for more demes or change it at different time points,
but these need to have <code>start = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start_frequency</code></td>
<td>
<p>The start frequency at which the selected allele is
introduced at <code>time</code>. If the model has multiple population, this
can either be a numeric vector that contains the initial frequency for each
population or a single number. In the latter case, the value is used for
all population specified with <code>populations</code>, and 0 is used for all
other populations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ne</code></td>
<td>
<p>The effective population size that is used for the forward
simulations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>position</code></td>
<td>
<p>The position of the selected site, relative to the
simulated sequence. Values between 0 and 1 are within the simulated area,
while smaller values are to the left of it and larger ones to the right.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>force_keep</code></td>
<td>
<p>Whether to restart simulations in which the selected goes to
extinction or not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>locus_group</code></td>
<td>
<p>The loci for which this features is used. Can either be
<code>"all"</code> (default), in which case the feature is used for simulating
all loci, or a numeric vector. In the latter case, the feature is only
used for the loci added in <code>locus_</code> commands  with the corresponding
index starting from 1 in order in which the commands where added to the
model. For example, if a model has
<code>locus_single(10) + locus_averaged(10, 11) + locus_single(12)</code> and
this argument is <code>c(2, 3)</code>, than the feature is used for all but
the first locus (that is locus 2 - 12).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The feature, which can be added to a model created with
<code>coal_model</code> using <code>+</code>.
</p>


<h3>See Also</h3>

<p>For using rates that variate between the loci in a model:
<code>par_variation</code>, <code>par_zero_inflation</code>
</p>
<p>For summary statistics that are sensitive for selection:
<code>sumstat_tajimas_d</code>, <code>sumstat_ihh</code>,
<code>sumstat_omega</code>, <code>sumstat_mcmf</code>
</p>
<p>For creating a model: <code>coal_model</code>
</p>
<p>Other features: 
<code>feat_growth()</code>,
<code>feat_ignore_singletons()</code>,
<code>feat_migration()</code>,
<code>feat_mutation()</code>,
<code>feat_outgroup()</code>,
<code>feat_pop_merge()</code>,
<code>feat_recombination()</code>,
<code>feat_size_change()</code>,
<code>feat_unphased()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Positive additive selection in population 2:
model &lt;- coal_model(c(10, 13), 1, 10000) +
  feat_pop_merge(.5, 2, 1) +
  feat_selection(strength_A = 1000,
                 population = 2,
                 time = par_named("tau")) +
  feat_mutation(100) +
  feat_recombination(10) +
  sumstat_tajimas_d(population = 2)
## Not run: simulate(model, pars = c(tau = 0.03))
</code></pre>


</div>