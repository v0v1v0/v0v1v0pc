<div class="container">

<table style="width: 100%;"><tr>
<td>d.rel.conn.multiple</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Functions for estimating the probability distribution of relative 
connectivity values as a weighted sum over possible input parameters</h2>

<h3>Description</h3>

<p>These functions calculate the probability density function 
(<code>d.rel.conn.multiple</code>), the probability distribution function (aka the 
cumulative distribution function; <code>p.rel.conn.multiple</code>) and the 
quantile function (<code>q.rel.conn.multiple</code>) for the relative (to all 
settlers at the destination site) connectivity value for larval transport 
between a source and destination site. This version allows one to input 
multiple possible fractions of individuals (i.e., eggs) marked at the source 
site, multiple possible numbers of settlers collected and multiple possible 
marked individuals observed in the sample.  This gives one the possibility to
produce ensemble averages over different input parameter values with 
different probabilities of being correct.
</p>


<h3>Usage</h3>

<pre><code class="language-R">d.rel.conn.multiple(
  phi,
  ps,
  ks,
  ns,
  weights = 1,
  d.rel.conn = d.rel.conn.beta.prior,
  ...
)

p.rel.conn.multiple(
  phi,
  ps,
  ks,
  ns,
  weights = 1,
  p.rel.conn = p.rel.conn.beta.prior,
  ...
)

q.rel.conn.multiple.func(
  ps,
  ks,
  ns,
  weights = 1,
  p.rel.conn = p.rel.conn.beta.prior,
  N = 1000,
  ...
)

q.rel.conn.multiple(
  q,
  ps,
  ks,
  ns,
  weights = 1,
  p.rel.conn = p.rel.conn.beta.prior,
  N = 1000,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>Vector of fractions of individuals (i.e., eggs) from the source 
population settling at the destination population</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ps</code></td>
<td>
<p>Vector of fractions of individuals (i.e., eggs) marked in the 
source population</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ks</code></td>
<td>
<p>Vector of numbers of marked settlers found in sample</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ns</code></td>
<td>
<p>Vector of total numbers of settlers collected</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Vector of weights for each set of p, k and n values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d.rel.conn</code></td>
<td>
<p>Function to use to calculate probability density for 
individual combinations of <code>ps</code>, <code>ks</code> and <code>ns</code>. Defaults to 
<code>d.rel.conn.beta.prior</code>.  Could also be 
<code>d.rel.conn.unif.prior</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments for the function <code>d.rel.conn</code> or
<code>p.rel.conn</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.rel.conn</code></td>
<td>
<p>Function to use to calculate cumulative probability 
distribution for individual combinations of <code>ps</code>, <code>ks</code> and 
<code>ns</code>. Defaults to <code>p.rel.conn.beta.prior</code>. Could also be 
<code>p.rel.conn.unif.prior</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Number of points at which to estimate cumulative probability 
function for reverse approximation of quantile distribution. Defaults to 
<code>1000</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>Vector of quantiles</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>ps</code>, <code>ks</code>, <code>ns</code> and <code>weights</code> can be scalars or 
vectors of the same length (or lengths divisible into that of the largest 
input parameter).  <code>weights</code> are normalized to sum to 1 before being 
used to sum probabilities from each individual set of input parameters.
</p>


<h3>Value</h3>

<p>Vector of probabilities or quantiles, or a function in the case of 
<code>q.rel.conn.multiple.func</code>
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>d.rel.conn.multiple</code>: Estimates quantiles for the probability 
distribution function for relative connectivity between a pair of sites for
multiple possible <code>p</code>, <code>k</code> and <code>n</code> values.
</p>
</li>
<li> <p><code>p.rel.conn.multiple</code>: Estimates the cumulative probability
distribution for relative connectivity between a paire of sites for
multiple possible <code>p</code>, <code>k</code> and <code>n</code> values.
</p>
</li>
<li> <p><code>q.rel.conn.multiple.func</code>: Returns a function to estimate quantiles for
the probability distribution function for relative connectivity between a
pair of sites for multiple possible <code>p</code>, <code>k</code> and <code>n</code> values.
</p>
</li>
<li> <p><code>q.rel.conn.multiple</code>: Estimates quantiles for the probability 
distribution function for relative connectivity between a pair of sites for
multiple possible <code>p</code>, <code>k</code> and <code>n</code> values.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>David M. Kaplan <a href="mailto:dmkaplan2000@gmail.com">dmkaplan2000@gmail.com</a>
</p>


<h3>References</h3>

<p>Kaplan DM, Cuif M, Fauvelot C, Vigliola L, Nguyen-Huu T, Tiavouane J and Lett C 
(in press) Uncertainty in empirical estimates of marine larval connectivity. 
ICES Journal of Marine Science. doi:10.1093/icesjms/fsw182.
</p>


<h3>See Also</h3>

<p>Other connectivity estimation: 
<code>d.rel.conn.beta.prior()</code>,
<code>d.rel.conn.dists.func()</code>,
<code>d.rel.conn.finite.settlement()</code>,
<code>d.rel.conn.multinomial.unnorm()</code>,
<code>d.rel.conn.unif.prior()</code>,
<code>dual.mark.transmission()</code>,
<code>optim.rel.conn.dists()</code>,
<code>r.marked.egg.fraction()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(ConnMatTools)

# p values have uniform probability between 0.1 and 0.4
p &lt;- seq(0.1,0.8,length.out=100)

# Weights the same for all except first and last, which are halved
w &lt;- rep(1,length(p))
w[1]&lt;-0.5
w[length(w)]&lt;-0.5

n &lt;- 20 # Sample size
k &lt;- 2 # Marked individuals in sample

# phi values to use for plotting distribution
phi &lt;- seq(0,1,0.01)

prior.shape1 = 1 # Uniform prior
# prior.shape1 = 0.5 # Jeffreys prior

# Plot distribution
plot(phi,d.rel.conn.multiple(phi,p,k,n,w,prior.shape1=prior.shape1),
     main="Probability density for relative connectivity",
     xlab=expression(phi),
     ylab="Probability density",
     type="l")

# Add standard distributions for max and min p values
lines(phi,d.rel.conn.beta.prior(phi,min(p),k,n,prior.shape1=prior.shape1),
      col="red",lty="dashed")
lines(phi,d.rel.conn.beta.prior(phi,max(p),k,n,prior.shape1=prior.shape1),
      col="red",lty="dashed")

# Add some quantiles
q = q.rel.conn.multiple(c(0.025,0.25,0.5,0.75,0.975),
                        p,k,n,w,prior.shape1=prior.shape1)
abline(v=q,col="green")
</code></pre>


</div>