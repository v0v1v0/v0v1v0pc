<div class="container">

<table style="width: 100%;"><tr>
<td>vcr.da.train</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Carry out discriminant analysis on training data, and prepare to visualize its results.
</h2>

<h3>Description</h3>

<p>Custom DA function which prepares for graphical displays such as the <code>classmap</code>. The disciminant analysis itself is carried out by the maximum a posteriori rule, which maximizes the density of the mixture.
</p>


<h3>Usage</h3>

<pre><code class="language-R">vcr.da.train(X, y, rule = "QDA", estmethod = "meancov")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a numerical matrix containing the predictors in its columns. Missing values are not allowed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a factor with the given class labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rule</code></td>
<td>
<p>either "<code>QDA</code>" for quadratic discriminant analysis or "<code>LDA</code>"  for linear discriminant analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estmethod</code></td>
<td>
<p>function for location and covariance estimation.
Should return a list with the center <code>$m</code> and the covariance matrix <code>$S</code>. The default is <code>"meancov"</code> (classical mean and covariance matrix), and the option <code>"DetMCD"</code> (based on <code>robustbase::covMcd</code>) is also provided.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with components: <br></p>
<table>
<tr style="vertical-align: top;">
<td><code>yint</code></td>
<td>
<p>number of the given class of each case. Can contain <code>NA</code>'s.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>given class label of each case. Can contain <code>NA</code>'s.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>levels</code></td>
<td>
<p>levels of <code>y</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predint</code></td>
<td>
<p>predicted class number of each case. For each case this is the class with the highest posterior probability. Always exists.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred</code></td>
<td>
<p>predicted label of each case.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>altint</code></td>
<td>
<p>number of the alternative class. Among the classes different from the given class, it is the one with the highest posterior probability. Is <code>NA</code> for cases whose <code>y</code> is missing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>altlab</code></td>
<td>
<p>label of the alternative class. Is <code>NA</code> for cases whose <code>y</code> is missing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PAC</code></td>
<td>
<p>probability of the alternative class. Is <code>NA</code> for cases whose <code>y</code> is missing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>figparams</code></td>
<td>
<p>parameters for computing <code>fig</code>, can be used for new data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fig</code></td>
<td>
<p>distance of each case <code class="reqn">i</code> from each class <code class="reqn">g</code>. Always exists.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>farness</code></td>
<td>
<p>farness of each case from its given class. Is <code>NA</code> for cases whose <code>y</code> is missing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ofarness</code></td>
<td>
<p>for each case <code>i</code>, its lowest  <code>fig[i,g]</code> to any class <code>g</code>. Always exists.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>classMS</code></td>
<td>
<p>list with center and covariance matrix of each class</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lCurrent</code></td>
<td>
<p>log of mixture density of each case in its given class. Is <code>NA</code> for cases with missing <code>y</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lPred</code></td>
<td>
<p>log of mixture density of each case in its predicted class. Always exists.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lAlt</code></td>
<td>
<p>log of mixture density of each case in its alternative class. Is <code>NA</code> for cases with missing <code>y</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Raymaekers J., Rousseeuw P.J.
</p>


<h3>References</h3>

<p>Raymaekers J., Rousseeuw P.J., Hubert M. (2021). Class maps for visualizing classification results. <em>Technometrics</em>, appeared online. doi: <a href="https://doi.org/10.1080/00401706.2021.1927849">10.1080/00401706.2021.1927849</a>(link to open access pdf)
</p>


<h3>See Also</h3>

<p><code>vcr.da.newdata</code>, <code>classmap</code>, <code>silplot</code>, <code>stackedplot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data("data_floralbuds")
X &lt;- data_floralbuds[, 1:6]; y &lt;- data_floralbuds[, 7]
vcrout &lt;- vcr.da.train(X, y, rule = "QDA")
# For linear discriminant analysis, put rule = "LDA".
confmat.vcr(vcrout) # There are a few outliers
cols &lt;- c("saddlebrown", "orange", "olivedrab4", "royalblue3")
stackedplot(vcrout, classCols = cols)
classmap(vcrout, "bud", classCols = cols)

# For more examples, we refer to the vignette:
## Not run: 
vignette("Discriminant_analysis_examples")

## End(Not run)
</code></pre>


</div>