<div class="container">

<table style="width: 100%;"><tr>
<td>coxerr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cox regression with dependent error in covariates</h2>

<h3>Description</h3>

<p>Estimation methods of Huang and Wang (2018)</p>


<h3>Usage</h3>

<pre><code class="language-R">coxerr(t,dlt,wuz,method,initbt=rep(0,dim(as.matrix(wuz))[2]-1),
       derr=1e-6)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>follow-up time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dlt</code></td>
<td>
<p>censoring indicator: 1 - event, 0 - censored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wuz</code></td>
<td>
<p>covariate-related variables: wuz[,1] -  mismeasured,
wuz[,2] - instrumental variable (IV),
wuz[,-c(1,2)] - accurately measured.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>estimation method: 1 - Prop1, 2 - Prop 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initbt</code></td>
<td>
<p>initial value for the estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>derr</code></td>
<td>
<p>error tolerance.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>bt</code></td>
<td>
<p>point estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>va</code></td>
<td>
<p>estimated variance-covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>succ</code></td>
<td>
<p>indicator for estimate-finding success.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Yijian Huang</p>


<h3>References</h3>

<p>Huang, Y. and Wang, C. Y. (2018) Cox Regression with dependent
error in covariates, <em>Biometrics</em> 74, 118â€“126.</p>


<h3>Examples</h3>

<pre><code class="language-R">## simulate a dataset following Scenario 1 of Table 1 in Huang and Wang (2018)
size &lt;- 300
bt0 &lt;- 1

## true covariate
x &lt;- rnorm(size)

## survival time, censoring time, follow-up time, censoring indicator
s &lt;- rexp(size) * exp(-bt0 * x)
c &lt;- runif(size) * ifelse(x &lt;= 0, 4.3, 8.6)
t &lt;- pmin(s, c)
dlt &lt;- as.numeric(s &lt;= c)

## mismeasured covariate with heterogeneous error, IV
w &lt;- x + rnorm(size) * sqrt(pnorm(x) * 2) * 0.5 + 1
u &lt;- x * 0.8 + rnorm(size) * 0.6
wuz &lt;- cbind(w, u)

## estimation using PROP1
fit1 &lt;- coxerr(t, dlt, wuz, 1)
## estimation using PROP2
fit2 &lt;- coxerr(t, dlt, wuz, 2)
</code></pre>


</div>