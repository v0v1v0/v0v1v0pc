<div class="container">

<table style="width: 100%;"><tr>
<td>cp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Control Polygons</h2>

<h3>Description</h3>

<p>Generate the control polygon for a uni-variable B-spline
</p>


<h3>Usage</h3>

<pre><code class="language-R">cp(x, ...)

## S3 method for class 'cpr_bs'
cp(x, theta, ...)

## S3 method for class 'formula'
cp(
  formula,
  data,
  method = stats::lm,
  method.args = list(),
  keep_fit = TRUE,
  check_rank = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a <code>cpr_bs</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>pass through</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>a vector of (regression) coefficients, the ordinates of the control polygon.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula that is appropriate for regression method being used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a required <code>data.frame</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the regression method such as <code>lm</code>,
<code>glm</code>, <code>lmer</code>, etc.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method.args</code></td>
<td>
<p>a list of additional arguments to pass to the regression
method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep_fit</code></td>
<td>
<p>(logical, default value is <code>TRUE</code>).  If <code>TRUE</code> the
regression model fit is retained and returned in as the <code>fit</code> element.
If <code>FALSE</code> the <code>fit</code> element with be <code>NA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check_rank</code></td>
<td>
<p>(logical, defaults to <code>TRUE</code>) if <code>TRUE</code> check
that the design matrix is full rank.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>cp</code> generates the control polygon for the given B-spline function.
</p>


<h3>Value</h3>

<p>a <code>cpr_cp</code> object, this is a list with the element <code>cp</code>, a
data.frame reporting the x and y coordinates of the control polygon.
Additional elements include the knot sequence, polynomial order, and other
meta data regarding the construction of the control polygon.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Support
xvec &lt;- runif(n = 500, min = 0, max = 6)
bknots &lt;- c(0, 6)

# Define the basis matrix
bmat1 &lt;- bsplines(x = xvec, iknots = c(1, 1.5, 2.3, 4, 4.5), bknots = bknots)
bmat2 &lt;- bsplines(x = xvec, bknots = bknots)

# Define the control vertices ordinates
theta1 &lt;- c(1, 0, 3.5, 4.2, 3.7, -0.5, -0.7, 2, 1.5)
theta2 &lt;- c(1, 3.4, -2, 1.7)

# build the two control polygons
cp1 &lt;- cp(bmat1, theta1)
cp2 &lt;- cp(bmat2, theta2)

# black and white plot
plot(cp1)
plot(cp1, show_spline = TRUE)

# multiple control polygons
plot(cp1, cp2, show_spline = TRUE)
plot(cp1, cp2, color = TRUE)
plot(cp1, cp2, show_spline = TRUE, color = TRUE)

# via formula
DF  &lt;- data.frame(x = xvec, y = sin((xvec - 2)/pi) + 1.4 * cos(xvec/pi))
cp3 &lt;- cp(y ~ bsplines(x, bknots = bknots), data = DF)

# plot the spline and target data.
plot(cp3, show_cp = FALSE, show_spline = TRUE) +
  ggplot2::geom_line(mapping = ggplot2::aes(x = x, y = y, color = "Target"),
                     data = DF, linetype = 2)

</code></pre>


</div>