<div class="container">

<table style="width: 100%;"><tr>
<td>CDW</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cardinal Dates Using Fitted Weibull Curves</h2>

<h3>Description</h3>

<p>CDW (cardinal dates using Weibull curves) extracts “cardinal dates” from
fitted four- and six-parametric Weibull curves.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CDW(p, xmin = 0, xmax = 365, quantile = 0.05, symmetric = FALSE)

CDWa(p, xmin = 0, xmax = 365, quantile = 0.05, symmetric = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>object of class <code>cardiFit</code> returned by <code>fitweibull6</code> or
<code>fitweibull4</code> or parameter vector of the fitted Weibull function,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xmin</code></td>
<td>
<p>left boundary (in day of year) of the integral under the curve,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xmax</code></td>
<td>
<p>right boundary (in day of year) of the integral under the curve,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quantile</code></td>
<td>
<p>two-sided quantile (percentage of integral)
which defines beginning and end of the peak,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>symmetric</code></td>
<td>
<p>if (<code>TRUE</code>), quantiles are calculated for the whole area
under the curve, otherwise for each of the branches separately.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>CDW</code> is a numerically improved version of the algorithm
described in Rolinski et al. (2007). Version <code>CDWa</code> is an alternative,
simplified version which sets the baseline before and after the peak to zero
using appropriate offset parameters <code>p[1]</code> and <code>p[4]</code>. 
The original method described by Rolinski et al. 2007 (here called <code>CDW</code>)
shifts the function for the left and right branch separately
in the asymmetric case.
</p>


<h3>Value</h3>

<p>A list with components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>x values of cardinal dates <code>tMid</code>, <code>tBegin</code>, <code>tEnd</code>,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>the corresponding y values (divided by ymax),</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>parameters of the fitted Weibull function</p>
</td>
</tr>
</table>
<h3>See Also</h3>


<p><code>weibull4</code>,
<code>weibull6</code>,
<code>fitweibull</code>,
<code>peakwindow</code>,

<code>metaCDW</code>,
<code>cardidates</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## create some test data
set.seed(123)
x &lt;- seq(0, 360, length = 20)
y &lt;- abs(rnorm(20, mean = 1, sd = 0.1))
y[5:10] &lt;- c(2, 4, 7, 3, 4, 2)

## fit Weibull function with 6 free parameters
res &lt;- fitweibull6(x, y)

## show some properties
res$r2
p &lt;- res$p
o &lt;- res$fit
f &lt;- res$ymax

## identify cardinal dates from fitted curves
(smd  &lt;- CDW(p))
(smda &lt;- CDW(p, symmetric = FALSE))

## plot data, curve and cardinal dates
plot(x, y, ylim=c(0, 10), xlim = c(0, 365))
lines(o$x, o$f * f)
points(x, fweibull6(x, p) * f, col = "green")
points(smd$x, fweibull6(smd$x, p) * f, col = "orange", pch = 16)
points(smda$x, fweibull6(smda$x, p) * f, col = "red", pch = 1, cex = 1.2)

## for comparison: additional fit of a 4 parameter Weibull
res4  &lt;- fitweibull4(x, y)
res4$r2
p &lt;- res4$p
o &lt;- res4$fit
f &lt;- res4$ymax
smd  &lt;- CDW(p)
lines(o$x, o$f * f, col = "blue")
points(smd$x, fweibull4(smd$x, p) * f, col = "blue", pch = 16)
</code></pre>


</div>