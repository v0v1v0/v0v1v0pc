<div class="container">

<table style="width: 100%;"><tr>
<td>circ_loess</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>An implementation of circular-linear locally-weighted regression (LOESS)
<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
</h2>

<h3>Description</h3>

<p>Provides an locally-weighted average when the independent variable is circular and depended variable is linear. Mainly to use with ggplot2.
</p>


<h3>Usage</h3>

<pre><code class="language-R">circ_loess(
  formula = NULL,
  data = NULL,
  angle = NULL,
  y = NULL,
  xseq = NULL,
  circ_space = NULL,
  span = 0.75,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>the formula, e.g., y ~ x</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data to use</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>angle</code></td>
<td>
<p>a vector of angles (not used if a formula is provided)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>dependent variable vector (not used if a formula is provided)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xseq</code></td>
<td>
<p>a grid to compute predictions on (optional, the default is to use 500 points spanning the circle)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>circ_space</code></td>
<td>
<p>circular space to use (90, 180, 360, or 2*pi)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>span</code></td>
<td>
<p>a span to adjust the degree of smoothing</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments (ignored)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Weights for the regression are computed as
\[w = (1-(d/d_{max})^3)^3\]
where <em>d</em> is the angular difference between the point at which the estimate is computed and the angles in the data, and \(d_{max}\) is the maximum possible distance. If <code>span</code> is above 1, all points are included and \(d_{max} = {circ\_space}/(4*span)\). Otherwise, a proportion \(\alpha\) of the points included based on their distance to the point at which the estimate is computed and \(d_{max}\) is the corresponding maximal distance.
</p>


<h3>Value</h3>

<p>an object of <code>circ_loess</code> class with the following parameters:
</p>

<ul>
<li> <p><code>angle</code> the angles in the data
</p>
</li>
<li> <p><code>y</code> the dependent variable vales in the data
</p>
</li>
<li> <p><code>xseq</code> the grid on which the loess values are estimated
</p>
</li>
<li> <p><code>y_est</code> the estimated loess values
</p>
</li>
<li> <p><code>y_se</code> standard errors
</p>
</li>
<li> <p><code>w</code> weights
</p>
</li>
<li> <p><code>circ_space</code> circular space used
</p>
</li>
<li> <p><code>span</code> span used
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>stats::loess()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">p &lt;- ggplot(Pascucci_et_al_2019_data, aes(x = orientation, y = err)) +
  geom_point(alpha = 0.05) +
  labs(x = "Orientation, deg.", y = "Error, deg.")
p1 &lt;- p + geom_smooth(method = "loess") + ggtitle("Standard LOESS")
p2 &lt;- p + geom_smooth(method = "circ_loess", method.args = list(circ_space = 180, span = 0.5)) +
  ggtitle("Circular LOESS, span = 0.5")
p3 &lt;- p + geom_smooth(method = "circ_loess", method.args = list(circ_space = 180, span = 0.2)) +
  ggtitle("Circular LOESS, span = 0.2")
(p1 + p2 + p3)

</code></pre>


</div>