<div class="container">

<table style="width: 100%;"><tr>
<td>ciu.textual</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Give textual CIU explanation</h2>

<h3>Description</h3>

<p>Provide textual CIU explanations as those used in Kary Fr√§mling's
PhD thesis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ciu.textual(
  ciu,
  instance = NULL,
  ind.inputs = NULL,
  ind.output = 1,
  in.min.max.limits = NULL,
  n.samples = 100,
  neutral.CU = 0.5,
  show.input.values = TRUE,
  concepts.to.explain = NULL,
  target.concept = NULL,
  target.ciu = NULL,
  ciu.meta = NULL,
  sort = "CI",
  n.features = NULL,
  use.text.effects = FALSE,
  CI.voc = data.frame(limits = c(0.2, 0.4, 0.6, 0.8, 1), texts = c("not important",
    "slightly important", "important", "very important", "extremely important")),
  CU.voc = data.frame(limits = c(0.2, 0.4, 0.6, 0.8, 1), texts = c("very bad", "bad",
    "average", "good", "very good"))
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ciu</code></td>
<td>
<p><code>ciu</code> object as created with ciu function (not to be confused
with <code>CIU</code> object as created by ciu.new).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>instance</code></td>
<td>
<p>Input values for the instance to explain. Should be a
data.frame even though a <code>vector</code> or <code>matrix</code> might work too if input
names and other needed metadata can be deduced from the dataset or other
parameters given to <code>ciu.new</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ind.inputs</code></td>
<td>
<p>Indices of input features to explain (the set i in CIU
formulae)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ind.output</code></td>
<td>
<p>Index of output to be explained.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>in.min.max.limits</code></td>
<td>
<p>data.frame or matrix with one row per output
and two columns, where the first column indicates the minimal value and the
second column the maximal value for that output. ONLY NEEDED HERE IF not
given as parameter to ciu.new or if the limits are different for this
specific instance than the default ones.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.samples</code></td>
<td>
<p>How many instances to generate for estimating CI and CU.
For inputs of type factor, all possible combinations of input values
are generated, so this parameter only influences how many instances are
(at least) generated for continuous-valued inputs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>neutral.CU</code></td>
<td>
<p>Indicates when the Contextual Utility is considered
to be "negative". The default value of 0.5 seems quite logical for most cases.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.input.values</code></td>
<td>
<p>Include input values after input labels or not.
Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>concepts.to.explain</code></td>
<td>
<p>List of input feature concepts to explain, as defined
by vocabulary provided as argument to ciu.new. If <code>ind.inputs=NULL</code>,
then use <code>concepts.to.explain</code> instead. If both are <code>NULL</code>, then use all inputs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target.concept</code></td>
<td>
<p>If provided, then calculate CIU of inputs
<code>ind.inputs.to.explain</code> relative to the given concept rather than
relative to the actual output(s). <code>ind.inputs.to.explain</code> should
normally be a subset (or all) of the inputs that <code>target.concept</code>
consists of, even though that not required by the CIU calculation.
If a <code>target.ciu</code> is provided, then the <code>target.concept</code> doesn't have to
be included in the <code>vocabulary</code> gives as parameter to ciu.new
(at least for the moment).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target.ciu</code></td>
<td>
<p><code>ciu.result</code> object previously calculated for
<code>target.concept</code>. If a <code>target.concept</code> is provided but <code>target.ciu=NULL</code>,
then <code>target.ciu</code> is estimated by a call to ciu.explain with the
<code>n.samples</code> value given as a parameter to this call. It may be useful
to provide <code>target.ciu</code> if it should be estimated using some other
(typically greater) value for <code>n.samples</code> than the default one, or if it
has already been calculated for some reason.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ciu.meta</code></td>
<td>
<p>If given, then use existing <code>ciu.meta.result</code> rather
than calling ciu.meta.explain.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sort</code></td>
<td>
<p>NULL, "CI" or "CU".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.features</code></td>
<td>
<p>Maximal number of features to include in explanation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.text.effects</code></td>
<td>
<p>Add bold/italics/colors effects?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI.voc</code></td>
<td>
<p>Limits and texts to use for CI values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CU.voc</code></td>
<td>
<p>Limits and texts to use for CU values.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Text string with explanation.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Explaining the classification of an Iris instance with lda model.
# We use a versicolor (instance 100).
library(MASS)
test.ind &lt;- 100
iris_test &lt;- iris[test.ind, 1:4]
iris_train &lt;- iris[-test.ind, 1:4]
iris_lab &lt;- iris[[5]][-test.ind]
model &lt;- lda(iris_train, iris_lab)

# Create CIU object
ciu &lt;- ciu.new(model, Species~., iris)

# Give textual explanation. Use 'cat' for getting newlines to work.
cat(ciu.textual(ciu, iris_test, ind.output = 2))
cat(ciu.textual(ciu, iris_test, ind.output = 2, n.features = 2))

## Not run: 
# Boston housing, GBM model.
library(caret)
kfoldcv &lt;- trainControl(method="cv", number=10)
gbm &lt;- train(medv ~ ., Boston, method="gbm", trControl=kfoldcv)
boston.inst &lt;- Boston[370,1:13]
ciu &lt;- ciu.new(gbm, medv~., Boston)
cat(ciu.textual(ciu, boston.inst,use.text.effects = TRUE))
# Customized limits for CI.
cat(ciu.textual(ciu, boston.inst,use.text.effects = TRUE,
  CI.voc = data.frame(limits=c(0.05,0.1,0.3,0.5,1.0),
texts=c("not important","little important", "important","very important",
  "extremely important"))))

# Intermediate concepts
social&lt;-c(1,11,13); usage_type&lt;-c(2,3); chas&lt;-c(4); air_quality&lt;-c(5)
housing&lt;-c(6,7); transport&lt;-c(8,9); blacks&lt;-c(12); tax&lt;-c(10)
Boston.voc &lt;- list("SOCIAL"=social, "LAND USAGE"=usage_type, "Charles R. dummy"=chas,
"Air quality (Nox)"=air_quality, "HOUSING"=housing, "TRANSPORT"=transport,
"Prop. of black people"=blacks, "Tax"=tax)
ciu &lt;- ciu.new(gbm, medv~., Boston, vocabulary = Boston.voc)

# We use `meta.explain` here to avoid differences due to sampling.
meta.top &lt;- ciu$meta.explain(boston.inst, concepts.to.explain=names(Boston.voc))
cat(ciu.textual(ciu, boston.inst, use.text.effects = TRUE, ciu.meta = meta.top))

# Explain intermediate concept utility, using input features (could also
# be using other intermediate concepts).
cat(ciu.textual(ciu, boston.inst, use.text.effects = TRUE, ind.inputs = Boston.voc$SOCIAL,
  target.concept = "SOCIAL", target.ciu = meta.top$ciuvals[["SOCIAL"]]))
cat(ciu.textual(ciu, boston.inst, use.text.effects = TRUE, ind.inputs = Boston.voc$HOUSING,
  target.concept = "HOUSING", target.ciu = meta.top$ciuvals[["HOUSING"]]))

## End(Not run)
</code></pre>


</div>