<div class="container">

<table style="width: 100%;"><tr>
<td>ls_fit_sum_of_ultrametrics</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Least Squares Fit of Sums of Ultrametrics to Dissimilarities</h2>

<h3>Description</h3>

<p>Find a sequence of ultrametrics with sum minimizing square distance
(Euclidean dissimilarity) to a given dissimilarity object.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ls_fit_sum_of_ultrametrics(x, nterms = 1, weights = 1,
                           control = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a dissimilarity object inheriting from or coercible to class
<code>"dist"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nterms</code></td>
<td>
<p>an integer giving the number of ultrametrics to be
fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>a numeric vector or matrix with non-negative weights
for obtaining a weighted least squares fit.  If a matrix, its
numbers of rows and columns must be the same as the number of
objects in <code>x</code>, and the lower diagonal part is used.
Otherwise, it is recycled to the number of elements in <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list of control parameters.  See <b>Details</b>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The problem to be solved is minimizing the criterion function
</p>
<p style="text-align: center;"><code class="reqn">L(u(1), \dots, u(n)) =
    \sum_{i,j} w_{ij} \left(x_{ij} - \sum_{k=1}^n u_{ij}(k)\right)^2</code>
</p>

<p>over all <code class="reqn">u(1), \ldots, u(n)</code> satisfying the ultrametric
constraints.
</p>
<p>We provide an implementation of the iterative heuristic suggested in
Carroll &amp; Pruzansky (1980) which in each step <code class="reqn">t</code> sequentially
refits the <code class="reqn">u(k)</code> as the least squares ultrametric fit to the
“residuals” <code class="reqn">x - \sum_{l \ne k} u(l)</code> using
<code>ls_fit_ultrametric</code>.
</p>
<p>Available control parameters include
</p>

<dl>
<dt><code>maxiter</code></dt>
<dd>
<p>an integer giving the maximal number of
iteration steps to be performed.
Defaults to 100.</p>
</dd>
<dt><code>eps</code></dt>
<dd>
<p>a nonnegative number controlling the iteration,
which stops when the maximal change in all <code class="reqn">u(k)</code> is less than
<code>eps</code>.
Defaults to <code class="reqn">10^{-6}</code>.</p>
</dd>
<dt><code>reltol</code></dt>
<dd>
<p>the relative convergence tolerance.  Iteration
stops when the relative change in the criterion function is less
than <code>reltol</code>.
Defaults to <code class="reqn">10^{-6}</code>.</p>
</dd>
<dt><code>method</code></dt>
<dd>
<p>a character string indicating the fitting
method to be employed by the individual least squares fits.</p>
</dd>
<dt><code>control</code></dt>
<dd>
<p>a list of control parameters to be used by the
method of <code>ls_fit_ultrametric</code> employed.  By default,
if the <abbr><span class="acronym">SUMT</span></abbr> method method is used, 10 inner
<abbr><span class="acronym">SUMT</span></abbr> runs are performed for each refitting.</p>
</dd>
</dl>
<p>It should be noted that the method used is a heuristic which can not
be guaranteed to find the global minimum.
</p>


<h3>Value</h3>

<p>A list of objects of class <code>"cl_ultrametric"</code> containing
the fitted ultrametric distances.
</p>


<h3>References</h3>

<p>J. D. Carroll and S. Pruzansky (1980).
Discrete and hybrid scaling models.
In E. D. Lantermann and H. Feger (eds.), <em>Similarity and Choice</em>.
Bern (Switzerland): Huber.
</p>


</div>