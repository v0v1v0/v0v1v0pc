<div class="container">

<table style="width: 100%;"><tr>
<td>icp.torus</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Conformity score for inductive prediction sets</h2>

<h3>Description</h3>

<p><code>icp.torus</code> prepares all values
for computing the conformity score for specified methods.
</p>
<p><code>plot.icp.torus</code> plots <code>icp.torus</code> object with some options.
</p>


<h3>Usage</h3>

<pre><code class="language-R">icp.torus(
  data,
  split.id = NULL,
  model = c("kmeans", "kde", "mixture"),
  mixturefitmethod = c("axis-aligned", "circular", "general"),
  kmeansfitmethod = c("general", "homogeneous-circular", "heterogeneous-circular",
    "ellipsoids"),
  init = c("hierarchical", "kmeans"),
  d = NULL,
  additional.condition = TRUE,
  J = 4,
  concentration = 25,
  kmax = 500,
  THRESHOLD = 1e-10,
  maxiter = 200,
  verbose = TRUE,
  ...
)

## S3 method for class 'icp.torus'
logLik(object, ...)

## S3 method for class 'icp.torus'
predict(object, newdata, ...)

## S3 method for class 'icp.torus'
plot(
  x,
  data = NULL,
  level = 0.1,
  ellipse = TRUE,
  out = FALSE,
  type = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>n x d matrix of toroidal data on <code class="reqn">[0, 2\pi)^d</code>
or <code class="reqn">[-\pi, \pi)^d</code>. Default is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>split.id</code></td>
<td>
<p>a n-dimensional vector consisting of values 1 (estimation)
and 2(evaluation)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>A string. One of "kde", "mixture", and "kmeans" which
determines the model or estimation methods. If "kde", the model is based
on the kernel density estimates. It supports the kde-based conformity score
only. If "mixture", the model is based on the von Mises mixture, fitted
with an EM algorithm. It supports the von Mises mixture and its variants
based conformity scores. If "kmeans", the model is also based on the von
Mises mixture, but the parameter estimation is implemented with the
elliptical k-means algorithm illustrated in Appendix. It supports the
log-max-mixture based conformity score only. If the
dimension of data space is greater than 2, only "kmeans" is supported.
Default is <code>model = "kmeans"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mixturefitmethod</code></td>
<td>
<p>A string. One of "circular", "axis-aligned", and
"general" which determines the constraint of the EM fitting. Default is
"axis-aligned". This argument only works for <code>model = "mixture"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kmeansfitmethod</code></td>
<td>
<p>A string. One of "general", ellipsoids",
"heterogeneous-circular" or "homogeneous-circular". If "general", the
elliptical k-means algorithm with no constraint is used. If "ellipsoids",
only the one iteration of the algorithm is used. If"heterogeneous-circular",
the same as above, but with the constraint that ellipsoids must be spheres.
If "homogeneous-circular", the same as above but the radii of the spheres are
identical. Default is "general". This argument only works for <code>model = "kmeans"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>Methods for choosing initial values of "kmeans" fitting.
Must be "hierarchical" or "kmeans". If "hierarchical", the initial
parameters are obtained with hierarchical clustering method.
If "kmeans", the initial parameters are obtained with extrinsic k-means method.
Additional arguments for k-means clustering and hierarchical clustering can be designated
via argument <code>...</code>. If no options are designated, <code>nstart=1</code> for <code>init="kmeans"</code>
and <code>method="complete"</code> for <code>init="hierarchical"</code> are used. Default is "hierarchical".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>pairwise distance matrix(<code>dist</code> object) for <code>init = "hierarchical"</code>,
which used in hierarchical clustering. If <code>init = "hierarchical"</code> and <code>d = NULL</code>,
<code>d</code> will be automatically filled with <code>ang.pdist(data)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>additional.condition</code></td>
<td>
<p>boolean index.
If <code>TRUE</code>, a singular matrix will be altered to the scaled identity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>J</code></td>
<td>
<p>A scalar or numeric vector for the number(s) of components for <code>model = c("mixture", "kmeans")</code>.
Default is <code>J = 4</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>concentration</code></td>
<td>
<p>A scalar or numeric vector for the concentration parameter(s) for <code>model = "kde"</code>.
Default is <code>concentration = 25</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kmax</code></td>
<td>
<p>the maximal number of kappa. If estimated kappa is
larger than <code>kmax</code>, then put kappa as <code>kmax</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>THRESHOLD</code></td>
<td>
<p>number for difference between updating and
updated parameters. Default is 1e-10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>the maximal number of iteration. Default is 200.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>boolean index, which indicates whether display
additional details as to what the algorithm is doing or
how many loops are done. Moreover, if <code>additional.condition</code> is
<code>TRUE</code>, the warning message will be reported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters. For plotting icp.torus, these parameters are for ggplot2::ggplot().</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p><code>icp.torus</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>n x d matrix of toroidal data on <code class="reqn">[0, 2\pi)^d</code>.
Dimension d must be the same as data used for <code>icp.torus</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p><code>icp.torus</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>either a numeric scalar or a vector in <code class="reqn">[0,1]</code>. Default value is 0.1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ellipse</code></td>
<td>
<p>A boolean index which determines whether plotting ellipses from
mixture models. Default is <code>TRUE</code>. (This option is used only when the
<code>icp.torus</code> object <code>x</code> is fitted by model <code>kmeans</code> or <code>mixture</code>.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out</code></td>
<td>
<p>An option for returning the ggplot object. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>A string. One of "mix", "max" or "e". This argument is only available if <code>icp.torus</code>
object is fitted with <code>model = "mixture"</code>. Default is <code>NULL</code>. If <code>type != NULL</code>, argument
<code>ellipse</code> automatically becomes <code>FALSE</code>. If "mix", it plots based on von Mises mixture.
If "max", it plots based on von Mises max-mixture. If "e", it plots based on ellipse-approximation.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>icp.torus</code> returns an <code>icp.torus</code> object, containing all values
to compute the conformity score (if <code>J</code> or <code>concentration</code> is a
single value). if <code>J</code> or <code>concentration</code> is a vector containing
multiple values, then <code>icp.torus</code> returns a list of <code>icp.torus</code> objects
</p>


<h3>References</h3>

<p>Jung, S., Park, K., &amp; Kim, B. (2021). Clustering on the torus by conformal prediction. <em>The Annals of Applied Statistics</em>, 15(4), 1583-1603.
</p>
<p>Mardia, K. V., Kent, J. T., Zhang, Z., Taylor, C. C., &amp; Hamelryck, T. (2012). Mixtures of concentrated multivariate sine distributions with applications to bioinformatics. <em>Journal of Applied Statistics</em>, 39(11), 2475-2492.
</p>
<p>Di Marzio, M., Panzera, A., &amp; Taylor, C. C. (2011). Kernel density estimation on the torus. <em>Journal of Statistical Planning and Inference</em>, 141(6), 2156-2173.
</p>
<p>Shin, J., Rinaldo, A., &amp; Wasserman, L. (2019). Predictive clustering. <em>arXiv preprint arXiv:1903.08125</em>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data &lt;- toydata1[, 1:2]

icp.torus &lt;- icp.torus(data, model = "kmeans",
                       kmeansfitmethod = "general",
                       J = 4, concentration = 25)

</code></pre>


</div>