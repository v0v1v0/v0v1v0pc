<div class="container">

<table style="width: 100%;"><tr>
<td>fitVolDist</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit a model for cell volume distribution under least squares criteria.</h2>

<h3>Description</h3>

<p>This function fits a model for cell volume distribution
under least squares criteria; free model parameters are the cell
growth rate <code>r</code> (<code class="reqn">\mu m^3/h</code>), the variability in cell growth rate
<code>sigma_r</code> (<code class="reqn">\mu m^3/h</code>) and a linear scaling factor <code>A</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitVolDist(vol, freq, r = 100, sigma_r = 44, t = 40,
           sigma_t = 0.3 * t, maxiter = 100, nprint = 1,
           alg="leastsq")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>vol</code></td>
<td>
<p>a vector of numeric values representing volumes (<code class="reqn">\mu
      m^3</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freq</code></td>
<td>
<p>a vector of numeric values with the same length as
<code>vol</code>, representing the frequency of cells of the volumes given
in <code>vol</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>a numeric value that represents the starting value for the
rate (<code class="reqn">\mu m^3/h</code>) of cell growth parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma_r</code></td>
<td>
<p>a numeric value that represents the starting value for
the variability in the rate of cell growth parameter <code>r</code>
(<code class="reqn">\mu m^3/h</code>) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>a numeric value representing the average cell cycle time (<code class="reqn">h</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma_t</code></td>
<td>
<p>a numeric value representing the variability in the
average cell cycle time <code>t</code> (<code class="reqn">h</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>numeric value representing the maximum number of
iterations used by nls.lm in model fitting under least
squares criteria</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nprint</code></td>
<td>
<p>optimization output is printed every <code>nprint</code>
iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alg</code></td>
<td>
<p>character string indicating the algorithm to use; the
choices are now "leastsq", so that that sum square error
<code>sum((data - model)^2)</code> is minimized, or "chisq", so that the
multinomial likelihood chi-square
</p>
<p><code>2*sum(data*log(data/model))</code> is  minimized.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>fitVolDist</code> returns
an object of class <code>"fitVolDist"</code>.
</p>
<p>The generic accessor functions <code>coefficients</code>,
<code>vcov</code>, <code>deviance</code>, <code>fitted</code> and <code>residuals</code> extract
various useful features of the value returned by <code>fitVolDist</code>.
</p>
<p>An object of class <code>"fitVolDist"</code> is a list containing the
following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>the value for <code>t</code> (<code class="reqn">h</code>) used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma_t</code></td>
<td>
<p>the value for <code>sigma_t</code> (<code class="reqn">h</code>)  used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted</code></td>
<td>
<p>the model fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.res</code></td>
<td>
<p>the output object returned from nls.lm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>summary.fit.res</code></td>
<td>
<p>the summary of the output object returned from
nls.lm.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Halter M, Elliott JT, Hubbard JB, Tona A, Plant AL (2009),
"Cell Volume Distributions Reveal Cell Growth Rates and Division Times",
Journal of Theoretical Biology, Vol 257, pp 124 - 130,
DOI: 10.1016/j.jtbi.2008.10.031.
</p>


<h3>See Also</h3>

<p><code>volEq7</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 

#############################################################
# Fit volume distribution data for A10 vSMC cell cultures
# as described in the above referenced paper
#############################################################

## load the volume distributions in the "A10_vSMC_volume_data" dataset
data("A10_vSMC_volume_data")  
labs &lt;- c("a","b","c","d")

## the volume distributions representing 0 nM aphidicolin concentration
Aph0 &lt;- list(Aph0_a, Aph0_b, Aph0_c, Aph0_d)
## the associated cell cycle times
tAph0 &lt;- c(tAph0_a, tAph0_b, tAph0_c, tAph0_d)   
## fit each dataset
Aph0res &lt;- list()
Aph0tab &lt;- matrix(ncol=2,nrow=4)
for(i in 1:length(Aph0)) {
  Aph0res[[i]] &lt;- fitVolDist(vol=volumes_A10_vSMC, freq=Aph0[[i]],
                             r=100,sigma_r=44, t=tAph0[i])

  Aph0tab[i,] &lt;- coef(Aph0res[[i]])
}
Aph0tab &lt;- rbind(Aph0tab, colMeans(Aph0tab))
colnames(Aph0tab) &lt;- c("r", "sigma_r")
rownames(Aph0tab) &lt;- c(labs, "mean values")

## plot results 
par(mfrow=c(3,2))

for(i in 1:length(Aph0)) {
  pe &lt;- signif(coef(Aph0res[[i]]),3)
  plot(volumes_A10_vSMC, Aph0[[i]], type="l", main= substitute(paste(
  "r: ", p1, ", ", sigma[r],": ",p2), 
  list(p1=pe[1], p2=pe[2])),
  xlab = expression(paste("volume (",mu, m^3,")", sep="")), 
  sub=paste("vol. dist. Aphidicolin 0 nM", labs[i]), ylab="frequency")
  
  lines(volumes_A10_vSMC, fitted(Aph0res[[i]]), col=2)
}
textplot("(Above) Volume distribution data
representing A10 vSMC cells 
cultured with 0 nM aphidicolin 
concentration (black) 
and model fit (red).  
(Right) Parameter estimates and 
mean estimates over the four fits",fixed.width=FALSE)
textplot(signif(Aph0tab,3))

## the volume distributions representing 50 nM aphidicolin concentration
Aph50 &lt;- list(Aph50_a, Aph50_b, Aph50_c, Aph50_d)
## the associated cell cycle times
tAph50 &lt;- c(tAph50_a, tAph50_b, tAph50_c, tAph50_d)   
## fit each dataset
Aph50res &lt;- list()
Aph50tab &lt;- matrix(ncol=2,nrow=4)
for(i in 1:length(Aph50)) {
  Aph50res[[i]] &lt;- fitVolDist(vol=volumes_A10_vSMC, freq=Aph50[[i]],
                             r=100,sigma_r=44, t=tAph50[i]) 

  Aph50tab[i,] &lt;- coef(Aph50res[[i]])
}
Aph50tab &lt;- rbind(Aph50tab, colMeans(Aph50tab))
colnames(Aph50tab) &lt;- c("r", "sigma_r")
rownames(Aph50tab) &lt;- c(labs, "mean values")
  
## plot results 
par(mfrow=c(3,2))

for(i in 1:length(Aph50)) {
  pe &lt;- signif(coef(Aph50res[[i]]),3)
  plot(volumes_A10_vSMC, Aph50[[i]], type="l", main= substitute(paste(
  "r: ", p1, ", ", sigma[r],": ",p2),
  list(p1=pe[1], p2=pe[2])),
  xlab = expression(paste("volume (", mu, m^3,")", sep="")),
  sub=paste("vol. dist. Aphidicolin 50 nM", labs[i]), ylab="frequency")
  
  lines(volumes_A10_vSMC, fitted(Aph50res[[i]]), col=2)
}
textplot("(Above) Volume distribution data
representing A10 vSMC cells 
cultured with 50 nM aphidicolin 
concentration (black) 
and model fit (red).  
(Right) Parameter estimates and 
mean estimates over the four fits",fixed.width=FALSE)
textplot(signif(Aph50tab,3))

## the volume distributions representing 100 nM aphidicolin concentration
Aph100 &lt;- list(Aph100_a, Aph100_b, Aph100_c, Aph100_d)
## the associated cell cycle times
tAph100 &lt;- c(tAph100_a, tAph100_b, tAph100_c, tAph100_d)   
## fit each dataset
Aph100res &lt;- list()
Aph100tab &lt;- matrix(ncol=2,nrow=4)
for(i in 1:length(Aph100)) {
  Aph100res[[i]] &lt;- fitVolDist(vol=volumes_A10_vSMC, freq=Aph100[[i]],
                             r=100,sigma_r=44, t=tAph100[i]) 
  Aph100tab[i,] &lt;- coef(Aph100res[[i]])
}
Aph100tab &lt;- rbind(Aph100tab, colMeans(Aph100tab))
colnames(Aph100tab) &lt;- c("r", "sigma_r")
rownames(Aph100tab) &lt;- c(labs, "mean values")

## plot results 
par(mfrow=c(3,2))

for(i in 1:length(Aph100)) {
  pe &lt;- signif(coef(Aph100res[[i]]),3)
  plot(volumes_A10_vSMC, Aph100[[i]], type="l", main= substitute(paste(
  "r: ", p1, ", ", sigma[r],": ",p2),
  list(p1=pe[1], p2=pe[2])),
  xlab = expression(paste("volume (",mu, m^3,")", sep="")),
  sub=paste("vol. dist. Aphidicolin 100 nM", labs[i]), ylab="frequency")
  
  lines(volumes_A10_vSMC, fitted(Aph100res[[i]]), col=2)
}
textplot("(Above) Volume distribution data
representing A10 vSMC cells 
cultured with 100 nM aphidicolin 
concentration (black) 
and model fit (red).  
(Right) Parameter estimates and 
mean estimates over the four fits",fixed.width=FALSE)
textplot(signif(Aph100tab,3))


## End(Not run)

#############################################################
# Fit volume distribution data for NIH3T3 cell cultures
# as described in the above referenced paper
#############################################################

## load the volume distributions in the "NIH3T3_volume_data" dataset
data("NIH3T3_volume_data")  
labs &lt;- c("a","b","c","d")

## the volume distributions representing NIH3T3 cells 
NIH3T3 &lt;- list(NIH3T3_a, NIH3T3_b, NIH3T3_c, NIH3T3_d)
## the associated cell cycle times
tNIH3T3 &lt;- c(tNIH3T3_a, tNIH3T3_b, tNIH3T3_c, tNIH3T3_d)   
## fit each dataset
NIH3T3res &lt;- list()
NIH3T3tab &lt;- matrix(ncol=2,nrow=4)
for(i in 1:length(NIH3T3)) {
  NIH3T3res[[i]] &lt;- fitVolDist(vol=volumes_nih3t3, freq=NIH3T3[[i]],
                               r=100,sigma_r=44, t=tNIH3T3[i])
  NIH3T3tab[i,] &lt;- coef(NIH3T3res[[i]])
}
NIH3T3tab &lt;- rbind(NIH3T3tab, colMeans(NIH3T3tab))
colnames(NIH3T3tab) &lt;- c("r", "sigma_r")
rownames(NIH3T3tab) &lt;- c(labs, "mean values")

## plot results 
par(mfrow=c(3,2))

for(i in 1:length(NIH3T3)) {
  pe &lt;- signif(coef(NIH3T3res[[i]]),3)
  plot(volumes_nih3t3, NIH3T3[[i]], type="l", main= substitute(paste(
  "r: ", p1, ", ", sigma[r],": ",p2),
  list(p1=pe[1], p2=pe[2])),
  xlab = expression(paste("volume (",mu, m^3,")", sep="")),
  sub=paste("vol. dist. NIH3T3", labs[i]), ylab="frequency")
  
  lines(volumes_nih3t3, fitted(NIH3T3res[[i]]), col=2)
}
textplot("(Above) Volume distribution data
representing NIH3T3 cells 
cultured under normal
conditions (black) 
and model fit (red). 
(Right) Parameter estimates and 
mean estimates over the four fits",fixed.width=FALSE)
textplot(signif(NIH3T3tab,3))

</code></pre>


</div>