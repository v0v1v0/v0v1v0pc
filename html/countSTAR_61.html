<div class="container">

<table style="width: 100%;"><tr>
<td>splineBasis</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Initialize and reparametrize a spline basis matrix</h2>

<h3>Description</h3>

<p>Following Wand and Ormerod (2008), compute a low-rank thin plate spline
basis which is diagonalized such that the prior variance for the nonlinear component
is a scalar times a diagonal matrix. Knot locations are determined by quantiles
and the penalty is the integrated squared second derivative.
</p>


<h3>Usage</h3>

<pre><code class="language-R">splineBasis(tau, sumToZero = TRUE, rescale01 = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p><code>m x 1</code> vector of observed points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sumToZero</code></td>
<td>
<p>logical; if TRUE, enforce a sum-to-zero constraint (useful for additive models)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rescale01</code></td>
<td>
<p>logical; if TRUE, rescale <code>tau</code> to the interval [0,1] prior to computing
basis and penalty matrices</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>B_nl</code>: the nonlinear component of the spline basis matrix
</p>


<h3>Note</h3>

<p>To form the full spline basis matrix, compute <code>cbind(1, tau, B_nl)</code>.
The sum-to-zero constraint implicitly assumes that the linear term is
centered and scaled, i.e., <code>scale(tau)</code>.
</p>


</div>