<div class="container">

<table style="width: 100%;"><tr>
<td>bsspline2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Evaluate the functions b and s at x</h2>

<h3>Description</h3>

<p>Evaluate the functions b and s, as specified by the vector
(b(d/6),b(2d/6),...,b(5d/6),s(0),s(d/6),...,s(5d/6)) computed using
<code>bsciuupi2</code>, <code>alpha</code>, <code>m</code>
and <code>natural</code> at <code>x</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bsspline2(x, bsvec, alpha, m, natural = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A value or vector of values at which the functions b and s are to be
evaluated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bsvec</code></td>
<td>
<p>The vector <code class="reqn">(b(d/6), b(2d/6), \dots, b(5d/6), s(0), s(d/6),
\dots, s(5d/6))</code> computed using <code>bsciuupi2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The minimum coverage probability is 1 - <code>alpha</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>Degrees of freedom <code>n - p</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>natural</code></td>
<td>
<p>Equal to 1 (default) if the b and s functions are evaluated by
natural cubic spline interpolation or 0 if evaluated by clamped cubic spline
interpolation. This parameter must take the same value as that used in
<code>bsciuupi2</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function b is an odd continuous function and the function s is an
even continuous function. In addition, b(x)=0 and s(x) is equal to the
<code class="reqn">1 - \alpha/2</code> quantile of the <code class="reqn">t</code> distribution with <code>m</code>
degrees of freedom for all |x| greater than or equal to d, where d is a
sufficiently large positive number (chosen by the function
<code>bsciuupi2</code>). The values of these functions in the interval
<code class="reqn">[-d,d]</code> are specified by the vector <code class="reqn">(b(d/6), b(2d/6), \dots,
 b(5d/6), s(0), s(d/6), \dots, s(5d/6))</code> as follows. By assumption,
<code class="reqn">b(0)=0</code> and <code class="reqn">b(-i)=-b(i)</code> and <code class="reqn">s(-i)=s(i)</code> for
<code class="reqn">i=d/6,...,d</code>. The values of <code class="reqn">b(x)</code> and <code class="reqn">s(x)</code> for any <code class="reqn">x</code>
in the interval <code class="reqn">[-d,d]</code> are found using cubic spline interpolation for
the given values of <code class="reqn">b(i)</code> and <code class="reqn">s(i)</code> for
<code class="reqn">i=-d,-5d/6,...,0,d/6,...,5d/6,d</code>. The choices of <code class="reqn">d</code> for <code class="reqn">m =
 1, 2</code> and <code class="reqn">&gt;2</code> are <code class="reqn">d=20, 10</code> and <code class="reqn">6</code> respectively.
</p>
<p>The vector <code class="reqn">(b(d/6), b(2d/6), \dots, b(5d/6), s(0), s(d/6), \dots,
 s(5d/6))</code> that specifies the Kabaila and Giri(2009) confidence interval that
utilizes uncertain prior information (CIUUPI), with minimum coverage
probability <code>1 - alpha</code>, is obtained using
<code>bsciuupi2</code>.
</p>
<p>In the examples, we continue with the same 2 x 2 factorial example described
in the documentation for <code>find_rho</code>.
</p>


<h3>Value</h3>

<p>A data frame containing <code>x</code> and the corresponding values of the
functions b and s.
</p>


<h3>References</h3>

<p>Kabaila, P. and Giri, R. (2009).  Confidence intervals in
regression utilizing prior information. Journal of Statistical Planning and
Inference, 139, 3419-3429.
</p>


<h3>See Also</h3>

<p><code>find_rho</code>, <code>bsciuupi2</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">alpha &lt;- 0.05
m &lt;- 8

# Find the vector (b(d/6),...,b(5d/6),s(0),...,s(5d/6)) that specifies the
# Kabaila &amp; Giri (2009) CIUUPI for the first definition of the
# scaled expected length (default) (takes about 30 mins to run):

bsvec &lt;- bsciuupi2(alpha, m, rho = -0.7071068)


# The result bsvec is (to 7 decimal places) the following:
bsvec &lt;- c(-0.0287487, -0.2151595, -0.3430403, -0.3125889, -0.0852146,
            1.9795390,  2.0665414,  2.3984471,  2.6460159,  2.6170066,  2.3925494)

# Graph the functions b and s
x &lt;- seq(0, 8, by = 0.1)
splineval &lt;- bsspline2(x, bsvec, alpha, m)

plot(x, splineval[, 2], type = "l", main = "b function",
ylab = " ", las = 1, lwd = 2, xaxs = "i", col = "blue")
plot(x, splineval[, 3], type = "l", main = "s function",
ylab = " ", las = 1, lwd = 2, xaxs = "i",  col = "blue")

</code></pre>


</div>