<div class="container">

<table style="width: 100%;"><tr>
<td>plot_phenology_trends</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Visualizing phenology responses to temperatures during two phases</h2>

<h3>Description</h3>

<p>The timing of many development stages of temperate trees may depend on temperatures during two
phases (e.g. bloom dates depend on the temperature during both the chilling and forcing phase of dormancy).
<code>plot_phenology_trends()</code> illustrates this dependency as a colored surface with contour lines by applying an
interpolating procedure with functions in the <code>fields</code> package. The plot is implemented
through functions in the <code>ggplot2</code> package.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_phenology_trends(
  pheno_data,
  weather_data,
  split_month = 6,
  chilling_phase,
  forcing_phase,
  Krig_warn = TRUE,
  x_axis_name = NULL,
  y_axis_name = NULL,
  legend_name = NULL,
  contour_line_color = "black",
  point_color = "black",
  point_shape = 19,
  legend_colors = NULL,
  base_size = 11,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pheno_data</code></td>
<td>
<p>is a data frame that contains information on the timing of phenology events by year.
It should consist of two columns called <code>Year</code> and <code>pheno</code>. Data in the <code>pheno</code> column should be in
Julian date (day of the year).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weather_data</code></td>
<td>
<p>is a data frame containing daily minimum and maximum temperature data (in columns
called <code>Tmin</code> and <code>Tmax</code>, respectively). There also has to be a column for <code>Year</code>, one for
<code>Month</code> and one for <code>Day</code>. It can also contain a column for <code>JDay</code>
(the Julian date, or day of the year).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>split_month</code></td>
<td>
<p>is an integer representing the last month of the growing season. This procedure analyzes
data by phenology year, which can start and end in any month during the calendar year (currently only
at the beginning of a month). This variable indicates the last month (e.g. 5 for May) that should be
included in the record for a given phenology year. All subsequent months are assigned to the 
following phenology year.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chilling_phase</code></td>
<td>
<p>is a vector of integers representing the start and end for the chilling period
in temperate trees. Numbers must be provided in Julian date (day of the year).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>forcing_phase</code></td>
<td>
<p>is a vector of integers representing the start and end for the forcing period
in temperate trees. Numbers must be provided in Julian date (day of the year).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Krig_warn</code></td>
<td>
<p>is a boolean parameter passed to the <code>Krig</code> function. Default is
set to <code>TRUE</code> following the recommendation of the authors of the package. For detailed information, please see the documentation
of the function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_axis_name</code></td>
<td>
<p>is a character string that allows the user modifying the default label used in the x axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_axis_name</code></td>
<td>
<p>is a character string that allows the user modifying the default label used in the y axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend_name</code></td>
<td>
<p>is a character string that allows the user modifying the default label used in the legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contour_line_color</code></td>
<td>
<p>is a character string representing the color used to draw the contour lines.
Default is set to black. If <code>NA</code> is used, the function will remove the contour lines with a warning.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>point_color</code></td>
<td>
<p>is a character string representing the color used to draw the points for actual
observations. Default is set to black. If <code>NA</code> is used, the function will remove the points with
a warning.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>point_shape</code></td>
<td>
<p>is a numeric input representing the point shape used to draw the points for actual
observations. Default is set to 19 (filled point). If <code>NA</code> is used, the function will remove the points with
a warning.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend_colors</code></td>
<td>
<p>is a character string representing the color scale used in the surface plot.
Default is set to <code>NULL</code> to let the function use the rainbow colors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>base_size</code></td>
<td>
<p>is a numeric input representing the relative size of the elements in plot. <code>base_size</code>
is passed to <code>ggplot2::theme_bw</code> as well as used to determine the size of the
points and contour lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>accepts arguments passed to <code>ggplot2::theme</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The generation of the color surface is based on the Kriging technique, which is typically used for 
interpolation of spatial data. The use for this particular purpose is a bit experimental.
</p>


<h3>Value</h3>

<p><code>plot_phenology_trends()</code> is expected to return an object of class <code>gg</code> and <code>ggplot</code>. This
means that the plot can be later modified by using the syntax <code>'+'</code> from the
<code>ggplot2</code> package (see examples). The plot returned in the function should look as the following:
</p>
<p><img src="../help/figures/rainbowplotexample.png" width="100%" alt="rainbow\_plot example"></p>


<h3>Examples</h3>

<pre><code class="language-R">
# Run a simple plot
# Code is commented out, so that it passes the CRAN incoming checks.
# Please uncomment to run the code.

# plot_phenology_trends(pheno_data = chillR::KA_bloom,
#                       weather_data = chillR::KA_weather,
#                       chilling_phase = c(306, 350),
#                       forcing_phase = c(355, 60))
             
# Customize the aspects of the plot and save it as 'plot'

# plot &lt;- plot_phenology_trends(pheno_data = chillR::KA_bloom,
#                               weather_data = chillR::KA_weather,
#                               chilling_phase = c(306, 350),
#                               forcing_phase = c(355, 60),
#                               x_axis_name = "Temperatura en el periodo de frio (Celsius)",
#                               y_axis_name = "Temperatura en el periodo de forzado (Celsius)",
#                               legend_name = "Fecha de floracion\n(dia juliano)",
#                               contour_line_color = "white",
#                               point_color = "blue4",
#                               point_shape = 4,
#                               legend_colors = NULL,
#                               base_size = 14,
#                               legend.position = "bottom",
#                               axis.title = ggplot2::element_text(family = "serif"))

# plot

# Modify the plot object with the syntax from ggplot2.
# Be aware that the following code overrides the modifications
# done by the argument '...' in the main function

# plot + ggplot2::theme_classic(base_size = 14)

</code></pre>


</div>