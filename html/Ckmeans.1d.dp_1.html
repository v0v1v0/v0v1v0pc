<div class="container">

<table style="width: 100%;"><tr>
<td>Ckmeans.1d.dp-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Optimal, Fast, and Reproducible Univariate Clustering
</h2>

<h3>Description</h3>

<p>This package provides a powerful set of tools for univariate data analysis with guaranteed optimality, efficiency, and reproducibility.
Four problems including univariate <code class="reqn">k</code>-means, <code class="reqn">k</code>-median, <code class="reqn">k</code>-segments, and multi-channel weighted <code class="reqn">k</code>-means are solved with guaranteed optimality and reproducibility. The core algorithm minimizes the (weighted) sum of within-cluster distances using respective metrics. Its advantage over heuristic clustering in efficiency and accuracy is increasingly pronounced as the number of clusters <code class="reqn">k</code> increases. Weighted <code class="reqn">k</code>-means can also optimally segment time series to perform peak calling. An auxiliary function generates histograms that are adaptive to patterns in data.
</p>
<p>The Ckmeans.1d.dp algorithm clusters (weighted) univariate data given by a numeric vector <code class="reqn">x</code> into <code class="reqn">k</code> groups by dynamic programming (Wang and Song 2011; Song and Zhong 2020). It guarantees the optimality of clustering—the total of within-cluster sums of squares is always the minimum given the number of clusters <code class="reqn">k</code>. In contrast, heuristic univariate clustering algorithms may be non-optimal or inconsistent from run to run. As non-negative weights are supported, the algorithm can partition a time course using time points as input and corresponding values as weight. Based on an optimal clustering, a function can generate histograms adaptive to patterns in data. The implementation of this algorithm is numerically stable.
</p>
<p>A linear time solution. Excluding the time for sorting <code class="reqn">x</code>, the weighted univariate clustering algorithm takes a runtime of <code class="reqn">O(kn)</code> (Song and Zhong 2020), linear in both sample size <code class="reqn">n</code> and the number of clusters <code class="reqn">k</code>. The approach was first introduced into version 3.4.9 (not publicly released) on July 16, 2016, using a new divide-and-conquer strategy integrating a previous theoretical result on matrix search (Aggarwal et al. 1987) and a novel in-place search space reduction method (Song and Zhong 2020).
</p>
<p>A log-linear time solution. Since version 3.4.6, a divide-and-conquer strategy that is simple to code reduces the runtime from <code class="reqn">O(kn^2)</code> down to <code class="reqn">O(kn\lg n)</code> (Song and Zhong 2020).
</p>
<p>A quadratic time solution. Before version 3.4.6, Ckmeans.1d.dp uses an algorithm that runs in quadratic runtime <code class="reqn">O(kn^2)</code> (Wang and Song 2011).
</p>
<p>A cubic time solution. Bellman (1973) first described a general dynamic programming strategy for solving univariate clustering problems with additive optimality measures. The strategy, however, did not address any specific characteristics of the <code class="reqn">k</code>-means problem and its implied general algorithm will have a time complexity of <code class="reqn">O(kn^3)</code> on an input of <code class="reqn">n</code> points.
</p>
<p>The space complexity in all cases is <code class="reqn">O(kn)</code>.
</p>
<p>This package provides a powerful alternative to heuristic clustering and also new functionality for weighted clustering, segmentation, and peak calling with guaranteed optimality. It is practical for Ckmeans.1d.dp to find a few clusters on millions of sample points with optional weights in seconds using a single core on a typical desktop computer.
</p>
<p>Third parties have ported various versions of this package to JavaScript, MATLAB, Python, Ruby, SAS, and Scala.
</p>


<h3>Details</h3>

<p>The most important function of this package is <code>Ckmeans.1d.dp</code> that implements optimal univariate clustering either weighted or unweighted. It also contains an adaptive histogram function <code>ahist</code>, plotting functions <code>plot.Ckmeans.1d.dp</code> and <code>plotBIC</code>, and a print function <code>print.Ckmeans.1d.dp</code>.
</p>


<h3>Disclaimer</h3>

<p>This program is free software: you can redistribute it and/or modify
it under the terms of the GNU Lesser General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.
</p>
<p>This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Lesser General Public License for more details.
</p>
<p>You should have received a copy of the GNU General Public License
along with this program.  If not, see <a href="https://www.gnu.org/licenses/">https://www.gnu.org/licenses/</a>.</p>


<h3>Author(s)</h3>

<p>Joe Song, Hua Zhong, and Haizhou Wang
</p>


<h3>References</h3>

<p>Aggarwal A, Klawe MM, Moran S, Shor P, Wilber R (1987).
“Geometric applications of a matrix-searching algorithm.”
<em>Algorithmica</em>, <b>2</b>(1-4), 195–208.
<a href="https://doi.org/10.1007/BF01840359">doi:10.1007/BF01840359</a>.<br><br> Bellman R (1973).
“A note on cluster analysis and dynamic programming.”
<em>Mathematical Biosciences</em>, <b>18</b>(3), 311–312.
<a href="https://doi.org/10.1016/0025-5564%2873%2990007-2">doi:10.1016/0025-5564(73)90007-2</a>.<br><br> Song M, Zhong H (2020).
“Efficient weighted univariate clustering maps outstanding dysregulated genomic zones in human cancers.”
<em>Bioinformatics</em>, <b>36</b>(20), 5027–5036.
<a href="https://doi.org/10.1093/bioinformatics/btaa613">doi:10.1093/bioinformatics/btaa613</a>.<br><br> Wang H, Song M (2011).
“Ckmeans.1d.dp: Optimal <code class="reqn">k</code>-means clustering in one dimension by dynamic programming.”
<em>The R Journal</em>, <b>3</b>(2), 29–33.
<a href="https://doi.org/10.32614/RJ-2011-015">doi:10.32614/RJ-2011-015</a>.
</p>





<h3>See Also</h3>

<p>The <code>kmeans</code> function in package <span class="pkg">stats</span> that implements several heuristic <code class="reqn">k</code>-means algorithms.
</p>


</div>