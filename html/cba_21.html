<div class="container">

<table style="width: 100%;"><tr>
<td>order.optimal</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Optimal Leaf Ordering of Binary Trees.</h2>

<h3>Description</h3>

<p>Find an optimal linear leaf ordering of a binary merge tree as
produced by a hierarchical cluster algorithm.
</p>


<h3>Usage</h3>

<pre><code class="language-R">order.optimal(dist, merge)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>
<p>an object of class <code>dist</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>merge</code></td>
<td>
<p>a binary merge tree (see <code>hclust</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A binary tree has <code class="reqn">2^{n-1}</code> internal nodes (subtrees) and
the same
number of leaf orderings. That is, at each internal node the left 
and right subtree (or leaves) can be swapped, or, in terms of a
dendrogram, be flipped.
</p>
<p>An objective measure of a leaf ordering is the sum of the distances
along the path connecting the leaves in the given order. An ordering 
with a minimal path length is defined to be an optimal ordering.
</p>
<p>This function provides an interface to the optimal leaf ordering
algorithm (see references) for tree representations that are used by 
hierarchical cluster algorithms such as <code>hclust</code>.
</p>
<p>Note that non-finite distance values are not allowed.
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>merge</code></td>
<td>
<p>a matrix containing the merge tree corresponding with the 
optimal leaf order.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>a vector containing the optimal leaf order.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>length</code></td>
<td>
<p>the length of the ordering.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The time complexity of the algorithm is <code class="reqn">O(n^3)</code>.</p>


<h3>Author(s)</h3>

<p>Christian Buchta</p>


<h3>References</h3>

<p>Z. Bar-Joseph, E. D. Demaine, D. K. Gifford, and T. Jaakkola.
(2001). Fast Optimal Leaf Ordering for Hierarchical Clustering.
<em>Bioinformatics</em>, Vol. 17 Suppl. 1, pp. 22-29. 
</p>


<h3>See Also</h3>

<p><code>hclust</code> for hierarchical clustering and
<code>order.length</code> for computing the objective value of a 
leaf ordering.
</p>


<h3>Examples</h3>

<pre><code class="language-R">d &lt;- dist(matrix(runif(30), ncol=2))
hc &lt;- hclust(d)
co &lt;- order.optimal(d, hc$merge)
### compare dendrograms
ho &lt;- hc
ho$merge &lt;- co$merge
ho$order &lt;- co$order
op &lt;- par(mfrow=c(2,2), pty="s")
plot(hc, main="hclust")
plot(ho, main="optimal")
# compare images
implot(d[[hc$order]])
implot(d[[co$order]])
par(op)
### compare lengths
order.length(d, hc$order)
order.length(d, co$order)
cat("compare: ",co$length,"\n")
</code></pre>


</div>