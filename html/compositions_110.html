<div class="container">

<table style="width: 100%;"><tr>
<td>ccompgof</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compositional Goodness of fit test</h2>

<h3>Description</h3>

<p>Goodness of fit tests for count compositional data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PoissonGOF.test(x,lambda=mean(x),R=999,estimated=missing(lambda))
ccompPoissonGOF.test(x,simulate.p.value=TRUE,R=1999)
ccompMultinomialGOF.test(x,simulate.p.value=TRUE,R=1999)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a dataset integer numbers (PoissonGOF) or count compositions (compPoissonGOF)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>the expected value to check against</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>The number of replicates to compute the distribution
of the test statistic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimated</code></td>
<td>
<p>states whether the lambda parameter should be
considered as estimated for the computation of the p-value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simulate.p.value</code></td>
<td>
<p>should all p-values be infered by simulation.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The compositional goodness of fit testing problem is essentially a
multivariate goodness of fit test. However there is a lack of
standardized multivariate goodness of fit tests in R. Some can be found in
the <code>energy</code>-package.
</p>
<p>In principle there is only one test behind the Goodness of fit tests
provided here, a two sample test with test statistic.
</p>
<p style="text-align: center;"><code class="reqn">\frac{\sum_{ij} k(x_i,y_i)}{\sqrt{\sum_{ij} k(x_i,x_i)\sum_{ij} k(y_i,y_i)}}</code>
</p>

<p>The idea behind that statistic is to measure the cos of an angle
between the distributions in a scalar product given by
</p>
<p style="text-align: center;"><code class="reqn">
  (X,Y)=E[k(X,Y)]=E[\int K(x-X)K(x-Y) dx]
  </code>
</p>

<p>where k and K are Gaussian kernels with different spread. The bandwith
is actually the standarddeviation of k.<br>
The other goodness of fit tests against a specific distribution are
based on estimating the parameters of the distribution, simulating a
large dataset of that distribution and apply the two sample goodness
of fit test. 
</p>


<h3>Value</h3>

<p>A classical <code>"htest"</code> object
</p>
<table>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p>The name of the dataset as specified</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a name for the test used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>an empty string</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replicates</code></td>
<td>
<p>a dataset of p-value distributions under the
Null-Hypothesis got from
nonparametric bootstrap</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>The p.value computed for this test</p>
</td>
</tr>
</table>
<h3>Missing Policy</h3>

<p>Up to now the tests can not handle missings. 
</p>


<h3>Author(s)</h3>

<p>K.Gerald v.d. Boogaart <a href="http://www.stat.boogaart.de">http://www.stat.boogaart.de</a></p>


<h3>References</h3>

<p>Aitchison, J. (1986) <em>The Statistical Analysis of Compositional
Data</em> Monographs on Statistics and Applied Probability. Chapman &amp;
Hall Ltd., London (UK). 416p.<br></p>


<h3>See Also</h3>

<p><code>fitDirichlet</code>,<code>rDirichlet</code>, <code>runif.acomp</code>,
<code>rnorm.acomp</code>, 
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
x &lt;- runif.acomp(100,4)
y &lt;- runif.acomp(100,4)

erg &lt;- acompGOF.test(x,y)
#continue
erg
unclass(erg)
erg &lt;- acompGOF.test(x,y)


x &lt;- runif.acomp(100,4)
y &lt;- runif.acomp(100,4)
dd &lt;- replicate(1000,acompGOF.test(runif.acomp(100,4),runif.acomp(100,4))$p.value)
hist(dd)

dd &lt;- replicate(1000,acompGOF.test(runif.acomp(20,4),runif.acomp(100,4))$p.value)
hist(dd)
dd &lt;- replicate(1000,acompGOF.test(runif.acomp(10,4),runif.acomp(100,4))$p.value)

hist(dd)
dd &lt;- replicate(1000,acompGOF.test(runif.acomp(10,4),runif.acomp(400,4))$p.value)
hist(dd)
dd &lt;- replicate(1000,acompGOF.test(runif.acomp(400,4),runif.acomp(10,4),bandwidth=4)$p.value)
hist(dd)


dd &lt;- replicate(1000,acompGOF.test(runif.acomp(20,4),runif.acomp(100,4)+acomp(c(1,2,3,1)))$p.value)

hist(dd)


x &lt;- runif.acomp(100,4)
acompUniformityGOF.test(x)

dd &lt;- replicate(1000,acompUniformityGOF.test(runif.acomp(10,4))$p.value)

hist(dd)


## End(Not run)
</code></pre>


</div>