<div class="container">

<table style="width: 100%;"><tr>
<td>CFO2d.simu</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Conduct one simulation using the two-dimensional calibration-free odds (2dCFO) design for phase I trials.</h2>

<h3>Description</h3>

<p>In the 2dCFO design for phase I trials, the function is used to conduct one single simulation and find the maximum tolerated dose (MTD).
</p>


<h3>Usage</h3>

<pre><code class="language-R">CFO2d.simu(target, p.true, init.level = c(1,1), ncohort, cohortsize, 
                 prior.para = list(alp.prior = target, bet.prior = 1 - target),
                 cutoff.eli = 0.95, early.stop = 0.95, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>
<p>the target DLT rate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.true</code></td>
<td>
<p>a matrix representing the true DIL rates under the different dose levels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init.level</code></td>
<td>
<p>the dose level assigned to the first cohort. The default value <code>init.level</code> is <code>c(1,1)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncohort</code></td>
<td>
<p>the total number of cohorts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cohortsize</code></td>
<td>
<p>the number of patients of each cohort.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior.para</code></td>
<td>
<p>the prior parameters for a beta distribution, where set as <code>list(alp.prior = target, bet.prior = 1 - target)</code>
by default, <code>alp.prior</code> and <code>bet.prior</code> represent the parameters of the prior distribution for
the true DLT rate at any dose level. This prior distribution is specified as Beta(<code>alpha.prior</code>, <code>beta.prior</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff.eli</code></td>
<td>
<p>the cutoff to eliminate overly toxic doses for safety. We recommend
the default value of (<code>cutoff.eli = 0.95</code>) for general use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>early.stop</code></td>
<td>
<p>the threshold value for early stopping. The default value <code>early.stop = 0.95</code>
generally works well.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>an integer to be set as the seed of the random number generator for reproducible results. The default is set to <code>NULL</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>CFO2d.simu()</code> function simulates the operating characteristics of the 2dCFO design
in a dose-combination trial.
The early stopping and dose elimination rules are incorporated into the 2dCFO design
to ensure patient safety and benefit.
</p>


<h3>Value</h3>

<p>The <code>CFO2d.simu()</code> function returns a list with the following components:
</p>

<ul>
<li>
<p> target: the target DLT rate.
</p>
</li>
<li>
<p> MTD: a vector of length 2 representing the recommended dose level. <code>MTD = (99, 99)</code> indicates that this trial is terminated due to early stopping.
</p>
</li>
<li>
<p> correct: a binary indicator of whether the recommended dose level matches the correct MTD (1 for yes).
The correct MTD is the dose level at which the true DLT rate is closest to the target DLT rate.
</p>
</li>
<li>
<p> npatients: a matrix of the number of patients allocated to different doses.
</p>
</li>
<li>
<p> ntox: a matrix of the number of DLT observed for different doses.
</p>
</li>
<li>
<p> npercent: the percentage of patients assigned to the correct MTD.
</p>
</li>
<li>
<p> over.doses: a matrix indicating whether each dose is overdosed or not (1 for yes).
</p>
</li>
<li>
<p> cohortdose: the dose combination assigned to each cohort.
</p>
</li>
<li>
<p> ptoxic: the percentage of subjects assigned to dose levels with a DLT rate greater than the target.
</p>
</li>
<li>
<p> patientDLT: the DLT observed at each cohort.
</p>
</li>
<li>
<p> sumDLT: the total number of DLT observed.
</p>
</li>
<li>
<p> earlystop: a binary indicator of whether the trial is early stopped (1 for yes).
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Jialu Fang, Wenliang Wang, Ninghao Zhang, and Guosheng Yin
</p>


<h3>References</h3>

<p>Jin H, Yin G (2022). CFO: Calibration-free odds design for phase I/II clinical trials.
<em>Statistical Methods in Medical Research</em>, 31(6), 1051-1066. <br>
Wang W, Jin H, Zhang Y, Yin G (2023). Two-dimensional calibration-free odds (2dCFO)
design for phase I drug-combination trials. <em>Frontiers in Oncology</em>, 13, 1294258.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Simulate a two-dimensional dose-finding trial with 20 cohorts of size 3.
p.true &lt;- matrix(c(0.05, 0.10, 0.15, 0.30, 0.45,
                   0.10, 0.15, 0.30, 0.45, 0.55,
                   0.15, 0.30, 0.45, 0.50, 0.60), 
                 nrow = 3, ncol = 5, byrow = TRUE)
target &lt;- 0.3; ncohort &lt;- 20; cohortsize &lt;- 3
CFO2dtrial &lt;- CFO2d.simu(target, p.true, init.level = c(1,1), ncohort, cohortsize, seed = 1)
summary(CFO2dtrial)
plot(CFO2dtrial)
</code></pre>


</div>