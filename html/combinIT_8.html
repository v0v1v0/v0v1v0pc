<div class="container">

<table style="width: 100%;"><tr>
<td>KKSA_test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Kharrati-Kopaei and Sadooghi-Alvandi's (2007) test for interaction</h2>

<h3>Description</h3>

<p>This function calculates Kharrati-Kopaei and Sadooghi-Alvandi's test statistic and corresponding p-value for testing interaction.
</p>


<h3>Usage</h3>

<pre><code class="language-R">KKSA_test(
  x,
  nsim = 10000,
  alpha = 0.05,
  report = TRUE,
  plot = FALSE,
  vecolor = c("blue", "red"),
  linetype = c(1, 2),
  Elapsed_time = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>numeric matrix, <code class="reqn">a \times b</code> data matrix where the number of row and column is corresponding to the number of factor levels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>a numeric value, the number of Monte Carlo samples for computing an exact Monte Carlo p-value. The default value is 10000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>a numeric value, the level of the test. The default value is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>report</code></td>
<td>
<p>logical: if <code>TRUE</code> the result of the test is reported at the <code>alpha</code> level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical: if <code>TRUE</code> an interaction plot will be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vecolor</code></td>
<td>
<p>character vector with length two, for visualizing the colors of lines in interaction plot. The default colors are blue and red.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linetype</code></td>
<td>
<p>numeric vector with length two, for visualizing the line types in interaction plot. The default line types are 1 and 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Elapsed_time</code></td>
<td>
<p>logical: if <code>TRUE</code> the progress will be printed in the console.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Suppose that <code class="reqn">a \ge b</code> and <code class="reqn">b \ge 4</code>. Consider the <code class="reqn">l</code>-th division of the data table into two sub-tables,
obtained by putting <code class="reqn">a_1</code> (<code class="reqn">2 \le a_1 \le a-2</code>) rows in the first sub-table and the remaining <code class="reqn">a_2</code> rows in the second sub-table (<code class="reqn">a_1+a_2=a</code>).
Let RSS1 and RSS2 denote the residual sum of squares for these two sub-tables, respectively. For a particular division <code class="reqn">l</code>, let <code class="reqn">F_l=max\{F_l,1/F_l\}</code>
where <code class="reqn">F_l=(a_2-1)RSS1/((a_1-1)RSS2)</code> and let <code class="reqn">P_l</code> denote the corresponding p-value.
Kharrati-Kopaei and Sadooghi-Alvandi (2007) proposed their test statistic as the minimum value of <code class="reqn">P_l</code> over <code class="reqn">l=1,…,2^{(a-1)}-a-1</code> all possible divisions of the table.
If <code>plot</code> is <code>TRUE</code> an interaction plot will be plotted by displaying levels of column factor on the horizontal axis,
levels of row factor using lines that are visually distinguished by line type and color, and the
observed values on the vertical axis. Color and line type are used to display which levels of row factor are assigned to which
sub-tables based on the minimum p-values among all possible configurations. Note
that the grouping colors and line types appear whether or not the KKSA.test detects
a significant non-additivity. The default colors are blue and red, and the default line types are one and two for the two sub-tables. They can be customized by supplying arguments called <code>vecolor</code> and <code>linetype</code>.
Note that this method of testing requires that the data matrix has more than three
rows. This test procedure is powerful for detecting interaction when the magnitude of interaction effects is heteroscedastic across the sub-tables of observations.
</p>


<h3>Value</h3>

<p>An object of the class <code>ITtest</code>, which is a list inducing following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>pvalue_exact</code></td>
<td>
<p>The calculated exact Monte Carlo p-value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalue_appro</code></td>
<td>
<p>The Bonferroni-adjusted p-value is calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>The value of the test statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nsim</code></td>
<td>
<p>The number of Monte Carlo samples that are used to estimate p-value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data_name</code></td>
<td>
<p>The name of the input dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>The name of the test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Level</code></td>
<td>
<p>The level of test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Result</code></td>
<td>
<p>The result of the test at the alpha level with some descriptions on the type of significant interaction.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Kharrati-Kopaei, M., Sadooghi-Alvandi, S.M. (2007). A New Method for
Testing Interaction in Unreplicated Two-Way Analysis of Variance. Communications
in Statistics-Theory and Methods 36:2787–2803.
</p>
<p>Shenavari, Z., Kharrati-Kopaei, M. (2018). A Method for Testing Additivity in
Unreplicated Two-Way Layouts Based on Combining Multiple Interaction Tests. International Statistical Review
86(3): 469-487.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(IDCP)
KKSA_test(IDCP, nsim = 1000, Elapsed_time = FALSE)

</code></pre>


</div>