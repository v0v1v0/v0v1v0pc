<div class="container">

<table style="width: 100%;"><tr>
<td>cstaubest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Confidence sets for the tau-best</h2>

<h3>Description</h3>

<p>Computation of confidence sets for the identities of populations among the tau best.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cstaubest(
  x,
  Sigma,
  tau = 2,
  coverage = 0.95,
  stepdown = TRUE,
  R = 1000,
  na.rm = FALSE,
  seed = NA
)

cstauworst(
  x,
  Sigma,
  tau = 2,
  coverage = 0.95,
  stepdown = TRUE,
  R = 1000,
  na.rm = FALSE,
  seed = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>vector of estimates containing estimated features by which the populations are to be ranked.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>estimated covariance matrix of <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>the confidence set contains indicators for the elements in <code>x</code> whose rank is less than or equal to <code>tau</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coverage</code></td>
<td>
<p>nominal coverage of the confidence set. Default is 0.95.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stepdown</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), stepwise procedure is used, otherwise single step procedure is used. See Details section for more.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>number of bootstrap replications. Default is 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>logical; if <code>TRUE</code>, then <code>NA</code>'s are removed from <code>x</code> and <code>Sigma</code> (if any).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>seed for bootstrap random variable draws. If set to <code>NA</code> (default), then seed is not set.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>logical vector indicating which of the elements of <code>x</code> are in the confidence set for the tau-best.
</p>


<h3>Functions</h3>


<ul><li> <p><code>cstauworst()</code>: Confidence sets for the tau-worst
</p>
<p>Equivalent to calling <code>cstaubest</code> with <code>-x</code>.
</p>
</li></ul>
<h3>Details</h3>

<p>The function computes a confidence set containing indicators for the elements in <code>x</code> whose rank is less than or equal to <code>tau</code> with probability approximately equal to the nominal coverage (<code>coverage</code>).
</p>
<p>The function implements the projection confidence set for the tau-best developed and described in more detail in Mogstad, Romano, Shaikh, and Wilhelm (2023).
</p>


<h3>References</h3>

<p>Mogstad, Romano, Shaikh, and Wilhelm (2023), "Inference for Ranks with Applications to Mobility across Neighborhoods and Academic Achievements across Countries", forthcoming at Review of Economic Studies
<a href="http://dwilhelm.userweb.mwn.de/papers/cwp0323.pdf">cemmap working paper</a>, <a href="https://doi.org/10.1093/restud/rdad006">doi:10.1093/restud/rdad006</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># simple simulated example:
n &lt;- 100
p &lt;- 10
X &lt;- matrix(rep(1:p,n)/p, ncol=p, byrow=TRUE) + matrix(rnorm(n*p), 100, 10)
thetahat &lt;- colMeans(X)
Sigmahat &lt;- cov(X) / n

# confidence set for the populations that may be among the top-3 
# (with probability approximately 0.95):
cstaubest(thetahat, Sigmahat, tau=3)

# confidence set for the populations that may be among the bottom-3 
# (with probability approximately 0.95):
cstauworst(thetahat, Sigmahat, tau=3)

</code></pre>


</div>