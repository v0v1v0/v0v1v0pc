<div class="container">

<table style="width: 100%;"><tr>
<td>rlog</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sampling Logarithmic Distributions</h2>

<h3>Description</h3>

<p>Generating random variates from a Log(p) distribution with probability
mass function
</p>
<p style="text-align: center;"><code class="reqn">p_k=\frac{p^k}{-\log(1-p)k},\ k\in\mathbf{N},
      </code>
</p>

<p>where <code class="reqn">p\in(0,1)</code>.  The implemented algorithm is the
one named “LK” in Kemp (1981).
</p>


<h3>Usage</h3>

<pre><code class="language-R">   rlog(n, p, Ip = 1 - p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>sample size, that is, length of the resulting vector of random
variates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>parameter in <code class="reqn">(0,1)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ip</code></td>
<td>
<p><code class="reqn">= 1 - p</code>, possibly more accurate, e.g, when
<code class="reqn">p\approx 1</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For documentation and didactical purposes, <code>rlogR</code> is a pure-<span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>
implementation of <code>rlog</code>.  However, <code>rlogR</code> is not as fast as
<code>rlog</code> (the latter being implemented in C).
</p>


<h3>Value</h3>

<p>A vector of positive <code>integer</code>s of length <code>n</code> containing the
generated random variates.
</p>


<h3>Note</h3>

<p>In the <span class="pkg">copula</span> package, the Log(p) distribution is needed only
for generating Frank copula observations, namely in
<code>copFrank@V0()</code>, where <code class="reqn">p = 1 - exp(-\theta)</code>, i.e.,
<code>p = -expm1(-theta)</code> and <code>Ip = exp(-theta)</code>.
</p>
<p>For large <code class="reqn">\theta</code> it would be desirable to pass <code>-theta</code>
to <code>rlog()</code> instead of <code>p</code>.  This has not yet been implemented.
</p>


<h3>References</h3>

<p>Kemp, A. W. (1981),
Efficient Generation of Logarithmically Distributed Pseudo-Random Variables,
<em>Journal of the Royal Statistical Society: Series C (Applied
Statistics)</em> <b>30</b>, 3, 249–253.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Sample n random variates from a Log(p) distribution and plot a
## "histogram"
n &lt;- 1000
p &lt;- .5
X &lt;- rlog(n, p)
table(X) ## distribution on the integers {1, 2, ..}
## ==&gt; The following plot is more reasonable than a  hist(X, prob=TRUE) :
plot(table(X)/n, type="h", lwd=10, col="gray70")

## case closer to numerical boundary:
lV &lt;- log10(V &lt;- rlog(10000, Ip = 2e-9))# Ip = exp(-theta) &lt;==&gt; theta ~= 20
hV &lt;- hist(lV, plot=FALSE)
dV &lt;- density(lV)
## Plot density and histogram on log scale with nice axis labeling &amp; ticks:
plot(dV, xaxt="n", ylim = c(0, max(hV$density, dV$y)),
     main = "Density of [log-transformed] Log(p),  p=0.999999..")
abline(h=0, lty=3); rug(lV); lines(hV, freq=FALSE, col = "light blue"); lines(dV)
rx &lt;- range(pretty(par("usr")[1:2]))
sx &lt;- outer(1:9, 10^(max(0,rx[1]):rx[2]))
axis(1, at=log10(sx),     labels= FALSE, tcl = -0.3)
axis(1, at=log10(sx[1,]), labels= formatC(sx[1,]), tcl = -0.75)
</code></pre>


</div>