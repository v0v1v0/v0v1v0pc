<div class="container">

<table style="width: 100%;"><tr>
<td>plot.CopulaCenR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plotting for CopulaCenR fits</h2>

<h3>Description</h3>

<p>Plotting for CopulaCenR fits from  <code>ic_spTran_copula</code>, <code>rc_spCox_copula</code>,
<code>ic_par_copula</code> and <code>rc_par_copula</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'CopulaCenR'
plot(
  x,
  y,
  class = "joint",
  newdata,
  evalPoints = 50,
  evalTimes1 = NULL,
  evalTimes2 = NULL,
  plot_margin = 1,
  cond_time = NULL,
  cond_margin = 2,
  type = "l",
  xlab = "years",
  ylab = "survival probability",
  cex.main = 1.4,
  cex.lab = 1.4,
  cex.axis = 1.4,
  legend = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of <code>ic_spTran_copula</code> or <code>rc_spCox_copula</code>
or <code>ic_par_copula</code> or <code>rc_par_copula</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>new data frame with colname names <code>id</code>, <code>ind</code> and <code>covariate</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>class</code></td>
<td>
<p>one of "joint", "conditional" or "marginal"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>new data frame (ignored if <code>y</code> is included)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>evalPoints</code></td>
<td>
<p>number of time points to be evaluated in both margins;
default is 50</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>evalTimes1</code></td>
<td>
<p>a vector of times for margin 1 to be evaluated;
default is NULL;
will override evalPoints if non-NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>evalTimes2</code></td>
<td>
<p>a vector of times for margin 2 to be evaluated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_margin</code></td>
<td>
<p>for <code>class = "marginal"</code> only; indicator of which margin to plot
(either 1 or 2); default is 1 for margin 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cond_time</code></td>
<td>
<p>for <code>class = "conditional"</code> only; the time
by which event has occurred in the margin indicated by <code>cond_margin</code>;
must be smaller than the largest observed time</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cond_margin</code></td>
<td>
<p>for <code>class = "conditional"</code> only; indicator of the margin
where event has occurred (either 1 or 2); default is 2 for margin 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of plot with default <code>type = "l"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>a title for the x axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>a title for the x axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.main</code></td>
<td>
<p>cex for main.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.lab</code></td>
<td>
<p>cex for lab.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.axis</code></td>
<td>
<p>cex for axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>
<p>whether to show legend with default <code>legend = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>y must be a data frame with columns <code>id</code> (subject id),
<code>ind</code> (1,2 for two margins) and <code>covariates</code>. <br>
The argument class determines the plot:
<code>"joint"</code> for joint survival probabilities,
<code>"conditional"</code> for conditional probabilities and
<code>"marginal"</code> for marginal probabilities.
</p>
<p>The function evaluates on a series of time points
(given by <code>evalPoints</code> or <code>evalTimes</code>;
<code>evalTimes</code> will override <code>evalPoints</code>).
By default, the time points are automatically
selected by specifying the number of points (<code>evalPoints = 50</code>).
Users can also provide the specific time points through <code>evalTimes1</code> and
<code>evalTimes2</code> for the two margins, respectively.
When <code>class</code> <code>= "conditional"</code>, only <code>evalTimes1</code> is needed
and the evaluation times are actually <code>evalTimes1</code> plus <code>cond_time</code>. <br></p>
<p>If <code>class</code> <code>= "conditional"</code>, one needs to specify the margin
that has the event (by <code>cond_margin</code>)
and time when the event has occurred (by <code>cond_time</code>).
For example, if <code>cond_margin = 2</code> and <code>cond_time = 5</code>,
then the function produces the conditional survival probability
(after time 5) in margin 1 given that margin 2 has got an event by time 5.
This measurement is useful for predicting the second event
given the first event has occurred. See the example for details.<br></p>
<p>If <code>class = "marginal"</code>, one needs to specify which margin to plot
through the argument <code>plot_margin</code>. See the example for details. <br></p>


<h3>Value</h3>

<p>a 3D joint survival distribution plot if <code>class = "joint"</code>;
a 2D survival distribution plot if <code>class</code> = <code>"marginal"</code> or <code>"conditional"</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(AREDS)
# fit a Copula2-Sieve model
copula2_sp &lt;- ic_spTran_copula(data = AREDS, copula = "Copula2",
              l = 0, u = 15, m = 3, r = 3,
              var_list = c("ENROLLAGE","rs2284665","SevScaleBL"))
newdata = data.frame(id = rep(1, each=2), ind = rep(c(1,2),1),
                     SevScaleBL = rep(3,2), ENROLLAGE = rep(60,2),
                     rs2284665 = c(0,0))
# Plot joint survival probabilities
plot(x = copula2_sp, class = "joint", newdata = newdata)

# Plot conditional survival probabilities
plot(x = copula2_sp, class = "conditional", newdata = newdata,
     cond_margin = 2, cond_time = 5, ylim = c(0.25,1),
     ylab = "Conditional Survival Probability")

# Plot marginal survival probabilities
plot(x = copula2_sp, class = "marginal", newdata = newdata,
     plot_margin = 1, ylim = c(0.6,1),
     ylab = "Marginal Survival Probability")
</code></pre>


</div>