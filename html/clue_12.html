<div class="container">

<table style="width: 100%;"><tr>
<td>cl_agreement</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Agreement Between Partitions or Hierarchies</h2>

<h3>Description</h3>

<p>Compute the agreement between (ensembles) of partitions or
hierarchies.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cl_agreement(x, y = NULL, method = "euclidean", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an ensemble of partitions or hierarchies and dissimilarities,
or something coercible to that (see <code>cl_ensemble</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p><code>NULL</code> (default), or as for <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string specifying one of the built-in
methods for computing agreement, or a function to be taken as
a user-defined method.  If a character string, its lower-cased
version is matched against the lower-cased names of the available
built-in methods using <code>pmatch</code>.  See <b>Details</b> for
available built-in methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed to methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>y</code> is given, its components must be of the same kind as those
of <code>x</code> (i.e., components must either all be partitions, or all be
hierarchies or dissimilarities).
</p>
<p>If all components are partitions, the following built-in methods for
measuring agreement between two partitions with respective membership
matrices <code class="reqn">u</code> and <code class="reqn">v</code> (brought to a common number of columns)
are available:
</p>

<dl>
<dt><code>"euclidean"</code></dt>
<dd>
<p><code class="reqn">1 - d / m</code>, where <code class="reqn">d</code> is the
Euclidean dissimilarity of the memberships, i.e., the square root
of the minimal sum of the squared differences of <code class="reqn">u</code> and all
column permutations of <code class="reqn">v</code>, and <code class="reqn">m</code> is an upper bound for
the maximal Euclidean dissimilarity.  See Dimitriadou, Weingessel
and Hornik (2002).</p>
</dd>
<dt><code>"manhattan"</code></dt>
<dd>
<p><code class="reqn">1 - d / m</code>, where <code class="reqn">d</code> is the
Manhattan dissimilarity of the memberships, i.e., the minimal
sum of the absolute differences of <code class="reqn">u</code> and all column
permutations of <code class="reqn">v</code>, and <code class="reqn">m</code> is an upper bound for the
maximal Manhattan dissimilarity.</p>
</dd>
<dt><code>"Rand"</code></dt>
<dd>
<p>the Rand index (the rate of distinct pairs of
objects both in the same class or both in different classes in
both partitions), see Rand (1971) or Gordon (1999), page 198.
For soft partitions, (currently) the Rand index of the
corresponding nearest hard partitions is used.</p>
</dd>
<dt><code>"cRand"</code></dt>
<dd>
<p>the Rand index corrected for agreement by
chance, see Hubert and Arabie (1985) or Gordon (1999), page 198.
Can only be used for hard partitions.</p>
</dd>
<dt><code>"NMI"</code></dt>
<dd>
<p>Normalized Mutual Information, see Strehl and
Ghosh (2002).  For soft partitions, (currently) the NMI of the
corresponding nearest hard partitions is used.</p>
</dd> 
<dt><code>"KP"</code></dt>
<dd>
<p>the Katz-Powell index, i.e., the product-moment
correlation coefficient between the elements of the co-membership
matrices <code class="reqn">C(u) = u u'</code> and <code class="reqn">C(v)</code>, respectively, see Katz
and Powell (1953).  For soft partitions, (currently) the
Katz-Powell index of the corresponding nearest hard partitions is
used.  (Note that for hard partitions, the <code class="reqn">(i,j)</code> entry of
<code class="reqn">C(u)</code> is one iff objects <code class="reqn">i</code> and <code class="reqn">j</code> are in the same
class.)</p>
</dd>
<dt><code>"angle"</code></dt>
<dd>
<p>the maximal cosine of the angle between the
elements of <code class="reqn">u</code> and all column permutations of <code class="reqn">v</code>.</p>
</dd>
<dt><code>"diag"</code></dt>
<dd>
<p>the maximal co-classification rate, i.e., the
maximal rate of objects with the same class ids in both
partitions after arbitrarily permuting the ids.</p>
</dd>
<dt><code>"FM"</code></dt>
<dd>
<p>the index of Fowlkes and Mallows (1983), i.e.,
the ratio <code class="reqn">N_{xy} / \sqrt{N_x N_y}</code> of
the number <code class="reqn">N_{xy}</code> of distinct pairs of objects in the
same class in both partitions and the geometric mean of the
numbers <code class="reqn">N_x</code> and <code class="reqn">N_y</code> of distinct pairs of objects in
the same class in partition <code class="reqn">x</code> and partition <code class="reqn">y</code>,
respectively.
For soft partitions, (currently) the Fowlkes-Mallows index of the
corresponding nearest hard partitions is used.</p>
</dd>
<dt><code>"Jaccard"</code></dt>
<dd>
<p>the Jaccard index, i.e., the ratio of the
numbers of distinct pairs of objects in the same class in both
partitions and in at least one partition, respectively.
For soft partitions, (currently) the Jaccard index of the
corresponding nearest hard partitions is used.</p>
</dd>
<dt><code>"purity"</code></dt>
<dd>
<p>the purity of the classes of <code>x</code> with
respect to those of <code>y</code>, i.e.,
<code class="reqn">\sum_j \max_i n_{ij} / n</code>,
where <code class="reqn">n_{ij}</code> is the joint frequency of objects in class
<code class="reqn">i</code> for <code>x</code> and in class <code class="reqn">j</code> for <code>y</code>, and
<code class="reqn">n</code> is the total number of objects.</p>
</dd>
<dt><code>"PS"</code></dt>
<dd>
<p>Prediction Strength, see Tibshirani and Walter
(2005): the minimum, over all classes <code class="reqn">j</code> of <code>y</code>, of the
maximal rate of objects in the same class for <code>x</code> and in
class <code class="reqn">j</code> for <code>y</code>.</p>
</dd>
</dl>
<p>If all components are hierarchies, available built-in methods for
measuring agreement between two hierarchies with respective
ultrametrics <code class="reqn">u</code> and <code class="reqn">v</code> are as follows.
</p>

<dl>
<dt><code>"euclidean"</code></dt>
<dd>
<p><code class="reqn">1 / (1 + d)</code>, where <code class="reqn">d</code> is the
Euclidean dissimilarity of the ultrametrics (i.e., the square root
of the sum of the squared differences of <code class="reqn">u</code> and <code class="reqn">v</code>).</p>
</dd>
<dt><code>"manhattan"</code></dt>
<dd>
<p><code class="reqn">1 / (1 + d)</code>, where <code class="reqn">d</code> is the
Manhattan dissimilarity of the ultrametrics (i.e., the sum of the
absolute differences of <code class="reqn">u</code> and <code class="reqn">v</code>).</p>
</dd>
<dt><code>"cophenetic"</code></dt>
<dd>
<p>The cophenetic correlation coefficient.
(I.e., the product-moment correlation of the ultrametrics.)</p>
</dd>
<dt><code>"angle"</code></dt>
<dd>
<p>the cosine of the angle between the
ultrametrics.</p>
</dd>
<dt><code>"gamma"</code></dt>
<dd>
<p><code class="reqn">1 - d</code>, where <code class="reqn">d</code> is the rate of
inversions between the associated ultrametrics (i.e., the rate of
pairs <code class="reqn">(i,j)</code> and <code class="reqn">(k,l)</code> for which <code class="reqn">u_{ij} &lt; u_{kl}</code>
and <code class="reqn">v_{ij} &gt; v_{kl}</code>).  (This agreement measure is a linear
transformation of Kruskal's <code class="reqn">\gamma</code>.)</p>
</dd>
</dl>
<p>The measures based on ultrametrics also allow computing agreement with
“raw” dissimilarities on the underlying objects (R objects
inheriting from class <code>"dist"</code>).
</p>
<p>If a user-defined agreement method is to be employed, it must be a
function taking two clusterings as its arguments.
</p>
<p>Symmetric agreement objects of class <code>"cl_agreement"</code> are
implemented as symmetric proximity objects with self-proximities
identical to one, and inherit from class <code>"cl_proximity"</code>.  They
can be coerced to dense square matrices using <code>as.matrix</code>.  It is
possible to use 2-index matrix-style subscripting for such objects;
unless this uses identical row and column indices, this results in a
(non-symmetric agreement) object of class <code>"cl_cross_agreement"</code>.
</p>


<h3>Value</h3>

<p>If <code>y</code> is <code>NULL</code>, an object of class <code>"cl_agreement"</code>
containing the agreements between the all pairs of components of
<code>x</code>.  Otherwise, an object of class <code>"cl_cross_agreement"</code>
with the agreements between the components of <code>x</code> and the
components of <code>y</code>.
</p>


<h3>References</h3>

<p>E. Dimitriadou, A. Weingessel and K. Hornik (2002).
A combination scheme for fuzzy clustering.
<em>International Journal of Pattern Recognition and Artificial
Intelligence</em>, <b>16</b>, 901–912. <br><a href="https://doi.org/10.1142/S0218001402002052">doi:10.1142/S0218001402002052</a>.
</p>
<p>E. B. Fowlkes and C. L. Mallows (1983).
A method for comparing two hierarchical clusterings.
<em>Journal of the American Statistical Association</em>, <b>78</b>,
553–569. <br><a href="https://doi.org/10.1080/01621459.1983.10478008">doi:10.1080/01621459.1983.10478008</a>.
</p>
<p>A. D. Gordon (1999).
<em>Classification</em> (2nd edition).
Boca Raton, FL: Chapman &amp; Hall/CRC.
</p>
<p>L. Hubert and P. Arabie (1985).
Comparing partitions.
<em>Journal of Classification</em>, <b>2</b>, 193–218.
<a href="https://doi.org/10.1007/bf01908075">doi:10.1007/bf01908075</a>.
</p>
<p>W. M. Rand (1971).
Objective criteria for the evaluation of clustering methods.
<em>Journal of the American Statistical Association</em>, <b>66</b>,
846–850.
<a href="https://doi.org/10.2307/2284239">doi:10.2307/2284239</a>.
</p>
<p>L. Katz and J. H. Powell (1953).
A proposed index of the conformity of one sociometric measurement to
another.
<em>Psychometrika</em>, <b>18</b>, 249–256.
<a href="https://doi.org/10.1007/BF02289063">doi:10.1007/BF02289063</a>.
</p>
<p>A. Strehl and J. Ghosh (2002).
Cluster ensembles — A knowledge reuse framework for combining
multiple partitions.
<em>Journal of Machine Learning Research</em>, <b>3</b>, 583–617. <br><a href="https://www.jmlr.org/papers/volume3/strehl02a/strehl02a.pdf">https://www.jmlr.org/papers/volume3/strehl02a/strehl02a.pdf</a>.
</p>
<p>R. Tibshirani and G. Walter (2005).
Cluster validation by Prediction Strength.
<em>Journal of Computational and Graphical Statistics</em>, <b>14</b>/3,
511–528.
<a href="https://doi.org/10.1198/106186005X59243">doi:10.1198/106186005X59243</a>.
</p>


<h3>See Also</h3>

<p><code>cl_dissimilarity</code>;
<code>classAgreement</code> in package <span class="pkg">e1071</span>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## An ensemble of partitions.
data("CKME")
pens &lt;- CKME[1 : 20]		# for saving precious time ...
summary(c(cl_agreement(pens)))
summary(c(cl_agreement(pens, method = "Rand")))
summary(c(cl_agreement(pens, method = "diag")))
cl_agreement(pens[1:5], pens[6:7], method = "NMI")
## Equivalently, using subscripting.
cl_agreement(pens, method = "NMI")[1:5, 6:7]

## An ensemble of hierarchies.
d &lt;- dist(USArrests)
hclust_methods &lt;-
    c("ward", "single", "complete", "average", "mcquitty")
hclust_results &lt;- lapply(hclust_methods, function(m) hclust(d, m))
names(hclust_results) &lt;- hclust_methods 
hens &lt;- cl_ensemble(list = hclust_results)
summary(c(cl_agreement(hens)))
## Note that the Euclidean agreements are *very* small.
## This is because the ultrametrics differ substantially in height:
u &lt;- lapply(hens, cl_ultrametric)
round(sapply(u, max), 3)
## Rescaling the ultrametrics to [0, 1] gives:
u &lt;- lapply(u, function(x) (x - min(x)) / (max(x) - min(x)))
shens &lt;- cl_ensemble(list = lapply(u, as.cl_dendrogram))
summary(c(cl_agreement(shens)))
## Au contraire ...
summary(c(cl_agreement(hens, method = "cophenetic")))
cl_agreement(hens[1:3], hens[4:5], method = "gamma")
</code></pre>


</div>