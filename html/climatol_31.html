<div class="container">

<table style="width: 100%;"><tr>
<td>QCthresholds</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Obtain monthly thresholds for Quality Control alerts</h2>

<h3>Description</h3>

<p>This function calculate monthly quantiles of daily or subdaily series that can be used as thresholds for Quality Control alerts.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  QCthresholds(dat, ndec=1, probs=c(0.,.001,.01,.99,.999,1.), minval=NA,
  maxval=NA, homog=TRUE, verb=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>Either the name of a *.rda file of <code>climatol</code> homogenization results or a data.frame of daily (or subdaily) data in columns, dates or date/times (of class Date or POSIXct) in the first column and station codes in the header</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndec</code></td>
<td>
<p>number of decimals of output values [1] (defaults shown between brackets)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>
<p>probabilities of the quantiles to be computed [0., .001, .01, .99, .999, 1.]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minval</code></td>
<td>
<p>minimum value to compute runs of constant values [<code>NA</code>].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxval</code></td>
<td>
<p>maximum value to compute runs of constant values [<code>NA</code>].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>homog</code></td>
<td>
<p>use homogenized data if a *.rda file is used as input [<code>TRUE</code>].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verb</code></td>
<td>
<p>list all calculated values? [<code>TRUE</code>].</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>minval</code> and <code>maxval</code> allow to exclude frequent values that would
result in the report of long runs of identical data. Examples: set
<code>minval=0.1</code> in daily precipitation to avoid long runs of zeros or set
<code>maxval=97</code> in relative humidity to avoid long runs of near saturation
values in episodes of persistent fog.
</p>
<p>Calculated thresholds are shown in the text output and are also saved in a
binary R file named <code>QCthresholds.Rdat</code>, which contains the matrices
<code>thr1</code>, <code>thr2</code> and <code>thr3</code>. Load this file and write the
thresholds in the required format for importation into a Climate Data
Management System.
</p>


<h3>See Also</h3>

<p><code>homogen</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## Set a temporal working directory and write input files:
wd &lt;- tempdir()
wd0 &lt;- setwd(wd)
data(climatol_data)

## Now run the examples:
QCthresholds(RR3st,minval=0.1) #daily precipitation of three stations
QCthresholds(TX3st) #daily maximum temperatures of three stations
load('QCthresholds.Rdat') #load last calculated thresholds
thr1[1,,] #thresholds with 0% probability to find lower values
thr1[,3,] #monthly thresholds of the third station
thr2 #thresholds of absolute increments between consecutive data
thr3 #thresholds for equal data run lengths

## Return to user's working directory:
setwd(wd0)

## Input and output files can be found in directory:
print(wd)
</code></pre>


</div>