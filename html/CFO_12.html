<div class="container">

<table style="width: 100%;"><tr>
<td>CFOeff.simu</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Conduct one simulation using the calibration-free odds (CFO) design for phase I/II trials</h2>

<h3>Description</h3>

<p>In the CFO design for phase I/II trials, the function is used to conduct one single simulation and find the optimal biological dose (OBD).
</p>


<h3>Usage</h3>

<pre><code class="language-R">CFOeff.simu(target, p.true, pE.true, ncohort=10, init.level=1,  cohortsize=3,
                   prior.para = list(alp.prior = target, bet.prior = 1 - target, 
                   alp.prior.eff = 0.5, bet.prior.eff = 0.5), 
                   cutoff.eli = 0.95, early.stop = 0.95, 
                   effearly.stop = 0.9, mineff, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>
<p>the target DLT rate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.true</code></td>
<td>
<p>the true DLT rates under the different dose levels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pE.true</code></td>
<td>
<p>the true efficacy rates under the different dose levels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncohort</code></td>
<td>
<p>the total number of cohorts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init.level</code></td>
<td>
<p>the dose level assigned to the first cohort. The default value of <code>init.level</code> is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cohortsize</code></td>
<td>
<p>the number of patients of each cohort.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior.para</code></td>
<td>
<p>the prior parameters for two beta distributions, where set as <code>list(alp.prior = target, 
                 bet.prior = 1 - target, alp.prior.eff = 0.5, bet.prior.eff = 0.5)</code> by default. <code>alp.prior</code> and <code>bet.prior</code>
represent the parameters of the prior distribution for the true DLT rate at any dose level. This prior distribution
is specified as Beta(<code>alpha.prior</code>, <code>beta.prior</code>). <code>alp.eff.prior</code> and <code>bet.eff.prior</code>
represent the parameters of the Jeffreys' prior distribution for the efficacy probability at any dose level.
This prior distribution is specified as Beta(<code>alpha.eff.prior</code>, <code>beta.eff.prior</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff.eli</code></td>
<td>
<p>the cutoff to eliminate overly toxic doses for safety. We recommend
the default value of <code>cutoff.eli = 0.95</code> for general use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>early.stop</code></td>
<td>
<p>the threshold value for early stopping due to overly toxic. The default value <code>early.stop = 0.95</code>
generally works well.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effearly.stop</code></td>
<td>
<p>the threshold value for early stopping due to low efficacy. The trial would be terminated
early if <code class="reqn">Pr(q_k&lt;\psi |y_k,m_k \ge 3)</code> is smaller than the value of <code>effearly.stop</code> where <code class="reqn">q_k, y_k</code> and <code class="reqn">m_k</code>
are the efficacy probability, the number of efficacy outcomes and the number of patients at dose level <code class="reqn">k</code>.
<code class="reqn">\psi</code> is the the lowest acceptable efficacy rate which is set by <code>mineff</code> here.
By default, <code>effearly.stop</code> is set as <code>0.9</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mineff</code></td>
<td>
<p>the lowest acceptable efficacy rate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>an integer to be set as the seed of the random number generator for reproducible results. The default value is set to <code>NULL</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The <code>CFOeff.simu</code> function returns a list object comprising the following components:
</p>

<ul>
<li>
<p> OBD: the selected OBD. <code>OBD = 99</code> indicates that the simulation is terminated due to early stopping.
</p>
</li>
<li>
<p> target: the target DLT rate.
</p>
</li>
<li>
<p> npatients: the total number of patients allocated to all dose levels.
</p>
</li>
<li>
<p> neff: the total number of efficacy outcomes for all dose levels.
</p>
</li>
<li>
<p> ntox: the total number of DLTs observed for all dose levels.
</p>
</li>
<li>
<p> pE.true: the true efficacy rates under the different dose levels.
</p>
</li>
<li>
<p> p.true: the true DLT rates under the different dose levels.
</p>
</li>
<li>
<p> cohortdose: a vector including the dose level assigned to each cohort.
</p>
</li>
<li>
<p> ptoxic: the percentage of subjects assigned to dose levels with a DLT rate greater than the target.
</p>
</li>
<li>
<p> patientDLT: a vector including the DLT outcome observed for each patient.
</p>
</li>
<li>
<p> patienteff: a vector including the efficacy outcome observed for each patient.
</p>
</li>
<li>
<p> over.doses: a vector indicating whether each dose is overdosed or not (1 for yes).
</p>
</li>
<li>
<p> under.eff: a vector indicating whether the efficacy of each dose is lower than
acceptable efficacy rate (1 for yes).
</p>
</li>
<li>
<p> correct: a binary indicator of whether the recommended dose level matches the correct OBD (1 for yes).
The correct OBD is the dose level in the admissible set with the upper bound being the correct MTD,
which has the highest true efficacy probability.
</p>
</li>
<li>
<p> sumDLT: the total number of DLT observed.
</p>
</li>
<li>
<p> sumeff: the total number of efficacy outcome observed.
</p>
</li>
<li>
<p> earlystop: a binary indicator of whether the trial is early stopped (1 for yes).
</p>
</li>
<li>
<p> stopreason: the reason for earlystop. <code>overly_toxic</code> represents the trial was terminated
beacuse all tested doses were overly toxic. <code>low_efficacy</code> represents the trial was terminated
because all tested doses show low efficacy.
</p>
</li>
<li>
<p> class: the phase of the trial.
</p>
</li>
</ul>
<h3>Note</h3>

<p>The <code>CFOeff.simu</code> function is designed to conduct a single CFO simulation for phase I/II trials. The dose elimination rule is the
same as the case in phase I (refer to the function <code>CFO.simu</code>). As for early stopping rule, compared to the case of phase I, the rule
in this case further considers the efficacy data to terminate the trial early if none of the admissible dose levels show adequate
efficacious effect.
</p>


<h3>Author(s)</h3>

<p>Jialu Fang, Wenliang Wang, Ninghao Zhang, and Guosheng Yin
</p>


<h3>References</h3>

<p>Jin H, Yin G (2022). CFO: Calibration-free odds design for phase I/II clinical trials.
<em>Statistical Methods in Medical Research</em>, 31(6), 1051-1066. <br></p>


<h3>Examples</h3>

<pre><code class="language-R">target &lt;- 0.30; mineff &lt;- 0.30; cohortsize = 3; ncohort = 20; init.level = 1
prior.para = list(alp.prior = target, bet.prior = 1 - target, 
                  alp.prior.eff = 0.5, bet.prior.eff = 0.5)
p.true=c(0.05, 0.07, 0.1, 0.12, 0.16)
pE.true=c(0.35, 0.45, 0.5, 0.55, 0.75)
result &lt;- CFOeff.simu(target, p.true, pE.true, ncohort, init.level, cohortsize,
                       prior.para, mineff = mineff, seed = 1)
summary(result)
plot(result)
### overly toxic
target &lt;- 0.30; mineff &lt;- 0.30; cohortsize = 3; ncohort = 20; init.level = 1
prior.para = list(alp.prior = target, bet.prior = 1 - target, 
                  alp.prior.eff = 0.5, bet.prior.eff = 0.5)
p.true=c(0.55, 0.57, 0.61, 0.62, 0.66)
pE.true=c(0.35, 0.45, 0.5, 0.55, 0.75)
result &lt;- CFOeff.simu(target, p.true, pE.true, ncohort, init.level, cohortsize,
                       prior.para, mineff = mineff, seed = 1)
summary(result)
plot(result)

### low efficacy
target &lt;- 0.30; mineff &lt;- 0.30; cohortsize = 3; ncohort = 20; init.level = 1
prior.para = list(alp.prior = target, bet.prior = 1 - target, 
                  alp.prior.eff = 0.5, bet.prior.eff = 0.5)
p.true=c(0.05, 0.07, 0.1, 0.12, 0.16)
pE.true=c(0.001, 0.003, 0.004, 0.005, 0.006)
result &lt;- CFOeff.simu(target, p.true, pE.true, ncohort, init.level, cohortsize,
                       prior.para, mineff = mineff, seed = 1)
summary(result)
plot(result)

</code></pre>


</div>