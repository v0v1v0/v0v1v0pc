<div class="container">

<table style="width: 100%;"><tr>
<td>chopthin</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The Chopthin Resampler</h2>

<h3>Description</h3>

<p>A fast implementation of the Chopthin resampler. Can be used as the
resampling step in particle filters and in sequential Monte Carlo.
</p>


<h3>Usage</h3>

<pre><code class="language-R">chopthin(w, N, eta = 5.828427, normalise = TRUE, checks = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>a vector of weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>target number of particles</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta</code></td>
<td>
<p>upper bound on the ratio between the weights. Must be &gt;=4.
If eta=Inf then only thinnig is performed, requiring the number of weights to be at least N.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalise</code></td>
<td>
<p>Flag for controlling if the returned weights should
be normalised. If TRUE (default) then the sum of the returned
weights will sum to N. If FALSE then the returned weights have
the same sum as the original weights (within the numerical precision).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>checks</code></td>
<td>
<p>Flag controlling if checks on the input and the result should be performed. Default TRUE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with two elements: new weights and indices
of the ancestors of the new particles. The weights are normalised to add up to N.
</p>


<h3>References</h3>

<p>A Gandy and F. D-H Lau. The chopthin algorithm for
resampling.  IEEE Transactions on Signal Processing, 64(16):4273â€“4281, 2016
</p>


<h3>Examples</h3>

<pre><code class="language-R">chopthin(runif(10),N=10)
chopthin(runif(10),N=20,4)
chopthin(runif(10),N=5)
chopthin(runif(10),N=1)
</code></pre>


</div>