<div class="container">

<table style="width: 100%;"><tr>
<td>CFOeff.next</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Determination of the dose level for next cohort in the calibration-free odds (CFO) design for phase I/II trials</h2>

<h3>Description</h3>

<p>In the CFO design for phase I/II trials, the function is used to determine the dose movement
based on the toxicity outcomes and efficacy outcomes of the enrolled cohorts.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CFOeff.next(target, txs, tys, tns, currdose, 
                   prior.para=list(alp.prior = target, bet.prior = 1 - target, 
                   alp.prior.eff = 0.5, bet.prior.eff = 0.5),  
                   cutoff.eli=0.95, early.stop=0.95, effearly.stop = 0.9, mineff)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>
<p>the target DLT rate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>txs</code></td>
<td>
<p>the cumulative counts of efficacy outcomes at all dose levels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tys</code></td>
<td>
<p>the cumulative counts of DLTs observed at all dose levels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tns</code></td>
<td>
<p>the cumulative counts of patients treated at all dose levels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>currdose</code></td>
<td>
<p>the current dose level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior.para</code></td>
<td>
<p>the prior parameters for two beta distributions, where set as <code>list(alp.prior = target, 
                 bet.prior = 1 - target, alp.prior.eff = 0.5, bet.prior.eff = 0.5)</code> by default. <code>alp.prior</code> and <code>bet.prior</code>
represent the parameters of the prior distribution for the true DLT rate at any dose level. This prior distribution
is specified as Beta(<code>alpha.prior</code>, <code>beta.prior</code>). <code>alp.eff.prior</code> and <code>bet.eff.prior</code>
represent the parameters of the Jeffreys' prior distribution for the efficacy probability at any dose level.
This prior distribution is specified as Beta(<code>alpha.eff.prior</code>, <code>beta.eff.prior</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff.eli</code></td>
<td>
<p>the cutoff to eliminate overly toxic doses for safety. We recommend
the default value of <code>cutoff.eli = 0.95</code> for general use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>early.stop</code></td>
<td>
<p>the threshold value for early stopping due to overly toxic. The default value <code>early.stop = 0.95</code>
generally works well.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effearly.stop</code></td>
<td>
<p>the threshold value for early stopping due to low efficacy. The trial would be terminated
early if <code class="reqn">Pr(q_k&lt;\psi |y_k,m_k \ge 3)</code> is smaller than the value of <code>effearly.stop</code> where <code class="reqn">q_k, y_k</code> and <code class="reqn">m_k</code>
are the efficacy probability, the number of efficacy outcomes and the number of patients at dose level <code class="reqn">k</code>.
<code class="reqn">\psi</code> is the the lowest acceptable efficacy rate which is set by <code>mineff</code> here.
By default, <code>effearly.stop</code> is set as <code>0.9</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mineff</code></td>
<td>
<p>the lowest acceptable efficacy rate.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The CFO design for phase I/II trials will determine admissible set <code class="reqn">A_n</code> through the dose escalation rules for the MTD. The current dose is set as
<code class="reqn">d_n</code>. If the decision is to de-escalate the dose, the set <code class="reqn">A_n</code> will be <code class="reqn">\{1,\dots,d_n-1\}</code>. If the decision is to stay at the
current dose, then the admissible set <code class="reqn">A_n</code> will be <code class="reqn">\{1,\dots,d_n\}</code>. If the decision is to escalate the dose, then <code class="reqn">A_n</code> will be
<code class="reqn">\{1,\dots,d_n+1\}</code>. The dose level <code class="reqn">d_{n+1}</code> for the next cohort will be selected from <code class="reqn">A_n</code> by using the rule:
<code class="reqn">d_{n+1} = argmax_{k\in A_n}Pr(q_k = max_{j\in A_n}\{q_j\}| D_n)</code> where <code class="reqn">D_n</code> and <code class="reqn">q_k</code> are the current data and the
efficacy probability for dose level <code class="reqn">k</code>.
</p>


<h3>Value</h3>

<p>The <code>CFOeff.next()</code> function returns a list object comprising the following elements:
</p>

<ul>
<li>
<p> target: the target DLT rate.
</p>
</li>
<li>
<p> txs: the cumulative counts of efficacy outcomes at all dose levels.
</p>
</li>
<li>
<p> tys: the cumulative counts of DLTs observed at all dose levels.
</p>
</li>
<li>
<p> tns: the cumulative counts of patients treated at all dose levels.
</p>
</li>
<li>
<p> decision: the decision in the CFO design, where <code>de-escalation</code>, <code>stay</code>, and <code>escalation</code> represent the
movement directions of the dose level, <code>stop_for_tox</code> indicates stopping the experiment because the lowest dose level
is overly toxic and <code>stop_for_low_eff</code> indicates that all dose level in the admissible set shows low efficacy.
</p>
</li>
<li>
<p> currdose: the current dose level.
</p>
</li>
<li>
<p> nextdose: the recommended dose level for the next cohort. <code>nextdose = 99</code> indicates that the trial is
terminated due to early stopping.
</p>
</li>
<li>
<p> overtox: the situation regarding which positions experience over-toxicity. The dose level indicated
by <code>overtox</code> and all the dose levels above experience over-toxicity. <code>overtox = NA</code> signifies that
the occurrence of over-toxicity did not happen.
</p>
</li>
<li>
<p> toxprob: the expected toxicity probability, <code class="reqn">Pr(p_k &gt; \phi | x_k, m_k)</code>, for doses in admissible set,
where <code class="reqn">p_k</code>, <code class="reqn">x_k</code>, and <code class="reqn">m_k</code> are the dose-limiting toxicity (DLT) rate, the
numbers of observed DLTs, and the numbers of patients at dose level <code class="reqn">k</code>.
</p>
</li>
<li>
<p> effprob: the empirical probability of <code class="reqn">Pr(q_k=max_{j\in A_n}\{q_j\}|D_n)</code> for doses in admissible set,
where <code class="reqn">q_k</code> is efficacy probability at dose level <code class="reqn">k</code>. <code class="reqn">A_n</code> is the admissible set determined through
the dose escalation rules for the MTD and <code class="reqn">D_n</code> is the current cumulative dataset.
</p>
</li>
<li>
<p> admset: the admissible set <code class="reqn">A_n</code>. The dose level for the next cohort will be selected from <code class="reqn">A_n</code>.
</p>
</li>
<li>
<p> class: the phase of the trial.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Jialu Fang, Wenliang Wang, Ninghao Zhang, and Guosheng Yin
</p>


<h3>References</h3>

<p>Jin H, Yin G (2022). CFO: Calibration-free odds design for phase I/II clinical trials.
<em>Statistical Methods in Medical Research</em>, 31(6), 1051-1066. <br></p>


<h3>Examples</h3>

<pre><code class="language-R">txs = c(3, 1, 7, 11, 26); tys = c(0, 0, 0, 0, 6); tns = c(6, 3, 12, 17, 36)
target &lt;- 0.4
decision &lt;- CFOeff.next(target,txs,tys,tns,currdose = 3, mineff = 0.3)
summary(decision)
#early stop for overly toxic
txs = c(13, 11, 7, 11, 26); tys = c(25, 18, 12, 17, 26); tns = c(36, 23, 22, 27, 36)
target &lt;- 0.4
decision &lt;- CFOeff.next(target,txs,tys,tns,currdose = 1, mineff = 0.3)
summary(decision)

#early stop for low efficacy
txs = c(0, 0, 0, 0, 0); tys = c(2, 1, 1, 1, 6); tns = c(36, 23, 22, 27, 36)
target &lt;- 0.4
decision &lt;- CFOeff.next(target,txs,tys,tns,currdose = 1, mineff = 0.3)
summary(decision)

</code></pre>


</div>