<div class="container">

<table style="width: 100%;"><tr>
<td>coversim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Confidence Region Coverage</h2>

<h3>Description</h3>

<p>Creates a confidence region and determines coverage results for a corresponding point of interest.
Iterates through a user specified number of trials.
Each trial uses a random dataset with user-specified parameters (default) or a user specified dataset
matrix (<code>'n'</code> samples per column, <code>'iter'</code> columns) and returns the corresponding actual coverage results.
See the CRAN website https://CRAN.R-project.org/package=conf for a link to a <code>coversim</code> vignette.
</p>


<h3>Usage</h3>

<pre><code class="language-R">coversim(alpha, distn,
                n         = NULL,
                iter      = NULL,
                dataset   = NULL,
                point     = NULL,
                seed      = NULL,
                a         = NULL,
                b         = NULL,
                kappa     = NULL,
                lambda    = NULL,
                mu        = NULL,
                s         = NULL,
                sigma     = NULL,
                theta     = NULL,
                heuristic = 1,
                maxdeg    = 5,
                ellipse_n = 4,
                pts       = FALSE,
                mlelab    = TRUE,
                sf        = c(5, 5),
                mar       = c(4, 4.5, 2, 1.5),
                xlab      = "",
                ylab      = "",
                main      = "",
                xlas      = 0,
                ylas      = 0,
                origin    = FALSE,
                xlim      = NULL,
                ylim      = NULL,
                tol       = .Machine$double.eps ^ 1,
                info      = FALSE,
                returnsamp  = FALSE,
                returnquant = FALSE,
                repair    = TRUE,
                exact     = FALSE,
                showplot  = FALSE,
                delay     = 0 )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>significance level; scalar or vector; resulting plot illustrates a 100(1 - <code>alpha</code>)% confidence region.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distn</code></td>
<td>
<p>distribution to fit the dataset to; accepted values: <code>'cauchy'</code>, <code>'gamma'</code>, <code>'invgauss'</code>,
<code>'logis'</code>, <code>'llogis'</code>, <code>'lnorm'</code>, <code>'norm'</code>, <code>'unif'</code>, <code>'weibull'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>trial sample size (producing each confidence region); scalar or vector; needed if a dataset is not given.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>iterations (or replications) of individual trials per parameterization; needed if a dataset is not given.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataset</code></td>
<td>
<p>a <code>'n'</code> x <code>'iter'</code> matrix of dataset values, or a vector of length <code>'n'</code> (for a
single iteration).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>point</code></td>
<td>
<p>coverage is assessed relative to this point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>random number generator seed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>distribution parameter (when applicable).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>distribution parameter (when applicable).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kappa</code></td>
<td>
<p>distribution parameter (when applicable).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>distribution parameter (when applicable).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>distribution parameter (when applicable).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>distribution parameter (when applicable).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>distribution parameter (when applicable).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>distribution parameter (when applicable).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>heuristic</code></td>
<td>
<p>numeric value selecting method for plotting: 0 for elliptic-oriented point distribution, and
1 for smoothing boundary search heuristic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxdeg</code></td>
<td>
<p>maximum angle tolerance between consecutive plot segments in degrees.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ellipse_n</code></td>
<td>
<p>number of roughly equidistant confidence region points to plot using the
elliptic-oriented point distribution (must be a multiple of four because its algorithm
exploits symmetry in the quadrants of an ellipse).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pts</code></td>
<td>
<p>displays confidence region boundary points if <code>TRUE</code> (applies to confidence region plots in which <code>showplot = TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mlelab</code></td>
<td>
<p>logical argument to include the maximum likelihood estimate coordinate point (default is <code>TRUE</code>,
applies to confidence region plots when <code>showplot = TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sf</code></td>
<td>
<p>significant figures in axes labels specified using sf = c(x, y), where x and y represent the optional digits argument
in the R function <code>round</code> as it pertains the horizontal and vertical labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mar</code></td>
<td>
<p>specifies margin values for <code>par(mar = c( ))</code> (see <code>mar</code> in <code>par</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>string specifying the horizontal axis label (applies to confidence region plots when <code>showplot = TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>string specifying the vertical axis label (applies to confidence region plots when <code>showplot = TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>string specifying the plot title (applies to confidence region plots when <code>showplot = TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlas</code></td>
<td>
<p>numeric value of 0, 1, 2, or 3 specifying the style of axis labels (see <code>las</code> in <code>par</code>,
applies to confidence region plots when <code>showplot = TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylas</code></td>
<td>
<p>numeric value of 0, 1, 2, or 3 specifying the style of axis labels (see <code>las</code> in <code>par</code>,
applies to confidence region plots when <code>showplot = TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>origin</code></td>
<td>
<p>logical argument to include the plot origin (applies to confidence region plots when <code>showplot = TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>two element vector containing horizontal axis minimum and maximum values (applies to confidence region plots
when <code>showplot = TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>two element vector containing vertical axis minimum and maximum values (applies to confidence region plots
when <code>showplot = TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>the <code>uniroot</code> parameter specifying its required accuracy.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>info</code></td>
<td>
<p>logical argument to return coverage information in a list; includes <code>alpha</code> value(s), <code>n</code> value(s), coverage
and error results per iteration, and <code>returnsamp</code> and/or <code>returnquant</code> when requested.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnsamp</code></td>
<td>
<p>logical argument; if <code>TRUE</code> returns random samples used in a matrix with <code>n</code> rows, <code>iter</code> cols.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnquant</code></td>
<td>
<p>logical argument; if <code>TRUE</code> returns random quantiles used in a matrix with <code>n</code> rows, <code>iter</code> cols.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>repair</code></td>
<td>
<p>logical argument to repair regions inaccessible using a radial angle from its MLE (multiple root azimuths).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exact</code></td>
<td>
<p>logical argument specifying if alpha value is adjusted to compensate for negative coverage bias in order to achieve
(1 - alpha) coverage probability using previously recorded Monte Carlo simulation results; available for limited values of
alpha (roughly &lt;= 0.2–0.3), n (typically n = 4, 5, ..., 50) and distributions (distn suffixes: weibull, llogis, norm).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showplot</code></td>
<td>
<p>logical argument specifying if each coverage trial produces a plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delay</code></td>
<td>
<p>numeric value of delay (in seconds) between trials so its plot can be seen (applies when <code>showplot = TRUE</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Parameterizations for supported distributions are given following
the default axes convention in use by <code>crplot</code> and <code>coversim</code>, which are:
</p>

<table>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: center;"> Horizontal </td>
<td style="text-align: center;"> Vertical</td>
</tr>
<tr>
<td style="text-align: left;">
Distribution  </td>
<td style="text-align: center;">  Axis  </td>
<td style="text-align: center;"> Axis</td>
</tr>
<tr>
<td style="text-align: left;">
Cauchy </td>
<td style="text-align: center;"> <code class="reqn">a</code> </td>
<td style="text-align: center;"> <code class="reqn">s</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
gamma </td>
<td style="text-align: center;"> <code class="reqn">\theta</code> </td>
<td style="text-align: center;"> <code class="reqn">\kappa</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
inverse Gaussian </td>
<td style="text-align: center;"> <code class="reqn">\mu</code> </td>
<td style="text-align: center;"> <code class="reqn">\lambda</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
log logistic </td>
<td style="text-align: center;"> <code class="reqn">\lambda</code> </td>
<td style="text-align: center;"> <code class="reqn">\kappa</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
log normal </td>
<td style="text-align: center;"> <code class="reqn">\mu</code> </td>
<td style="text-align: center;"> <code class="reqn">\sigma</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
logistic </td>
<td style="text-align: center;"> <code class="reqn">\mu</code> </td>
<td style="text-align: center;"> <code class="reqn">\sigma</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
normal </td>
<td style="text-align: center;"> <code class="reqn">\mu</code> </td>
<td style="text-align: center;"> <code class="reqn">\sigma</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
uniform </td>
<td style="text-align: center;"> <code class="reqn">a</code> </td>
<td style="text-align: center;"> <code class="reqn">b</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
Weibull </td>
<td style="text-align: center;"> <code class="reqn">\kappa</code> </td>
<td style="text-align: center;"> <code class="reqn">\lambda</code>
</td>
</tr>
</table>
<p>Each respective distribution is defined below.
</p>

<ul>
<li>
<p> The Cauchy distribution
for the real-numbered location parameter <code class="reqn">a</code>, scale parameter <code class="reqn">s</code>, and <code class="reqn">x</code> is a real number,
has the probability density function
</p>
<p style="text-align: center;"><code class="reqn">1 / (s \pi (1 + ((x - a) / s) ^ 2)).</code>
</p>

</li>
<li>
<p> The gamma distribution
for shape parameter <code class="reqn">\kappa &gt; 0</code>, scale parameter <code class="reqn">\theta &gt; 0</code>, and <code class="reqn">x &gt; 0</code>,
has the probability density function
</p>
<p style="text-align: center;"><code class="reqn">1 / (Gamma(\kappa) \theta ^ \kappa) x ^ {(\kappa - 1)} \exp(-x / \theta).</code>
</p>

</li>
<li>
<p> The inverse Gaussian distribution
for mean <code class="reqn">\mu &gt; 0</code>, shape parameter <code class="reqn">\lambda &gt; 0</code>, and <code class="reqn">x &gt; 0</code>,
has the probability density function
</p>
<p style="text-align: center;"><code class="reqn">\sqrt{(\lambda / (2 \pi x ^ 3))} \exp( - \lambda (x - \mu) ^ 2 / (2 \mu ^ 2 x)).</code>
</p>

</li>
<li>
<p> The log logistic distribution
for scale parameter <code class="reqn">\lambda &gt; 0</code>, shape parameter <code class="reqn">\kappa &gt; 0</code>, and <code class="reqn">x &gt; 0</code>,
has a probability density function
</p>
<p style="text-align: center;"><code class="reqn">(\kappa \lambda) (x \lambda) ^ {(\kappa - 1)} / (1 + (\lambda x) ^ \kappa) ^ 2.</code>
</p>

</li>
<li>
<p> The log normal distribution
for the real-numbered mean <code class="reqn">\mu</code> of the logarithm, standard deviation <code class="reqn">\sigma &gt; 0</code>
of the logarithm, and <code class="reqn">x &gt; 0</code>,
has the probability density function
</p>
<p style="text-align: center;"><code class="reqn">1 / (x \sigma \sqrt{2 \pi}) \exp(-(\log x - \mu) ^ 2 / (2 \sigma ^ 2)).</code>
</p>

</li>
<li>
<p> The logistic distribution
for the real-numbered location parameter <code class="reqn">\mu</code>, scale parameter <code class="reqn">\sigma</code>, and <code class="reqn">x</code> is a real number,
has the probability density function
</p>
<p style="text-align: center;"><code class="reqn">(1 / \sigma) \exp((x - \mu) / \sigma) (1 + \exp((x - \mu) / \sigma)) ^ {-2}</code>
</p>

</li>
<li>
<p> The normal distribution
for the real-numbered mean <code class="reqn">\mu</code>, standard deviation <code class="reqn">\sigma &gt; 0</code>, and <code class="reqn">x</code> is a real number,
has the probability density function
</p>
<p style="text-align: center;"><code class="reqn">1 / \sqrt{2 \pi \sigma ^ 2} \exp(-(x - \mu) ^ 2 / (2 \sigma ^ 2)).</code>
</p>

</li>
<li>
<p> The uniform distribution for real-valued parameters <code class="reqn">a</code> and <code class="reqn">b</code> where <code class="reqn">a &lt; b</code>
and <code class="reqn">a \le x \le b</code>,
has the probability density function
</p>
<p style="text-align: center;"><code class="reqn">1 / (b - a).</code>
</p>

</li>
<li>
<p> The Weibull distribution
for scale parameter <code class="reqn">\lambda &gt; 0</code>, shape parameter <code class="reqn">\kappa &gt; 0</code>, and <code class="reqn">x &gt; 0</code>,
has the probability density function
</p>
<p style="text-align: center;"><code class="reqn">\kappa (\lambda ^ \kappa) x ^ {(\kappa - 1)} \exp(-(\lambda x) ^ \kappa).</code>
</p>

</li>
</ul>
<h3>Value</h3>

<p>If the optional argument <code>info = TRUE</code> is included then a list of coverage results is returned.  That list
includes <code>alpha</code> value(s), <code>n</code> value(s), coverage and error results per iteration.  Additionally, <code>returnsamp = TRUE</code>
and/or <code>returnquant = TRUE</code> will result in an <code>n</code> row, <code>iter</code> column maxtix of sample and/or sample cdf values.
</p>


<h3>Author(s)</h3>

<p>Christopher Weld (<a href="mailto:ceweld241@gmail.com">ceweld241@gmail.com</a>)
</p>
<p>Lawrence Leemis (<a href="mailto:leemis@math.wm.edu">leemis@math.wm.edu</a>)
</p>


<h3>References</h3>

<p>C. Weld, A. Loh, L. Leemis (2020), "Plotting Two-Dimensional Confidence Regions",
The American Statistician, Volume 72, Number 2, 156–168.
</p>


<h3>See Also</h3>

<p><code>crplot</code>, <code>uniroot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## assess actual coverage at various alpha = {0.5, 0.1} given n = 30 samples,  completing
## 10 trials per parameterization (iter) for a normal(mean = 2, sd = 3) rv
coversim(alpha = c(0.5, 0.1), "norm", n = 30, iter = 10, mu = 2, sigma = 3)

## show plots for 5 iterations of 30 samples each from a Weibull(2, 3)
coversim(0.5, "weibull", n = 30, iter = 5, lambda = 1.5, kappa = 0.5, showplot = TRUE,
origin = TRUE)

</code></pre>


</div>