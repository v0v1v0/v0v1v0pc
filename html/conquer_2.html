<div class="container">

<table style="width: 100%;"><tr>
<td>conquer</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Convolution-Type Smoothed Quantile Regression</h2>

<h3>Description</h3>

<p>Estimation and inference for conditional linear quantile regression models using a convolution smoothed approach. Efficient gradient-based methods are employed for fitting both a single model and a regression process over a quantile range. 
Normal-based and (multiplier) bootstrap confidence intervals for all slope coefficients are constructed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">conquer(
  X,
  Y,
  tau = 0.5,
  kernel = c("Gaussian", "logistic", "uniform", "parabolic", "triangular"),
  h = 0,
  checkSing = FALSE,
  tol = 1e-04,
  iteMax = 5000,
  stepBounded = TRUE,
  stepMax = 100,
  ci = c("none", "bootstrap", "asymptotic", "both"),
  alpha = 0.05,
  B = 1000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>An <code class="reqn">n</code> by <code class="reqn">p</code> design matrix. Each row is a vector of observations with <code class="reqn">p</code> covariates. Number of observations <code class="reqn">n</code> must be greater than number of covariates <code class="reqn">p</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>An <code class="reqn">n</code>-dimensional response vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>(<strong>optional</strong>) The desired quantile level. Default is 0.5. Value must be between 0 and 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel</code></td>
<td>
<p>(<strong>optional</strong>)  A character string specifying the choice of kernel function. Default is "Gaussian". Choices are "Gaussian", "logistic", "uniform", "parabolic" and "triangular".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>(<strong>optional</strong>) Bandwidth/smoothing parameter. Default is <code class="reqn">\max\{((log(n) + p) / n)^{0.4}, 0.05\}</code>. The default will be used if the input value is less than or equal to 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>checkSing</code></td>
<td>
<p>(<strong>optional</strong>) A logical flag. Default is FALSE. If <code>checkSing = TRUE</code>, then it will check if the design matrix is singular before running conquer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>(<strong>optional</strong>) Tolerance level of the gradient descent algorithm. The iteration will stop when the maximum magnitude of all the elements of the gradient is less than <code>tol</code>. Default is 1e-04.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iteMax</code></td>
<td>
<p>(<strong>optional</strong>) Maximum number of iterations. Default is 5000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stepBounded</code></td>
<td>
<p>(<strong>optional</strong>) A logical flag. Default is TRUE. If <code>stepBounded = TRUE</code>, then the step size of gradient descent is upper bounded by <code>stepMax</code>. If <code>stepBounded = FALSE</code>, then the step size is unbounded.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stepMax</code></td>
<td>
<p>(<strong>optional</strong>) Maximum bound for the gradient descent step size. Default is 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>
<p>(<strong>optional</strong>) A character string specifying methods to construct confidence intervals. Choices are "none" (default), "bootstrap", "asymptotic" and "both". If <code>ci = "none"</code>, then confidence intervals will not be constructed. 
If <code>ci = "bootstrap"</code>, then three types of confidence intervals (percentile, pivotal and normal) will be constructed via multiplier bootstrap. 
If <code>ci = "asymptotic"</code>, then confidence intervals will be constructed based on estimated asymptotic covariance matrix. 
If <code>ci = "both"</code>, then confidence intervals from both bootstrap and asymptotic covariance will be returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>(<strong>optional</strong>) Miscoverage level for each confidence interval. Default is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>(<strong>optional</strong>) The size of bootstrap samples. Default is 1000.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object containing the following items will be returned:
</p>

<dl>
<dt><code>coeff</code></dt>
<dd>
<p>A <code class="reqn">(p + 1)</code>-vector of estimated quantile regression coefficients, including the intercept.</p>
</dd>
<dt><code>ite</code></dt>
<dd>
<p>Number of iterations until convergence.</p>
</dd>
<dt><code>residual</code></dt>
<dd>
<p>An <code class="reqn">n</code>-vector of fitted residuals.</p>
</dd>
<dt><code>bandwidth</code></dt>
<dd>
<p>Bandwidth value.</p>
</dd>
<dt><code>tau</code></dt>
<dd>
<p>Quantile level.</p>
</dd>
<dt><code>kernel</code></dt>
<dd>
<p>Kernel function.</p>
</dd>
<dt><code>n</code></dt>
<dd>
<p>Sample size.</p>
</dd>
<dt><code>p</code></dt>
<dd>
<p>Number of covariates.</p>
</dd>
<dt><code>perCI</code></dt>
<dd>
<p>The percentile confidence intervals for regression coefficients. Only available if <code>ci = "bootstrap"</code> or <code>ci = "both"</code>.</p>
</dd>
<dt><code>pivCI</code></dt>
<dd>
<p>The pivotal confidence intervals for regression coefficients. Only available if <code>ci = "bootstrap"</code> or <code>ci = "both"</code>.</p>
</dd>
<dt><code>normCI</code></dt>
<dd>
<p>The normal-based confidence intervals for regression coefficients. Only available if <code>ci = "bootstrap"</code> or <code>ci = "both"</code>.</p>
</dd>
<dt><code>asyCI</code></dt>
<dd>
<p>The asymptotic confidence intervals for regression coefficients. Only available if <code>ci = "asymptotic"</code> or <code>ci = "both"</code>.</p>
</dd>
</dl>
<h3>References</h3>

<p>Barzilai, J. and Borwein, J. M. (1988). Two-point step size gradient methods. IMA J. Numer. Anal., 8, 141â€“148.
</p>
<p>Fernandes, M., Guerre, E. and Horta, E. (2021). Smoothing quantile regressions. J. Bus. Econ. Statist., 39, 338-357.
</p>
<p>He, X., Pan, X., Tan, K. M., and Zhou, W.-X. (2022+). Smoothed quantile regression for large-scale inference. J. Econometrics, in press.
</p>
<p>Koenker, R. and Bassett, G. (1978). Regression quantiles. Econometrica, 46, 33-50.
</p>


<h3>See Also</h3>

<p>See <code>conquer.process</code> for smoothed quantile regression process.
</p>


<h3>Examples</h3>

<pre><code class="language-R">n = 500; p = 10
beta = rep(1, p)
X = matrix(rnorm(n * p), n, p)
Y = X %*% beta + rt(n, 2)

## Smoothed quantile regression with Gaussian kernel
fit.Gauss = conquer(X, Y, tau = 0.5, kernel = "Gaussian")
beta.hat.Gauss = fit.Gauss$coeff

## Smoothe quantile regression with uniform kernel
fit.unif = conquer(X, Y, tau = 0.5, kernel = "uniform")
beta.hat.unif = fit.unif$coeff

## Construct three types of confidence intervals via multiplier bootstrap
fit = conquer(X, Y, tau = 0.5, kernel = "Gaussian", ci = "bootstrap")
ci.per = fit$perCI
ci.piv = fit$pivCI
ci.norm = fit$normCI
</code></pre>


</div>