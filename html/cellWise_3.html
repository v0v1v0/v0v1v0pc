<div class="container">

<table style="width: 100%;"><tr>
<td>cellMCD</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
cellWise minimum covariance determinant estimator
</h2>

<h3>Description</h3>

<p>The cellwise minimum covariance determinant estimator
computes cellwise robust estimates of the center and covariance matrix of a data set <code>X</code>. The algorithm guarantees a monotone decrease of an objective function, 
which is based on observed Gaussian log-likelihood. By default, it starts by calling <code>checkDataSet</code> to clean the data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cellMCD(X, alpha = 0.75, quant = 0.99,
        crit = 1e-4, noCits = 100, lmin = 1e-4,
        checkPars = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p><code>X</code> is the input data, and must be an <code class="reqn">n</code> by <code class="reqn">d</code> matrix or a data frame.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>In each column, at least <code class="reqn">n*</code><code>alpha</code> cells must remain unflagged. Defaults to <code class="reqn">75</code>%, should not be set (much) lower.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quant</code></td>
<td>
<p>Determines the cutoff value to flag cells. Defaults to <code class="reqn">0.99</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crit</code></td>
<td>
<p>The iteration stops when successive covariance matrices (of the standardized data) differ by less than <code>crit</code>. Defaults to <code class="reqn">1e-4</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noCits</code></td>
<td>
<p>The maximal number of C-steps used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lmin</code></td>
<td>
<p> a lower bound on the eigenvalues of the estimated covariance matrix on the standardized data. Defaults to <code class="reqn">1e-4</code>. Should not be smaller than <code class="reqn">1e-6</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>checkPars</code></td>
<td>
<p>Optional list of parameters used in the call to
<code>checkDataSet</code>. The options are:
</p>

<ul>
<li> <p><code>coreOnly</code> <br>
If <code>TRUE</code>, skip the execution of checkDataset. Defaults to <code>FALSE</code>.
</p>
</li>
<li> <p><code>numDiscrete</code><br>
A column that takes on numDiscrete or fewer values
will be considered discrete and not retained in the cleaned data.
Defaults to <code class="reqn">5</code>.
</p>
</li>
<li> <p><code>fracNA</code><br>
Only retain columns and rows with fewer NAs than this fraction.
Defaults to <code class="reqn">0.5</code>.
</p>
</li>
<li>
<p><code>precScale</code> <br>
Only consider columns whose scale is larger than precScale.
Here scale is measured by the median absolute deviation.
Defaults to <code class="reqn">1e-12</code>.
</p>
</li>
<li>
<p><code>silent</code><br>
Whether or not the function progress messages should be suppressed.
Defaults to <code>FALSE</code>.
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The matrix <code>raw.S</code> in the output is the raw estimate of scatter produced by cellMCD. The final <code>S</code> is obtained from <code>raw.S</code> by rescaling such that its diagonal entries equal the squares of the univariate scales in <code>locsca$scale</code>. This reduces the bias at Gaussian data, which matters mainly for large sample sizes.</p>


<h3>Value</h3>

<p>A list with components: <br></p>

<ul>
<li> <p><code>mu</code> <br>
the cellMCD estimate of location.
</p>
</li>
<li> <p><code>S</code> <br>
the cellMCD estimate of scatter, after bias correction (see details).
</p>
</li>
<li> <p><code>W</code> <br>
the cellMCD estimate of <code>W</code>, a binary matrix indicating all outlying cells as zero.
</p>
</li>
<li> <p><code>preds</code> <br>
predictions (=conditional expectations) of the flagged cells, given the clean cells in the same row.
</p>
</li>
<li> <p><code>csds</code> <br>
conditional standard deviations of the flagged cells, given the clean cells in the same row.
</p>
</li>
<li> <p><code>Ximp</code> <br>
imputed data matrix.
</p>
</li>
<li> <p><code>Zres</code> <br>
matrix of cellwise standardized residuals.
</p>
</li>
<li> <p><code>raw.S</code> <br>
the raw cellMCD estimate of scatter, without bias correction.
</p>
</li>
<li> <p><code>locsca</code> <br>
list containing robust locations and scales used to standardize the data before running the algorithm. The results <code>m</code>, <code>S</code>, <code>preds</code>, <code>Ximp</code> are returned in their original location/scale. 
</p>
</li>
<li> <p><code>nosteps</code> <br>
number of steps the algorithm took to converge.
</p>
</li>
<li> <p><code>X</code> <br>
the data on which the algorithm was executed.
</p>
</li>
<li> <p><code>quant</code> <br>
the cutoff used to flag the cells.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>J. Raymaekers and P.J. Rousseeuw
</p>


<h3>References</h3>

<p>J. Raymaekers and P.J. Rousseeuw (2022). The cellwise MCD estimator, Journal of the American Statistical Association, to appear.
<a href="https://doi.org/10.1080/01621459.2023.2267777">doi:10.1080/01621459.2023.2267777</a>(link to open access pdf)
</p>


<h3>See Also</h3>

<p><code>plot_cellMCD</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">mu    &lt;- rep(0, 3)
Sigma &lt;- diag(3) * 0.5 + 0.5
set.seed(123)
X &lt;- MASS::mvrnorm(1000, mu, Sigma)
X[1:5, 1]  &lt;- X[1:5, 1] + 5
X[6:10, 2] &lt;- X[6:10, 2] - 10
X[12, 1:2] &lt;- c(-4,8)
colnames(X) &lt;- c("X1","X2","X3")
cellMCD.out &lt;- cellMCD(X)
cellMCD.out$mu
cov2cor(cellMCD.out$S)
cellMCD.out$W[1:15,]
cellMCD.out$Ximp[1:15,]
cellMap(cellMCD.out$Zres[1:15,])

# For more examples, we refer to the vignette:
## Not run: 
vignette("cellMCD_examples")

## End(Not run)
</code></pre>


</div>