<div class="container">

<table style="width: 100%;"><tr>
<td>AdamontQQCorr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>AdamontQQCorr computes quantile-quantile correction of seasonal or decadal
forecast data using weather types</h2>

<h3>Description</h3>

<p>This function computes a quantile mapping based on weather types
for experiment data (typically a hindcast) onto reference <code>obs</code>,
typically provided by reanalysis data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">AdamontQQCorr(
  exp,
  wt_exp,
  obs,
  wt_obs,
  corrdims = c("member", "sdate", "ftime"),
  londim = "lon",
  latdim = "lat",
  regrid = FALSE,
  NN = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>exp</code></td>
<td>
<p>Array with named dimensions (such as <code>$data</code> array of 
experiment data from an object of class <code>s2dv_cube</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wt_exp</code></td>
<td>
<p>Corresponding weather types (same dimensions as <code>exp</code> but
lat/lon).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs</code></td>
<td>
<p>Array with named dimensions with reference data (can also be 
<code>$data</code> array of class <code>s2dv_cube</code>). lat/lon dimensions can differ 
from <code>exp</code> if non rectilinear latlon grids are used, in which case 
regrid should be set to TRUE and .NearestNeighbors <code>NN</code> output should 
be provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wt_obs</code></td>
<td>
<p>Corresponding weather types (same dimensions as <code>obs</code> but
lat/lon).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corrdims</code></td>
<td>
<p>List of dimensions in <code>exp</code> for which quantile mapping 
correction is applied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>londim</code></td>
<td>
<p>Character name of longitude dimension in <code>exp</code> and 
<code>obs</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>latdim</code></td>
<td>
<p>Character name of latitude dimension in <code>exp</code> and 
<code>obs</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>regrid</code></td>
<td>
<p>(optional) Boolean indicating whether .NearestNeighbors
regridding is needed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NN</code></td>
<td>
<p>(optional, if regrid = TRUE) List (output from .NearestNeighbors)
maps (nlat, nlon) onto (nlat_o, nlon_o).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An array (such as <code>$data</code> array from an object of class 
<code>s2dv_cube</code>) with named dimensions, containing experiment data on the 
lat/lon grid of <code>obs</code> array, corrected by quantile mapping depending on 
the weather types <code>wt_exp</code>
</p>


<h3>Author(s)</h3>

<p>Paola Marson, <a href="mailto:paola.marson@meteo.fr">paola.marson@meteo.fr</a> for PROSNOW version
</p>
<p>Lauriane Batt√©, <a href="mailto:lauriane.batte@meteo.fr">lauriane.batte@meteo.fr</a> for CSTools adaptation
</p>


<h3>Examples</h3>

<pre><code class="language-R">wt_exp &lt;- c(1,1,2,3,3,2,2,1,1,2,2,3)
dim(wt_exp) &lt;- c(dataset = 1, member = 1, sdate = 4, ftime = 3)
wt_obs &lt;- c(3,3,1,2,2,2,2,1,3,1,1,2) 
dim(wt_obs) &lt;- c(dataset = 1, member = 1, sdate = 4, ftime = 3)
exp &lt;- 1 : c(1 * 1 * 4 * 3 * 4 * 4)
dim(exp) &lt;- c(dataset = 1, member = 1, sdate = 4, ftime = 3,
             lat = 4, lon = 4)
obs &lt;- 101 : c(100 + 1 * 1 * 4 * 3 * 4 * 4)
dim(obs) &lt;- c(dataset = 1, member = 1, sdate = 4, ftime = 3,
             lat = 4, lon = 4)
exp_corr &lt;- AdamontQQCorr(exp = exp, wt_exp = wt_exp, 
                         obs = obs, wt_obs = wt_obs, 
                         corrdims = c('dataset', 'member', 'sdate', 'ftime'))
</code></pre>


</div>