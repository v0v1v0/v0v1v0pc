<div class="container">

<table style="width: 100%;"><tr>
<td>CSCI</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Pointwise Confidence Intervals for Current Status Data
</h2>

<h3>Description</h3>

<p>Calculates several different methods for getting pointwise confidence intervals for current st
</p>


<h3>Usage</h3>

<pre><code class="language-R">CSCI(C, D, times=NULL, type = c("VALID", "ABA", "LIKELIHOOD"), 
   conf.level = 0.95, control=controlCSCI())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>

<p>a vector of assessement times
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>

<p>a vector of indicators of event at or before the assessment time
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>

<p>a vector of times, t, to give the confidence interval for the event time distribution, F(t). If NULL then set to <code>sort(unique(C))</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>type of confidence interval, either "VALID", "ABA", or "LIKELIHOOD" (see details)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>

<p>confidence level for intervals (for <code>type="LIKELIHOOD"</code> only specific values are allowed, see note)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>

<p>list with parameters for algorithms, see <code>controlCSCI</code>
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function does three types of pointwise confidence intervals for the cumulative distribution function for the event time at the times specified by <code>times</code>. When <code>type="VALID"</code> the function gives a method that guarantees that the coverage will be at least nominal, but the confidence intervals are not ensured to be monotonic over the times of interest. When <code>type="ABA"</code> the function 
gives an approximate method that 
does not guarantee coverage, but has been shown by simulation to have good coverage for 
smoothly changing distributions,
and it does ensure monotonicity (see Kim, et al, 2020). 
When <code>type="LIKELIHOOD"</code> the function gives an asymptotic likelihood ratio test-based confidence interval that does not guarantee coverage
(Banerjee and Wellner, 2001).
</p>


<h3>Value</h3>

<p>A list with 2 objects:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>ciTable_all</code></td>
<td>
<p>data.frame with NPMLE and associated confidence intervals for all possible time values (not output for type='LIKELIHOOD')</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ciTable_times</code></td>
<td>
<p>data.frame with NPMLE and assoicated confidence intervals for the values of 'times' argument</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Because the likelihood ratio test goes to a non-standard asymptotic distribution, we do not calculate quantiles from that distribution, but take them from Table 2 of Banerjee and Wellner (2001). Because of this, when <code>type="LIKELIHOOD"</code> then 
conf.level must be one of 0.25,0.50,0.75,0.80,0.85,0.90,0.95, or 0.99.</p>


<h3>Author(s)</h3>

<p>Sungwook Kim
</p>


<h3>References</h3>

<p>Banerjee, M. and J. A. Wellner (2001). Likelihood ratio tests for monotone functions.
Ann. Statist. 29 (6), 1699-1731.
</p>
<p>Kim, S, Fay, MP, Proschan, MA (2020). Valid and Approximately Valid Confidence Intervals for Current Status Data.
(see <a href="https://arxiv.org/abs/1805.06488">https://arxiv.org/abs/1805.06488</a>).
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(hepABulg)
CSCI(C=hepABulg$age,D=hepABulg$testPos,type="VALID")

</code></pre>


</div>