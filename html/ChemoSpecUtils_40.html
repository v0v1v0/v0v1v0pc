<div class="container">

<table style="width: 100%;"><tr>
<td>plotScores</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot Scores from PCA, MIA or PARAFAC Analysis of a Spectra or Spectra2D Object</h2>

<h3>Description</h3>

<p>Plots the requested scores using the color scheme derived from the
<code>Spectra</code> or <code>Spectra2D</code> object.
Options are provided to add confidence ellipses for each group in the object.
The ellipses may be robust or classical.  Option to label the extreme points provided.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotScores(
  spectra,
  so,
  pcs = c(1, 2),
  ellipse = "none",
  tol = "none",
  use.sym = FALSE,
  leg.loc = "topright",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>spectra</code></td>
<td>
<p>An object of S3 class <code>ChemoSpec::Spectra()</code> or <code>ChemoSpec2D::Spectra2D()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>so</code></td>
<td>
<p>"Score Object" One of the following:
</p>

<ul>
<li>
<p> An object of class <code>prcomp</code>, created by <code>ChemoSpec</code> functions
<code>c_pcaSpectra</code>, <code>r_pcaSpectra</code>,
<code>irlba_pcaSpectra</code> or <code>s_pcaSpectra</code>.
</p>
</li>
<li>
<p> An object of class <code>mia</code> produced by
function <code>miaSpectra2D</code>.
</p>
</li>
<li>
<p> An object of class <code>parafac</code> produced by
function <code>pfacSpectra2D</code>.
</p>
</li>
<li>
<p> An object of class <code>pop</code> produced by
function <code>popSpectra2D</code>.
</p>
</li>
</ul>
<p>Any of the above score objects will have been modified to include a
list element called <code>$method</code>, a character string describing the
pre-processing carried out and the type of PCA performed (used to annotate the
plot).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pcs</code></td>
<td>
<p>A vector of two integers specifying the components (scores) to plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ellipse</code></td>
<td>
<p>A character vector specifying the type of ellipses to be
plotted.  One of <code>c("both"</code>, <code>"none"</code>, <code>"cls"</code>, <code>"rob")</code>.  <code>cls</code>
specifies classical confidence ellipses, <code>rob</code> specifies robust
confidence ellipses.  An ellipse is drawn for each group unless there
are three or fewer samples in the group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>A number describing the fraction of points to be labeled. <code>tol = 1.0</code> labels all the points; <code>tol = 0.05</code> labels <em>approximately</em> the most extreme 5 percent. Set to <code>'none'</code> to completely suppress labels. Note that a simple approach based upon quantiles is used, assumes that both x and y are each normally distributed, and treats x and y separately.  Thus, this is not a formal treatment of outliers, just a means of labeling points. Groups are lumped together for the computation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.sym</code></td>
<td>
<p>A logical; if TRUE, the color scheme is set to black and the
points plotted with symbols.  Applies only to <code>Spectra</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leg.loc</code></td>
<td>
<p>Either a list with elements <code>x</code> and <code>y</code>, or a string like <code>'topright'</code>.  Values in a list should be on <code style="white-space: pre;">⁠[0,1]⁠</code>, i.e. the lower left of the plot area is <code style="white-space: pre;">⁠0,0⁠</code> and the upper right is <code style="white-space: pre;">⁠1,1⁠</code>.  Allowed string values are those described in <code>graphics::legend()</code> under 'Details'. A value of <code>'none'</code> is acceptable as well.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Parameters to be passed to the plotting routines. <em>Applies to base graphics only</em>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The returned value depends on the graphics option selected (see <code>GraphicsOptions()</code>).
</p>

<ul>
<li> <p><code>base</code>: None.  Side effect is a plot.
</p>
</li>
<li> <p><code>ggplot2</code>: The plot is displayed, and a <code>ggplot2</code> object is returned if the value is assigned.  The plot can be modified in the usual <code>ggplot2</code> manner.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University), Tejasvi Gupta.
</p>


<h3>Examples</h3>

<pre><code class="language-R">if (checkForPackageWithVersion("ChemoSpec", 6.0)) {
  library("ChemoSpec")
  # This example assumes the graphics output is set to ggplot2 (see ?GraphicsOptions).
  library("ggplot2")
  data(metMUD1)

  pca &lt;- c_pcaSpectra(metMUD1)
  p &lt;- plotScores(metMUD1, pca, pcs = c(1, 2), ellipse = "cls", tol = 0.05)
  p &lt;- p + ggtitle("metMUD1 NMR Data")
  p
}

if (checkForPackageWithVersion("ChemoSpec2D", 0.5)) {
  library("ChemoSpec2D")
  library("ggplot2")
  data(MUD1)

  mia &lt;- miaSpectra2D(MUD1)
  p1 &lt;- plotScores(MUD1, mia, tol = 0.1, ellipse = "cls")
  p1 &lt;- p1 + ggtitle("MIA Scores")
  p1

  set.seed(123)
  pfac &lt;- pfacSpectra2D(MUD1, parallel = FALSE, nfac = 2)
  p2 &lt;- plotScores(MUD1, pfac, tol = 0.1, leg.loc = "bottomright")
  p2 &lt;- p2 + ggtitle("PARAFAC Score Plot")
  p2
}
</code></pre>


</div>