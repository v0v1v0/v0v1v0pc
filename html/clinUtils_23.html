<div class="container">

<table style="width: 100%;"><tr>
<td>getClinDT</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create an interactive table to display clinical data</h2>

<h3>Description</h3>

<p>This function converts a <code>data.frame</code> from R into 
a <code>datatable</code> object
with sensitive defaults.<br>
Extra functionalities are available to:
</p>

<ul>
<li>
<p> have columns or cells of interest that are collapsible/expandable
(see <code>expandVar</code>/<code>expandIdx</code>)
</p>
</li>
<li>
<p> group rows based on a variable (see <code>rowGroupVar</code>)
</p>
</li>
<li>
<p> display a variable as barplot (with specified range of threshold)
(see <code>barVar</code>)
</p>
</li>
<li>
<p> hide variable(s) (see <code>nonVisibleVar</code>)
</p>
</li>
</ul>
<h3>Usage</h3>

<pre><code class="language-R">getClinDT(
  data,
  nonVisibleVar = NULL,
  nonVisible = NULL,
  percVar = NULL,
  barVar = NULL,
  barColorThr = NULL,
  barRange = NULL,
  filter = "top",
  searchBox = FALSE,
  pageLength,
  fixedColumns = NULL,
  columnsWidth = NULL,
  options = list(),
  expandVar = NULL,
  expandIdx = NULL,
  escape = TRUE,
  rowGroup = NULL,
  rowGroupVar = NULL,
  vAlign = "top",
  callback = NULL,
  buttons = getClinDTButtons(),
  scrollX = TRUE,
  file = NULL,
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data.frame, matrix or <code>SharedData</code>
object with input data for the table.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nonVisibleVar</code></td>
<td>
<p>Character vector with column(s) in <code>data</code> to 
hide in the output table (column is hidden).<br>
The column(s) also get the extra attribute: <code>className = 'noVis'</code>,
to ensure they are not displayed in the
button to show/hide column(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nonVisible</code></td>
<td>
<p>This parameter is deprecated, use the new interface
with the <code>nonVisibleVar</code> parameter. 
Numeric vector with column(s)
in <code>data</code> to not display in the output table (column is hidden),
in <strong>Javascript unit: first column is 0</strong>, second column is 1, ...</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>percVar</code></td>
<td>
<p>Character vector with percentage columns.
These columns should contain the percentage from 0 to 1.
The content of these colunms will be rounded to 2 digits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>barVar</code></td>
<td>
<p>Character vector with numeric variable of <code>data</code>
which should be represented as bar in the table.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>barColorThr</code></td>
<td>
<p>Numeric vector with threshold to 
consider to color the bar, either:
</p>

<ul>
<li>
<p> a numeric vector of length 1, same threshold for all bars
</p>
</li>
<li>
<p> named vector with threshold for each bar, named with the variable
in <code>barVar</code>
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>barRange</code></td>
<td>
<p>(optional) range for the bars, either:
</p>

<ul>
<li>
<p> a numeric vector of length 2, same range for all bars
</p>
</li>
<li>
<p> list with range for each bar, named with the variable
in <code>barVar</code>
</p>
</li>
</ul>
<p>If not specified, the range of each <code>barVar</code> variable
in <code>data</code> is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filter</code></td>
<td>
<p>String with position of the filter boxes
(<code>filter</code> parameter of the <code>datatable</code> function), 
'top' by default. Set to 'none' to not included any filtering boxes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>searchBox</code></td>
<td>
<p>Logical, if TRUE (FALSE by default)
a general search box is included.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pageLength</code></td>
<td>
<p>Numeric with number of records to include in one page,
by default set to 10.
Set to Inf to include all records.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixedColumns</code></td>
<td>
<p>List with fixed columns, see corresponding
parameter in the <code>options</code> parameter of the <code>datatable</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>columnsWidth</code></td>
<td>
<p>Character vector with column width,
of length 1 (used for all columns) or of length: <code>ncol(data)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>options</code></td>
<td>
<p>List with additional <code>datatable</code> options.
This parameter overwrites the default options set internally
in the function (an indicative message mentions it if that is the case).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expandVar</code></td>
<td>
<p>Character vector with expandable variables of <code>data</code>.
These columns won't be included in the table, but displayed
for each row when the '+' icon in the first column 
of the table will be clicked on.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expandIdx</code></td>
<td>
<p>Matrix named with: 'row'/'column'
containing row/column indices to expand.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>escape</code></td>
<td>
<p>Column(s) to escape in the table
(e.g. containing raw HTML code), either character, numeric or logical of length 1.
See corresponding parameter in the <code>datatable</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rowGroup</code></td>
<td>
<p>This parameter is deprecated, please use <code>rowGroup</code> instead.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rowGroupVar</code></td>
<td>
<p>Character vector with colname(s) of <code>data</code>
containing variables to group rows by.
This creates row header containing this column.
Please note that the original row order in <code>data</code> is respected,
so you might want to order rows based on the grouping variables upfront.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vAlign</code></td>
<td>
<p>String with vertical alignment for the cells,
'top' by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>callback</code></td>
<td>
<p>String with custom Javascript callback function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>buttons</code></td>
<td>
<p>DataTable buttons
(passed to the 'buttons' element of the <code>options</code> parameter of <code>datatable</code>).
See <code>getClinDTButtons</code> for the default options.
To remove all buttons, set this parameter to NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scrollX</code></td>
<td>
<p>Logical, if TRUE (by default) a horizontal scrolling bar
is included. 
Note: this differs from the <code>datatable</code> default (FALSE),
because required for <code>bookdown::gitbook</code> output if table is too wide.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>(optional) String with name of html file to which the
created DT should be exported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical, if TRUE (by default) informative messages
are displayed, e.g. if specified <code>options</code> overwrite the
internal default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters for the <code>datatable</code> function,
e.g table width.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>datatable</code> object.
</p>


<h3>Author(s)</h3>

<p>Laure Cougnaud
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(dataADaMCDISCP01)
labelVars &lt;- attr(dataADaMCDISCP01, "labelVars")

# example of simple adverse event table
dataAE &lt;- dataADaMCDISCP01$ADAE
subjectsSafety &lt;- subset(dataADaMCDISCP01$ADSL, SAFFL == "Y")$USUBJID

# compute counts of subjects presenting each AE
tableAE &lt;- stats::aggregate(
	USUBJID ~ AESOC:AEDECOD,
	data = dataAE, 
	FUN = function(usubjid)	length(unique(usubjid))
)
colnames(tableAE)[colnames(tableAE) == "USUBJID"] &lt;- "N"
# and percentages
tableAE$perc &lt;- round(tableAE$N/length(subjectsSafety)*100, 3)
# sort records in decreasing percentage
tableAE &lt;- tableAE[order(tableAE$perc, decreasing = TRUE), ]

# extract new variables labels
tableAELabels &lt;- getLabelVar(
	var = colnames(tableAE),
	labelVars = labelVars,
	label = c(N = '# subjects', perc = "% subjects")
)
# 'colnames' for DT should be specified as c('new name' = 'old name', ...)
tableAELabelsDT &lt;- setNames(names(tableAELabels), tableAELabels)

## create table with bar

# default:
getClinDT(
	data = tableAE,
	barVar = "perc",
	colnames = tableAELabelsDT
)

# specify range for the bar
getClinDT(
	data = tableAE,
	filter = "none",
	barVar = "perc",
	barRange = c(0, 100),
	colnames = tableAELabelsDT
)

# change color according to threshold
getClinDT(
	data = tableAE,
	filter = "none",
	barVar = "perc",
	barColorThr = seq(from = 0, to = 100, by = 25),
	colnames = tableAELabelsDT
)

## group per system organ class (and decreasing N):
tableAESOC &lt;- aggregate(N ~ AESOC, data = tableAE, FUN = sum)
tableAE$AESOC &lt;- factor(tableAE$AESOC,
	levels = tableAESOC[order(tableAESOC$N, decreasing = FALSE), "AESOC"]
)
tableAE &lt;- tableAE[order(tableAE$AESOC, tableAE$perc, decreasing = TRUE), ]
	
getClinDT(
	data = tableAE,
	filter = "none",
	barVar = "perc",
	barRange = c(0, 100),
	colnames = tableAELabelsDT,
	rowGroupVar = "AESOC",
	pageLength = Inf
)

# expand the subject ID column, will
# be accessible when clicking on the '+' button
# Format URL correctly with: 'escape',
# please note that indexing starts at 0!
getClinDT(
	data = tableAE,
	barVar = "perc",
	colnames = tableAELabelsDT,
	expandVar = "USUBJID", 
	escape = grep("USUBJID", colnames(tableAE))-1
)

# fix size for columns
getClinDT(
	data = tableAE,
	colnames = tableAELabelsDT,
	fixedColumns = list(leftColumns = 1),
	columnsWidth = c(0.1, 0.7, 0.1, 0.1),
	width = "350px" # change dimension table
)

## Not run: # due to time constraint in CRAN

# change default buttons
getClinDT(
	data = tableAE,
	colnames = tableAELabelsDT,
	# remove general filter
	filter = "none",
	# custom set of buttons
	buttons = getClinDTButtons(type = c("csv", "excel", "pdf"))
)
# add button to select columns
getClinDT(
	data = tableAE,
	colnames = tableAELabelsDT,
	# custom set of buttons
	buttons = getClinDTButtons(typeExtra = "colvis")
)
# export pdf in landscape format
buttons &lt;- getClinDTButtons(
	opts = list(pdf = list(orientation = "landscape"))
)
getClinDT(
	data = tableAE,
	colnames = tableAELabelsDT,
	# custom set of buttons
	buttons = buttons
)

# hide the first column:
getClinDT(
	data = tableAE,
	nonVisibleVar = "AESOC"
)

# with specific caption
library(htmltools)
caption &lt;- tags$caption(
	"Number of subjects with adverse events grouped by system organ class.",
	br(), 
	paste(
		"Percentages are based on the total number of patients having",
		"received a first study treatment."
	)
)
getClinDT(
	data = tableAE,
	filter = "none",
	barVar = "perc",
	barRange = c(0, 100),
	pageLength = Inf,
	colnames = tableAELabelsDT,
	rowGroupVar = "AESOC",
	caption = caption
)


## End(Not run)
</code></pre>


</div>