<div class="container">

<table style="width: 100%;"><tr>
<td>CDVineCondRank</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Ranking of C- and D- vines allowing for conditional simulation</h2>

<h3>Description</h3>

<p>Provides a ranking of the C- and D- vines which allow for conditional 
sampling, under the condition discussed in the descriprion of <code>CDVineCondFit</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CDVineCondRank(data, Nx, treecrit = "AIC", selectioncrit = "AIC",
  familyset = NA, type = "CVine-DVine", indeptest = FALSE, level = 0.05,
  se = FALSE, rotations = TRUE, method = "mle")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>An <code>N x d</code> data matrix (with uniform margins).
Data of the conditioning variable(s) have to occupy the last column(s) of this matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nx</code></td>
<td>
<p>Number of conditioning variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>treecrit</code></td>
<td>
<p>Character indicating the criteria used to select the vine. All possible vines are fitted trough 
the function <code>RVineCopSelect</code> of the package <code>VineCopula</code>. Then the vines are ranked with respect 
the Akaike information criterion (<code>treecrit = "AIC"</code>, default) or Bayesian information criterion (<code>treecrit = "BIC"</code>). 
This need the estimation and model selection for all the pairs of all the possible vines, therefore could 
require long time in case of large datasets, i.e. large <code>N x d</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selectioncrit</code></td>
<td>
<p>Character indicating the criterion for pair-copula selection.
Possible choices are <code>selectioncrit = "AIC"</code> (default) and <code>"BIC"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>familyset</code></td>
<td>
<p>"Integer vector of pair-copula families to select from. The vector has to include at least one
pair-copula family that allows for positive and one that allows for negative
dependence. Not listed copula families might be included to better handle
limit cases.  If <code>familyset = NA</code> (default), selection among all
possible families is performed. If a vector of negative numbers is provided,
selection among all but <code>abs(familyset)</code> is performed. Coding of bivariate copula families: <br><code>0</code> = independence copula <br><code>1</code> = Gaussian copula <br><code>2</code> = Student t copula (t-copula) <br><code>3</code> = Clayton copula <br><code>4</code> = Gumbel copula <br><code>5</code> = Frank copula <br><code>6</code> = Joe copula <br><code>7</code> = BB1 copula <br><code>8</code> = BB6 copula <br><code>9</code> = BB7 copula <br><code>10</code> = BB8 copula <br><code>13</code> = rotated Clayton copula (180 degrees; “survival Clayton”) <br><code>14</code> = rotated Gumbel copula (180 degrees; “survival Gumbel”) <br><code>16</code> = rotated Joe copula (180 degrees; “survival Joe”) <br><code>17</code> = rotated BB1 copula (180 degrees; “survival BB1”)<br><code>18</code> = rotated BB6 copula (180 degrees; “survival BB6”)<br><code>19</code> = rotated BB7 copula (180 degrees; “survival BB7”)<br><code>20</code> = rotated BB8 copula (180 degrees; “survival BB8”)<br><code>23</code> = rotated Clayton copula (90 degrees) <br><code>24</code> = rotated Gumbel copula (90 degrees) <br><code>26</code> = rotated Joe copula (90 degrees) <br><code>27</code> = rotated BB1 copula (90 degrees) <br><code>28</code> = rotated BB6 copula (90 degrees) <br><code>29</code> = rotated BB7 copula (90 degrees) <br><code>30</code> = rotated BB8 copula (90 degrees) <br><code>33</code> = rotated Clayton copula (270 degrees) <br><code>34</code> = rotated Gumbel copula (270 degrees) <br><code>36</code> = rotated Joe copula (270 degrees) <br><code>37</code> = rotated BB1 copula (270 degrees) <br><code>38</code> = rotated BB6 copula (270 degrees) <br><code>39</code> = rotated BB7 copula (270 degrees) <br><code>40</code> = rotated BB8 copula (270 degrees) <br><code>104</code> = Tawn type 1 copula <br><code>114</code> = rotated Tawn type 1 copula (180 degrees) <br><code>124</code> = rotated Tawn type 1 copula (90 degrees) <br><code>134</code> = rotated Tawn type 1 copula (270 degrees) <br><code>204</code> = Tawn type 2 copula <br><code>214</code> = rotated Tawn type 2 copula (180 degrees) <br><code>224</code> = rotated Tawn type 2 copula (90 degrees) <br><code>234</code> = rotated Tawn type 2 copula (270 degrees)" (VineCopula Documentation, version 2.1.1, pp. 73-74)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Type of vine to be fitted: <br>
C-Vine: "CVine" or 1; <br>
D-Vine: "DVine" or 2; <br>
Both C and D-Vine: "CVine-DVine" or "1-2" (default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indeptest</code></td>
<td>
<p>"Logical; whether a hypothesis test for the independence of
<code>u1</code> and <code>u2</code> is performed before bivariate copula selection
(default: <code>indeptest = FALSE</code>; see <code>BiCopIndTest</code>).  The
independence copula is chosen for a (conditional) pair if the null
hypothesis of independence cannot be rejected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>numeric; significance level of the independence test (default:
<code>level = 0.05</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>Logical; whether standard errors are estimated (default: <code>se
= FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rotations</code></td>
<td>
<p>logical; if <code>TRUE</code>, all rotations of the families in
<code>familyset</code> are included.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>indicates the estimation method: either maximum
likelihood estimation (<code>method = "mle"</code>; default) or inversion of
Kendall's tau (<code>method = "itau"</code>). For <code>method = "itau"</code> only
one parameter families and the Student t copula can be used (<code>family =
1,2,3,4,5,6,13,14,16,23,24,26,33,34</code> or <code>36</code>). For the t-copula,
<code>par2</code> is found by a crude profile likelihood optimization over the
interval (2, 10]." (VineCopula Documentation, version 2.1.1, pp. 74-75)</p>
</td>
</tr>
</table>
<h3>Value</h3>


<dl>
<dt><code>table</code></dt>
<dd>
<p>A table with the ranking of the vines, with vine index <code>i</code>,
values of the selected <code>treecrit</code> and vine <code>type</code> (1 for "CVine" and 2 for D-Vine).</p>
</dd>
<dt><code>vines</code></dt>
<dd>
<p>A list where the element <code>[[i]]</code> is an <code>RVineMatrix</code> object corresponding to
the <code>i</code>-th vine in the ranking shown in <code>table</code>. 
Each <code>RVineMatrix</code> object containes the selected families (<code>$family</code>) as well as sequentially
estimated parameters stored in <code>$par</code> and <code>$par2</code>. Details about <code>RVineMatrix</code> objects are given in 
the documentation file of the <code>VineCopula</code> package). 
The fit of each model is performed via the function <code>RVineCopSelect</code> of the package <code>VineCopula</code>. 
"The object is augmented by the following information about the fit: 
</p>

<dl>
<dt><code>se, se2</code></dt>
<dd>
<p>standard errors for the parameter estimates  (if <code>se = TRUE</code>; note that these are only 
approximate since they do not account for the sequential nature of the estimation</p>
</dd>
<dt><code>nobs</code></dt>
<dd>
<p>number of observations</p>
</dd>
<dt><code>logLik, pair.logLik</code></dt>
<dd>
<p>log likelihood (overall and pairwise)</p>
</dd>
<dt><code>AIC, pair.AIC</code></dt>
<dd>
<p>Aikaike's Informaton Criterion (overall and pairwise)</p>
</dd>
<dt><code>BIC, pair.BIC</code></dt>
<dd>
<p>Bayesian's Informaton Criterion (overall and pairwise)</p>
</dd>
<dt><code>emptau</code></dt>
<dd>
<p>matrix of empirical values of Kendall's tau</p>
</dd>
<dt><code>p.value.indeptest</code></dt>
<dd>
<p>matrix of p-values of the independence test.</p>
</dd>
</dl>
</dd>
</dl>
<h3>Note</h3>

<p>For a comprehensive summary of the vine copula model, use
<code>summary(object)</code>; to see all its contents, use <code>str(object)</code>." (VineCopula Documentation, version 2.1.1, pp. 103)
</p>


<h3>Author(s)</h3>

<p>Emanuele Bevacqua
</p>


<h3>References</h3>

<p>Bevacqua, E., Maraun, D., Hobaek Haff, I., Widmann, M., and Vrac, M.: Multivariate statistical modelling of compound events via pair-copula constructions: analysis of floods in Ravenna (Italy), 
Hydrol. Earth Syst. Sci., 21, 2701-2723, https://doi.org/10.5194/hess-21-2701-2017, 2017.
<a href="https://www.researchgate.net/publication/317414374_Multivariate_statistical_modelling_of_compound_events_via_pair-copula_constructions_Analysis_of_floods_in_Ravenna_Italy">[link]</a> 
<a href="https://www.hydrol-earth-syst-sci.net/21/2701/2017/hess-21-2701-2017.html">[link]</a> 
</p>
<p>Aas, K., Czado, C., Frigessi, A. and Bakken, H.: Pair-copula constructions of multiple dependence, Insurance:
Mathematics and Economics, 44(2), 182-198, &lt;doi:10.1016/j.insmatheco.2007.02.001&gt;, 2009. 
<a href="http://www.sciencedirect.com/science/article/pii/S0167668707000194">[link]</a> 
</p>
<p>Ulf Schepsmeier, Jakob Stoeber, Eike Christian Brechmann, Benedikt Graeler, Thomas 
Nagler and Tobias Erhardt (2017). VineCopula: Statistical Inference of Vine Copulas. R 
package version 2.1.1. <a href="https://CRAN.R-project.org/package=VineCopula">[link]</a>
</p>


<h3>See Also</h3>

<p><code>CDVineCondFit</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Read data
data(dataset)
data &lt;- dataset$data[1:100,1:5]

# Define the variables Y and X. X are the conditioning variables, 
# which have to be positioned in the last columns of the data.frame
colnames(data) &lt;- c("Y1","Y2","X3","X4","X5")

# Rank the possible D-Vines according to the AIC
## Not run: 
Ranking &lt;- CDVineCondRank(data,Nx=3,"AIC",type="DVine")
Ranking$table
#    tree       AIC type
# 1     1 -292.8720    2
# 2     2 -290.2941    2
# 3     3 -288.5719    2
# 4     4 -288.2496    2
# 5     5 -287.8006    2
# 6     6 -285.8503    2
# 7     7 -282.2867    2
# 8     8 -278.9371    2
# 9     9 -275.8339    2
# 10   10 -272.9459    2
# 11   11 -271.1526    2
# 12   12 -270.5269    2

Ranking$vines[[1]]$AIC
# [1] -292.8720
summary(Ranking$vines[[1]])

## End(Not run)

</code></pre>


</div>