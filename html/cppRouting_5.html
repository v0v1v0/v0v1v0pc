<div class="container">

<table style="width: 100%;"><tr>
<td>get_detour</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Return the nodes that can be reached in a detour time set around the shortest path</h2>

<h3>Description</h3>

<p>Return the nodes that can be reached in a detour time set around the shortest path
</p>


<h3>Usage</h3>

<pre><code class="language-R">get_detour(Graph, from, to, extra = NULL, keep = NULL, long = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Graph</code></td>
<td>
<p>An object generated by makegraph or cpp_simplify function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>from</code></td>
<td>
<p>A vector of one or more vertices from which shortest path are calculated (origin).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>to</code></td>
<td>
<p>A vector of one or more vertices (destination).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extra</code></td>
<td>
<p>numeric. Additional cost</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep</code></td>
<td>
<p>numeric or character. Vertices of interest that will be returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>long</code></td>
<td>
<p>logical. If <code>TRUE</code>, a long <code>data.frame</code> is returned instead of a list.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Each returned nodes <em>n</em> meet the following condition :
</p>
<p><strong>SP(o,n) + SP(n,d) &lt; SP(o,d) + t</strong>
</p>
<p>with <em>SP</em> shortest distance/time, <em>o</em> the origin node, <em>d</em> the destination node and <em>t</em> the extra cost.
</p>
<p>Modified bidirectional Dijkstra algorithm is ran for each path.
</p>
<p>This algorithm is <strong>multithreaded.</strong> Please use <code>RcppParallel::setThreadOptions()</code> to set the number of threads.
</p>


<h3>Value</h3>

<p><code>list</code> or a <code>data.frame</code> of nodes that can be reached
</p>


<h3>Note</h3>

<p><code>from</code> and <code>to</code> must be the same length.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Choose number of cores used by cppRouting
RcppParallel::setThreadOptions(numThreads = 1)

if(requireNamespace("igraph",quietly = TRUE)){

#Generate fully connected graph
gf&lt;- igraph::make_full_graph(400)
igraph::V(gf)$names&lt;-1:400

#Convert to data frame and add random weights
df&lt;-igraph::as_long_data_frame(gf)
df$dist&lt;-sample(1:100,nrow(df),replace = TRUE)

#Construct cppRouting graph
graph&lt;-makegraph(df[,c(1,2,5)],directed = FALSE)

#Pick up random origin and destination node
origin&lt;-sample(1:400,1)
destination&lt;-sample(1:400,1)

#Compute distance from origin to all nodes
or_to_all&lt;-get_distance_matrix(graph,from=origin,to=1:400)

#Compute distance from all nodes to destination
all_to_dest&lt;-get_distance_matrix(graph,from=1:400,to=destination,)

#Get all shortest paths from origin to destination, passing by each node of the graph
total_paths&lt;-rowSums(cbind(t(or_to_all),all_to_dest))

#Compute shortest path between origin and destination
distance&lt;-get_distance_pair(graph,from=origin,to=destination)

#Compute detour with an additional cost of 3
det&lt;-get_detour(graph,from=origin,to=destination,extra=3)

#Check result validity
length(unlist(det))
length(total_paths[total_paths &lt; distance + 3])

}
</code></pre>


</div>