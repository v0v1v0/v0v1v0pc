<div class="container">

<table style="width: 100%;"><tr>
<td>COMMA_PVW</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Predictive Value Weighting Estimation of the Binary Mediator Misclassification Model</h2>

<h3>Description</h3>

<p>Estimate <code class="reqn">\beta</code>, <code class="reqn">\gamma</code>, and <code class="reqn">\theta</code> parameters from
the true mediator, observed mediator, and outcome mechanisms, respectively,
in a binary mediator misclassification model using a predictive value weighting
approach.
</p>


<h3>Usage</h3>

<pre><code class="language-R">COMMA_PVW(
  Mstar,
  outcome,
  outcome_distribution,
  interaction_indicator,
  x_matrix,
  z_matrix,
  c_matrix,
  beta_start,
  gamma_start,
  theta_start,
  tolerance = 1e-07,
  max_em_iterations = 1500,
  em_method = "squarem"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Mstar</code></td>
<td>
<p>A numeric vector of indicator variables (1, 2) for the observed
mediator <code>M*</code>. There should be no <code>NA</code> terms. The reference category is 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outcome</code></td>
<td>
<p>A vector containing the outcome variables of interest. There
should be no <code>NA</code> terms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outcome_distribution</code></td>
<td>
<p>A character string specifying the distribution of
the outcome variable. Options are <code>"Bernoulli"</code>,
<code>"Poisson"</code>, or <code>"Normal"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interaction_indicator</code></td>
<td>
<p>A logical value indicating if an interaction between
<code>x</code> and <code>m</code> should be used to generate the outcome variable, <code>y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_matrix</code></td>
<td>
<p>A numeric matrix of predictors in the true mediator and outcome mechanisms.
<code>x_matrix</code> should not contain an intercept and no values should be <code>NA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z_matrix</code></td>
<td>
<p>A numeric matrix of covariates in the observation mechanism.
<code>z_matrix</code> should not contain an intercept and no values should be <code>NA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c_matrix</code></td>
<td>
<p>A numeric matrix of covariates in the true mediator and outcome mechanisms.
<code>c_matrix</code> should not contain an intercept and no values should be <code>NA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_start</code></td>
<td>
<p>A numeric vector or column matrix of starting values for the <code class="reqn">\beta</code>
parameters in the true mediator mechanism. The number of elements in <code>beta_start</code>
should be equal to the number of columns of <code>x_matrix</code> and <code>c_matrix</code> plus 1.
Starting values should be provided in the following order: intercept, slope
coefficient for the <code>x_matrix</code> term, slope coefficient for first column
of the <code>c_matrix</code>, ..., slope coefficient for the final column of the <code>c_matrix</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma_start</code></td>
<td>
<p>A numeric vector or matrix of starting values for the <code class="reqn">\gamma</code>
parameters in the observation mechanism. In matrix form, the <code>gamma_start</code> matrix rows
correspond to parameters for the <code>M* = 1</code>
observed mediator, with the dimensions of <code>z_matrix</code> plus 1, and the
gamma parameter matrix columns correspond to the true mediator categories
<code class="reqn">M \in \{1, 2\}</code>. A numeric vector for <code>gamma_start</code> is
obtained by concatenating the gamma matrix, i.e. <code>gamma_start &lt;- c(gamma_matrix)</code>.
Starting values should be provided in the following order within each column:
intercept, slope coefficient for first column of the <code>z_matrix</code>, ...,
slope coefficient for the final column of the <code>z_matrix</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta_start</code></td>
<td>
<p>A numeric vector or column matrix of starting values for the <code class="reqn">\theta</code>
parameters in the outcome mechanism. The number of elements in <code>theta_start</code>
should be equal to the number of columns of <code>x_matrix</code> and <code>c_matrix</code> plus 2
(if <code>interaction_indicator</code> is <code>FALSE</code>) or 3 (if
<code>interaction_indicator</code> is <code>TRUE</code>). Starting values should be
provided in the following order: intercept, slope coefficient for the <code>x_matrix</code> term,
slope coefficient for the mediator <code>m</code> term,
slope coefficient for first column of the <code>c_matrix</code>, ...,
slope coefficient for the final column of the <code>c_matrix</code>,
and, optionally, slope coefficient for <code>xm</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tolerance</code></td>
<td>
<p>A numeric value specifying when to stop estimation, based on
the difference of subsequent log-likelihood estimates. The default is <code>1e-7</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_em_iterations</code></td>
<td>
<p>A numeric value specifying when to stop estimation, based on
the difference of subsequent log-likelihood estimates. The default is <code>1e-7</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>em_method</code></td>
<td>
<p>A character string specifying which EM algorithm will be applied.
Options are <code>"em"</code>, <code>"squarem"</code>, or <code>"pem"</code>. The default and
recommended option is <code>"squarem"</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Note that this method can only be used for binary outcome models.
</p>


<h3>Value</h3>

<p><code>COMMA_PVW</code> returns a data frame containing four columns. The first
column, <code>Parameter</code>, represents a unique parameter value for each row.
The next column contains the parameter <code>Estimates</code>. The third column,
<code>Convergence</code>, reports whether or not the algorithm converged for a
given parameter estimate. The final column, <code>Method</code>, reports
that the estimates are obtained from the "PVW" procedure.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(20240709)
sample_size &lt;- 2000

n_cat &lt;- 2 # Number of categories in the binary mediator

# Data generation settings
x_mu &lt;- 0
x_sigma &lt;- 1
z_shape &lt;- 1
c_shape &lt;- 1

# True parameter values (gamma terms set the misclassification rate)
true_beta &lt;- matrix(c(1, -2, .5), ncol = 1)
true_gamma &lt;- matrix(c(1, 1, -.5, -1.5), nrow = 2, byrow = FALSE)
true_theta &lt;- matrix(c(1, 1.5, -2, -.2), ncol = 1)

example_data &lt;- COMMA_data(sample_size, x_mu, x_sigma, z_shape, c_shape,
                           interaction_indicator = FALSE,
                           outcome_distribution = "Bernoulli",
                           true_beta, true_gamma, true_theta)
                           
beta_start &lt;- matrix(rep(1, 3), ncol = 1)
gamma_start &lt;- matrix(rep(1, 4), nrow = 2, ncol = 2)
theta_start &lt;- matrix(rep(1, 4), ncol = 1)

Mstar = example_data[["obs_mediator"]]
outcome = example_data[["outcome"]]
x_matrix = example_data[["x"]]
z_matrix = example_data[["z"]]
c_matrix = example_data[["c"]]
                           
PVW_results &lt;- COMMA_PVW(Mstar, outcome, outcome_distribution = "Bernoulli",
                         interaction_indicator = FALSE,
                         x_matrix, z_matrix, c_matrix,
                         beta_start, gamma_start, theta_start)

PVW_results

</code></pre>


</div>