<div class="container">

<table style="width: 100%;"><tr>
<td>SO.trend.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Likelihood ratio test of stochastic ordering</h2>

<h3>Description</h3>

<p>Performs a likelihood ratio test of stochastic ordering versus equality using
permutations to estimate the null-distribution and the p-value.  If only the
value of the test statistic is needed, use <code>SO.LRT</code> instead.
</p>


<h3>Usage</h3>

<pre><code class="language-R">SO.trend.test(cbdata, R = 100, control = soControl())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cbdata</code></td>
<td>
<p>a <code>CBData</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>an integer â€“ the number of random permutations for estimating the
null distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>an optional list of control settings, usually a call to
<code>soControl</code>.  See there for the names of the settable control
values and their effect.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The test is valid only under the assumption that the cluster-size
distribution does not depend on group. During the estimation of the
null-distribution the group assignments of the clusters are permuted keeping
the group sizes constant; the within-group distribution of the cluster-sizes
will vary randomly during the permutation test.
</p>
<p>The default value of <code>R</code> is probably too low for the final data
analysis, and should be increased.
</p>


<h3>Value</h3>

<p>A list with the following components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>LRT</code></td>
<td>
<p>the value of the likelihood ratio test statistic. It has two
attributes: <code>ll0</code> and <code>ll1</code> - the values of the log-likelihood
under <code class="reqn">H_0</code> and <code class="reqn">H_a</code> respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.val</code></td>
<td>
<p>the estimated one-sided p-value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot.res</code></td>
<td>
<p>an object of class "boot" with the detailed results of
the permutations.  See <code>boot</code> for details.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Aniko Szabo, aszabo@mcw.edu
</p>


<h3>References</h3>

<p>Szabo A, George EO. (2010) On the Use of Stochastic Ordering to
Test for Trend with Clustered Binary Data. <em>Biometrika</em> 97(1), 95-108.
</p>


<h3>See Also</h3>

<p><code>SO.LRT</code> for calculating only the test statistic,
<code>soControl</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">

data(shelltox)
set.seed(45742)
sh.test &lt;- SO.trend.test(shelltox, R=10, control=soControl(eps=0.1, max.directions=25)) 
sh.test

#a plot of the resampled LRT values
#would look better with a reasonable value of R
null.vals &lt;- sh.test$boot.res$t[,1]
hist(null.vals, breaks=10,  freq=FALSE, xlab="Test statistic", ylab="Density", 
     main="Simulated null-distribution", xlim=range(c(0,20,null.vals)))
points(sh.test$LRT, 0, pch="*",col="red", cex=3)


</code></pre>


</div>