<div class="container">

<table style="width: 100%;"><tr>
<td>sphereplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot a spherical function or point set</h2>

<h3>Description</h3>

<p>Plots a spherical function or a point set in a 2D projection using only standard R graphics. This avoids compatibility issues of rgl, e.g. knitting markdown documents.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sphereplot(
  f,
  n = 100,
  theta0 = pi/2,
  phi0 = 0,
  angle = 0,
  projection = "globe",
  col = gray.colors(256, 0, 1),
  clim = NULL,
  add = FALSE,
  center = c(0, 0),
  radius = 1,
  nv = 500,
  show.border = TRUE,
  show.grid = TRUE,
  grid.phi = seq(0, 330, 30)/180 * pi,
  grid.theta = seq(30, 150, 30)/180 * pi,
  pch = 16,
  pt.col = "black",
  pt.cex = 0.5,
  lwd = 0.5,
  lty = 1,
  line.col = "black",
  background = "white",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>must be either of:
</p>
<p>(1) NULL to plot just grid without spherical function
</p>
<p>(2) a vectorized real function f(theta,phi) of the polar angle theta [0,pi] and azimuth angle [0,2pi]
</p>
<p>(3) an n-by-2 array of values theta and phi</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of grid cells in each dimension used in the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta0</code></td>
<td>
<p>polar angle in radians at the center of the projection</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi0</code></td>
<td>
<p>azimuth angle in radians at the center of the projection</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>angle</code></td>
<td>
<p>angle in radians between vertical axis and central longitudinal great circle</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>projection</code></td>
<td>
<p>type of projection: "globe" (default), "cylindrical", "mollweide"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>color map</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clim</code></td>
<td>
<p>2-element vector specifying the values of f corresponding to the first and last color in col</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>logical flag specifying whether the sphere is to be added to an existing plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p>center of the sphere on the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>radius</code></td>
<td>
<p>radius of the sphere on the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nv</code></td>
<td>
<p>number or vertices used for grid lines and border</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.border</code></td>
<td>
<p>logical flag specifying whether to show a circular border around the sphere</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.grid</code></td>
<td>
<p>logical flag specifying whether to show grid lines</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid.phi</code></td>
<td>
<p>vector of phi-values of the longitudinal grid lines</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid.theta</code></td>
<td>
<p>vector of theta-values of the latitudinal grid lines</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>
<p>point type</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pt.col</code></td>
<td>
<p>point color</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pt.cex</code></td>
<td>
<p>point size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>line width of grid lines and border</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty</code></td>
<td>
<p>line type of grid lines and border</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line.col</code></td>
<td>
<p>color of grid lines and border</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>background</code></td>
<td>
<p>background color</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to be passed to the function f</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list containing the vector <code>col</code> of colors and 2-vector <code>clim</code> of values corresponding to the first and last color.
</p>


<h3>Author(s)</h3>

<p>Danail Obreschkow
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Plot random points on the unit sphere in Mollweide projection
set.seed(1)
f = cbind(acos(runif(5000,-1,1)),runif(5000,0,2*pi))
sphereplot(f,theta0=pi/3,projection='mollweide',pt.col='red')

## Plot real spherical harmonics up to third degree
oldpar = par(mar=c(0,0,0,0))
nplot(xlim=c(-4,3.5),ylim=c(0,4),asp=1)
for (l in seq(0,3)) { # degree of spherical harmonic
  for (m in seq(-l,l)) { # order of spherical harmonic

    # make spherical harmonic function in real-valued convention
    f = function(theta,phi) sphericalharmonics(l,m,cbind(theta,phi))

    # plot spherical harmonic
    sphereplot(f, 50, col=planckcolors(100), phi0=0.1, theta0=pi/3, add=TRUE, clim=c(-0.7,0.7),
               center=c(m,3.5-l), radius=0.47)

    if (l==3) text(m,-0.15,sprintf('m=%+d',m))
  }
  text(-l-0.55,3.5-l,sprintf('l=%d',l),pos=2)
}
par(oldpar)

</code></pre>


</div>