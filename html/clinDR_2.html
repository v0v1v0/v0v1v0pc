<div class="container">

<table style="width: 100%;"><tr>
<td>bpchkMonoEmax</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayes posterior predictive test for Emax (monotone) model fit</h2>

<h3>Description</h3>

<p>Bayes posterior predictive test for an Emax (monotone) model  
fit comparing the best response from lower doses to
the response from the highest dose.  <code>checkMonoEmax</code> is deprecated.  
See <code>bpchkMonoEmax</code>.</p>


<h3>Usage</h3>

<pre><code class="language-R">bpchkMonoEmax(x, trend='positive', protSel=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Output object of class 'fitEmaxB'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trend</code></td>
<td>
<p>The default is 'positive', so high values for lower doses
yield small Bayesian predictive probabilities.  Set <code>trend</code> to 'negative'
for dose response curves with negative trends.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>protSel</code></td>
<td>
<p>The test is applied to the data from a single protocol.  
The protocol can be selected if the model was fit to data from more 
than one protocol.  The <code>protSel</code> must match a 
protocol value input to <code>fitEmaxB</code> or it numerical index value, 1,2,...</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Bayesian predictive p-value 
is the posterior probability that a dose group
sample mean in a new study with the same sample sizes would yield a 
higher (or lower for negative trend) difference for one of the lower doses versus 
the highest dose than was actually obtained from the real sample.  There must
be at least two non-placebo dose groups (NA returned otherwise).  Placebo
response is excluded from the comparisons.
</p>
<p>The function generates random numbers, so the random number generator/seed must
be set before the function is called for exact reproducibility.
</p>
<p>When <code>fitEmaxB</code> is applied to first-stage fitted model output with a
non-diagonal variance-covariance matrix, the predictive draws are selected
from a multivariate model with means computed from the MCMC-generated
parameters and input asymptotic variance-covariance matrix <code>vcest</code>.  
If the fitted model was applied to binary data, the GOF statistic is 
computed based on the logit rather than observed dose group sample 
proportion scale.  This differs from the setting with patient-level
data input to <code>fitEmaxB</code>.
</p>


<h3>Value</h3>

<p>Returns a scalar Bayesian predictive p-value.
</p>


<h3>Author(s)</h3>

<p> Neal Thomas </p>


<h3>References</h3>

<p>Thomas, N., Sweeney, K., and Somayaji, V. (2014).  Meta-analysis of clinical dose response in a large drug development portfolio, Statistics in Biopharmaceutical Research, Vol. 6, No.4, 302-317.
&lt;doi:10.1080/19466315.2014.924876&gt;
</p>
<p>Thomas, N., and Roy, D. (2016).  Analysis of clinical dose-response in small-molecule drug development:  2009-2014. Statistics in Biopharmaceutical Research, Vol. 6, No.4, 302-317
&lt;doi:10.1080/19466315.2016.1256229&gt;
</p>
<p>Wu, J., Banerjee, A., Jin, B. Menon, M. S., Martin, S. and Heatherington, A. (2017). Clinical dose response for a broad set of biological products: A model-based meta-analysis. Statistical Methods in Medical Research. &lt;doi:10.1177/0962280216684528&gt;
</p>


<h3>See Also</h3>

<p><code>plot.plotB</code>, <code>plotD</code>,  <code>plot.fitEmax</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 

data("metaData")
exdat&lt;-metaData[metaData$taid==6 &amp; metaData$poptype==1,]

prior&lt;-emaxPrior.control(epmu=0,epsca=10,difTargetmu=0,difTargetsca=10,dTarget=80.0,
        p50=3.75,sigmalow=0.01,sigmaup=20)
mcmc&lt;-mcmc.control(chains=3)

msSat&lt;-sum((exdat$sampsize-1)*(exdat$sd)^2)/(sum(exdat$sampsize)-length(exdat$sampsize))
fitout&lt;-fitEmaxB(exdat$rslt,exdat$dose,prior,modType=4,
				count=exdat$sampsize,msSat=msSat,mcmc=mcmc)
parms&lt;-coef(fitout)[,1:4]  #use first intercept

checkMonoEmax(fitout, trend='negative')
      

## End(Not run)
</code></pre>


</div>