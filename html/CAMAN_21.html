<div class="container">

<table style="width: 100%;"><tr>
<td>mixalg.VEM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>VEM algorithm</h2>

<h3>Description</h3>

<p>When fitting finite mixture models two cases must be distinguished. The
flexible support size case, where no assumption about the
number of components <code>k</code> is made in advance and the fixed support size
case. For the flexible support size case the VEM-algorithm can be used.
<br><br>
The algorithm proceeds as follows:<br>
Step 1: Define an approximating grid lambda[1], ..., lambda[L] <br>
Step 2: Use the VEM algorithm to maximize <code>L(P)</code> in the simplex 
<code class="reqn">\Omega</code> and identify grid points with positive support. <br></p>


<h3>Usage</h3>

<pre><code class="language-R">mixalg.VEM(mix = NULL, obs=NULL, weights=NULL, data=NULL, pop.at.risk=NULL, 
           var.lnOR=NULL, family="gaussian", limit=0.01, acc=10^(-7), 
           numiter=5000, startk=50)    
</code></pre>


<h3>Arguments</h3>

  
<table>
<tr style="vertical-align: top;">
<td><code>mix</code></td>
<td>

<p>A CAMAN-object which quantifies a finite mixture model and the input data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs</code></td>
<td>

<p>observed / dependent variable. Vector or colname of <code>data</code>. Must be specified!
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>

<p>weights of the data. Vector or colname of <code>data</code>. Default is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>

<p>the underlying type density function as a character ("gaussian", "poisson" or "binomial")!
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>an optional data frame. <code>obs</code>, <code>weights</code>, <code>pop.at.risk</code> and <code>var.lnOR</code> can be specified as column name of the data frame. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pop.at.risk</code></td>
<td>

<p>population at risk: These data could be used to determine a mixture model for Poisson data. Vector or colname of <code>data</code>. Default is<code>NULL</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.lnOR</code></td>
<td>

<p>variances of the data: These variances might be given when working with meta analyses! Vector or colname of <code>data</code>. Default is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>limit</code></td>
<td>

<p>parameter to control the limit of union several components. Default is 0.01.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>acc</code></td>
<td>

<p>convergence criterion. VEM and EM loops stop when deltaLL&lt;acc. Default is 10^(-7). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numiter</code></td>
<td>

<p>parameter to control the maximal number of iterations in the VEM and EM loops. Default is 5000. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>startk</code></td>
<td>

<p>starting/maximal number of components. This number will be used to compute the grid in the VEM. Default is 50.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function returns a <code>CAMAN.VEM.object</code> object.
</p>


<h3>Author(s)</h3>

<p>Peter Schlattmann and Johannes Hoehne   
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(vitA)
m0&lt;-mixalg.VEM(obs="logrr",var.lnOR="var",family="gaussian", data=vitA,startk=20)
plot(m0@totalgrid[,2],m0@totalgrid[,3],type="l",xlab="parameter",ylab="gradient")
m1&lt;-mixalg.EM(obs="logrr",var.lnOR="var" ,family="gaussian",p=c(1),t=c(0),data=vitA)
</code></pre>


</div>