<div class="container">

<table style="width: 100%;"><tr>
<td>multilag.cpts.merge</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Merge Change Point Estimators from Multiple Lags</h2>

<h3>Description</h3>

<p>Merges change point estimators from different lagged values into a final set of overall change point estimators.
</p>


<h3>Usage</h3>

<pre><code class="language-R">multilag.cpts.merge(
  x.c,
  eta.merge = 1,
  merge.type = c("sequential", "bottom-up")[1]
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x.c</code></td>
<td>
<p>A <code>list</code> object, where each element of the list is the output of the np.mojo function computed at a
different lag.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta.merge</code></td>
<td>
<p>A positive numeric value for the minimal mutual distance of
changes, relative to bandwidth, used to merge change point estimators across different lags.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>merge.type</code></td>
<td>
<p>String indicating the method used to merge change point estimators from different lags. Possible choices are
</p>

<ul>
<li> <p><code>"sequential"</code>: starting from the left-most change point estimator and proceeding forward in time, estimators
are grouped into clusters based on mutual distance. The estimator yielding the smallest corresponding p-value is
chosen as the change point estimator for that cluster. See McGonigle and Cho (2023) for details.
</p>
</li>
<li> <p><code>"bottom-up"</code>: starting with the smallest p-value, the change points are merged using bottom-up merging (Messer
et al. (2014)).
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See McGonigle and Cho (2023) for further details.
</p>


<h3>Value</h3>

<p>A <code>list</code> object which contains the following fields
</p>
<table>
<tr style="vertical-align: top;">
<td><code>cpts</code></td>
<td>
<p>A matrix with rows corresponding to final change point estimators, with estimated change point location and associated lag and p-value given in columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cpt.clusters</code></td>
<td>
<p>A <code>list</code> object of length given by the number of detected change points. Each field contains a matrix of all
change point estimators that are declared to be associated to the corresponding change point in the <code>cpts</code> field.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>McGonigle, E.T., Cho, H. (2023). Nonparametric data segmentation in multivariate time series via joint characteristic functions.
<em>arXiv preprint arXiv:2305.07581</em>.
</p>
<p>Messer M., Kirchner M., Schiemann J., Roeper J., Neininger R., Schneider G. (2014). A Multiple Filter Test for
the Detection of Rate Changes in Renewal Processes with Varying Variance. <em>The Annals of Applied Statistics</em>, 8(4), 2027-2067.
</p>


<h3>See Also</h3>

<p>np.mojo, np.mojo.multilag
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)
n &lt;- 500
noise &lt;- c(rep(1, 300), rep(0.4, 200)) * stats::arima.sim(model = list(ar = 0.3), n = n)
signal &lt;- c(rep(0, 100), rep(2, 400))
x &lt;- signal + noise
x.c0 &lt;- np.mojo(x, G = 83, lag = 0)
x.c1 &lt;- np.mojo(x, G = 83, lag = 1)
x.c &lt;- multilag.cpts.merge(list(x.c0, x.c1))
x.c
</code></pre>


</div>