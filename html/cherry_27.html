<div class="container">

<table style="width: 100%;"><tr>
<td>DAG class</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Class "DAG" for storing the result of the DAG multiple testing method</h2>

<h3>Description</h3>

<p>The class DAG is the output of a call to <code>DAGmethod</code>. It stores which hypotheses have been rejected and can be used to calculate confidence sets for the number of true and/or false hypotheses among a selected set of hypotheses.</p>


<h3>Slots</h3>

<p>These slots are not meant to be directly accessed by the user.
</p>

<dl>
<dt>
<code>sets</code>:</dt>
<dd>
<p>Object of class "list". Stores unique original sets that are to be tested.</p>
</dd>
<dt>
<code>method</code>:</dt>
<dd>
<p>Object of class "character". Stores whether the any-parent, all-parents or structuredHolm method has been used.</p>
</dd>
<dt>
<code>isadjusted</code>:</dt>
<dd>
<p>Object of class "logical". Stores whether adjusted p-values are calculated.</p>
</dd>
<dt>
<code>allpvalues</code>:</dt>
<dd>
<p>Object of class "numeric". Stores (adjusted) p-values for all hypotheses. Has value NA if adjusted p-value is larger than alpha.</p>
</dd>
<dt>
<code>implications</code>:</dt>
<dd>
<p>Object of class "logical". Stores whether hypotheses are implications at chosen alpha-level</p>
</dd>
<dt>
<code>alpha</code>:</dt>
<dd>
<p>Object of class "numeric". The type I error level chosen.</p>
</dd>
<dt>
<code>rejected</code>:</dt>
<dd>
<p>Object of class "logical". Stores for each hypothesis wether this hypothesis has been rejected</p>
</dd>
<dt>
<code>leaf_based_sets</code>:</dt>
<dd>
<p>Object of class "list". Stores sets expressed in the indices of their corresponding leaf nodes (which are sets itself).</p>
</dd>
<dt>
<code>twoway</code>:</dt>
<dd>
<p>Object of class "logical". Is TRUE if the final DAG structure has twoway logical relationships.</p>
</dd>
</dl>
<h3>Methods</h3>


<dl>
<dt>show</dt>
<dd>
<p>(DAG): Prints how many hypotheses there are in total and how many of them were rejected.</p>
</dd>
<dt>summary</dt>
<dd>
<p>(DAG): Prints the test results (as <code>show</code>).</p>
</dd>
<dt>alpha</dt>
<dd>
<p>(DAG): Retrieves the maximal alpha_value from the DAG object.</p>
</dd>
<dt>implications</dt>
<dd>
<p>(DAG): Retrieves the implications from a given DAG object.</p>
</dd>
<dt>pvalue</dt>
<dd>
<p>(DAG,indicator): Retrieves pvalues for all possible hypotheses (as specified by indicator) from the DAG object.</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Rosa Meijer: <a href="mailto:r.j.meijer@lumc.nl">r.j.meijer@lumc.nl</a></p>


<h3>See Also</h3>

<p><code>DAGmethod</code>, <code>DAGpick</code>, <code>structuredHolm</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R">
  #Generate data, where the response Y is associated with two (out of 4) covariates
  set.seed(1)
  n=100
  p=4
  X &lt;- matrix(rnorm(n*p),n,p)
  beta &lt;- c(0,0.5,0.5,0)
  Y &lt;- X %*% beta + rnorm(n)

  # Let us assume we have the following sets that we want to test: 
  sets &lt;- list(c(1,2,3,4), c(1,2), c(2,3,4), c(2,3), 1, 2, 3, 4)
  names(sets) &lt;- c(1234, 12, 234, 23, 1, 2, 3, 4)

  # Start by making the corresponding graph structure
  struct &lt;- construct(sets)
  
  # Check whether the DAG has toway logical relations: 
  istwoway(struct)
  
  # Define the local test to be used in the closed testing procedure. 
  # This test expects a set as input.
  mytest &lt;- function(set)
  { 
    X &lt;- X[,set,drop=FALSE]
    lm.out &lt;- lm(Y ~ X)
    x &lt;- summary(lm.out)
    return(pf(x$fstatistic[1],x$fstatistic[2],x$fstatistic[3],lower.tail=FALSE))  
  }

  # Perform the DAG procedure (default is all-parents method).
  DAG &lt;- DAGmethod(struct, mytest, isadjusted=TRUE)
  summary(DAG)
  
  # What are the smallest sets that are found to be significant? If the sets have names, 
  # as in our example, the implications function will return the names 
  # of the implying sets, together with their (adjusted) p-value. 
  # If no names are provided, indices will be used instead of the names. 
  implications(DAG)
  
  # What is the adjusted p-value of the null-hypothesis corresponding to the fourth set, 
  # which is set c(2,3)? 
  # To look up the pvalue, the function uses the index or name of the set 
  # in the list of sets stored in the DAGstructure. 
  # (Note that, if there were duplicate sets in the original list, this index can be different from 
  # the one in the original list given to \code{construct})
  pvalue(DAG,4)
  pvalue(DAG, "23") #as above, but while using names
  
  # How many of the elementary hypotheses (the last 4 sets) have to be false 
  # with probability 1-alpha? 
  # Sets (don't have to be elementary hypotheses in general) must be specified 
  # by their index or name. 
  DAGpick(DAG, 5:8)
  DAGpick(DAG, c("1","2","3","4")) #as above, but while using names


</code></pre>


</div>