<div class="container">

<table style="width: 100%;"><tr>
<td>sim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate model parameters</h2>

<h3>Description</h3>

<p><code>sim()</code> simulates model parameters from a multivariate normal or t distribution that are then used by <code>sim_apply()</code> to calculate quantities of interest.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim(fit, n = 1000, vcov = NULL, coefs = NULL, dist = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>a model fit, such as the output of a call to <code>lm()</code> or <code>glm()</code>. Can be left unspecified if <code>coefs</code> and <code>vcov</code> are not functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>the number of simulations to run; default is 1000. More is always better but resulting calculations will take longer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcov</code></td>
<td>
<p>either a square covariance matrix of the coefficient covariance estimates or a function to use to extract it from <code>fit</code>. By default, uses <code>stats::vcov()</code> or <code>insight::get_varcov()</code> if that doesn't work.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefs</code></td>
<td>
<p>either a vector of coefficient estimates or a function to use to extract it from <code>fit</code>. By default, uses <code>stats::coef()</code> or <code>insight::get_parameters()</code> if that doesn't work.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>
<p>a string containing the name of the multivariate distribution to use to draw simulated coefficients. Should be one of <code>"normal"</code> (multivariate normal distribution) or <code>"t({#})"</code> (multivariate t distribution), where <code style="white-space: pre;">⁠{#}⁠</code> corresponds to the desired degrees of freedom (e.g., <code>"t(100)"</code>). If <code>NULL</code>, the right distribution to use will be determined based on heuristics; see Details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When <code>dist</code> is <code>NULL</code>, <code>sim()</code> samples from a multivariate normal or t distribution depending on the degrees of freedom extracted from <code>insight::get_df(., type = "wald")</code>. If <code>Inf</code>, a normal distribution will be used; otherwise, a t-distribution with the returned degrees of freedom will be used. Models not supported by <code>insight</code> will use a normal distribution.
</p>
<p>When a multivariate normal is used, it is sampled from with means equal to the estimated coefficients and the parameter covariance matrix as the covariance matrix using <code>mvnfast::rmvn()</code>. When a multivariate t distribution is used, it is sampled from with means equal to the estimated coefficients and scaling matrix equal to <code>cov*(df - 2)/df</code>, where <code>cov</code> is the parameter covariance matrix and <code>df</code> is the residual degrees of freedom for the model, using <code>mvnfast::rmvt()</code>.
</p>


<h3>Value</h3>

<p>A <code>clarify_sim</code> object, which has the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>sim.coefs</code></td>
<td>
<p>a matrix containing the simulated coefficients with a column for each coefficient and a row for each simulation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefs</code></td>
<td>
<p>the original coefficients extracted from <code>fit</code> or supplied to <code>coefs</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcov</code></td>
<td>
<p>the covariance matrix of the coefficients extracted from <code>fit</code> or supplied to <code>vcov</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>the original model fit supplied to <code>fit</code></p>
</td>
</tr>
</table>
<p>The <code>"dist"</code> attribute contains <code>"normal"</code> if the coefficients were sampled from a multivariate normal distribution and <code>"t(df)"</code> if sampled from a multivariate t distribution. The <code>"clarify_hash"</code> attribute contains a unique hash generated by <code>rlang::hash()</code>.
</p>


<h3>See Also</h3>


<ul>
<li> <p><code>misim()</code> for simulating model coefficients after multiple imputation
</p>
</li>
<li> <p><code>sim_apply()</code> for applying a function to each set of simulated coefficients
</p>
</li>
<li> <p><code>sim_ame()</code> for computing average marginal effects in each simulation draw
</p>
</li>
<li> <p><code>sim_setx()</code> for computing marginal predictions and first differences at typical values in each simulation draw
</p>
</li>
<li> <p><code>sim_adrf()</code> for computing average dose-response functions in each simulation draw
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">
data("lalonde", package = "MatchIt")
fit &lt;- lm(re78 ~ treat * (age + race + nodegree + re74), data = lalonde)

# Simulate coefficients
s &lt;- sim(fit)
s

## Could also use a robust covariance matrix, e.g.,
s &lt;- sim(fit, vcov = "HC3")

# Simulated coefficients assuming a normal distribution
# for coefficients; default for `lm` objects is a t-
# distribution
s &lt;- sim(fit, dist = "normal")
s

</code></pre>


</div>