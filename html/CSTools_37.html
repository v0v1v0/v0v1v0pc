<div class="container">

<table style="width: 100%;"><tr>
<td>CST_RFWeights</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute climatological weights for RainFARM stochastic precipitation downscaling</h2>

<h3>Description</h3>

<p>Compute climatological ("orographic") weights from a fine-scale 
precipitation climatology file.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CST_RFWeights(
  climfile,
  nf,
  lon,
  lat,
  varname = NULL,
  fsmooth = TRUE,
  lonname = "lon",
  latname = "lat",
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>climfile</code></td>
<td>
<p>Filename of a fine-scale precipitation climatology. The file 
is expected to be in NetCDF format and should contain at least one 
precipitation field. If several fields at different times are provided,
a climatology is derived by time averaging. Suitable climatology files could 
be for example a fine-scale precipitation climatology from a high-resolution 
regional climate model (see e.g. Terzago et al. 2018), a local 
high-resolution gridded climatology from observations, or a reconstruction 
such as those which can be downloaded from the WORLDCLIM 
(<a href="https://www.worldclim.org">https://www.worldclim.org</a>) or CHELSA (<a href="https://chelsa-climate.org/">https://chelsa-climate.org/</a>) 
websites. The latter data will need to be converted to NetCDF format before 
being used (see for example the GDAL tools (<a href="https://gdal.org/">https://gdal.org/</a>). It  
could also be an 's2dv_cube' object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nf</code></td>
<td>
<p>Refinement factor for downscaling (the output resolution is 
increased by this factor).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lon</code></td>
<td>
<p>Vector of longitudes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lat</code></td>
<td>
<p>Vector of latitudes. The number of longitudes and latitudes is 
expected to be even and the same. If not the function will perform a 
subsetting to ensure this condition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varname</code></td>
<td>
<p>Name of the variable to be read from <code>climfile</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fsmooth</code></td>
<td>
<p>Logical to use smooth conservation (default) or large-scale 
box-average conservation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lonname</code></td>
<td>
<p>A character string indicating the name of the longitudinal 
dimension set as 'lon' by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>latname</code></td>
<td>
<p>A character string indicating the name of the latitudinal 
dimension set as 'lat' by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>An integer that indicates the number of cores for parallel 
computations using multiApply function. The default value is one.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class 's2dv_cube' containing in matrix <code>data</code> the 
weights with dimensions (lon, lat).
</p>


<h3>Author(s)</h3>

<p>Jost von Hardenberg - ISAC-CNR, <a href="mailto:j.vonhardenberg@isac.cnr.it">j.vonhardenberg@isac.cnr.it</a>
</p>


<h3>References</h3>

<p>Terzago, S., Palazzi, E., &amp; von Hardenberg, J. (2018).
Stochastic downscaling of precipitation in complex orography: 
A simple method to reproduce a realistic fine-scale climatology.
Natural Hazards and Earth System Sciences, 18(11),
2825-2840. doi: <a href="https://doi.org/10.5194/nhess-18-2825-2018">10.5194/nhess-18-2825-2018</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Create weights to be used with the CST_RainFARM() or RainFARM() functions
# using an external random data in the form of 's2dv_cube'.
obs &lt;- rnorm(2 * 3 * 4 * 8 * 8)
dim(obs) &lt;- c(dataset = 1, member = 2, sdate = 3, ftime = 4, lat = 8, lon = 8)
lon &lt;- seq(10, 13.5, 0.5)
lat &lt;- seq(40, 43.5, 0.5)
coords &lt;- list(lon = lon, lat = lat)
data &lt;- list(data = obs, coords = coords)
class(data) &lt;- "s2dv_cube"
res &lt;- CST_RFWeights(climfile = data, nf = 3, lon, lat, lonname = 'lon', 
                    latname = 'lat', fsmooth = TRUE)
</code></pre>


</div>