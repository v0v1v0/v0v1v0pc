<div class="container">

<table style="width: 100%;"><tr>
<td>standardsPred</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Predict effect for new data (or get fitted data)</h2>

<h3>Description</h3>

<p>Predicted values for the standards
</p>


<h3>Usage</h3>

<pre><code class="language-R">standardsPred(model, newdata, factors, lg = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>result from <code>standardsFit</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>an <code>ExpressionSet</code> or <code>matrix</code> with new
data (or the data used to fit the model to get the fitted data)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>factors</code></td>
<td>
<p>the biological factors described in the pheno data
slot if <code>object</code> is an <code>ExpressionSet</code> or a design
matrix if <code>object</code> is a <code>matrix</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lg</code></td>
<td>
<p>logical indicating that the data should be log
transformed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>passed on to <code>standards</code> and <code>analytes</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>There is often unwanted variation in among the labeled internal
standards which is related to the experimental factors due to
overlapping peaks etc. This predicts this effect given a model of
the overlapping variance. The prediction is given by
<code class="reqn">\hat{X}_{IS}=X_{IS}-X_{IS}B</code>
</p>


<h3>Value</h3>

<p>the corrected data
</p>


<h3>Author(s)</h3>

<p>Henning Redestig
</p>


<h3>See Also</h3>

<p><code>makeX</code>, <code>standardsFit</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(mix)
fullFit &lt;- standardsFit(mix, "type", ncomp=3)
sfit &lt;- standardsFit(mix[,-1], "type", ncomp=3)
pred &lt;- standardsPred(sfit, mix[,1], "type")
cor(scores(sfit$fit$pc)[1,], scores(fullFit$fit$pc)[1,])
## could just as well have been done as
Y &lt;- exprs(mix)
G &lt;- model.matrix(~-1+mix$type)
isIS &lt;- fData(mix)$tag == 'IS'
fullFit &lt;- standardsFit(Y, G, ncomp=3, standards=isIS)
sfit    &lt;- standardsFit(Y[,-1], G[-1,], ncomp=3,
                        standards=isIS)
pred &lt;- standardsPred(sfit, Y[,1,drop=FALSE], G[1,,drop=FALSE], standards=isIS)
cor(scores(sfit$fit$pc)[1,], scores(fullFit$fit$pc)[1,])
</code></pre>


</div>