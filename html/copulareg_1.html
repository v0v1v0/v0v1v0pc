<div class="container">

<table style="width: 100%;"><tr>
<td>copulareg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>copulareg</h2>

<h3>Description</h3>

<p>This function fits joint distributions with an R-vine
pair copula structure, that is constructed in a specific way so that
the conditional density and distribution of the variable y can be
computed explicitly.
</p>


<h3>Usage</h3>

<pre><code class="language-R">copulareg.default(
  y,
  x,
  var_type_y,
  var_type_x,
  family_set = c("gaussian", "clayton", "gumbel"),
  extra_x = NULL,
  extra_y = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A vector of n observations of the (univariate) outcome variable y</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A (n x p) matrix of n observations of p covariates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var_type_y</code></td>
<td>
<p>A character that has to be specified as "d" or "c"
to indicate whether y is discrete or continuous, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var_type_x</code></td>
<td>
<p>A vector of p characters that have to take the value
"c" or "d" to indicate whether each margin of the covariates is discrete
or continuous.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family_set</code></td>
<td>
<p>A vector of strings that specifies the set of
pair-copula families that the fitting algorithm chooses from. For an
overview of which values that can be specified, see the documentation for
bicop.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extra_x</code></td>
<td>
<p>Optional extra values of x to use for estimating the
margins of the covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extra_y</code></td>
<td>
<p>Optional extra values of y to use to estimate the margin
of y.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of the class 'copulareg', which contains an object of the class
'vinecop', see rvinecopulib::vinecop, an enviroment that stores the transformed
variables at each level of the pair copula for the training data, the marginal 
distributions of the covariates, the marginal distribution of the response,
and the y-training values.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Compile some test data
data('ChickWeight') 
set.seed(10)
tr &lt;- sample(c(TRUE, FALSE), nrow(ChickWeight), TRUE, c(0.7, 0.3))
y_tr &lt;- ChickWeight$weight[tr]
y_te &lt;- ChickWeight$weight[!tr]
x_tr &lt;- apply(ChickWeight[tr, -1], 2, as.numeric)
x_te &lt;- apply(ChickWeight[!tr, -1], 2, as.numeric)
var_type_x &lt;- apply(x_tr, 2,
                    function(x) if(length(unique(x)) &lt; 10) "d" else "c")

# Fit model to training data
md &lt;- copulareg::copulareg(y_tr, x_tr, "c", var_type_x)

# Predict for a new data matrix
pred &lt;- predict(md, new_x = x_te)

# Plot residuals for test data against covariates
plot(data.frame(residual = y_te - pred, x_te))

# Plot residuals against fitted
plot(md)

# Plot prediction error against predicted values
plot(md, new_x=x_te, new_y=y_te)
</code></pre>


</div>