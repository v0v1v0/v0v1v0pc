<div class="container">

<table style="width: 100%;"><tr>
<td>rBin2Corr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate correlated binary variables</h2>

<h3>Description</h3>

<p>Generate correlated bivariate binary outcomes of toxicity and efficacy for a cohort number of patients.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rBin2Corr(cohortsize, pT, pE, psi, seed=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cohortsize</code></td>
<td>
<p>Number of patients in each cohort.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pT</code></td>
<td>
<p>Toxicity probability.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pE</code></td>
<td>
<p>Efficacy probability.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi</code></td>
<td>
<p>Association parameter for efficacy and toxicity, where psi=0 means toxicity and efficacy is independent.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>An integer for the seed to generate random numbers, default is NULL.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The formula for generating correlated binary variables is
</p>
<p style="text-align: center;"><code class="reqn">\pi_{i,j} = (\pi_E)^i(1-\pi_E)^{1-i}(\pi_T)^j(1-\pi_T)^{1-j} + (-1)^{i+j}\pi_E(1-\pi_E)\pi_T(1-\pi_T)\left(\frac{e^{\psi}-1}{e^{\psi}+1}\right),</code>
</p>

<p>where <code class="reqn">i, j = 0, 1</code>, so that four probabilities can be calculated for the possible combinations of (toxicity, efficacy) including <code class="reqn">(1,1), (0,0), (0,1), (1,0)</code> given <code class="reqn">\pi_T</code> and <code class="reqn">\pi_E</code>. Multinomial distribution <code>rmultinom</code> is further used to generate bivariate binary outcomes (number equals to cohortsize) based on the four calculated probabilities.
</p>


<h3>Value</h3>

<p>Return a <code class="reqn">cohortsize \times 2</code> matrix with columns corresponding to toxicity and efficacy, and rows for each observations of binary outcome with 0 for no toxicity (no efficacy) and 1 for toxicity (efficacy) at the first (second) column.
</p>


<h3>References</h3>

<p>Murtaugh, P. A., &amp; Fisher, L. D. (1990). Bivariate binary models of efficacy and toxicity in dose-ranging trials. Communications in Statistics-Theory and Methods, 19(6), 2003-2020. <a href="https://doi.org/10.1080/03610929008830305">doi:10.1080/03610929008830305</a>
</p>
<p>Thall, P. F., &amp; Cook, J. D. (2004). Dose‐finding based on efficacy–toxicity trade‐offs. Biometrics, 60(3), 684-693. <a href="https://doi.org/10.1111/j.0006-341X.2004.00218.x">doi:10.1111/j.0006-341X.2004.00218.x</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">rBin2Corr(cohortsize = 1, pT = 0.2, pE = 0.4, psi = 0, seed=12)
</code></pre>


</div>