<div class="container">

<table style="width: 100%;"><tr>
<td>popSpectra2D</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plain Old PCA (POP) of Spectra2D Objects</h2>

<h3>Description</h3>

<p>This function unstacks a <code>Spectra2D</code> object and conducts IRLBA
PCA on it.
To unstack, each F1 slice (parallel to F2) is concatenated one after the other
so that each 2D spectrum becomes a 1D spectrum.  The length of this spectrum will be
equal to the length of the F2 dimension times the length of the F1 dimension.
PCA is performed on the collection of 1D spectra (one spectrum from each 2D spectrum).
The IRLBA algorithm is used because the resulting matrix (n samples  in rows x F1 * F2 columns)
can be very large, and other PCA algorithms can struggle.
</p>


<h3>Usage</h3>

<pre><code class="language-R">popSpectra2D(spectra, n = 3, choice = "noscale", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>spectra</code></td>
<td>
<p>An object of S3 class <code>Spectra2D</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Integer. The number of components desired.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>choice</code></td>
<td>
<p>A character string indicating the choice of scaling.  One of
<code>c("noscale"</code>, <code>"autoscale"</code>, <code>"Pareto")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other parameters to be passed to <code>prcomp_irlba</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The scale choice <code>autoscale</code> scales the columns by their standard
deviation.  <code>Pareto</code> scales by the square root of the standard
deviation. <code>"autoscale"</code> is called "standard normal variate" or "correlation matrix PCA"
in some literature.  This action is performed on the unstacked matrix, as is centering.
</p>


<h3>Value</h3>

<p>An object of classes <code>prcomp</code>, <code>pop</code> and <code>computed_via_irlba</code>
modified to include a list element called <code>$method</code>, a character string describing the
pre-processing carried out and the type of PCA performed (used to annotate
plots).
</p>


<h3>Author(s)</h3>

<p>Bryan A. Hanson, DePauw University.
</p>


<h3>References</h3>

<p>J. Baglama and L. Reichel, "Augmented Implicitly Restarted Lanczos
Bidiagonalization Methods"  <em>SIAM J. Sci. Comput.</em> (2005).
</p>


<h3>See Also</h3>

<p>For other data reduction methods for <code>Spectra2D</code> objects, see
<code>miaSpectra2D</code> and <code>pfacSpectra2D</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library("ggplot2")
data(MUD1)
res &lt;- popSpectra2D(MUD1)

# plotScores &amp; plotScree use ggplot2 graphics

p1 &lt;- plotScores(MUD1, res, ellipse = "cls")
p1 &lt;- p1 + ggtitle("POP Scores")
p1

p2 &lt;- plotScree(res)
p2

# plotLoadings2D uses base graphics

MUD1a &lt;- plotLoadings2D(MUD1, res,
  load_lvls = c(-0.2, -0.1, 0.1, 0.2),
  load_cols = rep("black", 4), main = "POP Comp. 1 Loadings")

</code></pre>


</div>