<div class="container">

<table style="width: 100%;"><tr>
<td>lacv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Computes localized (wavelet) autocovariance function</h2>

<h3>Description</h3>

<p>Compute the LACV function for a locally
stationary wavelet process. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">lacv(x, filter.number = 10,
	family = c("DaubExPhase", "DaubLeAsymm"), smooth.dev=var,
	AutoReflect=TRUE, lag.max=NULL, smooth.RM=0, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The time series you want to compute the LACV for</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filter.number</code></td>
<td>
<p>The wavelet that you wish to compute the LACV
with respect to</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>The wavelet family</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth.dev</code></td>
<td>
<p>The deviance used in smoothing if running mean smoothing
is not used, ie in the call to <code>ewspec</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AutoReflect</code></td>
<td>
<p>If TRUE then the spectrum is computed on a boundary-corrected series, overcoming the lack of periodicity in the time series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lag.max</code></td>
<td>
<p>The maximum lag that the function computes. If this option
is <code>NULL</code> then the largest possible will be computed and used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth.RM</code></td>
<td>
<p>If this is zero then regular wavelet smoothing of the
periodogram will be used. If not zero then running mean smoothing
of the periodogram will be used with a bandwidth given by
this argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> Additional arguments to the spectrum computation
contained within</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A locally stationary wavelet process is a particular kind
of non-stationary time series constructed out of wavelet
atoms, with a time-varying spectrum (slowly varying).
This kind of model is useful for time series whose spectral
properties change over time. 
</p>
<p>The time-varying spectrum can be computed from within the
WaveThresh library by the <code>ewspec</code> function. However,
just as in the classical stationary case, where the
spectrum and autocovariance are a Fourier transform pair, the
paper Nason, von Sachs, Kroisandt (2000) [NvSK2000] shows that the
evolutionary wavelet spectrum is paired to a localized
autocovariance function using a wavelet-like transform.
This is expressed in formula (14) of the NvSK2000 paper.
</p>
<p>This function computes the localized autocovariance by
first computing the estimate of the evolutionary spectrum,
and then directly transforming it using formula (14) via
the autocorrelation wavelet transform.
</p>


<h3>Value</h3>

<p>An object of class <code>lacv</code>. This is a list with the following
components: <code>lacv</code> which is a matrix that contains the localized
autocovariance.
If the original time series was of length T, then the number
of rows of the returned matrix is also T, one row for each time
point.
The columns of the array correspond to the lag. The number of
columns, 2K+1,  depends both on the length of the time series and
also the order of the wavelet (smoother wavelets return
lacv matrices with larger number of lags). Lag 0 is always
the centre column, with negative lags from -K to -1 are
the leftmost columns, lags from 1 to K are the rightmost columns;
<code>lacr</code>: a matrix, with the same dimensions as <code>lacv</code>
but containing the local autocorrelations; <code>date</code>: the date
this function was executed.
</p>


<h3>Author(s)</h3>

<p>Guy Nason</p>


<h3>References</h3>

<p>Cardinali, A. and Nason, Guy P. (2013) Costationarity of
Locally Stationary Time Series Using costat.
<em>Journal of Statistical Software</em>, <b>55</b>, Issue 1.
</p>
<p>Cardinali, A. and Nason, G.P. (2010) Costationarity of locally stationary
time series. <em>J. Time Series Econometrics</em>, <b>2</b>, Issue 2, Article 1.
</p>
<p>Nason, G.P., von Sachs, R. and Kroisandt, G. (2000) Wavelet
processes and adaptive estimation of the evolutionary wavelet
spectrum. <em>J. R. Statist. Soc. B</em>, <b>62</b>, 271-292.
</p>


<h3>See Also</h3>

<p><code>ewspec</code>, <code>print.lacv</code>, <code>plot.lacv</code>,
<code>summary.lacv</code></p>


<h3>Examples</h3>

<pre><code class="language-R">#
# Generate an AR(1) time series
#
vsim &lt;- arima.sim(model=list(ar=0.8), n=1024)
#
# Compute the ACF of this stationary series
#
vsim.acf &lt;- acf(vsim, plot=FALSE)
#
# Compute the localized autocovariance. We'll use
# a reasonably smooth wavelet.
#
vsim.lacv &lt;- lacv(vsim, filter.number=4, lag.max=30)
#
# Now plot the time-varying autocorrelations, only the first 5 lags
#
## Not run: plot(vsim.lacv, lags=0:5)
#
# Now plot the localized autocorrelation at time t=100, a plot similar
# to the usual R acf plot.
#
## Not run: plot(vsim.lacv, type="acf", the.time=100)
</code></pre>


</div>