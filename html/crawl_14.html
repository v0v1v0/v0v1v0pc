<div class="container">

<table style="width: 100%;"><tr>
<td>crwPredict</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Predict animal locations and velocities using a fitted CTCRW model and
calculate measurement error fit statistics</h2>

<h3>Description</h3>

<p>The <code>crwMEfilter</code> function uses a fitted model object from
<code>crwMLE</code> to predict animal locations (with estimated uncertainty) at
times in the original data set and supplemented by times in <code>predTime</code>.
If <code>speedEst</code> is set to <code>TRUE</code>, then animal log-speed is also
estimated. In addition, the measurement error shock detection filter of de
Jong and Penzer (1998) is also calculated to provide a measure for outlier
detection.
</p>


<h3>Usage</h3>

<pre><code class="language-R">crwPredict(object.crwFit, predTime = NULL, return.type = "minimal", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object.crwFit</code></td>
<td>
<p>A model object from <code>crwMLE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predTime</code></td>
<td>
<p>vector of desired prediction times (numeric or POSIXct). Alternatively, a character vector specifying a time interval (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.type</code></td>
<td>
<p>character. Should be one of <code>"minimal","flat","list"</code> (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments for testing new features</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The requirements for <code>data</code> are the same as those for fitting the model
in <code>crwMLE</code>.
</p>

<ul><li>
<p>("predTime")
<code>predTime</code> can be either passed as a separate vector of POSIXct or 
numeric values for all prediction times expected in the returned object. 
Note, previous versions of <code>crwPredict</code> would return both times 
specified via <code>predTime</code> as well as each original observed time. This is
no longer the default (see </p>
<p>return.type). If the original data were 
provided as a POSIXct type, then <code>crwPredict</code> can derive a sequence of 
regularly spaced prediction times from the original data. This is specified 
by providing a character string that corresponds to the <code>by</code> argument 
of the <code>seq.POSIXt</code> function (e.g. '1 hour', '30 mins'). 
<code>crwPredict</code> will round the first observed time up to the nearest unit 
(e.g. '1 hour' will round up to the nearest hour, '30 mins' will round up to 
the nearest minute) and start the sequence from there. The last observation 
time is truncated down to the nearest unit to specify the end time.

</p>
</li></ul>
<h3>Value</h3>

<p>There are three possible return types specified with <code>return.type</code>:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>minimal</code></td>
<td>
<p>a data.frame with a minimal set of columns: 
<code>date_time,mu.x,mu.y,se.mu.x,se.mu.y</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flat</code></td>
<td>
<p>a data set is returned with the
columns of the original data plus the state estimates, standard errors (se),
and speed estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>list</code></td>
<td>
<p>List with the following elements:</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>originalData</code></td>
<td>
<p>A data.frame with <code>data</code> merged with
<code>predTime</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha.hat</code></td>
<td>
<p>Predicted state</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Var.hat</code></td>
<td>
<p>array where <code>Var.hat[,,i]</code> is the prediction
covariance matrix for <code>alpha.hat[,i]</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Devin S. Johnson
</p>


<h3>References</h3>

<p>de Jong, P. and Penzer, J. (1998) Diagnosing shocks in time
series. Journal of the American Statistical Association 93:796-806.
</p>


</div>