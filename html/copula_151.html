<div class="container">

<table style="width: 100%;"><tr>
<td>dnacopula</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Density Evaluation for (Nested) Archimedean Copulas</h2>

<h3>Description</h3>

<p>For a (nested) Archimedean copula (object of class <code>nacopula</code>)
<code>x</code>, <code>dCopula(u, x)</code> (or also currently still <code>dnacopula(x, u)</code>)
evaluates the density of <code>x</code> at the given vector or matrix <code>u</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'matrix,nacopula'
dCopula(u, copula, log=FALSE, ...)

## *Deprecated*:
dnacopula(x, u, log=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>copula, x</code></td>
<td>
<p>an object of class <code>"outer_nacopula"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>argument of the copula x.  Note that u can be a matrix in which case
the density is computed for each row of the matrix and the vector of
values is returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>logical indicating if the <code>log</code> of the density
should be returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>optional arguments passed to the copula's <code>dacopula</code>
function (slot), such as <code>n.MC</code> (non-negative integer) for
possible Monte Carlo evaluation (see <code>dacopula</code> in
<code>acopula</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If it exists, the density of an Archimedean copula <code class="reqn">C</code> with
generator <code class="reqn">\psi</code> at <code class="reqn">\bm{u}\in(0,1)^d</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">c(\bm{u})=\psi^{(d)}(\psi^{-1}(u_1)+\dots+\psi^{-1}(u_d))
    \prod_{j=1}^d(\psi^{-1}(u_j))^\prime
    = \frac{\psi^{(d)}(\psi^{-1}(u_1)+\dots+\psi^{-1}(u_d))}{
      \prod_{j=1}^d\psi^\prime(\psi^{-1}(u_j))}.
  </code>
</p>



<h3>Value</h3>

<p>A <code>numeric</code> vector containing the values of the density of the
Archimedean copula at <code>u</code>.
</p>


<h3>Note</h3>

<p><code>dCopula(u, copula)</code> is a <em>generic</em> function with
methods for <em>all</em> our copula classes, see <code>dCopula</code>.
</p>


<h3>References</h3>

<p>Hofert, M., Mächler, M., and McNeil, A. J. (2012).
Likelihood inference for Archimedean copulas in high dimensions
under known margins. <em>Journal of Multivariate Analysis</em>
<b>110</b>, 133–150.
</p>
<p>Hofert, M., Mächler, M., and McNeil, A. J. (2013).
Archimedean Copulas in High Dimensions: Estimators and Numerical
Challenges Motivated by Financial Applications.
<em>Journal de la Société Française de
Statistique</em>
<b>154</b>(1), 25–63.
</p>


<h3>See Also</h3>

<p>For more details about the derivatives of an Archimedean generator,
see, for example, <code>absdPsi</code> in class <code>acopula</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Construct a twenty-dimensional Gumbel copula with parameter chosen
## such that Kendall's tau of the bivariate margins is 0.25.
theta &lt;- copJoe@iTau(.25)
C20 &lt;- onacopula("J", C(theta, 1:20))

## Evaluate the copula density at the point u = (0.5,...,0.5)
u &lt;- rep(0.5, 20)
dCopula(u, C20)

## the same with Monte Carlo based on 10000 simulated "frailties"
dCopula(u, C20, n.MC = 10000)

## Evaluate the exact log-density at several points
u &lt;- matrix(runif(100), ncol=20)
dCopula(u, C20, log = TRUE)

## Back-compatibility check
stopifnot(identical( dCopula (u, C20), suppressWarnings(
                    dnacopula(C20, u))),
          identical( dCopula (u, C20, log = TRUE), suppressWarnings(
                    dnacopula(C20, u, log = TRUE))))
</code></pre>


</div>