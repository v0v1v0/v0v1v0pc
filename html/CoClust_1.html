<div class="container">

<table style="width: 100%;"><tr>
<td>CoClust</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Copula-Based Clustering Algorithm</h2>

<h3>Description</h3>

<p>Cluster analysis based on copula functions
</p>


<h3>Usage</h3>

<pre><code class="language-R">CoClust(m, dimset = 2:5, noc = 4, copula = "frank", fun = median,
  method.ma = c("empirical", "pseudo"), method.c = c("ml", "mpl", "irho", "itau"),
   dfree = NULL, writeout = 5, penalty = c("BICk", "AICk", "LL"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>a data matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dimset</code></td>
<td>
<p>the set of dimensions for which the function tries the clustering.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noc</code></td>
<td>
<p>sample size of the set for selecting the number of clusters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>copula</code></td>
<td>
<p>a copula model.
This should be one of "normal", "t", "frank", "clayton" and "gumbel". See the Details section.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fun</code></td>
<td>
<p>combination function of the pairwise Spearman's rho used to select the k-plets. The default is <code>median</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method.ma</code></td>
<td>
<p>estimation method for margins. See the Details section.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method.c</code></td>
<td>
<p>estimation method for copula. See <code>fitCopula</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dfree</code></td>
<td>
<p>degrees of freedom for the <em>t</em> copula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>writeout</code></td>
<td>
<p>writes a message on the number of allocated observations every writeout observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty</code></td>
<td>
<p>Specifies the likelihood criterion used for selecting the number of clusters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further parameters for <code>fitCopula</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>


<dl>
<dt>Usage for Frank copula: </dt>
<dd>
<pre>CoClust(m, nmaxmarg = 2:5, noc = 4, copula = "frank",
 fun = median, method.ma=c("gaussian","empirical"), method.c = "mpl",
 penalty ="BICk", ...)</pre>
</dd>
</dl>
<p>CoClust is a clustering algorithm that, being based on copula functions, allows to group observations according to the multivariate dependence structure of the generating process without any assumptions on the margins.
</p>
<p>For each <em>k</em> in <code>dimset</code> the algorithm builds a sample of <code>noc</code> observations (rows of the data matrix <code>m</code>) by using the matrix of Spearman's rho correlation coefficients which are combined by means of the function <code>fun</code> (<code>median</code> by default).
The number of clusters <em>K</em> is selected by means of a criterion based on the likelihood of the copula fit. The switch <code>penalty</code> allows to select 3 different criteria; The choice <code>LL</code> corresponds to using
the likelihood without penalty terms. Then, the remaining observations are allocated to the clusters as follows:
1. selects a <em>K</em>-plet of observations on the basis of <code>fun</code> applied to the pairwise Spearman's rho; 2. allocates or discards the <em>K</em>-plet on the basis of the likelihood of the copula fit.
</p>
<p>The estimation approach for the copula fit is semiparametric: a range of nonparametric margins and parametric copula models can be selected by the user.
The CoClust algorithm does not require to set a priori the number of clusters nor it needs a starting classification.
</p>
<p>Notice that the dependence structure for the Gaussian and the <em>t</em> copula is set to exchangeable. Non structured dependence structures will be allowed in a future version.
</p>


<h3>Value</h3>

<p>An object of S4 class "CoClust", which is a list with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Number.of.Clusters</code></td>
<td>
<p>the number <em>K</em> of identified clusters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Index.Matrix</code></td>
<td>
<p>a <em>n.obs</em> by <em>(K+1)</em> matrix where <em>n.obs</em> is the number of observations put in each cluster. The matrix contains the row indexes of the observations of the data matrix <code>m</code>.
The last column contains the log-likelihood of the copula fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Data.Clusters</code></td>
<td>
<p>the matrix of the final clustering.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Dependence</code></td>
<td>
<p>a list containing:
</p>

<table>
<tr>
<td style="text-align: left;">
        <code>Model</code>  </td>
<td style="text-align: left;"> the copula model used for the clustering. </td>
</tr>
<tr>
<td style="text-align: left;">
        <code>Param</code>  </td>
<td style="text-align: left;"> the estimated dependence parameter between clusters. </td>
</tr>
<tr>
<td style="text-align: left;">
        <code>Std.Err</code>
</td>
<td style="text-align: left;"> the standard error of Param.</td>
</tr>
<tr>
<td style="text-align: left;">
        <code>P.val</code>  </td>
<td style="text-align: left;"> the p-value associated to the null hypothesis <code>H_0: theta=0</code>.</td>
</tr>
<tr>
<td style="text-align: left;">
        </td>
</tr>
</table>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LogLik</code></td>
<td>
<p>the maximized log-likelihood copula fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Est.Method</code></td>
<td>
<p>the estimation method used for the copula fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Opt.Method</code></td>
<td>
<p>the optimization method used for the copula fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LLC</code></td>
<td>
<p>the value of the LogLikelihood Criterion for each <em>k</em> in <code>dimset</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Index.dimset</code></td>
<td>
<p>a list that, for each <em>k</em> in <code>dimset</code>, contains the index matrix of the initial set of <code>nk</code> observations used for selecting the number of clusters, together with the associated loglikelihood.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The final clustering is composed of <em>K</em> groups in which observations of the same group are independent whereas the observations that belong to different groups and that form a <em>K</em>-plet are dependent.
</p>


<h3>Author(s)</h3>

<p>Francesca Marta Lilja Di Lascio &lt;marta.dilascio@unibz.it&gt;,
</p>
<p>Simone Giannerini &lt;simone.giannerini@unibo.it&gt;</p>


<h3>References</h3>

<p>Di Lascio, F.M.L. (201x). "CoClust: An R Package for Copula-based Cluster Analysis". To be submitted.
</p>
<p>Di Lascio, F.M.L., Durante, F. and Pappada', R. (2017). "Copula-based clustering methods", Copulas and Dependence Models with Applications, p.49-67. Eds Ubeda-Flores, M., de Amo, E., Durante, F. and Fernandez Sanchez, J., Springer International Publishing. ISBN: 978-3-319-64220-8.
</p>
<p>Di Lascio, F.M.L. and Disegna, M. (2017). "A copula-based clustering algorithm to analyse EU country diets". <em>Knowledge-Based Systems</em>, 132, p.72-84. DOI: 10.1016/j.knosys.2017.06.004.
</p>
<p>Di Lascio, F.M.L. and Giannerini, S. (2016). "Clustering dependent observations with copula functions". <em>Statistical Papers</em>, p.1-17. DOI 10.1007/s00362-016-0822-3.
</p>
<p>Di Lascio, F.M.L. and Giannerini, S. (2012). "A Copula-Based Algorithm for Discovering Patterns of Dependent Observations", <em>Journal of Classification</em>, 29(1), p.50-75.
</p>
<p>Di Lascio, F.M.L. (2008). "Analyzing the dependence structure of microarray data: a copula-based approach". <em>PhD thesis</em>, Dipartimento di Scienze Statistiche, Universita' di Bologna, Italy.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## ******************************************************************
## 1. builds a 3-variate copula with different margins
##    (Gaussian, Gamma, Beta)
##
## 2. generates a data matrix xm with 15 rows and 21 columns and
##    builds the matrix of the true cluster indexes
##
## 3. applies the CoClust to the rows of xm and recovers the
##    multivariate dependence structure of the data
## ******************************************************************

## Step 1. **********************************************************
n      &lt;- 105             # total number of observations
n.col  &lt;- 21              # number of columns of the data matrix m
n.marg &lt;- 3               # dimension of the copula
n.row  &lt;- n*n.marg/n.col  # number of rows of the data matrix m

theta  &lt;- 10
copula &lt;- frankCopula(theta, dim = n.marg)
mymvdc &lt;- mvdc(copula, c("norm", "gamma", "beta"),list(list(mean=7, sd=2),
                list(shape=3, rate=4), list(shape1=2, shape2=1)))

## Step 2. **********************************************************
set.seed(11)
x.samp &lt;- rMvdc(n, mymvdc)
xm     &lt;- matrix(x.samp, nrow = n.row, ncol = n.col, byrow=TRUE)

index.true &lt;-  matrix(1:15,5,3)
colnames(index.true) &lt;- c("Cluster 1","Cluster 2", "Cluster 3")

## Step 3. **********************************************************

clust &lt;- CoClust(xm, dimset = 2:4, noc=2, copula="frank",
                 method.ma="empirical", method.c="ml",writeout=1)
clust
clust@"Number.of.Clusters"
clust@"Dependence"$Param
clust@"Data.Clusters"
index.clust &lt;- clust@"Index.Matrix"

## compare with index.true
index.clust
index.true
##
</code></pre>


</div>