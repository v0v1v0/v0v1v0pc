<div class="container">

<table style="width: 100%;"><tr>
<td>PlotGelmanRubinDiagnosticSingleChain</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot Histogram of the Gelman-Rubin Convergence Diagnostic for a Single MCMC Chain</h2>

<h3>Description</h3>

<p>This plots a histogram of the potential scale reduction factors (PSRF) for each of the individual posterior
calendar age estimates within a single MCMC chain. Achieved by splitting the chain into segments
after <code>n_burn</code> and comparing the <em>within-chain</em> variance with the <em>between-chains</em>
variance of the segments. The PSRF of each sample's posterior calendar age is calculated.
If the chain have converged to the target posterior distribution, then PSRF should be close to 1
for all of the samples (a stringent condition is that all values are less than 1.1).
</p>
<p>For more information read the vignette: <br><code>vignette("determining-convergence", package = "carbondate")</code>
</p>


<h3>Usage</h3>

<pre><code class="language-R">PlotGelmanRubinDiagnosticSingleChain(output_data, n_burn = NA, n_segments = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>output_data</code></td>
<td>
<p>The return value from one of the updating functions, e.g.,
PolyaUrnBivarDirichlet, WalkerBivarDirichlet or PPcalibrate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_burn</code></td>
<td>
<p>The number of MCMC iterations that should be discarded for burn-in. This relates to
the total number of iterations <code>n_iter</code> when running the original update functions (not the
thinned <code>output_data</code>). Any MCMC iterations before this are not used in the calculations of the PSRF.
If not given, the first half of the MCMC chain is discarded. Note: The maximum value that the function
will allow is <code>n_iter - 100 * n_thin</code> (where <code>n_iter</code> and <code>n_thin</code> are the arguments that were given to
PPcalibrate) which would leave only 100 of the (thinned) values in <code>output_data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_segments</code></td>
<td>
<p>The number of segments to split the chain into. Default is 3, must be a
number between 2 and 10.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>None
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Plot results for the example data - n_iter is too small for convergence
# Try increasing n_iter to see the values of the PSRF decrease
polya_urn_output &lt;- PolyaUrnBivarDirichlet(
    two_normals$c14_age,
    two_normals$c14_sig,
    intcal20,
    n_iter = 500,
    show_progress = FALSE)
PlotGelmanRubinDiagnosticSingleChain(polya_urn_output)
</code></pre>


</div>