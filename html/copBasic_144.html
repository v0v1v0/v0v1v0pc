<div class="container">

<table style="width: 100%;"><tr>
<td>tailordCOP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The Lower- and Upper-Tail Orders of a Copula</h2>

<h3>Description</h3>

<p>Compute the <em>lower-</em> and <em>upper-tail orders</em> (if they exist), respectively, of a copula <code class="reqn">\mathbf{C}(u,v)</code> according to Joe (2014, pp. 67–70). The <em>tail order</em> is a concept for the strength of dependence in the joint tails of a multivariate distribution. The opposing tails can be compared to assess tail order or <em>reflection symmetry</em> (term by Joe (2014) for Nelsen's (2006, p. 36) term <em>radial symmetry</em>). Joe (2014) provides extensively analytical details but sufficient for the <span class="pkg">copBasic</span> package, the tail orders can be numerically explored.
</p>
<p>The <em>lower-tail order</em> maybe numerically approximated by
</p>
<p style="text-align: center;"><code class="reqn">\kappa^L_\mathbf{C} = \frac{\log[\mathbf{C}(t,t)]}{\log(t)}\mbox{,}</code>
</p>

<p>for some small positive values of <code class="reqn">t</code>, and similarly the <em>upper-tail order</em> maybe numerically approximated by
</p>
<p style="text-align: center;"><code class="reqn">\kappa^U_\mathbf{C} = \frac{\log[\hat{\mathbf{C}}(t,t)]}{\log(t)}\mbox{,}</code>
</p>

<p>where <code class="reqn">\hat{\mathbf{C}}(u,v)</code> is the <em>survival copula</em> (<code>surCOP</code>). Joe (2014) has potentially(?) conflicting notation in the context of the upper-tail order; the term “reflection” is used (p. 67) and “lower tail order of the reflected copula is the same as the upper tail order of the original copula” (p. 69), but Joe (2014, p. 67) only uses the joint survival function (<code>surfuncCOP</code>) in the definition of <code class="reqn">\kappa^U_\mathbf{C}</code>.
</p>
<p>As a note, the author of this package was not able to get <code>tailordCOP</code> to function properly for the upper-tail order using the joint survival function as implied on the bottom of Joe (2014, p. 67) and fortunately the fact that “reflection” is used in other contexts and used in analytical examples, the <code>tailordCOP</code> function uses the lower-tail order of the reflection (survival copula). Joe (2014) also defines <em>tail order parameter</em> <code class="reqn">\Psi</code> but that seems to be a result of analytics and not implemented in this package. Lastly, the tail orders are extendable into <code class="reqn">d</code> dimensions, but only a bivariate (<code class="reqn">d = 2</code>) is provided in <span class="pkg">copBasic</span>. The tail orders have various classifications for <code class="reqn">\kappa = \kappa_L = \kappa_U</code>:
</p>

<dl>
<dt><code class="reqn">\bullet</code></dt>
<dd>
<p><em>Intermediate tail dependence</em> for <code class="reqn">1 &lt; \kappa &lt; d</code> or <code class="reqn">\kappa = 1, \Psi = 0</code>;</p>
</dd>
<dt><code class="reqn">\bullet</code></dt>
<dd>
<p><em>Strong tail dependence</em> for <code class="reqn">\kappa = 1</code> with <code class="reqn">\Psi &gt; 0</code>; and</p>
</dd>
<dt><code class="reqn">\bullet</code></dt>
<dd>
<p><em>Tail orthant independence</em> or <em>tail quadrant independence</em> for <code class="reqn">\kappa = d</code>.</p>
</dd>
</dl>
<p>Joe (2014) provides additional properties:
</p>

<dl>
<dt><code class="reqn">\bullet</code></dt>
<dd>
<p><code class="reqn">\kappa_L = \kappa_U = d</code> for the <code class="reqn">d</code>-dimensional <em>independence copula</em> (<code>P</code>; <em>e.g.</em> <code>tailordCOP(cop=P)</code>);</p>
</dd>
<dt><code class="reqn">\bullet</code></dt>
<dd>
<p>It is not possible for <code class="reqn">\kappa_L &lt; 1</code> or <code class="reqn">\kappa_U &lt; 1</code> but each can be <code class="reqn">&gt; 1</code> for a <code class="reqn">\mathbf{C}(u,v)</code> having some negative dependence (<em>e.g.</em> <code>tailordCOP(cop=PLACKETTcop, para=0.2)</code>; see <code>PLACKETTcop</code>); and</p>
</dd>
<dt><code class="reqn">\bullet</code></dt>
<dd>
<p>For the bivariate <em>Fréchet–Hoeffding lower-bound copula</em> (<code>W</code>; <em>countermonotonicity copula</em>) the <code class="reqn">\kappa_L = \kappa_U</code> and can be considered <code class="reqn">+\infty</code>. (A special trap in the <code>tailordCOP</code> provides consistency on <code>W</code> but does not test that the copula is actually that function itself.)</p>
</dd>
</dl>
<h3>Usage</h3>

<pre><code class="language-R">tailordCOP(cop=NULL, para=NULL, tol=1e-6, plot=FALSE, verbose=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cop</code></td>
<td>
<p>A copula function;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>para</code></td>
<td>
<p>Vector of parameters or other data structure, if needed, to pass to the copula;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>A tolerance on convergence;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>A logical plotting a diagnostic plot of the diagonal derivatives and label the limits;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Show incremental progress; and</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to pass to the copula function.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> list is returned.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>kappaL</code></td>
<td>
<p>The rounded value of <code class="reqn">\kappa^L_\mathbf{C}</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kappaU</code></td>
<td>
<p>The rounded value of <code class="reqn">\kappa^U_\mathbf{C}</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>source</code></td>
<td>
<p>An attribute identifying the computational source: “tailordCOP”.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The algorithm implemented for <code>tailordCOP</code> is based on halves (or alternatives by the setting of the <code>divisor</code> argument) and uses the copula function (not an analytical or even numerical derivative of the diagonal, <code class="reqn">\delta_\mathbf{C}'(t)</code>). Starting from the median or <code class="reqn">t = 0.5</code>, each limit is respectively computed by successive halving of the distance towards <code class="reqn">0^{+}</code> and checking the change in computed value against the tolerance <code>tol</code> argument. After the change becomes less than the the <code>tol</code>erance, convergence is assumed. Other tests are made for <code>NaN</code> to aid in breaking the successive halvings. The rounding for the numerical results for <code class="reqn">\kappa^U_\mathbf{C}</code> and <code class="reqn">\kappa^L_\mathbf{C}</code> is an order of magnitude larger than the tolerance.
</p>
<p>Users are encouraged to plot the results and further verify whether the convergence makes sense. The plot produced when <code>plot=TRUE</code> shows the probability <code class="reqn">t</code> transformed into standard normal variates by the <code>qnorm()</code> function in <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> so that the distal reaches of each tail and thus limit are readily seen. The terminal points of each limit computation are shown by a small dot, and the letter “L” and “U” also are plotted at the terminal points.
</p>


<h3>Author(s)</h3>

<p>W.H. Asquith</p>


<h3>References</h3>

<p>Joe, H., 2014, Dependence modeling with copulas: Boca Raton, CRC Press, 462 p.
</p>


<h3>See Also</h3>

<p><code>COP</code>, <code>tailconCOP</code>, <code>taildepCOP</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Joe (2014, p. 5) names MTCJ = Mardia-Takahasi-Cook-Johnson copula
"MTCJ" &lt;- function(u,v, para) { (u^(-para) + v^(-para) - 1)^(-1/para) }
# The results that follow match those reported by Joe (2014, p. 69) who
# analytically derives KappaL = 1 and KappaU = 2.
# TAIL ORDER:
tailordCOP(cop=MTCJ, para=3, plot=TRUE) # kappaL  = 1.00667, kappaU  = 1.96296
# TAIL DEPENDENCY:
taildepCOP(cop=MTCJ, para=3, plot=TRUE) # lambdaL = 0,       lambdaU = 0.7937
# Joe (2014) reports lambdaL = 2^(-1/para) = 2^(-1/3) = 0.7937005
## End(Not run)
</code></pre>


</div>