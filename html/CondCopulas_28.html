<div class="container">

<table style="width: 100%;"><tr>
<td>estimateCondCDF_matrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute kernel-based conditional marginal (univariate) cdfs</h2>

<h3>Description</h3>

<p>This function computes an estimate of the conditional (marginal) cdf
of X1 given a conditioning variable X3.
</p>


<h3>Usage</h3>

<pre><code class="language-R">estimateCondCDF_matrix(observedX1, newX1, matrixK3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>observedX1</code></td>
<td>
<p>a sample of observations of X1 of size <code>n</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newX1</code></td>
<td>
<p>a sample of new points for the variable X1, of size <code>p1</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>matrixK3</code></td>
<td>
<p>a matrix of kernel values of dimension <code>(p3, n)</code>
<code class="reqn">\big(K_h(X3[i] - U3[j])\big)_{i,j}</code>
such as given by <code>computeKernelMatrix</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is supposed to be used with <code>computeKernelMatrix</code>.
Assume that we observe a sample <code class="reqn">(X_{i,1}, X_{i,3}), i=1, \dots, n</code>.
We want to estimate the conditional cdf of <code class="reqn">X_1</code> given <code class="reqn">X_3 = x_3</code>
at point <code class="reqn">x_1</code> using the following kernel-based estimator
</p>
<p style="text-align: center;"><code class="reqn">\hat P(X_1 \le x_1 | X_3 = x_3)
:= \frac{\sum_{l=1}^n 1 \{X_{l,1} \leq x_1 \} K_h(X_{l,3} - x_3)}
{\sum_{l=1}^n K_h(X_{l,3} - x_3)},</code>
</p>

<p>for every <code class="reqn">x_1</code> in <code>newX1</code> and every <code class="reqn">x_3</code> in <code>newX3</code>.
The <code>matrixK3</code> should be a matrix of the values <code class="reqn">K_h(X_{l,3} - x_3)</code>
such as the one produced by
<code>computeKernelMatrix(observedX3, newX3, kernel, h)</code>.
</p>


<h3>Value</h3>

<p>A matrix of dimensions <code>(p1 = length(newX), p3 = length(matrixK3[,1]))</code>
of estimators <code class="reqn">\hat P(X_1 \leq x_1 | X_3 = x_3)</code> for every possible choices
of <code class="reqn">(x_1, x_3)</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">Y = MASS::mvrnorm(n = 100, mu = c(0,0), Sigma = cbind(c(1, 0.9), c(0.9, 1)))
newY1 = seq(-1, 1, by = 0.5)
newY2 = c(0, 1, 2)
matrixK = computeKernelMatrix(observedX = Y[,2], newX = newY2,
  kernel = "Gaussian", h = 0.8)
# In this matrix, there are the estimated conditionl cdf at points given by newY1
# conditionally to the points given by newY2.
matrixCondCDF = estimateCondCDF_matrix(observedX1 = Y[,1],
  newX1 = newY1, matrixK)
matrixCondCDF

</code></pre>


</div>