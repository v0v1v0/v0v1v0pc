<div class="container">

<table style="width: 100%;"><tr>
<td>coalescentMCMC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Run MCMC for Coalescent Trees</h2>

<h3>Description</h3>

<p>These are the main function of the package to run a Markov chain Monte
Carlo (MCMC) to generate a set of trees which is returned with their
likelihoods, the coalescent likelihoods and the respective parameter(s).
</p>
<p>The <code>logLik</code> method returns the average log-likelihood of the
coalescent model. <code>AIC</code>, <code>BIC</code>, and <code>anova</code> use this
average log-likelihood.
</p>


<h3>Usage</h3>

<pre><code class="language-R">coalescentMCMC(x, ntrees = 3000, model = "constant", tree0 = NULL,
               printevery = 100, degree = 1, nknots = 0,
               knot.times = NULL, moves = 1:6)
## S3 method for class 'coalescentMCMC'
logLik(object, ...)
## S3 method for class 'coalescentMCMC'
AIC(object, ..., k = 2)
## S3 method for class 'coalescentMCMC'
BIC(object, ...)
## S3 method for class 'coalescentMCMC'
anova(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a set of DNA sequences, typically an object of class
<code>"DNAbin"</code> or <code>"phyDat"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntrees</code></td>
<td>
<p>the number of trees to output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tree0</code></td>
<td>
<p>the initial tree of the chain; by default, a UPGMA
tree with a JC69 distance is generated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>the coalescent model to be used for resampling. By
default, a constant-THETA is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>printevery</code></td>
<td>
<p>an integer specifying the frequency at which to
print the numbers of trees proposed and accepted; set to 0 to cancel
all printings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degree, nknots, knot.times</code></td>
<td>
<p>parameters used if <code>model =
    "splines"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>moves</code></td>
<td>
<p>the tree moves used by the MCMC (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>options passed to other methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an bject of class <code>"coalescentMCMC"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>the coefficient used to calculate the AIC (see
<code>AIC</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Six tree moves are programmed and one is chosen randomly at each step
of the MCMC. The steps are: (1) NeighborhoodRearrangement (Kuhner et
al., 1995), (2) ScalingMove, (3) branchSwapping, (4) subtreeExchange,
(5) NodeAgeMove, and (6) randomWalkThetaMu (all five from Drummond et
al., 2002). In practice, it appears that in many situations
<code>moves = c(1, 3)</code> is a good selection resulting in around 50% acceptance rate.
</p>


<h3>Value</h3>

<p><code>coalescentMCMC</code> returns an object of class
<code>c("coalescentMCMC", "coda")</code> with the log-likelihood and the
parameters of each tree.
</p>
<p><code>logLik</code>, <code>AIC</code> and <code>BIC</code> return a numeric vector.
</p>
<p><code>anova</code> return an object of class <code>"anova"</code>.
</p>


<h3>Author(s)</h3>

<p>Emmanuel Paradis</p>


<h3>References</h3>

<p>Drummond, A. J., Nicholls, G. K., Rodrigo, A. G. and Solomon,
W. (2002) Estimating mutation parameters, population history and
genealogy simultaneously from temporally spaced sequence
data. <em>Genetics</em>, <b>161</b>, 1307–1320.
</p>
<p>Hastings, W. K. (1970) Monte Carlo sampling methods using Markov
chains and their applications. <em>Biometrika</em>, <b>57</b>, 97–109.
</p>
<p>Kuhner, M. K., Yamato, J. and Felsenstein, J. (1995) Estimating
effective population size and mutation rate from sequence data using
Metropolis-Hastings sampling. <em>Genetics</em>, <b>140</b>, 1421–1430.
</p>


<h3>See Also</h3>

<p><code>getMCMCtrees</code>, <code>dcoal</code>, <code>treeOperators</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data(woodmouse)
out &lt;- coalescentMCMC(woodmouse)
plot(out)
getMCMCtrees() # returns 3000 trees

## End(Not run)</code></pre>


</div>