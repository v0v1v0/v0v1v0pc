<div class="container">

<table style="width: 100%;"><tr>
<td>sedFitThin</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Optically-thin SED fit
</h2>

<h3>Description</h3>

<p>Function takes Herschel-SPIRE photometry and fits optically-thin
greybody function for a single-component temperature and galaxy
luminosity.  Function generates nsamp realizations of observed flux
densities with standard deviations for error analysis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sedFitThin(s, e = s*0.2, z = 2.5, nsamp = 100, alpha = 2, beta = 1.5,
wl= c(250, 350, 500), sc.start = 1.e-6, T.start = 50)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>

<p>Vector of observed-frame flux densities [Jy]
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>e</code></td>
<td>

<p>Vector of standard deviation of observed-frame flux density [Jy]
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>

<p>Galaxy redshift
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsamp</code></td>
<td>

<p>Number of realizations for Monte-Carlo calculation
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>Index of power-law for short-wavelength extension
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>

<p>Dust emissivity power law
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wl</code></td>
<td>

<p>Vector of observed-frame wavelengths corresponding to <code>s</code> and
<code>e</code> [microns]
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sc.start</code></td>
<td>

<p>Initial guess for fit luminosity density scaling factor
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T.start</code></td>
<td>

<p>Initial guess for dust temperature [K]
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Conversion from observed to rest frame is from equation (24) in Hogg
2000.  Dust temperature and 8-1000 micron luminosity derivation is
described in Blain, Barnard &amp; Chapman 2003.  Galaxy SEDs typically fall
off more slowly than greybody on the Wien side; see plot generated by
examples below to visualize power-law extension suggested by Blain et
al. 2003.
</p>


<h3>Value</h3>

<p>List of class <code>sedfit</code> with elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>td</code></td>
<td>
<p>Mean of dust temperature distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>e.td</code></td>
<td>
<p>Standard deviation of dust temperature distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lum.gb</code></td>
<td>
<p>Mean of greybody luminosity distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>e.lum.gb</code></td>
<td>
<p>Standard deviation of greybody luminosity distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lum.gbpl</code></td>
<td>
<p>Mean of greybody-power law luminosity distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>e.lum.gbpl</code></td>
<td>
<p>Standard deviation of greybody-power law luminosity
distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaleFactor</code></td>
<td>
<p>Conversion between observed frame flux density and
rest frame luminosity density</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>success</code></td>
<td>
<p>Fraction of fit attempts that converged</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>results</code></td>
<td>
<p>Matrix with <code>nsamp</code> rows and 5 columns:
dust temperature in K, greybody luminosity, luminosity for  greybody with
smoothly-joined power law to short wavelengths, luminosity density
scaling, and transition frequency in GHz for power law extension.
The first row contains results for the center-of-error input flux
densities <code>s</code>.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Fit will sometimes crash on numerical derivative and throw an error.  In
this case the routine will halt without producing results.  The more
usual lack of convergence is reported as a warning, and the
corresponding results will be <code>NA</code> in the output matrix.
</p>


<h3>Author(s)</h3>

<p>A. Harris
</p>


<h3>References</h3>

<p>Hogg 2000, astro-ph 9905116v4; Blain, Barnard &amp; Chapman 2003,
MNRAS 338, 733.
</p>


<h3>Examples</h3>

<pre><code class="language-R">s &lt;- c(0.242, 0.293, 0.231)
e &lt;- c(0.037, 0.045, 0.036)
z &lt;- 2.41
beta &lt;- 1.5
alpha &lt;- 2
X &lt;- sedFitThin(s=s, e=e, z=z, alpha=alpha, beta=beta, nsamp=100)
str(X)

## Make a plot
# greybody in blue, power-law extension in red dashed line
# functions
# optically thin greybody
otGreybody &lt;- function(nu, T, beta, sc=1) {
                       # nu in GHz, T in K, beta and sc unitless
                       sc*nu^(3+beta)/(exp(0.04801449*nu/T) - 1)
              }
# high frequency tail
hfTail &lt;- function(nu, alpha) nu^-alpha
#
# setups for 8-1000 microns:
nu.low &lt;- 3e5/1000
nu.high &lt;- 3e5/8
l.nue &lt;- s*X$scaleFactor
#
# greybody
nue.sweep &lt;- seq(nu.low, nu.high, len=350)
pred &lt;- otGreybody(nue.sweep, X$results[1,1], beta=beta,
                   X$results[1,4])
ylim &lt;- range(pred, l.nue)
par(fig=c(0,1,0.2,1), mgp=c(1.8, 0.6, 0))
plot(3e5/nue.sweep, pred, t='l', ylim=ylim, log='xy', col=4,
     xlab='Rest frame wavelength [microns]',
     ylab=expression(paste('Luminosity density [ ', L[sun],
                           ' ', Hz^-1, ']')))
# power law
nue.sweep &lt;- seq(X$results[1,5], nu.high, len=100)
val.t &lt;- otGreybody(nu=X$results[1,5], T=X$results[1,1], beta=beta,
     sc=X$results[1,4])
lines(3e5/nue.sweep, val.t*hfTail(nue.sweep/X$results[1,5], alpha=alpha),
      col=2, lwd=1, lty=2)
# data
wl &lt;- c(250, 350, 500)
nue &lt;- 3e5/wl*(1+z)
points(3e5/nue, l.nue, pch=16, col=3)
</code></pre>


</div>