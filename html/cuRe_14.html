<div class="container">

<table style="width: 100%;"><tr>
<td>fit.cure.model</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Parametric cure model</h2>

<h3>Description</h3>

<p>This function fits parametric cure models using simple parametric distributions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit.cure.model(
  formula,
  data,
  formula.surv = NULL,
  type = c("mixture", "nmixture"),
  dist = c("weibull", "exponential", "lognormal", "weiwei", "weiexp", "gmw"),
  link = c("logit", "loglog", "identity", "probit"),
  bhazard = NULL,
  covariance = TRUE,
  link.mix = c("logit", "loglog", "identity", "probit"),
  control = list(maxit = 10000),
  method = "Nelder-Mead",
  init = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>Formula for modelling the cure proportion. The left hand side
has to be of the form <code>Surv(time, status)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data frame in which to interpret the variable names in <code>formula</code> and <code>formula.surv</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula.surv</code></td>
<td>
<p>List of formulas for each parameter in the parametric distribution (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>A character indicating the type of cure model.
Possible values are <code>mixture</code> (default) and <code>nmixture</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>
<p>The parametric distribution of the survival of the uncured.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>
<p>Character. Specifies the link function of the cure proportion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bhazard</code></td>
<td>
<p>Background hazard.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariance</code></td>
<td>
<p>Logical. If <code>TRUE</code> (default), the covariance matrix is computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link.mix</code></td>
<td>
<p>Character. Specifies the link function for the mixture parameter in a
weibull-weibull mixture model and weibull-exponential model.<br> Only used when <code>dist = "weiwei"</code> and <code>dist = "weiexp"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>List of control parameters passed to <code>optim</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Optimization method passed to <code>optim</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>Initial values for the maximum likelihood optimization.
If not provided, the optimization will start in 0.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>type = "mixture"</code>, the function fits the model,
</p>
<p style="text-align: center;"><code class="reqn">S(t|z) = \pi(z) + [1 - \pi(z)] S_u(t|z),</code>
</p>

<p>and if <code>type = "nmixture"</code>, the function fits the model,
</p>
<p style="text-align: center;"><code class="reqn">S(t|z) = \pi(z)^{\widetilde F(t)},</code>
</p>

<p>where z is a vector of covariates. The <code>formula.surv</code> argument is used to model
<code class="reqn">S_u(t)</code> (1 - <code class="reqn">\widetilde F(t)</code>). It is a <code>list</code> of formulas with as many entries as there are
parameters in the chosen parametric distribution. If not specified, all formulas are assumed to be <code>~1</code>.
The ith formula, i.e., <code>formula.surv[[i]]</code> refers to <code class="reqn">\theta_i</code> in the below survival functions.<br><br>
Exponential model:
</p>
<p style="text-align: center;"><code class="reqn">S_u(t) = \exp\left(-t \theta_1\right).</code>
</p>

<p>Weibull model:
</p>
<p style="text-align: center;"><code class="reqn">S_u(t) = \exp\left(-\theta_1 t^{\theta_2}\right).</code>
</p>

<p>Log-normal model:
</p>
<p style="text-align: center;"><code class="reqn">S_u(t) = 1 - \Phi\left(\frac{\log(t) - \theta_1}{\theta_2}\right).</code>
</p>

<p>Weibull-exponential mixture model:
</p>
<p style="text-align: center;"><code class="reqn">S_u(t) = \theta_1\exp\left(-\theta_2 t^{\theta_3}\right) + (1 - \theta_1)\exp\left(-\theta_4 t\right).</code>
</p>

<p>Weibull-Weibull mixture model:
</p>
<p style="text-align: center;"><code class="reqn">S_u(t) = \theta_1\exp\left(-\theta_2 t^{\theta_3}\right) + (1 - \theta_1)\exp\left(-\theta_4 t^{\theta_5}\right).</code>
</p>

<p>Generalized modified Weibull distribution:
</p>
<p style="text-align: center;"><code class="reqn">S_u(t) = 1-\left(1 - \exp\left(-\theta_1 t ^ \theta_2 \exp(\theta_3 t)\right)\right) ^ \theta_4.</code>
</p>

<p>In the Weibull-exponential and Weibull-Weibull mixture models, the link function for the mixture component is controlled by <code>link.mix</code>.
The remaining parameters are modelled using an exponential link function except <code class="reqn">\theta_1</code> in the log-normal model,
which is modelled using the identity. Parameters are not transformed back to the original scale in
the outputted object and related <code>print.cm</code> and <code>summary.cm</code> functions
</p>


<h3>Value</h3>

<p>An object of class <code>cm</code> containing the estimated parameters of the cure model.
The appropriate link functions taken on <code class="reqn">\pi</code> and the <code class="reqn">\theta_i</code>'s are linear in the covariates corresponding to their respective parameter estimates.
</p>


<h3>Examples</h3>

<pre><code class="language-R">##Use data cleaned version of the colon cancer data from the rstpm2 package
data("colonDC")
set.seed(2)
colonDC &lt;- colonDC[sample(1:nrow(colonDC), 500), ]

##Extract general population hazards
colonDC$bhaz &lt;- general.haz(time = "FU", rmap = list(age = "agedays", sex = "sex", year= "dx"),
                            data = colonDC, ratetable = survexp.dk)


###Without covariates
##Fit weibull mixture cure model
fit.wei &lt;- fit.cure.model(Surv(FUyear, status) ~ 1, data = colonDC, bhazard = "bhaz",
                          type = "mixture", dist = "weibull", link = "logit")

##Plot various summaries of the model (see ?predict.cm)
plot(fit.wei)
plot(fit.wei, time = seq(0, 40, length.out = 100))
plot(fit.wei, type = "hazard")
plot(fit.wei, type = "survuncured")
plot(fit.wei, type = "probcure")

#Fit a weibull-weibull mixture cure model
fit.weiwei &lt;- fit.cure.model(Surv(FUyear, status) ~ 1, data = colonDC, bhazard = "bhaz",
                          type = "mixture", dist = "weiwei", link = "logit")

#Compare to the weibull model
plot(fit.wei, ci = FALSE)
plot(fit.weiwei, add = TRUE, col = 2, ci = FALSE)

###With covariates
##Fit weibull mixture cure model with age effect for both components of the Weibull model
fit &lt;- fit.cure.model(Surv(FUyear, status) ~ age, data = colonDC, bhazard = "bhaz",
                      formula.surv = list(~ age, ~ age),
                      type = "mixture", dist = "weibull", link = "logit")

##Plot model for age 50 and 60
plot(fit, newdata = data.frame(age = 60),
     time = seq(0, 15, length.out = 100), ci = FALSE)
plot(fit, newdata = data.frame(age = 50),
     time = seq(0, 15, length.out = 100), ci = FALSE, add = TRUE, col = 2)

plot(fit, newdata = data.frame(age = 60),
     time = seq(0, 15, length.out = 100), ci = FALSE, type = "hazard")
plot(fit, newdata = data.frame(age = 50),
     time = seq(0, 15, length.out = 100), ci = FALSE, type = "hazard", add = TRUE, col = 2)
</code></pre>


</div>