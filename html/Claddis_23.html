<div class="container">

<table style="width: 100%;"><tr>
<td>classify_costmatrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Classify a costmatrix character</h2>

<h3>Description</h3>

<p>Given a costmatrix, classifies it into one of twelve distinct types.
</p>


<h3>Usage</h3>

<pre><code class="language-R">classify_costmatrix(costmatrix)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>costmatrix</code></td>
<td>
<p>An object of class <code>costMatrix</code>.</p>
</td>
</tr></table>
<h3>Details</h3>

<p>Hoyal Cuthill and Lloyd (in press) classified discrete characters into twelve different types. This function applies their classification to a costmatrix object. The twelve different types are defined below alongside an empirical example for each, following Hoyal Cuthill and Lloyd (in review).
</p>
<p><b>Type I - Constant</b>
</p>
<p>The simplest character type - only one state
</p>
<p>Example: Character 18 of Sterli et al. (2013)
</p>
<p>Costmatrix:
</p>
<pre>    -----
    | 0 |
---------
| 0 | 0 |
---------</pre>
<p>State graph:
</p>
<pre>0</pre>
<p><b>Type II - Binary symmetric</b>
</p>
<p>Exactly two states with equal and finite transition costs between them.
</p>
<p>Example: Character 1 of Sterli et al. (2013)
</p>
<p>Costmatrix:
</p>
<pre>    ---------
    | 0 | 1 |
-------------
| 0 | 0 | 1 |
-------------
| 1 | 1 | 0 |
-------------</pre>
<p>State graph:
</p>
<pre>  1
0---1</pre>
<p><b>Type III - Multistate unordered</b>
</p>
<p>Three or more states where every state-to-state transition has equal and finite cost.
</p>
<p>Example: Character 53 of Sterli et al. (2013)
</p>
<p>Costmatrix:
</p>
<pre>    -------------
    | 0 | 1 | 2 |
-----------------
| 0 | 0 | 1 | 1 |
-----------------
| 1 | 1 | 0 | 1 |
-----------------
| 2 | 1 | 1 | 0 |
-----------------</pre>
<p>State graph:
</p>
<pre>    1
   / \
 1/   \1
 /     \
0-------2
    1</pre>
<p><b>Type IV - linear ordered symmetric</b>
</p>
<p>Three or more states arranged as a single path with all connected states having equal and finite transition cost.
</p>
<p>Example: Character 7 of Sterli et al. (2013)
</p>
<p>Costmatrix:
</p>
<pre>    -------------
    | 0 | 1 | 2 |
-----------------
| 0 | 0 | 1 | 2 |
-----------------
| 1 | 1 | 0 | 1 |
-----------------
| 2 | 2 | 1 | 0 |
-----------------</pre>
<p>State graph:
</p>
<pre>  1   1
0---1---2</pre>
<p><b>Type V - Non-linear ordered symmetric</b>
</p>
<p>Four or more states arranged into a state graph with at least one branching point (vertex of degree three or greater) with all connected states having equal and finite transition costs.
</p>
<p>Example: Character 71 of Hooker (2014)
</p>
<p>Costmatrix:
</p>
<pre>    -------------
    | 0 | 1 | 2 | 3 |
---------------------
| 0 | 0 | 1 | 2 | 2 |
---------------------
| 1 | 1 | 0 | 1 | 1 |
---------------------
| 1 | 2 | 1 | 0 | 2 |
---------------------
| 1 | 2 | 1 | 2 | 0 |
---------------------</pre>
<p>State graph:
</p>
<pre>          2
         /
       1/
   1   /
0-----1
       \
       1\
         \
          3</pre>
<p><b>Type VI - Binary irreversible</b>
</p>
<p>Two states where transitions in one direction have infinite cost and the other finite cost.
</p>
<p>Example: Character 119 of Gunnell et al. (2018)
</p>
<p>Costmatrix:
</p>
<pre>    ---------
    | 0 | 1 |
-------------
| 0 | 0 | 1 |
-------------
| 1 | i | 0 |
-------------</pre>
<p>(i = infinity)
</p>
<p>State graph:
</p>
<pre>  1
0--&gt;1</pre>
<p><b>Type VII - Multistate irreversible</b>
</p>
<p>Three or more states where transitions in one direction have infinite cost and the other finite cost.
</p>
<p>Example: Character 21 of Gunnell et al. (2018)
</p>
<p>Costmatrix:
</p>
<pre>    -------------
    | 0 | 1 | 2 |
-----------------
| 0 | 0 | 1 | 2 |
-----------------
| 1 | i | 0 | 1 |
-----------------
| 2 | i | i | 0 |
-----------------</pre>
<p>(i = infinity)
</p>
<p>State graph:
</p>
<pre>  1   1
0--&gt;1--&gt;2</pre>
<p><b>Type VIII - Binary Dollo</b>
</p>
<p>Two states where transitions in one direction can be made at most once, with no restriction in the other direction.
</p>
<p>Example: Character 10 of Paterson et al. (2014)
</p>
<p>Costmatrix:
</p>
<pre>    ----------
    | 0 | 1 |
-------------
| 0 | 0 | D |
-------------
| 1 | 1 | 0 |
-------------</pre>
<p>(D = a Dollo penalty applied to avoid multiple transitions, see Swofford and Olsen 1990)
</p>
<p>State graph:
</p>
<pre>      1
 --- &lt;-- ---
| 0 |   | 1 |
 --- --&gt; ---
      D</pre>
<p><b>Type IX - Multistate Dollo</b>
</p>
<p>Three or more states where transitions in one direction can be made at most once, with no restriction in the other direction.
</p>
<p>Example: Character 15 of Paterson et al. (2014)
</p>
<p>Costmatrix:
</p>
<pre>    --------------
    | 0 | 1 |  2 |
------------------
| 0 | 0 | D | 2D |
------------------
| 1 | 1 | 0 |  D |
------------------
| 2 | 2 | 1 |  0 |
------------------</pre>
<p>(D = a Dollo penalty applied to avoid multiple transitions, see Swofford and Olsen 1990)
</p>
<p>State graph:
</p>
<pre>      1       1
 --- &lt;-- --- &lt;-- ---
| 0 |   | 1 |   | 2 |
 --- --&gt; --- --&gt; ---
      D       D</pre>
<p><b>Type X - Multistate symmetric</b>
</p>
<p>Three or more states where connected states have symmetric finite costs, but where these are not all equal.
</p>
<p>Example: Character 8 of Sumrall abd Brett (2002)
</p>
<p>Costmatrix:
</p>
<pre>
    -------------------------
    | 0 | 1 | 2 | 3 | 4 | 5 |
-----------------------------
| 0 | 0 | 1 | 2 | 3 | 2 | 3 |
-----------------------------
| 1 | 1 | 0 | 3 | 2 | 1 | 2 |
-----------------------------
| 2 | 2 | 3 | 0 | 3 | 2 | 1 |
-----------------------------
| 3 | 3 | 2 | 3 | 0 | 1 | 2 |
-----------------------------
| 4 | 2 | 1 | 2 | 1 | 0 | 1 |
-----------------------------
| 5 | 3 | 2 | 1 | 2 | 1 | 0 |
-----------------------------</pre>
<p>State graph:
</p>
<pre>   1
 2---5   3
 |    \  |
2|    1\ |1
 |      \|
 0---1---4
   1   1</pre>
<p><b>Type XI - Binary asymmetric</b>
</p>
<p>Two states where transition costs are finite but non-equal.
</p>
<p>Example: Character 3 of Gheerbrant et al. (2014)
</p>
<p>Costmatrix:
</p>
<pre>    ----------
    |  0 | 1 |
--------------
| 0 |  0 | 1 |
--------------
| 1 | 10 | 0 |
--------------</pre>
<p>State graph:
</p>
<pre>      10
 --- &lt;--- ---
| 0 |    | 1 |
 --- ---&gt; ---
      1</pre>
<p><b>Type XII - Multistate asymmetric</b>
</p>
<p>Three or more states where at least one transition is asymmetric, but the character does not meet the definition of other multistate asymmetric characters (i.e., Type VII and IX).
</p>
<p>Example: Character 7 of Gheerbrant et al. (2014)
</p>
<p>Costmatrix:
</p>
<pre>    ---------------
    |  0 |  1 | 2 |
-------------------
| 0 |  0 |  1 | 1 |
-------------------
| 1 |  1 |  0 | 1 |
-------------------
| 1 | 10 | 10 | 0 |
-------------------</pre>
<p>State graph:
</p>
<pre>          10
    ______________
   /              \
  L   1       10   \
 --- &lt;-- --- &lt;--- ---
| 0 |   | 1 |    | 2 |
 --- --&gt; --- ---&gt; ---
  \   1        1   ^
   \______________/
           1</pre>
<p><b>Other character types</b>
</p>
<p>The classification of Hoyal Cuthill and Lloyd (in review) was derived as a means to delineate a mathematical problem. As such it may be of use to consider where some special kinds of character would fall in this classification.
</p>
<p><em>Stratigraphic characters</em>
</p>
<p>These would be classified as either Type VI, Type VII, Type XI, or Type XII characters (depending on state count and spacing of stratigraphic units).
</p>
<p><em>Gap-weighted characters</em>
</p>
<p>A gap-weighted (Thiele 1993) character would be classified as either Type II or Type IV (depending on state count), but differ in the implicit assumption of whether all states are expected to be sampled. For a gap-weighted character there is no presumption that every state be sampled as the spacing between states is the primary information being considered.
</p>
<p><em>Continuous characters</em>
</p>
<p>Continuous characters are necessarily not classifiable here as they are by definition non-discrete (except where translated into a gap-weighted character, above).
</p>


<h3>Value</h3>

<p>A text string indicating the classification result (e.g., <code>"Type VIII"</code>).
</p>


<h3>Author(s)</h3>

<p>Graeme T. Lloyd <a href="mailto:graemetlloyd@gmail.com">graemetlloyd@gmail.com</a>
</p>


<h3>References</h3>

<p>Gunnell, G. F., Boyer, D. M., Friscia, A. R., Heritage, S., Manthi, F. K., Miller, E. R., Sallam, H. M., Simmons, N. B., Stevens, N. J. and Seiffert, E. R., 2018. Fossil lemurs from Egypt and Kenya suggest an African origin for Madagascar's aye-aye. <em>Nature Communications</em>, <b>9</b>, 3193.
</p>
<p>Hooker, J. J., 2014. New postcranial bones of the extinct mammalian family Nyctitheriidae (Paleogene, UK): primitive euarchontans with scansorial locomotion. <em>Palaeontologia Electronica</em>, <b>17.3.47A</b>, 1-82.
</p>
<p>Hoyal Cuthill, J. F. and Lloyd, G. T., in press. Measuring homoplasy I: comprehensive measures of maximum and minimum cost under parsimony across discrete cost matrix character types. <em>Cladistics</em>, bold, .
</p>
<p>Paterson, A. M., Wallis, G. P., Kennedy, M. and Gray, R. D., 2014. Behavioural evolution in penguins does not reflect phylogeny. <em>Cladistics</em>, <b>30</b>, 243-259.
</p>
<p>Sterli, J., Pol, D. and Laurin, M., 2013. Incorporating phylogenetic uncertainty on phylogeny-based palaeontological dating and the timing of turtle diversification. <em>Cladistics</em>, <b>29</b>, 233-246.
</p>
<p>Sumrall, C. D. and Brett, C. E., 2002. A revision of <em>Novacystis hawkesi</em> Paul and Bolton 1991 (Middle Silurian: Glyptocystitida, Echinodermata) and the phylogeny of early callocystitids. <em>Journal of Paleontology</em>, <b>76</b>, 733-740.
</p>
<p>Swofford, D. L. and Olsen, G. J., 1990. Phylogeny reconstruction. In D. M. Hillis and C. Moritz (eds.), <em>Molecular Systematics</em>. Sinauer Associates, Sunderland. pp411-501.
</p>
<p>Thiele, K.. 1993. The Holy Grail of the perfect character: the cladistic treatment of morphometric data. <em>Cladistics</em>, <b>9</b>, 275-304.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Create a Type I character costmatrix:
constant_costmatrix &lt;- make_costmatrix(
  min_state = 0,
  max_state = 0,
  character_type = "unordered"
)

# Classify costmatrix:
classify_costmatrix(costmatrix = constant_costmatrix)

# Create a Type II character costmatrix:
binary_symmetric_costmatrix &lt;- make_costmatrix(
  min_state = 0,
  max_state = 1,
  character_type = "unordered"
)

# Classify costmatrix:
classify_costmatrix(costmatrix = binary_symmetric_costmatrix)

# Create a Type III character costmatrix:
unordered_costmatrix &lt;- make_costmatrix(
  min_state = 0,
  max_state= 2,
  character_type = "unordered"
)

# Classify costmatrix:
classify_costmatrix(costmatrix = unordered_costmatrix)

# Create a Type IV character costmatrix:
linear_ordered_costmatrix &lt;- make_costmatrix(
  min_state = 0,
  max_state= 2,
  character_type = "ordered"
)

# Classify costmatrix:
classify_costmatrix(costmatrix = linear_ordered_costmatrix)

# Create a Type V character costmatrix:
nonlinear_ordered_costmatrix &lt;- convert_adjacency_matrix_to_costmatrix(
  adjacency_matrix = matrix(
    data = c(
      0, 1, 0, 0,
      1, 0, 1, 1,
      0, 1, 0, 0,
      0, 1, 0, 0
    ),
    nrow = 4,
    dimnames = list(0:3, 0:3)
  )
)

# Classify costmatrix:
classify_costmatrix(costmatrix = nonlinear_ordered_costmatrix)

# Create a Type VI character costmatrix:
binary_irreversible_costmatrix &lt;- make_costmatrix(
  min_state = 0,
  max_state= 1,
  character_type = "irreversible"
)

# Classify costmatrix:
classify_costmatrix(costmatrix = binary_irreversible_costmatrix)

# Create a Type VII character costmatrix:
multistate_irreversible_costmatrix &lt;- make_costmatrix(
  min_state = 0,
  max_state= 2,
  character_type = "irreversible"
)

# Classify costmatrix:
classify_costmatrix(costmatrix = multistate_irreversible_costmatrix)

# Create a Type VIII character costmatrix:
binary_dollo_costmatrix &lt;- make_costmatrix(
  min_state = 0,
  max_state= 1,
  character_type = "dollo"
)

# Classify costmatrix:
classify_costmatrix(costmatrix = binary_dollo_costmatrix)

# Create a Type IX character costmatrix:
multistate_dollo_costmatrix &lt;- make_costmatrix(
  min_state = 0,
  max_state= 2,
  character_type = "dollo"
)

# Classify costmatrix:
classify_costmatrix(costmatrix = multistate_dollo_costmatrix)

# Create a Type X character costmatrix:
multistate_symmetric_costmatrix &lt;- make_costmatrix(
  min_state = 0,
  max_state= 5,
  character_type = "ordered"
)
multistate_symmetric_costmatrix$type &lt;- "custom"
multistate_symmetric_costmatrix$costmatrix &lt;- matrix(
  data = c(
    0, 1, 2, 3, 2, 3,
    1, 0, 3, 2, 1, 2,
    2, 3, 0, 3, 2, 1,
    3, 2, 3, 0, 1, 2,
    2, 1, 2, 1, 0, 1,
    3, 2, 1, 2, 1, 0
  ),
  nrow = multistate_symmetric_costmatrix$size,
  ncol = multistate_symmetric_costmatrix$size,
  byrow = TRUE,
  dimnames = list(
    multistate_symmetric_costmatrix$single_states,
    multistate_symmetric_costmatrix$single_states
  )
)

# Classify costmatrix:
classify_costmatrix(costmatrix = multistate_symmetric_costmatrix)

# Create a Type XI character costmatrix:
binary_asymmetric_costmatrix &lt;- make_costmatrix(
  min_state = 0,
  max_state= 1,
  character_type = "ordered"
)
binary_asymmetric_costmatrix$type &lt;- "custom"
binary_asymmetric_costmatrix$costmatrix &lt;- matrix(
  data = c(
    0, 1,
    10, 0
  ),
  nrow = binary_asymmetric_costmatrix$size,
  ncol = binary_asymmetric_costmatrix$size,
  byrow = TRUE,
  dimnames = list(
    binary_asymmetric_costmatrix$single_states,
    binary_asymmetric_costmatrix$single_states
  )
)
binary_asymmetric_costmatrix$symmetry &lt;- "Asymmetric"

# Classify costmatrix:
classify_costmatrix(costmatrix = binary_asymmetric_costmatrix)

# Create a Type XII character costmatrix:
multistate_asymmetric_costmatrix &lt;- make_costmatrix(
  min_state = 0,
  max_state= 2,
  character_type = "ordered"
)
multistate_asymmetric_costmatrix$type &lt;- "custom"
multistate_asymmetric_costmatrix$costmatrix &lt;- matrix(
  data = c(
    0, 1, 1,
    1, 0, 1,
    10, 10, 0
  ),
  nrow = multistate_asymmetric_costmatrix$size,
  ncol = multistate_asymmetric_costmatrix$size,
  byrow = TRUE,
  dimnames = list(
    multistate_asymmetric_costmatrix$single_states,
    multistate_asymmetric_costmatrix$single_states
  )
)
multistate_asymmetric_costmatrix$symmetry &lt;- "Asymmetric"

# Classify costmatrix:
classify_costmatrix(costmatrix = multistate_asymmetric_costmatrix)

</code></pre>


</div>