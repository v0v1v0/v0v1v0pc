<div class="container">

<table style="width: 100%;"><tr>
<td>ADMM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Penalized Optimization Framework for Community Detection in Networks with Covariates.</h2>

<h3>Description</h3>

<p>Semidefinite programming for optimizing the inner product between combined network and the
solution matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ADMM(
  Adj,
  Covariate,
  lambda,
  K,
  alpha,
  rho,
  TT,
  tol,
  quiet = NULL,
  report_interval = NULL,
  r = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Adj</code></td>
<td>
<p>A 0/1 adjacency matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Covariate</code></td>
<td>
<p>A covariate matrix. The rows correspond to nodes and the columns correspond to covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>A tuning parameter to weigh the covariate matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>A positive integer, indicating the number of underlying communities in graph <code>Adj</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>A number. The elementwise upper bound in the SDP.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>The learning rate of ADMM.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TT</code></td>
<td>
<p>The maximum of iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>The tolerance for stopping criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>
<p>An optional inoput. Whether to print result at each step.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>report_interval</code></td>
<td>
<p>An optional inoput. The frequency to print intermediate result.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>An optional inoput. The expected rank of the solution, leave NULL if no constraint is required.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><em>ADMM</em> is proposed in <em>Covariate Regularized Community Detection in Sparse Graphs</em>
of Yan &amp; Sarkar (2021). <em>ADMM</em> relies on semidefinite programming (SDP) relaxations for detecting
the community structure in sparse networks with covariates.
</p>


<h3>Value</h3>

<table><tr style="vertical-align: top;">
<td><code>estall</code></td>
<td>
<p>A lavel vector.</p>
</td>
</tr></table>
<h3>References</h3>

<p>Yan, B., &amp; Sarkar, P. (2021). <em>Covariate Regularized Community Detection in Sparse Graphs</em>.
<em>Journal of the American Statistical Association, 116(534), 734-745</em>.
<br><a href="https://doi.org/10.1080/01621459.2019.1706541">doi:10.1080/01621459.2019.1706541</a><br></p>


<h3>Examples</h3>

<pre><code class="language-R">
# Simulate the Network
n = 10; K = 2;
theta = 0.4 + (0.45-0.05)*(seq(1:n)/n)^2; Theta = diag(theta);
P  = matrix(c(0.8, 0.2, 0.2, 0.8), byrow = TRUE, nrow = K)
set.seed(2022)
l = sample(1:K, n, replace=TRUE); # node labels
Pi = matrix(0, n, K) # label matrix
for (k in 1:K){
  Pi[l == k, k] = 1
}
Omega = Theta %*% Pi %*% P %*% t(Pi) %*% Theta;
Adj = matrix(runif(n*n, 0, 1), nrow = n);
Adj = Omega - Adj;
Adj = 1*(Adj &gt;= 0)
diag(Adj) = 0
Adj[lower.tri(Adj)] = t(Adj)[lower.tri(Adj)]
caseno = 4; Nrange = 10; Nmin = 10; prob1 = 0.9; p = n*4;
Q = matrix(runif(p*K, 0, 1), nrow = p, ncol = K)
Q = sweep(Q,2,colSums(Q),`/`)
W = matrix(0, nrow = n, ncol = K);
for(jj in 1:n) {
  if(runif(1) &lt;= prob1) {W[jj, 1:K] = Pi[jj, ];}
  else W[jj, sample(K, 1)] = 1;
}
W = t(W)
D0 = Q %*% W
X = matrix(0, n, p)
N = switch(caseno, rep(100, n), rep(100, n), round(runif(n)*Nrange+ Nmin),
  round(runif(n)* Nrange+Nmin))
for (i in 1: ncol(D0)){
  X[i, ] = rmultinom(1, N[i], D0[, i])
}
ADMM(Adj, X, lambda = 0.2, K = K, alpha = 0.5, rho = 2, TT = 100, tol = 5)
</code></pre>


</div>