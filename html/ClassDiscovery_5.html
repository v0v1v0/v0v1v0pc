<div class="container">

<table style="width: 100%;"><tr>
<td>ClusterTest-class</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Class "ClusterTest"</h2>

<h3>Description</h3>

<p>This is a base class for tests that attempt to determine whether the groups
found by an unsupervised clustering method are statistically significant.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'ClusterTest'
image(x, dendrogram, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of the <code>ClusterTest</code> class.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dendrogram</code></td>
<td>
<p>An object with S3 class <code>hclust</code>, as returned
by the <code>hclust</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional graphical parameters to be passed to the
standard <code>heatmap</code> function that is used to implement the
<code>image</code> method.</p>
</td>
</tr>
</table>
<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("ClusterTest", ...)</code>. 
Most users, however, will only create objects from one of the derived
classes such as <code>BootstrapClusterTest</code> or
<code>PerturbationClusterTest</code>. 
</p>


<h3>Slots</h3>


<dl>
<dt>
<code>call</code>:</dt>
<dd>
<p>An object of class <code>call</code>, which shows
how the object was constructed.</p>
</dd>
<dt>
<code>result</code>:</dt>
<dd>
<p>A symmetric <code>matrix</code> containing the
results of the cluster reproducibility test.  The size of the
matrix corresponds to the number of samples (columns) in the data
set on which the test was performed.  The <code>result</code> matrix
should contain "agreement" values between 0 and 1, representing for
each pair of samples the fraction of times that they were
collected into the same cluster.</p>
</dd> 
</dl>
<h3>Methods</h3>


<dl>
<dt>hist</dt>
<dd>
<p><code>signature(x = "ClusterTest")</code>: Produces a
histogram of the agreement fractions.  When a true group structure
exists, one expects a multimodal distribution,with one group of
agreements near 0 (for pairs belonging to different clusters) and
one group of agreements near 1 (for pairs belonging to the same
cluster).</p>
</dd> 
<dt>image</dt>
<dd>
<p><code>signature(x = "ClusterTest")</code>: Uses the
<code>heatmap</code> function to display the agreement matrix. The
optional <code>dendrogram</code> argument should be used to display the
extent to which the agreement matrix matches the results of
hierarchical clustering using the full data set.  This method
invisibly returns the result of a call to <code>heatmap</code>; thus, you
can use <code>keep.dendro=TRUE</code> to recover the cluster assignments
from the dendrograms.</p>
</dd>
<dt>summary</dt>
<dd>
<p><code>signature(object = "ClusterTest")</code>: Write out a
summary of the object.</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Kevin R. Coombes <a href="mailto:krc@silicovore.com">krc@silicovore.com</a>
</p>


<h3>References</h3>

<p>Kerr MK, Churchill GJ.<br><em>Bootstrapping cluster analysis: Assessing the reliability of
conclusions from microarray experiments.</em><br>
PNAS 2001; 98:8961-8965.
</p>


<h3>See Also</h3>

<p><code>BootstrapClusterTest</code>,
<code>PerturbationClusterTest</code>,
<code>heatmap</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">showClass("ClusterTest")

## simulate data from two different classes
d1 &lt;- matrix(rnorm(100*30, rnorm(100, 0.5)), nrow=100, ncol=30, byrow=FALSE)
d2 &lt;- matrix(rnorm(100*20, rnorm(100, 0.5)), nrow=100, ncol=20, byrow=FALSE)
dd &lt;- cbind(d1, d2)

## cluster the data
hc &lt;- hclust(distanceMatrix(dd, 'pearson'), method='average')

## make a fake reproducibility matrix
fraud &lt;- function(x) {
  new('ClusterTest', result=abs(cor(x)), call=match.call())
}

fake &lt;- fraud(dd)
summary(fake)

hist(fake)

image(fake) # let heatmap compute a new dendrogram from the agreements

image(fake, dendrogram=hc) # use the actual dendrogram from the data

image(fake, dendrogram=hc, col=blueyellow(64)) # change the colors

## cleanup
rm(fake, fraud, hc, dd, d1, d2)
</code></pre>


</div>