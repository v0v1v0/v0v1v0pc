<div class="container">

<table style="width: 100%;"><tr>
<td>ReadImmuneMap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Read tracks from ImmuneMap</h2>

<h3>Description</h3>

<p>Reads tracks from <a href="https://immunemap.org">https://immunemap.org</a> for import into celltrackR. 
This produces both tracks object(s) and a dataframe with metadata.
</p>


<h3>Usage</h3>

<pre><code class="language-R">read.immap.json(
  url,
  tracks.url = NULL,
  keep.id = TRUE,
  scale.auto = TRUE,
  scale.t = NULL,
  scale.pos = NULL,
  warn.scaling = TRUE,
  simplify.2D = TRUE,
  warn.celltypes = TRUE,
  split.celltypes = FALSE,
  ...
)

parse.immap.json(url)

get.immap.tracks(
  input,
  keep.id = TRUE,
  scale.t = NULL,
  scale.pos = NULL,
  warn.scaling = TRUE,
  simplify.2D = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>url</code></td>
<td>
<p>of the json file to download from immunemap; this should be the url to the
video metadata without the "/tracks" suffix. With this method, the metadata will
be used to automatically scale time to seconds and coordinates to microns if
<code>scale.auto=TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tracks.url</code></td>
<td>
<p>optional: alternatively, provide directly the url of the tracks (ending with "/tracks"),
or an url of a local json file with tracks. With this method, scales must be set
manually. If not specified, it is assumed that adding the suffix "/tracks" to the
supplied <code>url</code> will provide the track data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep.id</code></td>
<td>
<p>logical: keep track ids from immunemap? If false, new unique ids are
generated. Defaults to <code>TRUE</code>. If there are no ids in the input json, a warning
will be returned; this can be suppressed by setting keep.id = <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.auto</code></td>
<td>
<p>logical: if <code>TRUE</code> (the default), scales will be set automatically using
the metadata found in <code>url</code>. This works only if the <code>url</code> is given, not
if only <code>tracks.url</code> is supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.t</code></td>
<td>
<p>optional: multiply timepoints with constant factor to rescale time.
By default, immunemap returns time in # frames.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.pos</code></td>
<td>
<p>optional: multiply coordinates with constant factor to rescale lengths.
By default, immunemap measures coordinates in pixels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warn.scaling</code></td>
<td>
<p>logical: if <code>scale.t</code> and <code>scale.pos</code> are not set,
warn the user that units are pixels and #frames instead of microns and min/sec. 
Defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simplify.2D</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), automatically project to 2D when the
z-coordinate has only one value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warn.celltypes</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), warn when the user is either 
trying to return a single tracks object while the metadata indicates there are 
multiple celltypes in the data, or when the user is trying to set <code>split.celltypes = TRUE</code> 
when there is only one celltype present.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>split.celltypes</code></td>
<td>
<p>logical: if <code>TRUE</code> (default = <code>FALSE</code>), return not one
tracks object but a list of tracks objects for each celltype in the data (as 
determined from the metadata in the immunemap json).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters to be passed to <code>get.immap.metadata</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>input</code></td>
<td>
<p>the output of <code>parse.immap.json</code> serves as input for <code>get.immap.tracks</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>read.immap.json</code> internally uses <code>parse.immap.json</code> to parse the json file,
<code>get.immap.tracks</code> to extract the tracks, and  <code>get.immap.metadata</code>
to read the metadata.
</p>


<h3>Value</h3>

<p><code>read.immap.json</code>  returns a list with:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>tracks</code></td>
<td>
<p>either a single tracks object or a named list of tracks objects per cell type (if <code>split.celltypes = TRUE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metadata</code></td>
<td>
<p>a dataframe with metadata for all the track.ids; this is read from the immunemap json file.</p>
</td>
</tr>
</table>
<p><code>parse.immap.json</code> simply returns the R list generated from the input json file.
</p>
<p><code>get.immap.tracks</code> returns a single tracks object.
</p>


<h3>Note</h3>

<p>This functionality requires the jsonlite package to be installed.
</p>


<h3>See Also</h3>

<p><code>get.immap.metadata</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## Read tracks from immunemap online, using the video info for automatic scaling
tr &lt;- read.immap.json( url = "https://api.immunemap.org/video/14" )

## Read tracks and rescale time (.5min/frame) and coordinates (2microns/pixel)
tracksUrl &lt;- "https://api.immunemap.org/video/14/tracks"
tr &lt;- read.immap.json( tracks.url = tracksUrl, scale.auto = FALSE, scale.t = .5, scale.pos = 2 )

## End(Not run)

## Read tracks from a file 
# tr &lt;- read.immap.json( tracks.url = "my-file.json", warn.scaling = FALSE )

</code></pre>


</div>