<div class="container">

<table style="width: 100%;"><tr>
<td>cusp3d.surface</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Generate 3D plot of the Cusp surface </h2>

<h3>Description</h3>

<p>This function generates a 3D display of the cusp equilibrium surface.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cusp3d.surface(alpha = c(-5, 5), beta = c(-3, 3), y = 41, 
xlim = range(alpha), ylim = range(beta), zlim = c(-5, 4), 
xlab = expression(alpha), ylab = expression(beta), zlab = "equilibrium states", 
main = NULL, sub = NULL, phi = 20, theta = 160, 
r = sqrt(3), d = 1, scale = TRUE, expand = 1, hue = 240, 
chroma = 35, surf.alpha = 0.75, gamma = 1.5, bcol = NA, 
lcol = "gray", ltheta = 90, lphi = 70, box = TRUE, 
axes = FALSE, nticks = 5, ticktype = "simple", floor.lines = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p> numeric 2-vector specifying the normal/symmetry factor axis range </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p> numeric 2-vector specifying the bifurcation/splitting factor axis range </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p> numeric specifying the iso contours used to render the surface (see details below) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim,ylim,zlim</code></td>
<td>
<p> numeric 2-vectors (see <code>persp</code>) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab,ylab,zlab,main,sub</code></td>
<td>
<p> strings (see <code>persp</code>) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi,theta</code></td>
<td>
<p> numeric, determine viewing direction (see <code>persp</code>) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p> numeric, distance to center of the plotting box (see <code>persp</code>) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p> numeric, strength of perspective transformation (see <code>persp</code>) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale,expand</code></td>
<td>
<p> logical, see <code>persp</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hue,chroma,surf.alpha</code></td>
<td>
<p> hue, chroma and alpha (transparency) of the surface segments (see <code>hcl</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p> gamma for shading of surface (see <code>cusp3d</code>) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bcol</code></td>
<td>
<p> color, <code>NA</code>, or string <code>"surface"</code>. Color of the border of each surface element; <code>NA</code> gives transparent borders; <code>"surface"</code> tries to hide the border as much as possible by giving it the same color as the surface segment. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lcol</code></td>
<td>
<p> color of the lines on the floor of the plotting cube </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ltheta,lphi</code></td>
<td>
<p> numeric, direction of illumination of the surface (similar to <code>persp</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>box,axes,nticks,ticktype</code></td>
<td>
<p> (see <code>persp</code>) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>floor.lines</code></td>
<td>
<p> logical, if <code>TRUE</code> (default) iso-contours are projected on the floor of the plotting cube (revealing the bifurcation set) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> extra arguments that are passed to <code>lines</code> and <code>polygon</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>y</code> has length 1, it is interpreted as the number of contours. Otherwise it is interpreted as a vector of contour levels from which the surface must be determined. If <code>y</code> is a number, the exact range of <code>y</code> is determined by the ranges of <code>alpha</code> and <code>beta</code> through the cusp equilibrium equation below.
</p>
<p>The surface is constructed from the iso-contours of the cusp equilibrium surface that makes up the solutions to </p>
<p style="text-align: center;"><code class="reqn">\alpha + \beta*y - y^3 = 0</code>
</p>

<p>as a (multi-)function of the asymmetry variable <code class="reqn">\alpha</code> and bifurcation variable <code class="reqn">\beta</code>. For each possible solution <code class="reqn">y</code> the iso-contours are given by the equation </p>
<p style="text-align: center;"><code class="reqn">\alpha = (\beta*y - y^3)/y,</code>
</p>
<p> which are linear in <code class="reqn">\beta</code>. For each value of <code class="reqn">y</code> the values of <code class="reqn">alpha</code> are determined for the end points of the <code class="reqn">beta</code> range specified by <code>beta</code>. The two 3D coordinates (<code class="reqn">\alpha</code>, <code class="reqn">\beta</code>, <code class="reqn">y</code>) are projected onto the 2D canvas using the <code>persp</code> transformation matrix and used for drawing the lines and polygons.
</p>


<h3>Value</h3>

<p><code>cusp3d.surface</code> returns the viewing transformation matrix, say <code>VT</code>, a 4 x 4 matrix suitable for projecting 3D coordinates (x,y,z) into the 2D plane using homogeneous 4D coordinates (x,y,z,t). It can be used to superimpose additional graphical elements on the 3D plot, by lines() or points(), using the simple function trans3d().
</p>


<h3>Note</h3>

<p>   This function is an alternative to <code>cusp3d</code> which uses a different method of rendering and also plots fitted points on the surface.
</p>


<h3>Author(s)</h3>

<p> Raoul Grasman </p>


<h3>References</h3>

<p> See <code>cusp-package</code>, <code>cusp3d</code> </p>


<h3>See Also</h3>

 <p><code>persp</code>, <code>plot.cusp</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
p = cusp3d.surface(chroma=40,lcol=1,surf.alpha=.95,phi=30,theta=150,
	bcol="surface",axes=TRUE,main="Cusp Equilibrium Surface")
lines(trans3d(c(5,5), c(3,3), c(-5,4), p), lty=3) # replot some of the box outlines 
lines(trans3d(c(-5,5), c(3,3), c(4,4), p), lty=3)

## End(Not run)
</code></pre>


</div>