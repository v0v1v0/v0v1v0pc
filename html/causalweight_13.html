<div class="container">

<table style="width: 100%;"><tr>
<td>ivnr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Instrument-based treatment evaluation under endogeneity and non-response bias</h2>

<h3>Description</h3>

<p>Non- and semiparaemtric treatment effect estimation under treatment endogeneity and selective non-response in the outcome based on a binary instrument for the treatment and a continous instrument for response.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ivnr(
  y,
  d,
  r,
  z1,
  z2,
  x = NULL,
  xpar = NULL,
  ruleofthumb = 1,
  wgtfct = 2,
  rtype = "ll",
  numresprob = 20,
  boot = 499,
  estlate = TRUE,
  trim = 0.01
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Dependent variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>Treatment, must be binary and must not contain missings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>Response, must be a binary indicator for whether the outcome is observed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z1</code></td>
<td>
<p>Binary instrument for the treatment, must not contain missings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z2</code></td>
<td>
<p>Continuous instrument for response, must not contain missings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A data frame of covariates to be included in the nonparametric estimation, must not contain missings. Factors and ordered varaibles must be appropriately defined as such by <code>factor()</code> and <code>ordered()</code>. Default is <code>NULL</code> (no covariates included). Covariates are only considered if both <code>x</code> and <code>xpar</code> are not <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xpar</code></td>
<td>
<p>Covariates  to be included in the semiparametric estimation, must not contain missings. Default is <code>NULL</code> (no covariates included). Covariates are only considered if both <code>x</code> and <code>xpar</code> are not <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ruleofthumb</code></td>
<td>
<p>If 1, bandwidth selection in any kernel function is based on the Silverman (1986) rule of thumb. Otherwise, least squares cross-validation is used. Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wgtfct</code></td>
<td>
<p>Weighting function to be used in effect estimation. If set to 1, equation (18) in Fricke et al (2020) is used as weight. If set to 2, equation (19) in Fricke et al (2020) is used as weight. If set to 3, the median of LATEs across values of response probabilities <code>numresprob</code> is used. Default is 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rtype</code></td>
<td>
<p>Regression type used for continuous outcomes in the kernel regressions. Either <code>"ll"</code> for local linear or <code>"lc"</code> for local constant regression. Default is <code>"ll"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numresprob</code></td>
<td>
<p>number of response probabilities at which the effects are evaluated. An equidistant grid is constructed based on the number provided. Default is 20.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot</code></td>
<td>
<p>Number of bootstrap replications for estimating standard errors of the effects. Default is 499.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estlate</code></td>
<td>
<p>If set to <code>TRUE</code> the local average treatment effect on compliers (LATE) is estimated, otherwise the average treatment effect (ATE) is estimated. Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trim</code></td>
<td>
<p>Trimming rule for too extreme denominators in the weighting functions or inverses of products of conditional treatment probabilities. Values below <code>trim</code> are set to <code>trim</code> to avoid values that are too close to zero in any denominator. Default is 0.01.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Non- and semiparametric treatment effect estimation under treatment endogeneity and selective non-response in the outcome based on a binary instrument for the treatment and a continuous instrument for response. The effects are estimated both semi-parametrically (using probit and OLS for the estimation of plug-in parameters like conditional probabilities and outcomes) and fully non-parametrically (based on kernel regression for any conditional probability/mean). Besides the instrument-based estimates, results are also presented under a missing-at-random assumption (MAR) when not using the instrument <code>z2</code> for response (but only <code>z1</code> for the treatment). See Fricke et al. (2020) for further details.
</p>


<h3>Value</h3>

<p>A <code>ivnr</code> object contains one output component:
</p>
<p><code>output</code>: The first row provides the effect estimates under non- and semi-parametric estimation using both instruments, see <code>"nonpara (L)ATE IV"</code> and <code>"semipara (L)ATE IV"</code> as well as under a missing-at-random assumption for response when using only the first instrument for the treatment, see <code>"nonpara (L)ATE MAR"</code> and <code>"semipara (L)ATE MAR"</code>. The second row provides the standard errors based on bootstrapping the effects. The third row provides the p-values based on the t-statistics.
</p>


<h3>References</h3>

<p>Fricke, H., Fr√∂lich, M., Huber, M., Lechner, M. (2020): "Endogeneity and non-response bias in treatment evaluation - nonparametric identification of causal effects by instruments", Journal of Applied Econometrics, forthcoming.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># A little example with simulated data (1000 observations)
## Not run: 
n=1000          # sample size
e&lt;-(rmvnorm(n,rep(0,3), matrix(c(1,0.5,0.5,  0.5,1,0.5,  0.5,0.5,1),3,3)))
# correlated error term of treatment, response, and outcome equation
x=runif(n,-0.5,0.5)           # observed confounder
z1&lt;-(-0.25*x+rnorm(n)&gt;0)*1    # binary instrument for treatment
z2&lt;- -0.25*x+rnorm(n)         # continuous instrument for selection
d&lt;-(z1-0.25*x+e[,1]&gt;0)*1      # treatment equation
 y_star&lt;- -0.25*x+d+e[,2]     # latent outcome
 r&lt;-(-0.25*x+z2+d+e[,3]&gt;0)*1  # response equation
 y=y_star                     # observed outcome
 y[r==0]=0                    # nonobserved outcomes are set to zero
 # The true treatment effect is 1
 ivnr(y=y,d=d,r=r,z1=z1,z2=z2,x=x,xpar=x,numresprob=4,boot=39)
## End(Not run)
</code></pre>


</div>