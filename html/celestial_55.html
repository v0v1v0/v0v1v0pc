<div class="container">

<table style="width: 100%;"><tr>
<td>coshalo</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Virial halo conversion functions
</h2>

<h3>Description</h3>

<p>All 6 Virial parameter conversion functions. Each can map precisely to the other as a one paramter function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">coshaloMvirToSigma(Mvir=1e+12, z=0, H0=100, OmegaM=0.3, OmegaL=1-OmegaM-OmegaR,
OmegaR=0, Rho='crit', Dist='Co', DeltaVir=200, Munit=1, Lunit=1e6, Vunit=1e3, Dim=3, ref)
coshaloSigmaToMvir(Sigma=230, z=0, H0=100, OmegaM=0.3, OmegaL=1-OmegaM-OmegaR,
OmegaR=0, Rho='crit', Dist='Co', DeltaVir=200, Munit=1, Lunit=1e6, Vunit=1e3, Dim=3, ref)
coshaloMvirToRvir(Mvir=1e12, z=0, H0=100, OmegaM=0.3, OmegaL=1-OmegaM-OmegaR,
OmegaR=0, Rho='crit', Dist='Co', DeltaVir=200, Munit=1, Lunit=1e6, Vunit=1e3, Dim=3, ref)
coshaloRvirToMvir(Rvir=162.635, z=0, H0=100, OmegaM=0.3, OmegaL=1-OmegaM-OmegaR,
OmegaR=0, Rho='crit', Dist='Co', DeltaVir=200, Munit=1, Lunit=1e6, Vunit=1e3, Dim=3, ref)
coshaloSigmaToRvir(Sigma=230, z=0, H0=100, OmegaM=0.3, OmegaL=1-OmegaM-OmegaR,
OmegaR=0, Rho='crit', Dist='Co', DeltaVir=200, Munit=1, Lunit=1e6, Vunit=1e3, Dim=3, ref)
coshaloRvirToSigma(Rvir=162.635, z=0, H0=100, OmegaM=0.3, OmegaL=1-OmegaM-OmegaR,
OmegaR=0, Rho='crit', Dist='Co', DeltaVir=200, Munit=1, Lunit=1e6, Vunit=1e3, Dim=3, ref)
coshaloSigmaToTvir(Sigma=230, Vunit=1e3, Tunit='K', Type='halo', Dim=3) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Mvir</code></td>
<td>

<p>Mass within virial radius in units of 'Munit'.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>

<p>Velocity dispersion (3D) within virial radius in units of 'Vunit'. For coshaloSigmaToTvir the Sigma input should be the virial Sigma which can be found by setting DeltaVir='get' in the the other coshalo functions.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rvir</code></td>
<td>

<p>Virial radius (3D) in units of 'Lunit'.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>

<p>Cosmological redshift, where z must be &gt; -1 (can be a vector).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H0</code></td>
<td>

<p>Hubble constant as defined at z=0 (default is H0=100 (km/s)/Mpc).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>OmegaM</code></td>
<td>

<p>Omega Matter (default is 0.3).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>OmegaL</code></td>
<td>

<p>Omega Lambda (default is for a flat Universe with OmegaL = 1-OmegaM = 0.7).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>OmegaR</code></td>
<td>

<p>Omega Radiation (default is 0, but OmegaM/3400 is typical).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rho</code></td>
<td>

<p>Set whether the critical energy density is used (crit) or the mean mass density (mean).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Dist</code></td>
<td>

<p>Determines the distance type, i.e. whether the Rho critical energy or mean mass densities are calculated with respect to angular / physical distances (Ang) or with respect to comoving distances (Co). In effect this means Rvir values are either angular / physical (Ang) or comoving (Co). It does not affect Mvir &lt;-&gt; Sigma conversions, but does affect Mvir &lt;-&gt; Rvir and Rvir &lt;-&gt; Sigma. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DeltaVir</code></td>
<td>

<p>Desired overdensity of the halo with respect to Rho. If set to 'get' it will estimate the required DeltaVir for a virial collapse using the <code>cosgrowDeltaVir</code> function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Munit</code></td>
<td>

<p>Base mass unit in multiples of Msun.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lunit</code></td>
<td>

<p>Base length unit in multiples of parsecs.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Vunit</code></td>
<td>

<p>Base velocity unit in multiples of m/s.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Type</code></td>
<td>

<p>Specify the 'halo' or 'gas' temperature to be computed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tunit</code></td>
<td>

<p>Specify the output temperature to be Kelvin ('K'), 'eV' or 'keV'.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Dim</code></td>
<td>

<p>The dimensional type for the halo (either the 2 or 3). 3 (default) means quantities are intrinsic 3D values. 2 means quantities are for projected systems (i.e. radius and velocity dispersion are compressed). From comparisons to simulations (so NFW, c~5 halos) Rvir[proj]=Rvir[3D]/1.37 and Sigma[proj]=Sigma[3D]/sqrt(3). The former has dependence on the halo profile (so is approximate), whereas the latter is a dimensionality argument that should hold for any virialised system. Note that for projected systems Sigma is measured along one dimension: the line-of-site.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ref</code></td>
<td>

<p>The name of a reference cosmology to use, one of 137 / 737 / Planck / Planck13 / Planck15 / Planck18 / WMAP / WMAP9 / WMAP7 / WMAP5 / WMAP3 / WMAP1 / Millennium / GiggleZ. Planck = Planck18 and WMAP = WMAP9. The usage is case insensitive, so wmap9 is an allowed input. See <code>cosref</code> for details. This overrides any other settings for H0/ OmegaM and OmegaL.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>These functions allow for various analytic conversions between the 3 major properties related to virial radius: the mass, velocity dispresion and size. The default properties calculate properties for 1e12 Msun halos and assume masses in Msun, velocities in km/s and distances in Kpc.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>coshaloMvirToSigma</code></td>
<td>
<p>Outputs approximate velocity dispersion (in units of Vunit) given mass (this is exactly the escape velocity at Rvir).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coshaloSigmaToMvir</code></td>
<td>
<p>Outputs mass (in units of Munit) given velocity dispersion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coshaloMvirToRvir</code></td>
<td>
<p>Outputs radius (in units of Lunit) given mass.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coshaloRvirToMvir</code></td>
<td>
<p>Outputs mass (in units of Munit) given radius.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coshaloSigmaToRvir</code></td>
<td>
<p>Outputs radius (in units of Lunit) given velocity dispersion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coshaloRvirToSigma</code></td>
<td>
<p>Outputs approximate velocity dispersion (in units of Vunit) given radius (this is exactly the escape velocity at Rvir).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coshaloSigmaToTvir</code></td>
<td>
<p>Output temperture (in units of Tunit) given velocity dispersion. Based on Eqns. 3/7/8/9 of Bryan &amp; Norman (1998).</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Aaron Robotham, Chris Power
</p>


<h3>References</h3>

<p>coshaloSigmaToTvir based on the equations in:
</p>
<p>Bryan &amp; Norman, 1998, ApJ, 495, 80
</p>


<h3>See Also</h3>

<p><code>cosvol</code>, <code>cosmap</code>,  <code>cosdist</code>, <code>cosgrow</code>, <code>cosNFW</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">coshaloMvirToSigma(1e13) # Velocity in km/s
coshaloMvirToSigma(1e13, Vunit=1) # Velocity in m/s
coshaloSigmaToMvir(coshaloMvirToSigma(1e13, Vunit=1),Vunit=1)
coshaloMvirToRvir(1e13) #Radius in kpc
coshaloSigmaToRvir(coshaloMvirToSigma(1e13, Vunit=1),Vunit=1)

#Some sanity checks

rho_crit200=cosgrowRhoCrit(z=0)*200 #200 times rho critical at z=0
rho_mean200=cosgrowRhoMean(z=0)*200 #200 times rho mean at z=0
#For a 10^12 Msun/h halo, the radius in Mpc/h where the contained density equals rho_crit*200
rad_crit200=(1e12/rho_crit200*3/4/pi)^(1/3)
coshaloMvirToRvir(1e12,Lunit=1e6)-rad_crit200 # ~0 as expected
#For a 10^12 Msun/h halo, the radius in Mpc/h where the contained density equals rho_crit*200
rad_mean200=(1e12/rho_mean200*3/4/pi)^(1/3) # ~0 as expected
coshaloMvirToRvir(1e12,Lunit=1e6,Rho='mean')-rad_mean200
</code></pre>


</div>