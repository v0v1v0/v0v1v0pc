<div class="container">

<table style="width: 100%;"><tr>
<td>wincrqa</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Windowed Recurrence Measures</h2>

<h3>Description</h3>

<p>A recurrence plot is computed in overlapping
windows of a certain size for a number of delays smaller
than the size of the window; and measures of it extracted.
</p>


<h3>Usage</h3>

<pre><code class="language-R">
wincrqa(ts1, ts2, windowstep, windowsize, delay, embed, 
radius, rescale, normalize, mindiagline, minvertline, tw, whiteline, 
recpt, side, method, metric, datatype, trend)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ts1</code></td>
<td>
<p>First time-series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ts2</code></td>
<td>
<p>Second time-series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>windowstep</code></td>
<td>
<p>Interval by which the window is moved.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>windowsize</code></td>
<td>
<p>The size of the window</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delay</code></td>
<td>
<p>The delay unit by which the series are lagged.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>embed</code></td>
<td>
<p>The number of embedding dimension for
phase-reconstruction, i.e., the lag intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>radius</code></td>
<td>
<p>A threshold, cut-off, constant used to
decide whether two points are recurrent or not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rescale</code></td>
<td>
<p>Rescale the distance matrix;
if rescale = 0 (do nothing);
if rescale = 1 (mean distance of entire matrix);
if rescale = 2 (maximum distance of entire matrix).
if rescale = 3 (minimum distance of entire matrix).
if rescale = 4 (euclidean distance of entire matrix).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalize</code></td>
<td>
<p>Normalize the time-series;
if normalize = 0 (do nothing);
if normalize = 1 (Unit interval);
if normalize =  2 (z-score).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mindiagline</code></td>
<td>
<p>A minimum diagonal length of
recurrent points. Usually set to 2, as it takes
a minimum of two points to define any line.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minvertline</code></td>
<td>
<p>A minimum vertical length of
recurrent points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tw</code></td>
<td>
<p>The Theiler window parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>whiteline</code></td>
<td>
<p>A logical flag to calculate (TRUE)
or not (FALSE) empty vertical lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>recpt</code></td>
<td>
<p>A logical flag indicating whether
measures of cross-recurrence are calculated directly
from a recurrent plot (TRUE) or not (FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>side</code></td>
<td>
<p>A string indicating whether recurrence measures
should be calculated in the 'upper' triangle of the RP
'lower' triangle of the matrix, or 'both'.
LOC is automatically excluded for 'upper' and 'lower'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A string to indicate the type of recurrence
analysis to peform. There are three options:
rqa (autorecurrence); crqa(cross-recurrence); 
mdcrqa(multidimensional recurrence). Default value is crqa</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metric</code></td>
<td>
<p>A string to indicate the type of 
distance metric used, default is euclidean but 
see help rdist() to list all other possible metrics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>datatype</code></td>
<td>
<p>a string (continuous or categorical) 
to indicate whether the nature of the data type</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trend</code></td>
<td>
<p>a boolean (TRUE or FALSE) 
to indicate whether the TREND should be computed of the
system</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>It returns a matrix where the rows are the
different windows explored, and the columns
are the recurrence measures observed
in that particular window.
Refer to <code>crqa</code> for the values returned.
</p>


<h3>Note</h3>

<p>If no-recurrence is found in a window,
that window will not be saved, and a message
about it will be warned.
TREND is implemented following a solution proposed
by Norbert Marwan, and translated here in R,
for those who have asked him.
He, however, warns that this measure might strongly depend
on the chosen settings to calculate crq.
Relying blindly on such measure can, therefore, produce misleading results.
Also, we enabled the possibility to input directly a RP with recpt = T, 
and so extract the measures. This implies that it will not be the same 
as by conducting phase-space reconstruction on subsets of the time series.  
So, please, make sure why you are doing it and why.
</p>


<h3>Author(s)</h3>

<p>Moreno I. Coco (moreno.cocoi@gmail.com)
Alexandra Paxton <a href="mailto:alexandra.paxton@uconn.edu">alexandra.paxton@uconn.edu</a></p>


<h3>See Also</h3>

<p><code>crqa</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
data(crqa) 

listener = eyemovement$listener[1:200]
narrator = eyemovement$narrator[1:200]

# NB, the parameters for windowsize and windowstep are large to allow
# faster running time, please set them carefully in your analysis. 

delay = 1; embed = 1; rescale = 0; radius = 0.001;
normalize = 0; mindiagline = 2; minvertline = 2;
tw = 0; whiteline = FALSE; recpt = FALSE; side = "both"
method = 'crqa'; metric = 'euclidean';  
datatype = "continuous"; 
windowsize =  100; windowstep = 50
trend = FALSE

ans = wincrqa(listener, narrator, windowstep, windowsize, delay, embed,
                    radius, rescale, normalize, mindiagline, minvertline,
                    tw, whiteline, recpt, side, method, metric, 
                    datatype, trend)

## other recurrence measures are available in ans
profile = as.numeric(ans$RR) 

plot(profile, type = 'l')

</code></pre>


</div>