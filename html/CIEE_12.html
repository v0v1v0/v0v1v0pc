<div class="container">

<table style="width: 100%;"><tr>
<td>sandwich_se</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sandwich standard error estimates</h2>

<h3>Description</h3>

<p>Function to obtain consistent and robust sandwich standard error estimates
based on estimating equations, for the parameter estimates of the
<code>get_estimates</code> function, under the GLM or AFT setting
for the analysis of a normally-distributed or censored time-to-event primary
outcome.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sandwich_se(setting = "GLM", scores = NULL, hessian = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>setting</code></td>
<td>
<p>String with value <code>"GLM"</code> or <code>"AFT"</code> indicating
whether standard error estimates are obtained for a
normally-distributed (<code>"GLM"</code>) or censored time-to-event
(<code>"AFT"</code>) primary outcome <code>Y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scores</code></td>
<td>
<p>Score matrix of the parameters, which can be obtained using the
<code>scores</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hessian</code></td>
<td>
<p>Hessian matrix of the parameters, which can be obtained using the
<code>hessian</code> function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Under the GLM setting for the analysis of a normally-distributed primary
outcome Y, robust sandwich standard error estimates are obtained for the
estimates of the parameters
<code class="reqn">\alpha_0, \alpha_1, \alpha_2, \alpha_3, \sigma_1^2, \alpha_4, \alpha_{XY}, \sigma_2^2</code>
in the model
</p>
<p style="text-align: center;"><code class="reqn">Y = \alpha_0 + \alpha_1 \cdot K + \alpha_2 \cdot X + \alpha_3 \cdot L + \epsilon_1, \epsilon_1 \sim N(0,\sigma_1^2)</code>
</p>

<p style="text-align: center;"><code class="reqn">Y^* = Y - \overline{Y} - \alpha_1 \cdot (K-\overline{K})</code>
</p>

<p style="text-align: center;"><code class="reqn">Y^* = \alpha_0 + \alpha_{XY} \cdot X + \epsilon_2, \epsilon_2 \sim N(0,\sigma_2^2)</code>
</p>

<p>by using the score and hessian matrices of the parameters.
</p>
<p>Under the AFT setting for the analysis of a censored time-to-event primary
outcome, robust sandwich standard error estimates are  similarly obtained of
the parameter estimates of
<code class="reqn">\alpha_0, \alpha_1, \alpha_2, \alpha_3, \sigma_1, \alpha_4, \alpha_{XY}, \sigma_2^2</code>.
For more details and the underlying model, see the vignette.
</p>


<h3>Value</h3>

<p>Returns a vector with the CIEE sandwich standard error estimates
of the parameter estimates.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Generate data including Y, K, L, X under the GLM setting
dat &lt;- generate_data(setting = "GLM")

# Obtain estimating functions expressions
estfunct &lt;- est_funct_expr(setting = "GLM")

# Obtain point estimates of the parameters
estimates &lt;- get_estimates(setting = "GLM", Y = dat$Y, X = dat$X,
                           K = dat$K, L = dat$L)

# Obtain matrices with all first and second derivatives
derivobj &lt;- deriv_obj(setting = "GLM", logL1 = estfunct$logL1,
                      logL2 = estfunct$logL2, Y = dat$Y, X = dat$X,
                      K = dat$K, L = dat$L, estimates = estimates)

# Obtain score and hessian matrices
results_scores &lt;- scores(derivobj)
results_hessian &lt;- hessian(derivobj)

# Obtain sandwich standard error estimates of the parameters
sandwich_se(scores = results_scores, hessian = results_hessian)

</code></pre>


</div>