<div class="container">

<table style="width: 100%;"><tr>
<td>CST_AccumulationExceedingThreshold</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Accumulation of a variable when Exceeding (not exceeding) a Threshold</h2>

<h3>Description</h3>

<p>The accumulation (sum) of a variable in the days (or time steps) that the 
variable is exceeding (or not exceeding) a threshold during a period. The 
threshold provided must be in the same units than the variable units, i.e. to 
use a percentile as a scalar, the function <code>Threshold</code> or 
<code>QThreshold</code> may be needed. Providing mean daily temperature data, the 
following agriculture indices for heat stress can be obtained by using this 
function:
</p>

<ul><li>
<p>'GDD', Summation of daily differences between daily average 
temperatures and 10Â°C between April 1st and October 31st.
</p>
</li></ul>
<h3>Usage</h3>

<pre><code class="language-R">CST_AccumulationExceedingThreshold(
  data,
  threshold,
  op = "&gt;",
  diff = FALSE,
  start = NULL,
  end = NULL,
  time_dim = "time",
  na.rm = FALSE,
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>An 's2dv_cube' object as provided function <code>CST_Start</code> or 
<code>CST_Load</code> in package CSTools.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>If only one threshold is used, it can be an 's2dv_cube' 
object or a multidimensional array with named dimensions. It must be in the 
same units and with the common dimensions of the same length as parameter 
'data'. It can also be a vector with the same length of 'time_dim' from 
'data' or a scalar. If we want to use two thresholds: it can be a vector 
of two scalars, a list of two vectors with the same length of 
'time_dim' from 'data' or a list of two multidimensional arrays with the 
common dimensions of the same length as parameter 'data'. If two thresholds
are used, parameter 'op' must be also a vector of two elements.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>op</code></td>
<td>
<p>An operator '&gt;' (by default), '&lt;', '&gt;=' or '&lt;='. If  two thresholds
are used it has to be a vector of a pair of two logical operators: 
c('&lt;', '&gt;'), c('&lt;', '&gt;='), c('&lt;=', '&gt;'), c('&lt;=', '&gt;='), c('&gt;', '&lt;'), 
c('&gt;', '&lt;='), c('&gt;=', '&lt;'),c('&gt;=', '&lt;=')).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diff</code></td>
<td>
<p>A logical value indicating whether to accumulate the difference 
between data and threshold (TRUE) or not (FALSE by default). It can only be
TRUE if a unique threshold is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>An optional parameter to define the initial date of the period
to select from the data by providing a list of two elements: the initial 
date of the period and the initial month of the period. By default it is 
set to NULL and the indicator is computed using all the data provided in 
<code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>end</code></td>
<td>
<p>An optional parameter to define the final date of the period to 
select from the data by providing a list of two elements: the final day of 
the period and the final month of the period. By default it is set to NULL
and the indicator is computed using all the data provided in <code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time_dim</code></td>
<td>
<p>A character string indicating the name of the dimension to 
compute the indicator. By default, it is set to 'time'. It can only
indicate one time dimension.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>A logical value indicating whether to ignore NA values (TRUE) 
or not (FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>An integer indicating the number of cores to use in parallel
computation.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An 's2dv_cube' object containing the aggregated values in the element
<code>data</code> with dimensions of the input parameter 'data' except the dimension
where the indicator has been computed. The 'Dates' array is updated to 
the dates corresponding to the beginning of the aggregated time period. A new 
element called 'time_bounds' will be added into the 'attrs' element in the 
's2dv_cube' object. It consists of a list containing two elements, the start 
and end dates of the aggregated period with the same dimensions of 'Dates' 
element.
</p>


<h3>Examples</h3>

<pre><code class="language-R">exp &lt;- NULL
exp$data &lt;- array(abs(rnorm(5 * 3 * 214 * 2)*100), 
                 c(memb = 5, sdate = 3, time = 214, lon = 2)) 
class(exp) &lt;- 's2dv_cube'
Dates &lt;- c(seq(as.Date("01-05-2000", format = "%d-%m-%Y"), 
              as.Date("30-11-2000", format = "%d-%m-%Y"), by = 'day'),
          seq(as.Date("01-05-2001", format = "%d-%m-%Y"), 
              as.Date("30-11-2001", format = "%d-%m-%Y"), by = 'day'),
          seq(as.Date("01-05-2002", format = "%d-%m-%Y"), 
              as.Date("30-11-2002", format = "%d-%m-%Y"), by = 'day'))
dim(Dates) &lt;- c(sdate = 3, time = 214)
exp$attrs$Dates &lt;- Dates
AT &lt;- CST_AccumulationExceedingThreshold(data = exp, threshold = 100,
                                        start = list(21, 4), 
                                        end = list(21, 6))

</code></pre>


</div>