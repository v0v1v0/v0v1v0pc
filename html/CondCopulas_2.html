<div class="container">

<table style="width: 100%;"><tr>
<td>bCond.pobs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Computing the pseudo-observations in case of discrete
conditioning events</h2>

<h3>Description</h3>

<p>Let <code class="reqn">A_1, ..., A_p</code> be <code class="reqn">p</code> events forming a partition of
a probability space and <code class="reqn">X_1, ..., X_d</code> be <code class="reqn">d</code> random variables.
Assume that we observe <code class="reqn">n</code> i.i.d. replications of <code class="reqn">(X_1, ..., X_d)</code>,
and that for each <code class="reqn">i=1, ..., d</code>,
</p>
<p style="text-align: center;"><code class="reqn">V_{i,j|A} = F_{X_j | A_k}(X_{i,j} | A_k),</code>
</p>

<p>we also know which of the <code class="reqn">A_k</code> was realized.
This function computes the pseudo-observations
where <code class="reqn">k</code> is such that the event <code class="reqn">A_k</code>
is realized for the <code class="reqn">i</code>-th observation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bCond.pobs(X, partition)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>matrix of size <code>n * d</code> observations of conditioned variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>partition</code></td>
<td>
<p>matrix of size <code>n * p</code>,
where <code>p</code> is the number of conditioning events that are considered.
partition[i,k] should be the indicator of whether the <code>i</code>-th observation
belongs or not to the <code>k</code>-th conditioning event.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a matrix of size <code>n * d</code>
containing the conditional pseudo-observations <code class="reqn">V_{i,j|A}</code>.
</p>


<h3>References</h3>

<p>Derumigny, A., &amp; Fermanian, J. D. (2017).
About tests of the “simplifying” assumption for conditional copulas.
Dependence Modeling, 5(1), 154-197.
<a href="https://doi.org/10.1515/demo-2017-0011">doi:10.1515/demo-2017-0011</a>
</p>
<p>Derumigny, A., &amp; Fermanian, J. D. (2022)
Conditional empirical copula processes and generalized dependence measures
Electronic Journal of Statistics, 16(2), 5692-5719.
<a href="https://doi.org/10.1214/22-EJS2075">doi:10.1214/22-EJS2075</a>
</p>


<h3>See Also</h3>

<p><code>bCond.estParamCopula</code> for the estimation
of a (conditional) parametric copula model in this framework.
</p>
<p><code>bCond.treeCKT</code> that provides a binary tree
based on conditional Kendall's tau
and that can be used to derive relevant conditioning events.
</p>


<h3>Examples</h3>

<pre><code class="language-R">n = 800
Z = stats::runif(n = n)
CKT = 0.2 * as.numeric(Z &lt;= 0.3) +
  0.5 * as.numeric(Z &gt; 0.3 &amp; Z &lt;= 0.5) +
  - 0.8 * as.numeric(Z &gt; 0.5)
simCopula = VineCopula::BiCopSim(N = n,
  par = VineCopula::BiCopTau2Par(CKT, family = 1), family = 1)
X1 = simCopula[,1]
X2 = simCopula[,2]
partition = cbind(Z &lt;= 0.3, Z &gt; 0.3 &amp; Z &lt;= 0.5, Z &gt; 0.5)
condPseudoObs = bCond.pobs(X = cbind(X1, X2),
                           partition = partition)

</code></pre>


</div>