<div class="container">

<table style="width: 100%;"><tr>
<td>da.cat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Data Augmentation algorithm for incomplete categorical data
</h2>

<h3>Description</h3>

<p>Markov-Chain Monte Carlo method for simulating draws from the
observed-data posterior distribution of underlying cell probabilities
under a saturated multinomial model. May be used in conjunction with
<code>imp.cat</code> to create proper multiple imputations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">da.cat(s, start, prior=0.5, steps=1, showits=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>

<p>summary list of an incomplete categorical dataset created by the
function <code>prelim.cat</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>

<p>starting value of the parameter. This is an array of cell
probabilities of dimension <code>s$d</code>, such as one created by <code>em.cat</code>.
If structural zeros appear in the table, starting values for those
cells should be zero.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>

<p>optional array of hyperparameters specifying a Dirichlet prior
distribution. The default is the Jeffreys prior (all hyperparameters =
supplied with hyperparameters set to <code>NA</code> for those cells.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>steps</code></td>
<td>

<p>number of data augmentation steps to be taken. Each step consists of an
imputation or I-step followed by a posterior or P-step. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showits</code></td>
<td>

<p>if <code>TRUE</code>, reports the iterations so the user can monitor the
progress of the algorithm.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>At each step, the missing data are randomly imputed under their
predictive distribution given the observed data and the current value
of <code>theta</code> (I-step), and then a new value of <code>theta</code> is drawn from its
Dirichlet posterior distribution given the complete data (P-step).
After a suitable number of steps are taken, the resulting value of the
parameter may be regarded as a random draw from its observed-data
posterior distribution.
</p>
<p>When the pattern of observed data is close to a monotone pattern, then
<code>mda.cat</code> is preferred because it will tend to converge more quickly.
</p>


<h3>Value</h3>

<p>an array like <code>start</code> containing simulated cell probabilities.
</p>


<h3>Note</h3>

<p>IMPORTANT: The random number generator seed must be set at least once
by the function <code>rngseed</code> before this function can be used.
</p>


<h3>References</h3>

<p>Schafer (1996) <em>Analysis of Incomplete Multivariate Data,</em>
Chapman &amp; Hall, Chapter 7.
</p>


<h3>See Also</h3>

<p><code>prelim.cat</code>, <code>rngseed</code>, <code>mda.cat</code>, <code>imp.cat</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(crimes)
x      &lt;- crimes[,-3]
counts &lt;- crimes[,3]
s &lt;- prelim.cat(x,counts)        # preliminary manipulations
thetahat &lt;- em.cat(s)            # find ML estimate under saturated model
rngseed(7817)                    # set random number generator seed
theta &lt;- da.cat(s,thetahat,50)   # take 50 steps from MLE
ximp  &lt;- imp.cat(s,theta)        # impute once under theta
theta &lt;- da.cat(s,theta,50)      # take another 50 steps
ximp  &lt;- imp.cat(s,theta)        # impute again under new theta
</code></pre>


</div>