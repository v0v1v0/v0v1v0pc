<div class="container">

<table style="width: 100%;"><tr>
<td>cv.merMod</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cross-Validate Mixed-Effects Model</h2>

<h3>Description</h3>

<p><code>cv()</code> methods for mixed-effect models of class <code>"merMod"</code>, fit
by the <code>lmer()</code> and <code>glmer()</code> functions
in the <span class="pkg">lme4</span> package; for models of class <code>"lme"</code>
fit by the <code>lme()</code> function in the <span class="pkg">nlme</span>
package; and for models of class <code>"glmmTMB"</code> fit by the
<code>glmmTMB()</code> function in the <span class="pkg">glmmTMB</span> package.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'merMod'
cv(
  model,
  data = insight::get_data(model),
  criterion = mse,
  k = NULL,
  reps = 1L,
  seed,
  details = NULL,
  ncores = 1L,
  clusterVariables,
  ...
)

## S3 method for class 'lme'
cv(
  model,
  data = insight::get_data(model),
  criterion = mse,
  k = NULL,
  reps = 1L,
  seed,
  details = NULL,
  ncores = 1L,
  clusterVariables,
  ...
)

## S3 method for class 'glmmTMB'
cv(
  model,
  data = insight::get_data(model),
  criterion = mse,
  k = NULL,
  reps = 1L,
  seed,
  details = NULL,
  ncores = 1L,
  clusterVariables,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a mixed-effects model object for which a <code>cv()</code> method is available.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data frame to which the model was fit (not usually necessary).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>
<p>cross-validation ("cost" or lack-of-fit) criterion function of form <code>f(y, yhat)</code>
where <code>y</code> is the observed values of the response and
<code>yhat</code> the predicted values; the default is <code>mse</code>
(the mean-squared error).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>perform k-fold cross-validation; <code>k</code>
may be a number or <code>"loo"</code> or <code>"n"</code> for n-fold (leave-one-out)
cross-validation; the default is <code>10</code> if cross-validating individual
cases and <code>"loo"</code> if cross-validating clusters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reps</code></td>
<td>
<p>number of times to replicate k-fold CV (default is <code>1</code>),
or greater), compute a confidence interval for the bias-corrected CV
criterion, if the criterion is the average of casewise components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>for R's random number generator; optional, if not
supplied a random seed will be selected and saved; not needed
for n-fold cross-validation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>details</code></td>
<td>
<p>if <code>TRUE</code> (the default if the number of
folds <code>k &lt;= 10</code>), save detailed information about the value of the
CV criterion for the cases in each fold and the regression coefficients
with that fold deleted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>number of cores to use for parallel computations
(default is <code>1</code>, i.e., computations aren't done in parallel).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clusterVariables</code></td>
<td>
<p>a character vector of names of the variables
defining clusters for a mixed model with nested or crossed random effects;
if missing, cross-validation is performed for individual cases rather than
for clusters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>for <code>cv()</code> methods, to match generic,
and for <code>cvMixed()</code>, arguments to be passed to <code>update()</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For mixed-effects models, cross-validation can be done by "clusters" or by
individual observations. If the former, predictions are based only on fixed
effects; if the latter, predictions include the random effects (i.e., are the
best linear unbiased predictors or "BLUPS").
</p>


<h3>Value</h3>

<p>The methods <code>cv.merMod()</code>, <code>cv.lme()</code>, and <code>cv.glmmTMB()</code>,
return objects of class <code>"cv"</code>, or,
if <code>reps &gt; 1</code>, of class <code>"cvList"</code> (see <code>cv()</code>).
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>cv(merMod)</code>: <code>cv()</code> method for <code>lmer()</code> and
<code>glmer()</code> models from the <span class="pkg">lme4</span> package.
</p>
</li>
<li> <p><code>cv(lme)</code>: <code>cv()</code> method for <code>lme()</code>
models from the <span class="pkg">nlme</span> package.
</p>
</li>
<li> <p><code>cv(glmmTMB)</code>: <code>cv()</code> method for <code>glmmTMB()</code>
models from the <span class="pkg">glmmTMB</span> package.
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>cv</code>, <code>lmer</code>, <code>glmer</code>,
<code>lme</code>, <code>glmmTMB</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library("lme4")
# from ?lmer:
(fm1 &lt;- lmer(Reaction ~ Days + (Days | Subject), sleepstudy))
summary(cv(fm1, clusterVariables="Subject")) # LOO CV of clusters
summary(cv(fm1, seed=447)) # 10-fold CV of cases
summary(cv(fm1, clusterVariables="Subject", k=5,
   seed=834, reps=3)) # 5-fold CV of clusters, repeated 3 times

library("nlme")
# from ?lme
(fm2 &lt;- lme(distance ~ age + Sex, data = Orthodont,
            random = ~ 1))
summary(cv(fm2)) # LOO CV of cases
summary(cv(fm2, clusterVariables="Subject",
        k=5, seed=321)) # 5-fold CV of clusters

library("glmmTMB")
# from ?glmmTMB
(m1 &lt;- glmmTMB(count ~ mined + (1|site),
               zi=~mined,
               family=poisson, data=Salamanders))
summary(cv(m1, seed=97816, k=5,
          clusterVariables="site")) # 5-fold CV of clusters
summary(cv(m1, seed=34506, k=5)) # 5-fold CV of cases
</code></pre>


</div>