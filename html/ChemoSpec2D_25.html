<div class="container">

<table style="width: 100%;"><tr>
<td>plotSpectra2D</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot a Spectra2D Object</h2>

<h3>Description</h3>

<p>Plots a 2D spectrum stored in a <code>Spectra2D</code> object.
This is primarily for inspection and for preparation of final plots.
If you need to do extensive exploration, you should probably go back
to the spectrometer.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotSpectra2D(
  spectra,
  which = 1,
  lvls = NULL,
  cols = NULL,
  showNA = TRUE,
  showGrid = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>spectra</code></td>
<td>
<p>An object of S3 class <code>Spectra2D</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>An integer specifying which spectrum to plot.  May be a vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lvls</code></td>
<td>
<p>A numeric vector specifying the levels at which to compute contours.
If <code>NULL</code>, values are computed using <code>calcLvls</code>.  If
argument <code>which</code> gives more than one spectrum to plot, then <code>lvls</code>
must be a list of levels of <code>length(which)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cols</code></td>
<td>
<p>A vector of valid color designations.  If provided, must be of the
the same length as <code>lvls</code> (i.e. each contour is a particular color).
If <code>NULL</code>, defaults to using a scheme of up to nine values
running from blue (low) to red (high), centered on green (zero).  If
argument <code>which</code> gives more than one spectrum to plot, then <code>cols</code>
must be a list of colors of <code>length(which)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showNA</code></td>
<td>
<p>Logical. Should the locations of peaks removed by <code>removePeaks2D</code>
be shown?  If present, these are shown by a gray line at each frequency.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showGrid</code></td>
<td>
<p>Logical. If TRUE, show a dotted gray line at each tick mark.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters to be passed to the plotting routines.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Side effect is a plot.
</p>


<h3>Warning</h3>

<p>One cannot remove frequencies from the interior of a 2D NMR data set and expect to get a meaningful
contour plot, because doing so puts unrelated peaks adjacent in the data set.
This would lead to contours being drawn that don't exist in the original data set.
This function will check for missing frequencies and stops if any are found.
</p>


<h3>Scale</h3>

<p>You can view the color scale for the plot via <code>showScale</code>.
</p>


<h3>Levels &amp; Colors</h3>

<p>The number of levels and colors must match, and they are used 1 for 1.  If you
provide <code>n</code> colors, and no levels, the automatic calculation of levels may return
a number of levels other than <code>n</code>, in which case the function will override your colors and
assign new colors for the number of levels it computed (with a message).  To get
exactly what you want, specify both levels and colors in equal numbers.  Function
<code>inspectLvls</code> can help you choose appropriate levels.
</p>


<h3>Overlaying Spectra</h3>

<p>If you specify more than one spectrum to plot, e.g. <code>which = c(1,2)</code>, then
arguments <code>lvls</code> and <code>cols</code> must be lists of levels and colors, one list
element for each spectrum to be plotted (if specified at all).  Two convenience functions exist to
make this process easier: <code>LofL</code> and <code>LofC</code>. See the examples.
</p>


<h3>Author(s)</h3>

<p>Bryan A. Hanson, DePauw University.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(MUD1)
mylvls &lt;- seq(5, 30, 5)
plotSpectra2D(MUD1,
  which = 7, lvls = mylvls,
  main = "MUD1 Sample 7"
)

# Invert the screen which makes the colors pop!
op &lt;- par(no.readonly = TRUE)
par(bg = "black", fg = "white", col.axis = "white", col.main = "white")
plotSpectra2D(MUD1,
  which = 7, lvls = mylvls,
  main = "MUD1 Sample 7"
)
par(op)

# Overlay multiple spectra:

plotSpectra2D(MUD1,
  which = c(6, 1), lvls = LofL(mylvls, 2),
  cols = LofC(c("red", "black"), 2, length(mylvls), 2),
  main = "MUD1 Sample 1 (red) &amp; Sample 6 (black)\n(4 of 6 peaks overlap)"
)
</code></pre>


</div>