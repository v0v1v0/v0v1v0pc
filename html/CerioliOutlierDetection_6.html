<div class="container">

<table style="width: 100%;"><tr>
<td>hr05AdjustedDF</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Adjusted Degrees of Freedom for Testing Robust Mahalanobis Distances for Outlyingness</h2>

<h3>Description</h3>

<p>Computes the degrees of freedom for the adjusted F distribution for testing
Mahalanobis distances calculated with the minimum covariance 
determinant (MCD) robust dispersion estimate (for data with 
a model normal distribution) as described in Hardin and 
Rocke (2005) or in Green and Martin (2017).
</p>


<h3>Usage</h3>

<pre><code class="language-R">hr05AdjustedDF( n.obs, p.dim, mcd.alpha, m.asy, method = c("HR05", "GM14"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n.obs</code></td>
<td>
<p>(Integer) Number of observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.dim</code></td>
<td>
<p>(Integer) Dimension of the data, i.e.,
number of variables. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcd.alpha</code></td>
<td>
<p>(Numeric) Value that determines the
fraction of the sample used to compute the MCD estimate. 
Default value corresponds to the maximum breakdown point
case of the MCD.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m.asy</code></td>
<td>
<p>(Numeric) Asymptotic Wishart degrees of freedom. 
The default value uses <code>ch99AsymptoticDF</code> to 
obtain the the finite-sample asymptotic value, but the user can also 
provide a pre-computed value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Either "HR05" to use the method of Hardin and Rocke (2005),
or "GM14" to use the method of Green and Martin (2017).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Hardin and Rocke (2005) derived an approximate <code class="reqn">F</code> distribution
for testing robust Mahalanobis distances, computed using the MCD
estimate of dispersion, for outlyingness. This distribution improves
upon the standard <code class="reqn">\chi^2</code> distribution for identifying outlying
points in data set. The method of Hardin and Rocke was designed to work
for the maximum breakdown point case of the MCD, where 
</p>
<p style="text-align: center;"><code class="reqn">\alpha = \lfloor (n.obs + p.dim + 1)/2 \rfloor/n.obs.</code>
</p>

<p>Green and Martin (2017) extended 
this result to MCD(<code class="reqn">\alpha</code>), where <code class="reqn">\alpha</code> controls the
size of the sample used to compute the MCD estimate, as well as the
breakdown point of the estimator.
</p>
<p>With argument <code>method = "HR05"</code> the function returns 
<code class="reqn">m_{pred}</code> as given in Equation 3.4 of Hardin and Rocke (2005).
The Hardin and Rocke method is only supported for the maximum breakdown
point case; an error will be generated for other values of <code>mcd.alpha</code>.
</p>
<p>The argument <code>method = "GM14"</code> uses the extended methodology 
described in Green and Martin (2017) and is available for all values
of <code>mcd.alpha</code>.
</p>


<h3>Value</h3>

<p> Returns the adjusted F degrees of freedom based on the
asymptotic value, the dimension of the data, and the sample size.
</p>


<h3>Note</h3>

<p> This function is typically not called directly by users; rather
it is used in the construction of other functions.
</p>


<h3>Author(s)</h3>

<p>Written and maintained by Christopher G. Green &lt;christopher.g.green@gmail.com&gt;
</p>


<h3>References</h3>

<p>C. G. Green and R. Douglas Martin. An extension of a method of Hardin and Rocke, with
an application to multivariate outlier detection via the IRMCD method of Cerioli.
Working Paper, 2017. Available from 
<a href="https://christopherggreen.github.io/papers/hr05_extension.pdf">https://christopherggreen.github.io/papers/hr05_extension.pdf</a>
</p>
<p>J. Hardin and D. M. Rocke. The distribution of robust distances. Journal of Computational
and Graphical Statistics, 14:928-946, 2005. <a href="https://doi.org/10.1198/106186005X77685">doi:10.1198/106186005X77685</a>
</p>


<h3>See Also</h3>

<p><code>ch99AsymptoticDF</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">hr05tester &lt;- function(n,p) {
	a &lt;- floor( (n+p+1)/2 )/n
	hr05AdjustedDF( n, p, a, ch99AsymptoticDF(n,p,a)$m.hat.asy, method="HR05" )
}
# compare to m_pred in table on page 941 of Hardin and Rocke (2005)
hr05tester(  50, 5)
hr05tester( 100,10)
hr05tester( 500,10)
hr05tester(1000,20)

# using default arguments
hr05tester &lt;- function(n,p) {
	hr05AdjustedDF( n, p, method="HR05" )
}
# compare to m_pred in table on page 941 of Hardin and Rocke (2005)
hr05tester(  50, 5)
hr05tester( 100,10)
hr05tester( 500,10)
hr05tester(1000,20)

# Green and Martin (2017) improved method
hr05tester &lt;- function(n,p) {
	hr05AdjustedDF( n, p, method="GM14" )
}
# compare to m_sim in table on page 941 of Hardin and Rocke (2005)
hr05tester(  50, 5)
hr05tester( 100,10)
hr05tester( 500,10)
hr05tester(1000,20)
</code></pre>


</div>