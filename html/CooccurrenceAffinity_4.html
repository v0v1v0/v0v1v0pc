<div class="container">

<table style="width: 100%;"><tr>
<td>affinity2by2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Maximum likelihood estimate and intervals of alpha, null expectation, p-value and traditional indices from a 2x2 table</h2>

<h3>Description</h3>

<p>This function uses ML.Alpha() and supplements to the outcome with traditional indices of Jaccard, Sorenson, and Simpson.
ML.Alpha() calculates the maximum likelihood estimate and other quantities computed in AlphInts(),
for the log-odds parameter alpha in the Extended Hypergeometric distribution with fixed margins (mA,mB) and
table-total N, which is the "log-affinity" index of co-occurrence championed in a paper by Mainali et al. (2022) as an index of co-occurrence-based similarity.
</p>


<h3>Usage</h3>

<pre><code class="language-R">affinity2by2(
  x,
  marg,
  bound = TRUE,
  scal = log(2 * marg[3]^2),
  lev = 0.95,
  pvalType = "Blaker"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>integer co-occurrence count that should properly fall within the closed interval [max(0,mA+mB-N), min(mA,mB)]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marg</code></td>
<td>
<p>a 3-entry integer vector (mA,mB,N) consisting of the first row and column totals and the table total for a 2x2 contingency table</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bound</code></td>
<td>
<p>a boolean parameter which when TRUE replaces the MLE of "+/-Infinity", applicable when x is respectively at the upper extreme min(mA,mB)
or the lower extreme max(mA+mB-N,0) of its possible range, by a finite value with absolute value upper-bounding the value of
MLEs attainable for values of x not equal to its extremes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scal</code></td>
<td>
<p>an integer parameter (default 2*N^2, capped at 10 within the function) that should be 2 or greater</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lev</code></td>
<td>
<p>a confidence level, generally somewhere from 0.8 to 0.95  (default 0.95)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalType</code></td>
<td>
<p>a character string telling what kind of p-value to calculate. ‘Blaker’ or “midP’.
If ‘pvalType=Blaker” (the default value), the p-value is calculated according to "Acceptability" function of Blaker (2000).
If ‘pvalType=midP’, the p-value is calculated using the same idea as the midP confidence interval.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See the details of ML.Alpha(). In addition to the output of ML.Alpha, this function also computes Jaccard, Sorenson and Simpson indices.
</p>


<h3>Value</h3>

<p>This function returns maximum likelihood estimate of alpha, the interval-endpoints of alpha values for which x is a median,
four confidence intervals for alpha, described in detail under documentation for AlphInts(), and traditional indices of Jaccard, Sorenson and Simpson.
In addition there are two output list-components for the null-distribution expected co-occurrence count and the p-value
for the test of the null hypothesis alpha=0, calculated as in AlphInts.
</p>


<h3>Author(s)</h3>

<p>Kumar Mainali and Eric Slud
</p>


<h3>References</h3>

<p>Fog, A. (2015), BiasedUrn: Biased Urn Model Distributions. R package version 1.07.
</p>
<p>Harkness, W. (1965), “Properties of the extended hypergeometric distribution“, Annals of Mathematical Statistics, 36, 938-945.
</p>
<p>Mainali, K., Slud, E., Singer, M. and Fagan, W. (2022), "A better index for analysis of co-occurrence and similarity", Science Advances, to appear.
</p>


<h3>Examples</h3>

<pre><code class="language-R">ML.Alpha(x=35, c(mA=50, mB=70, N=150), lev=0.95)
affinity2by2(x=35, c(mA=50, mB=70, N=150), lev=0.95)
# ML.Alpha() is a subset of affinity2by2()
a &lt;- ML.Alpha(x=35, c(mA=50, mB=70, N=150), lev=0.95)
b &lt;- affinity2by2(x=35, c(mA=50, mB=70, N=150), lev=0.95)
identical(a, b[1:11])
</code></pre>


</div>