<div class="container">

<table style="width: 100%;"><tr>
<td>lcomCOPpv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulating the Sample Distribution(s) of L-correlation, L-coskew, and L-cokurtosis for a Copula</h2>

<h3>Description</h3>

<p><em>EXPERIMENTAL:</em> The function provides two themes of sampling distribution characterization by simulation of the first three L-comoment ratios (L-correlation <code class="reqn">\tau_{2[\ldots]}</code>, L-coskew <code class="reqn">\tau_{3[\ldots]}</code> and L-cokurtosis <code class="reqn">\tau_{4[\ldots]}</code>) of a copula. Subsequently, the sampling distribution can be used for inference.
</p>
<p>First, semi-optional Monte Carlo integration estimation of the L-comoments of the parent copula are computed. Second, simulations involving the sample size <code class="reqn">n</code> presumed the size of the actual sample from which the estimates of the sample L-comoments given as arguments. These simulations result in a report of the L-moments (not L-comoments) of the sampling distribution and these then are used to compute p-values for the L-comoment matrices provided by the user as a function argument.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lcomCOPpv(n, lcom, cop=NULL, para=NULL, repcoe=5E3, type="gno",
                   mcn=1E4, mcrep=10, usemcmu=FALSE, digits=5, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The sample size <code class="reqn">n</code>. This argument is semi-optional because <code class="reqn">n = 0</code> can be given to skip corresponding simulations and the <code>ntable</code> on return will only contain <code>NA</code>; this feature permits rapid extraction of the <code>Ntable</code> and thus the <code>lcom</code> contents are simply not used;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lcom</code></td>
<td>
<p>The sample L-comoments (see below);</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cop</code></td>
<td>
<p>A copula function;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>para</code></td>
<td>
<p>Vector of parameters, if needed, to pass to the copula;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>repcoe</code></td>
<td>
<p>The replication coefficient <code class="reqn">\phi</code> affecting the number of simulations of size <code>n</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>The distribution type used for modeling the distribution of the sampling values. The generalized normal (see distribution type <code>"gno"</code> in package <span class="pkg">lmomco</span>) accommodates some skewness compared to the symmetry of the normal (<code>"nor"</code>) just in case situations arise in which non-ignorable skewness in the sample distribution exists. The distribution abbreviations of package <span class="pkg">lmomco</span> are recognized for the <code>type</code> argument, but in reality the <code>"nor"</code> and <code>"gno"</code> should be more than sufficient;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcn</code></td>
<td>
<p>The sample size <code class="reqn">N</code> passed to the <code>bilmoms</code> function for the Monte Carlo integration. If <code class="reqn">N = 0</code> then the Monte Carlo integration is not used, otherwise the minimum sample size is internally reset to <code class="reqn">N=4</code> so that first four L-moments are computable;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcrep</code></td>
<td>
<p>The number of replications of the Monte Carlo simulation by <code>bilmoms</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>usemcmu</code></td>
<td>
<p>A logical toggling whether the mean value computed from the replicated Monte Carlo integrations is used instead of the mean values for the small sample simulation for the p-value computations;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>The number of digits to round numerical entries in the returned tables and can be <code>NA</code> for no rounding; and</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to pass to the <code>bilmoms</code> function or to the copula.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The notation <code class="reqn">r[\ldots]</code> refers to two specific types of L-comoment definitions and a blend between the two. The notation <code class="reqn">r[12]</code> means that the <code class="reqn">r</code>th L-comoment for random variables <code class="reqn">\{X^{(1)}, X^{(2)}\}</code> where <code class="reqn">X^{(2)}</code> is the sorted variable and <code class="reqn">X^{(1)}</code> is shuffled by the sorting index. Conversely, the notation <code class="reqn">r[21]</code> means that the <code class="reqn">r</code>th L-comoment for random variables <code class="reqn">\{X^{(1)}, X^{(2)}\}</code> where <code class="reqn">X^{(1)}</code> is the sorted variable and <code class="reqn">X^{(2)}</code> is shuffled by the sorting index. The notation <code class="reqn">r[12:21]</code> means that the average between the <code class="reqn">r[21]</code> and <code class="reqn">r[21]</code> is computed, which might prove useful in circumstances of known or expected symmetry of the L-comoments.
</p>
<p>Continuing, <code class="reqn">\hat\tau_{2[12]}</code> is the sample L-correlation, <code class="reqn">\hat\tau_{3[12]}</code> is the sample L-coskew, and <code class="reqn">\hat\tau_{4[12]}</code> is the sample L-cokurtosis all with respect to the sorting of the second variable. The computation of these L-comoment matricies can be made by functions such as function <code>lcomoms2()</code> in the <span class="pkg">lmomco</span> package. The number of replications for the simulations involving the <code class="reqn">n</code> sample size is computed by
</p>
<p style="text-align: center;"><code class="reqn">m = \phi/\sqrt{n}\mbox{,}</code>
</p>

<p>where <code class="reqn">\phi</code> is the <code>repcoe</code> replication factor or coefficient. If <code>usemcmu</code> is <code>TRUE</code> then <code>mcn</code> <code class="reqn">&gt; 0</code> else <code>usemcmu</code> is reset to <code>FALSE</code>.
</p>


<h3>Value</h3>

<p>An <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> <code>list</code> is returned.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>text</code></td>
<td>
<p>A string functioning as a label for the remaining tables;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ntable</code></td>
<td>
<p>Another <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> <code>list</code> holding tables of the L-moments of the L-comoments derived from Monte Carlo integration for samples of size <code class="reqn">N =</code> <code>mcn</code>. The simulations are replicated <code>mcrep</code> times; and</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntable</code></td>
<td>
<p>Another <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> <code>list</code> holding tables of the L-moments of the L-comoments derived from the small sample simulations for samples of size <code class="reqn">n =</code> <code>n</code> as well as the p-values estimated by a generalized normal distribution (see <span class="pkg">lmomco</span> package documentation) of the L-moments using either the small sample means or the mean of the replicated Monte Carlo integrations as dictated by <code>usemcmu</code>. In all circumstances, however, the results for the small sample simluations are tabulated in <code>ntable</code> only the p-value will be reflective the setting of <code>usemcmu</code>.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>A significance column for the p-values is added to the right side of the returned <code>ntable</code> and is used to guide the eye in interpretation of results. The significant codes having the following definitions for a two-tailed form:
</p>
<pre>
  "_" &gt; 0.1;  ".", 0.1;  "*", 0.05;  "**", 0.01;  "***", 0.001
</pre>


<h3>Author(s)</h3>

<p>W.H. Asquith</p>


<h3>References</h3>

<p>Nelsen, R.B., 2006, An introduction to copulas: New York, Springer, 269 p.
</p>


<h3>See Also</h3>

<p><code>lcomCOP</code>, <code>COP</code>, <code>kullCOP</code>, <code>vuongCOP</code></p>


<h3>Examples</h3>

<pre><code class="language-R"># See Note section of vuongCOP() for an extended discussion of copula inference
## Not run: 
Tau &lt;- 0.6410811; para &lt;- GHcop(tau=Tau)$para # This Tau is from a situation of
# two river tributaries. These three L-comoments with univariate L-moments on the
T2 &lt;- c(1,  0.79908960, 0.79908960, 1) # diagonals are derived from those river
# tributaries and downstream of the junction data.
T3 &lt;- c(0, -0.04999318, 0.07689082, 0)
T4 &lt;- c(0,  0.01773833, 0.04756257, 0) # Is the Ho:GHcop rejectable?
LCOM &lt;- list(T2=matrix(T2, nrow=2), T3=matrix(T3, nrow=2), T4=matrix(T4, nrow=2))
set.seed(30312)
ZZ1 &lt;- lcomCOPpv(75, LCOM, cop=GHcop, para=para, repcoe=2000, usemcmu=FALSE)
print(ZZ1)
set.seed(30312)
ZZ2 &lt;- lcomCOPpv(75, LCOM, cop=GHcop, para=para, repcoe=2000, usemcmu=TRUE)
print(ZZ2)
# The results here suggest that the GHcop is not rejectable.
## End(Not run)
</code></pre>


</div>