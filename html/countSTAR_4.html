<div class="container">

<table style="width: 100%;"><tr>
<td>bart_star_ispline</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>MCMC sampler for BART-STAR with a monotone spline model
for the transformation</h2>

<h3>Description</h3>

<p>Run the MCMC algorithm for BART model for count-valued responses using STAR.
The transformation is modeled as an unknown, monotone function
using I-splines. The Robust Adaptive Metropolis (RAM) sampler
is used for drawing the parameter of the transformation function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bart_star_ispline(
  y,
  X,
  X_test = NULL,
  y_test = NULL,
  lambda_prior = 1/2,
  y_max = Inf,
  n.trees = 200,
  sigest = NULL,
  sigdf = 3,
  sigquant = 0.9,
  k = 2,
  power = 2,
  base = 0.95,
  nsave = 5000,
  nburn = 5000,
  nskip = 2,
  save_y_hat = FALSE,
  target_acc_rate = 0.3,
  adapt_rate = 0.75,
  stop_adapt_perc = 0.5,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p><code>n x 1</code> vector of observed counts</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p><code>n x p</code> matrix of predictors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X_test</code></td>
<td>
<p><code>n0 x p</code> matrix of predictors for test data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_test</code></td>
<td>
<p><code>n0 x 1</code> vector of the test data responses (used for
computing log-predictive scores)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda_prior</code></td>
<td>
<p>the prior mean for the transformation g() is the Box-Cox function with
parameter <code>lambda_prior</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_max</code></td>
<td>
<p>a fixed and known upper bound for all observations; default is <code>Inf</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.trees</code></td>
<td>
<p>number of trees to use in BART; default is 200</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigest</code></td>
<td>
<p>positive numeric estimate of the residual standard deviation (see ?bart)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigdf</code></td>
<td>
<p>degrees of freedom for error variance prior (see ?bart)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigquant</code></td>
<td>
<p>quantile of the error variance prior that the rough estimate (sigest)
is placed at. The closer the quantile is to 1, the more aggresive the fit will be (see ?bart)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>the number of prior standard deviations E(Y|x) = f(x) is away from +/- 0.5.
The response is internally scaled to range from -0.5 to 0.5.
The bigger k is, the more conservative the fitting will be (see ?bart)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>power parameter for tree prior (see ?bart)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>base</code></td>
<td>
<p>base parameter for tree prior (see ?bart)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsave</code></td>
<td>
<p>number of MCMC iterations to save</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nburn</code></td>
<td>
<p>number of MCMC iterations to discard</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nskip</code></td>
<td>
<p>number of MCMC iterations to skip between saving iterations,
i.e., save every (nskip + 1)th draw</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save_y_hat</code></td>
<td>
<p>logical; if TRUE, compute and save the posterior draws of
the expected counts, E(y), which may be slow to compute</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target_acc_rate</code></td>
<td>
<p>target acceptance rate (between zero and one)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adapt_rate</code></td>
<td>
<p>rate of adaptation in RAM sampler (between zero and one)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stop_adapt_perc</code></td>
<td>
<p>stop adapting at the proposal covariance at <code>stop_adapt_perc*nburn</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical; if TRUE, print time remaining</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list with the following elements:
</p>

<ul>
<li> <p><code>fitted.values</code>: the posterior mean of the conditional expectation of the counts <code>y</code>
</p>
</li>
<li> <p><code>post.fitted.values</code>: posterior draws of the conditional mean of the counts <code>y</code>
</p>
</li>
<li> <p><code>post.pred.test</code>: draws from the posterior predictive distribution at the test points <code>X_test</code>
</p>
</li>
<li> <p><code>post.fitted.values.test</code>: posterior draws of the conditional mean at the test points <code>X_test</code>
</p>
</li>
<li> <p><code>post.pred</code>: draws from the posterior predictive distribution of <code>y</code>
</p>
</li>
<li> <p><code>post.sigma</code>: draws from the posterior distribution of <code>sigma</code>
</p>
</li>
<li> <p><code>post.mu.test</code>: draws of the conditional mean of z_star at the test points
</p>
</li>
<li> <p><code>post.log.like.point</code>: draws of the log-likelihood for each of the <code>n</code> observations
</p>
</li>
<li> <p><code>post.log.pred.test</code>: draws of the log-predictive distribution for each of the <code>n0</code> test cases
</p>
</li>
<li> <p><code>WAIC</code>: Widely-Applicable/Watanabe-Akaike Information Criterion
</p>
</li>
<li> <p><code>p_waic</code>: Effective number of parameters based on WAIC
</p>
</li>
<li> <p><code>post.g</code>: draws from the posterior distribution of the transformation <code>g</code>
</p>
</li>
<li> <p><code>post.sigma.gamma</code>: draws from the posterior distribution of <code>sigma.gamma</code>,
the prior standard deviation of the transformation <code>g</code> coefficients
</p>
</li>
</ul>
</div>