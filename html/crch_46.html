<div class="container">

<table style="width: 100%;"><tr>
<td>CensoredStudentsT</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create a Censored Student's T Distribution</h2>

<h3>Description</h3>

<p>Class and methods for left-, right-, and interval-censored t
distributions using the workflow from the <span class="pkg">distributions3</span> package.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CensoredStudentsT(df, location = 0, scale = 1, left = -Inf, right = Inf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>numeric. The degrees of freedom of the underlying <em>uncensored</em>
t distribution. Can be any positive number, with <code>df = Inf</code> corresponding
to the normal distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>location</code></td>
<td>
<p>numeric. The location parameter of the underlying <em>uncensored</em>
t distribution, typically written <code class="reqn">\mu</code> in textbooks.
Can be any real number, defaults to <code>0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>numeric. The scale parameter (standard deviation) of
the underlying <em>uncensored</em> t distribution,
typically written <code class="reqn">\sigma</code> in textbooks.
Can be any positive number, defaults to <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>left</code></td>
<td>
<p>numeric. The left censoring point. Can be any real number,
defaults to <code>-Inf</code> (uncensored). If set to a finite value, the
distribution has a point mass at <code>left</code> whose probability corresponds
to the cumulative probability function of the <em>uncensored</em>
t distribution at this point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>right</code></td>
<td>
<p>numeric. The right censoring point. Can be any real number,
defaults to <code>Inf</code> (uncensored). If set to a finite value, the
distribution has a point mass at <code>right</code> whose probability corresponds
to 1 minus the cumulative probability function of the <em>uncensored</em>
t distribution at this point.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The constructor function <code>CensoredStudentsT</code> sets up a distribution
object, representing the censored t probability distribution by the
corresponding parameters: the degrees of freedom <code>df</code>, the latent mean
<code>location</code> = <code class="reqn">\mu</code> and latent scale parameter <code>scale</code> = <code class="reqn">\sigma</code>
(i.e., the parameters of the underlying <em>uncensored</em> t variable),
the <code>left</code> censoring point (with <code>-Inf</code> corresponding to uncensored),
and the <code>right</code> censoring point (with <code>Inf</code> corresponding to uncensored). 
</p>
<p>The censored t distribution has probability density function (PDF) <code class="reqn">f(x)</code>:
</p>

<table>
<tr>
<td style="text-align: left;">
<code class="reqn">T((left - \mu)/\sigma)</code> </td>
<td style="text-align: left;"> if <code class="reqn">x \le left</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
<code class="reqn">1 - T((right - \mu)/\sigma)</code> </td>
<td style="text-align: left;"> if <code class="reqn">x \ge right</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
<code class="reqn">\tau((x - \mu)/\sigma)/\sigma</code> </td>
<td style="text-align: left;"> otherwise
</td>
</tr>
</table>
<p>where <code class="reqn">T</code> and <code class="reqn">\tau</code> are the cumulative distribution function
and probability density function of the standard t distribution with
<code>df</code> degrees of freedom, respectively.
</p>
<p>All parameters can also be vectors, so that it is possible to define a vector
of censored t distributions with potentially different parameters.
All parameters need to have the same length or must be scalars (i.e.,
of length 1) which are then recycled to the length of the other parameters.
</p>
<p>For the <code>CensoredStudentsT</code> distribution objects there is a wide range
of standard methods available to the generics provided in the <span class="pkg">distributions3</span>
package: <code>pdf</code> and <code>log_pdf</code>
for the (log-)density (PDF), <code>cdf</code> for the probability
from the cumulative distribution function (CDF), <code>quantile</code> for quantiles,
<code>random</code> for simulating random variables,
<code>crps</code> for the continuous ranked probability score
(CRPS), and <code>support</code> for the support interval
(minimum and maximum). Internally, these methods rely on the usual d/p/q/r
functions provided for the censored t distributions in the <span class="pkg">crch</span>
package, see <code>dct</code>, and the <code>crps_ct</code>
function from the <span class="pkg">scoringRules</span> package.
The methods <code>is_discrete</code> and <code>is_continuous</code>
can be used to query whether the distributions are discrete on the entire support
(always <code>FALSE</code>) or continuous on the entire support (only <code>TRUE</code> if
there is no censoring, i.e., if both <code>left</code> and <code>right</code> are infinite).
</p>
<p>See the examples below for an illustration of the workflow for the class and methods.
</p>


<h3>Value</h3>

<p>A <code>CensoredStudentsT</code> distribution object.
</p>


<h3>See Also</h3>

<p><code>dct</code>, <code>StudentsT</code>, <code>TruncatedStudentsT</code>,
<code>CensoredNormal</code>, <code>CensoredLogistic</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
## package and random seed
library("distributions3")
set.seed(6020)

## three censored t distributions:
## - uncensored standard t with 5 degrees of freedom
## - left-censored at zero with 5 df, latent location = 1 and scale = 1
## - interval-censored in [0, 5] with 5 df, latent location = 2 and scale = 2
X &lt;- CensoredStudentsT(
  df       = c(   5,   5, 5),
  location = c(   0,   1, 2),
  scale    = c(   1,   1, 2),
  left     = c(-Inf,   0, 0),
  right    = c( Inf, Inf, 5)
)

X


## compute mean of the censored distribution
mean(X)
## higher moments (variance, skewness, kurtosis) are not implemented yet

## support interval (minimum and maximum)
support(X)

## simulate random variables
random(X, 5)

## histograms of 1,000 simulated observations
x &lt;- random(X, 1000)
hist(x[1, ], main = "uncensored")
hist(x[2, ], main = "left-censored at zero")
hist(x[3, ], main = "interval-censored in [0, 5]")

## probability density function (PDF) and log-density (or log-likelihood)
x &lt;- c(0, 0, 1)
pdf(X, x)
pdf(X, x, log = TRUE)
log_pdf(X, x)

## cumulative distribution function (CDF)
cdf(X, x)

## quantiles
quantile(X, 0.5)

## cdf() and quantile() are inverses (except at censoring points)
cdf(X, quantile(X, 0.5))
quantile(X, cdf(X, 1))

## all methods above can either be applied elementwise or for
## all combinations of X and x, if length(X) = length(x),
## also the result can be assured to be a matrix via drop = FALSE
p &lt;- c(0.05, 0.5, 0.95)
quantile(X, p, elementwise = FALSE)
quantile(X, p, elementwise = TRUE)
quantile(X, p, elementwise = TRUE, drop = FALSE)

## compare theoretical and empirical mean from 1,000 simulated observations
cbind(
  "theoretical" = mean(X),
  "empirical" = rowMeans(random(X, 1000))
)

## evaluate continuous ranked probability score (CRPS) using scoringRules

library("scoringRules")
crps(X, x)

</code></pre>


</div>