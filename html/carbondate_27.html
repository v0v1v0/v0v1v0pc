<div class="container">

<table style="width: 100%;"><tr>
<td>PlotPosteriorChangePoints</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot Calendar Ages of Changes in Rate of Sample Occurrence for Poisson Process Model</h2>

<h3>Description</h3>

<p>Given output from the Poisson process fitting function PPcalibrate, plot the
posterior density estimates for the calendar ages at which there are internal changepoints in the rate
of sample occurrence <code class="reqn">\lambda(t)</code>. These density estimates are calculated <strong>conditional</strong>
upon the number of internal changepoints within the period under study (which is specified as an input
to the function).
</p>
<p>Having conditioned on the number of changes, <code>n_change</code>, the code will extract all realisations
from the the posterior of the MCMC sampler which have that number of internal changepoints in the
estimate of <code class="reqn">\lambda(t)</code>. It will then provide density estimates for the (ordered) calendar ages
of those internal changepoints. These density estimates are obtained using a Gaussian kernel.
</p>
<p><strong>Note: These graphs will become harder to interpret as the specified number of changepoints
increases</strong>
</p>
<p>For more information read the vignette: <br><code>vignette("Poisson-process-modelling", package = "carbondate")</code>
</p>


<h3>Usage</h3>

<pre><code class="language-R">PlotPosteriorChangePoints(
  output_data,
  n_changes = c(1, 2, 3),
  plot_cal_age_scale = "BP",
  n_burn = NA,
  n_end = NA,
  kernel_bandwidth = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>output_data</code></td>
<td>
<p>The return value from the updating function
PPcalibrate. Optionally, the output data can have an extra list item
named <code>label</code> which is used to set the label on the plot legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_changes</code></td>
<td>
<p>Number of internal changepoints to condition on, and plot for. A vector
which can contain at most 4 elements, with values in the range 1 to 6. If not given, then
<code>c(1, 2, 3)</code> will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_cal_age_scale</code></td>
<td>
<p>(Optional) The calendar scale to use for the x-axis. Allowed values are
"BP", "AD" and "BC". The default is "BP" corresponding to plotting in cal yr BP.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_burn</code></td>
<td>
<p>The number of MCMC iterations that should be discarded as burn-in (i.e.,
considered to be occurring before the MCMC has converged). This relates to the number
of iterations (<code>n_iter</code>) when running the original update functions (not the thinned <code>output_data</code>).
Any MCMC iterations before this are not used in the calculations. If not given, the first half of the
MCMC chain is discarded. Note: The maximum value that the function
will allow is <code>n_iter - 100 * n_thin</code> (where <code>n_iter</code> and <code>n_thin</code> are the arguments that were given to
PPcalibrate) which would leave only 100 of the (thinned) values in <code>output_data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_end</code></td>
<td>
<p>The last iteration in the original MCMC chain to use in the calculations. Assumed to be the
total number of iterations performed, i.e. <code>n_iter</code>, if not given.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel_bandwidth</code></td>
<td>
<p>(Optional) The bandwidth used for the (Gaussian) kernel smoothing of
the calendar age densities. If not given, then 1/50th of the overall calendar age range will be used.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>None
</p>


<h3>Examples</h3>

<pre><code class="language-R"># NOTE: This example is shown with a small n_iter to speed up execution.
# Try n_iter and n_posterior_samples as the function defaults.

pp_output &lt;- PPcalibrate(
    pp_uniform_phase$c14_age,
    pp_uniform_phase$c14_sig,
    intcal20,
    n_iter = 1000,
    show_progress = FALSE)

# Plot the posterior change points for only 2 or 3 internal changes
PlotPosteriorChangePoints(pp_output, n_changes = c(2, 3))

# Changing the calendar age plotting scale to cal AD
PlotPosteriorChangePoints(pp_output, n_changes = c(2, 3),
    plot_cal_age_scale = "AD")
</code></pre>


</div>