<div class="container">

<table style="width: 100%;"><tr>
<td>lsfit.circle</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit a 2D circle to an (x,y) dataset</h2>

<h3>Description</h3>

<p>Fit a 2D circle to an (x,y) dataset using LS.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lsfit.circle(x, y, init = NULL, units = c("radians", "degrees"), 
  template = c("none", "geographics"),
  modulo = c("asis", "2pi", "pi"), zero = 0, 
  rotation = c("counter", "clock"), ...)
## S3 method for class 'lsfit.circle'
print(x, digits = max(3, getOption("digits") - 3), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>either a matrix with two columns or a vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>if <code>x</code> is a vector then <code>y</code> must be a vector with the same length.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>initial values of the parameters. A vector of length 3 with
the following components: radius of the circle, x-coordinate of the
center, y-coordinate of the center. If <code>NULL</code> the vector is set
to <code>c(max(c(abs(x-mean(x)), abs(y-mean(y)))), mean(x), mean(y)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>units</code></td>
<td>
<p>the <code>units</code> used in defining the angles between
observations and the center of the circle. See <code>circular</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>template</code></td>
<td>
<p>the <code>template</code> used in defining the angles between
observations and the center of the circle. See <code>circular</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modulo</code></td>
<td>
<p>the <code>modulo</code> used in defining the angles between
observations and the center of the circle. See <code>circular</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zero</code></td>
<td>
<p>the <code>zero</code> used in defining the angles between
observations and the center of the circle. See <code>circular</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rotation</code></td>
<td>
<p>the <code>rotation</code> used in defining the angles between
observations and the center of the circle. See <code>circular</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further parameters passed to the <code>optim</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>the number of digits to be printed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>lsfit.circle</code> uses the <code>optim</code> function to minimize the sum of the
squared residuals between the observations and the optimally fitting circle.
</p>


<h3>Value</h3>

<p>An object of class <code>lsfit.circle</code>.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>a vector of length 3 with the estimated radius and
coordinate of the center of the fitted circle.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the x-coordinate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>the y-coordinate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.centered</code></td>
<td>
<p>the x-coordinate re-centered at the center of the circle.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.centered</code></td>
<td>
<p>the y-coordinate re-centered at the center of the circle.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>angles</code></td>
<td>
<p>angles of the observations with respect to the center
coordinate of class <code>circular</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>radius</code></td>
<td>
<p>the distance between the observations and the center
coordinate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>
<p>value from the function optim.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optim</code></td>
<td>
<p>the output from the function optim.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the <code>match.call</code> result.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Claudio Agostinelli and Ulric Lund</p>


<h3>References</h3>

 
<p>Coope, I. (1993). Circle fitting by linear and non-linear least squares. 
Journal of Optimization Theory and Applications, 76, 381-388. 
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(coope)
res &lt;- lsfit.circle(x=x.coope, y=y.coope)
res

plot(res)

par(mfcol=c(1,2))
plot(res$angles)
hist(res$radius)

plot(circular(0), type="n", xlim=c(-5.2, 5.2), ylim=c(-5.2, 5.2), 
  xlab="The Radius of the circle \n is measured from the base line of the axes.")
lines(x=res$angles, y=res$radius, join=TRUE, type="b")
ff &lt;- function(x) sqrt((res$coefficients[1]*cos(x))^2+(res$coefficients[1]*sin(x))^2)
curve.circular(ff, add=TRUE, join=TRUE, nosort=FALSE, col=2)

windrose(x=res$angles, y=res$radius)
</code></pre>


</div>