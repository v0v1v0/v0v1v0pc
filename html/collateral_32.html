<div class="container">

<table style="width: 100%;"><tr>
<td>collateral_mappers</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Map over a list while capturing side effects.</h2>

<h3>Description</h3>

<p><code>map_safely()</code>, <code>map_quietly()</code> and <code>map_peacefully()</code> are variants of
<code>purrr::map()</code> that wrap the supplied function <code>.f</code> using <code>purrr::safely()</code>
and/or <code>purrr::quietly()</code> in order to capture various side effects. Lists
mapped in this way have an associated class added to them, allowing them to
succinctly summarise captured side effects when displayed in a tibble.
</p>


<h3>Usage</h3>

<pre><code class="language-R">map_safely(.x, .f, otherwise = NULL, quiet = TRUE, ...)

map_quietly(.x, .f, ...)

map_peacefully(.x, .f, ...)

map2_safely(.x, .y, .f, otherwise = NULL, quiet = TRUE, ...)

map2_quietly(.x, .y, .f, ...)

map2_peacefully(.x, .y, .f, ...)

pmap_safely(.l, .f, otherwise = NULL, quiet = TRUE, ...)

pmap_quietly(.l, .f, ...)

pmap_peacefully(.l, .f, ...)

future_map_safely(.x, .f, otherwise = NULL, quiet = TRUE, ...)

future_map_quietly(.x, .f, ...)

future_map_peacefully(.x, .f, ...)

future_map2_safely(.x, .y, .f, otherwise = NULL, quiet = TRUE, ...)

future_map2_quietly(.x, .y, .f, ...)

future_map2_peacefully(.x, .y, .f, ...)

future_pmap_safely(.l, .f, otherwise = NULL, quiet = TRUE, ...)

future_pmap_quietly(.l, .f, ...)

future_pmap_peacefully(.l, .f, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>.x</code></td>
<td>
<p>A list or atomic vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.f</code></td>
<td>
<p>A function, formula or atomic vector, as specified by
<code>purrr::as_mapper()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>otherwise</code></td>
<td>
<p>Default value to use when an error occurs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>
<p>Hide errors (<code>TRUE</code>, the default), or display them as they
occur?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments supplied to <code>purrr::map()</code> or its variants, or to
<code>furrr::future_map()</code> or its variants..</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.y</code></td>
<td>
<p>A list or atomic vector, of the same length as <code>.x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.l</code></td>
<td>
<p>A list of lists. The length of <code>.l</code> determines the number of
arguments that <code>.f</code> will be called with. List names will be used if
present.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>map_safely()</code> will summarise the returned list with a fixed-width
string of two (spaced) columns:
</p>

<ol>
<li>
<p> If a <code>result</code> component is present, <code>R</code> appears, and
</p>
</li>
<li>
<p> If an <code>error</code> component is present, <code>E</code> appears.
</p>
</li>
</ol>
<p>If either component is missing, an underscore (<code style="white-space: pre;">⁠_⁠</code>) appears in its
place.
</p>
<p>Similarly, <code>map_quietly()</code> will summarise the returned list with a
fixed-width string of four (spaced) columns:
</p>

<ol>
<li>
<p> If a <code>result</code> component is present, <code>R</code> appears,
</p>
</li>
<li>
<p> If an <code>output</code> component is present, <code>O</code> appears,
</p>
</li>
<li>
<p> If a <code>messages</code> component is present, <code>M</code> appears, and
</p>
</li>
<li>
<p> If a <code>warnings</code> component is present, <code>W</code> appears.
</p>
</li>
</ol>
<p>If any is missing, an underscore (<code style="white-space: pre;">⁠_⁠</code>) appears in its
place.
</p>
<p>Variants for <a href="https://purrr.tidyverse.org/reference/map2.html">iterating over two or more inputs simultaneously</a>
are also provided and function identically to their <code>purrr</code> counterparts:
</p>

<ol>
<li> <p><code>map2_safely()</code>
</p>
</li>
<li> <p><code>map2_quietly()</code>
</p>
</li>
<li> <p><code>pmap_safely()</code>
</p>
</li>
<li> <p><code>pmap_quietly()</code>
</p>
</li>
</ol>
<p>Further variants, prefixed by <code>future_</code>, allow safe or quiet mapping to
happen in parallel if you have the <a href="https://cran.r-project.org/package=furrr"><code>furrr</code></a>
package installed:
</p>

<ol>
<li> <p><code>future_map_safely()</code>
</p>
</li>
<li> <p><code>future_map_quietly()</code>
</p>
</li>
<li> <p><code>future_map2_safely()</code>
</p>
</li>
<li> <p><code>future_map2_quietly()</code>
</p>
</li>
<li> <p><code>future_pmap_safely()</code>
</p>
</li>
<li> <p><code>future_pmap_quietly()</code>
</p>
</li>
</ol>
<h3>Value</h3>

<p>A list of the same length as <code>.x</code>. Each element of the returned list
is itself a named list, structured according to the captured side effects.
The Details section elaborates on these side effects.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(tibble)
library(dplyr)
library(tidyr)
library(collateral)

# like map(), these can be used to iterate over vectors or lists
list("a", 10, 100) %&gt;% map_safely(log)
list(5, -12, 103) %&gt;% map_quietly(log)

# if you're using tibbles, you can also iterate over list-columns,
# such as nested data frames
mtcars %&gt;%
  rownames_to_column(var = "car") %&gt;%
  as_tibble() %&gt;%
  select(car, cyl, disp, wt) %&gt;%
  # spike some rows in cyl == 4 to make them fail
  mutate(wt = dplyr::case_when(
    wt &lt; 2 ~ -wt,
    TRUE ~ wt)) %&gt;%
  # nest and do some operations quietly()
  nest(data = -cyl) %&gt;%
  mutate(qlog = map_quietly(data, ~ log(.$wt)))

</code></pre>


</div>