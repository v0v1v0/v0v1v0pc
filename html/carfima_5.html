<div class="container">

<table style="width: 100%;"><tr>
<td>carfima.loglik</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Computing the log likelihood function of a CARFIMA(p, H, q) model</h2>

<h3>Description</h3>

<p>This function evaluates the log likelihood function of a CARFIMA(p, H, q) model as specified in Tsai and Chan (2005). 
</p>


<h3>Usage</h3>

<pre><code class="language-R">carfima.loglik(Y, time, measure.error, ar.p, ma.q, parameter, fitted = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>

<p>A vector for the <code class="reqn">k</code> observed data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>

<p>A vector for the <code class="reqn">k</code> observation times.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>measure.error</code></td>
<td>

<p>(Optional) A vector for the <code class="reqn">k</code> measurement error standard deviations, if such information is available (especially for astronomical applications). A vector of zeros is automatically assigned, if nothing is specified.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ar.p</code></td>
<td>

<p>A positive integer for the order of the AR model. <code>ar.p</code> must be greater than <code>ma.q</code>. If <code>ar.p</code> is greater than 2, numerical errors may occur for both methods.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ma.q</code></td>
<td>

<p>A non-negative integer for the order of the MA model. <code>ma.q</code> must be smaller than <code>ar.p</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameter</code></td>
<td>

<p>The values of the unknown parameters at which the log likelihood is evaluated. For example, users need to specify five values of <code class="reqn">\alpha_1</code>,  <code class="reqn">\alpha_2</code>, <code class="reqn">\beta_1</code>, <code class="reqn">H</code>, and <code class="reqn">\sigma</code> for CARFIMA(2, H, 1). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted</code></td>
<td>

<p>If "TRUE", fitted values and AIC are returned. If "FALSE", a value of the log likelihood is returned. Default is "FALSE".
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>carfiam.loglik</code> computes the log likelihood of a CARFIMA(p, H, q) model via the innovation algorithm whose computational cost increases linearly as the size of the data increases; see Tsai and Chan (2005) for details.
</p>


<h3>Value</h3>

<p>The outcome of <code>carfima</code> is the value of the log likelihood if "fitted = FALSE" and both AIC and fitted values if "fitted = TRUE".
</p>


<h3>Author(s)</h3>

<p>Hyungsuk Tak, Henghsiu Tsai, Kisung You
</p>


<h3>References</h3>

<p>H. Tsai and K.S. Chan (2005) "Maximum Likelihood Estimation of Linear Continuous Time Long Memory Processes with Discrete Time Data," Journal of the Royal Statistical Society (Series B), 67 (5), 703-716. DOI: 10.1111/j.1467-9868.2005.00522.x
</p>
<p>H. Tsai and K.S. Chan (2000) "A Note on the Covariance Structure of a Continuous-time ARMA Process," Statistica Sinica, 10, 989-998. <br> Link: http://www3.stat.sinica.edu.tw/statistica/j10n3/j10n317/j10n317.htm
</p>


<h3>Examples</h3>

<pre><code class="language-R">  ##### Irregularly spaced observation time generation.


  length.time &lt;- 30
  time.temp &lt;- rexp(length.time, rate = 2)
  time &lt;- rep(NA, length.time + 1)
  time[1] &lt;- 0
  for (i in 2 : (length.time + 1)) {
    time[i] &lt;- time[i - 1] + time.temp[i - 1]
  }
  time &lt;- time[-1]

  ##### Data genration for CARFIMA(1, H, 0) based on the observation times. 

  parameter &lt;- c(-0.4, 0.8, 0.2) 
  # AR parameter alpha = -0.4
  # Hurst parameter = 0.8
  # Process uncertainty (standard deviation) sigma = 0.2

  me.sd &lt;- rep(0.05, length.time)
  # Known measurement error standard deviations 0.05 for all observations
  # If not known, remove the argument "measure.error = me.sd" in the following codes,
  # so that the default values (zero) are automatically assigned.

  y &lt;- carfima.sim(parameter = parameter, time = time, 
                   measure.error = me.sd, ar.p = 1, ma.q = 0)  

  ##### Computing the log likelihood of the CARFIMA(1, H, 0) model given the parameters.
  loglik &lt;- carfima.loglik(Y = y, time = time, ar.p = 1, ma.q = 0,
                           measure.error = me.sd,
                           parameter = parameter, fitted = FALSE)
</code></pre>


</div>