<div class="container">

<table style="width: 100%;"><tr>
<td>Divergence based regression for compositional data with compositional data in the covariates side using the alpha-transformation</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Divergence based regression for compositional data with compositional data in the covariates side using the <code class="reqn">\alpha</code>-transformation
</h2>

<h3>Description</h3>

<p>Divergence based regression for compositional data with compositional data in the covariates side using the <code class="reqn">\alpha</code>-transformation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">kl.alfapcr(y, x, covar = NULL, a, k, xnew = NULL, B = 1, ncores = 1, tol = 1e-07,
maxiters = 50)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>A numerical matrixc with compositional data with or without zeros.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>A matrix with the predictor variables, the compositional data. Zero values are allowed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covar</code></td>
<td>

<p>If you have other covariates as well put themn here.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>

<p>The value of the power transformation, it has to be between -1 and 1. If zero values are present it has to be greater than 0.
If <code class="reqn">\alpha=0</code> the isometric log-ratio transformation is applied.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>

<p>A number at least equal to 1. How many principal components to use.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xnew</code></td>
<td>

<p>A matrix containing the new compositional data whose response is to be predicted. If you have no new data,
leave this NULL as is by default.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>

<p>If B is greater than 1 bootstrap estimates of the standard error are returned. If B=1, no standard errors are returned.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>

<p>If ncores is 2 or more parallel computing is performed. This is to be used for the case of bootstrap.
If B=1, this is not taken into consideration.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>

<p>The tolerance value to terminate the Newton-Raphson procedure.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiters</code></td>
<td>

<p>The maximum number of Newton-Raphson iterations.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code class="reqn">\alpha</code>-transformation is applied to the compositional data first, the first k principal component scores are calcualted and used as predictor variables for the Kullback-Leibler divergence based regression model.
</p>


<h3>Value</h3>

<p>A list including:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>runtime</code></td>
<td>

<p>The time required by the regression.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iters</code></td>
<td>

<p>The number of iterations required by the Newton-Raphson in the kl.compreg function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>

<p>The log-likelihood. This is actually a quasi multinomial regression. This is bascially minus the half deviance, or
<code class="reqn">- sum_{i=1}^ny_i\log{y_i/\hat{y}_i}</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>be</code></td>
<td>

<p>The beta coefficients.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seb</code></td>
<td>

<p>The standard error of the beta coefficients, if bootstrap is chosen, i.e. if B &gt; 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est</code></td>
<td>

<p>The fitted values of xnew if xnew is not NULL.
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Initial code by Abdulaziz Alenazi. Modifications by Michail Tsagris.
</p>
<p>R implementation and documentation: Abdulaziz Alenazi <a href="mailto:a.alenazi@nbu.edu.sa">a.alenazi@nbu.edu.sa</a> 
and Michail Tsagris <a href="mailto:mtsagris@uoc.gr">mtsagris@uoc.gr</a>.
</p>


<h3>References</h3>

<p>Alenazi A. (2019). Regression for compositional data with compositional data as predictor variables with or without zero values.
Journal of Data Science, 17(1): 219-238.
https://jds-online.org/journal/JDS/article/136/file/pdf
</p>
<p>Tsagris M. (2015). Regression analysis with compositional data containing zero values. Chilean Journal of Statistics, 6(2): 47-57.
http://arxiv.org/pdf/1508.01913v1.pdf
</p>
<p>Tsagris M.T., Preston S. and Wood A.T.A. (2011). A data-based power transformation for compositional data.
In Proceedings of the 4th Compositional Data Analysis Workshop, Girona, Spain.
http://arxiv.org/pdf/1106.1451.pdf
</p>


<h3>See Also</h3>

<p><code>klalfapcr.tune, tflr, glm.pcr, alfapcr.tune
</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(MASS)
y &lt;- rdiri(214, runif(4, 1, 3))
x &lt;- as.matrix(fgl[, 2:9])
x &lt;- x / rowSums(x)
mod &lt;- alfa.pcr(y = y, x = x, a = 0.7, k = 1)
mod
</code></pre>


</div>