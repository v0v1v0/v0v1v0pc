<div class="container">

<table style="width: 100%;"><tr>
<td>sPlotSpectra</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>s-Plot of Spectra Data (Post PCA)</h2>

<h3>Description</h3>

<p>Produces a scatter plot of the correlation of the
variables against their covariance for a chosen principal component.  It
allows visual identification of variables driving the separation and thus is
a useful adjunct to traditional loading plots.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sPlotSpectra(spectra, pca, pc = 1, tol = 0.05, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>spectra</code></td>
<td>
<p>An object of S3 class <code>Spectra()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pca</code></td>
<td>
<p>The result of a pca calculation on <code>Spectra</code> (i.e.
the output from <code>c_pcaSpectra</code> or <code>r_pcaSpectra</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pc</code></td>
<td>
<p>An integer specifying the desired pc plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>A number describing the fraction of points to be labeled. <code>tol = 1.0</code> labels all the points; <code>tol = 0.05</code> labels <em>approximately</em> the most extreme 5 percent. Set to <code>'none'</code> to completely suppress labels. Note that a simple approach based upon quantiles is used, assumes that both x and y are each normally distributed, and treats x and y separately.  Thus, this is not a formal treatment of outliers, just a means of labeling points. Groups are lumped together for the computation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Parameters to be passed to the plotting routines. <em>Applies to base graphics only</em>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The returned value depends on the graphics option selected (see <code>GraphicsOptions()</code>).
</p>

<ul>
<li> <p><code>base</code>: None.  Side effect is a plot.
</p>
</li>
<li> <p><code>ggplot2</code>: The plot is displayed, and a <code>ggplot2</code> object is returned if the value is assigned.  The plot can be modified in the usual <code>ggplot2</code> manner.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University), Tejasvi Gupta, Matthew J. Keinsley.
</p>


<h3>References</h3>

<p>Wiklund, Johansson, Sjostrom, Mellerowicz, Edlund, Shockcor,
Gottfries, Moritz, and Trygg. "Visualization of GC/TOF-MS-Based
Metabololomics Data for Identification of Biochemically Interesting
Compounds Usings OPLS Class Models" Analytical Chemistry Vol.80 no.1 pgs.
115-122 (2008).
</p>


<h3>See Also</h3>

<p>Additional documentation at <a href="https://bryanhanson.github.io/ChemoSpec/">https://bryanhanson.github.io/ChemoSpec/</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# This example assumes the graphics output is set to ggplot2 (see ?GraphicsOptions).
library("ggplot2")
data(SrE.IR)
pca &lt;- c_pcaSpectra(SrE.IR)
myt &lt;- expression(bolditalic(Serenoa) ~ bolditalic(repens) ~ bold(IR ~ Spectra))
p &lt;- sPlotSpectra(spectra = SrE.IR, pca = pca, pc = 1, tol = 0.001)
p &lt;- p + ggtitle(myt)
p

</code></pre>


</div>