<div class="container">

<table style="width: 100%;"><tr>
<td>avei_vs_res</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Mean and standard deviation in resolution shells.</h2>

<h3>Description</h3>

<p>Calculates averages and standard deviations of the input vector quantity for all
reflections, corresponding to shells of resolution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">avei_vs_res(nbin, resos, II = NULL, m = max(resos), M = min(resos))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>nbin</code></td>
<td>
<p>A positive integer. The number of resolution shells.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resos</code></td>
<td>
<p>A vector of real quantities. These are the resolutions (in angstroms)
corresponding to the data vector, II. If the data vector is missing, the averages
will be computed just for resos.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>II</code></td>
<td>
<p>A vector of real quantities. This is the key quantity whose averages
and standard deviations are calculated. If <code>II</code> is set to <code>NULL</code>, resolutions
averages and standard deviations will be the calculated quantities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>Minimum (highest) resolution (in angstroms). Data with resolution smaller than m
will be ignored when calculating the averages.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>Maximum (lowest) resolution (in angstroms). Data with resolution larger than M
will be ignored when calculating the averages.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Binning is done with inverse resolutions in order to have lower resolutions
correspond to small numbers and high resolutions to large numbers. The output
<code>mids</code>, <code>ave</code> and <code>sd</code> correspond to inverse resolutions.
</p>


<h3>Value</h3>

<p>A named list of length 4. <code>counts</code> is a vector of integers, the number of
reflections in each resolution shell. <code>mids</code> is the representative inverse resolution
for each resolution shell; the value is decided by the function <code>hist</code>. <code>ave</code>
is the average value in each resolution shell and <code>sd</code> is the corresponding standard
deviation.
</p>


<h3>Examples</h3>

<pre><code class="language-R">datadir &lt;- system.file("extdata",package="cry")
filename &lt;- file.path(datadir,"1dei_phases.mtz")
lmtz &lt;- readMTZ(filename)
hkl &lt;- lmtz$reflections[,1:3]
II &lt;- lmtz$reflections[,4]
cpars &lt;- lmtz$header$CELL
resos &lt;- hkl_to_reso(hkl[,1],hkl[,2],hkl[,3],
                     cpars[1],cpars[2],cpars[3],
                     cpars[4],cpars[5],cpars[6])
ltmp &lt;- avei_vs_res(20,resos,II)
plot(ltmp$mids,ltmp$ave,type="b",pch=16)
</code></pre>


</div>