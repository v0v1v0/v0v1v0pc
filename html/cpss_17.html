<div class="container">

<table style="width: 100%;"><tr>
<td>cpss.custom</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Detecting changes in uers-customized models</h2>

<h3>Description</h3>

<p>Detecting changes in uers-customized models
</p>


<h3>Usage</h3>

<pre><code class="language-R">cpss.custom(
  dataset,
  n,
  g_subdat,
  g_param,
  g_cost,
  algorithm = "BS",
  dist_min = floor(log(n)),
  ncps_max = ceiling(n^0.4),
  pelt_pen_val = NULL,
  pelt_K = 0,
  wbs_nintervals = 500,
  criterion = "CV",
  times = 2,
  model = NULL,
  g_smry = NULL,
  easy_cost = NULL,
  param.opt = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dataset</code></td>
<td>
<p>an <code>ANY</code> object that could be a vector, matrix, tensor, list, etc.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>an integer indicating the sample size of the data <code>dataset</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g_subdat</code></td>
<td>
<p>a customized R function of two arguments <code>dat</code> and <code>indices</code>, which extracts a subset of data <code>dat</code> according to a collection of time indices <code>indices</code>. The returned object inherits the class from that of <code>dataset</code>. The argument <code>dat</code> inherits the class from that of <code>dataset</code>, and the argument <code>indices</code> is a logical vector with <code>TRUE</code>s indicating extracted indices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g_param</code></td>
<td>
<p>a customized R function of two arguments <code>dat</code> (cf. <code>dat</code> of <code>g\_subdat</code>) and <code>param.opt</code> (cf. <code>param.opt</code> of <code>cpss.custom</code>), which returns estimated parameters based on the data segment <code>dat</code>. It could return a numeric value, vector, matrix, list, etc.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g_cost</code></td>
<td>
<p>a customized R function of two arguments <code>dat</code> (cf. <code>dat</code> of <code>g\_subdat</code>) and <code>param</code>, which returns a numeric value of the associated cost for data segment <code>dat</code> with parameters <code>param</code>. The argument <code>param</code> inherits the class from that of the returned object of <code>g\_param</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>algorithm</code></td>
<td>
<p>a character string specifying the change-point searching algorithm, one of the following choices: "SN" (segment neighborhood), "BS" (binary segmentation), "WBS" (wild binary segmentation) and "PELT" (pruned exact linear time) algorithms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist_min</code></td>
<td>
<p>an integer specifying minimum searching distance (length of feasible segments).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncps_max</code></td>
<td>
<p>an integer specifying an upper bound of the number of true change-points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pelt_pen_val</code></td>
<td>
<p>a numeric vector specifying candidate values of the penalty only if <code>algorithm = "PELT"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pelt_K</code></td>
<td>
<p>a numeric value for pruning adjustment only if <code>algorithm = "PELT"</code>. It is usually taken to be 0 if the negative log-likelihood is used as a cost, see Killick et al. (2012).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wbs_nintervals</code></td>
<td>
<p>an integer specifying the number of random intervals drawn only if <code>algorithm = "WBS"</code>, see Fryzlewicz (2014).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>
<p>a character string specifying the model selection criterion, "CV" ("cross-validation") or "MS" ("multiple-splitting").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>
<p>an integer specifying how many times of sample-splitting should be performed; It should be 2 if <code>criterion = "CV"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a character string indicating the considered change model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g_smry</code></td>
<td>
<p>a customized R function of two arguments <code>dataset</code> (cf. <code>dataset</code> of <code>cpss.custom</code>) and <code>param.opt</code> (cf. <code>param.opt</code> of <code>cpss.custom</code>), which calculates the summary statistics that will be used for cost evaluation. The returned object is a list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>easy_cost</code></td>
<td>
<p>a customized R function of three arguments <code>data_smry</code>, <code>s</code> and <code>e</code>, which evaluates the value of the cost for a date segment form observed time point $s$ to $e$. The argument <code>data_smry</code> inherits the class from that of the returned object of <code>g_smry</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param.opt</code></td>
<td>
<p>an <code>ANY</code> object specifying additional constant parameters needed for parameter estimation or cost evaluation beyond unknown parameters.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>cpss.custom</code> returns an object of an S4 class, called "<code>cpss</code>", which collects data and information required for further change-point analyses and summaries.
</p>

<dl>
<dt><code>dat</code></dt>
<dd>
<p>data set</p>
</dd>
<dt><code>mdl</code></dt>
<dd>
<p>considered change-point model</p>
</dd>
<dt><code>algo</code></dt>
<dd>
<p>change-point searching algorithm</p>
</dd>
<dt><code>algo_param_dim</code></dt>
<dd>
<p>user-specified upper bound of the number of true change-points if <code>algorithm = "SN"/"BS"/"WBS"</code>, or user-specified candidate values of the penalty only if <code>algorithm = "PELT"</code></p>
</dd>
<dt><code>SC</code></dt>
<dd>
<p>model selection criterion</p>
</dd>
<dt><code>ncps</code></dt>
<dd>
<p>estimated number of change-points</p>
</dd>
<dt><code>pelt_pen</code></dt>
<dd>
<p>selected value of the penalty only if <code>algorithm = "PELT"</code></p>
</dd>
<dt><code>cps</code></dt>
<dd>
<p>a vector of estimated locations of change-points</p>
</dd>
<dt><code>params</code></dt>
<dd>
<p>a list object, each member is a list containing estimated parameters in the associated data segment</p>
</dd>
<dt><code>S_vals</code></dt>
<dd>
<p>a numeric vector of candidate model dimensions in terms of a sequence of numbers of change-points or values of the penalty</p>
</dd>
<dt><code>SC_vals</code></dt>
<dd>
<p>a numeric matrix, each column records the values of the  criterion based on the validation data split under the corresponding model dimension (<code>S_vals</code>), and each row represents a splitting at each time</p>
</dd>
</dl>
<h3>References</h3>

<p>Killick, R., Fearnhead, P., and Eckley, I. A. (2012). Optimal Detection of Changepoints With a Linear Computational Cost. Journal of the American Statistical Association, 107(500): 1590–1598.
</p>
<p>Fryzlewicz, P. (2014). Wild binary segmentation for multiple change-point detection. The Annals of Statistics, 42(6): 2243–2281.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library("cpss")
g_subdat_l1 &lt;- function(dat, indices) {
  dat[indices]
}
g_param_l1 &lt;- function(dat, param.opt = NULL) {
  return(median(dat))
}
g_cost_l1 &lt;- function(dat, param) {
  return(sum(abs(dat - param)))
}
res &lt;- cpss.custom(
  dataset = well, n = length(well),
  g_subdat = g_subdat_l1, g_param = g_param_l1, g_cost = g_cost_l1,
  ncps_max = 11
)
summary(res)
plot(well)
abline(v = res@cps, col = "red")

</code></pre>


</div>