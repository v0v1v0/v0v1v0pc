<div class="container">

<table style="width: 100%;"><tr>
<td>cusp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Fit a Cusp Catastrophe Model to Data </h2>

<h3>Description</h3>

<p>This function fits a cusp catastrophe model to data using the maximum likelihood method of Cobb. Both the state variable may be modeled by a linear combination of variables and design factors, as well as the normal/asymmetry factor <code>alpha</code> and bifurction/splitting factor <code>beta</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cusp(formula, alpha, beta, data, weights, offset, ..., control =
    glm.control(), method = "cusp.fit", optim.method = "L-BFGS-B", model = TRUE,
    contrasts = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
 <p><code>formula</code> that models the canonical state variable </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
 <p><code>formula</code> that models the canonical normal/asymmetry factor </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
 <p><code>formula</code> that models the canonical bifurcation/splitting factor </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
 <p><code>data.frame</code> that contains all the variables named in the formulas </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p> vector of weights by which each data point is weighted (experimental) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p> vector of offsets for the data (experimental) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> named arguments that are passed to <code>optim</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
 <p><code>glm.control</code> object, currently unused </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p> string, currently unused </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optim.method</code></td>
<td>
<p> string passed to <code>optim</code> to choose the optimization algorithm </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p> should the model matrix be returned? </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p> matrix of <code>contrasts</code>, experimental </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>cusp</code> fits a cusp catastrophe model to data. Cobb's definition for the canonical form of the stochastic cusp catastrophe is the stochastic differential equation </p>
<p style="text-align: center;"><code class="reqn">dY_t = (\alpha + \beta Y_t - Y_t^3)dt + dW_t.</code>
</p>
<p> The stationary distribution of the ‘behavioral’, or ‘state’ variable <code class="reqn">Y</code>, given the control parameters <code class="reqn">\alpha</code> (‘asymmetry’ or ‘normal’ factor) and <code class="reqn">\beta</code> (‘bifurcation’ or ‘splitting’ factor) is </p>
<p style="text-align: center;"><code class="reqn"> f(y) = \Psi \exp(\alpha y + \beta y^2/2 - y^4/4), </code>
</p>
<p> where <code class="reqn">\Psi</code> is a normalizing constant.
</p>
<p>The behavioral variable and the asymmetry and bifurcation factors are usually not directly related to the dependent and independent variables in the data set. These are therefore used to predict the state variable and control parameters:
</p>
<p style="text-align: center;"><code class="reqn">y_i = w_0 + w_1 Y_{i1} + \cdots + w_p Y_{ip}</code>
</p>

<p style="text-align: center;"><code class="reqn">\alpha_i = a_0 + a_1 X_{i1} + \cdots + a_p X_{ip}</code>
</p>

<p style="text-align: center;"><code class="reqn">\beta_i = b_0 + b_1 X_{i1} + \cdots + b_q X_{iq}</code>
</p>

<p>in which the <code class="reqn">a_j</code>'s, <code class="reqn">b_j</code>'s, and <code class="reqn">w_j</code>'s are estimated by means of maximum likelihood.
Here, the <code class="reqn">Y_{ij}</code>'s and <code class="reqn">X_{ij}</code>'s are variables constructed from variables in the data set. Variables predicting the <code class="reqn">\alpha</code>'s and <code class="reqn">\beta</code>'s need not be the same.
</p>
<p>The state variable and control parameters can be modeled by specifying a model <code>formula</code>: </p>
<p style="text-align: center;"><code class="reqn">\code{y ~ model},</code>
</p>
 <p style="text-align: center;"><code class="reqn">\code{alpha ~ model},</code>
</p>
 <p style="text-align: center;"><code class="reqn">\code{beta ~ model},</code>
</p>
<p> in which <code>model</code> can be any valid <code>formula</code> specified in terms of variables that are present in the <code>data.frame</code>.
</p>


<h3>Value</h3>


<p>List with components
</p>
<table><tr style="vertical-align: top;">
<td><code> coefficients </code></td>
<td>
<p>Estimated coefficients </p>
</td>
</tr></table>
<table>
<tr style="vertical-align: top;">
<td><code> rank </code></td>
<td>
<p>rank of Hessian matrix </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> qr </code></td>
<td>
<p><code>qr</code> decomposition of the Hessian matrix </p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code> linear.predictors </code></td>
<td>
<p>two column matrix containing the <code class="reqn">\alpha_i</code>'s and <code class="reqn">\beta_i</code>'s for each case </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> deviance </code></td>
<td>
<p>sum of squared errors using Delay convention </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> aic </code></td>
<td>
<p> AIC </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> null.deviance </code></td>
<td>
<p>variance of canonical state variable </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> iter </code></td>
<td>
<p> number of optimization iterations </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> weights </code></td>
<td>
<p> weights provided through weights argument </p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code> df.residual </code></td>
<td>
<p> residual degrees of freedom </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> df.null </code></td>
<td>
<p> degrees of freedom of constant model for state variable </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> y </code></td>
<td>
<p> predicted values of state variable </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> converged </code></td>
<td>
<p> convergence status given by <code>optim</code> </p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code> par </code></td>
<td>
<p> parameter estimates for <code>qr</code> standardized data </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> Hessian </code></td>
<td>
<p>Hessian matrix of negative log likelihood function at minimum </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> hessian.untransformed </code></td>
<td>
<p> Hessian matrix of negative log likelihood for <code>qr</code> standardized data </p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code> code </code></td>
<td>
<p><code>optim</code> convergence indicator </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> model </code></td>
<td>
<p>list with model design matrices </p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code> call </code></td>
<td>
<p>function call that created the object </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> formula </code></td>
<td>
<p>list with the formulas </p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code> OK </code></td>
<td>
<p> logical. <code>TRUE</code> if Hessian matrix is positive definite at the minimum obtained </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> data </code></td>
<td>
<p>original data.frame </p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Raoul Grasman </p>


<h3>References</h3>

<p> See cusp-package  </p>


<h3>See Also</h3>

 <p><code>cusp-package</code>.
</p>
<p><code>summary.cusp</code> for summaries and model assessment.
</p>
<p>The generic functions <code>coef</code>, <code>effects</code>, <code>residuals</code>, <code>fitted</code>, <code>vcov</code>.
</p>
<p><code>predict</code> for estimated values of the control parameters <code class="reqn">\alpha[i]</code> and <code class="reqn">\beta[i]</code>,
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(123)
# example with regressors
x1 = runif(150)
x2 = runif(150)
z = Vectorize(rcusp)(1, 4*x1-2, 4*x2-1)
data &lt;- data.frame(x1, x2, z)
fit &lt;- cusp(y ~ z, alpha ~ x1+x2, beta ~ x1+x2, data)
print(fit)
summary(fit)
## Not run: 
plot(fit)
cusp3d(fit)

## End(Not run)

# useful use of OK
## Not run: 
while(!fit$OK)
    fit &lt;- cusp(y ~ z, alpha ~ x1+x2, beta ~ x1+x2, data,
            start=rnorm(fit$par)) # use different starting values

## End(Not run)
</code></pre>


</div>