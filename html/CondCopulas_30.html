<div class="container">

<table style="width: 100%;"><tr>
<td>estimateCondQuantiles</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute kernel-based conditional quantiles</h2>

<h3>Description</h3>

<p>This function is supposed to be used with <code>computeKernelMatrix</code>.
Assume that we observe a sample <code class="reqn">(X_{i,1}, X_{i,3}), i=1, \dots, n</code>.
We want to estimate the conditional quantiles of <code class="reqn">X_1</code> given <code class="reqn">X_3 = x_3</code>
at point <code class="reqn">u_1</code> using the following kernel-based estimator
</p>
<p style="text-align: center;"><code class="reqn">\hat Q(u_1 | X_3 = x_3) := \hat P^{(-1)}(u_1 \leq x_1 | X_3 = x_3),</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">\hat P(X_1 \leq x_1 | X_3 = x_3)
:= \frac{\sum_{l=1}^n 1 \{X_(l,1) \leq x_1 \} K_h(X_(l,3) - x_3)}
{\sum_{l=1}^n K_h(X_(l,3) - x_3)},</code>
</p>

<p>for every <code class="reqn">u_1</code> in <code>probsX1</code> and every <code class="reqn">x_3</code> in <code>newX3</code>.
The <code>matrixK3</code> should be a matrix of the values <code class="reqn">K_h(X_(l,3) - x_3)</code>
such as the one produced by
<code>computeKernelMatrix(observedX3, newX3, kernel, h)</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">estimateCondQuantiles(observedX1, probsX1, matrixK3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>observedX1</code></td>
<td>
<p>a sample of observations of X1 of size n</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probsX1</code></td>
<td>
<p>a sample of probabilities at which we want to compute
the quantiles for the variable X1, of size p1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>matrixK3</code></td>
<td>
<p>a matrix of kernel values of dimension (p2 , n)
<code class="reqn">\big(K_h(X3[i] - U3[j])\big)_{i,j}</code>
such as given by <code>computeKernelMatrix</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A matrix of dimensions <code>(p1,p2)</code> whose (i,j) entry is <code class="reqn">\hat Q(u_1 | X_3 = x_3)</code>
with <code class="reqn">u_1</code> = <code>probsX1[i]</code> and <code class="reqn">x_3</code> = <code>newX3[j]</code>,
where <code>newX3[j]</code> is the vector that was used to construct <code>matrixK3</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">Y = MASS::mvrnorm(n = 100, mu = c(0,0), Sigma = cbind(c(1, 0.9), c(0.9, 1)))
matrixK = computeKernelMatrix(observedX = Y[,2] , newX = c(0, 1, 2.5),
  kernel = "Gaussian", h = 0.8)
matrixnp = estimateCondQuantiles(observedX1 = Y[,2],
  probsX1 = c(0.3, 0.5) , matrixK3 = matrixK)
matrixnp

</code></pre>


</div>