<div class="container">

<table style="width: 100%;"><tr>
<td>mixalg.EM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>EM algorithm</h2>

<h3>Description</h3>

<p>In the fixed support size case the number of components <code>k</code> is assumed to
be known. Here the unknown parameters are the mixing weights <code>p[j]</code> and the
parameters <code>lambda[j]</code> of the subpopulation.<br></p>
<p>Estimation of these models' parameters is usually achieved by application
of the EM algorithm.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mixalg.EM (mix = NULL, p, t, obs = NULL, weights = NULL, family = "gaussian", 
    data = NULL, pop.at.risk = NULL, var.lnOR = NULL, limit = 0.01, 
    acc = 10^(-7), numiter = 5000)    
</code></pre>


<h3>Arguments</h3>

  
<table>
<tr style="vertical-align: top;">
<td><code>mix</code></td>
<td>

<p>A CAMAN-object which quantifies a finite mixture model and the input data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p> vector containing the starting values for p</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p> vector containing the starting values for the distribution specific parameters (poisson-&gt;<code class="reqn">\lambda</code>, gaussian-&gt; <code class="reqn">\mu</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs</code></td>
<td>

<p>observed / dependent variable. Vector or colname of <code>data</code>. Must be specified!
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>

<p>weights of the data. Vector or colname of <code>data</code>. Default is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>

<p>the underlying type density function as a character ("gaussian", "poisson" or "binomial")!
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>an optional data frame. <code>obs</code>, <code>weights</code>, <code>pop.at.risk</code> and <code>var.lnOR</code> can be specified as column name of the data frame. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pop.at.risk</code></td>
<td>

<p>population at risk: These data could be used to determine a mixture model for Poisson data. Vector or colname of <code>data</code>. Default is<code>NULL</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.lnOR</code></td>
<td>

<p>variances of the data: These variances might be given when working with meta analyses! Vector or colname of <code>data</code>. Default is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>limit</code></td>
<td>

<p>parameter to control the limit of union several components. Default is 0.01.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>acc</code></td>
<td>

<p>convergence criterion. VEM and EM loops stop when deltaLL&lt;acc. Default is 10^(-7). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numiter</code></td>
<td>

<p>parameter to control the maximal number of iterations in the VEM and EM loops. Default is 5000. 
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function returns a <code>CAMAN.object</code> object, thus the same as mixalg!
</p>


<h3>Author(s)</h3>

<p>Peter Schlattmann and Johannes Hoehne   
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(vitA)
m1&lt;-mixalg.EM(obs="logrr",var.lnOR="var" ,family="gaussian",
              p=c(1),t=c(0),data=vitA)
m2&lt;-mixalg.EM(obs="logrr",var.lnOR="var" ,family="gaussian",
              p=c(0.5,0.5),t=c(-0.3,0.2),data=vitA)

# apply EM-algorithm on an existing CAMAN.object: 
data(thai_cohort)
mix0 &lt;- mixalg(obs="counts", weights="frequency", family="poisson", 
               data=thai_cohort, numiter=18000, acc=0.00001,startk=25)
em0&lt;-mixalg.EM(mix0,p=c(1),t=c(1))
em1&lt;-mixalg.EM(mix0,p=c(0.7,0.3),t=c(2,9))

</code></pre>


</div>