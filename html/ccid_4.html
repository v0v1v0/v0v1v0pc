<div class="container">

<table style="width: 100%;"><tr>
<td>match.cpt.ts</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Associating the change-points with the component time series</h2>

<h3>Description</h3>

<p>This function performs a contrast function based approach in order to
match each change-point and time series. In simple terms, for a given
change-point set this function associates each change-point with the
respective data sequence (or sequences) from which it was detected.
</p>


<h3>Usage</h3>

<pre><code class="language-R">match.cpt.ts(
  X,
  cpt,
  thr_const = 1,
  thr_fin = thr_const * sqrt(2 * log(nrow(X))),
  scales = -1,
  count = 5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A numerical matrix representing the multivariate periodograms.
Each column contains a different periodogram which is the result of
applying the wavelet transformation to the initial multivariate time
series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cpt</code></td>
<td>
<p>A positive integer vector with the locations of the
change-points. If missing, then our approach with the <code class="reqn">L_2</code>
aggregation is called internally to extract the change-points in
<code>X</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thr_const</code></td>
<td>
<p>A positive real number with default value equal to 1. It is
used to define the threshold; see <code>thr_fin</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thr_fin</code></td>
<td>
<p>With <code>T</code> the length of the data sequence, this is a
positive real number with default value equal to
<code>thr_const * log(T)</code>. It is the threshold, which is used in the
detection process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scales</code></td>
<td>
<p>Negative integers for the wavelet scales used to create the periodograms,
with a small negative integer representing a fine scale. The default value is equal
to -1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>count</code></td>
<td>
<p>Positive integer with default value equal to 5. It can be used
so that the function will return only the <code>count</code> most important
matches of each change-points with the time series.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the following components:
</p>

<table>
<tr>
<td style="text-align: left;">
   </td>
</tr>
<tr>
<td style="text-align: left;"> <code>time_series_indicator</code> </td>
<td style="text-align: left;"> A list of matrices. There are as many matrices as
   </td>
</tr>
<tr>
<td style="text-align: left;"> </td>
<td style="text-align: left;"> the number of change-points. Each change-point has its own matrix, with
   </td>
</tr>
<tr>
<td style="text-align: left;"> </td>
<td style="text-align: left;"> each row of the matrix representing the associated combination of time
   </td>
</tr>
<tr>
<td style="text-align: left;"> </td>
<td style="text-align: left;"> series that are associated with the respective change-point.
   </td>
</tr>
<tr>
<td style="text-align: left;"> <code>most_important</code> </td>
<td style="text-align: left;"> A list of matrices. There are as many matrices as
   </td>
</tr>
<tr>
<td style="text-align: left;"> </td>
<td style="text-align: left;"> the number of change-points. Each change-point has its own matrix, with
   </td>
</tr>
<tr>
<td style="text-align: left;"> </td>
<td style="text-align: left;"> each row of the matrix representing the associated combination of time
   </td>
</tr>
<tr>
<td style="text-align: left;"> </td>
<td style="text-align: left;"> series that are associated with the respective change-point. It shows the
   </td>
</tr>
<tr>
<td style="text-align: left;"> </td>
<td style="text-align: left;"> <code>count</code> most important time series combinations for each change-point.
 </td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Andreas Anastasiou, <a href="mailto:anastasiou.andreas@ucy.ac.cy">anastasiou.andreas@ucy.ac.cy</a>
</p>


<h3>References</h3>

<p>“Cross-covariance isolate detect: a new change-point method
for estimating dynamic functional connectivity”, Anastasiou et al (2020),
preprint &lt;doi:10.1101/2020.12.20.423696&gt;.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  set.seed(1)
  num.nodes &lt;- 40 # number of nodes
  etaA.1    &lt;- 0.95
  etaA.2    &lt;- 0.05
  pcor1     &lt;- GeneNet::ggm.simulate.pcor(num.nodes, etaA = etaA.1)
  pcor2     &lt;- GeneNet::ggm.simulate.pcor(num.nodes, etaA = etaA.2)

  n &lt;- 100
  data1 &lt;- GeneNet::ggm.simulate.data(n, pcor1)
  data2 &lt;- GeneNet::ggm.simulate.data(n, pcor2)
  X &lt;- rbind(data1, data2, data1, data2) ## change-points at 100, 200, 300
  sgn &lt;- sign(stats::cor(X))
  M1 &lt;- match.cpt.ts(t(hdbinseg::gen.input(x = t(X),scales = -1, sq = TRUE,
  diag = FALSE, sgn = sgn)))
  M1
</code></pre>


</div>