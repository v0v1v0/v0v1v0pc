<div class="container">

<table style="width: 100%;"><tr>
<td>predict.cgam</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Predict Method for CGAM Fits</h2>

<h3>Description</h3>

<p>Predicted values based on a cgam object</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'cgam'
predict(object, newData, interval = c("none", "confidence", "prediction"), 
type = c("response", "link"), level = 0.95, n.mix = 500,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A cgam object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newData</code></td>
<td>
<p>A data frame in which to look for variables with which to predict. If omitted, the fitted values are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interval</code></td>
<td>
<p>Type of interval calculation. A prediction interval is only implemented for Gaussian response for now.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>If the response is Gaussian, type = "response" gives the predicted mean; if the response is binomial, type = "response" gives the predicted probabilities, and type = "link" gives the predicted systematic component.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>Tolerance/confidence level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.mix</code></td>
<td>
<p>Number of simulations to get the mixture distribution. The default is n.mix = 500.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to the routine.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Constrained spline estimators can be characterized by projections onto a polyhedral convex cone. Point-wise confidence intervals for constrained splines are constructed by estimating the probabilities that the projection lands on each of the faces of the cone, and using a mixture of covariance matrices to estimate the standard error of the function estimator at any design point. 
</p>
<p>Note that currently predict.cgam only works when all components in a cgam formula are additive.
</p>
<p>See references cited in this section for more details.	
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>A vector of predictions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>A vector of lower bound if interval is set to be "confidence".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>A vector of upper bound if interval is set to be "confidence".</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Mary C. Meyer and Xiyue Liao
</p>


<h3>References</h3>

<p>Meyer, M. C. (2017) Constrained partial linear regression splines. <em>Statistical Sinica in press</em>.
</p>
<p>Meyer, M. C. (2017) Confidence intervals for regression functions using constrained
splines with application to estimation of tree height
</p>
<p>Meyer, M. C. (2012) Constrained penalized splines. <em>Canadian Journal of Statistics <b>40(1)</b></em>, 190–206.
</p>
<p>Meyer, M. C. (2008) Inference using shape-restricted regression splines. <em>Annals of Applied Statistics <b>2(3)</b></em>, 1013–1033.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Example 1.
	# generate data
	n &lt;- 100
	set.seed(123)
	x &lt;- runif(n)
	y &lt;- 4*x^3 + rnorm(n)

	# regress y on x under the shape-restriction: "increasing-convex"
	fit &lt;- cgam(y ~ s.incr.conv(x))
	
	# make a data frame 
	x0 &lt;- seq(min(x), max(x), by = 0.05)
	new.Data &lt;- data.frame(x = x0)

	# predict values in new.Data based on the cgam fit without a confidence interval
	pfit &lt;- predict(fit, new.Data)
	
	# or 
	pfit &lt;- predict(fit, new.Data, interval = "none")
	
	# make a plot to check the prediction
	plot(x, y, main = "Predict Method for CGAM")
	lines(sort(x), (fitted(fit)[order(x)]))
	points(x0, pfit$fit, col = 2, pch = 20)

	# predict values in new.Data based on the cgam fit with a 95 percent confidence interval
	pfit &lt;- predict(fit, new.Data, interval = "confidence", level = 0.95)

	# make a plot to check the prediction
	plot(x, y, main = "Pointwise Confidence Bands (Gaussian Response)")
	lines(sort(x), (fitted(fit)[order(x)]))
	lines(sort(x0), (pfit$lower)[order(x0)], col = 2, lty = 2)
	lines(sort(x0), (pfit$upper)[order(x0)], col = 2, lty = 2)
	points(x0, pfit$fit, col = 2, pch = 20)

# Example 2. binomial response
	n &lt;- 200
	x &lt;- seq(0, 1, length = n)

	eta &lt;- 4*x - 2
	mu &lt;- exp(eta)/(1+exp(eta))
	set.seed(123)
	y &lt;- 1:n*0
	y[runif(n)&lt;mu] = 1
        
	fit &lt;- cgam(y ~ s.incr.conv(x), family = binomial)
	muhat &lt;- fitted(fit)
	
    # predict values in new.Data based on the cgam fit with a 95 percent confidence interval
    xinterp &lt;- seq(min(x), max(x), by = 0.05)
    new.Data &lt;- data.frame(x = xinterp)
	pfit &lt;- predict(fit, new.Data, interval = "confidence", level = 0.95)
	pmu &lt;- pfit$fit
	lwr &lt;- pfit$lower
	upp &lt;- pfit$upper
	
	# make a plot to check the prediction	
	plot(x, y, type = "n", ylim = c(0, 1), 
	main = "Pointwise Confidence Bands (Binomial Response)")
	rug(x[y == 0])
    rug(x[y == 1], side = 3)   
	lines(x, mu)
	lines(x, muhat, col = 5, lty = 2)
       
	points(xinterp, pmu, pch = 20)
	lines(xinterp, upp, col = 5)
	points(xinterp, upp, pch = 20)
	lines(xinterp, lwr, col = 5)
	points(xinterp, lwr, pch = 20)
</code></pre>


</div>