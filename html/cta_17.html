<div class="container">

<table style="width: 100%;"><tr>
<td>M.fct</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Marginalizing Matrix Based on Strata Information
</h2>

<h3>Description</h3>

<p>Creates the marginalizing matrix <code class="reqn">M</code> using strata information found in input variable <code>strata</code>. That is, <code class="reqn">Mp</code> gives the marginal probabilities corresponding to the levels of factor <code>strata</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">M.fct(strata, ncells = length(strata))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>strata</code></td>
<td>
<p>The vector that gives the stratum membership identifier.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncells</code></td>
<td>
<p>Number of contingency table cells. Default:
<code>ncells = length(strata)</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>M.fct</code> returns the marginalizing matrix <code>M</code>.
</p>


<h3>Note</h3>

<p>Marginals are ordered according to the levels of factor
<code>strata</code>.
</p>
<p>Examples:
</p>

<table>
<tr>
<td style="text-align: center;">
  <code>V1</code>  </td>
<td style="text-align: right;">  <code>V2</code>  </td>
<td style="text-align: right;">    <code>y</code>
</td>
</tr>
<tr>
<td style="text-align: center;">
  <code>b</code> </td>
<td style="text-align: right;">   <code>yes</code>  </td>
<td style="text-align: right;">   <code>15</code>
</td>
</tr>
<tr>
<td style="text-align: center;">
 <code>a</code>  </td>
<td style="text-align: right;">   <code>no</code> </td>
<td style="text-align: right;">    <code>12</code>
</td>
</tr>
<tr>
<td style="text-align: center;">
  <code>a</code> </td>
<td style="text-align: right;">   <code>yes</code>  </td>
<td style="text-align: right;">   <code>13</code>
</td>
</tr>
<tr>
<td style="text-align: center;">
 <code>b</code> </td>
<td style="text-align: right;">   <code>yes</code>   </td>
<td style="text-align: right;">     <code>5</code>
</td>
</tr>
<tr>
<td style="text-align: center;">
  <code>b</code> </td>
<td style="text-align: right;">    <code>no</code>  </td>
<td style="text-align: right;">   <code>1</code>
</td>
</tr>
<tr>
<td style="text-align: center;">
</td>
</tr>
</table>
<p><code>M1 &lt;- M.fct(V1)</code><br><code>M1 %*% y</code><br></p>

<table>
<tr>
<td style="text-align: right;">
</td>
<td style="text-align: right;"> <code>[,1]</code>
</td>
</tr>
<tr>
<td style="text-align: right;">
<code>a</code> </td>
<td style="text-align: right;">  <code>25</code>
</td>
</tr>
<tr>
<td style="text-align: right;">
<code>b</code> </td>
<td style="text-align: right;">  <code>21</code>
</td>
</tr>
<tr>
<td style="text-align: right;">
</td>
</tr>
</table>
<p><code>M2 &lt;- M.fct(V2)</code><br><code>M2 %*% y</code><br></p>

<table>
<tr>
<td style="text-align: right;">
</td>
<td style="text-align: right;"> <code>[,1]</code>
</td>
</tr>
<tr>
<td style="text-align: right;">
<code>no</code> </td>
<td style="text-align: right;">  <code>13</code>
</td>
</tr>
<tr>
<td style="text-align: right;">
<code>yes</code> </td>
<td style="text-align: right;">  <code>33</code>
</td>
</tr>
<tr>
<td style="text-align: right;">
</td>
</tr>
</table>
<p><code>M12 &lt;- M.fct(paste(V1, V2))</code><br><code>M12 %*% y</code>
</p>

<table>
<tr>
<td style="text-align: right;">
</td>
<td style="text-align: right;"> </td>
<td style="text-align: right;"> <code>[,1]</code>
</td>
</tr>
<tr>
<td style="text-align: right;">
<code>a</code> </td>
<td style="text-align: right;"> <code>no</code> </td>
<td style="text-align: right;">  <code>12</code>
</td>
</tr>
<tr>
<td style="text-align: right;">
<code>a</code> </td>
<td style="text-align: right;"> <code>yes</code>  </td>
<td style="text-align: right;"> <code>13</code>
</td>
</tr>
<tr>
<td style="text-align: right;">
<code>b</code> </td>
<td style="text-align: right;"> <code>no</code>   </td>
<td style="text-align: right;"> <code>1</code>
</td>
</tr>
<tr>
<td style="text-align: right;">
<code>b</code> </td>
<td style="text-align: right;"> <code>yes</code>  </td>
<td style="text-align: right;">  <code>20</code>
</td>
</tr>
<tr>
<td style="text-align: right;">
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Joseph B. Lang
</p>


<h3>References</h3>

<p>Lang, J. B. (2004) Multinomial-Poisson homogeneous models for contingency tables, <em>Annals of Statistics</em>, <b>32</b>, 340â€“383.
</p>


<h3>Examples</h3>

<pre><code class="language-R">M.fct(rep(1, 9))
M.fct(seq(1, 9))
M.fct(c(1, 1, 2, 3, 3))
</code></pre>


</div>