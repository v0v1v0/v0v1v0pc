<div class="container">

<table style="width: 100%;"><tr>
<td>coxseiInt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>

Calculate the estimator of the cumulative baseline intensity function
in the CoxSEI model.
</h2>

<h3>Description</h3>


<p>It takes the paramter of the parametric part (or its theorized value)
and calculate the values of the estimator at the jump times; it also
gives the values of the estimator for the variance of the intensity
estimator. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">coxseiInt(dat, parest, hessian=NULL, vcovmat=solve(hessian), m = 2,
          gfun = function(x, pa) {
            ifelse(x &lt;= 0, 0, pa[1] * pa[2] * exp(-pa[2] * x))
          },
          gfungrd = function(x, pa){
            if(length(x)==0)return(matrix(0,2,0));
            rbind(pa[2]*exp(-pa[2]*x),
                  pa[1]*exp(-pa[2]*x)*(1-pa[2]*x)
                 )
          })
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>


<p>a data frame containing the right-censored counting process data 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parest</code></td>
<td>


<p>the estimate of parameter of the parametric part of the CoxSEI model
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hessian</code></td>
<td>

<p>the hessian matrix returned by the optimization procedure in the
estimation of the parametric part based on partial likelihood
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcovmat</code></td>
<td>

<p>the variance-covariance matrix of the estimator of the the
parametric components; defaulted to the inverse of the hessian
matrix
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>


<p>autoregressive order in the excitation part of the intensity
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gfun</code></td>
<td>


<p>the excitation function; defaults to the exponential decay function
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gfungrd</code></td>
<td>

<p>derivative/gradient function of the excitation function
</p>
</td>
</tr>
</table>
<h3>Value</h3>






<p>a list giving the jump times and values at these of the estimator of the
cumulative baseline intensity function.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> the ordered death/event times</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p> the value of the estimator of the intensity function at the
observed death/event times</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varest</code></td>
<td>
<p> the value of the estimator of the variance of the
estimator of the intensity function, at the jump times
</p>
</td>
</tr>
</table>
<p>The step function can be obtained using <code>stepfun</code>, and plotted by setting
<code>type="s"</code> in the <code>plot</code> function.
</p>


<h3>Note</h3>


<p>Currently doesn't compute the standard error or variance estimator of
the baseline cumulative intensity estimator. 
</p>


<h3>Author(s)</h3>


<p>Feng Chen &lt;feng.chen@unsw.edu.au&gt;  
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("dat")
est &lt;- coxseiest3(dat,c(0.2,0.4,0.6,log(0.06),log(5)))
pe &lt;- est$par; pe[4:5] &lt;- exp(pe[4:5]);
ve &lt;- diag(pe) %*% solve(est$hessian, diag(pe));
cintest &lt;- coxseiInt(dat,pe,vcovmat=ve)
plot(cintest,type="s")
</code></pre>


</div>