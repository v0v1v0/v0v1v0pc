<div class="container">

<table style="width: 100%;"><tr>
<td>smooth_with_cutoffs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Identify and smooth-out anomalous gradient values</h2>

<h3>Description</h3>

<p>When <code>distance_cutoff</code> and <code>gradient_cutoff</code> thresholds are both broken
for route segments, this function treats them as anomalous and
sets the offending gradient values to the mean of the <code>n</code>
segments closest to (in front of and behind) the offending segment.
</p>


<h3>Usage</h3>

<pre><code class="language-R">smooth_with_cutoffs(
  gradient_segment,
  elevation_change,
  distances,
  distance_cutoff = 50,
  gradient_cutoff = 0.1,
  n = 3,
  warnNA = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>gradient_segment</code></td>
<td>
<p>The gradient for each segment from CycleStreets.net</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>elevation_change</code></td>
<td>
<p>The difference between the maximum and minimum elevations within each segment</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distances</code></td>
<td>
<p>The distance of each segment</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance_cutoff</code></td>
<td>
<p>Distance (m) used to identify anomalous gradients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gradient_cutoff</code></td>
<td>
<p>Gradient (%, e.g. 0.1 being 10%) used to identify anomalous gradients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The number of segments to use to smooth anomalous gradents.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warnNA</code></td>
<td>
<p>Logical should NA warning be given?
The default is 3, meaning segments directly before, after and including the offending segment.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">f = system.file(package = "cyclestreets", "extdata/journey.json")
rsf = json2sf_cs(readLines(f))
rsf$gradient_segment
rsf$elevation_change
rsf$distances
smooth_with_cutoffs(rsf$gradient_segment, rsf$elevation_change, rsf$distances)
smooth_with_cutoffs(rsf$gradient_segment, rsf$elevation_change, rsf$distances, 20, 0.05)
smooth_with_cutoffs(rsf$gradient_segment, rsf$elevation_change, rsf$distances, 200, 0.02)
smooth_with_cutoffs(rsf$gradient_segment, rsf$elevation_change, rsf$distances, 200, 0.02, n = 5)
</code></pre>


</div>