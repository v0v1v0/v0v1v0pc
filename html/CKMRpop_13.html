<div class="container">

<table style="width: 100%;"><tr>
<td>find_ancestors_and_relatives_of_samples</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Find ancestors and relative of each sampled member of a pedigree</h2>

<h3>Description</h3>

<p>This is a fairly general function that can be applied to pedigree output
from any simulation program.  It calls a function written in C++ to
do all the recursive pedigree searching.
</p>


<h3>Usage</h3>

<pre><code class="language-R">find_ancestors_and_relatives_of_samples(P, S, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>a tibble that gives the pedigree.  It must have the columns <code>kid</code>, <code>pa</code>, <code>ma</code>.
These columns must be character vectors of the unique IDs for each individual in
the pedigree.
Every individual in the pedigree must appear exactly once in the <code>kid</code> column.  When founders
appear in the pedigree, their <code>pa</code> and <code>ma</code> entries must be "0" (i.e. character zero).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>a vector of the IDs of the sampled individuals.  Obviously, all members of S must appear
in P.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of generations back from the sampled individuals to return in each
individual's ancestor vector. 0 = self, 1 =  back to and including the parents,
2 = back to and including the grandparents, and so on.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A tibble with three columns:
</p>

<ul>
<li> <p><code>sample_id</code>: the ID names of the sampled individuals
</p>
</li>
<li> <p><code>ancestors</code>: a list column.  Each element is a vector of the ids of the ancestors of the
sampled individual in the 2^(n+1) - 1 positions.  The first is the sampled individual, the second
is pa, third is ma, fourth is pa's pa, fifth is pa's ma, sixth is ma's pa, and so forth.
</p>
</li>
<li> <p><code>relatives</code>: a list column. Each element is a vector of the ids of the individuals that are <em>sampled</em> relatives
within the n generations.  The first element is the sampled individual itself, and the remaining
ones are all the relatives of that individual whom were also sampled.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R"># get some input variables
P &lt;- three_pops_with_mig_slurped_results$pedigree
S &lt;- three_pops_with_mig_slurped_results$samples$ID
n &lt;- 2
result &lt;- find_ancestors_and_relatives_of_samples(P, S, n)
result
</code></pre>


</div>