<div class="container">

<table style="width: 100%;"><tr>
<td>clustSE</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cluster robust standard errors with degrees of freedom adjustments (for lm and glm objects)</h2>

<h3>Description</h3>

<p>Function to compute the CR0, CR1, CR2 cluster
robust standard errors (SE) with Bell and McCaffrey (2002)
degrees of freedom (df) adjustments. Useful when dealing with datasets with a few clusters.
Shows output using different CR types and degrees of freedom choices (for comparative purposes only).
For linear and logistic regression models (as well as other GLMs). Computes the BRL-S2 variant.
</p>


<h3>Usage</h3>

<pre><code class="language-R">clustSE(mod, clust = NULL, digits = 3, ztest = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mod</code></td>
<td>
<p>The <code>lm</code> model object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clust</code></td>
<td>
<p>The cluster variable (with quotes).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>Number of decimal places to display.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ztest</code></td>
<td>
<p>If a normal approximation should be used as the naive degrees of freedom. If FALSE, the between-within degrees of freedom will be used.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A data frame with the CR adjustments with p-values.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>The regression coefficient.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.unadj</code></td>
<td>
<p>The model-based (regular, unadjusted) SE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CR0</code></td>
<td>
<p>Cluster robust SE based on Liang &amp; Zeger (1986).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CR1</code></td>
<td>
<p>Cluster robust SE (using an adjustment based on number of clusters).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CR2</code></td>
<td>
<p>Cluster robust SE based on Bell and McCaffrey (2002).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tCR2</code></td>
<td>
<p>t statistic based on CR2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dfn</code></td>
<td>
<p>Degrees of freedom(naive): can be infinite (z) or between-within (default). User specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dfBM</code></td>
<td>
<p>Degrees of freedom based on Bell and McCaffrey (2002).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pv.unadj</code></td>
<td>
<p>p value based on model-based standard errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CR0pv</code></td>
<td>
<p>p value based on CR0 SE with dfBM.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CR0pv.n</code></td>
<td>
<p>p value  based on CR0 SE with naive df.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CR1pv</code></td>
<td>
<p>p value based on CR1 SE with dfBM.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CR1pv.n</code></td>
<td>
<p>p value  based on CR1 SE with naive df.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CR2pv</code></td>
<td>
<p>p value based on CR2 SE with dfBM.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CR2pv.n</code></td>
<td>
<p>p value  based on CR2 SE with naive df.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p><cite>Bell, R., &amp; McCaffrey, D. (2002). Bias reduction in standard errors for linear regression with multi-stage samples. Survey Methodology, 28, 169-182.
(<a href="https://www150.statcan.gc.ca/n1/pub/12-001-x/2002002/article/9058-eng.pdf">link</a>)</cite>
</p>
<p>Liang, K.Y., &amp; Zeger, S. L. (1986). Longitudinal data analysis using generalized linear models. <em>Biometrika, 73</em>(1), 13â€“22.
doi: <a href="https://doi.org/10.1093/biomet/73.1.13">10.1093/biomet/73.1.13</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">clustSE(lm(mpg ~ am + wt, data = mtcars), 'cyl')
data(sch25)
clustSE(lm(math ~ ses + minority + mses + mhmwk, data = sch25), 'schid')

</code></pre>


</div>