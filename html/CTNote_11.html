<div class="container">

<table style="width: 100%;"><tr>
<td>view_by_lattice</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>View a Pattern through a Study Design "Lattice"</h2>

<h3>Description</h3>

<p>Given a use pattern string and the pattern of study visits,
view only the use pattern string components which are congruent with the
study design
</p>


<h3>Usage</h3>

<pre><code class="language-R">view_by_lattice(
  use_pattern,
  lattice_pattern,
  visit_is = "o",
  no_visit_is = "_"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>use_pattern</code></td>
<td>
<p>A character string showing the daily, by visit, or weekly
substance use pattern for a single subject</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lattice_pattern</code></td>
<td>
<p>A character string containing the study design for
subject visits. For example, a study design with required visits on Monday,
Wednesday, and Friday would have the lattice pattern <code>"o_o_o__"</code>,
where <code>"o"</code> represents a day wherein the subject should visit the
clinic (per study protocol) and <code>"_"</code> represents the other non-visit
days. These symbols are set by <code>visit_is</code> and <code>no_visit_is</code>,
respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>visit_is</code></td>
<td>
<p>Symbol indicating that the subject should appear in the
clinic for that time period, as dictated by the study protocol. Defaults to
<code>"o"</code> (because the outcome of the UDS will be unknown before the study
has been designed).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no_visit_is</code></td>
<td>
<p>Symbol indicating that the subject is not required to
appear in the clinic for that time period, as dictated by the study
protocol. Defaults to <code>"_"</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function was designed to handle outcomes where the clinical
trial protocol has staggered or non-sequential visits. For example, if we
observed the pattern <code>"-ooo"</code>, in most cases we would interpret this
to mean that the subject was present in the clinic for the first visit, but
missed the next three visits. Some trial outcomes would then count the
three missing visits as all positive or as a relapse. However, this use
pattern could have been observed late during subject follow-up, during
which time the protocol could be that the subject was only required to
visit the clinic monthly (so long as the supplied UDS was negative).
</p>
<p>Many lattice patterns can be easily constructed by using the function
<code>collapse_lattice</code>. For example, to repeat the
"Monday-Wednesday-Friday" visit pattern noted above 4 times, you can use
<code>collapse_lattice("o_o_o__", 4)</code> to create a vector of weekly visit
patterns, then collapse (concatenate) them all together. More complex visit
patterns can be constructed in a similar manner: first create a vector of
simple repeating visit patterns, then collapse them all together, setting
the number of repeats with the <code>times</code> argument.
</p>
<p>At current, this package allows for many symbols in the use pattern "word",
such as "_" for missing by study design, "o" missing for protocol
non-compliance (the most common form of missing), "+" for positive, "-" for
negative, and "*" for mixed positive and negative results (this usually
comes up when the visit represents multiple days and there are both
positive and negative results in those days; for example, a subject is
tested weekly; they provided a positive test on Tuesday but came back to
provide a negative test the following day).
</p>


<h3>Value</h3>

<p>A variant of <code>use_pattern</code>, but with all non-protocol visits set
to <code>"_"</code>. In most cases, this use pattern vector would be then passed
to <code>impute_missing_visits</code> so that the <code>"_"</code> visits could
be replaced with the last observed UDS. See the Examples below.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # This pattern represents 26 weeks of treatment UDS
  pattern_char  &lt;- "+++++o-------+--+-o-o-o+o+"
  pattern2_char &lt;- recode_missing_visits(pattern_char)
  
  # Example 1: a 16 week observation period with visits every 4 weeks
  lattice1_char &lt;- "___o___o___o___o"
  useLattice1_char &lt;- view_by_lattice(
    use_pattern = pattern2_char,
    lattice_pattern = lattice1_char
  )
  useLattice1_char
  impute_missing_visits(useLattice1_char, method = "locf", missing_is = "_")
  
  # Example 2: 24 week observation period with weekly visits for the first
  #   12 weeks, then monthly visits (during the second week) thereafter
  lattice2_char &lt;- "oooooooooooo_o___o___o__"
  useLattice2_char &lt;- view_by_lattice(
    use_pattern = pattern2_char,
    lattice_pattern = lattice2_char
  )
  useLattice2_char
  impute_missing_visits(useLattice2_char, method = "locf", missing_is = "_")
     
</code></pre>


</div>