<div class="container">

<table style="width: 100%;"><tr>
<td>make_local_lik</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Constructor functions for local parameter estimation.</h2>

<h3>Description</h3>

<p>This function generates another function to be used within <code>optim</code> to
obtain maximum likelihood estimates of covariance (and possibly mean) parameters.
The function includes options for
(1) maximum likelihood (<code>"ml"</code>) vs. restricted maximum likelihood
(<code>"reml"</code>),
(2) smoothness (<code>kappa</code>): models without smoothness vs. estimating the
smoothness vs. using fixed smoothness,
(3) locally isotropic vs. locally anisotropic, and
(4) fixed nugget variance (<code>tausq</code>): fixed vs. estimated.
</p>


<h3>Usage</h3>

<pre><code class="language-R">make_local_lik(
  locations,
  cov.model,
  data,
  Xmat,
  nugg2.var = matrix(0, nrow(locations), nrow(locations)),
  tausq = 0,
  kappa = 0.5,
  fixed = rep(FALSE, 6),
  method = "reml",
  local.aniso = TRUE,
  fix.tausq = FALSE,
  fix.kappa = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>locations</code></td>
<td>
<p>A matrix of locations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov.model</code></td>
<td>
<p>String; the covariance model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A vector or matrix of data to use in the likelihood
calculation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xmat</code></td>
<td>
<p>The design matrix for the mean model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nugg2.var</code></td>
<td>
<p>Fixed values for the variance/covariance of the second nugget term; defaults
to a matrix of zeros.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tausq</code></td>
<td>
<p>Scalar; fixed value for the nugget variance (when
<code>fix.tausq = TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kappa</code></td>
<td>
<p>Scalar; fixed value for the smoothness (when <code>fix.kappa = TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>Logical vector of <code>FALSE</code> values; length corresponds to the number
of parameters to be estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Indicates the estimation method, either maximum likelihood (<code>"ml"</code>)
or restricted maximum likelihood (<code>"reml"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>local.aniso</code></td>
<td>
<p>Logical; indicates if the local covariance should be
anisotropic (<code>TRUE</code>) or isotropic (<code>FALSE</code>). Defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fix.tausq</code></td>
<td>
<p>Logical; indicates whether the default nugget term
(tau^2) should be fixed (<code>TRUE</code>) or estimated (<code>FALSE</code>). Defaults to
<code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fix.kappa</code></td>
<td>
<p>Logical; indicates if the kappa parameter should be
fixed (<code>TRUE</code>) or estimated (<code>FALSE</code>). Defaults to <code>FALSE</code>
(only valid for <code>cov.model = "matern"</code> and <code>cov.model = "cauchy"</code>).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>This function returns another function for use in <code>optim</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
make_local_lik( locations, cov.model, data, Xmat )

## End(Not run)

</code></pre>


</div>