<div class="container">

<table style="width: 100%;"><tr>
<td>AMHcop</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The Ali–Mikhail–Haq Copula</h2>

<h3>Description</h3>

<p>The <em>Ali–Mikhail–Haq copula</em> (Nelsen, 2006, p. 92–93, 172) is
</p>
<p style="text-align: center;"><code class="reqn">\mathbf{C}_{\Theta}(u,v) = \mathbf{AMH}(u,v) = \frac{uv}{1 - \Theta(1-u)(1-v)}\mbox{,}</code>
</p>

<p>where <code class="reqn">\Theta \in [-1,+1)</code>, where the right boundary,
<code class="reqn">\Theta = 1</code>, can sometimes be considered valid according to Mächler (2014). The copula <code class="reqn">\Theta \rightarrow 0</code> becomes the <em>independence copula</em> (<code class="reqn">\mathbf{\Pi}(u,v)</code>; <code>P</code>), and the parameter <code class="reqn">\Theta</code> is readily computed from a <em>Kendall Tau</em> (<code>tauCOP</code>) by
</p>
<p style="text-align: center;"><code class="reqn">\tau_\mathbf{C} = \frac{3\Theta - 2}{3\Theta} -
                        \frac{2(1-\Theta)^2\log(1-\Theta)}{3\Theta^2}\mbox{,}</code>
</p>

<p>and by <em>Spearman Rho</em> (<code>rhoCOP</code>), through Mächler (2014), by
</p>
<p style="text-align: center;"><code class="reqn">\rho_\mathbf{C} = \sum_{k=1}^\infty \frac{3\Theta^k}{{k + 2 \choose 2}^2}\mbox{.}</code>
</p>

<p>The support of <code class="reqn">\tau_\mathbf{C}</code> is <code class="reqn">[(5 - 8\log(2))/3, 1/3] </code> <code class="reqn">\approx</code> <code class="reqn">[-0.1817258, 0.3333333]</code> and the <code class="reqn">\rho_\mathbf{C}</code> is <code class="reqn">[33 - 48\log(2), 4\pi^2 - 39]</code> <code class="reqn">\approx</code> <code class="reqn">[-0.2710647, 0.4784176]</code>, which shows that this copula has a limited range of dependency. The infinite summation is easier to work with than
Nelsen (2006, p. 172) definition of
</p>
<p style="text-align: center;"><code class="reqn">\rho_\mathbf{C} = \frac{12(1+\Theta)}{\Theta^2}\mathrm{dilog}(1-\Theta)-
                        \frac{24(1-\Theta)}{\Theta^2}\log(1-\Theta)-
                        \frac{3(\Theta+12)}{\Theta}\mbox{,}</code>
</p>

<p>where the <code class="reqn">\mathrm{dilog(x)}</code> is the dilogarithm function defined by
</p>
<p style="text-align: center;"><code class="reqn">\mathrm{dilog}(x) = \int_1^x \frac{\log(t)}{1-t}\,\mathrm{d}t\mbox{.}</code>
</p>

<p>The integral version has more nuances with approaches toward <code class="reqn">\Theta = 0</code> and <code class="reqn">\Theta = 1</code> than the infinite sum version.
</p>


<h3>Usage</h3>

<pre><code class="language-R">AMHcop(u, v, para=NULL, rho=NULL, tau=NULL, fit=c("rho", "tau"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>Nonexceedance probability <code class="reqn">u</code> in the <code class="reqn">X</code> direction;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>Nonexceedance probability <code class="reqn">v</code> in the <code class="reqn">Y</code> direction;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>para</code></td>
<td>
<p>A vector (single element) of parameters—the <code class="reqn">\Theta</code> parameter of the copula. However, if a second parameter is present, it is treated as a logical to reverse the copula (<code class="reqn">u + v - 1 + \mathbf{AMH}(1-u,1-v; \Theta)</code>);</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>Optional Spearman Rho from which the parameter will be estimated and presence of <code>rho</code> trumps <code>tau</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>Optional Kendall Tau from which the parameter will be estimated;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>If <code>para</code>, <code>rho</code>, and <code>tau</code> are all <code>NULL</code>, the the <code>u</code> and <code>v</code> represent the sample. The measure of association by the <code>fit</code> declaration will be computed and the parameter estimated subsequently. The <code>fit</code> has not other utility than to trigger which measure of association is computed internally by the <code>cor</code> function in <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>; and</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to pass.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Value(s) for the copula are returned. Otherwise if <code>tau</code> is given, then the <code class="reqn">\Theta</code> is computed and a <code>list</code> having
</p>
<table>
<tr style="vertical-align: top;">
<td><code>para</code></td>
<td>
<p>The parameter <code class="reqn">\Theta</code>, and</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>Kendall Tau.</p>
</td>
</tr>
</table>
<p>and if <code>para=NULL</code> and <code>tau=NULL</code>, then the values within <code>u</code> and <code>v</code> are used to compute Kendall Tau and then compute the parameter, and these are returned in the aforementioned list.
</p>


<h3>Note</h3>

<p>Mächler (2014) reports on accurate computation of <code class="reqn">\tau_\mathbf{C}</code> and <code class="reqn">\rho_\mathbf{C}</code> for this copula for conditions of <code class="reqn">\Theta \rightarrow 0</code> and in particular derives the following equation, which does not have <code class="reqn">\Theta</code> in the denominator:
</p>
<p style="text-align: center;"><code class="reqn">\rho_\mathbf{C} = \sum_{k=1}^{\infty} \frac{3\Theta^k}{{k+2 \choose 2}^2}\mbox{.}</code>
</p>

<p>The <span class="pkg">copula</span> package provides a Taylor series expansion for <code class="reqn">\tau_\mathbf{C}</code> for small <code class="reqn">\Theta</code> in the <code>copula::tauAMH()</code>. This is demonstrated here between the implementation of <code class="reqn">\tau = 0</code> for parameter estimation in the <span class="pkg">copBasic</span> package to that in the more sophisticated implementation in the <span class="pkg">copula</span> package.
</p>
<pre>
  copula::tauAMH(AMHcop(tau=0)$para) # theta = -2.313076e-07
</pre>
<p>It is seen that the numerical approaches yield quite similar results for small <code class="reqn">\tau_\mathbf{C}</code>, and finally, a comparison to the <code class="reqn">\rho_\mathbf{C}</code> is informative:
</p>
<pre>
  rhoCOP(AMHcop, para=1E-9)    # 3.333333e-10 (two nested integrations)
  copula:::.rhoAmhCopula(1E-9) # 3.333333e-10 (cutoff based)
  theta &lt;- seq(-1,1, by=.0001)
  RHOa &lt;- sapply(theta, function(t) rhoCOP(AMHcop, para=t))
  RHOb &lt;- sapply(theta, function(t) copula:::.rhoAmhCopula(t))
  plot(10^theta, RHOa-RHOb, type="l", col=2)
</pre>
<p>The plot shows that the apparent differences are less than 1 part in 100 million—The <span class="pkg">copBasic</span> computation is radically slower though, but <code>rhoCOP</code> was designed for generality of copula family.
</p>


<h3>Author(s)</h3>

<p>W.H. Asquith</p>


<h3>References</h3>

<p>Joe, H., 2014, Dependence modeling with copulas: Boca Raton, CRC Press, 462 p.
</p>
<p>Mächler, Martin, 2014, Spearman's Rho for the AMH copula—A beautiful formula: copula package vignette, accessed on April 7, 2018, at <a href="https://CRAN.R-project.org/package=copula">https://CRAN.R-project.org/package=copula</a> under the vignette <em>rhoAMH-dilog.pdf</em>.
</p>
<p>Nelsen, R.B., 2006, An introduction to copulas: New York, Springer, 269 p.
</p>
<p>Pranesh, Kumar, 2010, Probability distributions and estimation of Ali–Mikhail–Haq copula: Applied Mathematical Sciences, v. 4, no. 14, p. 657–666.
</p>


<h3>See Also</h3>

<p><code>P</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
t &lt;- 0.9 # The Theta of the copula and we will compute Spearman Rho.
di &lt;- integrate(function(t) log(t)/(1-t), lower=1, upper=(1-t))$value
A &lt;- di*(1+t) - 2*log(1-t) + 2*t*log(1-t) - 3*t # Nelsen (2007, p. 172)
rho &lt;- 12*A/t^2 - 3    # 0.4070369
rhoCOP(AMHcop, para=t) # 0.4070369
sum(sapply(1:100, function(k) 3*t^k/choose(k+2, 2)^2)) # Machler (2014)
# 0.4070369 (see Note section, very many tens of terms are needed) 
## End(Not run)

## Not run: 
  layout(matrix(1:2, byrow=TRUE)) # Note: Kendall Tau is same on reversal.
  s &lt;- 2; set.seed(s); nsim &lt;- 10000
  UVn &lt;- simCOP(nsim, cop=AMHcop, para=c(-0.9, "FALSE" ), col=4)
  mtext("Normal definition [default]") # '2nd' parameter could be skipped
  set.seed(s) # seed used to keep Rho/Tau inside attainable limits
  UVr &lt;- simCOP(nsim, cop=AMHcop, para=c(-0.9, "TRUE"),   col=2)
  mtext("Reversed definition")
  AMHcop(UVn[,1], UVn[,2], fit="rho")$rho # -0.2581653
  AMHcop(UVr[,1], UVr[,2], fit="rho")$rho # -0.2570689
  rhoCOP(cop=AMHcop, para=-0.9)           # -0.2483124
  AMHcop(UVn[,1], UVn[,2], fit="tau")$tau # -0.1731904
  AMHcop(UVr[,1], UVr[,2], fit="tau")$tau # -0.1724820
  tauCOP(cop=AMHcop, para=-0.9)           # -0.1663313 
## End(Not run)
</code></pre>


</div>