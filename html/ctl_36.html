<div class="container">

<table style="width: 100%;"><tr>
<td>CTLmapping</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>CTLmapping - Scan for correlated trait loci (CTL) </h2>

<h3>Description</h3>

<p>Scan for correlated trait loci (CTL)
</p>


<h3>Usage</h3>

<pre><code class="language-R">CTLmapping(genotypes, phenotypes, phenocol = 1, nperm = 100, nthreads = 1,
strategy = c("Exact", "Full", "Pairwise"), adjust = TRUE, qtl = TRUE, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>genotypes</code></td>
<td>
<p>   Matrix of genotypes. (individuals x markers) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phenotypes</code></td>
<td>
<p>  Matrix of phenotypes. (individuals x phenotypes) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phenocol</code></td>
<td>
<p>    Which phenotype column(s) should we analyse. Default: Analyse a single phenotype. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nperm</code></td>
<td>
<p>       Number of permutations to perform. This parameter is not used when method="Exact". </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nthreads</code></td>
<td>
<p>    Number of CPU cores to use during the analysis. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strategy</code></td>
<td>
<p>    The permutation strategy to use, either 
</p>

<ul>
<li>
<p> Exact: Uses exact calculations to calculate the likelihood of a difference 
in correlation: Cor(AA) - Cor(BB). Using a Bonferroni correction.
</p>
</li>
<li>
<p> Full: Most powerful analysis method - Compensate for marker and trait 
correlation structure (Breitling et al.).
</p>
</li>
<li>
<p> Pairwise: Suitable when we have a lot of markers and only a few 
traits (&lt; 50) (human GWAS)- Compensates only for marker correlation structure.
</p>
</li>
</ul>
<p>Note: Exact is the default and fastest option it uses a normal distribution for 
estimating p-values and uses bonferoni correction. It has however the least power to 
detect CTLs, the two other methods (Full and Pairwise) perform permutations to
assign significance. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjust</code></td>
<td>
<p>      Adjust p-values for multiple testing (only used when strategy = Exact). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qtl</code></td>
<td>
<p>         Use the internal slow QTL mapping method to map QTLs. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>     Be verbose. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>TODO
</p>

<ul><li>
<p> NOTE: Main bottleneck of the algorithm is the RAM available to the system
</p>
</li></ul>
<h3>Value</h3>

<p>CTLscan, a list of:
</p>

<ul>
<li>
<p> $dcor  - Matrix of differential correlation scores for each trait at each marker
</p>
</li>
<li>
<p> $perms - Vector of maximums per marker obtained during permutations
</p>
</li>
<li>
<p> $ctls  - Matrix of LOD scores for CTL likelihood
</p>
</li>
</ul>
<h3>Note</h3>

<p>TODO
</p>


<h3>Author(s)</h3>

 
<p>Danny Arends <a href="mailto:Danny.Arends@gmail.com">Danny.Arends@gmail.com</a><br>
Maintainer: Danny Arends <a href="mailto:Danny.Arends@gmail.com">Danny.Arends@gmail.com</a> 
</p>


<h3>References</h3>

 
<p>TODO
</p>


<h3>See Also</h3>


<ul>
<li> <p><code>CTLscan</code> - Main function to scan for CTL
</p>
</li>
<li> <p><code>CTLscan.cross</code> - Use an R/qtl cross object with <code>CTLscan</code>
</p>
</li>
<li> <p><code>CTLsignificant</code> - Significant interactions from a <code>CTLscan</code>
</p>
</li>
<li> <p><code>plot.CTLscan</code> - Plot the CTL curve for a single trait
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">  library(ctl)
  data(ath.metabolites) # Arabidopsis Thaliana dataset
  singlescan &lt;- CTLmapping(ath.metab$genotypes, ath.metab$phenotypes, phenocol = 23)

  plot(singlescan)      # Plot the results of the CTL scan for the phenotype

  summary &lt;- CTLsignificant(singlescan)
  summary               # Get a list of significant CTLs
</code></pre>


</div>