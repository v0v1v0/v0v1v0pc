<div class="container">

<table style="width: 100%;"><tr>
<td>cpg.assoc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Association Analysis Between Methylation Beta Values and Phenotype of Interest
</h2>

<h3>Description</h3>

<p>Association Analysis Between Methylation Beta Values and Phenotype of Interest.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cpg.assoc(beta.val, indep, covariates = NULL, data = NULL, logit.transform = FALSE, 
chip.id = NULL, subset = NULL, random = FALSE, fdr.cutoff = 0.05, large.data = FALSE,
fdr.method = "BH", logitperm = FALSE,return.data=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>beta.val</code></td>
<td>

<p>A vector, matrix, or data frame containing the beta values of interest (1 row per CpG site, 1 column per individual).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indep</code></td>
<td>

<p>A vector containing the variable to be tested for association. <code>cpg.assoc</code> will evaluate the association between the beta values (dependent
variable) and indep (independent variable).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariates</code></td>
<td>

<p>A data frame consisting of additional covariates to be included in the model. covariates can also be specified as a matrix 
if it takes the form of a model matrix with no intercept column, or can be specified as a vector if there is
only one covariate of interest. Can also be a formula(e.g. <code>~cov1+cov2</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>an optional data frame, list or environment (or object coercible by as.data.frame to a data frame) containing the
variables in the model. If not found in data, the variables are taken from the environment from which cpg.assoc is
called.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logit.transform</code></td>
<td>

<p>logical. If <code>TRUE</code>, the logit transform of the beta values log(beta.val/(1-beta.val)) will be used. Any values equal to zero or one will be set to the 
next smallest or  next largest value respectively; values &lt;0 or &gt;1 will be set to NA.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chip.id</code></td>
<td>

<p>An optional vector containing chip, batch identities, or other categorical factor of interest to the researcher. If specified, chip id will be included as a factor in the model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>

<p>An optional logical vector specifying a subset of observations to be used in the fitting process.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random</code></td>
<td>

<p>Logical. If <code>TRUE</code>, <span class="option">chip.id</span> will be included in the model as a random effect, and a random intercept model will be
fitted. If <code>FALSE</code>, <span class="option">chip.id</span> will be included in the model as an ordinary categorical covariate, for a much faster analysis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fdr.cutoff</code></td>
<td>

<p>The desired FDR threshold. The default setting is .05. The set of CpG sites with FDR &lt; <span class="option">fdr.cutoff</span> will be labeled as significant.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>large.data</code></td>
<td>

<p>Logical.  Enables analyses of large datasets.  When <code>large.data=TRUE</code>, <code>cpg.assoc</code> avoids memory problems by performing the analysis in chunks. Note: this option no longer works within windows systems. Based on reading max memory allowable by the system. Defaults to False. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fdr.method</code></td>
<td>

<p>Character. Method used to calculate False Discovery Rate. Choices include any of the methods available in <code>p.adjust()</code>. The default method is "BH" for the Benjamini &amp; Hochberg method.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logitperm</code></td>
<td>

<p>Logical. For internal use only.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.data</code></td>
<td>

<p>Logical. cpg.assoc can return dataframes containing the the variable of interest, covariates, and the chip id (if present). Defaults to FALSE. Set to TRUE if plan on using the downstream scatterplot functions).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>cpg.assoc</code> is designed to test for association between an independent variable and methylation at a number of CpG sites, with the option to include additional covariates and factors. <br><code>cpg.assoc</code> assesses significance with the Holm (step-down Bonferroni) and FDR methods. <br></p>
<p>If <code>class(indep)='factor'</code>, <code>cpg.assoc</code> will perform an ANOVA test of the variable conditional on the covariates specified. Covariates, if entered, should be in the form of a data 
frame, matrix, or vector. For example, <code>covariates=data.frame(weight,age,factor(city))</code>. The data frame can also be specified prior to calling <code>cpg.assoc</code>.  The covariates 
should either be vectors or columns of a matrix or data.frame.<br><code>cpg.assoc</code> is also designed to deal with large data sets. Setting <code>large.data=TRUE</code> will make <code>cpg.assoc</code> split up the data in chunks. Other option is to use cpg.combine and split up oneself. 
</p>


<h3>Value</h3>

<p><code>cpg.assoc</code> will return an object of class <code>"cpg"</code>. The functions <code>summary</code> and <code>plot</code> can be called to get a summary of results and to create QQ plots.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>results</code></td>
<td>

<p>A data frame consisting of the t or F statistics and P-values for each CpG site, as well as indicators of Holm and FDR significance. CpG sites will be in the same order as the original
input, but the <code>sort()</code> function can be used directly on the <code>cpg.assoc</code> object to sort CpG sites by p-value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Holm.sig</code></td>
<td>

<p>A list of sites that met criteria for Holm significance.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FDR.sig</code></td>
<td>

<p>A data.frame of the CpG sites that were significant by the FDR method specified.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>info</code></td>
<td>

<p>A data frame consisting of the minimum P-value observed, the FDR method that was used, the phenotype of interest, the number of covariates in the model, the name of the matrix or data frame the methylation beta values were
taken from, the FDR cutoff value and whether a mixed effects analysis was performed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indep</code></td>
<td>

<p>If <code>return.data=T</code>, the independent variable that was tested for association.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariates</code></td>
<td>

<p>If <code>return.data=T</code>, data.frame or matrix of covariates, if specified (otherwise <code>NULL</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chip</code></td>
<td>

<p>If <code>return.data=T</code>, chip.id vector, if specified (otherwise <code>NULL</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>

<p>A data frame consisting of the degrees of freedom, and if object is continous the intercept effect adjusted for possible covariates in the model, the estimated effect size, and the standard error. 
The degrees of freedom is used in <code>plot.cpg</code> to compute the genomic inflation factors.<br></p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Barfield, R.; Conneely, K.; Kilaru,V.<br>
Maintainer: R. Barfield: &lt;barfieldrichard8@gmail.com&gt;
</p>


<h3>See Also</h3>

<p><code>cpg.work</code>
<code>cpg.perm</code>
<code>plot.cpg</code>
<code>scatterplot</code>
<code>cpg.combine</code>
<code>manhattan</code>
<code>plot.cpg.perm</code>
<code>sort.cpg.perm</code>
<code>sort.cpg</code>
<code>cpg.qc</code>
<code>cpg.GC</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"> # Sample output from CpGassoc
data(samplecpg,samplepheno,package="CpGassoc")
results&lt;-cpg.assoc(samplecpg,samplepheno$weight,large.data=FALSE)
results
#Analysis with covariates. There are multiple ways to do this. One can define the
#dataframe prior or do it in the function call.
test&lt;-cpg.assoc(samplecpg,samplepheno$weight,data.frame(samplepheno$Distance,
samplepheno$Dose),large.data=FALSE)
# or
covar&lt;-data.frame(samplepheno$Distance,samplepheno$Dose)
test2&lt;-cpg.assoc(samplecpg,samplepheno$weight,covar,large.data=FALSE)


#Doing a mixed effects model. This does take more time, so we will do a subset of
#the samplecpg
randtest&lt;-cpg.assoc(samplecpg[1:10,],samplepheno$weight,chip.id=samplepheno$chip,
random=TRUE,large.data=FALSE)
          </code></pre>


</div>