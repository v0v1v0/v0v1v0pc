<div class="container">

<table style="width: 100%;"><tr>
<td>check_cmat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Check constraint matrix irreducibility</h2>

<h3>Description</h3>

<p>Checks a constraint matrix does not contains redundant rows
</p>


<h3>Usage</h3>

<pre><code class="language-R">check_cmat(Cmat)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>Cmat</code></td>
<td>
<p>A constraint matrix as passed to <code>cirls.fit()</code></p>
</td>
</tr></table>
<h3>Details</h3>

<p>The user typically doesn't need to use <code>check_cmat</code> as it is internally called by <code>cirls.control()</code>. However, it might be useful to undertsand if <code>Cmat</code> can be reduced for inference purpose. See the note in <code>confint.cirls()</code>.
</p>
<p>A constraint matrix is irreducible if no row can be expressed as a <em>positive</em> linear combination of the other rows. When it happens, it means the constraint is actually implicitly included in other constraints in the matrix and can be dropped. Note that this a less restrictive condition than the constraint matrix having full row rank (see some examples).
</p>
<p>The function starts by checking if some constraints are redundant and, if so, checks if they underline equality constraints. In the latter case, the constraint matrix can be reduced by expressing these constraints as a single equality constraint with identical lower and upper bounds (see <code>cirls.fit()</code>).
</p>


<h3>Value</h3>

<p>A list with two elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>redundant</code></td>
<td>
<p>Vector of indices of redundant constraints</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>equality</code></td>
<td>
<p>Indicates which constraints are part of an underlying equality constraint</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Meyer, M.C., 1999. An extension of the mixed primal–dual bases algorithm to the case of more constraints than dimensions. <em>Journal of Statistical Planning and Inference</em> <strong>81</strong>, 13–31. <a href="https://doi.org/10.1016/S0378-3758%2899%2900025-7">doi:10.1016/S0378-3758(99)00025-7</a>
</p>


<h3>See Also</h3>

<p><code>confint.cirls()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">###################################################
# Example of reducible matrix

# Constraints: successive coefficients should increase and be convex
p &lt;- 5
cmatic &lt;- rbind(diff(diag(p)), diff(diag(p), diff = 2))

# Checking indicates that constraints 2 to 4 are redundant.
# Intuitively, if the first two coefficients increase,
# then convexity forces the rest to increase
check_cmat(cmatic)

# Check without contraints
check_cmat(cmatic[-(2:4),])

###################################################
# Example of irreducible matrix

# Constraints: coefficients form an S-shape
p &lt;- 4
cmats &lt;- rbind(
  diag(p)[1,], # positive
  diff(diag(p))[c(1, p - 1),], # Increasing at both end
  diff(diag(p), diff = 2)[1:(p/2 - 1),], # First half convex
  -diff(diag(p), diff = 2)[(p/2):(p-2),] # second half concave
)

# Note, this matrix is not of full row rank
qr(t(cmats))$rank
all.equal(cmats[2,] + cmats[4,] - cmats[5,], cmats[3,])

# However, it is irreducible: all constraints are necessary
check_cmat(cmats)

###################################################
# Example of underlying equality constraint

# Contraint: Parameters sum is &gt;= 0 and sum is &lt;= 0
cmateq &lt;- rbind(rep(1, 3), rep(-1, 3))

# Checking indicates that both constraints imply equality constraint (sum == 0)
check_cmat(cmateq)
</code></pre>


</div>