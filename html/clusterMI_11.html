<div class="container">

<table style="width: 100%;"><tr>
<td>imputedata</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multiple imputation methods for cluster analysis</h2>

<h3>Description</h3>

<p><code>imputedata</code> returns a list of imputed datasets by using imputation methods dedicated to individuals clustered in (unknown) groups
</p>


<h3>Usage</h3>

<pre><code class="language-R">imputedata(
  data.na,
  method = "JM-GL",
  nb.clust = NULL,
  m = 20,
  maxit = 50,
  Lstart = 100,
  L = 20,
  method.mice = NULL,
  predictmat = NULL,
  verbose = TRUE,
  seed = 1234,
  bootstrap = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data.na</code></td>
<td>
<p>an incomplete dataframe</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a single string specifying the imputation method used among "FCS-homo","FCS-hetero","JM-DP","JM-GL". By default method = "JM-GL". See the details section</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb.clust</code></td>
<td>
<p>number of clusters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>number of imputed datasets. By default, m = 20.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>number of iterations for FCS methods (only used for method = FCS-homo or method = FCS-hetero)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lstart</code></td>
<td>
<p>number of iterations for the burn-in period (only used if method ="JM-DP" or "JM-GL")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>number of skipped iterations to keep one imputed data set after the burn-in period (only used if method ="JM-DP" or "JM-GL")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method.mice</code></td>
<td>
<p>a vector of strings (or a single string) giving the imputation method for each variable (only used for method = FCS-homo or method = FCS-hetero). Default value is "pmm" (predictive mean matching) for FCS-homo and "mice.impute.2l.jomo" for FCS-hetero</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predictmat</code></td>
<td>
<p>predictor matrix used for FCS imputation (only used for method = FCS-homo or method = FCS-hetero)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>a boolean. If TRUE, a message is printed at each iteration. Use verbose = FALSE for silent imputation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>a positive integer initializing the random generator</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bootstrap</code></td>
<td>
<p>a boolean. Use bootstrap = TRUE for proper imputation with FCS methods (Mclust sometimes fails with multiple points)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>imputedata</code> offers various multiple imputation methods dedicated to clustered individuals.
In particular, two fully conditional imputation methods are proposed (<code>FCS-homo</code> and <code>FCS-hetero</code>) which essentially differ by the assumption about the covariance in each cluster (constant or not respectively).
The imputation requires a pre-specified number of clusters (<code>nb.clust</code>). See <code>choosenbclust</code> if this number is unknown.
The <code>imputedata</code> function alternates clustering and imputation given the partition of individuals.
When the clustering is performed, the function calls the <code>mice</code> function from the <code>mice</code> R package to perform imputation.
The <code>mice</code> package proposes various methods for imputation which can be specified by tuning the <code>method.mice</code> argument.
Note that two other joint modelling methods are also available: <code>JM-GL</code> from the R package <code>mix</code> and <code>JM-DP</code> from the R package <code>DPImputeCont</code> <a href="https://github.com/hang-j-kim/DPImputeCont">https://github.com/hang-j-kim/DPImputeCont</a>
</p>


<h3>Value</h3>

<p>a list of 3 objets
</p>
<table>
<tr style="vertical-align: top;">
<td><code>res.imp</code></td>
<td>
<p> a list with the several imputed datasets</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res.conv</code></td>
<td>
<p> for FCS methods, an array given the between (and within) inertia of each imputed variable at each iteration and for each imputed dataset. For JM methods, a matrix given the between inertia for each variable and each imputed dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p> the matching call</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Kim, H. J., Reiter, J. P., Wang, Q., Cox, L. H. and Karr, A. F. (2014), Multiple imputation of missing or faulty values under linear constraints, Journal of Business and Economics Statistics, 32, 375-386 &lt;doi:10.1080/07350015.2014.885435&gt;
</p>
<p>Schafer, J. L. (1997) Analysis of Incomplete Multivariate Data. Chapman &amp; Hall, Chapter 9.
</p>
<p>Audigier, V., Niang, N., &amp; Resche-Rigon, M. (2021). Clustering with missing data: which imputation model for which cluster analysis method?. arXiv preprint &lt;arXiv:2106.04424&gt;.
</p>


<h3>See Also</h3>

<p><code>mice</code> <code>choosenbclust</code> <code>choosemaxit</code> <code>varselbest</code> <code>imp.mix</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(wine)
set.seed(123456)
wine.na &lt;- wine
wine.na$cult &lt;- NULL
wine.na &lt;- prodna(wine.na)
nb.clust &lt;- 3 # number of clusters
m &lt;- 20 # number of imputed data sets
res.imp &lt;- imputedata(data.na = wine.na, nb.clust = nb.clust, m = m)
lapply(res.imp$res.imp, summary)
</code></pre>


</div>