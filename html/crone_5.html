<div class="container">

<table style="width: 100%;"><tr>
<td>diffraction</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulation of 1D diffraction pattern</h2>

<h3>Description</h3>

<p>Analytic Fourier transform of electron density corresponding to
an array of <code>Ncell</code> unit cells calculated using numerical 
integration with the trapezoid rule. The diffraction peaks' height is 
proportional to the number of unit cells ( <code>Ncell</code>). The 
number of diffraction peaks included in the 1D diffraction pattern is 
related to the maximum resolution <code>D</code> provided in the input. 
The number of grid points for both the simulated electron density and
the resulting diffraction pattern can also be provided as input. A
further input parameter is the radius of the beamstop disc to stop
diffraction close to the incoming beam (as the resulting intensity far
outweigh the rest of the diffracted intensities).
</p>


<h3>Usage</h3>

<pre><code class="language-R">diffraction(sdata, D, Ncell = 10, N = 1000, n = 100, bstop = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sdata</code></td>
<td>
<p>A named list, normally obtained through the use of
functions <code>read_x</code> or <code>standardise_sdata</code>. 
The list names correspond to different object types:
</p>

<ul>
<li>
<p>a.     Real numeric. The size of the unit cell.
</p>
</li>
<li>
<p>SG.    Character string. Space group symbol; either "P1" 
or "P-1"
</p>
</li>
<li>
<p>x0.    Vector of real numerics indicating the expanded atomic
positions in the unit cell.
</p>
</li>
<li>
<p>Z.     Vector of integers indicating the expanded 
atomic numbers for all atoms in the unit cell.
</p>
</li>
<li>
<p>B.    Vector of real numerics indicating the expanded 
B factors for all atoms in the unit cell.
</p>
</li>
<li>
<p>occ.  Vector of real numerics indicating the expanded 
occupancies for all atoms in the unit cell.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>Real numeric. Maximum resolution in angstroms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ncell</code></td>
<td>
<p>Positive integer. It is the number of unit cells in 
the 1D crystal. The default value is <code>Ncell=10</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Positive integer indicating the number of grid points for the
electron density. The default value is <code>N=1000</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Positive integer determining the reciprocal space grid. The
grid is made of <code>2*n+1</code> regularly-spaced points from <code>-1/D</code> 
to <code>1/D</code>. The value 0 is always at the centre of the grid. The 
default value is <code>n=100</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bstop</code></td>
<td>
<p>Real numeric. Is the radius of the backstop disc. Intensities
at points closer to the origin than <code>bstop</code> are reduced to 
0. The presence of a backstop improves the contrast for all diffracted
intensities because it gets rid of the overwhelming intensity corresponding
to the origin of the reciprocal space. The default is not to include
any backstop.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A named list with two vectors of real numbers, the values of the
reciprocal space grid points (in 1/angstrom units) <code>xstar</code> 
and the intensities <code>Imod</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Diffraction from just two unit cells of cyanate
sdata &lt;- load_structure("cyanate")

# Max resolution is 1 angstroms; no backstop
ltmp &lt;- diffraction(sdata,D=1,Ncell=1)

# Plot diffraction pattern
plot(ltmp$xstar,ltmp$Imod,type="l",
 xlab=expression(paste("x"^"*")),ylab="Intensity")

# Diffraction from 20 unit cells with backstop of 20 angstroms diameter
ltmp &lt;- diffraction(sdata,D=1,bstop=10)
plot(ltmp$xstar,ltmp$Imod,type="l",
 xlab=expression(paste("x"^"*")),ylab="Intensity")


</code></pre>


</div>