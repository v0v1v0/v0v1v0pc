<div class="container">

<table style="width: 100%;"><tr>
<td>trajectories</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cluster longitudinal trajectories over time.</h2>

<h3>Description</h3>

<p>Performs k-means clustering on continuous <code>response</code> measured over <code>time</code>,
where each mean is defined by a thin plate spline fit to all points in a
cluster. Typically, this function is called by <code>clustra</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">trajectories(
  data,
  k,
  group,
  maxdf,
  conv = c(10, 0),
  mccores = 1,
  verbose = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data table or data frame with response measurements, one per observation.
Column names are <code>id</code>, <code>time</code>, <code>response</code>, <code>group</code>. Note that
<code>id</code>s must be sequential starting from 1. This affects expanding group
numbers to <code>id</code>s.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Number of clusters (groups)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>Vector of initial group numbers corresponding to <code>id</code>s.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxdf</code></td>
<td>
<p>Integer. Basis dimension of smooth term. See <code>s</code> function
parameter <code>k</code>, in package <code>mgcv</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conv</code></td>
<td>
<p>A vector of length two, <code>c(iter, minchange)</code>, where <code>iter</code> is the maximum
number of EM iterations and <code>minchange</code> is the minimum percentage of subjects
changing group to continue iterations. Setting <code>minchange</code> to zero continues
iterations until no more changes occur or <code>maxiter</code> is reached.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mccores</code></td>
<td>
<p>Integer number of cores to use by <code>mclapply</code> sections. Parallelization is
over <code>k</code>, the number of clusters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical, whether to produce debug output. A value &gt; 1 will plot tps fit lines
in each iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>See <code>clustra</code> for allowed <code>...</code> parameters.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with components
</p>

<ul>
<li> <p><code>deviance</code> - The final deviance in each cluster added across clusters.
</p>
</li>
<li> <p><code>group</code> - Integer vector of group assignments corresponding to unique <code>id</code>s.
</p>
</li>
<li> <p><code>loss</code> - Numeric matrix with rows corresponding to unique <code>id</code>s and one
column for each cluster. Each entry is the mean squared loss for the data in
the <code>id</code> relative to the cluster model.
</p>
</li>
<li> <p><code>k</code> - An integer giving the requested number of clusters.
</p>
</li>
<li> <p><code>k_cl</code> - An integer giving the converged number of clusters. Can be
smaller than <code>k</code> when some clusters become too small for degrees of freedom
during convergence.
</p>
</li>
<li> <p><code>data_group</code> - An integer vector, giving group assignment as expanded into
all <code>id</code> time points.
</p>
</li>
<li> <p><code>tps</code> - A list with <code>k_cl</code> elements, each an object returned by the
<code>mgcv::bam</code> fit of a cluster thin plate spline model.
</p>
</li>
<li> <p><code>iterations</code> - An integer giving the number of iterations taken.
</p>
</li>
<li> <p><code>counts</code> - An integer vector giving the number of <code>id</code>s in each cluster.
</p>
</li>
<li> <p><code>counts_df</code> - An integer vector giving the total number of observations in
each cluster (sum of the number of observations for <code>id</code>s belonging to the
cluster).
</p>
</li>
<li> <p><code>changes</code> - An integer, giving the number of <code>id</code>s that changed clusters in
the last iteration. This is zero if converged.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>George Ostrouchov and David Gagnon
</p>


</div>