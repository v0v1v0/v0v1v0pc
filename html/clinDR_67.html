<div class="container">

<table style="width: 100%;"><tr>
<td>targetD</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute the MLE (and its SE) of the dose achieving a specified
target improvement from placebo. </h2>

<h3>Description</h3>

<p>The MLE (se) of the dose required to achieve a targetted improvement
from placebo.
The fit can be from a 3- or 4- parameter Emax model or output from 
function emaxalt, or an object of class emaxsimobj.  The Emax model
is on the logit scale for binary data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">targetD (fit,
	target,
	modType=4,
	binary=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>Output of <code>nls</code> <code>fit</code> to a 3- or 4-parameter Emax
model.  The order of the parameters in the fit must be (log(ed50),emax,e0)
or (log(ed50),lambda,emax,e0).  
<code>fit</code> can also be a list with the first element the coefficient
vector, and the second element the variance-covariance matrix. 
Alternatively, <code>fit</code> may be of class <code>emaxalt</code> or 
<code>emaxsimobj</code>, and the target dose is based on the fitted model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>
<p>Targetted change from placebo (positive or negative). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modType</code></td>
<td>
<p>Value is 3 or 4 for the 3 or 4-parameter Emax model
output from nls with parameters in the
order (ed50,emax,e0) or (ed50,lambda,emax,e0).  
<code>modType</code> is ignored if fit is from <code>emaxalt</code> or <code>emaxsimobj</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binary</code></td>
<td>
<p>When <code>TRUE</code>, the fit is assumed to be for binary data on 
the logistic scale.  <code>target</code> is input as a risk difference, and 
transformed internally.  When the <code>fit</code> is of class <code>emaxalt</code> or
<code>emaxsimobj</code>, the <code>binary</code> status is taken from the object and
<code>binary</code> is ignored.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a vector with two elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>targetDose</code></td>
<td>
<p>The MLE of the dose achieving the target.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seTD</code></td>
<td>
<p>SE for target.dose</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Asymptotic SE computed using the delta method
</p>


<h3>Author(s)</h3>

<p>Neal Thomas </p>


<h3>See Also</h3>

<p><code>SeEmax</code>, <code>emaxalt</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">    ## Not run: 

		## emaxsim changes the random number seed
    doselev&lt;-c(0,5,25,50,100,250)
    n&lt;-c(78,81,81,81,77,80)
    dose&lt;-rep(doselev,n)

    ### population parameters for simulation
    e0&lt;-2.465375 
    ed50&lt;-67.481113 
    
   	dtarget&lt;-100
		diftarget&lt;-9.032497
		emax&lt;-solveEmax(diftarget,dtarget,log(ed50),1,e0)

    sdy&lt;-7.967897
    pop&lt;-c(led50=log(ed50),emax=emax,e0=e0)    
    meanresp&lt;-emaxfun(dose,pop)  
    y&lt;-rnorm(sum(n),meanresp,sdy)
    nls.fit&lt;-nls(y ~ e0 + (emax * dose)/(dose + exp(led50)), 
                              start = pop, control = nls.control(
                              maxiter = 100),trace=TRUE,na.action=na.omit)

    targetD(nls.fit,10,modType=3)

    ###
    ### apply targetD to an emaxsim object
    ###
    nsim&lt;-50
    sdy&lt;-25
    gen.parm&lt;-FixedMean(n,doselev,emaxfun(doselev,pop),sdy)  
    D4 &lt;- emaxsim(nsim,gen.parm,modType=4)
    summary(D4,testalph=0.05)

    out&lt;-NULL
    for(i in 1:nsim){
        out&lt;-rbind(out,targetD(D4[i],target=4))
    }

## End(Not run)
    
</code></pre>


</div>