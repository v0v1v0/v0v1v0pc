<div class="container">

<table style="width: 100%;"><tr>
<td>Cluster_Gauss_Newton_Bootstrap_method</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cluster_Gauss_Newton_Bootstrap_method</h2>

<h3>Description</h3>

<p>Conduct residual resampling bootstrap analyses using CGNM.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Cluster_Gauss_Newton_Bootstrap_method(
  CGNM_result,
  nonlinearFunction,
  num_bootstrapSample = 200,
  indicesToUseAsInitialIterates = NA,
  bootstrapType = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>CGNM_result</code></td>
<td>
<p>(required input) <em>A list</em> stores the computational result from Cluster_Gauss_Newton_method() function in CGNM package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nonlinearFunction</code></td>
<td>
<p>(required input) <em>A function with input of a vector x of real number of length n and output a vector y of real number of length m.</em> In the context of model fitting the nonlinearFunction is <strong>the model</strong>.  Given the CGNM does not assume the uniqueness of the minimizer, m can be less than n.  Also CGNM does not assume any particular form of the nonlinear function and also does not require the function to be continuously differentiable (see Appendix D of our publication for an example when this function is discontinuous).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_bootstrapSample</code></td>
<td>
<p>(default: 200) <em>A positive integer</em> number of bootstrap samples to generate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indicesToUseAsInitialIterates</code></td>
<td>
<p>(default: NA) <em>A vector of integers</em> indices to use for initial iterate of the bootstrap analyses.  For CGNM bootstrap, we use the parameters found by CGNM as the initial iterates, here you can manually spccify which of the approximate minimizers that was found by CGNM (where the CGNM computation result is given as CGNM_result file) to use as initial iterates.  (if NA, use indices chosen by the acceptedIndices() function with default setting).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bootstrapType</code></td>
<td>
<p>(default:1) <em>1 or 2</em> 1: residual resampling bootstrap method, 2: case sampling bootstrap method</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be supplied to nonlinearFunction</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>list of a matrix X, Y,residual_history, initialX, bootstrapX, bootstrapY as well as a list runSetting.
</p>
<ol>
<li>
<p> X, Y, residual_history, initialX: identical to what was given as CGNM_result.
</p>
</li>
<li>
<p> X: <em>a num_bootstrapSample by n matrix</em> which stores the the X values that was sampled using residual resampling bootstrap analyses (In terms of model fitting this is the parameter combinations with variabilities that represent <strong>parameter estimation uncertainties</strong>.).
</p>
</li>
<li>
<p> Y: <em>a num_bootstrapSample by m matrix</em> which stores the nonlinearFunction evaluated at the corresponding bootstrap analyses results in matrix bootstrapX above. In the context of model fitting each row corresponds to <strong>the model simulations</strong>.
</p>
</li>
<li>
<p> runSetting: identical to what is given as CGNM_result but in addition including num_bootstrapSample and indicesToUseAsInitialIterates.</p>
</li>
</ol>
<h3>Examples</h3>

<pre><code class="language-R">##lip-flop kinetics (an example known to have two distinct solutions)

model_analytic_function=function(x){

 observation_time=c(0.1,0.2,0.4,0.6,1,2,3,6,12)
 Dose=1000
 F=1

 ka=x[1]
 V1=x[2]
 CL_2=x[3]
 t=observation_time

 Cp=ka*F*Dose/(V1*(ka-CL_2/V1))*(exp(-CL_2/V1*t)-exp(-ka*t))

 log10(Cp)
}

observation=log10(c(4.91, 8.65, 12.4, 18.7, 24.3, 24.5, 18.4, 4.66, 0.238))

CGNM_result=Cluster_Gauss_Newton_method(
nonlinearFunction=model_analytic_function,
targetVector = observation, num_iteration = 10, num_minimizersToFind = 100,
initial_lowerRange = c(0.1,0.1,0.1), initial_upperRange =  c(10,10,10),
lowerBound=rep(0,3), ParameterNames=c("Ka","V1","CL_2"), saveLog = FALSE)

CGNM_bootstrap=Cluster_Gauss_Newton_Bootstrap_method(CGNM_result,
     nonlinearFunction=model_analytic_function, num_bootstrapSample=100)

plot_paraDistribution_byHistogram(CGNM_bootstrap)

</code></pre>


</div>