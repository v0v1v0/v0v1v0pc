<div class="container">

<table style="width: 100%;"><tr>
<td>corFunctions</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fast implementations of (robust) correlation estimators</h2>

<h3>Description</h3>

<p>Estimate the correlation of two vectors via fast C++ implementations, with a
focus on robust and nonparametric methods.
</p>


<h3>Usage</h3>

<pre><code class="language-R">corPearson(x, y)

corSpearman(x, y, consistent = FALSE)

corKendall(x, y, consistent = FALSE)

corQuadrant(x, y, consistent = FALSE)

corM(
  x,
  y,
  prob = 0.9,
  initial = c("quadrant", "spearman", "kendall", "pearson"),
  tol = 1e-06
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>numeric vectors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>consistent</code></td>
<td>
<p>a logical indicating whether a consistent estimate at the
bivariate normal distribution should be returned (defaults to <code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>numeric; probability for the quantile of the
<code class="reqn">\chi^{2}</code> distribution to be used for tuning the Huber
loss function (defaults to 0.9).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial</code></td>
<td>
<p>a character string specifying the starting values for the
Huber M-estimator.  For <code>"quadrant"</code> (the default), <code>"spearman"</code>
or <code>"kendall"</code>, the consistent version of the respecive correlation
measure is used together with the medians and MAD's.  For <code>"pearson"</code>,
the Pearson correlation is used together with the means and standard
deviations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>a small positive numeric value to be used for determining
convergence.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>corPearson</code> estimates the classical Pearson correlation.
<code>corSpearman</code>, <code>corKendall</code> and <code>corQuadrant</code> estimate the
Spearman, Kendall and quadrant correlation, respectively, which are
nonparametric correlation measures that are somewhat more robust.
<code>corM</code> estimates the correlation based on a bivariate M-estimator of
location and scatter with a Huber loss function, which is sufficiently
robust in the bivariate case, but loses robustness with increasing dimension.
</p>
<p>The nonparametric correlation measures do not estimate the same population
quantities as the Pearson correlation, the latter of which is consistent at
the bivariate normal model.  Let <code class="reqn">\rho</code> denote the population
correlation at the normal model.  Then the Spearman correlation estimates
<code class="reqn">(6/\pi) \arcsin(\rho/2)</code>, while the Kendall and
quadrant correlation estimate
<code class="reqn">(2/\pi) \arcsin(\rho)</code>.  Consistent estimates are
thus easily obtained by taking the corresponding inverse expressions.
</p>
<p>The Huber M-estimator, on the other hand, is consistent at the bivariate
normal model.
</p>


<h3>Value</h3>

<p>The respective correlation estimate.
</p>


<h3>Note</h3>

<p>The Kendall correlation uses a naive <code class="reqn">n^2</code> implementation if
<code class="reqn">n &lt; 30</code> and a fast <code class="reqn">O(n \log(n))</code> implementation for
larger values, where <code class="reqn">n</code> denotes the number of observations.
</p>
<p>Functionality for removing observations with missing values is currently not
implemented.
</p>


<h3>Author(s)</h3>

<p>Andreas Alfons, <code class="reqn">O(n \log(n))</code> implementation of
the Kendall correlation by David Simcha
</p>


<h3>See Also</h3>

<p><code>ccaGrid</code>, <code>ccaProj</code>,
<code>cor</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## generate data
library("mvtnorm")
set.seed(1234)  # for reproducibility
sigma &lt;- matrix(c(1, 0.6, 0.6, 1), 2, 2)
xy &lt;- rmvnorm(100, sigma=sigma)
x &lt;- xy[, 1]
y &lt;- xy[, 2]

## compute correlations

# Pearson correlation
corPearson(x, y)

# Spearman correlation
corSpearman(x, y)
corSpearman(x, y, consistent=TRUE)

# Kendall correlation
corKendall(x, y)
corKendall(x, y, consistent=TRUE)

# quadrant correlation
corQuadrant(x, y)
corQuadrant(x, y, consistent=TRUE)

# Huber M-estimator
corM(x, y)

</code></pre>


</div>