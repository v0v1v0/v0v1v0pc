<div class="container">

<table style="width: 100%;"><tr>
<td>coxphf-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cox Regression with Firth's Penalized Likelihood</h2>

<h3>Description</h3>

<p>Implements Firth's penalized maximum likelihood bias reduction method  for Cox regression which has been 
shown to provide a solution in case of monotone likelihood (nonconvergence of likelihood function).
The program fits profile penalized likelihood confidence intervals which were proved to outperform
Wald confidence intervals.
</p>


<h3>Details</h3>

<p>The phenomenon of monotone likelihood in a sample causes parameter estimates of a Cox model to diverge, 
with infinite standard errors. Therefore, classical maximum likelihood analysis fails; the usual Wald confidence 
intervals cover the whole range of real numbers. Monotone likelihood appears if there is single covariate 
or a linear combination of covariates such that at each event time, out of all individuals being at risk at that time, 
the individual with the highest (or at each event time the individual with the lowest) value for that covariate 
or linear combination experiences the event. It was shown that analysis by Firth's penalized likelihood method, 
particularly in conjunction with the computation of profile likelihood confidence intervals and penalized 
likelihood ratio tests is superior to maximum likelihood analysis. It completely removes the convergence
problem mentioned in the paragraph on CONVERGENCE of the description of the function <code>coxph</code>. 
The <code>formula</code> may involve time-dependent effects or time-dependent covariates. The response may be given 
in counting process style, but it cannot be used for multivariate failure times, as the program has no option 
to fit a robust covariance matrix. The user is responsible for the independency of observations within each risk set, i.e., 
the same individual should not appear twice within the same risk set.
</p>
<p>The package coxphf provides a comprehensive tool to facilitate the application of Firth's penalized 
likelihood method to Cox regression analysis. The core routines are written in Fortran 90, (and to our knowledge this is the first package written in Fortran 90). Some description of the problem of monotone likelihood
and Firth's penalized likelihood method as a solution can be found the web page 
<a href="https://cemsiis.meduniwien.ac.at/en/kb/science-research/software/statistical-software/fccoxphf/">https://cemsiis.meduniwien.ac.at/en/kb/science-research/software/statistical-software/fccoxphf/</a>.
</p>
<p>Version 1.13  now includes a convergence check and issues a warning in case of non-convergence. Profile likelihood confidence intervals or 
the estimation of the penalized likelihood ratio $p$-values can be vulnerable
non-convergence for numerical issues. In case of non-convergence problems, we suggest to first compare the output values iter.ci with the input parameter maxit. 
Then, set maxstep to a smaller value, e.g., 0.1 and increase the number of allowed iterations to e.g. 500. This setting may slow down convergence for some 
of the confidence limits, but proved robust also in extreme data sets.
</p>


<h3>Author(s)</h3>

<p>Georg Heinze &lt;georg.heinze@meduniwien.ac.at&gt; and Meinhard Ploner
</p>


<h3>References</h3>

<p>Firth D (1993). Bias reduction of maximum likelihood estimates. <em>Biometrika</em> 80:27–38.
Heinze G and Schemper M (2001). A Solution to the Problem of Monotone Likelihood in Cox Regression. <em>Biometrics</em> 57(1):114–119. 
Heinze G (1999). Technical Report 10/1999: The application of Firth's procedure to Cox and logistic regression. Section of Clinical Biometrics, Department of Medical Computer Sciences, University of Vienna, Vienna.
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://cemsiis.meduniwien.ac.at/kb/wf/software/statistische-software/fccoxphf/">https://cemsiis.meduniwien.ac.at/kb/wf/software/statistische-software/fccoxphf/</a>
</p>
</li>
<li>
<p> Report bugs at <a href="https://github.com/georgheinze/coxphf/issues/">https://github.com/georgheinze/coxphf/issues/</a>
</p>
</li>
</ul>
</div>