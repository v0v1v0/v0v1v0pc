<div class="container">

<table style="width: 100%;"><tr>
<td>make_subcort</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Make the subcortical components of a <code>"xifti"</code>
</h2>

<h3>Description</h3>

<p>Coerce subcortical data into valid entries for <code>xifti$data$subcort</code>
and <code>xifti$meta$subcort</code>. The data arguments can be matrices/arrays or
NIFTI file paths. If the mask is not provided, it will be inferred from the
labels.
</p>


<h3>Usage</h3>

<pre><code class="language-R">make_subcort(vol, labs, mask = NULL, idx = NULL, validate_mask = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>vol</code></td>
<td>
<p>represents the data values of the subcortex. It is either a NIFTI
file path, 3D/4D data array (<code class="reqn">i \times j \times k \times T</code>), or a vectorized data
matrix (<code class="reqn">V_S</code> voxels by <code class="reqn">T</code> measurements). If it's vectorized, the voxels
should be in spatial order.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labs</code></td>
<td>
<p>represents the brainstructure labels of each voxel: see
<code>substructure_table</code>. It is either a NIFTI file path, a 3D data array
(<code class="reqn">i \times j \times k</code>) of numeric brainstructure indices, or a <code class="reqn">V_S</code> length
vector in spatial order with brainstructure names as factors or integer
indices. The indices should be 3-22 (2 and 3 correspond to left and right
cortex, respectively) or 1-19 (cortex labels omitted), with 0 representing
out-of-mask voxels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mask</code></td>
<td>
<p>is a NIFTI file path or logical 3D data array (<code class="reqn">i \times j \times k</code>) where <code>TRUE</code>
values indicate subcortical voxels (in-mask). If it is not provided, the
mask will be inferred from voxels with labels <code>0</code> or <code>NA</code> in
<code>subcortLabs</code>. If <code>subcortLabs</code> are vectorized and <code>subcortMask</code>
is not provided, the mask cannot be inferred so an error will occur.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>idx</code></td>
<td>
<p>Only applies if <code>vol</code> is a NIFTI file path. This is a numeric
vector indicating the data indices to read. If <code>NULL</code> (default), read
all the data. Must be a subset of the indices present in the file, or an
error will occur.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>validate_mask</code></td>
<td>
<p>If <code>mask</code> is provided, set this to <code>TRUE</code> to
check that the mask only removes voxels with <code>NA</code> and <code>0</code> values
in <code>vol</code> and <code>labs</code>. Default: <code>FALSE</code> (saves time).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>To read in the labels as the primary data, use the labels NIFTI for both
<code>vol</code> and <code>labs</code>.
</p>


<h3>Value</h3>

<p>A list with components "data", "labels", "mask", and "trans_mat". The
first two will be vectorized and ordered spatially.
</p>
<p>The volume can be recovered using:
<code>vol &lt;- unvec_vol(data, mask, fill=NA)</code>
<code>labs &lt;- unvec_vol(labels, mask, fill=0)</code>
</p>


<h3>Label Levels</h3>

<p><code>xifti$meta$subcort$labels</code> is a factor with the following levels:
</p>

<ol>
<li>
<p>Cortex-L
</p>
</li>
<li>
<p>Cortex-R
</p>
</li>
<li>
<p>Accumbens-L
</p>
</li>
<li>
<p>Accumbens-R
</p>
</li>
<li>
<p>Amygdala-L
</p>
</li>
<li>
<p>Amygdala-R
</p>
</li>
<li>
<p>Brain Stem
</p>
</li>
<li>
<p>Caudate-L
</p>
</li>
<li>
<p>Caudate-R
</p>
</li>
<li>
<p>Cerebellum-L
</p>
</li>
<li>
<p>Cerebellum-R
</p>
</li>
<li>
<p>Diencephalon-L
</p>
</li>
<li>
<p>Diencephalon-R
</p>
</li>
<li>
<p>Hippocampus-L
</p>
</li>
<li>
<p>Hippocampus-R
</p>
</li>
<li>
<p>Pallidum-L
</p>
</li>
<li>
<p>Pallidum-R
</p>
</li>
<li>
<p>Putamen-L
</p>
</li>
<li>
<p>Putamen-R
</p>
</li>
<li>
<p>Thalamus-L
</p>
</li>
<li>
<p>Thalamus-R
</p>
</li>
</ol>
<p>These correspond to the same structures as given by
<code>ft_read_cifti</code> in the <code>cifti-matlab</code> MATLAB toolbox. Note that
the first two levels (left and right cortex) are not used.
</p>


</div>