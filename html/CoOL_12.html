<div class="container">

<table style="width: 100%;"><tr>
<td>CoOL_5_layerwise_relevance_propagation</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Layer-wise relevance propagation of the fitted non-negative neural network</h2>

<h3>Description</h3>

<p>Calculates risk contributions for each exposure and a baseline using layer-wise relevance propagation of the fitted non-negative neural network and data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CoOL_5_layerwise_relevance_propagation(X, model)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>The exposure data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>The fitted the non-negative neural network.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For each individual:</p>
<p style="text-align: center;"><code class="reqn">
P(Y=1|X^+)=R^b+\sum_iR^X_i
</code>
</p>

<p>The below procedure is conducted for all individuals in a one by one fashion. The baseline risk, $R^b$, is simply parameterised in the model. The decomposition of the risk contributions for exposures, $R^X_i$, takes 3 steps:
</p>
<p>Step 1 - Subtract the baseline risk, $R^b$:
</p>
<p style="text-align: center;"><code class="reqn">
R^X_k =  P(Y=1|X^+)-R^b
</code>
</p>

<p>Step 2 - Decompose to the hidden layer:
</p>
<p style="text-align: center;"><code class="reqn">
R^{X}_j =  \frac{H_j w_{j,k}}{\sum_j(H_j w_{j,k})} R^X_k
</code>
</p>

<p>Where $H_j$ is the value taken by each of the $ReLU()_j$ functions for the specific individual.
</p>
<p>Step 3 - Hidden layer to exposures:
</p>
<p style="text-align: center;"><code class="reqn">
R^{X}_i = \sum_j \Big(\frac{X_i^+ w_{i,j}}{\sum_i( X_i^+ w_{i,j})}R^X_j\Big)
</code>
</p>

<p>This creates a dataset with the dimensions equal to the number of individuals times the number of exposures plus a baseline risk value, which can be termed a risk contribution matrix. Instead of exposure values, individuals are given risk contributions, R^X_i.
</p>


<h3>Value</h3>

<p>A data frame with the risk contribution matrix [number of individuals, risk contributors + the baseline risk].
</p>


<h3>References</h3>

<p>Rieckmann, Dworzynski, Arras, Lapuschkin, Samek, Arah, Rod, Ekstrom. 2022. Causes of outcome learning: A causal inference-inspired machine learning approach to disentangling common combinations of potential causes of a health outcome. International Journal of Epidemiology &lt;https://doi.org/10.1093/ije/dyac078&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R">#See the example under CoOL_0_working_example
</code></pre>


</div>