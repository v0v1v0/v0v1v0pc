<div class="container">

<table style="width: 100%;"><tr>
<td>cglm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Estimates the ratio of the regression coefficients and the dispersion parameter
in conditional generalized linear models for clustered data. 
</h2>

<h3>Description</h3>

<p><code>cglm</code> estimates the ratio of the regression coefficients and the 
dispersion parameter in conditional generalized linear models. This 
is of particular interest in the so-called case-time-control design.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cglm(method, formula, data, id, link, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>a string specifying the desired estimation method; either <code>"ts"</code> for 
two-step estimation, or <code>"cml"</code> for conditional maximum likelihood estimation.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>

<p>a symbolic description of the model to be fitted. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>a data frame containing the variables in the model. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>

<p>a string containing the name of the cluster identification variable. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>

<p>a string specifying the desired link function. This argument is not used 
when <code>method="cml"</code>.   
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>optional arguments passed on to the <code>nleqslv</code> function or the <code>optim</code>
function, which are used to solve the estimating equations when 
<code>method="ts"</code> and <code>method="cml"</code>, respectively. See the help pages 
for <code>nleqslv</code> and <code>optim</code>.      
</p>
</td>
</tr>
</table>
<h3>Details</h3>

 
<p>Let <code class="reqn">y_{ij}</code> and <code class="reqn">x_{ij}</code> be the outcome and covariate(s) for subject 
<code class="reqn">j</code> in cluster <code class="reqn">i</code>, respectively. Consider the conditional generalized 
linear model
</p>
<p style="text-align: center;"><code class="reqn">p(y_{ij}|i,x_{ij})=\textrm{exp}\left[\frac{\theta_{ij}y_{ij}-A(\theta_{ij})}{\phi}+k(y_{ij},\phi)\right]</code>
</p>

<p>where 
</p>
<p style="text-align: center;"><code class="reqn">\theta_{ij}=\eta\{E(y_{ij}|x_{ij})\}=b_i+\beta x_{ij}.</code>
</p>

<p><code>cglm</code> estimates the ratio 
</p>
<p style="text-align: center;"><code class="reqn">\beta / \phi.</code>
</p>

<p>This ratio is of particular interest in so-called case-time-control designs;
see Sjolander (2016) and Sjolander and Ning (2018) for details. 
Two estimation methods are allowed; the two-step method proposed by Sjolander (2016) and the 
conditional maximum likelihood method proposed by Sjolander and Ning (2018).    
</p>


<h3>Value</h3>

<p>An object of class <code>"cglm"</code> is a list containing 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>

<p>the matched call. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>

<p>the ratio of the estimated coefficients and the estimated dispersion parameter.     
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>

<p>the variance-covariance matrix. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>

<p>was a solution found to the estimating equations?  
</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Missing data are not allowed.
</p>


<h3>Author(s)</h3>

<p>Arvid Sjolander. 
</p>


<h3>References</h3>

<p>Sjolander A. (2017). The case-time-control method for non-binary exposures. 
<em>Sociological Methodology</em> <b>47</b>(1), 182-211.
</p>
<p>Sjolander A., Ning Y. (2018). A general and robust estimation method for 
the case-time-control design. 
<em>Sociological Methodology</em> <b>49</b>(1), 349-365.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(teenpov)

fit.ide &lt;- cglm(method="ts", formula=hours~nonpov+inschool+spouse+age+mother, 
  data=teenpov, id="ID", link="identity")
summary(fit.ide)

fit.log &lt;- cglm(method="ts", formula=hours~nonpov+inschool+spouse+age+mother, 
  data=teenpov, id="ID", link="log")
summary(fit.log)

fit.cglm &lt;- cglm(method="cml", formula=hours~nonpov+inschool+spouse+age+mother,
  data=teenpov, id="ID")
summary(fit.cglm)

</code></pre>


</div>