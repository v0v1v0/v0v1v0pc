<div class="container">

<table style="width: 100%;"><tr>
<td>MultiEOF</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>EOF analysis of multiple variables starting from an array (reduced 
version)</h2>

<h3>Description</h3>

<p>This function performs EOF analysis over multiple variables, 
accepting in input an array with a dimension <code>"var"</code> for each variable to 
analyse. Based on Singular Value Decomposition. For each field the EOFs are 
computed and the corresponding PCs are standardized (unit variance, zero mean); 
the minimum number of principal components needed to reach the user-defined 
variance is retained. The function weights the input data for the latitude 
cosine square root.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MultiEOF(
  data,
  lon,
  lat,
  dates,
  time = NULL,
  lon_dim = "lon",
  lat_dim = "lat",
  time_dim = "ftime",
  sdate_dim = "sdate",
  var_dim = "var",
  neof_max = 40,
  neof_composed = 5,
  minvar = 0.6,
  lon_lim = NULL,
  lat_lim = NULL,
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A multidimensional array with dimension <code>"var"</code>, containing 
the variables to be analysed. The other diemnsions follow the same structure
as the <code>"exp"</code> element of a 's2dv_cube' object. Latitudinal 
dimension accepted names: 'lat', 'lats', 'latitude', 'y', 'j', 'nav_lat'. 
Longitudinal dimension accepted names: 'lon', 'lons','longitude', 'x', 'i', 
'nav_lon'. NAs can exist but it should be consistent along 'time_dim'. That 
is, if one grid point has NAs for each variable, all the time steps at this 
point should be NAs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lon</code></td>
<td>
<p>Vector of longitudes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lat</code></td>
<td>
<p>Vector of latitudes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dates</code></td>
<td>
<p>Vector or matrix of dates in POSIXct format.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>Deprecated parameter, it has been substituted by 'dates'. It will 
be removed in the next release.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lon_dim</code></td>
<td>
<p>A character string indicating the name of the longitudinal 
dimension. By default, it is set to 'lon'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lat_dim</code></td>
<td>
<p>A character string indicating the name of the latitudinal 
dimension. By default, it is set to 'lat'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time_dim</code></td>
<td>
<p>A character string indicating the name of the temporal 
dimension. By default, it is set to 'time'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdate_dim</code></td>
<td>
<p>A character string indicating the name of the start date 
dimension. By default, it is set to 'sdate'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var_dim</code></td>
<td>
<p>A character string indicating the name of the variable 
dimension. By default, it is set to 'var'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>neof_max</code></td>
<td>
<p>Maximum number of single eofs considered in the first 
decomposition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>neof_composed</code></td>
<td>
<p>Number of composed eofs to return in output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minvar</code></td>
<td>
<p>Minimum variance fraction to be explained in first decomposition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lon_lim</code></td>
<td>
<p>Vector with longitudinal range limits for the calculation for 
all input variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lat_lim</code></td>
<td>
<p>Vector with latitudinal range limits for the calculation for 
all input variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>An integer indicating the number of cores to use for parallel 
computation. The default value is NULL.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coeff</code></td>
<td>

<p>An array of principal components with dimensions 'time_dim', 'sdate_dim', 
number of eof, rest of the dimensions of 'data' except 'lon_dim' and 
'lat_dim'. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variance</code></td>
<td>

<p>An array of explained variances with dimensions 'eof' and the rest of the 
dimensions of 'data' except 'time_dim', 'sdate_dim', 'lon_dim' and 
'lat_dim'.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eof_pattern</code></td>
<td>

<p>An array of EOF patterns obtained by regression with dimensions: 'eof' and 
the rest of the dimensions of 'data' except 'time_dim' and 'sdate_dim'.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mask</code></td>
<td>

<p>An array of the mask with dimensions ('lon_dim', 'lat_dim', rest of the 
dimensions of 'data' except 'time_dim'). It is made from 'data', 1 for the 
positions that 'data' has value and NA for the positions that 'data' has NA. 
It is used to replace NAs with 0s for EOF calculation and mask the result 
with NAs again after the calculation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coordinates</code></td>
<td>

<p>Longitudinal and latitudinal coordinates vectors.
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jost von Hardenberg - ISAC-CNR, <a href="mailto:j.vonhardenberg@isac.cnr.it">j.vonhardenberg@isac.cnr.it</a>
</p>
<p>Paolo Davini - ISAC-CNR, <a href="mailto:p.davini@isac.cnr.it">p.davini@isac.cnr.it</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">exp &lt;- array(runif(1280)*280, dim = c(dataset = 2, member = 2, sdate = 3, 
                                     ftime = 3, lat = 4, lon = 4, var = 1))
lon &lt;- seq(0, 3)
lat &lt;- seq(47, 44)
dates &lt;- c("2000-11-01", "2000-12-01", "2001-01-01", "2001-11-01", 
          "2001-12-01", "2002-01-01", "2002-11-01", "2002-12-01", "2003-01-01")
Dates &lt;- as.POSIXct(dates, format = "%Y-%m-%d")
dim(Dates) &lt;- c(ftime = 3, sdate = 3)
cal &lt;- MultiEOF(data = exp, lon = lon, lat = lat, dates = Dates)
</code></pre>


</div>