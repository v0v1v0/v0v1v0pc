<div class="container">

<table style="width: 100%;"><tr>
<td>FindPosteriorMeanRate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Find Posterior Mean Rate of Sample Occurrence for Poisson Process Model</h2>

<h3>Description</h3>

<p>Given output from the Poisson process fitting function PPcalibrate calculate
the posterior mean rate of sample occurrence (i.e., the underlying Poisson process
rate <code class="reqn">\lambda(t)</code>) together with specified probability intervals, on a given calendar age
grid (provided in cal yr BP).
</p>
<p><strong>Note:</strong> If you want to calculate and plot the result, use
PlotPosteriorMeanRate instead.
</p>
<p>For more information read the vignette: <br><code>vignette("Poisson-process-modelling", package = "carbondate")</code>
</p>


<h3>Usage</h3>

<pre><code class="language-R">FindPosteriorMeanRate(
  output_data,
  calendar_age_sequence,
  n_posterior_samples = 5000,
  interval_width = "2sigma",
  bespoke_probability = NA,
  n_burn = NA,
  n_end = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>output_data</code></td>
<td>
<p>The return value from the updating function
PPcalibrate. Optionally, the output data can have an extra list item
named <code>label</code> which is used to set the label on the plot legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>calendar_age_sequence</code></td>
<td>
<p>A vector containing the calendar age grid (in cal yr BP) on which to
calculate the posterior mean rate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_posterior_samples</code></td>
<td>
<p>Number of samples it will draw, after having removed <code>n_burn</code>,
from the (thinned) MCMC realisations stored in <code>output_data</code> to estimate the
rate <code class="reqn">\lambda(t)</code>. These samples may be repeats if the number of, post burn-in,
realisations is less than <code>n_posterior_samples</code>. If not given, 5000 is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interval_width</code></td>
<td>
<p>The confidence intervals to show for both the
calibration curve and the predictive density. Choose from one of <code>"1sigma"</code> (68.3%),
<code>"2sigma"</code> (95.4%) and <code>"bespoke"</code>. Default is <code>"2sigma"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bespoke_probability</code></td>
<td>
<p>The probability to use for the confidence interval
if <code>"bespoke"</code> is chosen above. E.g., if 0.95 is chosen, then the 95% confidence
interval is calculated. Ignored if <code>"bespoke"</code> is not chosen.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_burn</code></td>
<td>
<p>The number of MCMC iterations that should be discarded as burn-in (i.e.,
considered to be occurring before the MCMC has converged). This relates to the number
of iterations (<code>n_iter</code>) when running the original update functions (not the thinned <code>output_data</code>).
Any MCMC iterations before this are not used in the calculations. If not given, the first half of the
MCMC chain is discarded. Note: The maximum value that the function
will allow is <code>n_iter - 100 * n_thin</code> (where <code>n_iter</code> and <code>n_thin</code> are the arguments that were given to
PPcalibrate) which would leave only 100 of the (thinned) values in <code>output_data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_end</code></td>
<td>
<p>The last iteration in the original MCMC chain to use in the calculations. Assumed to be the
total number of iterations performed, i.e. <code>n_iter</code>, if not given.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list, each item containing a data frame of the <code>calendar_age_BP</code>, the <code>rate_mean</code>
and the confidence intervals for the rate - <code>rate_ci_lower</code> and <code>rate_ci_upper</code>.
</p>


<h3>See Also</h3>

<p>PlotPosteriorMeanRate
</p>


<h3>Examples</h3>

<pre><code class="language-R"># NOTE: All these examples are shown with a small n_iter and n_posterior_samples
# to speed up execution.
# Try n_iter and n_posterior_samples as the function defaults.

pp_output &lt;- PPcalibrate(
    pp_uniform_phase$c14_age,
    pp_uniform_phase$c14_sig,
    intcal20,
    n_iter = 1000,
    show_progress = FALSE)

# Default plot with 2 sigma interval
FindPosteriorMeanRate(pp_output, seq(450, 640, length=10), n_posterior_samples = 100)
</code></pre>


</div>