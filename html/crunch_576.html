<div class="container">

<table style="width: 100%;"><tr>
<td>Subtotal-class</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Subtotals and headings</h2>

<h3>Description</h3>

<p>Subtotals and headings for Categorical Variables and Multiple Response
Variables. These are especially useful for making aggregates across
multiple categories (sometimes referred to as <em>nets</em>, <em>top box</em>, or
<em>top 2 box</em>).
</p>
<p>Subtotals and headings for Categorical Variables and Multiple Response
Variables. These are especially useful for making aggregates across
multiple categories (sometimes referred to as <em>nets</em>, <em>top box</em>, or
<em>top 2 box</em>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">Subtotal(
  name,
  categories = NULL,
  position = c("relative", "top", "bottom"),
  after = NULL,
  before = NULL,
  negative = NULL,
  na.rm = TRUE,
  variable = NULL,
  id = NULL,
  alias = NULL
)

Heading(name, position = c("relative", "top", "bottom"), after = NULL)

subtotals(x)

subtotals(x) &lt;- value

Subtotal(
  name,
  categories = NULL,
  position = c("relative", "top", "bottom"),
  after = NULL,
  before = NULL,
  negative = NULL,
  na.rm = TRUE,
  variable = NULL,
  id = NULL,
  alias = NULL
)

is.Subtotal(x)

is.Heading(x)

are.Subtotals(x)

are.Headings(x)

Heading(name, position = c("relative", "top", "bottom"), after = NULL)

## S4 method for signature 'CrunchVariable'
subtotals(x)

## S4 method for signature 'VariableTuple'
subtotals(x)

## S4 replacement method for signature 'CrunchVariable,ANY'
subtotals(x) &lt;- value

## S4 replacement method for signature 'CrunchVariable,'NULL''
subtotals(x) &lt;- value

Subtotal(
  name,
  categories = NULL,
  position = c("relative", "top", "bottom"),
  after = NULL,
  before = NULL,
  negative = NULL,
  na.rm = TRUE,
  variable = NULL,
  id = NULL,
  alias = NULL
)

is.Subtotal(x)

is.Heading(x)

are.Subtotals(x)

are.Headings(x)

Heading(name, position = c("relative", "top", "bottom"), after = NULL)

## S4 method for signature 'CrunchVariable'
subtotals(x)

## S4 method for signature 'VariableTuple'
subtotals(x)

## S4 replacement method for signature 'CrunchVariable,ANY'
subtotals(x) &lt;- value

## S4 replacement method for signature 'CrunchVariable,'NULL''
subtotals(x) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>character the name of the subtotal or heading</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>categories</code></td>
<td>
<p>character or numeric the category names or ids for subtotal
only</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>position</code></td>
<td>
<p>character one of "relative", "top", or "bottom". Determines
the position of the subtotal or heading, either at the top, bottom, or
relative to another category in the cube (default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>after</code></td>
<td>
<p>character or numeric if <code>position</code> is "relative", then the
category name or id to position the subtotal or heading after. If not supplied
this defaults to the last of the <code>categories</code> supplied to <code>Subtotal</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>before</code></td>
<td>
<p>character or numeric if <code>position</code> is "relative" and also the
subtotal is on a Multiple Response variable only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>negative</code></td>
<td>
<p>character or numeric of the category names or ids to be subtracted
for subtotals only</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>For Multiple Response subtotals, whether to remove missings before
calculating the subtotal (so that if <code>na.rm=TRUE</code> and there is one missing and
one selected, the response would selected instead of missing). This defaults to
<code>TRUE</code> to match how the crunch web application behaves.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variable</code></td>
<td>
<p>For Multiple Response subtotals, the parent MR variable that
contains the subvariables that are being subtotaled (defaults to the variable
that is having the Subtotal added to it)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>For Multiple Response subtotals, an optional number or string to use
as the new insertion's id (defaults to a sequential number).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alias</code></td>
<td>
<p>For Multiple Response subtotals, an optional string to use as the
new insertion's alias (defaults to letting the server choose the alias)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>either a variable or CrunchCube object to add or get subtotal
transforms for, for <code>is.Subtotal()</code> and <code>is.Heading()</code> an object to test if
it is either a Subtotal or Heading</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>For <code style="white-space: pre;">⁠[&lt;-⁠</code>, the replacement Subtotal to insert</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>To see the subtotals or headings set for a variable, use <code>subtotals(variable)</code>
</p>
<p>To see the subtotals or headings set for a variable, use <code>subtotals(variable)</code>
</p>


<h3>Adding Subtotals and Headings</h3>

<p>Subtotals and headings can be added either by passing a list of <code>Subtotal</code>s
or <code>Heading</code>s, or they can be added one at a time by passing <code>Subtotal</code> or
<code>Heading</code> to <code>subtotals(variable)</code> alone.
</p>
<p>Adding subtotals or headings is additive; meaning that subtotals or headings
that are already set on the variable are not removed when new subtotals or
headings are added. To remove all subtotals and headings, set
<code>subtotals(variable)</code> to <code>NULL</code>.
</p>
<p>To get an array of just the subtotal rows from a CrunchCube, use the function
<code>subtotalArray(CrunchCube)</code>.
</p>
<p>Subtotals and headings can be added either by passing a list of <code>Subtotal</code>s
or <code>Heading</code>s, or they can be added one at a time by passing <code>Subtotal</code> or
<code>Heading</code> to <code>subtotals(variable)</code> alone.
</p>
<p>Adding subtotals or headings is additive; meaning that subtotals or headings
that are already set on the variable are not removed when new subtotals or
headings are added. To remove all subtotals and headings, set
<code>subtotals(variable)</code> to <code>NULL</code>.
</p>
<p>To get an array of just the subtotal rows from a CrunchCube, use the function
<code>subtotalArray(CrunchCube)</code>.
</p>


<h3>Working with Subtotals and headings</h3>

<p>When interacting programmatically with Subtotals and Headings, it can be
useful to be able to tell if something is a Subtotal or a Heading. The <code style="white-space: pre;">⁠is.*⁠</code>
family of methods are useful here: the singular versions (<code>is.Subtotal</code> and
<code>is.Heading</code>) take a single object and returns <code>TRUE</code> if the object is either
a Subtotal or a Heading and <code>FALSE</code> if not; the plural versions
(<code>are.Subtotals</code> and <code>are.Headings</code>) take a list of objects (including an
<code>Insertions</code> object) and returns a vector of <code>TRUE</code>/<code>FALSE</code>s.
</p>
<p>When interacting programmatically with Subtotals and Headings, it can be
useful to be able to tell if something is a Subtotal or a Heading. The <code style="white-space: pre;">⁠is.*⁠</code>
family of methods are useful here: the singular versions (<code>is.Subtotal</code> and
<code>is.Heading</code>) take a single object and returns <code>TRUE</code> if the object is either
a Subtotal or a Heading and <code>FALSE</code> if not; the plural versions
(<code>are.Subtotals</code> and <code>are.Headings</code>) take a list of objects (including an
<code>Insertions</code> object) and returns a vector of <code>TRUE</code>/<code>FALSE</code>s.
</p>


<h3>Removing transforms</h3>

<p><code>noTransforms()</code> is useful if you don't want to see or use any transformations like
Subtotals and Headings. This action only applies to the CrunchCube object in
R: it doesn't actually change the variables on Crunch servers or the query
that generated the CrunchCube.
</p>
<p><code>noTransforms()</code> is useful if you don't want to see or use any transformations like
Subtotals and Headings. This action only applies to the CrunchCube object in
R: it doesn't actually change the variables on Crunch servers or the query
that generated the CrunchCube.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# given a variable ds$opinion, with categories: Strongly Agree, Somewhat
# Agree, Neither Agree nor Disagree, Somewhat Disagree, and Strongly Disagree,
# to make two subtotals for Agree and Disagree:
subtotals(ds$opinion) &lt;- list(
    Subtotal(
        name = "Agree",
        categories = c("Strongly Agree", "Somewhat Agree"),
        after = "Somewhat Agree"
    ),
    Subtotal(
        name = "Disagree",
        categories = c("Strongly Disagree", "Somewhat Disagree"),
        after = "Strongly Disagree"
    )
)

# headings can also be added:
subtotals(ds$opinion) &lt;- Heading(name = "All opinions", position = "top")

# to see the subtotals and headings associated with a variable
subtotals(ds$opinion)
#        anchor         name     func    args
# 1      2        Agree subtotal 1 and 2
# 2      4     Disagree subtotal 4 and 5
# 3      0 All opinions     &lt;NA&gt;      NA

# when you use a variable with subtotals and headings in a cube, you see them
# by default
opinion_cube &lt;- crtabs(~opinion, ds)
opinion_cube
#               All opinions
#             Strongly Agree 23
#             Somewhat Agree 24
#                      Agree 47
# Neither Agree nor Disagree 18
#          Somewhat Disagree 16
#          Strongly Disagree 19
#                   Disagree 35


# to get just the subtotals,
subtotalArray(opinion_cube)
#    Agree Disagree
#       47       35

# to remove all subtotals and headings
subtotals(ds$opinion) &lt;- NULL
crtabs(~opinion, ds)
#             Strongly Agree 23
#             Somewhat Agree 24
# Neither Agree nor Disagree 18
#          Somewhat Disagree 16
#          Strongly Disagree 19

# if you want to temporarily remove subtotals and headings, you can with `noTransforms`
noTransforms(crtabs(~opinion, ds))
#             Strongly Agree             Somewhat Agree Neither Agree nor Disagree
#                         23                         24                         18
#          Somewhat Disagree          Strongly Disagree
#                         16                         19

## End(Not run)

## Not run: 
# given a variable ds$opinion, with categories: Strongly Agree, Somewhat
# Agree, Neither Agree nor Disagree, Somewhat Disagree, and Strongly Disagree,
# to make two subtotals for Agree and Disagree:
subtotals(ds$opinion) &lt;- list(
    Subtotal(
        name = "Agree",
        categories = c("Strongly Agree", "Somewhat Agree"),
        after = "Somewhat Agree"
    ),
    Subtotal(
        name = "Disagree",
        categories = c("Strongly Disagree", "Somewhat Disagree"),
        after = "Strongly Disagree"
    )
)

# headings can also be added:
subtotals(ds$opinion) &lt;- Heading(name = "All opinions", position = "top")

# to see the subtotals and headings associated with a variable
subtotals(ds$opinion)
#        anchor         name     func    args
# 1      2        Agree subtotal 1 and 2
# 2      4     Disagree subtotal 4 and 5
# 3      0 All opinions     &lt;NA&gt;      NA

# when you use a variable with subtotals and headings in a cube, you see them
# by default
opinion_cube &lt;- crtabs(~opinion, ds)
opinion_cube
#               All opinions
#             Strongly Agree 23
#             Somewhat Agree 24
#                      Agree 47
# Neither Agree nor Disagree 18
#          Somewhat Disagree 16
#          Strongly Disagree 19
#                   Disagree 35


# to get just the subtotals,
subtotalArray(opinion_cube)
#    Agree Disagree
#       47       35

# to remove all subtotals and headings
subtotals(ds$opinion) &lt;- NULL
crtabs(~opinion, ds)
#             Strongly Agree 23
#             Somewhat Agree 24
# Neither Agree nor Disagree 18
#          Somewhat Disagree 16
#          Strongly Disagree 19

# if you want to temporarily remove subtotals and headings, you can with `noTransforms`
noTransforms(crtabs(~opinion, ds))
#             Strongly Agree             Somewhat Agree Neither Agree nor Disagree
#                         23                         24                         18
#          Somewhat Disagree          Strongly Disagree
#                         16                         19

## End(Not run)

</code></pre>


</div>