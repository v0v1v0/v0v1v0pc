<div class="container">

<table style="width: 100%;"><tr>
<td>Explore.WS.Corr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Explore within-subject correlations (reliabilities)
</h2>

<h3>Description</h3>

<p>This function allows for exploring the  within-subject (test-retest) correlation (<code class="reqn">R</code>) structure in the data, taking relevant covariates into account. Estimated correlations as a function of time lag (= absolute difference between measurement moments <code class="reqn">t_1</code> and <code class="reqn">t_2</code>) are provided as well as their confidence intervals (based on a non-parametric bootstrap). 
</p>


<h3>Usage</h3>

<pre><code class="language-R">Explore.WS.Corr(OLS.Model=" ", Dataset, Id, Time, 
Alpha=0.05, Smoother.Span=.2, Number.Bootstrap=100, 
Seed=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>OLS.Model</code></td>
<td>
<p><code>OLS.Model</code> is a formula passed to <code>lm</code> (to obtain the OLS residuals, i.e., to take covariates into account in the computation of <code class="reqn">R</code>). <code>OLS.Model</code> should thus be a formula that specifies the outcome of interest followed by a ~ sign and the covariates to be taken into account, e.g. 
</p>
<p><code>OLS.Model="Outcome~1+as.factor(Time) + as.factor(Treatment)"</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Dataset</code></td>
<td>
<p>A <code>data.frame</code> that should consist of multiple lines per subject ('long' format).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Id</code></td>
<td>
<p>The subject indicator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Time</code></td>
<td>
<p>The time indicator. Should be coded as <code class="reqn">1</code>, <code class="reqn">2</code>, etc.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Alpha</code></td>
<td>
<p>The <code class="reqn">\alpha</code>-level to be used in the non-parametric bootstrap-based Confidence Interval for <code class="reqn">R</code>. Default <code>Alpha=0.05</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Smoother.Span</code></td>
<td>
<p>A smoothing (loess) technique is used to estimate <code class="reqn">R</code> as a function of time lag. The smoother span gives the proportion of points in the plot which influence the smooth at each value. Larger values give more smoothness. For details, see <a href="https://stat.ethz.ch/R-manual/R-patched/library/stats/html/lowess.html">https://stat.ethz.ch/R-manual/R-patched/library/stats/html/lowess.html</a>. Defauls <code>Smoother.Span=.2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Number.Bootstrap</code></td>
<td>
<p>The number of non-parametric bootstrap samples to be used to estimate the Confidence Interval for <code class="reqn">R</code>. Default <code>Number.Bootstrap=100</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Seed</code></td>
<td>
<p>The seed to be used in the bootstrap. Default <code>Seed=1</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Est.Corr</code></td>
<td>
<p>The estimated correlations <code class="reqn">R</code> as a function of time lag. A smoothing (loess) technique is used to estimate <code class="reqn">R</code> as a function of time lag (based on the output in <code>All.Corrs).</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>All.Corrs</code></td>
<td>
<p>A <code>matrix</code> that contains the estimated correlations <code class="reqn">R</code> for all individual time lags.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Bootstrapped.Corrs</code></td>
<td>
<p>A <code>matrix</code> that contains the estimated correlations <code class="reqn">R</code> as a function of time lag in the bootstrapped samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Alpha</code></td>
<td>
<p>The <code class="reqn">\alpha</code> level used in the estimation of the confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI.Upper</code></td>
<td>
<p>The upper bounds of the confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI.Lower</code></td>
<td>
<p>The lower bounds of the confidence intervals.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Wim Van der Elst, Geert Molenberghs, Ralf-Dieter Hilgers, &amp; Nicole Heussen
</p>


<h3>References</h3>

<p>Van der Elst, W., Molenberghs, G., Hilgers, R., &amp; Heussen, N. (2015). Estimating the reliability of repeatedly measured endpoints based on linear mixed-effects models. A tutorial. <em>Submitted.</em>
</p>


<h3>See Also</h3>

<p><code>plot.Explore.WS.Corr</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Open data
data(Example.Data)

# Explore correlation structure
Expl_Corr &lt;- Explore.WS.Corr(OLS.Model="Outcome~as.factor(Time)+ 
  as.factor(Cycle) + as.factor(Condition)", Dataset=Example.Data, 
  Id="Id", Time="Time", Alpha=.05, Number.Bootstrap=50, Seed=123)

# explore results
summary(Expl_Corr)

# plot with correlations for all time lags, and 
# add smoothed (loess) correlation function 
plot(Expl_Corr, Indiv.Corrs=TRUE)
# plot bootstrapped smoothed (loess) correlation function 
plot(Expl_Corr)
</code></pre>


</div>