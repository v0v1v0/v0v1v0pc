<div class="container">

<table style="width: 100%;"><tr>
<td>compute_distance</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute distance or surround values for a cluster randomized trial</h2>

<h3>Description</h3>

<p><code>compute_distance</code> computes distance or surround values for a cluster randomized trial (CRT)
</p>


<h3>Usage</h3>

<pre><code class="language-R">compute_distance(
  trial,
  distance = "nearestDiscord",
  scale_par = NULL,
  auxiliary = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>trial</code></td>
<td>
<p>an object of class <code>"CRTsp"</code> or a data frame containing locations in (x,y) coordinates, cluster
assignments (factor <code>cluster</code>), and arm assignments (factor <code>arm</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p>the quantity(s) to be computed. Options are:
</p>

<table>
<tr>
<td style="text-align: left;">
<code>"nearestDiscord"</code> </td>
<td style="text-align: left;"> distance to nearest discordant location (km)</td>
</tr>
<tr>
<td style="text-align: left;">
<code>"distanceAssigned"</code> </td>
<td style="text-align: left;"> distance to the nearest pixel in the assigned cluster (km)</td>
</tr>
<tr>
<td style="text-align: left;">
<code>"disc"</code> </td>
<td style="text-align: left;"> disc </td>
</tr>
<tr>
<td style="text-align: left;">
<code>"kern"</code> </td>
<td style="text-align: left;"> kernel-based measure </td>
</tr>
<tr>
<td style="text-align: left;">
<code>"hdep"</code> </td>
<td style="text-align: left;"> Tukey half space depth</td>
</tr>
<tr>
<td style="text-align: left;">
<code>"sdep"</code> </td>
<td style="text-align: left;"> simplicial depth</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale_par</code></td>
<td>
<p>scale parameter equal to the disc radius in km if <code>distance = "disc"</code>
or to the standard deviance of the kernels if <code>distance = "kern"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>auxiliary</code></td>
<td>
<p><code>"CRTsp"</code> object containing external cluster and or arm assignments.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For each selected distance measure, the function first checks whether the variable is already present, and carries out
the calculations only if the corresponding field is absent from the <code>trial</code> data frame.<br><br>
If <code>distance = "nearestDiscord"</code> is selected the computed values are Euclidean distances
assigned a positive sign for the intervention arm of the trial, and a negative sign for the control arm.<br><br>
If <code>distance = "distanceAssigned"</code> is selected the computed values are Euclidean distances
to the nearest pixel in the <code>auxiliary</code> <code>"CRTsp"</code> object.<br><br>
If <code>distance = "disc"</code> is specified, the disc statistic is computed for each location as the number of locations
within the specified radius that are in the intervention arm
(<a href="https://onlinelibrary.wiley.com/doi/full/10.1111/biom.13316">Anaya-Izquierdo &amp; Alexander(2020)</a>). The input
value of <code>scale_par</code> is stored in the <code>design</code> list
of the output <code>"CRTsp"</code> object. Recalculation is carried out if the input value of
<code>scale_par</code> differs from the one in the input <code>design</code> list. The value of the the surround calculated
based on intervened locations is divided by the value of the surround calculated on the basis of all locations, so the
value returned is a proportion.<br><br>
If <code>distance = "kern"</code> is specified, the Normal curve with standard deviation
<code>scale_par</code> is used to simulate diffusion of the intervention effect by Euclidean
distance. For each location in the trial, the contributions of all intervened locations are
summed. As with <code>distance = "disc"</code>, when <code>distance = "kern"</code> the surround calculated
based on intervened locations is divided by the value of the surround calculated on the basis of all locations, so the
value returned is a proportion.<br><br>
If either <code>distance = "hdep"</code> or <code>distance = "sdep"</code> is specified then both the simplicial depth and
Tukey half space depth are calculated using the algorithm of
<a href="https://www.jstor.org/stable/2986073">Rousseeuw &amp; Ruts(1996)</a>. The half-depth probability within the intervention cloud (di) is computed
with respect to other locations in the intervention arm (<a href="https://onlinelibrary.wiley.com/doi/full/10.1111/biom.13316">Anaya-Izquierdo &amp; Alexander(2020)</a>). The half-depth within
the half-depth within the control cloud (dc) is also computed. <code>CRTspat</code> returns the proportion di/(dc + di). <br><br>
If an auxiliary <code>auxiliary</code> <code>"CRTsp"</code> object is specified then either <code>distanceAssigned</code> or <code>nearestDiscord</code> (the default)
is computed with respect to the assignments in the auxiliary. If the auxiliary is a grid with <code>design$geometry</code> set to <code>'triangle'</code>,
<code>'square'</code> or <code>'hexagon'</code> then the distance is computed to the edge of the nearest grid pixel in the discordant arm
(using a circular approximation for the perimeter) rather than to the point location itself.<br></p>


<h3>Value</h3>

<p>The input <code>"CRTsp"</code> object with additional column(s) added to the <code>trial</code> data frame
with variable name corresponding to the input value of <code>distance</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">{
# Calculate the disc with a radius of 0.5 km
exampletrial &lt;- compute_distance(trial = readdata('exampleCRT.txt'),
distance = 'disc', scale_par = 0.5)
}
</code></pre>


</div>