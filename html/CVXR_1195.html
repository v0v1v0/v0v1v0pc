<div class="container">

<table style="width: 100%;"><tr>
<td>matrix_frac</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Matrix Fraction</h2>

<h3>Description</h3>

<p><code class="reqn">tr(X^T P^{-1} X)</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">matrix_frac(X, P)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>An Expression or matrix. Must have the same number of rows as <code>P</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>An Expression or matrix. Must be an invertible square matrix.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An Expression representing the matrix fraction evaluated at the input.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
set.seed(192)
m &lt;- 100
n &lt;- 80
r &lt;- 70

A &lt;- matrix(stats::rnorm(m*n), nrow = m, ncol = n)
b &lt;- matrix(stats::rnorm(m), nrow = m, ncol = 1)
G &lt;- matrix(stats::rnorm(r*n), nrow = r, ncol = n)
h &lt;- matrix(stats::rnorm(r), nrow = r, ncol = 1)

# ||Ax-b||^2 = x^T (A^T A) x - 2(A^T b)^T x + ||b||^2
P &lt;- t(A) %*% A
q &lt;- -2 * t(A) %*% b
r &lt;- t(b) %*% b
Pinv &lt;- base::solve(P)

x &lt;- Variable(n)
obj &lt;- matrix_frac(x, Pinv) + t(q) %*% x + r
constr &lt;- list(G %*% x == h)
prob &lt;- Problem(Minimize(obj), constr)
result &lt;- solve(prob)
result$value

## End(Not run)
</code></pre>


</div>