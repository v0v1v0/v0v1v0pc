<div class="container">

<table style="width: 100%;"><tr>
<td>cwLocScat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Estimate location and scatter of data with cellwise weights
</h2>

<h3>Description</h3>

<p>Computes different estimators of multivariate location
and scatter for cellwise weighted data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cwLocScat(X, W, methods = "all", lmin = 1e-3,
                     crit = 1e-12, maxiter= 1000, 
                     initCwCov = FALSE, initEst = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>An <code class="reqn">n</code> by <code class="reqn">d</code> data matrix or data frame. Must be
given. <code>X</code> is allowed to contain <code>NA</code>'s.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p>An <code class="reqn">n</code> by <code class="reqn">d</code> matrix of nonnegative cellwise weights.
Must be given. <code>W</code> is not allowed to contain <code>NA</code>'s.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>methods</code></td>
<td>
<p>either <code>"all"</code> or <code>"explicit"</code>. If <code>"explicit"</code>
only the explicit estimates cwMean, cwCov
and sqrtCov are computed. If <code>"all"</code> (the
default) also the cellwise MLE is carried out,
yielding cwMLEmu and cwMLEsigma.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lmin</code></td>
<td>
<p>if not <code>NULL</code>, a lower bound on the eigenvalues
of the estimated covariance matrices on the
standardized data, to avoid singularity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crit</code></td>
<td>
<p>convergence criterion of successive mu
and Sigma estimates in the EM algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>maximal number of iteration steps in EM.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initCwCov</code></td>
<td>
<p>if <code>TRUE</code>, uses the weighted mean and cwCov
as initial estimates for the weighted EM.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initEst</code></td>
<td>
<p>if not <code>NULL</code>, a list with initial estimates <code>$mu</code>
of the mean, <code>$Sigma</code> of the covariance matrix,
for the weighted EM. Has no effect when
<code>initCwCov = TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with components: <br></p>

<ul>
<li>
<p><code>cwMean</code><br> the explicit cellwise weighted mean.
</p>
</li>
<li>
<p><code>cwCov</code><br> explicit cellwise weighted covariance matrix.
Is asymptotically normal but not necessarily
PSD (unless a nonnegative <code>lmin</code> was specified).
</p>
</li>
<li>
<p><code>sqrtCov</code><br> the cellwise weighted covariance matrix of Van
Aelst et al (2011). Also asymptotically normal
but not necessarily PSD (unless a nonnegative
<code>lmin</code> was specified).
</p>
</li>
<li>
<p><code>cwMLEmu</code><br> the location estimate obtained by the cwMLE.
</p>
</li>
<li>
<p><code>cwMLEsigma</code><br> the covariance matrix obtained by the cwMLE.
Is PSD when the EM algorithm converges.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>P.J. Rousseeuw
</p>


<h3>References</h3>

<p>P.J. Rousseeuw (2022). Analyzing cellwise weighted data, ArXiv:2209.12697.
<a href="https://arxiv.org/abs/2209.12697">(link to open access pdf)</a>
</p>


<h3>See Also</h3>

 
<p><code>weightedEM</code>,
<code>unpack</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("data_personality_traits")
X &lt;- data_personality_traits$X
W &lt;- data_personality_traits$W
fit &lt;- cwLocScat(X, W)
fit$cwMLEiter # number of iteration steps taken
round(fit$cwMLEmu, 2)
round(fit$cwMean, 2)
round(fit$cwMLEsigma, 2)
round(fit$cwCov, 2)


# For more examples, we refer to the vignette:
## Not run: 
vignette("cellwise_weights_examples")

## End(Not run)
</code></pre>


</div>