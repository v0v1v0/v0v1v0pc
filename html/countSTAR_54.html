<div class="container">

<table style="width: 100%;"><tr>
<td>sample_lm_gprior</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sample the linear regression parameters assuming a g-prior</h2>

<h3>Description</h3>

<p>Sample the parameters for a linear regression model assuming a
g-prior for the  coefficients.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sample_lm_gprior(y, X, params, psi = NULL, XtX = NULL, X_test = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p><code>n x 1</code> vector of data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p><code>n x p</code> matrix of predictors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>
<p>the named list of parameters containing
</p>

<ol>
<li> <p><code>mu</code>: vector of conditional means (fitted values)
</p>
</li>
<li> <p><code>sigma</code>: the conditional standard deviation
</p>
</li>
<li> <p><code>coefficients</code>: a named list of parameters that determine <code>mu</code>
</p>
</li>
</ol>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi</code></td>
<td>
<p>the prior variance for the g-prior</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>XtX</code></td>
<td>
<p>the <code>p x p</code> matrix of <code>crossprod(X)</code> (one-time cost);
if NULL, compute within the function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X_test</code></td>
<td>
<p>matrix of predictors at test points (default is NULL)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The updated named list <code>params</code> with draws from the full conditional distributions
of <code>sigma</code> and <code>coefficients</code> (along with updated <code>mu</code> and <code>mu_test</code> if applicable).
</p>


<h3>Note</h3>

<p>The parameters in <code>coefficients</code> are:
</p>

<ul><li> <p><code>beta</code>: the <code>p x 1</code> vector of regression coefficients
components of <code>beta</code>
</p>
</li></ul>
<h3>Examples</h3>

<pre><code class="language-R"># Simulate data for illustration:
sim_dat = simulate_nb_lm(n = 100, p = 5)
y = sim_dat$y; X = sim_dat$X
# Initialize:
params = init_lm_gprior(y = y, X = X)
# Sample:
params = sample_lm_gprior(y = y, X = X, params = params)
names(params)
names(params$coefficients)

</code></pre>


</div>