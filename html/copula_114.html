<div class="container">

<table style="width: 100%;"><tr>
<td>indepTest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test Independence of Continuous Random Variables via Empirical Copula</h2>

<h3>Description</h3>

<p>Multivariate independence test based on the empirical
copula process as proposed by Christian Genest and Bruno
Rémillard.  The test can be seen as composed of
three steps: (i) a simulation step, which consists of simulating the
distribution of the test statistics under independence for the sample
size under consideration; (ii) the test itself, which consists of
computing the approximate p-values of the test statistics with respect
to the empirical distributions obtained in step (i); and (iii) the
display of a graphic, called a <em>dependogram</em>, enabling to
understand the type of departure from independence, if any.  More
details can be found in the articles cited in the reference section.
</p>


<h3>Usage</h3>

<pre><code class="language-R">indepTestSim(n, p, m = p, N = 1000, verbose = interactive())
indepTest(x, d, alpha=0.05)
dependogram(test, pvalues = FALSE, print = FALSE)
</code></pre>


<h3>Arguments</h3>


<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p> sample size when simulating the distribution of the test
statistics under independence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p> dimension of the data when simulating the distribution of the test
statistics under independence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>maximum cardinality of the subsets of variables for which a
test statistic is to be computed.  It makes sense to consider <code class="reqn">m
      \ll p</code> especially when <code>p</code> is large.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>number of repetitions when simulating under independence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>a logical specifying if progress
should be displayed via <code>txtProgressBar</code>.</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> data frame or data matrix containing realizations (one per
line) of the random vector whose independence is to be tested.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p> object of class <code>"indepTestDist"</code> as returned by
the function <code>indepTestSim()</code>.  It can be regarded as the
empirical distribution of the test statistics under independence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p> significance level used in the computation of the
critical values for the test statistics.</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>object of class <code>"indepTest"</code> as returned by <code>indepTest()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalues</code></td>
<td>
<p> logical indicating whether the dependogram should be
drew from test statistics or the corresponding p-values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print</code></td>
<td>
<p> logical indicating whether details should be printed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The current (C code) implementation of <code>indepTestSim()</code>
uses (RAM) memory of size <code class="reqn">O(n^2 p)</code>, and time

<code class="reqn">O(N n^2 p)</code>.  This renders it unfeasible when
<code>n</code> is large.
</p>
<p>See the references below for more details, especially Genest
and Rémillard (2004).
</p>
<p>The former argument <code>print.every</code> is deprecated and not
supported anymore; use <code>verbose</code> instead.
</p>


<h3>Value</h3>

<p>The function <code>indepTestSim()</code> returns an object of class
<code>"indepTestDist"</code> whose attributes are: <code>sample.size</code>,
<code>data.dimension</code>, <code>max.card.subsets</code>,
<code>number.repetitons</code>, <code>subsets</code> (list of the subsets for
which test statistics have been computed), <code>subsets.binary</code>
(subsets in binary 'integer' notation),
<code>dist.statistics.independence</code> (a <code>N</code> line matrix containing
the values of the test statistics for each subset and each repetition)
and <code>dist.global.statistic.independence</code> (a vector a length
<code>N</code> containing the values of the global Cramér-von Mises test
statistic for each repetition – see Genest <em>et al</em> (2007), p.175).
</p>
<p>The function <code>indepTest()</code> returns an object of class
<code>"indepTest"</code> whose attributes are: <code>subsets</code>,
<code>statistics</code>, <code>critical.values</code>, <code>pvalues</code>,
<code>fisher.pvalue</code> (a p-value resulting from a combination <em>à la</em>
Fisher of the subset statistic p-values), <code>tippett.pvalue</code> (a p-value
resulting from a combination <em>à la</em> Tippett of the subset
statistic p-values),
<code>alpha</code> (global significance level of the test), <code>beta</code>
(1 - <code>beta</code> is the significance level per statistic),
<code>global.statistic</code> (value of the global Cramér-von Mises
statistic derived directly from the independence empirical copula
process - see Genest <em>et al</em> (2007), p.175) and
<code>global.statistic.pvalue</code> (corresponding p-value).
</p>


<h3>References</h3>


<p>Deheuvels, P. (1979).
La fonction de dépendance empirique et ses
propriétés: un test non paramétrique d'indépendance,
<em>Acad. Roy. Belg. Bull. Cl. Sci.</em>, 5th Ser. <b>65</b>, 274–292.
</p>
<p>Deheuvels, P. (1981)
A non parametric test for independence,
<em>Publ. Inst. Statist. Univ. Paris</em>. <b>26</b>, 29–50.
</p>
<p>Genest, C. and Rémillard, B. (2004)
Tests of independence and randomness based on the empirical copula process.
<em>Test</em> <b>13</b>, 335–369.
</p>
<p>Genest, C., Quessy, J.-F., and Rémillard, B. (2006).
Local efficiency of a Cramer-von Mises test of independence,
<em>Journal of Multivariate Analysis</em> <b>97</b>, 274–294.
</p>
<p>Genest, C., Quessy, J.-F., and Rémillard, B. (2007)
Asymptotic local efficiency of Cramér-von Mises tests for multivariate independence.
<em>The Annals of Statistics</em> <b>35</b>, 166–191.
</p>


<h3>See Also</h3>

<p><code>serialIndepTest</code>,
<code>multIndepTest</code>,
<code>multSerialIndepTest</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Consider the following example taken from
## Genest and Remillard (2004), p 352:

set.seed(2004)
x &lt;- matrix(rnorm(500),100,5)
x[,1] &lt;- abs(x[,1]) * sign(x[,2] * x[,3])
x[,5] &lt;- x[,4]/2 + sqrt(3) * x[,5]/2

## In order to test for independence "within" x, the first step consists
## in simulating the distribution of the test statistics under
## independence for the same sample size and dimension,
## i.e. n=100 and p=5. As we are going to consider all the subsets of
## {1,...,5} whose cardinality is between 2 and 5, we set p=m=5.

## For a realistic N = 1000 (default), this takes a few seconds:
N. &lt;- if(copula:::doExtras()) 1000 else 120
N.
system.time(d &lt;- indepTestSim(100, 5, N = N.))
## For N=1000,  2 seconds (lynne 2015)
## You could save 'd' for future use, via  saveRDS()

## The next step consists of performing the test itself (and print its results):
(iTst &lt;- indepTest(x,d))

## Display the dependogram with the details:
dependogram(iTst, print=TRUE)

## We could have tested for a weaker form of independence, for instance,
## by only computing statistics for subsets whose cardinality is between 2
## and 3. Consider for instance the following data:
y &lt;- matrix(runif(500),100,5)
## and perform the test:
system.time( d &lt;- indepTestSim(100,5,3, N=N.) )
iTy &lt;- indepTest(y,d)
iTy
dependogram(iTy, print=TRUE)


</code></pre>


</div>