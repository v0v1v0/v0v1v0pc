<div class="container">

<table style="width: 100%;"><tr>
<td>average_clusters_rowwise</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Rowwise math from matrix/data.frame per cluster based on another vector/metadata,
similar to clustifyr::average_clusters but ids as rows</h2>

<h3>Description</h3>

<p>Rowwise math from matrix/data.frame per cluster based on another vector/metadata,
similar to clustifyr::average_clusters but ids as rows
</p>


<h3>Usage</h3>

<pre><code class="language-R">average_clusters_rowwise(
  mat,
  metadata,
  cluster_col = "cluster",
  if_log = FALSE,
  cell_col = NULL,
  low_threshold = 0,
  method = "mean",
  output_log = FALSE,
  cut_n = NULL,
  trim = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mat</code></td>
<td>
<p>expression matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metadata</code></td>
<td>
<p>data.frame or vector containing cluster assignments per cell.
Order must match column order in supplied matrix. If a data.frame
provide the cluster_col parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster_col</code></td>
<td>
<p>column in metadata with cluster number</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>if_log</code></td>
<td>
<p>input data is natural log,
averaging will be done on unlogged data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cell_col</code></td>
<td>
<p>if provided, will reorder matrix first</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>low_threshold</code></td>
<td>
<p>option to remove clusters with too few cells</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>whether to take mean (default), median, 10% truncated mean, or trimean,
max, min</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output_log</code></td>
<td>
<p>whether to report log results</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cut_n</code></td>
<td>
<p>set on a limit of genes as expressed, lower ranked genes
are set to 0, considered unexpressed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trim</code></td>
<td>
<p>whether to remove 1 percentile when doing min caluculation</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>average expression matrix, with genes for row names, and clusters
for column names
</p>


<h3>Examples</h3>

<pre><code class="language-R">mat &lt;- average_clusters_rowwise(data.frame(
  y = c(1, 2, 3, 4, 5, 6),
  x = c(1, 2, 3, 4, 5, 6)
), metadata = c(1, 2, 1, 2, 1, 2), method = "min")
</code></pre>


</div>