<div class="container">

<table style="width: 100%;"><tr>
<td>varmatCUB</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Variance-covariance matrix for CUB models</h2>

<h3>Description</h3>

<p>Compute the variance-covariance matrix of parameter estimates for CUB models with or without
covariates for the feeling and the uncertainty parameter, and for extended CUB models with shelter effect.
</p>


<h3>Usage</h3>

<pre><code class="language-R">varmatCUB(ordinal,m,param,Y=0,W=0,X=0,shelter=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>Number of ordinal categories</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>Vector of parameters for the specified CUB model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Matrix of selected covariates to explain the uncertainty component (default: no covariate is included
in the model)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p>Matrix of selected covariates to explain the feeling component (default: no covariate is included
in the model)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Matrix of selected covariates to explain the shelter effect (default: no covariate is included
in the model)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shelter</code></td>
<td>
<p>Category corresponding to the shelter choice (default: no shelter effect is included in the
model)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function checks if the variance-covariance matrix is positive-definite: if not,
it returns a warning message and produces a matrix with NA entries.  No missing value should be present neither
for <code>ordinal</code> nor for covariate matrices: thus, deletion or imputation procedures should be preliminarily run.
</p>


<h3>References</h3>

<p>Piccolo D. (2006). Observed Information Matrix for MUB Models,
<em>Quaderni di Statistica</em>, <b>8</b>, 33–78 <br>
Iannario, M. (2012). Modelling shelter choices in ordinal data surveys.
<em>Statistical Modelling and Applications</em>, <b>21</b>, 1–22 <br>
Iannario M. and Piccolo D. (2016b). A generalized framework for modelling ordinal data.
<em>Statistical Methods and Applications</em>, <b>25</b>, 163–189.<br></p>


<h3>See Also</h3>

<p><code>vcov</code>, <code>cormat</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(univer)
m&lt;-7
### CUB model with no covariate
pai&lt;-0.87; csi&lt;-0.17 
param&lt;-c(pai,csi)
varmat&lt;-varmatCUB(univer$global,m,param)
#######################
### and with covariates for feeling
data(univer)
m&lt;-7
pai&lt;-0.86; gama&lt;-c(-1.94,-0.17)
param&lt;-c(pai,gama)
ordinal&lt;-univer$willingn; W&lt;-univer$gender      
varmat&lt;-varmatCUB(ordinal,m,param,W)
#######################
### CUB model with uncertainty covariates
data(relgoods)
m&lt;-10
naord&lt;-which(is.na(relgoods$Physician))
nacov&lt;-which(is.na(relgoods$Gender))
na&lt;-union(naord,nacov)
ordinal&lt;-relgoods$Physician[-na]
Y&lt;-relgoods$Gender[-na]
bet&lt;-c(-0.81,0.93); csi&lt;-0.20
varmat&lt;-varmatCUB(ordinal,m,param=c(bet,csi),Y=Y)
#######################
### and with covariates for both parameters
data(relgoods)
m&lt;-10
naord&lt;-which(is.na(relgoods$Physician))
nacov&lt;-which(is.na(relgoods$Gender))
na&lt;-union(naord,nacov)
ordinal&lt;-relgoods$Physician[-na]
W&lt;-Y&lt;-relgoods$Gender[-na]
gama&lt;-c(-0.91,-0.7); bet&lt;-c(-0.81,0.93)
varmat&lt;-varmatCUB(ordinal,m,param=c(bet,gama),Y=Y,W=W)
#######################
### Variance-covariance for a CUB model with shelter
m&lt;-8; n&lt;-300
pai1&lt;-0.5; pai2&lt;-0.3; csi&lt;-0.4
shelter&lt;-6
pr&lt;-probcubshe1(m,pai1,pai2,csi,shelter)
ordinal&lt;-sample(1:m,n,prob=pr,replace=TRUE)
param&lt;-c(pai1,pai2,csi)
varmat&lt;-varmatCUB(ordinal,m,param,shelter=shelter)
</code></pre>


</div>