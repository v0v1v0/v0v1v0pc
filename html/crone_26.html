<div class="container">

<table style="width: 100%;"><tr>
<td>strufac</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculation of structure factors</h2>

<h3>Description</h3>

<p>Calculates structure factors corresponding to one or more 1D Miller 
indices, given the atomic content of one unit cell. Anomalous scattering 
can be included using logical flag "anoflag" (default is FALSE). Crystal 
structures are always considered with no symmetry. Thus a 1D structure 
with the P-1 symmetry will have to be expanded first with function 
"expand_to_cell".
</p>


<h3>Usage</h3>

<pre><code class="language-R">strufac(hidx, sdata, anoflag = FALSE, aK = anoK, lbda = 1,
  k = ksigma, f1f2out = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>hidx</code></td>
<td>
<p>Real numeric. One or more 1D Miller indices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdata</code></td>
<td>
<p>A named list, normally obtained through the use of
functions <code>read_x</code> or <code>standardise_sdata</code>. 
The list names correspond to different object types:
</p>

<ul>
<li>
<p>a.     Real numeric. The size of the unit cell.
</p>
</li>
<li>
<p>SG.    Character string. Space group symbol; either "P1" 
or "P-1"
</p>
</li>
<li>
<p>x0.    Vector of real numerics indicating the expanded atomic
positions in the unit cell.
</p>
</li>
<li>
<p>Z.     Vector of integers indicating the expanded 
atomic numbers for all atoms in the unit cell.
</p>
</li>
<li>
<p>B.    Vector of real numerics indicating the expanded 
B factors for all atoms in the unit cell.
</p>
</li>
<li>
<p>occ.  Vector of real numerics indicating the expanded 
occupancies for all atoms in the unit cell.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>anoflag</code></td>
<td>
<p>Logical variable. If TRUE it forces scattering factors
to include anomalous contributions. As a consequence, Friedel's
pairs will not be equal.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aK</code></td>
<td>
<p>Real numeric. This is a fudge factor included to decrease the
strength of the anomalous contributions. Without aK the strength is too
high for 1D structures, compared to real 3D structures. So aK helps
bringing down the anomalous contribution within the 5
met with large-size structures. The default value is aK=0.3 (anoK is
included as internal data).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lbda</code></td>
<td>
<p>Real numeric. This is the wavelength in angstroms. Its value
is important in relation to anomalous scattering.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>A real number. It controls the standard deviation of the 
gaussian function describing the atom and, thus, the shape of the
associated peak. The standard deviation sigma is given by:
<code>sigma = k * sqrt(Z)</code>
The default value is k=0.05 (ksigma is included as internal data).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f1f2out</code></td>
<td>
<p>Logical variable. This variable controls output of a small
table of f' and f‚Äù values for all chemical elements in the structure.
Default is for the table to be printed.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A named list with two vectors of real numbers, the structure 
factors amplitudes, Fmod, and phases, Fpha, corresponding to the Miller 
indices in input.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># First create the crystal structure (P1)
a &lt;- 10
SG &lt;- "P1"
x0 &lt;- c(1,4,6.5)
Z &lt;- c(8,26,6)
B &lt;- c(18,20,17)
occ &lt;- c(1,1,1)
sdata &lt;- standardise_sdata(a,SG,x0,Z,B,occ)
lbda &lt;- 1.7   # Close to Fe's absorption

# Miller indices (including DC (h=0) component)
hidx &lt;- 0:10

# Now structure factors without anomalous contribution
ftmp &lt;- strufac(hidx,sdata,lbda=lbda)
print(length(ftmp$Fmod))  # Includes DC component (h=0)
print(ftmp)          # Amplitudes decrease with increasing
                     # resolution (Miller indices)
                  
# Now try with anomalous contributions
ftmp &lt;- strufac(hidx,sdata,lbda=lbda,anoflag=TRUE)
print(ftmp)  # DC component is not any longer real

</code></pre>


</div>