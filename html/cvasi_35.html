<div class="container">

<table style="width: 100%;"><tr>
<td>explore_space</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Explore parameter space</h2>

<h3>Description</h3>

<p>The function is aimed at getting an idea of how the parameter space
of a model behaves, so that parameter identifiability problems and correlations
between parameters can be explored. Therefore, the function samples a large
number of parameter sets by randomly drawing from each parameter's 95%
confidence interval (generated by <code>lik_profile()</code>). It then
checks how many of the parameter sets are within acceptable limits by comparing
the likelihood ratio of a parameter set vs. the original parameter set against
a chi-square distribution as degrees of freedom (df) the total number of profile
parameters (outer rim) or one df (inner rim). If needed, the function resamples
until at least <code>nr_accept</code> parameters sets are within the inner rim
</p>


<h3>Usage</h3>

<pre><code class="language-R">explore_space(
  x,
  par,
  res,
  output,
  sample_size = 1000,
  max_runs = 30,
  nr_accept = 100,
  sample_factor = 1.2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a list of caliset objects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p>best fit parameters from joined calibration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res</code></td>
<td>
<p>output of 'lik_profile()' function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>character vector, name of output column of <code>simulate()</code> that
is used in calibration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample_size</code></td>
<td>
<p>number of samples to draw from each parameter interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_runs</code></td>
<td>
<p>max number of times to redraw samples (within a smaller space), and repeat the process</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nr_accept</code></td>
<td>
<p>threshold for number of points sampled within the inner circle</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample_factor</code></td>
<td>
<p>multiplication factor for sampling (95% interval * sample factor)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list containing a plot to explore the parameter space, and the <code>data.frame</code>
supporting it
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(dplyr)
# Example with Lemna model - physiological params
# Before applying the function, a model needs to be calibrated and its parameters profiled
# Inputs for likelihood profiling

# exposure - control run
exp &lt;- Schmitt2013 %&gt;%
  filter(ID == "T0") %&gt;%
  select(time=t, conc)

# observations - control run
obs &lt;- Schmitt2013 %&gt;%
  filter(ID == "T0") %&gt;%
  select(t, BM=obs)

# parameters after calibration
params &lt;- c(
  k_phot_max = 5.663571,
  k_resp = 1.938689,
  Topt = 26.7
)

# set parameter boundaries (if different from defaults)
bounds &lt;- list(
  k_resp = list(0, 10),
  k_phot_max = list(0, 30),
  Topt = list(20, 30)
)

# update metsulfuron
myscenario &lt;- metsulfuron %&gt;%
  set_init(c(BM = 5, E = 1, M_int = 0)) %&gt;%
  set_param(list(
    k_0 = 5E-5,
    a_k = 0.25,
    BM50 = 17600,
    mass_per_frond = 0.1
  )) %&gt;%
  set_exposure(exp) %&gt;%
  set_param(params) %&gt;%
  set_bounds(bounds)

# Likelihood profiling
res &lt;- lik_profile(
  x = myscenario,
  data = obs,
  output = "BM",
  par = params,
  refit = FALSE,
  type = "fine",
  method = "Brent"
)
# plot
plot_lik_profile(res)

# parameter space explorer
set.seed(1) # for reproducibility
res_space &lt;- explore_space(
  x = list(caliset(myscenario, obs)),
  par = params,
  res = res,
  output = "BM",
  sample_size = 1000,
  max_runs = 20,
  nr_accept = 100)

plot_param_space(res_space)


</code></pre>


</div>