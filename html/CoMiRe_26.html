<div class="container">

<table style="width: 100%;"><tr>
<td>fit.pdf.mcmc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Posterior mean density plot for dose intervals</h2>

<h3>Description</h3>

<p>Pointwise posterior mean (continuous blue lines), and credible bands (shaded blue areas) for f (y | x, z) 
calculated in <code>x.val</code> under the the model fitted in <code>fit</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit.pdf.mcmc(y, x, fit, mcmc, J=10, H = 10, alpha = 0.05, 
max.x = max(x), x.val, y.grid = NULL, xlim = c(0, max(x)), 
ylim = c(0, 1), xlab = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>optional numeric vector for the response used in <code>comire.gibbs</code>. If <code>y</code> is missing, <code>y.grid</code> must be provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>numeric vector for the covariate relative to the dose of exposure used in <code>comire.gibbs</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>the output of <code>comire.gibbs</code> opportunely trasformed in <code>classCoMiRe</code> class.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcmc</code></td>
<td>
<p>a list giving the MCMC parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>J</code></td>
<td>
<p>parameter controlling the number of elements of the I-spline basis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>
<p>total number of components in the mixture at <code class="reqn">x_0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>level of the credible bands.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.x</code></td>
<td>
<p>maximum value allowed for x.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.val</code></td>
<td>
<p>central points of each dose interval to be used in the posterior estimation of the probability density function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.grid</code></td>
<td>
<p>optional numerical vector giving the actual values of the grid for y for plotting the posterior mean density. If <code>y.grid</code> is not provided, standard grids are automatically used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim, ylim</code></td>
<td>
<p>numeric vectors of length 2, giving the x and y coordinates ranges for the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>the title of the x axis.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Antonio Canale, Arianna Falcioni
</p>


<h3>Examples</h3>

<pre><code class="language-R">{
data(CPP)
attach(CPP)

n &lt;- NROW(CPP)
J &lt;- H &lt;- 10

premature &lt;- as.numeric(gestage&lt;=37)

mcmc &lt;- list(nrep=5000, nb=2000, thin=5, ndisplay=4)

## too few iterations to be meaningful. see below for safer and more comprehensive results

mcmc &lt;- list(nrep=10, nb=2, thin=1, ndisplay=4) 

prior &lt;- list(mu.theta=mean(gestage), k.theta=10, eta=rep(1, J)/J, 
              alpha=rep(1,H)/H, a=2, b=2, J=J, H=H)
              
fit.dummy &lt;- comire.gibbs(gestage, dde, family="continuous", 
                     mcmc=mcmc, prior=prior, seed=1, max.x=180)
                     
fit.pdf.mcmc(y = gestage, x = dde, fit = fit.dummy, mcmc = mcmc, J = 10, H = 10, 
                         alpha = 0.05, max.x = max(dde), x.val = 125, 
                         xlim = c(25,48), ylim = c(0,0.25),
                         xlab = "Gest. age. for DDE = 125")
                         

## safer procedure with more iterations (it may take some time)

mcmc &lt;- list(nrep=5000, nb=2000, thin=5, ndisplay=4)

## Fit the model for continuous y 

prior &lt;- list(mu.theta=mean(gestage), k.theta=10, eta=rep(1, J)/J, 
              alpha=rep(1,H)/H, a=2, b=2, J=J, H=H)
              
fit1 &lt;- comire.gibbs(gestage, dde, family="continuous", 
                     mcmc=mcmc, prior=prior, seed=5, max.x=180)
          
fit.pdf.mcmc(y = gestage, x = dde, fit = fit1, mcmc = mcmc, J = 10, H = 10, 
                         alpha = 0.05, max.x = max(dde), x.val = 125, 
                         xlim = c(25,48), ylim = c(0,0.25),
                         xlab = "Gest. age. for DDE = 125")
                         

}
</code></pre>


</div>