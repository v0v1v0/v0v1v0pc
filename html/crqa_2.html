<div class="container">

<table style="width: 100%;"><tr>
<td>crqa</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Auto, cross and multidimensional recurrence measures 
of one, two or multiple time-series, time-delayed and embedded 
in higher dimensional space
</h2>

<h3>Description</h3>

<p>Core recurrence function, which examines
recurrent structures of a single (rqa), two (crqa), 
or multidimensional time-series (mdcrqa), which are
time-delayed and embedded in higher dimensional space.
The approach compares the phase space trajectories of 
the time-series in the same phase-space when delays are
introduced. A distance matrix between the time-series,
delayed and embedded is calculated. Several measures
representative of the underlying dynamics of the system
are extracted (explained below).</p>


<h3>Usage</h3>

<pre><code class="language-R">crqa(ts1, ts2, delay, embed, rescale, radius, normalize,
mindiagline, minvertline, tw, whiteline, recpt, side, method,
metric, datatype)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ts1</code></td>
<td>
<p>First time-series dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ts2</code></td>
<td>
<p>Second time-series dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delay</code></td>
<td>
<p>The delay unit by which the series are lagged.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>embed</code></td>
<td>
<p>The number of embedding dimension for
phase-reconstruction, i.e., the lag intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rescale</code></td>
<td>
<p>Rescale the distance matrix;
if rescale = 0 (do nothing);
if rescale = 1 (mean distance of entire matrix);
if rescale = 2 (maximum distance of entire matrix).
if rescale = 3 (minimum distance of entire matrix).
if rescale = 4 (euclidean distance of entire matrix).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>radius</code></td>
<td>
<p>A threshold, cut-off, constant used to
decide whether two points are recurrent or not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalize</code></td>
<td>
<p>Normalize the time-series;
if normalize = 0 (do nothing);
if normalize = 1 (Unit interval);
if normalize =  2 (z-score).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mindiagline</code></td>
<td>
<p>A minimum diagonal length of
recurrent points. Usually set to 2, as it takes
a minimum of two points to define any line.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minvertline</code></td>
<td>
<p>A minimum vertical length of
recurrent points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tw</code></td>
<td>
<p>The Theiler window parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>whiteline</code></td>
<td>
<p>A logical flag to calculate (TRUE)
or not (FALSE) empty vertical lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>recpt</code></td>
<td>
<p>A logical flag indicating whether
measures of cross-recurrence are calculated directly
from a recurrent plot (TRUE) or not (FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>side</code></td>
<td>
<p>A string indicating whether recurrence measures
should be calculated in the 'upper' triangle of the RP
'lower' triangle of the matrix, or 'both'.
LOC is automatically excluded for 'upper' and 'lower'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A string to indicate the type of recurrence
analysis to peform. There are three options:
rqa (autorecurrence); crqa(cross-recurrence); 
mdcrqa(multidimensional recurrence). Default value is crqa</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metric</code></td>
<td>
<p>A string to indicate the type of 
distance metric used, default is euclidean but 
see help rdist() to list all other possible metrics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>datatype</code></td>
<td>
<p>a string (continuous or categorical) 
to indicate whether the nature of the data type</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>We recommend setting whiteline = FALSE, as the current
version of the library does not make use of such
information to extract recurrence measures.
</p>


<h3>Value</h3>

<p>If a recurrence plot (RP) can be calculated and hence 
recurrence observed the function will returna a list with 
different measures extracted. 
Otherwise, the values for the output arguments will be
either 0 or NA.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>RR</code></td>
<td>
<p>The percentage of recurrent points falling within
the specified radius (range between 0 and 100)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DET</code></td>
<td>
<p>Proportion of recurrent points forming diagonal
line structures.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NRLINE</code></td>
<td>
<p>The total number of lines in the recurrent plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxL</code></td>
<td>
<p>The length of the longest diagonal line
segment in the plot, excluding the main diagonal</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>The average length of line structures</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ENTR</code></td>
<td>
<p>Shannon information entropy of
diagonal line lengths longer than the minimum length</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rENTR</code></td>
<td>
<p>Entropy measure normalized by the number of
lines observed in the plot. Handy to compare across contexts
and conditions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LAM</code></td>
<td>
<p>Proportion of recurrent points forming vertical
line structures</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TT</code></td>
<td>
<p>The average length of vertical line structures</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>catH</code></td>
<td>
<p>Entropy of categorical recurrence plots based on rectangular block structures</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RP</code></td>
<td>
<p>The Recurrence Plot sparse matrix data</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Original bits of this code were translated from a Matlab
version provided by Rick Dale, and created during 
the Non-Linear Methods for Psychological Science
summer school held at the University of Cincinnati
in 2012. The multi-dimensional method for the crqa function 
has been written together with Sebastian Wallot 
(sebastian.wallot at aesthetics.mpg.de )</p>


<h3>Author(s)</h3>

<p>Moreno I. Coco (moreno.cocoi@gmail.com)</p>


<h3>References</h3>

<p>Coco, M. I., and Dale, R. (2014). Cross-recurrence quantification analysis of categorical and continuous time series: an R package. Frontiers in psychology, 5, 510.
</p>
<p>Wallot, S. (2018). Multidimensional Cross-Recurrence Quantification Analysis (MdCRQA) a method for quantifying correlation between multivariate time-series. Multivariate behavioral research, 1-19</p>


<h3>See Also</h3>

<p><code>spdiags</code>, <code>simts</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
# use the available data
data(crqa) 

listener = eyemovement$listener
narrator = eyemovement$narrator

delay = 1; embed = 1; rescale = 0; radius = .1;
normalize = 0; mindiagline = 2; minvertline = 2;
tw = 0; whiteline = FALSE; recpt = FALSE; side = "both"
method = 'crqa'; metric = 'euclidean';  
datatype = "categorical"

ans = crqa(narrator, listener, delay, embed, rescale, radius, normalize, 
           mindiagline, minvertline, tw, whiteline, recpt, side, method,
           metric, datatype)

print(ans[1:10]) ## last argument of list is the recurrence plot

</code></pre>


</div>