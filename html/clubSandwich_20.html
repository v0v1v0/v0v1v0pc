<div class="container">

<table style="width: 100%;"><tr>
<td>vcovCR.ivreg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cluster-robust variance-covariance matrix for an ivreg object.</h2>

<h3>Description</h3>

<p><code>vcovCR</code> returns a sandwich estimate of the variance-covariance matrix 
of a set of regression coefficient estimates from an ivreg object fitted
from the <a href="https://CRAN.R-project.org/package=AER"><span class="pkg">AER</span></a> package or the <a href="https://CRAN.R-project.org/package=ivreg"><span class="pkg">ivreg</span></a> package.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'ivreg'
vcovCR(
  obj,
  cluster,
  type,
  target = NULL,
  inverse_var = FALSE,
  form = "sandwich",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>Fitted model for which to calculate the variance-covariance matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>Expression or vector indicating which observations belong to
the same cluster. Required for <code>ivreg</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Character string specifying which small-sample adjustment should 
be used, with available options <code>"CR0"</code>, <code>"CR1"</code>, <code>"CR1p"</code>,
<code>"CR1S"</code>, <code>"CR2"</code>, or <code>"CR3"</code>. See "Details" section of 
<code>vcovCR</code> for further information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>
<p>Optional matrix or vector describing the working
variance-covariance model used to calculate the <code>CR2</code> and <code>CR4</code>
adjustment matrices. If a vector, the target matrix is assumed to be
diagonal. If not specified, the target is taken to be an identity matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inverse_var</code></td>
<td>
<p>Not used for <code>ivreg</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>Controls the form of the returned matrix. The default 
<code>"sandwich"</code> will return the sandwich variance-covariance matrix. 
Alternately, setting <code>form = "meat"</code> will return only the meat of the 
sandwich and setting <code>form = B</code>, where <code>B</code> is a matrix of 
appropriate dimension, will return the sandwich variance-covariance matrix 
calculated using <code>B</code> as the bread. <code>form = "estfun"</code> will return the 
(appropriately scaled) estimating function, the transposed crossproduct of 
which is equal to the sandwich variance-covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments available for some classes of objects.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For any "ivreg" objects fitted via the <code>ivreg</code> 
function from the <a href="https://CRAN.R-project.org/package=ivreg"><span class="pkg">ivreg</span></a> package, only traditional 2SLS 
regression method (method = "OLS") is supported.
clubSandwich currently cannot support robust-regression methods such as
M-estimation (method = "M") or MM-estimation (method = "MM").
</p>


<h3>Value</h3>

<p>An object of class <code>c("vcovCR","clubSandwich")</code>, which consists
of a matrix of the estimated variance of and covariances between the
regression coefficient estimates.
</p>


<h3>See Also</h3>

<p><code>vcovCR</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
if (requireNamespace("AER", quietly = TRUE)) withAutoprint({

  library(AER)
  data("CigarettesSW")
  Cigs &lt;- within(CigarettesSW, {
    rprice &lt;- price/cpi
    rincome &lt;- income/population/cpi
    tdiff &lt;- (taxs - tax)/cpi
  })

  iv_fit_AER &lt;- AER::ivreg(log(packs) ~ log(rprice) + log(rincome) | 
                  log(rincome) + tdiff + I(tax/cpi), data = Cigs)
  vcovCR(iv_fit_AER, cluster = Cigs$state, type = "CR2")
  coef_test(iv_fit_AER, vcov = "CR2", cluster = Cigs$state)

})

pkgs_available &lt;- 
  requireNamespace("AER", quietly = TRUE) &amp; 
  requireNamespace("ivreg", quietly = TRUE)

if (pkgs_available) withAutoprint ({

data("CigarettesSW")
  Cigs &lt;- within(CigarettesSW, {
    rprice &lt;- price/cpi
    rincome &lt;- income/population/cpi
    tdiff &lt;- (taxs - tax)/cpi
  })
iv_fit_ivreg &lt;- ivreg::ivreg(log(packs) ~ log(rprice) + log(rincome) | 
                  log(rincome) + tdiff + I(tax/cpi), data = Cigs)
  vcovCR(iv_fit_ivreg, cluster = Cigs$state, type = "CR2")
  coef_test(iv_fit_ivreg, vcov = "CR2", cluster = Cigs$state)
})

</code></pre>


</div>