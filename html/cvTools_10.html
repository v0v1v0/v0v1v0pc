<div class="container">

<table style="width: 100%;"><tr>
<td>cvFit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cross-validation for model evaluation</h2>

<h3>Description</h3>

<p>Estimate the prediction error of a model via (repeated) <code class="reqn">K</code>-fold
cross-validation.  It is thereby possible to supply an object returned by a
model fitting function, a model fitting function itself, or an unevaluated
function call to a model fitting function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cvFit(object, ...)

## Default S3 method:
cvFit(
  object,
  data = NULL,
  x = NULL,
  y,
  cost = rmspe,
  K = 5,
  R = 1,
  foldType = c("random", "consecutive", "interleaved"),
  grouping = NULL,
  folds = NULL,
  names = NULL,
  predictArgs = list(),
  costArgs = list(),
  envir = parent.frame(),
  seed = NULL,
  ...
)

## S3 method for class ''function''
cvFit(
  object,
  formula,
  data = NULL,
  x = NULL,
  y,
  args = list(),
  cost = rmspe,
  K = 5,
  R = 1,
  foldType = c("random", "consecutive", "interleaved"),
  grouping = NULL,
  folds = NULL,
  names = NULL,
  predictArgs = list(),
  costArgs = list(),
  envir = parent.frame(),
  seed = NULL,
  ...
)

## S3 method for class 'call'
cvFit(
  object,
  data = NULL,
  x = NULL,
  y,
  cost = rmspe,
  K = 5,
  R = 1,
  foldType = c("random", "consecutive", "interleaved"),
  grouping = NULL,
  folds = NULL,
  names = NULL,
  predictArgs = list(),
  costArgs = list(),
  envir = parent.frame(),
  seed = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>the fitted model for which to estimate the prediction error,
a function for fitting a model, or an unevaluated function call for fitting
a model (see <code>call</code> for the latter).  In the case of a fitted
model, the object is required to contain a component <code>call</code> that stores
the function call used to fit the model, which is typically the case for
objects returned by model fitting functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to be passed down.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame containing the variables required for fitting the
models.  This is typically used if the model in the function call is
described by a <code>formula</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric matrix containing the predictor variables.  This is
typically used if the function call for fitting the models requires the
predictor matrix and the response to be supplied as separate arguments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a numeric vector or matrix containing the response.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cost</code></td>
<td>
<p>a cost function measuring prediction loss.  It should expect
the observed values of the response to be passed as the first argument and
the predicted values as the second argument, and must return either a
non-negative scalar value, or a list with the first component containing
the prediction error and the second component containing the standard
error.  The default is to use the root mean squared prediction error
(see <code>cost</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>an integer giving the number of folds into which the data should
be split (the default is five).  Keep in mind that this should be chosen
such that all folds are of approximately equal size.  Setting <code>K</code>
equal to the number of observations or groups yields leave-one-out
cross-validation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>an integer giving the number of replications for repeated
<code class="reqn">K</code>-fold cross-validation.  This is ignored for for leave-one-out
cross-validation and other non-random splits of the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>foldType</code></td>
<td>
<p>a character string specifying the type of folds to be
generated.  Possible values are <code>"random"</code> (the default),
<code>"consecutive"</code> or <code>"interleaved"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grouping</code></td>
<td>
<p>a factor specifying groups of observations.  If supplied,
the data are split according to the groups rather than individual
observations such that all observations within a group belong to the same
fold.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>folds</code></td>
<td>
<p>an object of class <code>"cvFolds"</code> giving the folds of the
data for cross-validation (as returned by <code>cvFolds</code>).  If
supplied, this is preferred over the arguments for generating
cross-validation folds.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>names</code></td>
<td>
<p>an optional character vector giving names for the arguments
containing the data to be used in the function call (see “Details”).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predictArgs</code></td>
<td>
<p>a list of additional arguments to be passed to the
<code>predict</code> method of the fitted models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>costArgs</code></td>
<td>
<p>a list of additional arguments to be passed to the
prediction loss function <code>cost</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>envir</code></td>
<td>
<p>the <code>environment</code> in which to evaluate the
function call for fitting the models (see <code>eval</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>optional initial seed for the random number generator (see
<code>.Random.seed</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a <code>formula</code> describing the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args</code></td>
<td>
<p>a list of additional arguments to be passed to the model
fitting function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>(Repeated) <code class="reqn">K</code>-fold cross-validation is performed in the following
way.  The data are first split into <code class="reqn">K</code> previously obtained blocks of
approximately equal size.  Each of the <code class="reqn">K</code> data blocks is left out once
to fit the model, and predictions are computed for the observations in the
left-out block with the <code>predict</code> method of the fitted
model.  Thus a prediction is obtained for each observation.
</p>
<p>The response variable and the obtained predictions for all observations are
then passed to the prediction loss function <code>cost</code> to estimate the
prediction error.  For repeated cross-validation, this process is replicated
and the estimated prediction errors from all replications as well as their
average are included in the returned object.
</p>
<p>Furthermore, if the response is a vector but the
<code>predict</code> method of the fitted models returns a matrix,
the prediction error is computed for each column.  A typical use case for
this behavior would be if the <code>predict</code> method returns
predictions from an initial model fit and stepwise improvements thereof.
</p>
<p>If <code>formula</code> or <code>data</code> are supplied, all variables required for
fitting the models are added as one argument to the function call, which is
the typical behavior of model fitting functions with a
<code>formula</code> interface.  In this case, the accepted values
for <code>names</code> depend on the method.  For the <code>function</code> method, a
character vector of length two should supplied, with the first element
specifying the argument name for the formula and the second element
specifying the argument name for the data (the default is to use
<code>c("formula", "data")</code>).  Note that names for both arguments should be
supplied even if only one is actually used.  For the other methods, which do
not have a <code>formula</code> argument, a character string specifying the
argument name for the data should be supplied (the default is to use
<code>"data"</code>).
</p>
<p>If <code>x</code> is supplied, on the other hand, the predictor matrix and the
response are added as separate arguments to the function call.  In this
case, <code>names</code> should be a character vector of length two, with the
first element specifying the argument name for the predictor matrix and the
second element specifying the argument name for the response (the default is
to use <code>c("x", "y")</code>).  It should be noted that the <code>formula</code> or
<code>data</code> arguments take precedence over <code>x</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>"cv"</code> with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>an integer giving the number of observations or groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>an integer giving the number of folds.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>an integer giving the number of replications.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv</code></td>
<td>
<p>a numeric vector containing the respective estimated
prediction errors.  For repeated cross-validation, those are average values
over all replications.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>a numeric vector containing the respective estimated
standard errors of the prediction loss.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reps</code></td>
<td>
<p>a numeric matrix in which each column contains the
respective estimated prediction errors from all replications.  This is
only returned for repeated cross-validation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>the seed of the random number generator before
cross-validation was performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched function call.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Andreas Alfons
</p>


<h3>See Also</h3>

<p><code>cvTool</code>, <code>cvSelect</code>,
<code>cvTuning</code>, <code>cvFolds</code>, <code>cost</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library("robustbase")
data("coleman")

## via model fit
# fit an MM regression model
fit &lt;- lmrob(Y ~ ., data=coleman)
# perform cross-validation
cvFit(fit, data = coleman, y = coleman$Y, cost = rtmspe, 
    K = 5, R = 10, costArgs = list(trim = 0.1), seed = 1234)

## via model fitting function
# perform cross-validation
# note that the response is extracted from 'data' in 
# this example and does not have to be supplied
cvFit(lmrob, formula = Y ~ ., data = coleman, cost = rtmspe, 
    K = 5, R = 10, costArgs = list(trim = 0.1), seed = 1234)

## via function call
# set up function call
call &lt;- call("lmrob", formula = Y ~ .)
# perform cross-validation
cvFit(call, data = coleman, y = coleman$Y, cost = rtmspe, 
    K = 5, R = 10, costArgs = list(trim = 0.1), seed = 1234)
</code></pre>


</div>