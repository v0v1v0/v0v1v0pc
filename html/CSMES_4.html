<div class="container">

<table style="width: 100%;"><tr>
<td>CSMES.ensSel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>CSMES Training Stage 1: Cost-Sensitive Multicriteria Ensemble Selection resulting in a Pareto frontier of candidate ensemble classifiers</h2>

<h3>Description</h3>

<p>This function applies the first stage in the learning process of CSMES: optimizing Cost-Sensitive Multicriteria Ensemble
Selection, resulting in a Pareto frontier of equivalent candidate ensemble classifiers along two objective functions. By default, cost space is optimized
by optimizing false positive and false negative rates simultaneously. This results in a set of optimal ensemble classifiers, varying in the tradeoff between
FNR and FPR. Optionally, other objective metrics can be specified. Currently, only binary classification is supported.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CSMES.ensSel(
  memberPreds,
  y,
  obj1 = c("FNR", "AUCC", "MSE", "AUC"),
  obj2 = c("FPR", "ensSize", "ensSizeSq", "clAmb"),
  selType = c("selection", "selectionWeighted", "weighted"),
  plotting = TRUE,
  generations = 30,
  popsize = 100
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>memberPreds</code></td>
<td>
<p>matrix containing ensemble member library predictions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Vector with true class labels. Currently, a dichotomous outcome variable is supported</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obj1</code></td>
<td>
<p>Specifies the first objective metric to be minimized</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obj2</code></td>
<td>
<p>Specifies the second objective metric to be minimized</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selType</code></td>
<td>
<p>Specifies the type of ensemble selection to be applied: <code>"selection"</code> for basic selection, <code>"selectionWeighted"</code> for weighted selection, <code>"weighted"</code> for weighted sum</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotting</code></td>
<td>
<p><code>TRUE</code> or <code>FALSE</code>: Should a plot be generated showing objective function values throughout the optimization process?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>generations</code></td>
<td>
<p>the number of population generations for nsga-II. Default is 30.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>popsize</code></td>
<td>
<p>the population size for nsga-II. Default is 100.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of the class <code>CSMES.ensSel</code> which is a list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>ensemble member weights for all pareto-optimal ensemble classifiers after multicriteria ensemble selection</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obj_values</code></td>
<td>
<p>optimization objective values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pareto</code></td>
<td>
<p>overview of pareto-optimal ensemble classifiers</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>popsize</code></td>
<td>
<p>the population size for nsga-II</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>generarations</code></td>
<td>
<p>the number of population generations for nsga-II</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obj1</code></td>
<td>
<p>Specifies the first objective metric that was minimized</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obj2</code></td>
<td>
<p>Specifies the second objective metric that was minimized</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selType</code></td>
<td>
<p>the type of ensemble selection that was applied: <code>"selection"</code>, <code>"selectionWeighted"</code> or <code>"weighted"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ParetoPredictions_p</code></td>
<td>
<p>probability predictions for pareto-optimal ensemble classifiers</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ParetoPredictions_c</code></td>
<td>
<p>class predictions for pareto-optimal ensebmle classifiers</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Koen W. De Bock, <a href="mailto:kdebock@audencia.com">kdebock@audencia.com</a>
</p>


<h3>References</h3>

<p>De Bock, K.W., Lessmann, S. And Coussement, K., Cost-sensitive business failure prediction
when misclassification costs are uncertain: A heterogeneous ensemble selection approach,
European Journal of Operational Research (2020), doi: 10.1016/j.ejor.2020.01.052.
</p>


<h3>Examples</h3>

<pre><code class="language-R">##load data
library(rpart)
library(zoo)
library(ROCR)
library(mco)
data(BFP)
##generate random order vector
BFP_r&lt;-BFP[sample(nrow(BFP),nrow(BFP)),]
size&lt;-nrow(BFP_r)
##size&lt;-300
train&lt;-BFP_r[1:floor(size/3),]
val&lt;-BFP_r[ceiling(size/3):floor(2*size/3),]
test&lt;-BFP_r[ceiling(2*size/3):size,]
##generate a list containing model specifications for 100 CART decisions trees varying in the cp
##and minsplit parameters, and trained on bootstrap samples (bagging)
rpartSpecs&lt;-list()
for (i in 1:100){
  data&lt;-train[sample(1:ncol(train),size=ncol(train),replace=TRUE),]
  str&lt;-paste("rpartSpecs$rpart",i,"=rpart(as.formula(Class~.),data,method=\"class\",
  control=rpart.control(minsplit=",round(runif(1, min = 1, max = 20)),",cp=",runif(1,
  min = 0.05, max = 0.4),"))",sep="")
  eval(parse(text=str))
}
##generate predictions for these models
hillclimb&lt;-mat.or.vec(nrow(val),100)
for (i in 1:100){
  str&lt;-paste("hillclimb[,",i,"]=predict(rpartSpecs[[i]],newdata=val)[,2]",sep="")
  eval(parse(text=str))
}
##score the validation set used for ensemble selection, to be used for ensemble selection
ESmodel&lt;-CSMES.ensSel(hillclimb,val$Class,obj1="FNR",obj2="FPR",selType="selection",
generations=10,popsize=12,plot=TRUE)
## Create Ensemble nomination curve
enc&lt;-CSMES.ensNomCurve(ESmodel,hillclimb,val$Class,curveType="costCurve",method="classPreds",
plot=FALSE)
</code></pre>


</div>