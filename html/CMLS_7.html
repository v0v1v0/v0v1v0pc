<div class="container">

<table style="width: 100%;"><tr>
<td>IsplineBasis</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
I-Spline Basis for Monotonic Polynomial Splines
</h2>

<h3>Description</h3>

<p>Generate the I-spline basis matrix for a monotonic polynomial spline.
</p>


<h3>Usage</h3>

<pre><code class="language-R">IsplineBasis(x, df = NULL, knots = NULL, degree = 3, intercept = FALSE,
             Boundary.knots = range(x))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>the predictor variable. Missing values are <b>not</b> allowed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>

<p>degrees of freedom; if specified the number of <code>knots</code> is defined as <code>df - degree - ifelse(intercept, 1, 0)</code>; the <code>knots</code> are placed at the quantiles of <code>x</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knots</code></td>
<td>

<p>the internal breakpoints that define the spline (typically the quantiles of <code>x</code>) 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degree</code></td>
<td>

<p>degree of the M-spline basisâ€”default is 3 for cubic splines
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>

<p>if <code>TRUE</code>, the basis includes an intercept column  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Boundary.knots</code></td>
<td>

<p>boundary points for M-spline basis; defaults to min and max of <code>x</code>  
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Syntax is adapted from the <code>bs</code> function in the <b>splines</b> package (R Core Team, 2021).
</p>
<p>Used for implementing monotonic smoothness constraints in the <code>cmls</code> fucntion.
</p>


<h3>Value</h3>

<p>A matrix of dimension <code>c(length(x), df)</code> where either <code>df</code> was supplied or <code>df = length(knots) + degree + ifelse(intercept, 1, 0)</code>
</p>


<h3>Note</h3>

<p>I-spline basis functions are created by integrating M-spline basis functions.
</p>


<h3>Author(s)</h3>

<p>Nathaniel E. Helwig &lt;helwig@umn.edu&gt;
</p>


<h3>References</h3>

<p>R Core Team (2023). R: A Language and Environment for Statistical Computing. R Foundation for Statistical Computing, Vienna, Austria. https://www.R-project.org/
</p>
<p>Ramsay, J. O. (1988). Monotone regression splines in action. <em>Statistical Science, 3</em>, 425-441. <a href="https://doi.org/10.1214/ss/1177012761">doi:10.1214/ss/1177012761</a>
</p>


<h3>See Also</h3>

<p><code>MsplineBasis</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">x &lt;- seq(0, 1, length.out = 101)
I &lt;- IsplineBasis(x, df = 8, intercept = TRUE)
plot(x, I[,1], ylim = c(0, 1), t = "l")
for(j in 2:8) lines(x, I[,j], col = j)
</code></pre>


</div>