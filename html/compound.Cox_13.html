<div class="container">

<table style="width: 100%;"><tr>
<td>surv.factorial</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Factorial survival analysis under dependent censoring
</h2>

<h3>Description</h3>

<p>Perform factorial survival analysis under dependent censoring under an assumed copula (Emura et al. 2024).
</p>


<h3>Usage</h3>

<pre><code class="language-R">surv.factorial(t.vec,d.vec,group,copula,alpha,R=1000,t.upper=min(tapply(t.vec,group,max)),
C=NULL,S.plot=TRUE,mark.time=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>t.vec</code></td>
<td>
<p>Vector of survival times (time to either death or censoring)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d.vec</code></td>
<td>
<p>Vector of censoring indicators, 1=death, 0=censoring</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>Vector of group indicators, 1, 2, ..., d</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>copula</code></td>
<td>
<p>Copula function: "CG.Clayton","CG.Gumbel" or "CG.Frank"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Copula parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>The number of Monte Carlo simulations to find the critical value of the F-test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t.upper</code></td>
<td>
<p>Follow-up end (default is max(t.vec))</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>Contrast matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S.plot</code></td>
<td>
<p>If TRUE, the survival curve is displayed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mark.time</code></td>
<td>
<p>If TRUE, then curves are marked at each censoring time</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Estimates of treatment effects and the test results are shown.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>copula.parameter</code></td>
<td>
<p>Copula parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Estimates of treatment effects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Var</code></td>
<td>
<p>Variance estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>F</code></td>
<td>
<p>F-statistic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c.simu</code></td>
<td>
<p>Critical value via the simulation method</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c.anal</code></td>
<td>
<p>Critical value via the analytical method</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P.value</code></td>
<td>
<p>P-value of the F-test</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Takeshi Emura</p>


<h3>References</h3>

<p>Emura T, Ditzhaus M, Dobler D, Murotani K (2024), Factorial survival analysis for treatment effects under dependent censoring, Stat Methods Med Res 33(1):61-79.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(survival)
data(cancer)
dat=subset(colon,etype==1)
## Treatment effects ##
t.vec=dat$time
d.vec=dat$status
trt=dat$rx
C12=matrix(c(1,-1,0),1,3,byrow=TRUE)
C13=matrix(c(1,0,-1),1,3,byrow=TRUE)
C23=matrix(c(0,1,-1),1,3,byrow=TRUE)
group=as.numeric(trt) # 1=Obs; 2=Lev; 3=Lev+5FU
# surv.factorial(t.vec,d.vec,group,alpha=2,copula=CG.Clayton)
# surv.factorial(t.vec,d.vec,group,alpha=2,copula=CG.Clayton,C=C12)
# surv.factorial(t.vec,d.vec,group,alpha=2,copula=CG.Clayton,C=C13)
# surv.factorial(t.vec,d.vec,group,alpha=2,copula=CG.Clayton,C=C23)
# alpha is a copula parameter

</code></pre>


</div>