<div class="container">

<table style="width: 100%;"><tr>
<td>pcaDiag</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Outlier Diagnostic Plots for PCA of a Spectra Object</h2>

<h3>Description</h3>

<p>A function to carry diagnostics on the PCA results for a
<code>Spectra</code> object.  Basically a wrapper to Filzmoser's
<code>pcaDiagplot</code> which colors everything according to
the scheme stored in the <code>Spectra</code> object.  Works with PCA
results of either class <code>prcomp</code> or class <code>princomp</code>.  Works
with either classical or robust PCA results.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pcaDiag(
  spectra,
  pca,
  pcs = 3,
  quantile = 0.975,
  plot = c("OD", "SD"),
  use.sym = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>spectra</code></td>
<td>
<p>An object of S3 class <code>Spectra()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pca</code></td>
<td>
<p>An object of class <code>prcomp</code>
modified to include a character string (<code>$method</code>) describing the
pre-processing carried out and the type of PCA performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pcs</code></td>
<td>
<p>As per <code>pcaDiagplot</code>.  The number of
principal components to include.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quantile</code></td>
<td>
<p>As per <code>pcaDiagplot</code>.  The
significance criteria to use as a cutoff.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>A character string, indicating whether to plot the score
distances or orthogonal distances, or both.  Options are <code>c("OD",
"SD")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.sym</code></td>
<td>
<p>logical; if true, the color scheme is change to black and
symbols are used for plotting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Parameters to be passed to the plotting routines. <em>Applies to base graphics only</em>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If both plots are desired, the output should be directed to a file rather
than the screen.  Otherwise, the 2nd plot overwrites the 1st in the active
graphics window.  Alternatively, just call the function twice, once
specifying <code>OD</code> and once specifying <code>SD</code>.
</p>


<h3>Value</h3>

<p>The returned value depends on the graphics option selected (see <code>ChemoSpecUtils::GraphicsOptions()</code>).
</p>

<ul>
<li> <p><strong>base</strong> A data frame or list containing the data plotted.  Assign the value and run <code>str()</code> or <code>names()</code> on it to see what it contains. Side effect is a plot.
</p>
</li>
<li> <p><strong>ggplot2</strong> The plot is displayed, and a <code>ggplot2</code> plot object is returned if the value is assigned. The plot can be modified in the usual <code>ggplot2</code> manner. If you want the plotted values, you can access them via the base graphics mode.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University), Tejasvi Gupta.
</p>


<h3>References</h3>

<p>K. Varmuza and P. Filzmoser <em>Introduction to Multivariate
Statistical Analysis in Chemometrics</em>, CRC Press, 2009.
</p>


<h3>See Also</h3>

<p><code>pcaDiagplot</code> in package
<code>chemometrics</code> for the underlying function. Additional documentation at
<a href="https://bryanhanson.github.io/ChemoSpec/">https://bryanhanson.github.io/ChemoSpec/</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># This example assumes the graphics output is set to ggplot2 (see ?GraphicsOptions).
library("ggplot2")
data(SrE.IR)
pca &lt;- c_pcaSpectra(SrE.IR, choice = "noscale")
p1 &lt;- pcaDiag(SrE.IR, pca, pcs = 2, plot = "OD") + ggtitle("OD Plot")
p1
p2 &lt;- pcaDiag(SrE.IR, pca, pcs = 2, plot = "SD") + ggtitle("SD Plot")
p2

</code></pre>


</div>