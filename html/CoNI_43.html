<div class="container">

<table style="width: 100%;"><tr>
<td>plotPcorvsCor</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Correlation vs Partial correlation</h2>

<h3>Description</h3>

<p>This function fits two linear models on standardize data and plots the results. It generates a scatter plot with two regression lines, where the slopes correspond to the correlation and partial correlation coefficients (blue for cor and red for pcor)
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotPcorvsCor(
  ResultsCoNI,
  edgeFeature,
  vertexD,
  edgeD,
  vertexFeatures = NULL,
  outputDir = "./",
  fname,
  label_edgeFeature = "Edge Feature",
  plot_to_screen = TRUE,
  height = 10,
  width = 8,
  saveFiles = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ResultsCoNI</code></td>
<td>
<p>The significant results generated by CoNI</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edgeFeature</code></td>
<td>
<p>The edge feature to explore e.g. Fabp2 (for a gene)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vertexD</code></td>
<td>
<p>Vertex data that was given as input to CoNI</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edgeD</code></td>
<td>
<p>Edge data that was given as input to CoNI</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vertexFeatures</code></td>
<td>
<p>The vertex features to include as a list. If not specified all metabolites available in combination with the edgeFeature will be used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outputDir</code></td>
<td>
<p>Output directory with path</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fname</code></td>
<td>
<p>File name to save the plots</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label_edgeFeature</code></td>
<td>
<p>Name for plot title e.g. Gene or Protein</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_to_screen</code></td>
<td>
<p>logical. If TRUE plots will be outputted to the plotting screen</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>height</code></td>
<td>
<p>height of the plotting area for the saved file</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>width of the plotting are for the saved file</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>saveFiles</code></td>
<td>
<p>logical. If FALSE plot is not saved to disk</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a ggplot object for a scatter plot with two regression lines.
The blue line is the regression of the vertex features, and the red line is the regression
of the resulting residuals after regressing each vertex feature with the edge feature.
The slope of the blue line corresponds to the pearson correlation coefficient and the slope of the red line
to the partial correlation coefficient
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Load gene expression - Toy dataset of two treatments
data(GeneExpToy)
#Samples in rows and genes in columns
GeneExp &lt;- as.data.frame(t(GeneExpToy))
hfd_gene &lt;- GeneExp[1:8,] #high fat diet
chow_gene&lt;- GeneExp[9:nrow(GeneExp),] #chow diet

#Load metabolite expression - Toy dataset of two treatments
data(MetaboExpToy)
MetaboExp &lt;- MetaboExpToy
hfd_metabo &lt;- MetaboExp[11:18,] #high fat diet
chow_metabo &lt;- MetaboExp[1:10,] #chow diet

#Match row names both data sets
rownames(hfd_metabo)&lt;-rownames(hfd_gene)
rownames(chow_metabo)&lt;-rownames(chow_gene)

#Load CoNI results
data(CoNIResultsHFDToy)

plotPcorvsCor(ResultsCoNI = CoNIResultsHFDToy,
              edgeFeature = "Arfrp1",
              vertexFeatures = c("PC.ae.C40.2", "SM..OH..C22.1"),
              vertexD = hfd_metabo,
              edgeD = hfd_gene,
              label_edgeFeature = "Gene",
              plot_to_screen = TRUE,
              height = 10,
              saveFiles = FALSE)
</code></pre>


</div>