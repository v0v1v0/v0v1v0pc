<div class="container">

<table style="width: 100%;"><tr>
<td>iterator</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Iterator protocol</h2>

<h3>Description</h3>

<p>An <strong>iterator</strong> is a function that implements the following
protocol:
</p>

<ul>
<li>
<p> Calling the function advances the iterator. The new value is
returned.
</p>
</li>
<li>
<p> When the iterator is exhausted and there are no more elements to
return, the symbol <code>quote(exhausted)</code> is returned. This signals
exhaustion to the caller.
</p>
</li>
<li>
<p> Once an iterator has signalled exhaustion, all subsequent
invokations must consistently return <code>coro::exhausted()</code> or
<code>as.symbol(".__exhausted__.")</code>.
</p>
</li>
</ul>
<div class="sourceCode r"><pre>iterator &lt;- as_iterator(1:3)

# Calling the iterator advances it
iterator()
#&gt; [1] 1
iterator()
#&gt; [1] 2

# This is the last value
iterator()
#&gt; [1] 3

# Subsequent invokations return the exhaustion sentinel
iterator()
#&gt; .__exhausted__.
</pre></div>
<p>Because iteration is defined by a protocol, creating iterators is
free of dependency. However, it is often simpler to create
iterators with generators, see
<code>vignette("generator")</code>. To loop over an iterator, it is simpler
to use the <code>loop()</code> and <code>collect()</code> helpers provided in this
package.
</p>


<h3>Usage</h3>

<pre><code class="language-R">exhausted()

is_exhausted(x)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object.</p>
</td>
</tr></table>
<h3>Properties</h3>

<p>Iterators are <strong>stateful</strong>. Advancing the iterator creates a
persistent effect in the R session. Also iterators are
<strong>one-way</strong>. Once you have advanced an iterator, there is no going
back and once it is exhausted, it stays exhausted.
</p>
<p>Iterators are not necessarily finite. They can also represent
infinite sequences, in which case trying to exhaust them is a
programming error that causes an infinite loop.
</p>


<h3>The exhausted sentinel</h3>

<p>Termination of iteration is signalled via a sentinel value,
<code>as.symbol(".__exhausted__.")</code>. Alternative designs include:
</p>

<ul>
<li>
<p> A condition as in python.
</p>
</li>
<li>
<p> A rich value containing a termination flag as in Javascript.
</p>
</li>
</ul>
<p>The sentinel design is a simple and efficient solution but it has a
downside. If you are iterating over a collection of elements that
inadvertently contains the sentinel value, the iteration will be
terminated early. To avoid such mix-ups, the sentinel should only
be used as a temporary value. It should be created from scratch by
a function like <code>coro::exhausted()</code> and never stored in a container
or namespace.
</p>


</div>