<div class="container">

<table style="width: 100%;"><tr>
<td>carVarSelect</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Variable selection with Correlation-Adjusted Regression Survival (CARS) Scores</h2>

<h3>Description</h3>

<p>Computes the CARS scores and selects significant variables. 
If the false non discovery rate (fndr) approach is used, significant and null variables
are distinguished by an a priori defined q-value.
</p>


<h3>Usage</h3>

<pre><code class="language-R">carVarSelect(carSurvScores, method = "fndr", plotDiag = FALSE,
  threshold = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>carSurvScores</code></td>
<td>
<p>Estimated CAR survival scores of each variable (numeric vector).
See function <code>carSurvScore</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Gives the variable selection procedure. Default is "fndr", which is based
on the false non-discovery-rate. The other option is "threshold", which selects only 
variables above a given empirical quantile.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotDiag</code></td>
<td>
<p>Should diagnostic plots of the null distribution be plotted? 
Default is FALSE (logical scalar).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>If method="threshold", then this specifies the quantile threshold of
the CAR survival scores. Every score above this threshold is then a significant variable.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Index giving the significant variables of the original data (integer vector).
</p>


<h3>Note</h3>

<p>The quality of estimated, significant variables depends on the sample size 
and on the number of variables.
</p>


<h3>Author(s)</h3>

<p>Thomas Welchowski
</p>


<h3>References</h3>

<p>Strimmer, K., (2008), A unified approach to false discovery rate estimation, BMC Bioinformatics
</p>


<h3>See Also</h3>

<p><code>carSurvScore</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">##########################################
# Simulate accelerated, failure time model

# Generate multivariate normal distributed covariates
noObs &lt;- 100
noCovar &lt;- 250
library(mvtnorm)
set.seed(7903)
X &lt;- rmvnorm(noObs, mean=rep(0, noCovar), sigma=diag(noCovar))

# Generate gamma distributed survival times
# Only the first 5 variables have an influence
eta &lt;- 1 - 2 * X[,1] - X[,2] + X[,3] +
0.5 * X[,4] + 1.5 * X[,5]

# Function to generate survival times
genSurv &lt;- function(x) {
set.seed(x)
rgamma(1, shape=2, scale=exp(eta[x]))
}

# Generate survival times
survT &lt;- sapply(1:length(eta), genSurv)

# Generate exponential distributed censoring times
censT &lt;- rexp(noObs, rate=1)

# Calculate event indicator
eventInd &lt;- ifelse(survT &lt;= censT, 1, 0)

# Calculate observed times
obsTime &lt;- survT
obsTime[survT &gt; censT] &lt;- censT [survT &gt; censT]

# Conduct variable selection using fndr
carScores &lt;- carSurvScore(obsTime=obsTime, obsEvent=eventInd, X=X)
selectedVar &lt;- carVarSelect(carSurvScores=carScores)
selectedVar

# Check true positive and true negative rate
TPR &lt;- mean(c(1:5) %in% selectedVar)
TNR &lt;- mean(c(6:250) %in% setdiff(6:250, selectedVar))
perf &lt;- TPR + TNR -1
perf
</code></pre>


</div>