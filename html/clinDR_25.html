<div class="container">

<table style="width: 100%;"><tr>
<td>plot.fitEmax</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot a Emax model and dose group means.
</h2>

<h3>Description</h3>

<p>Plot an Emax model stored in an object
created by function <code>fitEmax</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'fitEmax'
plot(
          x,int=0,plotResid=FALSE,clev=0.9,
          predict=TRUE,plotci=TRUE,plotDif=FALSE,
          xlab='Dose',
          ylab=ifelse(plotResid,'Residuals',ifelse(plotDif,
                'Difference With Placebo','Response')),
          ncol=NULL,
          symbol=NULL,symbolLabel='Group',symbolShape=8,
          symbolColor='red',symbolSize=4,
          bwidth=NULL,
          xlim=NULL,
          xat=NULL,
          ylim=NULL,
          logScale=FALSE,       
          ngrid=200,
          plot=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Output of <code>fitEmax</code> with class
"fitEmax".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>int</code></td>
<td>
<p>The index for the protocol (intercept) to use for the predictions 
and computation of dose group means and standard errors.  The default
value is <code>0</code>, which displays all protocols in a grid layout.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotResid</code></td>
<td>
<p>If <code>TRUE</code>, a residual plot of the observed dose group means  
is produced instead of a dose response curve plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clev</code></td>
<td>
<p>Confidence level for intervals about the estimated
mean for each dose.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predict</code></td>
<td>
<p>When predict=TRUE, predictive intervals for sample dose group
means are plotted.  They are gray-shaded bars. If there is <code>&gt;1</code> symbol group
mean for a protocol/dose combination, then the smaller sample size is used when computing
the prediction interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotci</code></td>
<td>
<p>When plotCI=TRUE, confidence intervals for the population dose group
means are plotted.  They are black bars.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotDif</code></td>
<td>
<p>Plot difference between doses and placebo.  It is assumed the lowest
dose in each protocol is placebo.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>Label for the x-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>Label for the y-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncol</code></td>
<td>
<p>When more than one protocol is plotted, <code>ncol</code> specifies
the number of side by side plots in the plot grid.  The default is 3 or
5 depending on the plot type</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>symbol</code></td>
<td>
<p>An optional grouping variable.  
The values of symbol must correspond to the original data used in 
<code>fitEmax</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>symbolLabel</code></td>
<td>
<p>Label given to symbol in plot legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>symbolShape</code></td>
<td>
<p>A character vector with named elements giving 
the shapes assigned
to different levels of variable <code>symbol</code>.  If a single shape is 
specified, it is replicated for all dose group means.  See package
<code>ggplot2</code> for symbol mappings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>symbolColor</code></td>
<td>
<p>A character vector with named elements 
giving the colors assigned
to different levels of variable <code>symbol</code>.  If a single color is 
specified, it is replicated for all dose group means.  See package
<code>ggplot2</code> for color mappings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>symbolSize</code></td>
<td>
<p>The size of the symbol for the dose group sample means.   
Set <code>symbolSize=0</code> to supress plotting the means.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bwidth</code></td>
<td>
<p>Width of the cap on the predictive interval bars.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>Plot limits for the x-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xat</code></td>
<td>
<p>The points at which tick-marks are to be drawn. Errors occur if the 
points are outside the range of xlim. By default (when NULL) tickmark locations are    computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>Plot limits for the y-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logScale</code></td>
<td>
<p>If <code>TRUE</code>, log scale is used for dose.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ngrid</code></td>
<td>
<p>The number doses evaluated when plotting the curve.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>Return plotting output without plotting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>No additional plotting options are currently used.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Model estimates, standard errors, and confidence bounds are computed 
using function <code>SeEmax</code>.   
</p>
<p>The function generates random numbers when <code>predict=TRUE</code>, so the random number generator/seed must
be set before the function is called for exact reproducibility.
</p>


<h3>Value</h3>

<p>A list with ggplot object, and a matrix with the confidence and prediction interval
limits.
</p>


<h3>Author(s)</h3>

<p>Neal Thomas </p>


<h3>See Also</h3>

<p><code>nls</code></p>


<h3>Examples</h3>

<pre><code class="language-R">### example changes the random number seed

doselev&lt;-c(0,5,25,50,100,350)
n&lt;-c(78,81,81,81,77,80)

### population parameters for simulation
e0&lt;-2.465375 
ed50&lt;-67.481113 

dtarget&lt;-100
diftarget&lt;-9.032497
emax&lt;-solveEmax(diftarget,dtarget,log(ed50),1,e0)

sdy&lt;-8.0
pop.parm&lt;-c(log(ed50),emax,e0)    
dose&lt;-rep(doselev,n)
meanlev&lt;-emaxfun(dose,pop.parm)  

y&lt;-rnorm(sum(n),meanlev,sdy)

testout&lt;-fitEmax(y,dose,modType=4)

plot(testout)
</code></pre>


</div>