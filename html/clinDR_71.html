<div class="container">

<table style="width: 100%;"><tr>
<td>"Extract.emaxsim"</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extract a simulation from the output of emaxsim </h2>

<h3>Description</h3>

<p>Extract a simulated data set from the output of
emaxsim. Data are re-created using the stored random number seed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'emaxsim'
x[i, ...]
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Output object from <code>emaxsim</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>i</code></td>
<td>
<p>Simulation replication to extract </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Parameters passed to other functions (none currently) </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Re-creates the ith simulated data set for subsequent analyses.  Also returns all
analyses done for the ith data set in  <code>emaxsim</code>
</p>


<h3>Value</h3>

<p>A list is returned with class(emaxsimobj) containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Response vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dose</code></td>
<td>
<p>Doses corresponding to <code>y</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pop</code></td>
<td>
<p>Population parameters; type of parameter depends on
constructor function generating study data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>popSD</code></td>
<td>
<p>Vector containing the population SD used to generate
continuous data.  <code>NULL</code> for binary data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>Starting Emax parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est4</code></td>
<td>
<p> 4-parmameter Emax fit (ed50,lambda,emax,e0).  NA if
failed to converge or 3-parameter model requested.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est3</code></td>
<td>
<p> 3-parmameter Emax fit (ed50,emax,e0).  NA if
failed to converge or 4-parameter model successfully fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estA</code></td>
<td>
<p>Alternative parameter estimates.  NA if
Emax model fit successfully</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vc</code></td>
<td>
<p>The variance-covariance matrix of the model parameters 
for the selected model. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residSD</code></td>
<td>
<p>The residual SD based on the selected model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bigC</code></td>
<td>
<p>bigC= TRUE if the primary fit (from modType) yielded an 
ED50 &gt; ED50 upper limit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>negC</code></td>
<td>
<p>negC= TRUE if the primary fit (from modType) yielded a
negative ED50 estimate&lt; ED50 lower limit </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modType</code></td>
<td>
<p>When modType=4, the fitting begins with the 4
parameter model.  If estimation fails or modType=3, the 3-parameter
estimation is applied.  If it fails, a best-fitting model linear in
its parameters is selected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>Output of model determined by fitType</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitType</code></td>
<td>
<p>Character vector with "4", "3", "L", "LL", or "E" for
4-Emax, 3-Emax, linear,
log-linear, or exponential when an alternative model is selected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ed50cutoff</code></td>
<td>
<p>Upper allowed limit for ED50 estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ed50lowcutoff</code></td>
<td>
<p>Lower allowed limit for the ED50 estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>switchMod</code></td>
<td>
<p>If switchMod is TRUE, the algorithm substitutes a
simpler model if (1) convergence is not achieved, (2) the information
matrix is not positive definite at the converged values, (3) the ED50
estimates are outside the cutoff bounds.  If switchMod is F, only
conditions (1) or (2) cause a simpler model to be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PL</code></td>
<td>
<p>T if the 'plinear' algorithm in
nls converged</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predpop</code></td>
<td>
<p>Population means for each dose group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dm</code></td>
<td>
<p>Vector containing dose group means</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dsd</code></td>
<td>
<p>Vector containing dose group SDs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitpred</code></td>
<td>
<p>Dose groups means
estimated from the model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sepred</code></td>
<td>
<p>SEs for estimates in
fitpred</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sedif</code></td>
<td>
<p>SEs for model-based estimates of difference with placebo</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pVal, selContrast</code></td>
<td>
<p>P-value and contrast selected from MCP-MOD test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>idmax</code></td>
<td>
<p>Index of default dose group for comparison to placebo</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Extraction from a simulation object requires re-creation of the
simulated data set.  If the
extracted object is to be used more than once, it is more efficient to
save the extracted object than reuse [].
</p>


<h3>Author(s)</h3>

<p>Neal Thomas </p>


<h3>See Also</h3>

<p><code>emaxsim</code>, <code>print.emaxsimobj</code>, 
<code>plot.emaxsimobj</code>, <code>update.emaxsimobj</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 
## code change random number seed

nsim&lt;-50
idmax&lt;-5
doselev&lt;-c(0,5,25,50,100)
n&lt;-c(78,81,81,81,77)

### population parameters for simulation
e0&lt;-2.465375 
ed50&lt;-67.481113 

dtarget&lt;-100
diftarget&lt;-9.032497
emax&lt;-solveEmax(diftarget,dtarget,log(ed50),1,e0)

sdy&lt;-7.967897
pop&lt;-c(log(ed50),emax,e0)    
meanlev&lt;-emaxfun(doselev,pop)  

###FixedMean is specialized constructor function for emaxsim
gen.parm&lt;-FixedMean(n,doselev,meanlev,sdy)  

D1 &lt;- emaxsim(nsim,gen.parm,modType=3)
e49&lt;-D1[49]                  #### extract 49th simulation


## End(Not run)

</code></pre>


</div>