<div class="container">

<table style="width: 100%;"><tr>
<td>resid_boot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Obtain Residual Bootstrap</h2>

<h3>Description</h3>

<p>Generates bootstrap samples of the data vector.
</p>


<h3>Usage</h3>

<pre><code class="language-R">resid_boot(
  formula,
  data,
  gfix = NULL,
  eps = NULL,
  xi = NULL,
  null.resids = TRUE,
  theta = NULL,
  ssq = NULL,
  tsq = NULL,
  cov.theta = NULL,
  seed = NULL,
  nsim = 1000,
  mySolver = "LS",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula expression. The constrained effect(s) must come before any unconstrained covariates on the right-hand side of the expression. The first <code>ncon</code> terms will be assumed to be constrained.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data frame containing the variables in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gfix</code></td>
<td>
<p>optional vector of group levels for residual variances. Data should be sorted by this value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>estimates of residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xi</code></td>
<td>
<p>estimates of random effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null.resids</code></td>
<td>
<p>logical indicating if residuals should be computed under the null hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>estimates of fixed effects coefficients. Estimated if not submitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ssq</code></td>
<td>
<p>estimates of residual variance components. Estimated if not submitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tsq</code></td>
<td>
<p>estimates of random effects variance components. Estimated if not submitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov.theta</code></td>
<td>
<p>covariance matrix of fixed effects coefficients. Estimated if not submitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>set the seed for the RNG.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>number of bootstrap samples to use for significance testing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mySolver</code></td>
<td>
<p>solver to use, passed to <code>activeSet</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>space for additional arguments.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If any of the parameters <code>theta</code>, <code>ssq</code>, <code>tsq</code>, <code>eps</code>, or <code>xi</code> are provided, the function will use those values in generating the bootstrap samples. They will be estimated if not submitted. If<code>null.resids=TRUE</code>, then <code>theta</code> will be projected onto the space of the null hypothesis ( <code class="reqn">H_{0}: \theta_1 = \theta_2 = ... = \theta_{p_1}</code>) regardless of whether it is provided or estimated. To generate bootstraps with a specific <code>theta</code>, set <code>null.residuals=FALSE</code>.
</p>


<h3>Value</h3>

<p>Output is <code class="reqn">N \ times nsim</code> matrix, where each column is a bootstrap sample of the response data <code>Y</code>.
</p>


<h3>Note</h3>

<p>This function is primarily designed to be called by <code>clme</code>. 
</p>
<p>By default, homogeneous variances are assumed for the residuals and (if included) random effects. Heterogeneity can be induced using the arguments <code>Nks</code> and <code>Qs</code>, which refer to the vectors <code class="reqn"> (n_{1}, n_{2}, \ldots, n_{k}) </code> and <code class="reqn"> (c_{1}, c_{2}, \ldots, c_{q}) </code>, respectively. See <code>clme_em</code> for further explanation of these values.
</p>


<h3>See Also</h3>

<p><code>clme</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data( rat.blood )
boot_sample &lt;- resid_boot(mcv ~ time + temp + sex + (1|id), nsim = 10, 
                          data = rat.blood, null.resids = TRUE  )

</code></pre>


</div>