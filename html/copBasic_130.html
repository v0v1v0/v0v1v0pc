<div class="container">

<table style="width: 100%;"><tr>
<td>semicorCOP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Lower and Upper Semi-Correlations of a Copula</h2>

<h3>Description</h3>

<p>Compute the <em>lower semi-correlations</em> (bottom-left)
</p>
<p style="text-align: center;"><code class="reqn">\rho^{N{-}{-}}_\mathbf{C}(u,v; a) = \rho_N^{{-}{-}}(a) \mbox{ and}</code>
</p>

<p>compute the <em>upper semi-correlations</em> (top-right)
</p>
<p style="text-align: center;"><code class="reqn">\rho^{N{+}{+}}_\mathbf{C}(u,v; a) = \rho_N^{{+}{+}}(a)</code>
</p>

<p>of a copula <code class="reqn">\mathbf{C}(u,v)</code> (Joe, 2014, p. 73) using numerical simulation. The semi-correlations are defined as
</p>
<p style="text-align: center;"><code class="reqn">\rho_N^{{-}{-}}(a) = \mathrm{cor}[Z_1, Z_2 \mid Z_1 &lt; -a, Z_2 &lt; -a]\mbox{,}</code>
</p>

<p style="text-align: center;"><code class="reqn">\rho_N^{{+}{+}}(a) = \mathrm{cor}[Z_1, Z_2 \mid Z_1 &gt; +a, Z_2 &gt; +a]\mbox{,\ and}</code>
</p>

<p style="text-align: center;"><code class="reqn">\rho_N(a &gt; -\infty) = \mathrm{cor}[Z_1, Z_2]\mbox{,}</code>
</p>

<p>where <code class="reqn">\mathrm{cor[z_1, z_2]}</code> is the familiar <em>Pearson correlation function</em>, which is in <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> the syntax <code>cor(...,</code> <code>method="pearson")</code>, parameter <code class="reqn">a \ge 0</code> is a truncation point that identifies <em>truncated tail regions</em> (Joe, 2014, p. 73), and lastly <code class="reqn">(Z_1, Z_2) \sim \mathbf{C}(\Phi, \Phi)</code> and thus from the standard normal distribution <code class="reqn">(Z_1, Z_2) = (\Phi^{-1}(u), \Phi^{-1}(v))</code> where the random variables <code class="reqn">(U,V) \sim \mathbf{C}</code>.
</p>
<p>The semi-correlations are extended for the <span class="pkg">copBasic</span> package into bottom right and top left versions as well by
</p>
<p style="text-align: center;"><code class="reqn">\rho_N^{{+}{-}}(a) = \mathrm{cor}[Z_1, Z_2 \mid Z_1 &gt; +a, Z_2 &lt; -a]\mbox{,\ and}</code>
</p>

<p style="text-align: center;"><code class="reqn">\rho_N^{{-}{+}}(a) = \mathrm{cor}[Z_1, Z_2 \mid Z_1 &lt; -a, Z_2 &gt; +a]\mbox{.}</code>
</p>

<p>As a result, the notations <code class="reqn">{-}{-}</code>, <code class="reqn">{+}{+}</code>, <code class="reqn">{+}{-}</code>, and <code class="reqn">{-}{+}</code> can be used to represent each of the respective corners bottom-left, top-right, bottom-right, and top-left of the <code class="reqn">(u,v)</code> domain with the respective truncation. These words are used in the variable names of the returned list from the function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">semicorCOP(cop=NULL, para=NULL, truncation=0, n=0, as.sample=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cop</code></td>
<td>
<p>A copula function;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>para</code></td>
<td>
<p>Vector of parameters or other data structure, if needed, to pass to the copula;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>truncation</code></td>
<td>
<p>The truncation value for <code class="reqn">a</code>, which is in standard normal variates, and the default of zero is the origin (medians);</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The sample size <code class="reqn">n</code> for simulation estimates of the <code class="reqn">\rho_N</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>as.sample</code></td>
<td>
<p>A logical controlling whether an optional <code>data.frame</code> in <code>para</code> is used to compute the <code class="reqn">\hat\rho_N</code> (see <b>Note</b>); and</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to pass to the copula.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The value(s) for <code class="reqn">\rho_N</code>, <code class="reqn">\rho_N^{{-}{-}}</code>, <code class="reqn">\rho_N^{{+}{+}}</code>, <code class="reqn">\rho_N^{{+}{-}}</code>, and <code class="reqn">\rho_N^{{-}{+}}</code> are returned.
</p>


<h3>Note</h3>

<p>The sample semi-correlations can be computed from a two-column table that is passed into the function using the <code>para</code> argument. Although the truncation point <code class="reqn">a \ge 0</code>, as <code class="reqn">a</code> increases and focus is increasingly made into one or the other truncated tail regions, the sample version with data becomes decreasing well estimated because the available sample size diminishes. The <code>para</code> argument can contain probabilities or raw data because internally the function computes the <em>Hazen plotting positions</em> (<em>e.g.</em> <code class="reqn">u_i = (i-0.5) / n</code> for rank <code class="reqn">i</code> and sample size <code class="reqn">n</code>) because Joe (2014, pp. 9, 17, 245, 247â€“248) repeatedly emphasizes this form of plotting position when normal scores are involved.
</p>


<h3>Author(s)</h3>

<p>W.H. Asquith</p>


<h3>References</h3>

<p>Joe, H., 2014, Dependence modeling with copulas: Boca Raton, CRC Press, 462 p.
</p>


<h3>See Also</h3>

<p><code>giniCOP</code>, <code>rhoCOP</code>, <code>tauCOP</code>, <code>COP</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Gumbel-Hougaard copula with Pearson rhoN = 0.4 (by definition)
run &lt;- sapply(1:50, function(i) semicorCOP(cop=GHcop, para=1.350, n=600))
mean(unlist(run[1,])) # cor.normal.scores
mean(unlist(run[2,])) #  botleft.semicor
mean(unlist(run[3,])) # topright.semicor
sd(  unlist(run[1,])) # cor.normal.scores (These are our sampling variations
sd(  unlist(run[2,])) #  botleft.semicor   for the n=600 used as a Monte
sd(  unlist(run[3,])) # topright.semicor   Carlo simulation.)
# The function returns:    rhoN = 0.392112, rhoN--= 0.117674, rhoN++= 0.404733
#  standard deviations           (0.038883)        (0.073392)        (0.073942)
# Joe (2014, p. 72) shows: rhoN = 0.4_____, rhoN--= 0.132___, rhoN++= 0.415___
#  standard deviations           (not avail)       (0.08____)        (0.07____)
# We see alignment with the results of Joe with his n=600. #
## End(Not run)

## Not run: 
p &lt;- 0.5 # Reasonable strong positive association for the Raftery copula,
# but then we are going to be reflecting and rotating the copula.
# See similar Example under COP() function.
"RFcop1" &lt;- function(u,v, para) COP(u,v, cop=RFcop, para=para, reflect="1")
"RFcop2" &lt;- function(u,v, para) COP(u,v, cop=RFcop, para=para, reflect="2")
"RFcop3" &lt;- function(u,v, para) COP(u,v, cop=RFcop, para=para, reflect="3")
"RFcop4" &lt;- function(u,v, para) COP(u,v, cop=RFcop, para=para, reflect="4")
RF &lt;- NULL; n &lt;- 10000
RF &lt;- rbind(RF, as.data.frame(semicorCOP(cop=RFcop1, para=p, n=n))[,1:5])
RF &lt;- rbind(RF, as.data.frame(semicorCOP(cop=RFcop2, para=p, n=n))[,1:5])
RF &lt;- rbind(RF, as.data.frame(semicorCOP(cop=RFcop3, para=p, n=n))[,1:5])
RF &lt;- rbind(RF, as.data.frame(semicorCOP(cop=RFcop4, para=p, n=n))[,1:5])
print(RF[,1:3]) # total sample and lower and upper semi-correlations
#   cor.normal.scores botleft.semicor topright.semicor
# 1         0.5587837      0.74124686       0.10027641
# 2         0.5567889      0.10302772       0.73729702
# 3        -0.5807201     -0.04683536      -0.01714573 # see near zeros --,++
# 4        -0.5698139      0.03040520       0.05125916 # see near zeros --,++
print(RF[,2:5]) # now look at all four corners
#   botleft.semicor topright.semicor topleft.semicor botright.semicor
# 1      0.74124686       0.10027641      0.01529508       0.02046530
# 2      0.10302772       0.73729702     -0.05195628       0.01747874
# 3     -0.04683536      -0.01714573     -0.11106842      -0.74077321
# 4      0.03040520       0.05125916     -0.74516061      -0.07636233
# Notice how the tight tail of the copula, being reflected and rotated
# into each of the four corners, shows semi-correlation magnitude of 0.74.
# See the copula density plots of COP() Examples section. 
## End(Not run)
</code></pre>


</div>