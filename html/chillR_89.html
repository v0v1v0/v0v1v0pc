<div class="container">

<table style="width: 100%;"><tr>
<td>plot_scenarios</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot historic and future scenarios for climate-related metrics (<code>ggplot2</code> version)</h2>

<h3>Description</h3>

<p>Visualize outputs from the <code>temperature_generation</code> function used
in climate-related assessments. These outputs are usually compiled with the
<code>make_climate_scenario</code> function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_scenarios(
  scenario_list,
  metric,
  add_historic = TRUE,
  ...,
  outlier_shape = 19,
  historic_color = "white",
  group_by = c("Scenario", "Year"),
  y_axis_name = paste("Cumulative response in", metric),
  x_axis_name = "Year",
  legend_title = "Climate model",
  legend_labels = NULL,
  panel_labels = NULL,
  base_size = 11
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>scenario_list</code></td>
<td>
<p>is a list of lists containing information and data about the scenarios to be plotted. These
lists must have:</p>

<ul>
<li>
<p>an element named <code>data</code>, which should be a list containing one or more named dataframes with a column
named the same as the <code>metric</code> argument. This column must contain (<code>numeric</code>) information to be plotted.
Dataframes of climate-related metrics can be obtained with the 
<code>tempResponse_daily_list</code> function. For
past scenarios, the names of the dataframes can be the reference years used to generate the
scenarios. These names will be recycled and used in the x-axis of the historic panel. For future 
scenarios, the names of the dataframes can be the models used in the projections. These names
will appear in the legend for future panels.
</p>
</li>
<li>
<p>an element named <code>caption</code> containing information about the scenario which the list
is related to.
</p>
</li>
<li>
<p>an element named <code>historic_data</code> which represents a data frame for 
actual observations in past scenarios. This element can be optional but is mandatory if
<code>add_historic = TRUE</code>
</p>
</li>
<li>
<p><code>time_series</code> is an optional argument that defines whether the scenario contains
a time series.
</p>
</li>
<li>
<p><code>labels</code> is an optional vector that usually contains the names of the elements used for
<code>metric_summary</code> in <code>make_climate_scenario</code>.</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metric</code></td>
<td>
<p>is a character string corresponding to the name of the column that contains the data of interest
in the dataframe of the <code>scenario_list</code> (and, if applicable, in the
<code>historic_data</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add_historic</code></td>
<td>
<p>is a boolean parameter to define whether the plot should include the actual observations
of historic climate-related metrics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>accepts arguments that can be passed to <code>layer</code> and are 
commonly used outside the aesthetic function for different geoms. In this case, <code>...</code> is passed to the 
<code>geom_point</code> function in the case that actual observations of chill or heat
are displayed. Options are <code>size</code>, <code>color</code>, among others.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outlier_shape</code></td>
<td>
<p>is the optional shape to replace the outliers in the boxplots. To show no oultiers
use <code>NA</code>. See <code>shape</code> for shape options.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>historic_color</code></td>
<td>
<p>is a character string corresponding to the color used to fill the boxplots in simulated
historic scenarios. Supported options are those provided by <code>colors</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group_by</code></td>
<td>
<p>is a vector of character strings indicating how the plots should be grouped.
I.e. by <code>Scenario</code> and then <code>Year</code> or viceversa.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_axis_name</code></td>
<td>
<p>is a character string representing the title of the y axis in the final plot. Default
is set to <code>paste('Cumulative response in', metric)</code> to let the function obtain the name based on 
the <code>metric</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_axis_name</code></td>
<td>
<p>is a character string representing the title of the x axis in the 'Historic' panel.
Default is set to <code>Year</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend_title</code></td>
<td>
<p>is a character string representing the title of the legend showing the
climate models used in the assessment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend_labels</code></td>
<td>
<p>is a vector of character strings that allows the user to modify the names of the climate
models used in the projections. The length of the vector must coincide with the number of climate models.
Default is set to <code>NULL</code> to let the function use the labels generated with the
<code>make_climate_scenario</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>panel_labels</code></td>
<td>
<p>is a list of 3 named objects that allows the user to customize the text in the upper part
of the plot. Default is set to <code>NULL</code> to let the function use the labels generated with the
<code>make_climate_scenario</code> function. If provided, the
objects of the list must be:</p>

<ul>
<li>
<p>an element named <strong>Historic</strong> containing the name to be used in the 'Historic' panel.
</p>
</li>
<li>
<p>an element named <strong>Scenario</strong> containing the names of the scenarios used for the projections.
If <code>group_by = c("Year", "Scenario")</code> is used, <code>Scenario</code> must be a list of named objects 
according to the labels used in the <code>Year</code> object. See examples.
</p>
</li>
<li>
<p>an element named <strong>Year</strong> containing the labels to be used for the time horizons used in the
assessment. If <code>group_by = c("Scenario", "Year")</code> is used, <code>Year</code> must be a list of named objects 
according to the labels used in the <code>Scenario</code> object. See examples.</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>base_size</code></td>
<td>
<p>is an integer to define the relative size of the text in the final plot. This argument
is passed to <code>ggpplot2::theme_bw</code>. Default is set to 11.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>plot_scenarios</code> uses the <code>ggplot2</code> syntax for producing separated
plots for historic and future scenarios. Later, the plots are merged into one final figure by using the
<code>patchwork</code> library.
</p>


<h3>Value</h3>

<p>A plot of classes <code>'patchwork'</code>, <code>'gg'</code>, and <code>'ggplot'</code>. This allows the user to
continue editing some features of the plots through the syntax (i.e. <code>'&amp;'</code>,
and <code>'+'</code>) from both libraries (see examples).
</p>
<p><img src="../help/figures/plotscenariosexample.png" width="100%" alt="plot\_scenarios example"></p>


<h3>Author(s)</h3>

<p>Eduardo Fernandez and Eike Luedeling
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Make 3 identical objects as scenarios; let's assume these represent the
# years 2000, 2005 and 2010.

library(chillR)

# Compute chill responses for KA_weather data

chill &lt;- tempResponse(stack_hourly_temps(
                      fix_weather(KA_weather[which(KA_weather$Year &gt; 2006), ]),
                      latitude = 50.4), Start_JDay = 305, End_JDay = 60)


# Simulated scenarios labels

past_labels &lt;- c(2000, 2005, 2010)

# Models labels

models_labels &lt;- c("Climate model 1", "Climate model 2",
                   "Climate model 3")

# Add named elements to past and future scenarios

scenario_results_past &lt;- list(`2000` = chill,
                              `2005` = chill,
                              `2010` = chill)
                              
scenario_results_future &lt;- list(`Climate model 1` = chill,
                                `Climate model 2` = chill,
                                `Climate model 3` = chill)

# Define the climate scenario  

climate_scenario_list &lt;- list(list(data = scenario_results_past,
                                   caption = c("Historic", "data"),
                                   time_series = TRUE,
                                   labels = past_labels,
                                   historic_data = chill),
                              list(data = scenario_results_future,
                                   caption = c("Scenario 1", "2050"),
                                   labels = models_labels),
                              list(data = scenario_results_future,
                                   caption = c("Scenario 1", "2075"),
                                   labels = models_labels),
                              list(data = scenario_results_future,
                                   caption=c("Scenario 1", "2100"),
                                   labels = models_labels),
                              list(data = scenario_results_future,
                                   caption=c("Scenario 2", "2040"),
                                   labels = models_labels),
                              list(data = scenario_results_future,
                                   caption=c("Scenario 2", "2080"),
                                   labels = models_labels))
                                   
# Plot the climate scenarios

plot_scenarios(climate_scenario_list, metric = 'Chill_Portions',
               add_historic = TRUE, size = 2, shape = 3, color = 'blue',
               outlier_shape = 12, historic_color = 'skyblue',
               group_by = c("Year", "Scenario"))
               
## Plot scenarios modifying the whole text in the plot
## We will comment the next examples to reduce the running time in CRAN
## submissions...
# plot_scenarios(scenario_list = climate_scenario_list, metric = 'Chill_Portions',
#                add_historic = TRUE, size = 2, shape = 3, color = 'blue',
#                outlier_shape = 12, historic_color = 'skyblue',
#                group_by = c("Scenario", "Year"),
#                y_axis_name = "Acumulacion de frio en CP",
#                x_axis_name = "Tiempo",
#                legend_title = "Modelo climatico",
#                legend_labels = c("Modelo 1", "Modelo 2", "Modelo 3"),
#                panel_labels = list(Historic = "Historico",
#                                    Scenario = c("Escenario 1",
#                                                 "Escenario 2"),
#                                    Year = list(`Escenario 1` = c("Futuro cercano",
#                                                                  "Futuro medio",
#                                                                  "Future lejano"),
#                                                `Escenario 2` = c("Futuro cercano",
#                                                                  "Futuro medio"))))

## Since the output is a ggplot object, it is possible to continue
## modifying some general aspects of the plot

## Define the basic plot 
# plot &lt;- plot_scenarios(climate_scenario_list, metric = 'Chill_Portions',
#                        add_historic = TRUE, size = 2, shape = 3, color = 'blue',
#                        outlier_shape = 12, historic_color = 'skyblue')


## Example to change the color of the climate model scale

# plot &amp; ggplot2::scale_fill_brewer(type = 'qual')

## Modify the format of axis title and axis text

# plot &amp; ggplot2::theme(axis.title = ggplot2::element_text(size = 14,
#                                                          family = 'serif'),
#                       axis.text = ggplot2::element_text(face = 'bold',
#                                                         color = 'blue'))

</code></pre>


</div>