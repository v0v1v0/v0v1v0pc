<div class="container">

<table style="width: 100%;"><tr>
<td>mclust3dSpectra</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>mclust Analysis of a Spectra Object in 3D</h2>

<h3>Description</h3>

<p>This function conducts an mclust analysis of the PCA results of a
<code>Spectra</code> object and displays the results in 3D.  Classical or
robust confidence ellipses can be added if desired. Improperly classified
data points can be marked.  The interactive plot is made via <code>plotly</code>
and appears in a browser window. Note that the confidence ellipses computed
here are generated independently of the <code>Mclust</code> results - they do not
correspond to the ellipses seen in 2D plots from <code>Mclust</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mclust3dSpectra(
  spectra,
  pca,
  pcs = 1:3,
  ellipse = TRUE,
  rob = FALSE,
  cl = 0.95,
  frac.pts.used = 0.8,
  truth = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>spectra</code></td>
<td>
<p>An object of S3 class <code>Spectra()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pca</code></td>
<td>
<p>An object of class <code>prcomp</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pcs</code></td>
<td>
<p>An integer vector describing which PCs to use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ellipse</code></td>
<td>
<p>Logical indicating if confidence ellipses should be drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rob</code></td>
<td>
<p>Logical; if <code>ellipse = TRUE</code>, indicates that robust
confidence ellipses should be drawn.  If <code>FALSE</code>, classical confidence
ellipses are drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl</code></td>
<td>
<p>A number indicating the confidence interval for the ellipse.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frac.pts.used</code></td>
<td>
<p>If <code>ellipse = TRUE</code> and <code>rob = TRUE</code>, a
number indicating the fraction of the data points to be considered "good"
and thus used to compute the robust confidence ellipse.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>truth</code></td>
<td>
<p>A character vector indicating the known group membership for
reach row of the PC scores.  Generally this would be <code>spectra$groups</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments to be passed to <code>mclust</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The mclust model is returned invisibly, and a plot is produced.
</p>


<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University).
</p>


<h3>See Also</h3>

<p><code>Mclust</code> for background on the method.
Additional documentation at <a href="https://bryanhanson.github.io/ChemoSpec/">https://bryanhanson.github.io/ChemoSpec/</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
require(mclust)
data(metMUD1)
pca &lt;- c_pcaSpectra(metMUD1)
mclust3dSpectra(metMUD1, pca)

# show mis-classified points
mclust3dSpectra(metMUD1, pca, truth = metMUD1$groups)

## End(Not run)


</code></pre>


</div>