<div class="container">

<table style="width: 100%;"><tr>
<td>cprobit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Apply the three-step workflow for the analysis of two repeated outcomes from
each subject</h2>

<h3>Description</h3>

<p>Apply the three-step workflow for the analysis of two repeated outcomes from
each subject
</p>


<h3>Usage</h3>

<pre><code class="language-R">cprobit(
  formula,
  dat,
  index,
  transform = NULL,
  lambda = NA,
  resid_pval_threshold = 0.05
)

## S3 method for class 'cprobit'
summary(object, plot = FALSE, ...)

## S3 method for class 'cprobit'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>Formula for the model. Do not convert data type within the
formula (e.g., <code>factor(x)</code> is not supported in <code>formula</code>). See
<code>Details</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>A <code>data.frame</code> in the long format, with each row
corresponding to one measurement from one subject, and two columns
indicating the subject and case ID respecitively. Variable names must not
contain space or special characters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>
<p>Names of variables indicating subject and case ID. Case ID must
be coded as integers 1 and 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transform</code></td>
<td>
<p>Whether a Box-Cox transformation should be applied to the
outcome, taking value <code>NULL</code> (the default), <code>TRUE</code> or
<code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Value of the Box-Cox transformation parameter to use. Default
is <code>NA</code>, in which case it will be estimated from data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resid_pval_threshold</code></td>
<td>
<p>The threshold for the Lilliefors p-value of the
residuals to determine whether a Box-Cox transformation on the outcome is
necessary. Default is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>Model fitted using <code>cprobit</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>Wether residual qq-plots should be plotted. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments affecting the summary produced (not yet
implemented).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Model fitted using <code>cprobit</code> function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Specify the formula for the repeated measurements instead of the
change in the outcome, but without any time-invariant component that would
have been eliminated after taking the difference. Interaction between two
variables can be specified in the formula using <code>*</code> or <code>:</code>, but
users need to create their own variable for interaction involving three or
more variables.
</p>
<p>If <code>transform = NULL</code>, the workflow will determine the need for a
Box-Cox transforamtion on the outcome (i.e., Step 3) based on the residual
diagnostics in Step 2. A Box-Cox transforamtion will be used if the p-value
of the Lilliefors test is smaller than <code>resid_pval_threshold</code> (default
is 0.05). If <code>transform = TRUE</code>, analyses will always be performed on
both the observed and Box-Cox transformed outcomes. If <code>transform =
FALSE</code>, analysis will only be performed on the observed outcomes.
</p>


<h3>Value</h3>

<p>Returns a list.
</p>


<h3>References</h3>


<ul>
<li>
<p>GEP Box, DR Cox. An Analysis of Transformations. Journal of the Royal
Statistical Society. Series B (Methodological). 1964;26:211–52.
</p>
</li>
<li>
<p>DM Hawkins, S Weisberg. Combining the box-cox power and generalised
log transformations to accommodate nonpositive responses in linear and
mixed-effects linear models. South African Stat J. 2017;51:317–28.
</p>
</li>
<li>
<p>HW Lilliefors. On the Kolmogorov-Smirnov Test for Normality with Mean
and Variance Unknown. J Am Stat Assoc. 1967;62:399.
</p>
</li>
<li>
<p>Y Ning, NC Støer, PJ Ho, SL Kao, KY Ngiam, EYH Khoo, SC Lee, ES Tai, M
Hartman, M Reilly, CS Tan. Robust estimation of the effect of an exposure on
the change in a continuous outcome. BMC Medical Research Methodology
(in press).
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R"># Apply the three-step workflow to assess the association between the
# baseline glucose variability and the change in the glucose variability in
# the subsequent two days.
# Although age and gender are available, they do not need to be explicitly
# adjusted for in the cprobit model.
data(bg_variability)
head(bg_variability)
model &lt;- cprobit(formula = y ~ t + t:sd0, dat = bg_variability,
                 index = c("subject_id", "case_id"))
summary(model, plot = TRUE)
</code></pre>


</div>