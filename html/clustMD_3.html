<div class="container">

<table style="width: 100%;"><tr>
<td>clustMD</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Model Based Clustering for Mixed Data</h2>

<h3>Description</h3>

<p>A function that fits the clustMD model to a data set consisting of any
combination of continuous, binary, ordinal and nominal variables.
</p>


<h3>Usage</h3>

<pre><code class="language-R">clustMD(X, G, CnsIndx, OrdIndx, Nnorms, MaxIter, model, store.params = FALSE,
  scale = FALSE, startCL = "hc_mclust", autoStop = FALSE, ma.band = 50,
  stop.tol = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a data matrix where the variables are ordered so that the 
continuous variables come first, the binary (coded 1 and 2) and
ordinal variables (coded 1, 2, ...) come second and the nominal
variables (coded 1, 2, ...) are in last position.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>
<p>the number of mixture components to be fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CnsIndx</code></td>
<td>
<p>the number of continuous variables in the data set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>OrdIndx</code></td>
<td>
<p>the sum of the number of continuous, binary and ordinal
variables in the data set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nnorms</code></td>
<td>
<p>the number of Monte Carlo samples to be used for the 
intractable E-step in the presence of nominal data. Irrelevant if
there are no nominal variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MaxIter</code></td>
<td>
<p>the maximum number of iterations for which the (MC)EM 
algorithm should run.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a string indicating which clustMD model is to be fitted. This
may be one of: <code>EII, VII, EEI, VEI, EVI, VVI</code> or <code>BD</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>store.params</code></td>
<td>
<p>a logical argument indicating if the parameter estimates
at each iteration should be saved and returned by the clustMD function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>a logical argument indicating if the continuous variables
should be standardised.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>startCL</code></td>
<td>
<p>a string indicating which clustering method should be used to
initialise the (MC)EM algorithm. This may be one of "kmeans" (K means
clustering), "hclust" (hierarchical clustering), "mclust" (finite 
mixture of Gaussian distributions), "hc_mclust" (model-based 
hierarchical clustering) or "random" (random cluster allocation).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>autoStop</code></td>
<td>
<p>a logical argument indicating whether the (MC)EM algorithm
should use a stopping criterion to decide if convergence has been 
reached. Otherwise the algorithm will run for <code>MaxIter</code> iterations. 
</p>
<p>If only continuous variables are present the algorithm will use Aitken's
acceleration criterion with tolerance <code>stop.tol</code>.
</p>
<p>If categorical variables are present, the stopping criterion is based
on a moving average of the approximated log likelihood values. Let 
<code>t</code> denote the current interation. The average of the 
<code>ma.band</code> most recent approximated log likelihood values is 
compared to the average of another <code>ma.band</code> iterations with a lag
of 10 iterations. If this difference is less than the tolerance the
algorithm will be said to have converged.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ma.band</code></td>
<td>
<p>the number of iterations to be included in the moving average
calculation for the stopping criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stop.tol</code></td>
<td>
<p>the tolerance of the (MC)EM stopping criterion.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class clustMD is returned. The output components are as
follows:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>model </code></td>
<td>
<p>The covariance model fitted to the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G </code></td>
<td>
<p>The number of clusters fitted to the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y </code></td>
<td>
<p>The observed data matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl </code></td>
<td>
<p>The cluster to which each observation belongs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau </code></td>
<td>
<p>A <code>N x G</code> matrix of the probabilities of 
each observation blonging to each cluster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>means </code></td>
<td>
<p>A <code>D x G</code> matrix of the cluster means. Where D is the 
dimension of the combined observed and latent continuous space.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A </code></td>
<td>
<p>A <code>G x D</code> matrix containing the diagonal entries of the 
<code>A</code> matrix corresponding to each cluster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lambda </code></td>
<td>
<p>A <code>G x D</code> matrix of volume parameters corresponding
to each observed or latent dimension for each cluster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma </code></td>
<td>
<p>A <code>D x D x G</code> array of the covariance matrices for 
each cluster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BIChat </code></td>
<td>
<p>The estimated Bayesian information criterion for the 
model fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ICLhat </code></td>
<td>
<p>The estimated integrated classification likelihood criterion
for the model fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>paramlist </code></td>
<td>
<p>If store.params is <code>TRUE</code> then paramlist is a 
list of the stored parameter values in the order given above with 
the saved estimated likelihood values in last position.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Varnames </code></td>
<td>
<p>A character vector of names corresponding to the 
columns of <code>Y</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Varnames_sht </code></td>
<td>
<p>A truncated version of <code>Varnames</code>. Used for
plotting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>likelihood.store </code></td>
<td>
<p>A vector containing the estimated log 
likelihood at each iteration.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>McParland, D. and Gormley, I.C. (2016). Model based clustering
for mixed data: clustMD. Advances in Data Analysis and Classification,
10 (2):155-169.
</p>


<h3>Examples</h3>

<pre><code class="language-R">	data(Byar)
    # Transformation skewed variables
    Byar$Size.of.primary.tumour &lt;- sqrt(Byar$Size.of.primary.tumour)
    Byar$Serum.prostatic.acid.phosphatase &lt;- log(Byar$Serum.prostatic.acid.phosphatase)

    # Order variables (Continuous, ordinal, nominal)
    Y &lt;- as.matrix(Byar[, c(1, 2, 5, 6, 8, 9, 10, 11, 3, 4, 12, 7)])

    # Start categorical variables at 1 rather than 0
    Y[, 9:12] &lt;- Y[, 9:12] + 1

    # Standardise continuous variables
    Y[, 1:8] &lt;- scale(Y[, 1:8])

    # Merge categories of EKG variable for efficiency
    Yekg &lt;- rep(NA, nrow(Y))
    Yekg[Y[,12]==1] &lt;- 1
    Yekg[(Y[,12]==2)|(Y[,12]==3)|(Y[,12]==4)] &lt;- 2
    Yekg[(Y[,12]==5)|(Y[,12]==6)|(Y[,12]==7)] &lt;- 3
    Y[, 12] &lt;- Yekg

    ## Not run: 
    res &lt;- clustMD(X = Y, G = 3, CnsIndx = 8, OrdIndx = 11, Nnorms = 20000,
    MaxIter = 500, model = "EVI", store.params = FALSE, scale = TRUE, 
    startCL = "kmeans", autoStop= TRUE, ma.band=30, stop.tol=0.0001)
    
## End(Not run)
</code></pre>


</div>