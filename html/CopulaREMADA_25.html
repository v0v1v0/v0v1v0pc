<div class="container">

<table style="width: 100%;"><tr>
<td>FactorCopulaREMADA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Maximum likelihood estimation  of 1-factor copula mixed models for joint meta-analysis of <code class="reqn">T</code> diagnostic tests
</h2>

<h3>Description</h3>

<p>The estimated parameters can be obtained by 
using a quasi-Newton method applied to the logarithm of the joint likelihood.  
This numerical  method requires only the objective
function, i.e.,  the logarithm of the joint likelihood, while the gradients
are computed numerically and the Hessian matrix of the second
order derivatives is updated in each iteration. The standard errors (SE) of the ML estimates can be also obtained via the gradients and the Hessian computed numerically during the maximization process.
</p>


<h3>Usage</h3>

<pre><code class="language-R">FactorCopulaREMADA.norm(TP,FN,FP,TN,gl,mgrid,qcond1,tau2par1,qcond2,tau2par2)
                               
FactorCopulaREMADA.beta(TP,FN,FP,TN,gl,mgrid,qcond1,tau2par1,qcond2,tau2par2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>TP</code></td>
<td>
<p>an <code class="reqn">n\times T</code> matrix where <code class="reqn">n</code> is the number of studies. Column <code class="reqn">j</code> has  the number of true positives for test <code class="reqn">j</code> for <code class="reqn">j=1\ldots T</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FN</code></td>
<td>
<p>an <code class="reqn">n\times T</code> matrix where <code class="reqn">n</code> is the number of studies. Column <code class="reqn">j</code> has the number of false negatives Column <code class="reqn">j</code> has  the number of true positives for test <code class="reqn">j</code> for <code class="reqn">j=1\ldots T</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FP</code></td>
<td>
<p>an <code class="reqn">n\times T</code> matrix where <code class="reqn">n</code> is the number of studies. Column <code class="reqn">j</code> has the number of false positives Column <code class="reqn">j</code> has  the number of true positives for test <code class="reqn">j</code> for <code class="reqn">j=1\ldots T</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TN</code></td>
<td>
<p>an <code class="reqn">n\times T</code> matrix where <code class="reqn">n</code> is the number of studies. Column <code class="reqn">j</code> has the number of true negatives Column <code class="reqn">j</code> has  the number of true positives for test <code class="reqn">j</code> for <code class="reqn">j=1\ldots T</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gl</code></td>
<td>
<p>a list containing the components of Gauss-Legendre nodes <code>gl$nodes</code> and weights <code>gl$weights</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mgrid</code></td>
<td>

<p>a list containing two matrices with the rows of the output matrix x are copies of the vector <code>gl$nodes</code>; columns of the output matrix y are copies of the vector <code>gl$nodes</code>. For more details see also <code>meshgrid</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qcond1</code></td>
<td>
<p>function for the inverse conditional copula cdfs that link the factor with the latent sensitivities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau2par1</code></td>
<td>
<p>function for maping Kendall's tau  to copula parameter at the copulas that link the factor with the latent sensitivities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qcond2</code></td>
<td>
<p>function for the inverse conditional copula cdfs that link the factor with the latent specificities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau2par2</code></td>
<td>
<p>function for maping Kendall's tau  to copula parameter at the copulas that link the factor with the latent specificities</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>minimum</code></td>
<td>
<p>the value of the estimated minimum of the negative log-likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>the MLE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gradient</code></td>
<td>
<p>the gradient at the estimated minimum of of the negative log-likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hessian</code></td>
<td>
<p>the hessian at the estimated minimum of the negative log-likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>code</code></td>
<td>
<p>an integer indicating why the optimization process terminated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterations</code></td>
<td>
<p>the number of iterations performed</p>
</td>
</tr>
</table>
<p>For more details see  <code>nlm</code>
</p>


<h3>References</h3>

<p>Nikoloulopoulos, A.K. (2022) An one-factor copula mixed model for joint meta-analysis of multiple diagnostic tests. <em>Journal of the Royal Statistical Society: Series A (Statistics in Society)</em>,  185 (3), 1398â€“1423. <a href="https://doi.org/10.1111/rssa.12838">doi:10.1111/rssa.12838</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(arthritis)
attach(arthritis)
TP=cbind(TP1,TP2)
TN=cbind(TN1,TN2)
FP=cbind(FP1,FP2)
FN=cbind(FN1,FN2)


nq=25
gl=gauss.quad.prob(nq,"uniform")
mgrid=meshgrid(gl$n,gl$n)
qcond1=qcondcln
qcond2=qcondcln270
tau2par1=tau2par.cln
tau2par2=tau2par.cln270

out=FactorCopulaREMADA.norm(TP,FN,FP,TN,gl,mgrid,qcond1,tau2par1,qcond2,tau2par2)
se=sqrt(diag(solve(out$hessian)))

detach(arthritis)
</code></pre>


</div>