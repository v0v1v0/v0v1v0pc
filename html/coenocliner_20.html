<div class="container">

<table style="width: 100%;"><tr>
<td>simJamil</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate species abundance data following Jamil &amp; ter Braak
(2013)</h2>

<h3>Description</h3>

<p>Simulate species probability of occurrence data according
to the method used by Tahira Jamil and Cajo ter Braak in their recent
paper <em>Generalized linear mixed models can detect unimodal
species-environment relationships</em>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simJamil(
  n,
  m,
  x,
  gl = 4,
  randx = TRUE,
  tol = 0.5,
  tau = gl/2,
  randm = TRUE,
  expectation = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>numeric; the number of samples/sites.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>numeric, the number of species/variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>numeric; values for the environmental gradient. Can be
missing, in which case suitable values are generated. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gl</code></td>
<td>
<p>numeric; gradient length in arbitrary units. The default
is 4 units with gradient values ranging from -2 to 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>randx</code></td>
<td>
<p>logical; should locations along the gradient (<code>x</code>)
be located randomly or equally-spaced?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>numeric; the species tolerances. Can be a vector of
length <code>m</code>, hence allowing for varying tolerances along the
gradient <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>numeric; constant that ensures some of the optima are
located beyond the observed gradient end points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>randm</code></td>
<td>
<p>logical; should species optima along the gradient be
located randomly or equally-spaced?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expectation</code></td>
<td>
<p>logical; if <code>TRUE</code> the binomial probabilities
<code class="reqn">p_{ij}</code> from the response curve are returned directly. If
<code>FALSE</code>, the default, random draws from a Bernoulli distribution
with probability <code class="reqn">p_{ij}</code> are made.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a matrix of <code>n</code> rows and <code>m</code> columns containing the
simulated species abundance data.
</p>


<h3>Author(s)</h3>

<p>Gavin L. Simpson
</p>


<h3>References</h3>

<p>Jamil and ter Braak (2013) Generalized linear mixed models can detect unimodal species-environment relationships. <em>PeerJ</em> <strong>1:e95</strong>; DOI doi: <a href="https://doi.org/10.7717/peerj.95">10.7717/peerj.95</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(42)
N &lt;- 100   # Number of locations on gradient (samples)
glen &lt;- 4  # Gradient length
grad &lt;- sort(runif(N, -glen/2, glen/2)) # sample locations
M &lt;- 10    # Number of species
sim &lt;- simJamil(n = N, m = M, x = grad, gl = glen, randx = FALSE,
                randm = FALSE, expectation = TRUE)
## visualise the response curves
matplot(grad, sim, type = "l", lty = "solid")

## simulate binomial responses from those response curves
sim &lt;- simJamil(n = N, m = M, x = grad, gl = glen, randx = FALSE,
                randm = FALSE)

</code></pre>


</div>