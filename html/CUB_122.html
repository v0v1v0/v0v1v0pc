<div class="container">

<table style="width: 100%;"><tr>
<td>varmatCUBE</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Variance-covariance matrix for CUBE models</h2>

<h3>Description</h3>

<p>Compute the variance-covariance matrix of parameter estimates for CUBE models when no covariate
is specified, or when covariates are included for all the three parameters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">varmatCUBE(ordinal,m,param,Y=0,W=0,Z=0,expinform=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ordinal</code></td>
<td>
<p>Vector of ordinal responses</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>Number of ordinal categories</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>Vector of parameters for the specified CUBE model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Matrix of selected covariates to explain the uncertainty component (default: no covariate is included
in the model)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p>Matrix of selected covariates to explain the feeling component (default: no covariate is included
in the model)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>Matrix of selected covariates to explain the overdispersion component (default: no covariate is included
in the model)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expinform</code></td>
<td>
<p>Logical: if TRUE  and no covariate is included in the model, the function returns
the expected variance-covariance matrix (default is FALSE: the function returns the observed
variance-covariance matrix)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function checks if the variance-covariance matrix is positive-definite: if not,
it returns a warning message and produces a matrix with NA entries.  No missing value should be present neither
for <code>ordinal</code> nor for covariate matrices: thus, deletion or imputation procedures should be preliminarily run.
</p>


<h3>References</h3>

<p>Iannario, M. (2014). Modelling Uncertainty and Overdispersion in Ordinal Data,
<em>Communications in Statistics - Theory and Methods</em>, <b>43</b>, 771–786 <br>
Piccolo D. (2015). Inferential issues for CUBE models with covariates,
<em>Communications in Statistics. Theory and Methods</em>, <b>44</b>(23), 771–786. <br></p>


<h3>See Also</h3>

<p><code>vcov</code>, <code>cormat</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">m&lt;-7; n&lt;-500
pai&lt;-0.83; csi&lt;-0.19; phi&lt;-0.045
ordinal&lt;-simcube(n,m,pai,csi,phi)
param&lt;-c(pai,csi,phi)
varmat&lt;-varmatCUBE(ordinal,m,param)
##########################
### Including covariates
data(relgoods)
m&lt;-10
naord&lt;-which(is.na(relgoods$Tv))
nacov&lt;-which(is.na(relgoods$BirthYear))
na&lt;-union(naord,nacov)
age&lt;-2014-relgoods$BirthYear[-na]
lage&lt;-log(age)-mean(log(age))
Y&lt;-W&lt;-Z&lt;-lage
ordinal&lt;-relgoods$Tv[-na]
estbet&lt;-c(0.18,1.03); estgama&lt;-c(-0.6,-0.3); estalpha&lt;-c(-2.3,0.92)
param&lt;-c(estbet,estgama,estalpha)
varmat&lt;-varmatCUBE(ordinal,m,param,Y=Y,W=W,Z=Z,expinform=TRUE)
</code></pre>


</div>