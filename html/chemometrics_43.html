<div class="container">

<table style="width: 100%;"><tr>
<td>prm_cv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cross-validation for robust PLS</h2>

<h3>Description</h3>

<p>Cross-validation (CV) is carried out with robust PLS based on partial robust 
M-regression. A plot with the choice for the optimal number of components is 
generated.
This only works for univariate y-data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">prm_cv(X, y, a, fairct = 4, opt = "median", subset = NULL, segments = 10, 
segment.type = "random", trim = 0.2, sdfact = 2, plot.opt = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>predictor matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>response variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>number of PLS components</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fairct</code></td>
<td>
<p>tuning constant, by default fairct=4</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opt</code></td>
<td>
<p>if "l1m" the mean centering is done by the l1-median,
otherwise by the coordinate-wise median</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>optional vector defining a subset of objects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>segments</code></td>
<td>
<p>the number of segments to use or a list with segments (see 
<code>mvrCv</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>segment.type</code></td>
<td>
<p>the type of segments to use.  Ignored if 'segments' is a list</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trim</code></td>
<td>
<p>trimming percentage for the computation of the SEP</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdfact</code></td>
<td>
<p>factor for the multiplication of the standard deviation for
the determination of the optimal number of components, see 
<code>mvr_dcv</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.opt</code></td>
<td>
<p>if TRUE a plot will be generated that shows the selection of the
optimal number of components for each step of the CV, see 
<code>mvr_dcv</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A function for robust PLS based on partial robust M-regression is available at 
<code>prm</code>. The optimal number of robust PLS components is chosen according 
to the following criterion: Within the CV scheme, the mean of the trimmed SEPs 
SEPtrimave is computed for each number of components, as well as their standard 
errors SEPtrimse. Then one searches for the minimum of the SEPtrimave values and 
adds sdfact*SEPtrimse. The optimal number of components is the most parsimonious 
model that is below this bound.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>predicted</code></td>
<td>
<p>matrix with length(y) rows and a columns with predicted values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SEPall</code></td>
<td>
<p>vector of length a with SEP values for each number of components</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SEPtrim</code></td>
<td>
<p>vector of length a with trimmed SEP values for each number of 
components</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SEPj</code></td>
<td>
<p>matrix with segments rows and a columns with SEP values within the CV 
for each number of components</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SEPtrimj</code></td>
<td>
<p>matrix with segments rows and a columns with trimmed SEP values 
within the CV for each number of components</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optcomp</code></td>
<td>
<p>final optimal number of PLS components</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SEPopt</code></td>
<td>
<p>trimmed SEP value for final optimal number of PLS components</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Peter Filzmoser &lt;P.Filzmoser@tuwien.ac.at&gt; </p>


<h3>References</h3>

<p> K. Varmuza and P. Filzmoser: Introduction to Multivariate Statistical 
Analysis in Chemometrics. CRC Press, Boca Raton, FL, 2009. </p>


<h3>See Also</h3>

<p><code>prm</code></p>


<h3>Examples</h3>

<pre><code class="language-R">data(cereal)
set.seed(123)
res &lt;- prm_cv(cereal$X,cereal$Y[,1],a=5,segments=4,plot.opt=TRUE)
</code></pre>


</div>