<div class="container">

<table style="width: 100%;"><tr>
<td>mc.est.CMData</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Distribution of the number of responses assuming marginal compatibility.</h2>

<h3>Description</h3>

<p>The <code>mc.est</code> function estimates the distribution of the number of
responses in a cluster under the assumption of marginal compatibility:
information from all cluster sizes is pooled. The estimation is performed
independently for each treatment group.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'CMData'
mc.est(object, eps = 1e-06, ...)

## S3 method for class 'CBData'
mc.est(object, ...)

mc.est(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>a <code>CBData</code> or <code>CMData</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>numeric; EM iterations proceed until the sum of squared changes fall below <code>eps</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other potential arguments; not currently used</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The EM algorithm given by Stefanescu and Turnbull (2003) is used for the binary data.
</p>


<h3>Value</h3>

<p>For <code>CMData</code>: A data frame giving the estimated pdf for each treatment and
clustersize.  The probabilities add up to 1
for each <code>Trt</code>/<code>ClusterSize</code> combination. It has the following columns:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Prob</code></td>
<td>
<p>numeric, the probability of <code>NResp</code> responses in a
cluster of size <code>ClusterSize</code> in group <code>Trt</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Trt</code></td>
<td>
<p>factor, the treatment group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ClusterSize</code></td>
<td>
<p>numeric, the cluster size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NResp.1 - NResp.K</code></td>
<td>
<p>numeric, the number of responses of each type</p>
</td>
</tr>
</table>
<p>For <code>CBData</code>: A data frame giving the estimated pdf for each treatment and
clustersize.  The probabilities add up to 1
for each <code>Trt</code>/<code>ClusterSize</code> combination. It has the following columns:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Prob</code></td>
<td>
<p>numeric, the probability of <code>NResp</code> responses in a
cluster of size <code>ClusterSize</code> in group <code>Trt</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Trt</code></td>
<td>
<p>factor, the treatment group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ClusterSize</code></td>
<td>
<p>numeric, the cluster size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NResp</code></td>
<td>
<p>numeric, the number of responses</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>For multinomial data, the implementation is currently written in R, so it is not very fast.
</p>


<h3>Author(s)</h3>

<p>Aniko Szabo
</p>


<h3>References</h3>

<p>George EO, Cheon K, Yuan Y, Szabo A (2016)  On Exchangeable Multinomial Distributions. #'<em>Biometrika</em> 103(2), 397-408.
</p>
<p>Stefanescu, C. &amp; Turnbull, B. W. (2003) Likelihood inference for
exchangeable binary data with varying cluster sizes.  <em>Biometrics</em>, 59,
18-24
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(dehp)
dehp.mc &lt;- mc.est(subset(dehp, Trt=="0"))
subset(dehp.mc, ClusterSize==2)

data(shelltox)
sh.mc &lt;- mc.est(shelltox)

if (require(lattice)){
xyplot(Prob~NResp|factor(ClusterSize), groups=Trt, data=sh.mc, subset=ClusterSize&gt;0, 
   type="l", as.table=TRUE, auto.key=list(columns=4, lines=TRUE, points=FALSE),
   xlab="Number of responses", ylab="Probability P(R=r|N=n)")
}
</code></pre>


</div>