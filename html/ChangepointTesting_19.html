<div class="container">

<table style="width: 100%;"><tr>
<td>changePoint</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Change Point Estimation for Clustered Signals </h2>

<h3>Description</h3>

<p> A multiple testing procedure for clustered alternative 
hypotheses. It is assumed that the p-values under the 
null hypotheses follow U(0,1) and that the distributions
of p-values from the alternative hypotheses are
stochastically smaller than U(0,1).
By aggregating information, this method is more
sensitive to detecting signals of low magnitude than
standard methods. Additionally,
sporadic small p-values appearing within a
null hypotheses sequence are avoided 
by averaging on the neighboring p-values. </p>


<h3>Usage</h3>

<pre><code class="language-R">changePoint(pvalues, alpha, km, lm, compare = "BOTH", fdrlWindow = 3, 
fdrlNStep = 300, fdrlLambda = 0.1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pvalues   </code></td>
<td>
<p>an object of class numeric.
A vector of p-values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha     </code></td>
<td>
<p>an object of class numeric. The significant level for
the estimation of the critical value, gamma*.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>km        </code></td>
<td>
<p>an object of class numeric. The size of the window 
defining the neighborhood in left and right distances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lm        </code></td>
<td>
<p>an object of class numeric. The size of the 
window defining the 
neighborhood in the long-run variance estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>compare   </code></td>
<td>
<p>one of ("FDRL", "BH", "Both", "None"). 
In addition to the Cao-Wu method, 
obtain significance indicators using
the FDR_L method (FDRL) 
(Zhang et al., 2011),
the Benjamini-Hochberg method (BH), 
(Benjamini andHochberg, 1995),
"both" the FDRL and the BH methods, or 
do not consider alternative methods (none).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fdrlWindow</code></td>
<td>
<p>an object of class numeric.
If FDR_L method requested, the size of the window 
defining the neighborhood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fdrlNStep </code></td>
<td>
<p>an object of class numeric.
If FDR_L method requested, the number of threshold
values to consider.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fdrlLambda</code></td>
<td>
<p>and object of class numeric.
If FDR_L method requested, the tuning constant.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The comparison capability is included only for convenience and 
reproducibility 
of the original manuscript. The Benjamini-Hochberg and FDR_L
methods cannot be accessed outside of the changePoint function.
</p>
<p>The following methods retrieve individual results from a changePoint
object, x: 
</p>
<p><code>BH(x)</code>: 
Retrieves a vector of integer values. 
An element is 1 if the null hypothesis is rejected
by the Benjamini-Hochberg (1995) method.
</p>
<p><code>blocks(x)</code>: 
Retrieves a list, each element of which is 
a vector of integer values. 
Each vector contains the indices of 
an alternative hypothesis block.
</p>
<p><code>CW(x)</code>: 
Retrieves a vector of integer values. 
An element is 1 if the null hypothesis is rejected 
by the Cao-Wu change point (2015) method.
</p>
<p><code>changePts(x)</code>:
Retrieves a vector of integer values.
The vector of change points identified by the
Cao-Wu (2015) method. If no change points are
identified, NULL is returned.
</p>
<p><code>FDRL(x)</code>:  
Retrieves a vector of integer values. 
Elements are 1 if the null hypothesis is rejected 
by the FDR_L (Zhang et al. 2011) method. 
</p>
<p><code>critical(x)</code>: Retrieves the
estimated critical value for testing used by
the Cao-Wu (2015) method.
</p>
<p><code>numAlt(x)</code>: Retrieves the
estimated number of alternative hypotheses
obtained by the Cao-Wu (2015) method. 
</p>
<p><code>piAlt(x)</code>: Retrieves the
estimated proportion of alternative hypotheses
obtained by the Cao-Wu (2015) method. 
</p>
<p><code>plot(x, y, logp, ...)</code>: Generates plots
of -log(p) vs position or p-value vs position for
each alternative hypothesis block obtained
by the Cao-Wu (2015) method. logp is TRUE/FALSE
indicating if -log(p)/p-values are plotted on the y-axis.
</p>
<p><code>sigmaSq(x)</code>: Retrieves the
estimated variance used to determine the critical value of
the Cao-Wu (2015) method.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>changePoint</code>.
</p>


<h3>Author(s)</h3>

<p>Hongyuan Cao, Wei Biao Wu, and Shannon T.  Holloway
Maintainer: Shannon T. Holloway &lt;shannon.t.holloway@gmail.com&gt;
</p>


<h3>References</h3>

<p>Benjamini, Y. and Hochberg, Y. (1995).
Controlling the false discovery rate: A practical and powerful approach to 
multiple testing.
Journal of the Royal Statistical Society: Series B, 57, 289–300.
</p>
<p>Cao, H. and Wu, W. B. (2015)
Changepoint estimation: Another look at multiple testing problems.
Biometrika, 102, 974–980.
</p>
<p>Zhang, C., Fan, J., and Yu, T. (2011).
Multiple testing via FDRL for large-scale imaging data.
Anals of Statistics, 39, 613–642.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
m &lt;- 5000

T &lt;- c(rep(0.1,  75), rep( 0.8, 75), rep(1.8, 100), 
       rep(0.0,2250), rep(-1.5,250), rep(0.0,2250)) + 
     rnorm(m, mean=0.0, sd = 1.0)

pv &lt;- 2.0*(1.0-pnorm(abs(T)))

res &lt;- changePoint(pvalues = pv, 
                   alpha = 0.05, 
                   km = {log(m)}^2, 
                   lm = m^{1/4}, 
                   compare = "Both")

print(changePts(res))

print(head(cbind(BH(res),FDRL(res),CW(res))))

</code></pre>


</div>