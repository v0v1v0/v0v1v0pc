<div class="container">

<table style="width: 100%;"><tr>
<td>ggbplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Create a biplot with ggplot2
</h2>

<h3>Description</h3>

<p>Function <code>ggbiplot</code> creates a biplot of a matrix with ggplot2 graphics.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ggbplot(A, B, main = "", circle = TRUE, xlab = "", ylab = "", main.size = 8,
xlim = c(-1, 1), ylim = c(-1, 1), rowcolor = "red", rowch = 1, colcolor = "blue",
colch = 1, rowarrow = FALSE, colarrow = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>A dataframe with coordinates and names for the biplot row markers</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>A dataframe with coordinates and names for the biplot column markers</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>A title for the biplot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>circle</code></td>
<td>
<p>Draw a unit circle (<code>circle=TRUE</code>) or not (<code>circle=FALSE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>The label for the x axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>The label for the y axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main.size</code></td>
<td>
<p>Size of the main title</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>Limits for the horizontal axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>Limits for the vertical axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rowcolor</code></td>
<td>
<p>Color used for the row markers</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rowch</code></td>
<td>
<p>Symbol used for the row markers</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colcolor</code></td>
<td>
<p>Color used for the column markers</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colch</code></td>
<td>
<p>Symbol used for the column markers</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rowarrow</code></td>
<td>
<p>Draw arrows from the origin to the row markers (<code>rowarrow=TRUE</code>) or not</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colarrow</code></td>
<td>
<p>Draw arrows from the origin to the column markers (<code>colarrow=TRUE</code>) or not</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Dataframes <code>A</code> and <code>B</code> must consists of three columns labeled "PA1", "PA2" (coordinates of the first and second principal axis) and a column "strings" with the labels for the coordinates.
</p>
<p>Dataframe <code>B</code> is optional. If it is not specified, a biplot with a single set of markers is constructed, for which the row settings must be specified.</p>


<h3>Value</h3>

<p>A ggplot2 object</p>


<h3>Author(s)</h3>

<p> Jan Graffelman (jan.graffelman@upc.edu) </p>


<h3>References</h3>

<p>Graffelman, J. and De Leeuw, J. (2023) On the visualisation of the correlation matrix. Available online. <a href="https://doi.org/10.48550/arXiv.2211.13150">doi:10.48550/arXiv.2211.13150</a></p>


<h3>See Also</h3>

<p><code>bplot</code>,<code>ggtally</code>,<code>biplot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("HeartAttack")
X &lt;- as.matrix(HeartAttack[,1:7])
n &lt;- nrow(X)
Xt &lt;- scale(X)/sqrt(n-1)
res.svd &lt;- svd(Xt)
Fs &lt;- sqrt(n)*res.svd$u # standardized principal components
Gp &lt;- crossprod(t(res.svd$v),diag(res.svd$d)) # biplot coordinates for variables
rows.df &lt;- data.frame(Fs[,1:2],as.character(1:n))
colnames(rows.df) &lt;- c("PA1","PA2","strings")
cols.df &lt;- data.frame(Gp[,1:2],colnames(X))
colnames(cols.df) &lt;- c("PA1","PA2","strings")
ggbplot(rows.df,cols.df,xlab="PA1",ylab="PA2",main="PCA")
</code></pre>


</div>