<div class="container">

<table style="width: 100%;"><tr>
<td>cIRT</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generic Implementation of Choice IRT MCMC</h2>

<h3>Description</h3>

<p>Builds a model using MCMC
</p>


<h3>Usage</h3>

<pre><code class="language-R">cIRT(
  subject_ids,
  fixed_effects,
  B_elem_plus1,
  rv_effects,
  trial_matrix,
  choices_nk,
  burnit,
  chain_length = 10000L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>subject_ids</code></td>
<td>
<p>A <code>vector</code> that contains subject IDs for each line of
data in the choice vector (e.g. For 1 subject that
made 5 choices, we would have the number 1 appear
five times consecutively.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed_effects</code></td>
<td>
<p>A <code>matrix</code> with NK x P1 dimensions that acts as the
design matrix for terms WITHOUT theta.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B_elem_plus1</code></td>
<td>
<p>A <code>V[[1]]</code> dimensional column <code>vector</code> indicating
which zeta_i relate to theta_i.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rv_effects</code></td>
<td>
<p>A <code>matrix</code> with NK x V dimensions for random effects
design matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trial_matrix</code></td>
<td>
<p>A <code>matrix</code> with N x J dimensions, where J denotes the
number of items presented. The matrix MUST contain
only 1's and 0's.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>choices_nk</code></td>
<td>
<p>A <code>vector</code> with NK length that contains the choice
value e.g. 0 or 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnit</code></td>
<td>
<p>An <code>int</code> that describes how many MCMC draws should be
discarded.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chain_length</code></td>
<td>
<p>An <code>int</code> that controls how many MCMC draws there are.
(&gt; 0)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>list</code> that contains:
</p>

<dl>
<dt><code>as</code></dt>
<dd>
<p>A <code>matrix</code> of dimension chain_length x J</p>
</dd>
<dt><code>bs</code></dt>
<dd>
<p>A <code>matrix</code> of dimension chain_length x J</p>
</dd>
<dt><code>gs</code></dt>
<dd>
<p>A <code>matrix</code> of dimension chain_length x P_1</p>
</dd>
<dt><code>Sigma_zeta_inv</code></dt>
<dd>
<p>An <code>array</code> of dimension V x V x chain_length</p>
</dd>
<dt><code>betas</code></dt>
<dd>
<p>A <code>matrix</code> of dimension chain_length x P_2</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Steven Andrew Culpepper and James Joseph Balamuta
</p>


<h3>See Also</h3>

<p><code>TwoPLChoicemcmc()</code>, <code>probitHLM()</code>, <code>center_matrix()</code>,
<code>rmvnorm()</code>, <code>rwishart()</code>, and <code>riwishart()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Variables
# Y = trial matix
# C = KN vector of binary choices
# N = #of subjects
# J = # of items
# K= # of choices
# atrue = true item discriminations
# btrue = true item locations
# thetatrue = true thetas/latent performance
# gamma = fixed effects coefficients
# Sig = random-effects variance-covariance
# subid = id variable for subjects

# Load the Package
library(cIRT)

# Load the Data
data(trial_matrix)
data(choice_matrix)

# Thurstone design matrices
all_nopractice = subset(all_data_trials, experiment_loop.thisN &gt; -1)
hard_items = choice_matrix$hard_q_id
easy_items = choice_matrix$easy_q_id

D_easy = model.matrix( ~ -1 + factor(easy_items))
D_hard = -1 * model.matrix( ~ -1 + factor(hard_items))[, -c(5, 10, 15)]

# Defining effect-coded contrasts
high_contrasts = rbind(-1, diag(4))
rownames(high_contrasts) = 12:16
low_contrasts = rbind(-1, diag(2))
rownames(low_contrasts) = 4:6

# Creating high &amp; low factors
high = factor(choice_matrix[, 'high_value'])
low = factor(choice_matrix[, 'low_value'])
contrasts(high) = high_contrasts
contrasts(low) = low_contrasts

fixed_effects = model.matrix( ~ high + low)
fixed_effects_base = fixed_effects[, 1]
fixed_effects_int = model.matrix( ~ high * low)


# Model with Thurstone D Matrix
system.time({
 out_model_thurstone = cIRT(
   choice_matrix[, 'subject_id'],
   cbind(fixed_effects[, -1], D_easy, D_hard),
   c(1:ncol(fixed_effects)),
   as.matrix(fixed_effects),
   as.matrix(trial_matrix),
   choice_matrix[, 'choose_hard_q'],
   20000,
   25000
 )
})


vlabels_thurstone = colnames(cbind(fixed_effects[, -1], D_easy, D_hard))
G_thurstone = t(apply(
 out_model_thurstone$gs0,
 2,
 FUN = quantile,
 probs = c(.5, .025, .975)
))

rownames(G_thurstone) = vlabels_thurstone
B_thurstone = t(apply(
 out_model_thurstone$beta,
 2,
 FUN = quantile,
 probs = c(.5, 0.025, .975)
))

rownames(B_thurstone) = colnames(fixed_effects)

S_thurstone = solve(
  apply(out_model_thurstone$Sigma_zeta_inv, c(1, 2), FUN = mean)
)

inv_sd = diag(1 / sqrt(diag(solve(
 apply(out_model_thurstone$Sigma_zeta_inv, c(1, 2),
       FUN = mean)
))))

inv_sd %*% S_thurstone %*% inv_sd
apply(out_model_thurstone$as, 2, FUN = mean)
apply(out_model_thurstone$bs, 2, FUN = mean)

## End(Not run)
</code></pre>


</div>