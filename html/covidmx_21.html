<div class="container">

<table style="width: 100%;"><tr>
<td>positividad</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Positividad</h2>

<h3>Description</h3>

<p><code>positividad</code> Calcula la positividad  por fecha agrupando (o sin hacerlo)
por covariables. Por default calcula la positividad de las pruebas
haciendo Antigeno y PCR por separado, cada una por fecha y entidad.
</p>


<h3>Usage</h3>

<pre><code class="language-R">positividad(
  datos_covid,
  entidades = c("AGUASCALIENTES", "BAJA CALIFORNIA", "BAJA CALIFORNIA SUR", "CAMPECHE",
    "CHIAPAS", "CHIHUAHUA", "CIUDAD DE MÉXICO", "COAHUILA DE ZARAGOZA", "COLIMA",
    "DURANGO", "GUANAJUATO", "GUERRERO", "HIDALGO", "JALISCO", "MÉXICO",
    "MICHOACÁN DE OCAMPO", "MORELOS", "NAYARIT", "NUEVO LEÓN", "OAXACA", "PUEBLA",
    "QUERÉTARO", "QUINTANA ROO", "SAN LUIS POTOSÍ", "SINALOA", "SONORA", "TABASCO",
    "TAMAULIPAS", "TLAXCALA", "VERACRUZ DE IGNACIO DE LA LLAVE", "YUCATÁN", "ZACATECAS"),
  group_by_entidad = TRUE,
  entidad_tipo = c("Unidad Medica", "Residencia", "Nacimiento"),
  fecha_tipo = c("Sintomas", "Ingreso", "Defuncion"),
  tipo_prueba = c("Antigeno", "PCR"),
  group_by_tipo_prueba = TRUE,
  tipo_paciente = c("AMBULATORIO", "HOSPITALIZADO", "NO ESPECIFICADO"),
  group_by_tipo_paciente = FALSE,
  tipo_uci = c("SI", "NO", "NO APLICA", "SE IGNORA", "NO ESPECIFICADO"),
  group_by_tipo_uci = FALSE,
  tipo_sector = c("CRUZ ROJA", "DIF", "ESTATAL", "IMSS", "IMSS-BIENESTAR", "ISSSTE",
    "MUNICIPAL", "PEMEX", "PRIVADA", "SEDENA", "SEMAR", "SSA", "UNIVERSITARIO",
    "NO ESPECIFICADO"),
  group_by_tipo_sector = FALSE,
  defunciones = FALSE,
  edad_cut = NULL,
  fill_NA = TRUE,
  list_name = "positividad",
  remove_inconclusive = TRUE,
  .grouping_vars = c()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>datos_covid</code></td>
<td>
<p>(<strong>obligatorio</strong>) Lista de <code>tibble</code>s o <code>duckdb</code>s resultante de
<code>descarga_datos_abiertos()</code> o <code>read_datos_abiertos()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>entidades</code></td>
<td>
<p>(<strong>opcional</strong>)  Vector con las entidades de las unidades medicas a analizar.
Opciones: <code>AGUASCALIENTES</code>, <code style="white-space: pre;">⁠BAJA CALIFORNIA⁠</code>, <code style="white-space: pre;">⁠BAJA CALIFORNIA SUR⁠</code>,
<code>CAMPECHE</code>, <code>CHIAPAS</code>, <code>CHIHUAHUA</code>, <code style="white-space: pre;">⁠CIUDAD DE MEXICO⁠</code>,
<code style="white-space: pre;">⁠COAHUILA DE ZARAGOZA⁠</code> , <code>COLIMA</code>, <code>DURANGO</code>, <code>GUANAJUATO</code>, <code>GUERRERO</code>,
<code>HIDALGO</code>, <code>JALISCO</code>, <code>MEXICO</code>, <code style="white-space: pre;">⁠MICHOACAN DE OCAMPO⁠</code>, <code>MORELOS</code>,<code>NAYARIT</code>
<code style="white-space: pre;">⁠NUEVO LEON⁠</code>, <code>OAXACA</code> ,<code>PUEBLA</code>, <code>QUERETARO</code>,<code style="white-space: pre;">⁠QUINTANA ROO⁠</code>,
<code style="white-space: pre;">⁠SAN LUIS POTOSI⁠</code>, <code>SINALOA</code>, <code>SONORA</code>, <code>TABASCO</code>, <code>TAMAULIPAS</code>,<code>TLAXCALA</code>,
<code style="white-space: pre;">⁠VERACRUZ DE IGNACIO DE LA LLAVE⁠</code>, <code>YUCATAN</code>, <code>ZACATECAS</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group_by_entidad</code></td>
<td>
<p>(<strong>opcional</strong>) <code>TRUE</code> obtiene los casos para cada entidad reportando
en cada fecha la entidad y los casos en dicha entidad. <code>FALSE</code>  junta las <code>entidades</code> sumando
sus casos en una sola observacion por cada fecha.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>entidad_tipo</code></td>
<td>
<p>(<strong>opcional</strong>) Indica a que se refiere las <code>entidades</code> seleccionadas. Elige
una de las opciones: <code style="white-space: pre;">⁠Unidad Medica⁠</code> (entidad de la unidad medica), <code>Nacimiento</code>
(entidad de origen del individuo) o <code>Residencia</code> (entidad donde reside el individuo).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fecha_tipo</code></td>
<td>
<p>(<strong>opcional</strong>) Selecciona si la fecha que se utiliza es la fecha de <code>Ingreso</code>
(si aplica), la fecha de <code>Sintomas</code> o la de <code>Defuncion</code> (si aplica). El default es fecha de <code>Sintomas</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tipo_prueba</code></td>
<td>
<p>(<strong>opcional</strong>) Vector con el tipo de pruebas a incluir <code>Antigeno</code>, <code>PCR</code>. Por
default se incluyen ambas.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group_by_tipo_prueba</code></td>
<td>
<p>(<strong>opcional</strong>) Booleana determinando si regresa la base
con cada entrada agrupada por <code>tipo_prueba</code>. En caso <code>TRUE</code> (cada fecha
y entidad reporta separado el los casos de PCR y Antigeno). En caso <code>FALSE</code> se juntan
los casos de PCR y Antigeno para devolver un unico numero por fecha.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tipo_paciente</code></td>
<td>
<p>(<strong>opcional</strong>) Vector con el tipo de pacientes a incluir. Opciones:
<code>AMBULATORIO</code>, <code>HOSPITALIZADO</code>, <code style="white-space: pre;">⁠NO ESPECIFICADO⁠</code>. Por default se incluyen todos.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group_by_tipo_paciente</code></td>
<td>
<p>(<strong>opcional</strong>) Booleana determinando (caso <code>TRUE</code>) si regresa
la base con cada entrada agrupada por <code>tipo_paciente</code> (es decir cada fecha
se genera un renglon para <code>AMBULATORIO</code>, un renglon para <code>HOSPITALIZADO</code>, etc) o bien
si se suman todos los grupos y cada fecha reporta solo la suma de estos
(estilo <code>AMBULATORIO + HOSPITALIZADO</code> segun las categorias de <code>tipo_paciente</code>)
El default es <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tipo_uci</code></td>
<td>
<p>(<strong>opcional</strong>)  Vector con el tipo de valores para Unidad de
Cuidado Intensivo (UCI) a incluir:  <code>SI</code>,<code>NO</code>,<code style="white-space: pre;">⁠NO APLICA⁠</code>,<code style="white-space: pre;">⁠SE IGNORA⁠</code>,<code style="white-space: pre;">⁠NO ESPECIFICADO⁠</code>.
Por default se incluyen todos.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group_by_tipo_uci</code></td>
<td>
<p>(<strong>opcional</strong>) Booleana. El caso <code>TRUE</code> determina si regresa la base
con cada fecha teniendo diferentes renglones uno para cada <code>tipo_uci</code> (es decir cada fecha
se generan tantos observaciones como grupos de tipo de UCI) o bien en una sola fecha
se suman todos los tipos de UCI (<code>FALSE</code>). El default es <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tipo_sector</code></td>
<td>
<p>(<strong>opcional</strong>) Vector con los sectores del sistema de salud a incluir:
<code style="white-space: pre;">⁠CRUZ ROJA⁠</code>,<code>DIF</code>,<code>ESTATAL</code>,<code>IMSS</code>,<code>IMSS-BIENESTAR</code>,<code>ISSSTE</code>, <code>MUNICIPAL</code>,<code>PEMEX</code>,
<code>PRIVADA</code>,<code>SEDENA</code>,<code>SEMAR</code>,<code>SSA</code>, <code>UNIVERSITARIO</code>,<code style="white-space: pre;">⁠NO ESPECIFICADO⁠</code>.
Por default se incluyen todos.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group_by_tipo_sector</code></td>
<td>
<p>(<strong>opcional</strong>) Booleana determina en el caso de <code>TRUE</code> si regresa
la base con cada entrada agrupada por <code>tipo_sector</code> (es decir cada fecha
tiene una entrada con los del <code>IMSS</code>, una entrada distinta con los de <code>ISSSTE</code>, etc) o bien
en caso de <code>FALSE</code> se devuelve una sola entrada por fecha con la suma <code>IMSS + ISSSTE + etc</code>
segun los  sectores seleccionados. El default es <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>defunciones</code></td>
<td>
<p>(<strong>opcional</strong>)  Booleana si incluir sólo defunciones <code>TRUE</code> o a todos <code>FALSE</code>.
El default es <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edad_cut</code></td>
<td>
<p>(<strong>opcional</strong>) Vector con secuencia de edades para hacer grupos. Por ejemplo
<code>edad_cut = c(0, 10, Inf)</code> arma dos grupos de edad de 0 a 10 y de 10 a infinito o bien
<code>edad_cut = c(15, 20)</code> deja sólo los registros entre 15 y 20 años. Por default es <code>NULL</code>
y no arma grupos etarios.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fill_NA</code></td>
<td>
<p>(<strong>opcional</strong>)  Regresa observaciones para todas las combinaciones de variables
incluyendo como <code>NA</code> donde no se observaron casos en el denominador.  En caso contrario no se
incluyen las filas donde no se observaron casos.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>list_name</code></td>
<td>
<p>(<strong>opcional</strong>) Asigna un nombre en la lista de datos a la base generada</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remove_inconclusive</code></td>
<td>
<p>(<strong>opcional</strong>)  Si <code>TRUE</code> no considera en el denominador de la
positividad las pruebas cuyo resultado es inconcluso o aún no ha sido otorgado. Si <code>FALSE</code>
considera a todos. Por default es <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.grouping_vars</code></td>
<td>
<p>(<strong>opcional</strong>) Vector de variables adicionales de agrupacion de los
conteos. Por ejemplo si se agrega <code>.grouping_vars = 'DIABETES'</code> entonces para cada fecha habra
dos conteos de casos uno de los que tienen diabetes y uno de los que no.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>La positividad se define como
</p>
<p style="text-align: center;"><code class="reqn">\frac{\# Pruebas positivas}{Total de pruebas}</code>
</p>

<p>Si se utiliza la opción <code>remove_inconclusive = TRUE</code> el <strong>Total de pruebas</strong> se calcula
utilizando solo <code>POSITIVOS + NEGATIVOS</code>. Si <code>remove_inconclusive = FALSE</code> se calcula
utilizando todas las personas que tuvieron prueba:
<code style="white-space: pre;">⁠POSITIVOS + NEGATIVOS + INCONCLUSOS + SIN RESULTADO⁠</code>.
</p>
<p>Si no se realizaron pruebas un dia la positividad no esta definida pues el <strong>Total de pruebas</strong>
es cero. En ese caso si <code>fill_NA = TRUE</code> se devuelven las entradas de esos dias pero
con valor <code>NA</code>.
</p>


<h3>Value</h3>

<p>Une a la lista de <code>datos_covid</code> una nueva entrada de nombre <code>list_name</code>
(default: <code>positividad</code>) con una base de datos (<code>tibble</code>) con los
resultados agregados.
</p>

<ul>
<li>
<p> positividad - Base de datos generara con los datos agregados (el nombre cambia si
se usa <code>list_name</code>).
</p>
</li>
<li>
<p> dict - Diccionario de datos
</p>
</li>
<li>
<p> dats - Datos originales (conexion a <code>duckdb</code> o <code>tibble</code>)
</p>
</li>
<li>
<p> disconnect  - Función para desconectarte de <code>duckdb</code>
</p>
</li>
<li>
<p> ... - Cualquier otro elemento que ya existiera en <code>datos_covid</code>
</p>
</li>
</ul>
<h3>References</h3>

<p>Furuse, Y., Ko, Y. K., Ninomiya, K., Suzuki, M., &amp; Oshitani, H. (2021). Relationship of test
positivity rates with COVID-19 epidemic dynamics. International journal of environmental
research and public health, 18(9), 4655.
</p>
<p>Al Dallal, A., AlDallal, U., &amp; Al Dallal, J. (2021). Positivity rate: an indicator for the
spread of COVID-19. Current Medical Research and Opinion, 37(12), 2067-2076.
</p>


<h3>See Also</h3>

<p><code>descarga_datos_abiertos()</code> <code>numero_pruebas()</code> <code>cfr()</code> <code>chr()</code> <code>estima_rt()</code> <code>casos()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Para el ejemplo usaremos los datos precargados (datosabiertos) pero tu puedes
# correr el ejemplo descargando informacion mas reciente.
datos_covid &lt;- datosabiertos

# Casos a nivel nacional por estado por tipo de prueba
datos_covid &lt;- datos_covid |&gt; positividad()
head(datos_covid$positividad)


# Total nacional sumando todas las pruebas del pais
datos_covid &lt;- datos_covid |&gt;
  positividad(group_by_entidad = FALSE, list_name = "positividad_nacional")
head(datos_covid$positividad_nacional)

# Positivos en Baja California y Baja California Sur
datos_covid &lt;- datos_covid |&gt;
  positividad(
    entidades = c("BAJA CALIFORNIA", "BAJA CALIFORNIA SUR"),
    list_name = "positividad_californiana"
  )
head(datos_covid$positividad_californiana)

# Agrupando ambas pruebas en una sola positividad global
datos_covid &lt;- datos_covid |&gt;
  positividad(
    entidades = c("BAJA CALIFORNIA", "BAJA CALIFORNIA SUR"),
    group_by_tipo_prueba = FALSE,
    list_name = "positividad_californiana_2"
  )
head(datos_covid$positividad_californiana_2)

# Regresa la suma de ambos estados pero dividiendo por tipo de paciente
datos_covid &lt;- datos_covid |&gt;
  positividad(
    entidades = c("BAJA CALIFORNIA", "BAJA CALIFORNIA SUR"),
    group_by_entidad = FALSE,
    tipo_paciente = c("AMBULATORIO", "HOSPITALIZADO"),
    group_by_tipo_paciente = TRUE,
    list_name = "positividad_paciente"
  )
head(datos_covid$positividad_paciente)

# Si deseas agrupar por una variable que no este en las opciones va en .grouping_vars
datos_covid &lt;- datos_covid |&gt;
  positividad(
    tipo_sector = "IMSS",
    .grouping_vars = c("SEXO"),
    list_name = "positividad_imss_sexo"
  )
head(datos_covid$positividad_imss_sexo)


# Una vez hayas concluido tu trabajo no olvides desconectar
datos_covid$disconnect()
</code></pre>


</div>