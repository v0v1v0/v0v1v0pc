<div class="container">

<table style="width: 100%;"><tr>
<td>angleToPlane</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Angle with a Reference Plane</h2>

<h3>Description</h3>

<p>Compute the angle between a track's overall displacement and a reference plane.
Useful to detect directed movement and/or tracking artefacts.
</p>


<h3>Usage</h3>

<pre><code class="language-R">angleToPlane(
  x,
  p1 = c(0, 0, 0),
  p2 = c(0, 1, 0),
  p3 = c(1, 0, 0),
  from = 1,
  degrees = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a single input track; a matrix whose first column is time and whose
remaining columns are a spatial coordinate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p1, p2, p3</code></td>
<td>
<p>numeric vectors of coordinates of three points specifying a reference plane to
compute distances to.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>from</code></td>
<td>
<p>index, or vector of indices, of the first row of the track. If
<code>from</code> is a vector, angles are returned for all steps starting at
the indices in <code>from</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degrees</code></td>
<td>
<p>logical; should angles be returned in degrees rather than radians? (default = TRUE).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The average angle of steps to a reference plane should be roughly 32.7 degrees.
Lower angles to the border planes of an imaging volume can be indicative of tracking
artefacts, and systematic deviations from 32.7 can indicate a directional bias
(Beltman et al, 2009).
</p>


<h3>Value</h3>

<p>A single angle.
</p>


<h3>References</h3>

<p>Joost B. Beltman, Athanasius F.M. Maree and Rob. J. de Boer (2009),
Analysing immune cell migration. <em>Nature Reviews Immunology</em> <b>9</b>,
789â€“798. doi:10.1038/nri2638
</p>


<h3>See Also</h3>

<p><code>distanceToPlane</code> to compute the distance to the reference plane, and
<code>AngleAnalysis</code> for other methods to compute angles and distances.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Plotting the angle versus the distance to a reference plane can be informative to
## detect tracking artefacts near the border of the imaging volume.
## We should be suspicious especially when small angles are more frequent at low distances
## to the border planes.
load( system.file("extdata", "TCellsRaw.rda", package="celltrackR" ) )
steps &lt;- subtracks( TCellsRaw, 1 )
minz &lt;- boundingBox( TCellsRaw )["min","z"]
## Compute angles and distances to the lower plane in z-dimension
angles &lt;- sapply( steps, angleToPlane, p1 = c(0,0,minz), p2 = c(1,0,minz), p3 = c(0,1,minz) )
distances &lt;- sapply( steps, distanceToPlane, p1 = c(0,0,minz), p2 = c(1,0,minz), p3 = c(0,1,minz) )
scatter.smooth( distances, angles )
abline( h = 32.7, col = "red" )
</code></pre>


</div>