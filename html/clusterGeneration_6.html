<div class="container">

<table style="width: 100%;"><tr>
<td>getSepProj</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>OPTIMAL PROJECTION DIRECTION AND CORRESPONDING SEPARATION INDEX FOR PAIRS OF CLUSTERS</h2>

<h3>Description</h3>

<p>Optimal projection direction and corresponding separation index for pairs of clusters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">getSepProjTheory(
		 muMat, 
		 SigmaArray, 
                 iniProjDirMethod = c("SL", "naive"), 
                 projDirMethod = c("newton", "fixedpoint"), 
                 alpha = 0.05, 
		 ITMAX = 20, 
		 eps = 1.0e-10, 
		 quiet = TRUE)

getSepProjData(
	       y, 
	       cl, 
               iniProjDirMethod = c("SL", "naive"), 
               projDirMethod = c("newton", "fixedpoint"), 
               alpha = 0.05, 
	       ITMAX = 20, 
	       eps = 1.0e-10, 
	       quiet = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>muMat</code></td>
<td>

<p>Matrix of mean vectors. Rows correspond to mean vectors for clusters.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SigmaArray</code></td>
<td>

<p>Array of covariance matrices. <code>SigmaArray[,,i]</code> record the covariance 
matrix of the <code>i</code>-th cluster.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>Data matrix. Rows correspond to observations. Columns correspond to variables.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl</code></td>
<td>

<p>Cluster membership vector.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iniProjDirMethod</code></td>
<td>

<p>Indicating the method to get initial projection direction when calculating
the separation index between a pair of clusters (c.f. Qiu and Joe,
2006a, 2006b). <br><code>iniProjDirMethod</code>=“SL” indicates the initial projection 
direction is the sample version of the SL's projection direction 
(Su and Liu, 1993)
<code class="reqn">\left(\boldsymbol{\Sigma}_1+\boldsymbol{\Sigma}_2\right)^{-1}\left(\boldsymbol{\mu}_2-\boldsymbol{\mu}_1\right)</code><br><code>iniProjDirMethod</code>=“naive” indicates the initial projection 
direction is <code class="reqn">\boldsymbol{\mu}_2-\boldsymbol{\mu}_1</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>projDirMethod</code></td>
<td>

<p>Indicating the method to get the optimal projection direction when calculating 
the separation index between a pair of clusters (c.f. Qiu and Joe,
2006a, 2006b). <br><code>projDirMethod</code>=“newton” indicates we use the Newton-Raphson 
method to search the optimal projection direction (c.f. Qiu and Joe, 2006a). 
This requires the assumptions that both covariance matrices of the pair of 
clusters are positive-definite. If this assumption is violated, the 
“fixedpoint” method could be used. The “fixedpoint” method 
iteratively searches the optimal projection direction based on the first 
derivative of the separation index to the project direction 
(c.f. Qiu and Joe, 2006b).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>Tuning parameter reflecting the percentage in the two
tails of a projected cluster that might be outlying.
We set <code>alpha</code><code class="reqn">=0.05</code> like we set
the significance level in hypothesis testing as <code class="reqn">0.05</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ITMAX</code></td>
<td>

<p>Maximum iteration allowed when to iteratively calculate the
optimal projection direction.
The actual number of iterations is usually much less than the default value 20.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>

<p>Convergence threshold. A small positive number to check if a quantitiy 
<code class="reqn">q</code> is equal to zero.  If <code class="reqn">|q|&lt;</code><code>eps</code>, then we regard <code class="reqn">q</code> 
as equal to zero.  <code>eps</code> is used to check if an algorithm converges.
The default value is <code class="reqn">1.0e-10</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>

<p>A flag to switch on/off the outputs of intermediate results and/or possible warning messages. The default value is <code>TRUE</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When calculating the optimal projection direction and corresponding optimal 
separation index for a pair of cluster, if one or both cluster covariance 
matrices is/are singular, the ‘newton’ method can not be used. 
In this case, the functions <code>getSepProjTheory</code> and <code>getSepProjData</code> 
will automatically use the ‘fixedpoint’ method to search the optimal 
projection direction, even if the user specifies the value of the argument 
<code>projDirMethod</code> as ‘newton’. Also, multiple initial projection 
directions will be evaluated. 
</p>
<p>Specifically, <code class="reqn">2+2p</code> projection directions will be evaluated. The first 
projection direction is the “naive” direction 
<code class="reqn">\boldsymbol{\mu}_2-\boldsymbol{\mu}_1</code>. 
The second projection direction is the “SL” projection direction  
<code class="reqn">\left(\boldsymbol{\Sigma}_1+\boldsymbol{\Sigma}_2\right)^{-1}
\left(\boldsymbol{\mu}_2-\boldsymbol{\mu}_1\right)</code>.
The next <code class="reqn">p</code> projection directions are the <code class="reqn">p</code> eigenvectors of the covariance 
matrix of the first cluster. The remaining <code class="reqn">p</code> projection directions are 
the <code class="reqn">p</code> eigenvectors of the covariance matrix of the second cluster. 
</p>
<p>Each of these <code class="reqn">2+2*p</code> projection directions are in turn used as the initial 
projection direction for the ‘fixedpoint’ algorithm to obtain the 
optimal projection direction and the corresponding optimal separation index. 
We also obtain <code class="reqn">2+2*p</code> separation indices by projecting two clusters along each of these <code class="reqn">2+2*p</code> projection directions.
</p>
<p>Finally, the projection direction with the largest separation index among the 
<code class="reqn">2*(2+2*p)</code> optimal separation indices is chosen as the optimal projection 
direction. The corresponding separation index is chosen as the optimal 
separation index.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sepValMat</code></td>
<td>

<p>Separation index matrix
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>projDirArray</code></td>
<td>

<p>Array of projection directions for each pair of clusters
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Weiliang Qiu <a href="mailto:weiliang.qiu@gmail.com">weiliang.qiu@gmail.com</a><br>
Harry Joe <a href="mailto:harry@stat.ubc.ca">harry@stat.ubc.ca</a>
</p>


<h3>References</h3>

<p>Qiu, W.-L. and Joe, H. (2006a)
Generation of Random Clusters with Specified Degree of Separaion.
<em>Journal of Classification</em>, <b>23</b>(2), 315-334.
</p>
<p>Qiu, W.-L. and Joe, H. (2006b)
Separation Index and Partial Membership for Clustering.
<em>Computational Statistics and Data Analysis</em>, <b>50</b>, 585–603.
</p>
<p>Su, J. Q. and Liu, J. S. (1993)
Linear Combinations of Multiple Diagnostic Markers.
<em>Journal of the American Statistical Association</em>, <b>88</b>, 1350–1355.
</p>


<h3>Examples</h3>

<pre><code class="language-R">n1 &lt;- 50
mu1 &lt;- c(0, 0)
Sigma1 &lt;- matrix(c(2, 1, 1, 5), 2, 2)
n2 &lt;- 100
mu2 &lt;- c(10, 0)
Sigma2 &lt;- matrix(c(5, -1, -1, 2), 2, 2)
projDir &lt;- c(1,  0)
muMat &lt;- rbind(mu1,  mu2)
SigmaArray &lt;- array(0,  c(2, 2, 2))
SigmaArray[, , 1] &lt;- Sigma1
SigmaArray[, , 2] &lt;- Sigma2

a &lt;- getSepProjTheory(
		    muMat = muMat, 
		    SigmaArray = SigmaArray, 
		    iniProjDirMethod = "SL")
# separation index for cluster distributions 1 and 2
a$sepValMat[1, 2]
# projection direction for cluster distributions 1 and 2
a$projDirArray[1, 2, ]

library(MASS)
y1 &lt;- mvrnorm(n1, mu1, Sigma1)
y2 &lt;- mvrnorm(n2, mu2, Sigma2)
y &lt;- rbind(y1, y2)
cl &lt;- rep(1:2, c(n1, n2))

b &lt;- getSepProjData(
		  y = y, 
		  cl = cl, 
		  iniProjDirMethod = "SL", 
		  projDirMethod = "newton")
# separation index for clusters 1 and 2
b$sepValMat[1, 2]
# projection direction for clusters 1 and 2
b$projDirArray[1, 2, ]

</code></pre>


</div>