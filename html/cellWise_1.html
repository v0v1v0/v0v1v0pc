<div class="container">

<table style="width: 100%;"><tr>
<td>cellHandler</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
cellHandler algorithm
</h2>

<h3>Description</h3>

<p>This function flags cellwise outliers in <code>X</code> and imputes them, if robust estimates of the center <code>mu</code> and scatter matrix <code>Sigma</code> are given. When the latter are not known, as is typically the case, one can use the function <code>DDC</code> which only requires the data matrix <code>X</code>. Alternatively, the unknown center mu and scatter matrix Sigma can be estimated robustly from <code>X</code> by the function <code>DI</code>. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">cellHandler(X, mu, Sigma, quant = 0.99)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p><code>X</code> is the input data, and must be an <code class="reqn">n</code> by <code class="reqn">d</code> matrix or a data frame.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>An estimate of the center of the data
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>An estimate of the covariance matrix of the data
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quant</code></td>
<td>
<p>Cutoff used in the detection of cellwise outliers. Defaults to <code>0.99</code>
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with components: <br></p>

<ul>
<li> <p><code>Ximp</code> <br>
The imputed data matrix.
</p>
</li>
<li> <p><code>indcells</code> <br>
Indices of the cells which were flagged in the analysis.
</p>
</li>
<li> <p><code>indNAs</code> <br>
Indices of the NAs in the data. 
</p>
</li>
<li> <p><code>Zres</code> <br>
Matrix with standardized cellwise residuals of the flagged cells. Contains zeroes in the unflagged cells.
</p>
</li>
<li> <p><code>Zres_denom</code> <br>
Denominator of the standardized cellwise residuals.
</p>
</li>
<li> <p><code>cellPaths</code> <br>
Matrix with the same dimensions as X, in which each row contains the path of least angle regression through the cells of that row, i.e. the order of the coordinates in the path (1=first, 2=second,...)
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>J. Raymaekers and P.J. Rousseeuw
</p>


<h3>References</h3>

<p>J. Raymaekers and P.J. Rousseeuw (2020). Handling cellwise outliers by sparse regression and robust covariance. <em>Journal of Data Science, Statistics, and Visualisation</em>. <a href="https://doi.org/10.52933/jdssv.v1i3.18">doi:10.52933/jdssv.v1i3.18</a>(link to open access pdf)
</p>


<h3>See Also</h3>

<p><code>DI</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">mu &lt;- rep(0, 3)
Sigma &lt;- diag(3) * 0.1 + 0.9
X &lt;- rbind(c(0.5, 1.0, 5.0), c(-3.0, 0.0, 1.0))
n &lt;- nrow(X); d &lt;- ncol(X)
out &lt;- cellHandler(X, mu, Sigma)
Xres &lt;- X - out$Ximp # unstandardized residual
mean(abs(as.vector(Xres - out$Zres*out$Zres_denom))) # 0
W &lt;- matrix(rep(0,n*d),nrow=n) # weight matrix 
W[out$Zres != 0] &lt;- 1 # 1 indicates cells that were flagged
# For more examples, we refer to the vignette:
## Not run: 
vignette("DI_examples")

## End(Not run)
</code></pre>


</div>