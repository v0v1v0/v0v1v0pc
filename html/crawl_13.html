<div class="container">

<table style="width: 100%;"><tr>
<td>crwPostIS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate a value from the posterior distribution of a CTCRW model</h2>

<h3>Description</h3>

<p>The crwPostIS draws a set of states from the posterior distribution of a
fitted CTCRW model. The draw is either conditioned on the fitted parameter
values or "full" posterior draw with approximated parameter posterior
</p>


<h3>Usage</h3>

<pre><code class="language-R">crwPostIS(object.sim, fullPost = TRUE, df = Inf, scale = 1, thetaSamp = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object.sim</code></td>
<td>
<p>A crwSimulator object from <code>crwSimulator</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fullPost</code></td>
<td>
<p>logical. Draw parameter values as well to simulate full
posterior</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>degrees of freedom for multivariate t distribution approximation
to parameter posterior</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>Extra scaling factor for t distribution approximation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thetaSamp</code></td>
<td>
<p>If multiple parameter samples are available in object.sim,
setting <code>thetaSamp=n</code> will use the nth sample. Defaults to the last.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The crwPostIS draws a posterior sample of the track state matrices. If
fullPost was set to TRUE when the object.sim was build in
crwSimulator then a pseudo-posterior draw will be made by first
sampling a parameter value from a multivariate t distribution which
approximates the marginal posterior distribution of the parameters. The
covariance matrix from the fitted model object is used to scale the MVt
approximation. In addition, the factor "scale" can be used to further adjust
the approximation. Further, the parameter simulations are centered on the
fitted values.
</p>
<p>To correct for the MVt approximation, the importance sampling weight is also
supplied. When calculating averages of track functions for Bayes estimates
one should use the importance sampling weights to calculate a weighted
average (normalizing first, so the weights sum to 1).
</p>


<h3>Value</h3>

<p>List with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>alpha.sim.y</code></td>
<td>
<p>A matrix a simulated latitude state values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha.sim.x</code></td>
<td>
<p>Matrix of simulated longitude state values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>locType</code></td>
<td>
<p>Indicates prediction types with a "p" or observation times
with an "o"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Time</code></td>
<td>
<p>Initial state covariance for latitude</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>log likelihood of simulated parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p>Simulated parameter value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.isw</code></td>
<td>
<p>non normalized log importance sampling weight</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Devin S. Johnson
</p>


<h3>See Also</h3>

<p>See <code>demo(northernFurSealDemo)</code> for example.
</p>


</div>