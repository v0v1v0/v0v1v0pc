<div class="container">

<table style="width: 100%;"><tr>
<td>cellMap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Draw a cellmap
</h2>

<h3>Description</h3>

<p>This function draws a cellmap, possibly of a subset of rows and columns of the data,
and possibly combining cells into blocks. A cellmap shows which cells are missing and which ones are outlying, marking them in red for unusually large cell values and in blue for unusually low cell values. When cells are combined into blocks, the final color is the average of the colors in the individual cells. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">cellMap(R, indcells = NULL, indrows = NULL, outrows = NULL, 
        showcellvalues = NULL, D = NULL, rowlabels = NULL,
        columnlabels = NULL, mTitle = "cell map",
        rowtitle = "cases", columntitle = "variables", 
        showrows = NULL, showcolumns = NULL,
        nrowsinblock = NULL, ncolumnsinblock = NULL, 
        manualrowblocksizes = NULL,
        manualcolumnblocksizes = NULL,
        rowblocklabels = NULL, columnblocklabels = NULL,
        sizemain = 1.5, sizetitles = 1.2, sizerowlabels = 1,
        sizecolumnlabels = 1, sizecellvalues = 1, 
        adjustrowlabels = 1, adjustcolumnlabels = 1,
        columnangle = 90, colContrast = 1, 
        outlyingGrad = TRUE, 
        darkestColor = sqrt(qchisq(0.999, 1)),
        drawCircles = FALSE, showVals = NULL, autolabel = TRUE)   
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>

<p>Matrix of standardized residuals of the cells (required input argument). After running <code>DDC</code>, <code>DDCpredict</code>,  <code>MacroPCA</code> or <code>MacroPCApredict</code> this is typically their value <code>$stdResid</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indcells</code></td>
<td>

<p>Indices of flagged cells. Defaults to <code>NULL</code>, which flags the cells for which
<code class="reqn">|\code{R}| &gt; \sqrt(qchisq(0.99,1))</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indrows</code></td>
<td>

<p>Indices of outlying rows (if available). If not <code>NULL</code>, the small circle to the right of the row is filled black if the row is in this list, and white otherwise. This gets overruled if <code>outrows</code> is not <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outrows</code></td>
<td>

<p>Outlyingness of each row (if available). If not <code>NULL</code>, represents the outlyingness of each row by a shade of gray in the small circle to the right of the row. This color is white for <code>outrows</code> below <code class="reqn">1</code>, and becomes fully black for <code>outrows</code> over <code class="reqn">3</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showcellvalues</code></td>
<td>

<p>Takes the values <code>"D"</code>, <code>"R"</code> or <code>NULL</code> (the default). If <code>"R"</code> the numerical values of the residuals in <code>R</code> are shown in the cellmap. If <code>"D"</code>, the entries of the data matrix <code>D</code> are shown, provided the matrix <code>D</code> is being specified. If <code>NULL</code>, no entries are shown.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>

<p>A matrix of data values, of the same dimensions as <code>R</code>. Default is <code>NULL</code>. <code>D</code> is only required when the data values are to be shown in the cellmap, by the option <code>showcellvalues = "D"</code>. After running <code>DDC</code> or <code>MacroPCA</code>, <code>D</code> is typically their value <code>$remX</code>. After running <code>DDCpredict</code> or <code>MacroPCApredict</code> it is their argument <code>$newX</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rowlabels</code></td>
<td>

<p>Labels of the rows of the matrix <code>R</code>. If <code>NULL</code>, these labels are taken as rownames(<code>R</code>), and failing that they are <code>1:nrow(R)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>columnlabels</code></td>
<td>

<p>Labels of the columns of the matrix <code>R</code>. If <code>NULL</code>, these labels are taken as colnames(<code>R</code>), and failing that they are <code>1:ncol(R)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mTitle</code></td>
<td>

<p>Main title of the cellMap. Defaults to "cell map".
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rowtitle</code></td>
<td>

<p>Title for the rows. Defaults to "cases".
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>columntitle</code></td>
<td>

<p>Title for the columns. Defaults to "variables".
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showrows</code></td>
<td>

<p>Indices of the rows to be shown. Defaults to <code>NULL</code> which means all rows are shown.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showcolumns</code></td>
<td>

<p>Indices of the columns to be shown. Defaults to <code>NULL</code> which means all columns are shown.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrowsinblock</code></td>
<td>

<p>How many rows are combined in a block. Defaults to <code>NULL</code>, which asks not to block rows. The argument <code>nrowsinblock</code> is overruled by the argument <code>manualrowblocksizes</code> when the latter is specified.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncolumnsinblock</code></td>
<td>

<p>Defaults to <code>NULL</code>, which asks not to block columns. The argument <code>ncolumnsinblock</code> is overruled by the argument <code>manualcolumnblocksizes</code> when the latter is specified.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>manualrowblocksizes</code></td>
<td>
<p>This allows the user to specify their own row blocks, unlike the argument nrowsinblock which makes all row blocks the same length. The argument takes the form <code>c(a,b,...)</code> where <code>a</code> is the length of the first block, <code>b</code> is the length of the second, and so on. The numbers <code>a,b,...</code> must be strictly positive integers, adding up to at most <code>nrow(R)</code>. They cannot all be 1, which would mean no blocking of rows. Defaults to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>manualcolumnblocksizes</code></td>
<td>
<p>Analogous to manualrowblocksizes but for columns. It is allowed for one of them to be <code>NULL</code> while the other is not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rowblocklabels</code></td>
<td>
<p>This allows the user to specify labels for the row blocks, whether obtained from <code>nrowsinblock</code> or from <code>manualrowblocksizes</code>. Defaults to <code>NULL</code>, and then labels will be created automatically. Will throw an error if the number of row labels does not match the number of blocks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>columnblocklabels</code></td>
<td>
<p>Analogous to <code>rowblocklabels</code> but for columns. It is allowed for one of them to be <code>NULL</code> while the other is not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sizemain</code></td>
<td>

<p>Size of main title. Defaults to <code class="reqn">1.5</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sizetitles</code></td>
<td>

<p>Size of row title and column title. Defaults to <code class="reqn">1.2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sizerowlabels</code></td>
<td>

<p>Size of row labels. Defaults to <code class="reqn">1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sizecolumnlabels</code></td>
<td>

<p>Size of column labels. Defaults to <code class="reqn">1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sizecellvalues</code></td>
<td>

<p>Size of values in the cells, when showcellvalues = TRUE. Defaults to <code class="reqn">1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjustrowlabels</code></td>
<td>

<p>Adjust row labels: 0=left, 0.5=centered, 1=right. Defaults to <code class="reqn">1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjustcolumnlabels</code></td>
<td>

<p>Adjust column labels: 0=left, 0.5=centered, 1=right. Defaults to <code class="reqn">1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>columnangle</code></td>
<td>

<p>Angle of the column labels. Defaults to <code class="reqn">90</code> so the column labels are vertical.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colContrast</code></td>
<td>

<p>Parameter regulating the contrast of colors, should be in <code class="reqn">[1,5]</code>. Defaults to <code class="reqn">1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outlyingGrad</code></td>
<td>

<p>If <code>TRUE</code>, the color is gradually adjusted in function of the outlyingness. Defaults to <code>TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>darkestColor</code></td>
<td>

<p>Standardized residuals whose absolute value is bigger than this will get the darkest color.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drawCircles</code></td>
<td>

<p>Whether or not to draw circles indicating outlyingness of rows. When both <code>indrows</code> and <code>outrows</code> are NULL, no circles are drawn.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showVals</code></td>
<td>
<p>old name of argument <code>showcellvalues</code>. Only for backward compatibility.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>autolabel</code></td>
<td>
<p>obsoleted by the current machanism for creating blocks of cells. Is only in the list for backward compatibility.
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Rousseeuw P.J., Van den Bossche W. 
</p>


<h3>References</h3>

<p>Rousseeuw, P.J., Van den Bossche W. (2018). Detecting Deviating Data Cells. <em>Technometrics</em>, <b>60</b>(2), 135-145. <a href="https://www.tandfonline.com/doi/full/10.1080/00401706.2017.1340909">(link to open access pdf)</a>
</p>


<h3>See Also</h3>

<p><code>DDC</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># For examples of the cellmap, we refer to the vignette:
## Not run: 
vignette("DDC_examples")

## End(Not run)
</code></pre>


</div>