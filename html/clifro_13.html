<div class="container">

<table style="width: 100%;"><tr>
<td>cf_find_station</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Search for Clifro Stations</h2>

<h3>Description</h3>

<p>Search for <span class="pkg">clifro</span> stations based on name, region, location or network
number, and return a <code>cfStation</code> object.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cf_find_station(
  ...,
  search = c("name", "region", "network", "latlong"),
  datatype,
  combine = c("all", "any"),
  status = c("open", "closed", "all")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments to pass into the search, these differ depending on
<code>search</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>search</code></td>
<td>
<p>one of <code>name</code>, <code>network</code>, <code>region</code> or
<code>latlong</code> indicating the type of search to be conducted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>datatype</code></td>
<td>
<p><code>cfDatatype</code> object for when the search is based on
datatypes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>combine</code></td>
<td>
<p>character string <code>"all"</code> or <code>"any"</code> indicating if the
stations contain all or any of the selected datatypes for when the search is
based on datatypes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>status</code></td>
<td>
<p>character string indicating <code>"open"</code>, <code>"closed"</code> or
<code>"all"</code> stations be returned by the search.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>cf_find_station</code> function is a convenience function for finding
CliFlo stations in <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>. It uses the CliFlo
<a href="https://cliflo.niwa.co.nz/pls/niwp/wstn.get_stn_html">Find Stations</a>
page to do the searching, and therefore means that the stations are not
stored within <span class="pkg">clifro</span>.
</p>
<p>If <code>datatype</code> is missing then the search is conducted
without any reference to datatypes. If it is supplied then the
search will only return stations that have any or all of the supplied
datatypes, depending on <code>combine</code>. The default behaviour is to search
for stations based on pattern matching the station name and return only the
open stations.
</p>
<p>If the <code>latlong</code> search type is used the function expects named
arguments with names (partially) matching latitude,
longitude and radius. If the arguments are passed in without names they must
be in order of latitude, longitude and radius (see examples).
</p>


<h3>Value</h3>

<p><code>cfStation</code> object
</p>


<h3>Note</h3>

<p>Since the searching is done by CliFlo there are obvious restrictions.
Unfortunately the pattern matching for station name does not provide
functionality for regular expressions, nor does it allow simultaneous
searches although <span class="pkg">clifro</span> does provide some extra functionality, see
the 'OR query Search' example below.
</p>


<h3>See Also</h3>

<p><code>cf_save_kml</code> for saving the resulting stations as a KML
file, <code>cf_station</code> for creating <code>cfStation</code> objects
when the agent numbers are known, <code>vignette("choose-station")</code> for a
tutorial on finding <span class="pkg">clifro</span> stations and <code>vignette("cfStation")</code>
for working with <code>cfStation</code> objects.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Station Name Search ------------------------------------------------------
# Return all open stations with 'island' in the name (pattern match search)
# Note this example uses all the defaults

island_st = cf_find_station("island")
island_st

# Region Search ------------------------------------------------------------
# Return all the closed stations from Queenstown (using partial matching)

queenstown.st = cf_find_station("queen", search = "region", status = "closed")
queenstown.st

# Long/Lat Search ----------------------------------------------------------
# Return all open stations within a 10km radius of the Beehive in Wellington
# From Wikipedia: latitude 41.2784 S, longitude 174.7767 E

beehive.st = cf_find_station(lat = -41.2784, long = 174.7767, rad = 10,
                             search = "latlong")
beehive.st

# Network ID Search --------------------------------------------------------
# Return all stations that share A42 in their network ID

A42.st = cf_find_station("A42", search = "network", status = "all")
A42.st

# Using Datatypes in the Search --------------------------------------------
# Is the Reefton EWS station open and does it collect daily rain and/or wind
# data?

# First, create the daily rain and wind datatypes
daily.dt = cf_datatype(c(2, 3), c(1, 1), list(4, 1), c(1, NA))
daily.dt

# Then combine into the search. This will only return stations where at least
# one datatype is available.
cf_find_station("reefton EWS", datatype = daily.dt)  # Yes

# OR Query Search ----------------------------------------------------------
# Return all stations sharing A42 in their network ID *or* all the open
# stations within 10km of the Beehive in Wellington (note this is not
# currently available as a single query in CliFlo).

cf_find_station("A42", search = "network", status = "all") +
cf_find_station(lat = -41.2784, long = 174.7767, rad = 10,
                search = "latlong")

# Note these are all ordered by open stations, then again by their end dates

## End(Not run)
</code></pre>


</div>