<div class="container">

<table style="width: 100%;"><tr>
<td>cmvnorm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Conditional Multivariate Normal Density and Random Deviates</h2>

<h3>Description</h3>

<p>These functions provide the density function and a random number
generator for the conditional multivariate normal
distribution, [Y given X], where Z = (X,Y) is the fully-joint multivariate normal distribution with mean equal to <code>mean</code> and covariance matrix
<code>sigma</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dcmvnorm(x, mean, sigma, dependent.ind, given.ind, 
	X.given, check.sigma=TRUE, log = FALSE)
rcmvnorm(n, mean, sigma, dependent.ind, given.ind, 
	X.given, check.sigma=TRUE, 
	method=c("eigen", "svd", "chol"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>vector or matrix of quantiles of Y. If <code>x</code> is a matrix, each
row is taken to be a quantile.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of random deviates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p>mean vector, which must be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>a symmetric, positive-definte matrix of dimension n x n, which must be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dependent.ind</code></td>
<td>
<p>a vector of integers denoting the indices of dependent variable Y.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>given.ind</code></td>
<td>
<p>a vector of integers denoting the indices of conditioning variable X. If specified as integer vector of length zero or left unspecified, the unconditional distribution is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X.given</code></td>
<td>
<p>a vector of reals denoting the conditioning value of X. This should be of the same length as <code>given.ind</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check.sigma</code></td>
<td>
<p>logical; if <code>TRUE</code>, the variance-covariance matrix is checked for appropriateness (symmetry, positive-definiteness). This could be set to FALSE if the user knows it is appropriate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>logical; if <code>TRUE</code>, densities d are given as log(d).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>string specifying the matrix decomposition used to
determine the matrix root of <code>sigma</code>.  Possible methods are
eigenvalue decomposition (<code>"eigen"</code>, default),
singular value decomposition (<code>"svd"</code>), and
Cholesky decomposition (<code>"chol"</code>).  The
Cholesky is typically fastest, not by much though.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>pcmvnorm</code>, <code>pmvnorm</code>, <code>dmvnorm</code>, <code>qmvnorm</code></p>


<h3>Examples</h3>

<pre><code class="language-R"># 10-dimensional multivariate normal distribution
n &lt;- 10
A &lt;- matrix(rnorm(n^2), n, n)
A &lt;- A %*% t(A)

# density of Z[c(2,5)] given Z[c(1,4,7,9)]=c(1,1,0,-1)
dcmvnorm(x=c(1.2,-1), mean=rep(1,n), sigma=A, 
	dependent.ind=c(2,5), given.ind=c(1,4,7,9), 
	X.given=c(1,1,0,-1))

dcmvnorm(x=-1, mean=rep(1,n), sigma=A, dep=3, given=c(1,4,7,9,10), 
  X=c(1,1,0,0,-1))

dcmvnorm(x=c(1.2,-1), mean=rep(1,n), sigma=A, dep=c(2,5), 
  given=integer())

# gives an error since `x' and `dep' are incompatibe
#dcmvnorm(x=-1, mean=rep(1,n), sigma=A, dep=c(2,3), 
#	given=c(1,4,7,9,10), X=c(1,1,0,0,-1))

rcmvnorm(n=10, mean=rep(1,n), sigma=A, dep=c(2,5), 
	given=c(1,4,7,9,10), X=c(1,1,0,0,-1), 
	method="eigen")

rcmvnorm(n=10, mean=rep(1,n), sigma=A, dep=3, 
	given=c(1,4,7,9,10), X=c(1,1,0,0,-1), 
	method="chol")
</code></pre>


</div>