<div class="container">

<table style="width: 100%;"><tr>
<td>confintROB</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Confidence Intervals for Robust and Classical Linear Mixed Model Estimators.</h2>

<h3>Description</h3>

<p>Confidence Intervals (CIs) based on parametric and semi-parametric bootstrap (and Wald-type) for robust and classical Linear Mixed Models estimators.
</p>


<h3>Usage</h3>

<pre><code class="language-R">confintROB(
  object,
  parm,
  level = 0.95,
  method = c("boot", "BCa", "Wald"),
  nsim = 5000,
  boot.type = c("wild", "parametric"),
  clusterID,
  verify.saved = NULL,
  .export = NULL,
  varComprob.data,
  varComprob.random,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of class <code>lmerMod</code>, <code>rlmerMod</code> or <code>varComprob</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parm</code></td>
<td>
<p>parameters for which intervals are sought. Specified by an integer vector of positions (see example) or a character vector of parameter names. Fixed effects parameters are ordered according their appearance in the formula. For the order of variance components, see argument <code>order</code> of the <code>varCorr</code> function from package <code>lme4</code>. By default, the CIs of all the parameters of the model are computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>confidence level in ]0; 1[</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>type of CIs: <code>"Wald"</code>, <code>"boot"</code>, <code>"BCa"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>number of bootstrap samples, positive integer</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot.type</code></td>
<td>
<p>type of bootstrap: <code>"wild"</code> or <code>"parametric"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clusterID</code></td>
<td>
<p>text variable indicating the clustering variable. This is only required for method <code>"BCa"</code> or for boot.type <code>"wild"</code> for <code>varComprob</code> objects. This vector is used to identify the level of the "cluster" to which these resampling methods should be applied and is not included in the <code>varComprob</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verify.saved</code></td>
<td>
<p>check if an existing CI is already computed. Only for the vignette examples</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.export</code></td>
<td>
<p>passed on to <code>foreach</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varComprob.data</code></td>
<td>
<p>a data frame object used to fit the original model. This is only required for the <code>varComprob</code> objects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varComprob.random</code></td>
<td>
<p>text variable describing the random effect structure as it would be written with <code>lmer</code> from <code>lme4</code>. This is only required for the <code>varComprob</code> objects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments passed on to <code>lmer</code> (if applicable)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Implements the classical Wald-type CI, the parametric and the wild bootstrap (Modugno &amp; Giannerini, 2013) for linear mixed models estimated with the robust estimators in <code>rlmer</code> (Koller, 2016; Koller &amp; Stahel, 2022) and 
<code>varComprob</code> (Agostinelli &amp; Yohai, 2016) and the classical estimators in <code>lmer</code> (Bates et al., 2013). For bootstrap methods, percentile, Bias-Corrected, and accelerated (BCa) versions are available. All these versions are tested in Mason, Cantoni &amp; Ghisletta (2021, 2024).
</p>
<p><code>confintROB</code> computes 5 types of CIs based on arguments <code>method</code> and <code>boot.type</code>.
</p>
<p><code>method</code>:
</p>
<p>- <code>"Wald"</code>: CIs computation is based on standard error estimates
</p>
<p>- <code>"boot"</code>: CIs are computed using the respective percentile of estimates obtained on bootstrap sample(s) based on the confidence <code>level</code>
</p>
<p>- <code>"BCa"</code>: based on the Jacknife method, the Bias-Corrected and accelerated parameters are computed on the original sample to correct estimates obtained from the bootstrap sample(s)
</p>
<p><code>boot.type</code> (for <code>method</code>s <code>"boot"</code> and <code>"BCa"</code>):
</p>
<p>- <code>"parametric"</code>: the classical parametric bootstrap scheme is used to create bootstrap sample(s)
</p>
<p>- <code>"wild"</code>: the semi-parametric bootstrap scheme is used to create bootstrap sample(s)
</p>


<h3>Value</h3>

<p>a numeric table (matrix with column and row names) of CIs.
</p>


<h3>References</h3>

<p>Agostinelli, C., &amp; Yohai, V. J. (2016). Composite robust estimators for linear mixed models. Journal of the American Statistical Association, 111 (516), 1764-1774. doi:10.1080/01621459.2015.1115358
</p>
<p>Bates, D., Machler, M., Bolker, B., &amp; Walker, S. (2015). Fitting linear mixed-effects models using lme4. Journal of Statistical Software, 67 (1), 1-48. doi: 10.18637/jss.v067.i01
</p>
<p>Koller, M. (2016). robustlmm: An R package for robust estimation of linear mixed-effects models. Journal of Statistical Software, 75 (6), 1-24. doi: 10.18637/jss.v075.i06
</p>
<p>Koller, M., &amp; Stahel, W. A. (2022). Robust estimation of general linear mixed effects models. In P. M. Yi &amp; P. K. Nordhausen (Eds.), Robust and multivariate statistical methods. Springer Nature Switzerland AG.
</p>
<p>Mason, F., Cantoni, E., &amp; Ghisletta, P. (2021). Parametric and semi-parametric bootstrap-based confidence intervals for robust linear mixed models. Methodology, 17 (4), 271-295. doi: 10.5964/meth.6607
</p>
<p>Mason, F., Cantoni, E., &amp; Ghisletta, P. (2024). Linear mixed models and latent growth curve models for group comparison studies contaminated by outliers. Psychological methods. doi: 10.1037/met0000643
</p>
<p>Modugno, L., &amp; Giannerini, S. (2013). The wild bootstrap for multilevel models. Communications in Statistics - Theory and Methods, 44 (22), 4812-4825. doi: 10.1080/03610926.2013.80280
</p>


<h3>See Also</h3>

<p><code>lmer</code>
<code>rlmer</code> 
<code>varComprob</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">if (require(robustlmm)) {
  model.RSE &lt;- rlmer(Reaction ~ 1 + Days + (Days|Subject),
                    data = sleepstudy)
  CI.RSE &lt;- confintROB(model.RSE, level = .95, boot.type = "wild",
                    parm = c(1,2), # indicates that only CIs
                                   # for the intercept and Days are asked.
                    nsim = 10) # small nsim for speed, in practice use, e.g., 5000
  print(CI.RSE)
}
</code></pre>


</div>