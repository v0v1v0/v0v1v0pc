<div class="container">

<table style="width: 100%;"><tr>
<td>cmtest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Conditional moments test</h2>

<h3>Description</h3>

<p>Conditional moments tests for maximum likelihood estimators consist
on adding to the matrix of individual contributions to the score
moments conditions and then test the hypothesis that the expected
value of the vector of augmented scores is zero. It is particularly
convenient for the probit and the tobit model to test for
functional form, omitted variables, heteroscedasticity and normaliy.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cmtest(
  x,
  test = c("normality", "reset", "heterosc", "skewness", "kurtosis"),
  powers = 2:3,
  heter_cov = NULL,
  OPG = FALSE
)

## S3 method for class 'tobit'
cmtest(
  x,
  test = c("normality", "reset", "heterosc", "skewness", "kurtosis"),
  powers = 2:3,
  heter_cov = NULL,
  OPG = FALSE
)

## S3 method for class 'tobit1'
cmtest(
  x,
  test = c("normality", "reset", "heterosc", "skewness", "kurtosis"),
  powers = 2:3,
  heter_cov = NULL,
  OPG = FALSE
)

## S3 method for class 'censReg'
cmtest(
  x,
  test = c("normality", "reset", "heterosc", "skewness", "kurtosis"),
  powers = 2:3,
  heter_cov = NULL,
  OPG = FALSE
)

## S3 method for class 'glm'
cmtest(
  x,
  test = c("normality", "reset", "heterosc", "skewness", "kurtosis"),
  powers = 2:3,
  heter_cov = NULL,
  OPG = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a fitted model, currently a tobit model either fitted by
<code>AER::tobit</code> or <code>censReg::censReg</code> or a probit model fitted by
<code>glm</code> with <code>family = binomial(link = 'probit')</code>,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>the kind of test to be performed, either a normality
test (or separately a test that the skewness or kurtosis
coefficients are 0 and 3), a heteroscedasticity test or a reset
test,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>powers</code></td>
<td>
<p>the powers of the fitted values that should be used
in the reset test,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>heter_cov</code></td>
<td>
<p>a one side formula that indicates the covariates
that should be used for the heteroscedasticity test (by default
all the covariates used in the regression are used),</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>OPG</code></td>
<td>
<p>a boolean, if <code>FALSE</code> (the default), the analytic
derivatives are used, otherwise the outer product of the
gradient formula is used</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list with class <code>'htest'</code> containing the following components:
</p>

<ul>
<li>
<p> data.mane: a character string describing the fitted model
</p>
</li>
<li>
<p> statistic: the value of the test statistic
</p>
</li>
<li>
<p> parameter: degrees of freedom
</p>
</li>
<li>
<p> p.value: the p.value of the test
</p>
</li>
<li>
<p> method: a character indicating what type of test is performed
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Yves Croissant
</p>


<h3>References</h3>

<p>Newey WK (1985).
“Maximum Likelihood Specification Testing and Conditional Moment Tests.”
<em>Econometrica</em>, <b>53</b>(5), 1047–1070.
ISSN 00129682, 14680262, <a href="https://www.jstor.org/stable/1911011">https://www.jstor.org/stable/1911011</a>.
</p>
<p>Pagan A, Vella F (1989).
“Diagnostic Tests for Models Based on Individual Data: A Survey.”
<em>Journal of Applied Econometrics</em>, <b>4</b>, S29–S59.
ISSN 08837252, 10991255, <a href="https://www.jstor.org/stable/2096593">https://www.jstor.org/stable/2096593</a>.
</p>
<p>Tauchen G (1985).
“Diagnostic testing and evaluation of maximum likelihood models.”
<em>Journal of Econometrics</em>, <b>30</b>(1), 415-443.
ISSN 0304-4076, doi: <a href="https://doi.org/10.1016/0304-4076(85)90149-6">10.1016/0304-4076(85)90149-6</a>, <a href="https://www.sciencedirect.com/science/article/pii/0304407685901496">https://www.sciencedirect.com/science/article/pii/0304407685901496</a>.
</p>
<p>Wells C (2003).
“Retesting Fair's (1978) Model on Infidelity.”
<em>Journal of Applied Econometrics</em>, <b>18</b>(2), 237–239.
ISSN 08837252, 10991255, <a href="https://www.jstor.org/stable/30035205">https://www.jstor.org/stable/30035205</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># replication of Wells (2003) and Pagan and Vella (1989) using Fair's data
library("AER")
data("Affairs", package = "AER")
z &lt;- tobit(affairs ~ gender + age + yearsmarried + children + religiousness +
                     education + occupation + rating, data = Affairs)
cmtest(z, test = "normality")
cmtest(z, test = "skewness", OPG = TRUE)
cmtest(z, test = "kurtosis", OPG = TRUE)
cmtest(z, test = "reset", powers = 2, OPG = TRUE)
cmtest(z, test = "reset", powers = 3, OPG = TRUE)
cmtest(z, test = "heterosc", OPG = TRUE, heter_cov = ~ gender)
</code></pre>


</div>