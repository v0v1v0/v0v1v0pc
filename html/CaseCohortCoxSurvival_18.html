<div class="container">

<table style="width: 100%;"><tr>
<td>influences</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>influences</h2>

<h3>Description</h3>

<p>Computes the influences on the log-relative hazard, baseline hazards at each
unique event time, cumulative baseline hazard in a given time interval
[Tau1, Tau2] and on the pure risk in [Tau1, Tau2] and for a given covariate
profile x. Can take calibration of the design weights into account.
</p>


<h3>Usage</h3>

<pre><code class="language-R">influences(mod, Tau1 = NULL, Tau2 = NULL, x = NULL, calibrated = NULL,
A = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mod</code></td>
<td>
<p>a cox model object, result of function coxph.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tau1</code></td>
<td>
<p>left bound of the time interval considered for the cumulative
baseline hazard and pure risk. Default is the first event time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tau2</code></td>
<td>
<p>right bound of the time interval considered for the cumulative
baseline hazard and pure risk. Default is the last event time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>vector of length <code class="reqn">p</code>, specifying the covariate profile considered for the
pure risk. Default is (0,...,0).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>calibrated</code></td>
<td>
<p>are calibrated weights used for the estimation of the
parameters? If <code>calibrated = TRUE</code>, the argument below needs to be
provided. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p><code class="reqn">n \times q</code> matrix with the values of the auxiliary variables used for
the calibration of the weights in the whole cohort. Needs to be provided if
<code>calibrated = TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>influences</code> works for estimation from a case-cohort with design weights
or calibrated weights (case-cohort consisting of the subcohort and cases not in
the subcohort, i.e., case-cohort obtained from two phases of sampling).
</p>
<p>If covariate information is missing for certain individuals in the phase-two data
(i.e., case-cohort obtained from three phases of sampling), use <code>influences.missingdata</code>.
</p>
<p><code>influences</code> uses the influence formulas provided in Etievant and Gail
(2024).
</p>
<p>If <code>calibrated = FALSE</code>, the infuences are only provided for the individuals
in the case-cohort. If <code>calibrated = TRUE</code>, the influences are provided for
all the individuals in the cohort.
</p>


<h3>Value</h3>

<p><code>infl.beta</code>: matrix with the overall influences on the log-relative hazard estimates.
</p>
<p><code>infl.lambda0.t</code>: matrix with the overall influences on the baseline hazards estimates at each unique event time.
</p>
<p><code>infl.Lambda0.Tau1Tau2.hat</code>: vector with the overall influences on the cumulative baseline hazard estimate in [Tau1, Tau2].
</p>
<p><code>infl.Pi.x.Tau1Tau2.hat</code>: vector with the overall influences on the pure risk estimate in [Tau1, Tau2] and for covariate profile <code>x</code>.
</p>
<p><code>infl2.beta</code>: matrix with the phase-two influences on the log-relative hazard estimates. Returned if <code>calibrated = TRUE</code>.
</p>
<p><code>infl2.lambda0.t</code>: matrix with the phase-two influences on the baseline hazards estimates at each unique event time. Returned if <code>calibrated = TRUE</code>.
</p>
<p><code>infl2.Lambda0.Tau1Tau2.hat</code>: vector with the phase-two influences on the cumulative baseline hazard estimate in [Tau1, Tau2]. Returned if <code>calibrated = TRUE</code>.
</p>
<p><code>infl2.Pi.x.Tau1Tau2.hat</code>: vector with the phase-two influences on the pure risk estimate in [Tau1, Tau2] and for covariate profile <code>x</code>. Returned if <code>calibrated = TRUE</code>.
</p>
<p><code>beta.hat</code>: vector of length <code class="reqn">p</code> with log-relative hazard estimates.
</p>
<p><code>lambda0.t.hat</code>: vector with baseline hazards estimates at each unique event time.
</p>
<p><code>Lambda0.Tau1Tau2.hat</code>: cumulative baseline hazard estimate in [Tau1, Tau2].
</p>
<p><code>Pi.x.Tau1Tau2.hat</code>: pure risk estimate in [Tau1, Tau2] and for covariate profile <code>x</code>.
</p>


<h3>References</h3>

<p>Etievant, L., Gail, M. H. (2024). Cox model inference for relative hazard and pure risk from stratified weight-calibrated case-cohort data. Lifetime Data Analysis, 30, 572-599.
</p>


<h3>See Also</h3>

<p><code>estimation</code>, <code>estimation.CumBH</code>, <code>estimation.PR</code>,
<code>influences.RH</code>, <code>influences.CumBH</code>, <code>influences.PR</code>,
<code>influences.missingdata</code>, <code>influences.RH.missingdata</code>,
<code>influences.CumBH.missingdata</code>,
<code>influences.PR.missingdata</code>, <code>robustvariance</code> and  <code>variance</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
  data(dataexample.stratified, package="CaseCohortCoxSurvival")
  cohort &lt;- dataexample.stratified$cohort
  casecohort &lt;- cohort[which(cohort$status == 1 |
                       cohort$subcohort == 1),] # the stratified case-cohort
  casecohort$weights &lt;- casecohort$strata.n / casecohort$strata.m
  casecohort$weights[which(casecohort$status == 1)] &lt;- 1

  Tau1 &lt;- 0
  Tau2 &lt;- 8
  x &lt;- c(-1, 1, -0.6) # given covariate profile for the pure risk

  # Estimation using the stratified case cohort with design weights
  mod &lt;- coxph(Surv(event.time, status) ~ X1 + X2 + X3, data = casecohort,
               weight = weights, id = id, robust = TRUE)
  est &lt;- influences(mod, Tau1 = Tau1, Tau2 = Tau2, x = x)

  # print the vector with log-relative hazard estimates
  est$beta.hat

  # print the cumulative baseline hazard estimate
  est$Lambda0.Tau1Tau2.hat

  # print the pure risk estimate
  est$Pi.x.Tau1Tau2.hat

  # print the influences on the log-relative hazard estimates
  # est$infl.beta

  # print the influences on the cumulative baseline hazard estimate
  # est$infl.Lambda0.Tau1Tau2

  # print the influences on the pure risk estimate
  # est$infl.Pi.x.Tau1Tau2
</code></pre>


</div>