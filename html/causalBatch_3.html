<div class="container">

<table style="width: 100%;"><tr>
<td>cb.correct.caus_cComBat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Causal Conditional ComBat</h2>

<h3>Description</h3>

<p>A function for implementing the causal conditional ComBat (causal cComBat) algorithm.
This algorithm allows users to remove batch effects (in each dimension), while adjusting for known confounding
variables. It is imperative that this function is used in conjunction with domain
expertise (e.g., to ensure that the covariates are not colliders, and that the system satisfies the strong
ignorability condiiton) to derive causal conclusions. See citation for more details as to the conditions
under which conclusions derived are causal.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cb.correct.caus_cComBat(
  Ys,
  Ts,
  Xs,
  match.form,
  reference = NULL,
  match.args = list(method = "nearest", exact = NULL, replace = FALSE, caliper = 0.1),
  retain.ratio = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Ys</code></td>
<td>
<p>an <code>[n, d]</code> matrix, for the outcome variables with <code>n</code> samples in <code>d</code> dimensions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ts</code></td>
<td>
<p><code>[n]</code> the labels of the samples, with <code>K &lt; n</code> levels, as a factor variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xs</code></td>
<td>
<p><code>[n, r]</code> the <code>r</code> covariates/confounding variables, for each of the <code>n</code> samples, as a data frame with named columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>match.form</code></td>
<td>
<p>A formula of columns from <code>Xs</code>, to be passed directly to <code>matchit</code> for subsequent matching. See <code>formula</code> argument from <code>matchit</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reference</code></td>
<td>
<p>the name of the reference/control batch, against which to match. Defaults to <code>NULL</code>, which treats the reference batch as the smallest batch.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>match.args</code></td>
<td>
<p>A named list arguments for the <code>matchit</code> function, to be used to specify specific matching strategies, where the list names are arguments and the corresponding values the value to be passed to <code>matchit</code>. Defaults to inexact nearest-neighbor caliper (width 0.1) matching without replacement.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>retain.ratio</code></td>
<td>
<p>If the number of samples retained is less than <code>retain.ratio*n</code>, throws a warning. Defaults to <code>0.05</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list, containing the following:
</p>

<ul>
<li>
<p><code>Ys.corrected</code> an <code>[m, d]</code> matrix, for the <code>m</code> retained samples in <code>d</code> dimensions, after correction.
</p>
</li>
<li>
<p><code>Ts</code> <code>[m]</code> the labels of the <code>m</code> retained samples, with <code>K &lt; n</code> levels.
</p>
</li>
<li>
<p><code>Xs</code> the <code>r</code> covariates/confounding variables for each of the <code>m</code> retained samples.
</p>
</li>
<li>
<p><code>Retained.Ids</code> a <code>[m]</code> vector consisting of the sample ids of the <code>n</code> original samples that were retained after matching.
</p>
</li>
</ul>
<h3>Details</h3>

<p>For more details see the help vignette:
<code>vignette("causal_ccombat", package = "causalBatch")</code>
</p>


<h3>Author(s)</h3>

<p>Eric W. Bridgeford
</p>


<h3>References</h3>

<p>Eric W. Bridgeford, et al. "A Causal Perspective for Batch Effects: When is no answer better than a wrong answer?" Biorxiv (2024).
</p>
<p>Daniel E. Ho, et al. "MatchIt: Nonparametric Preprocessing for Parametric Causal Inference" JSS (2011).
</p>
<p>W Evan Johnson, et al. "Adjusting batch effects in microarray expression data using empirical Bayes methods" Biostatistics (2007).
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(causalBatch)
sim &lt;- cb.sims.sim_linear(a=-1, n=100, err=1/8, unbalancedness=3)
cb.correct.caus_cComBat(sim$Ys, sim$Ts, data.frame(Covar=sim$Xs), "Covar")

</code></pre>


</div>