<div class="container">

<table style="width: 100%;"><tr>
<td>log1mexp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute  f(a) = <code class="reqn">\mathrm{log}</code>(1 +/- <code class="reqn">\mathrm{exp}</code>(-a))
Numerically Optimally</h2>

<h3>Description</h3>

<p>Compute f(a) = log(1 - exp(-a)), respectively
g(x) = log(1 + exp(x))  quickly numerically accurately.
</p>


<h3>Usage</h3>

<pre><code class="language-R">log1mexp(a, cutoff = log(2))
log1pexp(x, c0 = -37, c1 = 18, c2 = 33.3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>numeric vector of positive values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>numeric vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p>positive number; <code>log(2)</code> is “optimal”,

but the exact value is unimportant, and anything in
<code class="reqn">[0.5, 1]</code> is fine.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c0, c1, c2</code></td>
<td>
<p>cutoffs for <code>log1pexp</code>; see below.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>f(a) == log(1 - exp(-a)) == log1p(-exp(-a)) ==
log(-expm1(-a))
</p>
<p>or
</p>
<p>g(x) == log(1 + exp(x)) == log1p(exp(x))
</p>
<p>computed accurately and quickly
</p>


<h3>References</h3>


<p>Martin Mächler (2012).
Accurately Computing <code class="reqn">\log(1-\exp(-|a|))</code>;
<a href="https://CRAN.R-project.org/package=Rmpfr/vignettes/log1mexp-note.pdf">https://CRAN.R-project.org/package=Rmpfr/vignettes/log1mexp-note.pdf</a>.

</p>


<h3>Examples</h3>

<pre><code class="language-R">a &lt;- 2^seq(-58,10, length = 256)
fExpr &lt;- expression(
          log(1 - exp(-a)),
          log(-expm1(-a)),
          log1p(-exp(-a)),
          log1mexp(a))
names(fExpr) &lt;- c("DEF", "expm1", "log1p", "F")
str(fa &lt;- do.call(cbind, as.list(fExpr)))
head(fa)# expm1() works here
tail(fa)# log1p() works here

## graphically:
lwd &lt;- 1.5*(5:2); col &lt;- adjustcolor(1:4, 0.4)
op &lt;- par(mfcol=c(1,2), mgp = c(1.25, .6, 0), mar = .1+c(3,2,1,1))
  matplot(a, fa, type = "l", log = "x", col=col, lwd=lwd)
  legend("topleft", fExpr, col=col, lwd=lwd, lty=1:4, bty="n")
  # expm1() &amp; log1mexp() work here

  matplot(a, -fa, type = "l", log = "xy", col=col, lwd=lwd)
  legend("left", paste("-",fExpr), col=col, lwd=lwd, lty=1:4, bty="n")
  # log1p() &amp; log1mexp() work here
par(op)

curve(log1pexp, -10, 10, asp=1)
abline(0,1, h=0,v=0, lty=3, col="gray")

## Cutoff c1 for log1pexp() -- not often "needed":
curve(log1p(exp(x)) - log1pexp(x), 16, 20, n=2049)
## need for *some* cutoff:
x &lt;- seq(700, 720, by=2)
cbind(x, log1p(exp(x)), log1pexp(x))

## Cutoff c2 for log1pexp():
curve((x+exp(-x)) - x, 20, 40, n=1025)
curve((x+exp(-x)) - x, 33.1, 33.5, n=1025)
</code></pre>


</div>