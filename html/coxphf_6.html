<div class="container">

<table style="width: 100%;"><tr>
<td>coxphftest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Penalized Likelihood Ratio Test in Cox Regression</h2>

<h3>Description</h3>

<p>Performs a penalized likelihood ratio test for hypotheses within a Cox regression analysis using Firth's penalized likelihood.
</p>


<h3>Usage</h3>

<pre><code class="language-R">coxphftest(
  formula,
  data,
  test = ~.,
  values,
  maxit = 50,
  maxhs = 5,
  epsilon = 1e-06,
  maxstep = 0.5,
  firth = TRUE,
  adapt = NULL,
  penalty = 0.5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula object, with the response on the left of the  operator, and the model terms on the right. The response must be a survival object as returned by the 'Surv' function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data.frame in which to interpret the variables named in the 'formula' argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>righthand formula of parameters to test (e.g. <code>~ B + D</code>). As default the null hypothesis that all parameters are 0 is tested.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>values</code></td>
<td>
<p>null hypothesis values, default values are 0. For testing the hypothesis H0: B1=1 and B4=2 and B5=0, specify <code>test= ~ B1 + B4 + B5</code> and <code>values=c(1, 2, 0)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>maximum number of iterations (default value is 50)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxhs</code></td>
<td>
<p>maximum number of step-halvings per iterations (default value is 5). The increments of the parameter vector in one Newton-Rhaphson iteration step are halved, unless the new likelihood is greater than the old one, maximally doing <code>maxhs</code> halvings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>specifies the maximum allowed change in penalized log likelihood todeclare convergence. Default value is 0.0001.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxstep</code></td>
<td>
<p>specifies the maximum change of (standardized) parameter values allowed in one iteration. Default value is 2.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>firth</code></td>
<td>
<p>use of Firth's penalized maximum likelihood (<code>firth=TRUE</code>, default) or the standard maximum likelihood method (<code>firth=FALSE</code>) for fitting the Cox model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adapt</code></td>
<td>
<p>optional: specifies a vector of 1s and 0s, where 0 means that the corresponding parameter is fixed at 0, while 1 enables 
parameter estimation for that parameter. The length of adapt must be equal to the number of parameters to be estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty</code></td>
<td>
<p>strength of Firth-type penalty. Defaults to 0.5.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function performs a penalized likelihood ratio test on some (or all) selected parameters.  
It can be used to test contrasts of parameters, or factors that are coded in dummy variables. 
The resulting object is of the class coxphftest and includes the information printed by the proper print method.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>testcov</code></td>
<td>
<p>the names of the tested model terms</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>the restricted and unrestricted maximized (penalized) log likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>the number of degrees of freedom related to the test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>the p-value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the function call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the estimation method (penalized ML or ML)</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Firth D (1993). Bias reduction of maximum likelihood estimates. <em>Biometrika</em> 80:27–38.
</p>
<p>Heinze G and Schemper M (2001). A Solution to the Problem of Monotone Likelihood in Cox Regression. <em>Biometrics</em> 57(1):114–119. 
</p>
<p>Heinze G (1999). Technical Report 10/1999: The application of Firth's procedure to Cox and logistic regression. Section of Clinical Biometrics, Department of Medical Computer Sciences, University of Vienna, Vienna.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(survival)
testdata &lt;- data.frame(list(start=c(1, 2, 5, 2, 1, 7, 3, 4, 8, 8),
stop =c(2, 3, 6, 7, 8, 9, 9, 9,14,17),
event=c(1, 1, 1, 1, 1, 1, 1, 0, 0, 0),
x1    =c(1, 0, 0, 1, 0, 1, 1, 1, 0, 0),
x2    =c(0, 1, 1, 1, 0, 0, 1, 0, 1, 0),
x3    =c(1, 0, 1, 0, 1, 0, 1, 0, 1, 0)))

summary( coxphf( formula=Surv(start, stop, event) ~ x1+x2+x3, data=testdata))

# testing H0: x1=0, x2=0

coxphftest( formula=Surv(start, stop, event) ~ x1+x2+x3, test=~x1+x2,  data=testdata)



# How to test total effect of a variable with time-dependent effect

# NOT RUN (works)
#fitt&lt;- coxphf( formula=Surv(start, stop, event) ~ x1+x2+x3*stop, data=testdata, pl=FALSE)

#test &lt;- coxphf(formula=Surv(start, stop, event) ~ x1+x2+x3*stop, data=testdata, adapt=c(1,1,0,0))

# PLR p-value for x3 + x3:stop
#pchisq((fitt$loglik[2]-test$loglik[2])*2, 2, lower.tail=FALSE)

#NOT RUN (does not work)
#test &lt;- coxphf(formula=Surv(start, stop, event) ~ x1+x2+x3*stop, data=testdata, test=~x3+stop:x3)


</code></pre>


</div>