<div class="container">

<table style="width: 100%;"><tr>
<td>Laplace</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Calculate Laplace's Marginal Density Approximation
</h2>

<h3>Description</h3>

<p>Calculates the Laplace approximation to the uni- and bivariate
marginal densities of components of the <abbr><span class="acronym">MLE</span></abbr> in a
regression-scale model.  The reference distribution is the
conditional distribution given the ancillary.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Laplace(which = stop("no choice made"), data = stop("data are missing"), 
        val1, idx1, val2, idx2, log.scale = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>

<p>the kind of marginal density that should be approximated.  
Possible choices are <code>c</code> (univariate: regression 
coefficient),
<code>s</code> (univariate: scale parameter), <code>cc</code> (bivariate: two 
regression coefficients) and <code>cs</code> (bivariate: regression 
coefficient and scale parameter).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>a special <em>conditional sampling</em> data object.  This object 
must be a list with the following elements:
</p>

<dl>
<dt><code>anc</code></dt>
<dd>
<p>the vector containing the values of the ancillary; usually the 
Pearson residuals.  It has to be of the same length than the 
number of observations in the linear regression model.  
</p>
</dd>
<dt><code>X</code></dt>
<dd>
<p>the model matrix.  It may be obtained applying 
<code>model.matrix</code> to the fitted <code>rsm</code> 
object of interest.  The number of observations has to be the
same than the dimension of the ancillary, and the number of 
covariates must correspond to the number of regression 
coefficients defined in the <code>coef</code> component.
</p>
</dd>
<dt><code>coef</code></dt>
<dd>
<p>the vector of <em>true</em> values of the regression coefficients,
that is, the values used in the simulation study.
</p>
</dd>
<dt><code>disp</code></dt>
<dd>
<p>the <em>true</em> value of the scale parameter used in the 
simulation study.
</p>
</dd>
<dt><code>family</code></dt>
<dd>
<p>a <code>family.rsm</code> object characterizing the error
distribution of the linear regression model.  The following
generator functions are available in the <code>marg</code> 
package of the <abbr><span class="acronym">R</span></abbr> package bundle <code>hoa</code>: 
<code>student</code> (Student's t), <code>extreme</code> (Gumbel or extreme 
value), <code>logistic</code>, <code>logWeibull</code>, 
<code>logExponential</code>, <code>logRayleigh</code> and <code>Huber</code> 
(Huber's least favourable).  The demonstration file 
‘<span class="file">margdemo.R</span>’ that accompanies the <code>marg</code> package shows
how to create a new generator function. 
</p>
</dd> 
<dt><code>fixed</code></dt>
<dd>
<p>a logical value.  If <code>TRUE</code> the scale parameter is known.
</p>
</dd>
</dl>
<p>The <code>make.sample.data</code> function can be used
to create this data object from a fitted <code>rsm</code> model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>val1</code></td>
<td>

<p>sequence of values for the first <abbr><span class="acronym">MLE</span></abbr> at which to 
calculate the density.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>idx1</code></td>
<td>

<p>index of the first regression coefficient, that is, its position 
in the vector <abbr><span class="acronym">MLE</span></abbr>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>val2 </code></td>
<td>

<p>sequence of values for the second <abbr><span class="acronym">MLE</span></abbr> at which to 
calculate the density.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>idx2</code></td>
<td>

<p>index of the second regression coefficient, that is, its position 
in the vector <abbr><span class="acronym">MLE</span></abbr>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.scale</code></td>
<td>

<p>logical value.  If <code>TRUE</code> the approximation is calculated on 
the log scale.  Highly recommended.  The default is <code>TRUE</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Laplace's integral approximation method is used in order to avoid
multi-dimensional numerical integration.  The uni- and bivariate
approximations to the marginal distributions give insight into how
the multivariate conditional distribution of the <abbr><span class="acronym">MLE</span></abbr>
vector is structured.  Methods are available to plot them.  They 
help in choosing a suitable candidate generation density to be used 
in the <code>rsm.sample</code> function.
</p>
<p>All information is supplied through the <code>data</code> argument.  Note 
that the user has to keep to the structure described above.  If a
conditional simulation is to be performed for a fitted <code>rsm</code> 
object, the <code>make.sample.data</code> function can be
used to generate this special object.  The logical switch 
<code>fixed</code> in the conditional sampling data object must be 
specified.
</p>


<h3>Value</h3>

<p>Returns a <code>Lapl.spl</code> or <code>Lapl.cont</code> object with the 
approximate uni- or bivariate conditional distribution of one or two
components of the <abbr><span class="acronym">MLE</span></abbr>.  
</p>


<h3>Demonstration</h3>

<p>The file ‘<span class="file">csamplingdemo.R</span>’ contains code that can be used to 
run a conditional simulation study similar to the one described 
in <cite>Brazzale (2000, Section 7.3)</cite> using the data given in 
Example 3 of <cite>DiCiccio, Field and Fraser (1990)</cite>.
</p>


<h3>References</h3>

<p>Brazzale, A. R. (2000) <em>Practical Small-Sample Parametric 
Inference</em>.  Ph.D. Thesis N. 2230, Department of Mathematics, Swiss 
Federal Institute of Technology Lausanne.
</p>
<p>DiCiccio, T. J., Field, C. A. and Fraser, D. A. S. (1990)  
Approximations of marginal tail probabilities and inference for 
scalar parameters. <em>Biometrika</em>, <b>77</b>, 77–95.	
</p>


<h3>See Also</h3>

<p><code>make.sample.data</code>, 
<code>rsm.sample</code>.
<code>family.rsm.object</code>, 
</p>


</div>