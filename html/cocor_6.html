<div class="container">

<table style="width: 100%;"><tr>
<td>cocor.dep.groups.nonoverlap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compare two nonoverlapping correlations based on dependent groups</h2>

<h3>Description</h3>

<p>Performs a test of significance for the difference between two correlations based on dependent groups (e.g.,
the same group). The two correlations are nonoverlapping, i.e.,
they have no variable in common. The function tests whether the correlations between <code>j</code> and <code>k</code> (<code>r.jk</code>) and between <code>h</code> and <code>m</code> (<code>r.hm</code>) differ in magnitude. Because the significance depends on the pairwise intercorrelations between all of the variables involved (<code>j</code>,
<code>k</code>, <code>h</code>, and <code>m</code>),
these intercorrelations have to be provided as additional parameters. The function expects correlation coefficients as input.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cocor.dep.groups.nonoverlap(
  r.jk,
  r.hm,
  r.jh,
  r.jm,
  r.kh,
  r.km,
  n,
  alternative = "two.sided",
  test = "all",
  alpha = 0.05,
  conf.level = 0.95,
  null.value = 0,
  data.name = NULL,
  var.labels = NULL,
  return.htest = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>r.jk</code></td>
<td>
<p>A number specifying the correlation between <code class="reqn">j</code> and <code class="reqn">k</code> (this correlation is used for comparison)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r.hm</code></td>
<td>
<p>A number specifying the correlation between <code class="reqn">h</code> and <code class="reqn">m</code> (this correlation is used for comparison)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r.jh</code></td>
<td>
<p>A number specifying the correlation between <code class="reqn">j</code> and <code class="reqn">h</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r.jm</code></td>
<td>
<p>A number specifying the correlation between <code class="reqn">j</code> and <code class="reqn">m</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r.kh</code></td>
<td>
<p>A number specifying the correlation between <code class="reqn">k</code> and <code class="reqn">h</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r.km</code></td>
<td>
<p>A number specifying the correlation between <code class="reqn">k</code> and <code class="reqn">m</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>An integer defining the size of the group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>A character string specifying whether the alternative hypothesis is two-sided ("<code>two.sided</code>"; default) or one-sided ("<code>greater</code>" or "<code>less</code>",
depending on the direction). Optionally,
the initial letter of the character strings ("<code>t</code>", "<code>g</code>", and "<code>l</code>)" can be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>A vector of character strings specifying the tests to be used (<code>pearson1898</code>,
<code>dunn1969</code>, <code>steiger1980</code>, <code>raghunathan1996</code>, <code>silver2004</code>,
or <code>zou2007</code>). Use <code>all</code> to apply all tests (default). For further information see the tests section below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>A number defining the alpha level for the hypothesis test. The default value is <code class="reqn">.05</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>A number defining the level of confidence for the confidence interval (if test <code>zou2007</code> is used). The default value is <code class="reqn">.95</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null.value</code></td>
<td>
<p>A number defining the hypothesized difference between the two correlations used for testing the null hypothesis. The default value is <code class="reqn">0</code>. If the value is other than <code class="reqn">0</code>,
only the test <code>zou2007</code> that uses a confidence interval is available.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p>A character string giving the name of the data/group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.labels</code></td>
<td>
<p>A vector of four character strings specifying the labels for j, k, h,
and m (in this order).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.htest</code></td>
<td>
<p>A logical indicating whether the result should be returned as a list containing a list of class 'htest' for each test. The default value is <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns an S4 object of class 'cocor.dep.groups.nonoverlap' with the following slots:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>r.jk</code></td>
<td>
<p>Input parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r.hm</code></td>
<td>
<p>Input parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r.jh</code></td>
<td>
<p>Input parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r.jm</code></td>
<td>
<p>Input parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r.kh</code></td>
<td>
<p>Input parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r.km</code></td>
<td>
<p>Input parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Input parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>Input parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Input parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>Input parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null.value</code></td>
<td>
<p>Input parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p>Input parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.labels</code></td>
<td>
<p>Input parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diff</code></td>
<td>
<p>Difference between the two correlations, r.jk and r.hm, that were compared</p>
</td>
</tr>
</table>
<p>For each test a slot of the same name exists with a list containing the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>The value of the test statistic (unless test <code>zou2007</code> is used).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distribution</code></td>
<td>
<p>The distribution of the test statistic (unless test <code>zou2007</code> is used).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>The p-value of the test (unless test <code>zou2007</code> is used).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.int</code></td>
<td>
<p>The confidence interval of the difference between the two correlations (if test <code>zou2007</code> is used).</p>
</td>
</tr>
</table>
<h3>Tests</h3>

<p>In the following,
<code class="reqn">r_{jk}</code> and <code class="reqn">r_{hm}</code> are the two correlations that are being compared; <code class="reqn">Z_{jk}</code> and <code class="reqn">Z_{hm}</code> are their <code class="reqn">Z</code> transformed equivalents.
<code class="reqn">r_{jh}</code>, <code class="reqn">r_{kh}</code>, <code class="reqn">r_{jm}</code>,
and <code class="reqn">r_{km}</code> are the related correlations that are also required.
<code class="reqn">n</code> specifies the size of the group the two correlations are based on.
Some tests make use of Fisher's <code class="reqn">r</code>-to-<code class="reqn">Z</code> transformation (1921, p. 26):
</p>
<p style="text-align: center;"><code class="reqn">Z = \frac{1}{2}(ln(1+r) - ln(1-r)).</code>
</p>


<dl>
<dt>pearson1898:</dt>
<dd>
<p><em>Pearson and Filon's (1898) z</em>
</p>
<p>This test was proposed by Pearson and Filon (1898, p. 262, formula xl).
The formula for the test statistic <code class="reqn">z</code> is computed as
</p>
<p style="text-align: center;"><code class="reqn">z = \frac{\sqrt{n} (r_{jk} - r_{hm})}{\sqrt{(1 - r_{jk}^2)^2 + (1 - r_{hm}^2)^2 - k}}</code>
</p>

<p>(Raghunathan, Rosenthal, and Rubin, 1996, p. 179, formula 1), where
</p>
<p style="text-align: center;"><code class="reqn">k = (r_{jh} - r_{jk} r_{kh}) (r_{km} - r_{kh} r_{hm}) + (r_{jm} - r_{jh} r_{hm}) (r_{kh} - r_{jk} r_{jh})</code>
</p>

<p style="text-align: center;"><code class="reqn">+ (r_{jh} - r_{jm} r_{hm}) (r_{km} - r_{jk} r_{jm}) + (r_{jm} - r_{jk} r_{km}) (r_{kh} - r_{km} r_{hm})</code>
</p>

<p>(Raghunathan et al. (1996, p. 179, formula 2).
The two formulae can also be found in Steiger (1980, p. 245, formula 2 and p. 246,
formula 5).
</p>
</dd>
<dt>dunn1969:</dt>
<dd>
<p><em>Dunn and Clark's (1969) z</em>
</p>
<p>The test statistic <code class="reqn">z</code> of this test is calculated as
</p>
<p style="text-align: center;"><code class="reqn">z = \frac{(Z_{jk} - Z_{hm})\sqrt{n - 3}}{\sqrt{2 - 2c}}</code>
</p>

<p>(Dunn and Clark, 1969, p. 370, formula 15), where
</p>
<p style="text-align: center;"><code class="reqn">c = \Bigl(\frac{1}{2} r_{jk} r_{hm} (r_{jh}^2 + r_{jm}^2 + r_{kh}^2 + r_{km}^2) + r_{jh} r_{km} + r_{jm} r_{kh}</code>
</p>

<p style="text-align: center;"><code class="reqn">- (r_{jk} r_{jh} r_{jm} + r_{jk} r_{kh} r_{km} + r_{jh} r_{kh} r_{hm} + r_{jm} r_{km} r_{hm})\Bigr)</code>
</p>

<p style="text-align: center;"><code class="reqn">\Big/ \Bigl((1 - r_{jk}^2)(1 - r_{hm}^2)\Bigr)</code>
</p>

<p>(Dunn and Clark, 1969, p. 368, formula 9).
</p>
</dd>
<dt>steiger1980:</dt>
<dd>
<p><em>Steiger's (1980) modification of Dunn and Clark's (1969) z using average correlations</em>
</p>
<p>This test was proposed by Steiger (1980) and is a modification of Dunn and Clark's (1969) <code class="reqn">z</code>.
Instead of <code class="reqn">r_{jk}</code> and <code class="reqn">r_{hm}</code> the mean of the two is being used.
The test statistic <code class="reqn">z</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">z = \frac{(Z_{jk} - Z_{hm})\sqrt{n - 3}}{\sqrt{2 - 2c}}</code>
</p>

<p>(Steiger, 1980, p. 247, formula 15), where
</p>
<p style="text-align: center;"><code class="reqn">\bar r = \frac{r_{jk} + r_{hm}}{2}</code>
</p>

<p>(Steiger, 1980, p. 247) and
</p>
<p style="text-align: center;"><code class="reqn">c = \frac{\frac{1}{2} \bar r^2 (r_{jh}^2 + r_{jm}^2 + r_{kh}^2 + r_{km}^2) + r_{jh} r_{km} + r_{jm} r_{kh} - (\bar r r_{jh} r_{jm} + \bar r r_{kh} r_{km} + r_{jh} r_{kh} \bar r + r_{jm} r_{km} \bar r)}{(1 - \bar r^2)^2}</code>
</p>

<p>(Steiger, 1980, p. 247, formula 11; in the original article,
there are brackets missing around the divisor).
</p>
</dd>
<dt>raghunathan1996:</dt>
<dd>
<p><em>Raghunathan, Rosenthal,
and Rubin's (1996) modification of Pearson and Filon's (1898) z</em>
</p>
<p>This test of Raghunathan, Rosenthal,
and Rubin (1996) is based on Pearson and Filon's (1898) <code class="reqn">z</code>.
Unlike Pearson and Filon (1898),
Raghunathan et al. (1996) use <code class="reqn">Z</code> transformed correlation coefficients.
The test statistic <code class="reqn">z</code> is computed as
</p>
<p style="text-align: center;"><code class="reqn">z = \sqrt{\frac{n - 3}{2}} \frac{Z_{jk} - Z_{hm}}{\sqrt{1 - \frac{k}{2(1 - r_{jk}^2)(1 - r_{hm}^2)}}}</code>
</p>

<p>(Raghunathan et al., 1996, p. 179, formula 3), where
</p>
<p style="text-align: center;"><code class="reqn">k = (r_{jh} - r_{jk} r_{kh}) (r_{km} - r_{kh} r_{hm}) + (r_{jm} - r_{jh} r_{hm}) (r_{kh} - r_{jk} r_{jh})</code>
</p>

<p style="text-align: center;"><code class="reqn">+ (r_{jh} - r_{jm} r_{hm}) (r_{km} - r_{jk} r_{jm}) + (r_{jm} - r_{jk} r_{km}) (r_{kh} - r_{km} r_{hm})</code>
</p>

<p>(Raghunathan et al., 1996, p. 179, formula 2).
</p>
</dd>
<dt>silver2004:</dt>
<dd>
<p><em>Silver, Hittner,
and May's (2004) modification of Dunn and Clark's (1969) z using a backtransformed average Fisher's (1921) Z procedure</em>
</p>
<p>The approach to backtransform averaged Fisher's (1921) <code class="reqn">Z</code>s was first proposed in Silver and Dunlap (1987) and was applied to the comparison of nonoverlapping correlations by Silver et al. (2004).
The test is based on Steiger's (1980) approach.
The formula of the test statistic <code class="reqn">z</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">z = \frac{(Z_{jk} - Z_{hm})\sqrt{n - 3}}{\sqrt{2 - 2c}}</code>
</p>

<p>(Silver et al., 2004, p. 55, formula 5), where
</p>
<p style="text-align: center;"><code class="reqn">c = \frac{\frac{1}{2} \bar r_z^2 (r_{jh}^2 + r_{jm}^2 + r_{kh}^2 + r_{km}^2) + r_{jh} r_{km} + r_{jm} r_{kh} - (\bar r_z r_{jh} r_{jm} + \bar r_z r_{kh} r_{km} + r_{jh} r_{kh} \bar r_z + r_{jm} r_{km} \bar r_z)}{(1 - \bar r_z^2)^2}</code>
</p>

<p>(Silver et al., 2004, p. 56),
</p>
<p style="text-align: center;"><code class="reqn">\bar r_z = \frac{exp(2\bar Z - 1)}{exp(2\bar Z + 1)}</code>
</p>

<p>(Silver and Dunlap, 1987, p. 146, formula 4), and
</p>
<p style="text-align: center;"><code class="reqn">\bar Z = \frac{Z_{jk} + Z_{hm}}{2}</code>
</p>

<p>(Silver et al., 2004, p. 55).
</p>
</dd>
<dt>zou2007:</dt>
<dd>
<p><em>Zou's (2007) confidence interval</em>
</p>
<p>This test calculates the confidence interval of the difference between the two correlations <code class="reqn">r_{jk}</code> and <code class="reqn">r_{hm}</code>.
If the confidence interval includes zero,
the null hypothesis that the two correlations are equal must be retained.
If the confidence interval does not include zero, the null hypothesis has to be rejected.
A lower and upper bound for the interval (<code class="reqn">L</code> and <code class="reqn">U</code>, respectively) is given by
</p>
<p style="text-align: center;"><code class="reqn">L = r_{jk} - r_{hm} - \sqrt{(r_{jk} - l_1)^2 + (u_2 - r_{hm})^2 - 2c(r_{jk} - l_1)(u_2 - r_{hm})}</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">U = r_{jk} - r_{hm} + \sqrt{(u_1 - r_{jk})^2 + (r_{hm} - l_2)^2 - 2c(u_1 - r_{jk})(r_{hm} - l_2)}</code>
</p>

<p>(Zou, 2007, pp. 409-410), where
</p>
<p style="text-align: center;"><code class="reqn">l = \frac{exp(2l') - 1}{exp(2l') + 1},</code>
</p>

<p style="text-align: center;"><code class="reqn">u = \frac{exp(2u') - 1}{exp(2u') + 1}</code>
</p>

<p>(Zou, 2007, p. 406),
</p>
<p style="text-align: center;"><code class="reqn">c = \Bigl(\frac{1}{2} r_{jk} r_{hm} (r_{jh}^2 + r_{jm}^2 + r_{kh}^2 + r_{km}^2) + r_{jh} r_{km} + r_{jm} r_{kh}</code>
</p>

<p style="text-align: center;"><code class="reqn">- (r_{jk} r_{jh} r_{jm} + r_{jk} r_{kh} r_{km} + r_{jh} r_{kh} r_{hm} + r_{jm} r_{km} r_{hm})\Bigr)</code>
</p>

<p style="text-align: center;"><code class="reqn">\Big/ \Bigl((1 - r_{jk}^2)(1 - r_{hm}^2)\Bigr)</code>
</p>

<p>(Zou, 2007, p. 409), and
</p>
<p style="text-align: center;"><code class="reqn">l',u' = Z \pm z_{\frac{\alpha}{2}} \sqrt{\frac{1}{n - 3}}</code>
</p>

<p>(Zou, 2007, p. 406).
<code class="reqn">\alpha</code> denotes the desired alpha level of the confidence interval.
</p>
</dd>
</dl>
<h3>References</h3>

<p>Dunn, O. J., &amp; Clark,
V. A. (1969). Correlation coefficients measured on the same individuals. <em>Journal of the American Statistical Association</em>, <em>64</em>,
366-377. doi:10.2307/2283746
</p>
<p>Pearson, K., &amp; Filon,
L. N. G. (1898). Mathematical contributions to theory of evolution: IV. On the probable errors of frequency constants and on the influence of random selection and correlation. <em>Philosophical Transactions of the Royal Society of London,
Series A</em>, <em>191</em>, 229-311. doi:10.1098/rsta.1898.0007
</p>
<p>Raghunathan, T. E., Rosenthal, R., &amp; Rubin, D. B.,
(1996). Comparing correlated but nonoverlapping correlations. <em>Psychological Methods</em>, <em>1</em>,
178-183. doi:10.1037//1082-989X.1.2.178
</p>
<p>Silver, N. C., &amp; Dunlap,
W. P. (1987). Averaging correlation coefficients: Should Fisher's Z transformation be used? <em>Journal of Applied Psychology</em>, <em>72</em>,
146-148. doi:10.1037//0021-9010.72.1.146
</p>
<p>Silver, N. C., Hittner, J. B., &amp; May,
K. (2004). Testing dependent correlations with nonoverlapping variables: A Monte Carlo simulation. <em>Journal of Experimental Education</em>,
<em>73</em>, 53-69. doi:10.3200/JEXE.71.1.53-70
</p>
<p>Steiger,
J. H. (1980). Tests for comparing elements of a correlation matrix. <em>Psychological Bulletin</em>, <em>87</em>, 245-251. doi:10.1037//0033-2909.87.2.245
</p>
<p>Zou,
G. Y. (2007). Toward using confidence intervals to compare correlations. <em>Psychological Methods</em>, <em>12</em>, 399-413. doi:10.1037/1082-989X.12.4.399
</p>


<h3>See Also</h3>

<p>cocor, cocor.indep.groups, cocor.dep.groups.overlap, as.htest
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Compare the difference between the correlations (age, intelligence) and
# body mass (index, shoe size) measured in the same group (all values are fictional):
r.jk &lt;- .2  # Correlation (age, intelligence)
r.hm &lt;- .7  # Correlation (body mass index, shoe size)
r.jh &lt;- .4  # Correlation (age, body mass index)
r.jm &lt;- .5  # Correlation (age, shoe size)
r.kh &lt;- .1  # Correlation (intelligence, body mass index)
r.km &lt;- .3  # Correlation (intelligence, shoe size)
n &lt;- 232  # Size of the group

cocor.dep.groups.nonoverlap(r.jk, r.hm, r.jh, r.jm, r.kh, r.km, n,
var.labels=c("age", "intelligence", "body mass index", "shoe size"))

</code></pre>


</div>