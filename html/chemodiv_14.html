<div class="container">

<table style="width: 100%;"><tr>
<td>compDis</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate compound dissimilarities</h2>

<h3>Description</h3>

<p>Function to quantify dissimilarities between phytochemical compounds.
</p>


<h3>Usage</h3>

<pre><code class="language-R">compDis(
  compoundData,
  type = "PubChemFingerprint",
  npcTable = NULL,
  unknownCompoundsMean = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>compoundData</code></td>
<td>
<p>Data frame with the chemical compounds of interest,
usually the compounds found in the sample dataset.
Should have a column named "compound" with common names of
the compounds, a column named "smiles" with SMILES IDs of the compounds,
and a column named "inchikey" with the InChIKey IDs for the compounds.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Type of data compound dissimilarity calculations will be
based on: <code>NPClassifier</code>, <code>PubChemFingerprint</code> or <code>fMCS</code>.
If more than one is chosen, a matrix with mean values of the other
matrices will also calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npcTable</code></td>
<td>
<p>A data frame already generated by <code>NPCTable</code>
can optionally be supplied, if compound dissimilarities are to be
calculated using <code>type = "NPClassifier"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unknownCompoundsMean</code></td>
<td>
<p>If unknown compounds, i.e. ones without SMILES
or InChIKey, should be given mean dissimilarity values. If not, these
will have dissimilarity 1 to all other compounds.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function calculates matrices with pairwise dissimilarities between
the chemical compounds in <code>compoundData</code>, to quantify how
different the molecules are to each other. It does so in three
different ways, based on the biosynthetic classification or
molecular structure of the molecules:
</p>

<ol>
<li>
<p> Using the classification from the <em>NPClassifier</em> tool,
<code>type = "NPClassifier"</code>. <em>NPClassifier</em> (Kim et al. 2021) is a
deep-learning tool that automatically classifies natural products
(i.e. phytochemical compounds) into a hierarchical classification of
three levels: pathway, superclass and class. This classification largely
corresponds to the biosynthetic groups/pathways the compounds
are produced in. Classifications are downloaded from
<a href="https://npclassifier.ucsd.edu/">https://npclassifier.ucsd.edu/</a>. <em>NPClassifier</em> does not always
manage to classify every compound into all three hierarchical levels. In
such cases, it might be beneficial to first run <code>NPCTable</code>,
manually edit the resulting data frame with probable classifications if
possible (with help from the Supporting Information in Kim et al. 2021),
and then supply this classification to the <code>compDis</code> function
with the <code>npcTable</code> argument. This will ensure that compound
dissimilarities are computed optimally.
</p>
</li>
<li>
<p> Using PubChem Fingerprints, <code>type = "PubChemFingerprint"</code>.
This is a binary substructure fingerprint with 881 binary
variables describing the chemical structure of a compound.
With this method, compounds are therefore compared
based on how structurally dissimilar the molecules are.
See <a href="https://pubchem.ncbi.nlm.nih.gov/docs/data-specification">https://pubchem.ncbi.nlm.nih.gov/docs/data-specification</a>
for more information. (There are many other types of fingerprints,
and ways of calculating compound dissimilarities based on them, see
e.g. packages <code>fingerprint</code> and <code>rcdk</code>). Fingerprint data for
molecules is downloaded from PubChem. In association with this,
there might be a Warning message about closing unused connections,
which is not important.
</p>
</li>
<li>
<p> fMCS, flexible Maximum Common Substructure,
<code>type = "fMCS"</code>. This is a pairwise graph matching concept.
The fMCS of two compounds is the largest substructure that occurs in both
compounds allowing for atom and/or bond mismatches (Wang et al 2013).
As with the fingerprints, compounds are compared based on how
structurally dissimilar the molecules are. While potentially a very
accurate similarity measure, fMCS is much more computationally demanding
than the other methods, and will take a significant amount of time for
larger data sets. Data on molecules is downloaded from PubChem.
In association with this, there might be a Warning message about closing
unused connections, which is not important.
</p>
</li>
</ol>
<p>Dissimilarities using NPClassifier and PubChem Fingerprints
are generated by calculating Jaccard (Tanimoto) dissimilarities from a
0/1 table with compounds as rows and group (NPClassifier) or binary
fingerprint variable (PubChem Fingerprints) as columns. fMCS generates
dissimilarity values by calculating Jaccard dissimilarities based on the
number of atoms in the maximum common substructure, allowing for one
atom and one bond mismatch. Dissimilarities are outputted as
dissimilarity matrices.
</p>
<p>If dissimilarities are calculated with more than one method,
the function will output additional dissimilarity matrices.
This always includes a matrix with the mean dissimilarity values of the
selected methods. If <code>"NPClassifier"</code> is included in <code>type</code>,
a matrix of "mix" values is also calculated. The values in this matrix
are the dissimilarities from NPClassifier when these are &gt; 0.
For pairs of compounds where dissimilarities from NPClassifier
equals 0 (i.e. when the compounds belong to the same pathway, superclass
and class), values are equal to half of the (mean) value(s) of the
structural dissimilarity/-ies from PubChem Fingerprints and/or fMCS.
With this method, compound dissimilarities are primarily based on
NPClassifier, but instead of compounds with identical classification having
0 dissimilarity, these have a dissimilarity based on PubChem Fingerprints
and/or fMCS, scaled to always be less (&lt; 0.5) than compounds being in the
same pathway and superclass, but different class.
</p>
<p>If there are unknown compounds, which do not have a
corresponding SMILES or InChIKey, this can be handled in three
different ways. First, these can be completely removed from the list
of compounds and the sample data set, and hence excluded from all analyses.
Second, if <code>unknownCompoundsMean = FALSE</code>, unknown compounds will
be given a dissimilarity value of 1 to all other compounds. Third, if
<code>unknownCompoundsMean = TRUE</code>, unknown compounds will be given
a dissimilarity value to all other compounds which equals the mean
dissimilarity value between all known compounds. See <code>chemodiv</code>
for alternative methods that can be used when most or all compounds
are unknown.
</p>


<h3>Value</h3>

<p>List with compound dissimilarity matrices. A list is always
outputted, even if only one matrix is calculated. Downstream functions,
including <code>calcDiv</code>, <code>calcBetaDiv</code>,
<code>calcDivProf</code>, <code>sampDis</code>, <code>molNet</code>
and <code>chemoDivPlot</code> require only the matrix as
input (e.g. as <code>fullList$specificMatrix</code>) rather than the whole list.
</p>


<h3>References</h3>

<p>Kim HW, Wang M, Leber CA, Nothias L-F, Reher R, Kang KB,
van der Hooft JJJ, Dorrestein PC, Gerwick WH, Cottrell GW. 2021.
NPClassifier: A Deep Neural Network-Based Structural Classification
Tool for Natural Products. Journal of Natural Products 84: 2795-2807.
</p>
<p>Wang Y, Backman TWH, Horan K, Girke T. 2013.
fmcsR: mismatch tolerant maximum common substructure searching in R.
Bioinformatics 29: 2792-2794.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(minimalCompData)
data(minimalNPCTable)
compDis(minimalCompData, type = "NPClassifier",
npcTable = minimalNPCTable) # Dissimilarity based on NPClassifier

## Not run: compDis(minimalCompData) # Dissimilarity based on Fingerprints

data(alpinaCompData)
data(alpinaNPCTable)
compDis(compoundData = alpinaCompData, type = "NPClassifier",
npcTable = alpinaNPCTable) # Dissimilarity based on NPClassifier
</code></pre>


</div>