<div class="container">

<table style="width: 100%;"><tr>
<td>p.perm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Permutation test for the significance of canonical correlation coefficients </h2>

<h3>Description</h3>

<p>This function runs a permutation test to assign the statistical significance 
of canonical correlation coefficients.
Wilks' Lambda, the Hotelling-Lawley Trace, the Pillai-Bartlett Trace, 
or of Roy's Largest Root can be used as a test statistic.
</p>


<h3>Usage</h3>

<pre><code class="language-R">p.perm(X, Y, nboot = 999, rhostart = 1, type = "Wilks")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p> array containing the independent variables, with <code class="reqn">N</code> rows (number of observations) and <code class="reqn">p</code> columns (number of independent variables). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p> array containing the dependent variables, with <code class="reqn">N</code> rows (number of observations) and <code class="reqn">q</code> columns (number of dependent variables). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nboot</code></td>
<td>
<p> number of permutation resamples calculated. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rhostart</code></td>
<td>
<p> index of the largest canonical correlation coefficient included in the calculation of the test statistic (see <code class="reqn">Details</code>). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p> test statistic to be used. One of "Wilks" (default), "Hotelling", "Pillai", or "Roy". </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Permutation tests are based on resampling of the original data without replacement. To test the hypothesis of no correlation
between two sets (X, Y) of variables, the values of one variable (Y) are randomly reassigned. Permutation tests do not require
specific population distributions of the variables such as normal distribution. 
Canonical correlation analysis (CCA) calculates <code class="reqn">m = min(p,q)</code> correlation coefficients, see <code>p.asym</code>.
The coefficients are arranged in descending order of magnitude: <code class="reqn">rho[1] &gt; rho[2] &gt; rho[3] &gt; ... &gt; rho[m]</code>.
In <code>p.perm</code>, the parameter <code class="reqn">rhostart</code> determines how many correlation coefficients are included in the calculation
of the test statistic: 
choosing <code class="reqn">rhostart=1</code>, all canonical correlations are included, 
choosing <code class="reqn">rhostart=2</code>, the biggest canonical correlation (<code class="reqn">rho[1]</code>) is excluded,
choosing <code class="reqn">rhostart=3</code>, both <code class="reqn">rho[1]</code> and <code class="reqn">rho[2]</code> are excluded, etc.
On principle, Roy's Largest Root takes only <code class="reqn">rho[1]</code> into account, hence only <code class="reqn">rhostart=1</code> can be chosen. 
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>stat0</code></td>
<td>
<p>original value of the statistic (without resampling).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stat</code></td>
<td>
<p><code class="reqn">nboot</code> values of the statistic, one for each permutation resampling.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nexcess</code></td>
<td>
<p>number of permutation resamplings that resulted in a more extreme value of the statistic than <code class="reqn">stat0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>p-value, derived from <code class="reqn">nexcess</code>.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p> Permutation tests do not require a specific distribution of the variables.  
Tests based on random resampling do generally not yield the same results when repeated.
The canonical correlation coefficients are statistically significant
if Wilks' Lambda is <em>smaller</em> than a critical value.
</p>


<h3>Author(s)</h3>

<p> Uwe Menzel  &lt;uwemenzel@gmail.com&gt;</p>


<h3>References</h3>

<p>Efron, B. and Tibshirani, R. J. (1994)
<em>An Introduction to the Bootstrap</em>,
Chapman &amp; Hall, New York.
</p>
<p>Moore, D. S. amd McCabe, G. P. (2006)
<em>Introduction to the Practice of Statistics, Chapter 14</em>, 
W. H. Freeman, New York.
</p>


<h3>See Also</h3>

<p> See the function <code>cancor</code> or the <code>CCA</code> package for the calculation of canonical correlation coefficients. </p>


<h3>Examples</h3>

<pre><code class="language-R">
## Load the CCP package:
library(CCP)


## Simulate example data:
X &lt;- matrix(rnorm(150), 50, 3)
Y &lt;- matrix(rnorm(250), 50, 5)



## Run permutation test using Wilks Lambda (default) as test statistic; 
## include different numbers of canonical correlations:
p.perm(X, Y, nboot = 999, rhostart = 1)
p.perm(X, Y, nboot = 999, rhostart = 2)
p.perm(X, Y, nboot = 999, rhostart = 3)


## Run permutation tests based on different test statistics:
p.perm(X, Y, nboot = 999, rhostart = 1, type = "Wilks")        
p.perm(X, Y, nboot = 999, rhostart = 1, type = "Hotelling")
p.perm(X, Y, nboot = 999, rhostart = 1, type = "Pillai")
p.perm(X, Y, nboot = 999, rhostart = 1, type = "Roy")

## Plot the permutation distribution
## with the value of the original statistic marked:
out &lt;- p.perm(X, Y, nboot = 999, rhostart = 3, type = "Hotelling")
plt.perm(out)
</code></pre>


</div>