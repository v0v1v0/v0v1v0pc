<div class="container">

<table style="width: 100%;"><tr>
<td>plot_rp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Plot a recurrence matrix 
</h2>

<h3>Description</h3>

<p>Given a recurrence plot object (RP) returned from the function  <code>crqa()</code>, 
visualize it.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_rp(rp_matrix,
        title = "",
        xlabel = "Time",
        ylabel = "Time",
        pcolour = "black",
        geom = c("tile", "point", "void"),
        flip_y = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>rp_matrix</code></td>
<td>
<p>A recurrence plot sparse matrix from <code>crqa()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>Main title of the plot (character). Default: <code>""</code> (empty)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlabel</code></td>
<td>
<p>The x-axis label (character). Default: <code>"Time"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylabel</code></td>
<td>
<p>The y-axis label (character). Default: <code>"Time"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pcolour</code></td>
<td>
<p>The colour used for points in the plot (character). Default: <code>"black"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>geom</code></td>
<td>
<p>The ggplot2 geom used to draw the points (character).
One of: <code>"tile"</code>, <code>"point"</code> or <code>"void"</code>.
The default value, <code>"tile"</code>, uses (<code>geom_tile()</code> to plot 
the points.
The value <code>"point"</code> uses <code>geom_point()</code> to plot the points, and
the value <code>"void"</code> produces a plot without any geom, so users can
add their own for a more costumized plot (see examples below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flip_y</code></td>
<td>
<p>Logical argument controlling whether to flip the directionality of
the y axis (logical). Default: <code>FALSE</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The argument <code>geom</code> is a character denoting what type of ggplot2 geom is
used to plot the points in the recurrence plot. Allowed values are 
<code>"tile", "point"</code> and <code>"void"</code>. The latter produces an empty plot, 
so the user is required to add their own geom to the output. See example below.
</p>


<h3>Value</h3>

<p>A ggplot2 plot.
</p>


<h3>Author(s)</h3>

<p>MÃ¸nster, D. <a href="mailto:danm@econ.au.dk">danm@econ.au.dk</a>
</p>


<h3>See Also</h3>

<p>This plotting solution as substituted what was previously <code>plotRP()</code> 
available till version crqa.2.0.5
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Here is a very short example based on these two time series
ts_1 &lt;-  c(0, 0, 1, 1, 0, 0, 2, 2, 1, 1)
ts_2 &lt;-  c(1, 1, 2, 2, 0, 0, 1, 2, 2, 1)

# Create the cross recurrence matrix
short_rec &lt;-  crqa(ts_1, ts_2, 
                   delay = 1, embed = 1, radius = 0.001,
                   rescale = 1, method = "crqa")

# Extract the cross recurrence matrix
small_rp &lt;-  short_rec$RP

# Make a cross recurrence plot with blue tiles
plot_rp(small_rp, pcolour  = "blue", geom = "tile")

# Make a cross recurrenbce plot with blue points
plot_rp(small_rp, pcolour  = "blue", geom = "point")

## Uncomment below if you want to have more example. Not runnable because
## of CRAN, globally unavailable function plus timing constraint to check vignette.

# Neither of the two plots above may be suitable
# Using geom = "void" we can add a custumized geom, here blue tiles
# that are smaller than the default width and height
# plot_rp(small_rp, geom = "void") +
#  geom_tile(fill = "blue", height = 0.75, width = 0.75)

# Another custom geom uses tiles with a border colour
# plot_rp(small_rp, geom = "void") +
#  geom_tile(fill = "blue", colour = "pink", linewidth = 1)

# Use the eyemovement dataset to create a cross-recurrence plot
# large_crqa &lt;- crqa(eyemovement$narrator, eyemovement$listener,
#                delay = 1, embed = 1, radius = 0.001,
#                method = "crqa", metric = "euclidean", datatype = "continuous")

# Extract the recurrence matrix from the result
# large_rp &lt;- large_crqa$RP

# Create a recurrence plot using defaults
# plot_rp(large_rp)

# The same recurrence plot with flipped y axis and using geom_point()
# plot_rp(large_rp, flip_y = TRUE, geom = "point", title = "Flipped y axis") 

# Add axes labels, a title and extra plot elements
# Note that we can add to the output, here added the line of synchonization
# using ggplot2's geom_abline() function.
# plot_rp(large_rp, 
#        xlabel = "Narrator",
#        ylabel = "Listener",
#        title = "Coloured tiles with line of synchronization",
#        pcolour = "blue") +
#  geom_abline(intercept = 0, slope = 1)

</code></pre>


</div>