<div class="container">

<table style="width: 100%;"><tr>
<td>rcggm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate Data from a Conditional Gaussian Graphical Model with Censored and/or Missing Values</h2>

<h3>Description</h3>

<p>‘<code>rcggm</code>’ function is used to produce one or more samples from a conditional Gaussian graphical model with censored and/or missing values.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rcggm(n, p, b0, X, B, Sigma, probl, probr, probna, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>the number of samples required (optional, see below for a description).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>the number of response variables (optional, see below for a description).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b0</code></td>
<td>
<p>a vector of length <code>p</code> used to specify the intercepts. Default is a zero vector of length <code>p</code> (optional, see below for a description).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a matrix of dimension <code class="reqn">n\times q</code> used to model the expected values of the response variables (optional, see below for a description).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>a matrix of dimension <code class="reqn">q\times p</code> used to specify the regression coefficients. If <code>X</code> is missing then <code>B</code> is set equal to <code>NULL</code> (optional, see below for a description).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>a positive-definite symmetric matrix specifying the covariance matrix of the response variables. Default is the identity matrix (optional, see below for a description).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probl</code></td>
<td>
<p>a vector giving the probabilities that the response variables are left-censored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probr</code></td>
<td>
<p>a vector giving the probabilities that the response variables are right-censored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probna</code></td>
<td>
<p>the probability that a response value is missing-at-random. By default ‘<code>probna</code>’ is set equal to zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to the function ‘<code>mvrnorm</code>’.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>‘The <code>rcggm</code>’ function simulates a dataset from a conditional Gaussian graphical model with censored or missing values and returns an object of class ‘<code>datacggm</code>’. Censoring values are implicitly specified using arguments <code>probl</code> and <code>probr</code>, that is, <code>lo</code> and <code>up</code> are computed in such a way that the average probabilities of left and right censoring are equal to <code>probl</code> and <code>probr</code>, respectively. Missing-at-random values are simulated using a Bernoulli distribution with probability <code>probna</code>.
</p>
<p>The dataset is simulated through the following steps:
</p>

<ol>
<li>
<p> lower and upper censoring values (<code>lo</code> and <code>up</code>) are computed according to the arguments <code>probl</code> and <code>probr</code>;
</p>
</li>
<li>
<p> The function <code>mvrnorm</code> is used to simulate one or more samples from the multivariate Gaussian distribution specified by the arguments <code>b0</code>, <code>X</code>, <code>B</code> and <code>Sigma</code>;
</p>
</li>
<li>
<p> The response values that are outside of the interval <code>[lo, up]</code> are replaced with the corresponding censoring values;
</p>
</li>
<li>
<p> if <code>probna</code> is greater than zero, then missing-at-random values are simulated using a Bernoulli distribution with probability <code>probna</code>.
</p>
</li>
</ol>
<table>
<tr>
<td style="text-align: center;">
Model </td>
<td style="text-align: center;"> <code>n</code> </td>
<td style="text-align: center;"> <code>p</code> </td>
<td style="text-align: center;"> <code>b0</code> </td>
<td style="text-align: center;"> <code>X</code> </td>
<td style="text-align: center;"> <code>B</code> </td>
<td style="text-align: center;"> <code>Sigma</code> </td>
<td style="text-align: left;"> Gaussian distribution </td>
</tr>
<tr>
<td style="text-align: center;">
1 </td>
<td style="text-align: center;"> <code>x</code> </td>
<td style="text-align: center;"> <code>x</code> </td>
<td style="text-align: center;">           </td>
<td style="text-align: center;">          </td>
<td style="text-align: center;">          </td>
<td style="text-align: center;">              </td>
<td style="text-align: left;"> <code class="reqn">Y\sim N(0, I)</code> </td>
</tr>
<tr>
<td style="text-align: center;">
2 </td>
<td style="text-align: center;"> <code>x</code> </td>
<td style="text-align: center;">          </td>
<td style="text-align: center;">           </td>
<td style="text-align: center;">          </td>
<td style="text-align: center;">          </td>
<td style="text-align: center;"> <code>x</code>     </td>
<td style="text-align: left;"> <code class="reqn">Y\sim N(0, \Sigma)</code> </td>
</tr>
<tr>
<td style="text-align: center;">
3 </td>
<td style="text-align: center;"> <code>x</code> </td>
<td style="text-align: center;">          </td>
<td style="text-align: center;"> <code>x</code>  </td>
<td style="text-align: center;">          </td>
<td style="text-align: center;">          </td>
<td style="text-align: center;">              </td>
<td style="text-align: left;"> <code class="reqn">Y\sim N(b0, I)</code> </td>
</tr>
<tr>
<td style="text-align: center;">
4 </td>
<td style="text-align: center;"> <code>x</code> </td>
<td style="text-align: center;">          </td>
<td style="text-align: center;"> <code>x</code>  </td>
<td style="text-align: center;">          </td>
<td style="text-align: center;">          </td>
<td style="text-align: center;"> <code>x</code>     </td>
<td style="text-align: left;"> <code class="reqn">Y\sim N(b0, \Sigma)</code> </td>
</tr>
<tr>
<td style="text-align: center;">
5 </td>
<td style="text-align: center;">          </td>
<td style="text-align: center;">          </td>
<td style="text-align: center;">           </td>
<td style="text-align: center;">
<code>x</code>  </td>
<td style="text-align: center;"> <code>x</code> </td>
<td style="text-align: center;">              </td>
<td style="text-align: left;"> <code class="reqn">Y\sim N(XB, I)</code> </td>
</tr>
<tr>
<td style="text-align: center;">
6 </td>
<td style="text-align: center;">          </td>
<td style="text-align: center;">          </td>
<td style="text-align: center;">           </td>
<td style="text-align: center;">
<code>x</code>  </td>
<td style="text-align: center;"> <code>x</code> </td>
<td style="text-align: center;"> <code>x</code>     </td>
<td style="text-align: left;"> <code class="reqn">Y\sim N(XB, \Sigma)</code> </td>
</tr>
<tr>
<td style="text-align: center;">
7 </td>
<td style="text-align: center;">          </td>
<td style="text-align: center;">          </td>
<td style="text-align: center;"> <code>x</code>  </td>
<td style="text-align: center;">
<code>x</code>  </td>
<td style="text-align: center;"> <code>x</code> </td>
<td style="text-align: center;">              </td>
<td style="text-align: left;"> <code class="reqn">Y\sim N(b0 + XB, I)</code> </td>
</tr>
<tr>
<td style="text-align: center;">
8 </td>
<td style="text-align: center;">          </td>
<td style="text-align: center;">          </td>
<td style="text-align: center;"> <code>x</code>  </td>
<td style="text-align: center;">
<code>x</code>  </td>
<td style="text-align: center;"> <code>x</code> </td>
<td style="text-align: center;"> <code>x</code>     </td>
<td style="text-align: left;"> <code class="reqn">Y\sim N(b0 + XB, \Sigma)</code>
</td>
</tr>
</table>
<p>The previous table sums up the default setting of the multivariate Gaussian distribution used in step 2 (specified arguments are marked by the symbol ‘<code>x</code>’). See also below for some examples.
</p>


<h3>Value</h3>

<p><code>rcggm</code> returns an object of class ‘<code>datacggm</code>’. See <code>datacggm</code> for further details.
</p>


<h3>Author(s)</h3>

<p>Luigi Augugliaro (<a href="mailto:luigi.augugliaro@unipa.it">luigi.augugliaro@unipa.it</a>)</p>


<h3>References</h3>

<p>Augugliaro L., Sottile G., Wit E.C., and Vinciotti V. (2023) &lt;<a href="https://doi.org/10.18637/jss.v105.i01">doi:10.18637/jss.v105.i01</a>&gt;.
cglasso: An R Package for Conditional Graphical Lasso Inference with Censored and Missing Values.
<em>Journal of Statistical Software</em> <b>105</b>(1), 1–58.
</p>
<p>Augugliaro, L., Sottile, G., and Vinciotti, V. (2020a) &lt;<a href="https://doi.org/10.1007/s11222-020-09945-7">doi:10.1007/s11222-020-09945-7</a>&gt;.
The conditional censored graphical lasso estimator.
<em>Statistics and Computing</em> <b>30</b>, 1273–1289.
</p>
<p>Augugliaro, L., Abbruzzo, A., and Vinciotti, V. (2020b) &lt;<a href="https://doi.org/10.1093/biostatistics/kxy043">doi:10.1093/biostatistics/kxy043</a>&gt;.
<code class="reqn">\ell_1</code>-Penalized censored Gaussian graphical model.
<em>Biostatistics</em> <b>21</b>, e1–e16.</p>


<h3>See Also</h3>

<p><code>datacggm</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(123)

n &lt;- 100
p &lt;- 3
q &lt;- 2
b0 &lt;- rep(1, p)
X &lt;- matrix(rnorm(n * q), n, q)
B &lt;- matrix(rnorm(q * p), q, p)
Sigma &lt;- outer(1:p, 1:p, function(i, j) 0.3^abs(i - j))
probl &lt;- 0.05
probr &lt;- 0.05
probna &lt;- 0.05

# Model 1: Y ~ N(0, I)
Z &lt;- rcggm(n = n, p = p, probl = probl, probr = probr, probna = probna)
summary(Z)

# Model 2: Y ~ N(0, Sigma)
Z &lt;- rcggm(n = n, Sigma = Sigma, probl = probl, probr = probr, probna = probna)
summary(Z)

# Model 3: Y ~ N(b0, I)
Z &lt;- rcggm(n = n, b0 = b0, probl = probl, probr = probr, probna = probna)
summary(Z)

# Model 4: Y ~ N(b0, Sigma)
Z &lt;- rcggm(n = n, b0 = b0, Sigma = Sigma, probl = probl, probr = probr, 
           probna = probna)
summary(Z)

# Model 5: Y ~ N(XB, I)
Z &lt;- rcggm(X = X, B = B, probl = probl, probr = probr, probna = probna)
summary(Z)

# Model 6: Y ~ N(XB, Sigma)
Z &lt;- rcggm(X = X, B = B, Sigma = Sigma, probl = probl, probr = probr, 
           probna = probna)
summary(Z)

# Model 7: Y ~ N(b0 + XB, I)
Z &lt;- rcggm(b0 = b0, X = X, B = B, probl = probl, probr = probr, probna = probna)
summary(Z)

# Model 8: Y ~ N(b0 + XB, Sigma)
Z &lt;- rcggm(b0 = b0, X = X, B = B, Sigma = Sigma, probl = probl, probr = probr, 
           probna = probna)
summary(Z)
</code></pre>


</div>