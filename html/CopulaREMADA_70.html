<div class="container">

<table style="width: 100%;"><tr>
<td>rCopulaREMADA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Simulation from copula mixed models for diagnostic test accuaracy studies
</h2>

<h3>Description</h3>

<p>To simulate the data we have used the following steps:
</p>
<p>1. Simulate the study size <code class="reqn">n</code> from a shifted gamma distribution with parameters <code class="reqn">\alpha=1.2,\beta=0.01,lag=30</code> and round off to the nearest integer. 
</p>
<p>2. Simulate <code class="reqn">(u_1,u_2)</code> from a parametric family of copulas 'cop'.  
</p>
<p>3. Convert to beta realizations  or normal realizations. 
</p>
<p>4. Draw the number of diseased <code class="reqn">n_1</code> from a <code class="reqn">B(n,0.43)</code> distribution.
</p>
<p>5. Set  <code class="reqn">n_2=n-n_1, y_j=n_jx_j</code> and then round <code class="reqn">y_j</code> for <code class="reqn">j=1,2</code>. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">rCopulaREMADA.norm(N,p,si,tau,rcop,tau2par)
rCopulaREMADA.beta(N,p,g,tau,rcop,tau2par) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>sample size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Pair <code class="reqn">(\pi_1,\pi_2)</code> of sensitivity/specificity</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>si</code></td>
<td>
<p>Pair <code class="reqn">(\sigma_1,\sigma_2)</code> of variability; normal margins</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>Pair <code class="reqn">(\gamma_1,\gamma_2)</code> of variability; beta margins</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>Kendall's tau value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rcop</code></td>
<td>
<p>function for copula generation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau2par</code></td>
<td>
<p>function for mapping from Kendall's tau to copula parameter </p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the following simulated components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>TP</code></td>
<td>
<p>the number of true positives</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FN</code></td>
<td>
<p>the number of false negatives</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FP</code></td>
<td>
<p>the number of false positives</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TN</code></td>
<td>
<p>the number of true negatives</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Nikoloulopoulos, A.K.  (2015) A mixed effect model for bivariate meta-analysis of diagnostic test accuracy studies using a copula representation of the random effects distribution. <em>Statistics in Medicine</em>, <b>34</b>, 3842â€“3865. <a href="https://doi.org/10.1002/sim.6595">doi:10.1002/sim.6595</a>.
</p>


<h3>See Also</h3>

<p><code>CopulaREMADA</code> <code>rcop</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">nq=15
gl=gauss.quad.prob(nq,"uniform")
mgrid&lt;- meshgrid(gl$n,gl$n)

N=20
tau=-0.5
p=c(0.7,0.9)
g=c(0.2,0.1)
simDat=rCopulaREMADA.beta(N,p,g,tau,rcln270,tau2par.cln270)
TP=simDat$TP
TN=simDat$TN
FP=simDat$FP
FN=simDat$FN
c270est.b=CopulaREMADA.beta(TP,FN,FP,TN,gl,mgrid,qcondcln270,tau2par.cln270)

si=c(2,1)
tau=0.5
simDat=rCopulaREMADA.norm(N,p,si,tau,rcln,tau2par.cln)
TP=simDat$TP
TN=simDat$TN
FP=simDat$FP
FN=simDat$FN
cest.n=CopulaREMADA.norm(TP,FN,FP,TN,gl,mgrid,qcondcln,tau2par.cln)
</code></pre>


</div>