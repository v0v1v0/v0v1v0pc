<div class="container">

<table style="width: 100%;"><tr>
<td>KLR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Kernel Logistic Regression</h2>

<h3>Description</h3>

<p>The function performs a kernel logistic regression for binary outputs.
</p>


<h3>Usage</h3>

<pre><code class="language-R">KLR(X, y, xnew, lambda = 0.01, kernel = c("matern", "exponential")[1],
  nu = 1.5, power = 1.95, rho = 0.1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a design matrix with dimension <code>n</code> by <code>d</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a response vector with length <code>n</code>. The values in the vector are 0 or 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xnew</code></td>
<td>
<p>a testing matrix with dimension <code>n_new</code> by <code>d</code> in which each row corresponds to a predictive location.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>a positive value specifing the tuning parameter for KLR. The default is 0.01.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel</code></td>
<td>
<p>"matern" or "exponential" which specifies the matern kernel or power exponential kernel. The default is "matern".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p>a positive value specifying the order of matern kernel if <code>kernel</code> == "matern". The default is 1.5 if matern kernel is chosen.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>a positive value (between 1.0 and 2.0) specifying the power of power exponential kernel if <code>kernel</code> == "exponential". The default is 1.95 if power exponential kernel is chosen.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>a positive value specifying the scale parameter of matern and power exponential kernels. The default is 0.1.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function performs a kernel logistic regression, where the kernel can be assigned to Matern kernel or power exponential kernel by the argument <code>kernel</code>. The arguments <code>power</code> and <code>rho</code> are the tuning parameters in the power exponential kernel function, and <code>nu</code> and <code>rho</code> are the tuning parameters in the Matern kernel function. The power exponential kernel has the form </p>
<p style="text-align: center;"><code class="reqn">K_{ij}=\exp(-\frac{\sum_{k}{|x_{ik}-x_{jk}|^{power}}}{rho}),</code>
</p>
<p> and the Matern kernel has the form </p>
<p style="text-align: center;"><code class="reqn">K_{ij}=\prod_{k}\frac{1}{\Gamma(nu)2^{nu-1}}(2\sqrt{nu}\frac{|x_{ik}-x_{jk}|}{rho})^{nu} \kappa(2\sqrt{nu}\frac{|x_{ik}-x_{jk}|}{rho}).</code>
</p>
<p> The argument <code>lambda</code> is the tuning parameter for the function smoothness.
</p>


<h3>Value</h3>

<p>Predictive probabilities at given locations <code>xnew</code>.
</p>


<h3>Author(s)</h3>

<p>Chih-Li Sung &lt;iamdfchile@gmail.com&gt;
</p>


<h3>References</h3>

<p>Zhu, J. and Hastie, T. (2005). Kernel logistic regression and the import vector machine. Journal of Computational and Graphical Statistics, 14(1), 185-205.
</p>


<h3>See Also</h3>

<p><code>cv.KLR</code> for performing cross-validation to choose the tuning parameters.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(calibrateBinary)

set.seed(1)
np &lt;- 10
xp &lt;- seq(0,1,length.out = np)
eta_fun &lt;- function(x) exp(exp(-0.5*x)*cos(3.5*pi*x)-1) # true probability function
eta_x &lt;- eta_fun(xp)
yp &lt;- rep(0,np)
for(i in 1:np) yp[i] &lt;- rbinom(1,1, eta_x[i])

x.test &lt;- seq(0,1,0.001)
etahat &lt;- KLR(xp,yp,x.test)

plot(xp,yp)
curve(eta_fun, col = "blue", lty = 2, add = TRUE)
lines(x.test, etahat, col = 2)

#####   cross-validation with K=5    #####
##### to determine the parameter rho #####

cv.out &lt;- cv.KLR(xp,yp,K=5)
print(cv.out)

etahat.cv &lt;- KLR(xp,yp,x.test,lambda=cv.out$lambda,rho=cv.out$rho)

plot(xp,yp)
curve(eta_fun, col = "blue", lty = 2, add = TRUE)
lines(x.test, etahat, col = 2)
lines(x.test, etahat.cv, col = 3)

</code></pre>


</div>