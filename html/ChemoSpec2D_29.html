<div class="container">

<table style="width: 100%;"><tr>
<td>removePeaks2D</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Remove Peaks in a Spectra2D Object</h2>

<h3>Description</h3>

<p>This function sets peaks at specified frequencies in a <code>Spectra2D</code>
object to <code>NA</code>. This effectively removes these peaks from calculations of
contours which can speed things up and clarifies the visual presentation of data.
This function is useful for removing regions with large
interfering peaks (e.g. the water peak in 1H NMR), or regions that are primarily
noise.  This function leaves the frequency axes intact.  Note that the
<code>parafac</code> function, used by <code>pfacSpectra2D</code>, does not allow <code>NA</code>
in the input data matrices.  See <code>removeFreq</code> for a way to shrink
the data set without introducing <code>NA</code>s.
</p>


<h3>Usage</h3>

<pre><code class="language-R">removePeaks2D(spectra, remF2 = NULL, remF1 = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>spectra</code></td>
<td>
<p>An object of S3 class <code>Spectra2D</code> from which to
remove selected peaks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remF2</code></td>
<td>
<p>A formula giving the range of frequencies to be set to <code>NA</code>.  May include
"low" or "high" representing the extremes of the spectra.    Values outside the range of
F2 are tolerated without notice and are handled <code>min</code> or <code>max</code>.See the examples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remF1</code></td>
<td>
<p>As for <code>remF2</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of S3 class <code>Spectra2D</code>.
</p>


<h3>Author(s)</h3>

<p>Bryan A. Hanson, DePauw University.
</p>


<h3>See Also</h3>

<p><code>removeFreq</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Note we will set contours a bit low to better
# show what is going on.

data(MUD1)

plotSpectra2D(MUD1,
  which = 7, lvls = 0.1, cols = "black",
  main = "MUD1 Sample 7: Complete Data Set"
)

MUD1a &lt;- removePeaks2D(MUD1, remF2 = 2.5 ~ 4)
sumSpectra(MUD1a)
plotSpectra2D(MUD1a,
  which = 7, lvls = 0.1, cols = "black",
  main = "MUD1 Sample 7\nRemoved Peaks: F2 2.5 ~ 4"
)

MUD1b &lt;- removePeaks2D(MUD1, remF2 = low ~ 2)
sumSpectra(MUD1b)
plotSpectra2D(MUD1b,
  which = 7, lvls = 0.1, cols = "black",
  main = "MUD1 Sample 7\nRemoved Peaks: F2 low ~ 2"
)

MUD1c &lt;- removePeaks2D(MUD1, remF1 = high ~ 23)
sumSpectra(MUD1c)
plotSpectra2D(MUD1c,
  which = 7, lvls = 0.1, cols = "black",
  main = "MUD1 Sample 7\nRemoved Peaks: F1 high ~ 23"
)

MUD1d &lt;- removePeaks2D(MUD1, remF2 = 2.5 ~ 4, remF1 = 45 ~ 55)
sumSpectra(MUD1d)
plotSpectra2D(MUD1d,
  which = 7, lvls = 0.1, cols = "black",
  main = "MUD1 Sample 7\nRemoved Peaks: F2 2.5 ~ 4 &amp; F1 45 ~ 55"
)
</code></pre>


</div>