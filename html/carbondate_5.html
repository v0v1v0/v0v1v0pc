<div class="container">

<table style="width: 100%;"><tr>
<td>CalibrateSingleDetermination</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calibrate a Single Radiocarbon Determination</h2>

<h3>Description</h3>

<p>Uses the supplied calibration curve to calibrate a single radiocarbon
determination and uncertainty (expressed either in terms of radiocarbon age, or
as an F<code class="reqn">{}^{14}</code>C concentration) and obtain its calendar age probability
density estimate.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CalibrateSingleDetermination(
  rc_determination,
  rc_sigma,
  calibration_curve,
  F14C_inputs = FALSE,
  resolution = 1,
  plot_output = FALSE,
  plot_cal_age_scale = "BP",
  interval_width = "2sigma",
  bespoke_probability = NA,
  denscale = 3,
  plot_pretty = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>rc_determination</code></td>
<td>
<p>A single observed radiocarbon determination
provided either as the radiocarbon age (in <code class="reqn">{}^{14}</code>C yr BP) or the F<code class="reqn">{}^{14}</code>C concentration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rc_sigma</code></td>
<td>
<p>The corresponding measurement uncertainty of the radiocarbon determination
(must be in the same units as above, i.e., reported as <code class="reqn">{}^{14}</code>C age or F<code class="reqn">{}^{14}</code>C)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>calibration_curve</code></td>
<td>
<p>A dataframe which must contain one column <code>calendar_age_BP</code>, and also
columns <code>c14_age</code> and <code>c14_sig</code> or <code>f14c</code> and <code>f14c_sig</code> (or both sets).
This format matches the curves supplied with this package, e.g., intcal20,
intcal13, which contain all 5 columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>F14C_inputs</code></td>
<td>
<p><code>TRUE</code> if the provided <code>rc_determination</code> is an F<code class="reqn">{}^{14}</code>C
concentration and <code>FALSE</code> if it is a radiocarbon age. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resolution</code></td>
<td>
<p>The distance between the calendar ages at which to calculate the calendar age probability.
Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_output</code></td>
<td>
<p><code>TRUE</code> if you wish to plot the determination, the calibration curve,
and the posterior calibrated age estimate on the same plot. Defaults to <code>FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_cal_age_scale</code></td>
<td>
<p>Only for usage when <code>plot_output = TRUE</code>.
The calendar scale to use for the x-axis. Allowed values are "BP", "AD" and "BC". The default
is "BP", corresponding to plotting in cal yr BP.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interval_width</code></td>
<td>
<p>Only for usage when <code>plot_output = TRUE</code>. The confidence intervals to show for the
calibration curve and for the highest posterior density ranges.
Choose from one of "1sigma" (68.3%), "2sigma" (95.4%) and "bespoke". Default is "2sigma".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bespoke_probability</code></td>
<td>
<p>The probability to use for the confidence interval
if "bespoke" is chosen above. E.g. if 0.95 is chosen, then the 95% confidence
interval is calculated. Ignored if "bespoke" is not chosen.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>denscale</code></td>
<td>
<p>Whether to scale the vertical range of the calendar age density plot
relative to the calibration curve plot (optional). Default is 3 which means
that the maximum calendar age density will be at 1/3 of the height of the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_pretty</code></td>
<td>
<p>logical, defaulting to <code>TRUE</code>. If set <code>TRUE</code> then will select pretty plotting
margins (that create sufficient space for axis titles and rotates y-axis labels). If <code>FALSE</code> will
implement current user values.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A data frame with one column <code>calendar_age_BP</code> containing the calendar
ages, and the other column <code>probability</code> containing the probability at that
calendar age.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Calibration of a single determination expressed as 14C age BP
calib &lt;- CalibrateSingleDetermination(860, 35, intcal20)
plot(calib, type = "l", xlim = c(1000, 600))

# Incorporating an automated plot to visualise the calibration
CalibrateSingleDetermination(860, 35, intcal20, plot_output = TRUE)

# Calibration of a single (old) determination expressed as 14C age BP
calib &lt;- CalibrateSingleDetermination(31020, 100, intcal20)
plot(calib, type = "l", xlim = c(36500, 34500))

# Calibration of a single (old) determination expressed as F14C concentration
calib &lt;- CalibrateSingleDetermination(
    0.02103493, 0.0002618564, intcal20, F14C_inputs = TRUE)
plot(calib, type = "l", xlim = c(36500, 34500))

# Calibration of a single determination expressed as 14C age BP
# against SHCal20 (and creating an automated plot)
CalibrateSingleDetermination(1413, 25, shcal20, plot_output = TRUE)

# Implementing a bespoke confidence interval level and plot in AD
CalibrateSingleDetermination(
    1413,
    25,
    shcal20,
    plot_output = TRUE,
    plot_cal_age_scale = "AD",
    interval_width = "bespoke",
    bespoke_probability = 0.8)

# Changing denscale (so the calendar age density takes up less space)
CalibrateSingleDetermination(
    1413,
    25,
    shcal20,
    plot_output = TRUE,
    interval_width = "bespoke",
    bespoke_probability = 0.8,
    denscale = 5)
</code></pre>


</div>