<div class="container">

<table style="width: 100%;"><tr>
<td>draw.rings</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>plot the dates and model of a wiggle-match dated tree</h2>

<h3>Description</h3>

<p>A plot with two panels. The top panel shows the calibrated distributions (in blue) and the wiggle-match age-modelled age estimates for each dated ring (grey). The bottom panel shows the fit of the uncalibrated radiocarbon dates (steelblue dots and lab error bars) to the calibration curve (green), as well as the age estimate of the oldest/starting ring (grey) and its hpd range (black).
</p>


<h3>Usage</h3>

<pre><code class="language-R">draw.rings(
  name = "mytree",
  tree.dir = "trees",
  sep = ",",
  normal = TRUE,
  dat = c(),
  out = c(),
  cc = 1,
  postbomb = FALSE,
  BCAD = FALSE,
  t.a = 3,
  t.b = 4,
  x.lim = c(),
  x1.axis = TRUE,
  x1.labels = FALSE,
  x1.lab = c(),
  rev.x = FALSE,
  y1.lab = c(),
  y1.lim = c(),
  y2.lim = c(),
  x2.lab = c(),
  y2.lab = c(),
  ex = 0.05,
  plot.cc = TRUE,
  plot.dists = TRUE,
  mar.1 = c(1, 3, 1, 1),
  mar.2 = c(3, 3, 0, 1),
  mgp = c(1.7, 0.7, 0),
  dist.res = 500,
  date.col = "steelblue",
  cc.col = rgb(0, 0.5, 0, 0.5),
  dist.col = rgb(0, 0, 0, 0.5),
  calib.col = rgb(0, 0, 1, 0.25),
  range.col = "black",
  set.layout = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>The name of the tree. The .csv file should be saved under a folder named exactly the same as <code>name</code>, and the folder should live under the <code>tree.dir</code> folder. Default names include Ulandryk4 and mytree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tree.dir</code></td>
<td>
<p>The directory where the folders of the individual trees live. Defaults to <code>treedir="trees"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sep</code></td>
<td>
<p>Separator for the fields in the .csv file. Defaults to a comma.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normal</code></td>
<td>
<p>Calculations can be done assuming that the measurements are normally distributed. By default this is set to FALSE and a student-t distribution is used (Christen and Perez 2009).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>If <code>plot.rings</code> is called from within <code>rings()</code>, both dat and out are provided. If an existing run has to be plotted again, dat and out are read from the files in the folder named <code>name</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out</code></td>
<td>
<p>If <code>plot.rings</code> is called from within <code>rings()</code>, both dat and out are provided. If an existing run has to be plotted again, dat and out are read from the files in the folder named <code>name</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cc</code></td>
<td>
<p>Calibration curve to be used. Could be 1 (IntCal20; default), 2 (Marine20), 3 (SHCal20) or 4 (custom curve).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>postbomb</code></td>
<td>
<p>Negative C-14 ages should be calibrated using a postbomb curve. This could be 1 (northern-hemisphere region 1), 2 (NH region 2), 3 (NH region 3), 4 (southern hemisphere regions 1-2), or 5 (SH region 3).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BCAD</code></td>
<td>
<p>The calendar scale of graphs and age output-files is in <code>cal BP</code> by default, but can be changed to BC/AD using <code>BCAD=TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t.a</code></td>
<td>
<p>First parameter for the student-t distribution (defaults to 3; higher numbers make the distribution approximate the normal distribution more).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t.b</code></td>
<td>
<p>Second parameter for the student-t distribution (defaults to 4; higher numbers make the distribution approximate the normal distribution more).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.lim</code></td>
<td>
<p>Limits of the x-axes. Calculated automatically by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x1.axis</code></td>
<td>
<p>Whether or not to plot the upper x-axis (slightly redundant since the bottom axis shows the values already). Defaults to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x1.labels</code></td>
<td>
<p>Whether or not to plot the labels of the upper x-axis. (slightly redundant since the bottom axis shows the values already). Defaults to FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x1.lab</code></td>
<td>
<p>The labels for the calendar axis of the upper panel. Defaults to empty.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rev.x</code></td>
<td>
<p>Whether or not to reverse the x-axis. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y1.lab</code></td>
<td>
<p>The labels for the y-axis. Defaults to <code>"rings"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y1.lim</code></td>
<td>
<p>Limits of the top y-axis. Calculated automatically if left empty.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y2.lim</code></td>
<td>
<p>Limits of the bottom y-axis. Calculated automatically if left empty.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x2.lab</code></td>
<td>
<p>The labels for the bottom calendar axis (default <code>age.lab="cal BP"</code> or <code>"BC/AD"</code> if <code>BCAD=TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y2.lab</code></td>
<td>
<p>The labels for the bottom y-axis. Defaults to 14C BP with superscript 14, so <code>expression(""^14*C~BP)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ex</code></td>
<td>
<p>Exaggeration of the heights of the calibrated distributions. Defaults to 0.05 so there is plenty space to plot many distributions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.cc</code></td>
<td>
<p>Whether or not to plot a panel with the calibration curve.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.dists</code></td>
<td>
<p>Whether or not to plot a panel with the distributions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mar.1</code></td>
<td>
<p>Margins around the first/top plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mar.2</code></td>
<td>
<p>Margins around the first/bottom plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mgp</code></td>
<td>
<p>Axis text margins (where should titles, labels and tick marks be plotted). Defaults to <code>mgp=c(1.7, .7, .0)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist.res</code></td>
<td>
<p>Resolution of the plot of the distribution. The default is <code>500</code>, which results in smooth plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>date.col</code></td>
<td>
<p>Colour of the uncalibrated dates when plotted on top of the calibration curve. Defaults to <code>"steelblue"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cc.col</code></td>
<td>
<p>Colour of the calibration curve. Defaults to semi-transparent darkgreen, <code>cc.col=rgb(0 0.5, 0, 0.5)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist.col</code></td>
<td>
<p>Colour of the age-modelled distribution. Defaults to semi-transparent grey, <code>dist.col=rgb(0,0,0,0.5)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>calib.col</code></td>
<td>
<p>Colour of the calibrated distributions. Defaults to semi-transparent blue, <code>dist.col=rgb(0,0,1,0.5)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range.col</code></td>
<td>
<p>Colour of the hpd ranges. Defaults to <code>"black"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>set.layout</code></td>
<td>
<p>By default, the layout of the two plots is set automatically (2 plots in one column).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A plot with the calibrated distributions of the individual dates and the wiggle-match distributions (top), and the dates on the calibration curve together with the age distribution for the earliest ring, 0.
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw, J. Andres Christen
</p>


<h3>Examples</h3>

<pre><code class="language-R">  treedir &lt;- tempdir()
  rings("Ulandryk", tree.dir=treedir, draw=FALSE)
  draw.rings("Ulandryk", tree.dir=treedir)
</code></pre>


</div>