<div class="container">

<table style="width: 100%;"><tr>
<td>maximize_loess_metric</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Optimize a metric function in binary classification after LOESS smoothing</h2>

<h3>Description</h3>

<p>Given a function for computing a metric in <code>metric_func</code>, these functions
smooth the function of metric value per cutpoint using LOESS, then
maximize or minimize the metric by selecting an optimal cutpoint. For further details
on the LOESS smoothing see <code>?fANCOVA::loess.as</code>.
The <code>metric</code> function should accept the following inputs:
</p>

<ul>
<li> <p><code>tp</code>: vector of number of true positives
</p>
</li>
<li> <p><code>fp</code>: vector of number of false positives
</p>
</li>
<li> <p><code>tn</code>: vector of number of true negatives
</p>
</li>
<li> <p><code>fn</code>: vector of number of false negatives
</p>
</li>
</ul>
<h3>Usage</h3>

<pre><code class="language-R">maximize_loess_metric(
  data,
  x,
  class,
  metric_func = youden,
  pos_class = NULL,
  neg_class = NULL,
  direction,
  criterion = "aicc",
  degree = 1,
  family = "symmetric",
  user.span = NULL,
  tol_metric,
  use_midpoints,
  ...
)

minimize_loess_metric(
  data,
  x,
  class,
  metric_func = youden,
  pos_class = NULL,
  neg_class = NULL,
  direction,
  criterion = "aicc",
  degree = 1,
  family = "symmetric",
  user.span = NULL,
  tol_metric,
  use_midpoints,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame or tibble in which the columns that are given in x
and class can be found.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>(character) The variable name to be used for classification,
e.g. predictions or test values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>class</code></td>
<td>
<p>(character) The variable name indicating class membership.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metric_func</code></td>
<td>
<p>(function) A function that computes a
metric to be maximized. See description.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos_class</code></td>
<td>
<p>The value of class that indicates the positive class.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>neg_class</code></td>
<td>
<p>The value of class that indicates the negative class.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>direction</code></td>
<td>
<p>(character) Use "&gt;=" or "&lt;=" to select whether an x value
&gt;= or &lt;= the cutoff predicts the positive class.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>
<p>the criterion for automatic smoothing parameter selection:
"aicc" denotes bias-corrected AIC criterion, "gcv" denotes generalized
cross-validation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degree</code></td>
<td>
<p>the degree of the local polynomials to be used. It can be
0, 1 or 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>if "gaussian" fitting is by least-squares, and if "symmetric"
a re-descending M estimator is used with Tukey's biweight function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>user.span</code></td>
<td>
<p>The user-defined parameter which controls the degree of
smoothing</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol_metric</code></td>
<td>
<p>All cutpoints will be returned that lead to a metric
value in the interval [m_max - tol_metric, m_max + tol_metric] where
m_max is the maximum achievable metric value. This can be used to return
multiple decent cutpoints and to avoid floating-point problems.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_midpoints</code></td>
<td>
<p>(logical) If TRUE (default FALSE) the returned optimal
cutpoint will be the mean of the optimal cutpoint and the next highest
observation (for direction = "&gt;") or the next lowest observation
(for direction = "&lt;") which avoids biasing the optimal cutpoint.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments that will be passed to metric_func or the
loess smoother.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The above inputs are arrived at by using all unique values in <code>x</code>, Inf, and
-Inf as possible cutpoints for classifying the variable in class.
</p>


<h3>Value</h3>

<p>A tibble with the columns <code>optimal_cutpoint</code>, the corresponding metric
value and <code>roc_curve</code>, a nested tibble that includes all possible cutoffs
and the corresponding numbers of true and false positives / negatives and
all corresponding metric values.
</p>


<h3>Source</h3>

<p>Xiao-Feng Wang (2010). fANCOVA: Nonparametric Analysis of Covariance.
https://CRAN.R-project.org/package=fANCOVA
</p>
<p>Leeflang, M. M., Moons, K. G., Reitsma, J. B., &amp; Zwinderman, A. H.
(2008). Bias in sensitivity and specificity caused by data-driven selection
of optimal cutoff values: mechanisms, magnitude, and solutions.
Clinical Chemistry, (4), 729â€“738.
</p>


<h3>See Also</h3>

<p>Other method functions: 
<code>maximize_boot_metric()</code>,
<code>maximize_gam_metric()</code>,
<code>maximize_metric()</code>,
<code>maximize_spline_metric()</code>,
<code>oc_manual()</code>,
<code>oc_mean()</code>,
<code>oc_median()</code>,
<code>oc_youden_kernel()</code>,
<code>oc_youden_normal()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">oc &lt;- cutpointr(suicide, dsi, suicide, gender, method = maximize_loess_metric,
criterion = "aicc", family = "symmetric", degree = 2, user.span = 0.7,
metric = accuracy)
plot_metric(oc)
oc &lt;- cutpointr(suicide, dsi, suicide, gender, method = minimize_loess_metric,
criterion = "aicc", family = "symmetric", degree = 2, user.span = 0.7,
metric = misclassification_cost, cost_fp = 1, cost_fn = 10)
plot_metric(oc)
</code></pre>


</div>