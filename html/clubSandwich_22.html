<div class="container">

<table style="width: 100%;"><tr>
<td>vcovCR.lme</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cluster-robust variance-covariance matrix for an lme object.</h2>

<h3>Description</h3>

<p><code>vcovCR</code> returns a sandwich estimate of the variance-covariance matrix 
of a set of regression coefficient estimates from a <code>lme</code> object.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'lme'
vcovCR(obj, cluster, type, target, inverse_var, form = "sandwich", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>Fitted model for which to calculate the variance-covariance matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>Optional expression or vector indicating which observations 
belong to the same cluster. If not specified, will be set to 
<code>getGroups(obj)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Character string specifying which small-sample adjustment should 
be used, with available options <code>"CR0"</code>, <code>"CR1"</code>, <code>"CR1p"</code>,
<code>"CR1S"</code>, <code>"CR2"</code>, or <code>"CR3"</code>. See "Details" section of 
<code>vcovCR</code> for further information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>
<p>Optional matrix or vector describing the working 
variance-covariance model used to calculate the <code>CR2</code> and <code>CR4</code> 
adjustment matrices. If not specified, the target is taken to be the
estimated variance-covariance structure of the <code>lme</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inverse_var</code></td>
<td>
<p>Optional logical indicating whether the weights used in 
fitting the model are inverse-variance. If not specified, <code>vcovCR</code> 
will attempt to infer a value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>Controls the form of the returned matrix. The default 
<code>"sandwich"</code> will return the sandwich variance-covariance matrix. 
Alternately, setting <code>form = "meat"</code> will return only the meat of the 
sandwich and setting <code>form = B</code>, where <code>B</code> is a matrix of 
appropriate dimension, will return the sandwich variance-covariance matrix 
calculated using <code>B</code> as the bread. <code>form = "estfun"</code> will return the 
(appropriately scaled) estimating function, the transposed crossproduct of 
which is equal to the sandwich variance-covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments available for some classes of objects.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>c("vcovCR","clubSandwich")</code>, which consists 
of a matrix of the estimated variance of and covariances between the 
regression coefficient estimates.
</p>


<h3>See Also</h3>

<p><code>vcovCR</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
if (requireNamespace("nlme", quietly = TRUE)) {

  library(nlme)
  rat_weight &lt;- lme(weight ~ Time * Diet, data=BodyWeight, ~ Time | Rat) 
  vcovCR(rat_weight, type = "CR2")

}

pkgs_available &lt;- 
  requireNamespace("nlme", quietly = TRUE) &amp; 
  requireNamespace("mlmRev", quietly = TRUE)

if (pkgs_available) {

  data(egsingle, package = "mlmRev")
  subset_ids &lt;- levels(egsingle$schoolid)[1:10]
  egsingle_subset &lt;- subset(egsingle, schoolid %in% subset_ids)
  
  math_model &lt;- lme(math ~ year * size + female + black + hispanic, 
                    random = list(~ year | schoolid, ~ 1 | childid), 
                    data = egsingle_subset)
                    
  vcovCR(math_model, type = "CR2")
  
}

</code></pre>


</div>