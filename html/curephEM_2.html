<div class="container">

<table style="width: 100%;"><tr>
<td>cureph</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
NPMLE for Logistic-CoxPH Cure-Rate Model
</h2>

<h3>Description</h3>

<p>Fit NPMLE for Logistic-CoxPH Cure-Rate Model

</p>


<h3>Usage</h3>

<pre><code class="language-R">cureph (formula, formula2 , data,  subset, na.action, init, control,
                 method = c("EM"), singular.ok = TRUE,
                  var = c("Louis"),...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>

<p>a <code>formula</code> object for cure logistic model,with the response on the left of a ~ operator, and the terms on the right. The response must be a survival object as returned by the <code>Surv.cure</code> function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula2</code></td>
<td>

<p>a <code>formula</code> object for event time CoxPH model
The Response can be suppressed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>a <code>data.frame</code> in which to interpret the variables named in the <code>formula</code> and <code>formula2</code>, or in the <code>subset</code> and the <code>weights</code> argument.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>

<p>expression indicating which subset of the rows of data should be used in the fit. All observations are included by default.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>

<p>a missing-data filter function. This is applied to the model.frame after any subset argument has been used. Default is <code>options()$na.action</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>

<p>a <code>list</code> of length 3,  initial values of the iteration. Its compoenents are: a vector of <code>formula</code> coefficients,a vector of<code>formula2</code> coefficients and a <code>step.fun</code> step function of baseline cummulative hazard function. Default initial value is the estimate from naive separate <code>glm</code> and <code>coxph</code> models.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>

<p>Object of class <code>cureph.control</code> specifying iteration limit and other control options. Default is <code>cureph.control(...)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>a character string specifying the method for estimation. The default method is the EM algorithm.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>singular.ok</code></td>
<td>

<p>logical value indicating how to handle collinearity in the model matrix. If <code>TRUE</code>, the program will automatically skip over columns of the X matrix that are linear combinations of earlier columns. In this case the coefficients for such columns will be <code>NA</code>, and the variance matrix will contain zeros. For ancillary calculations, such as the linear predictor, the missing coefficients are treated as zeros.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>

<p>a character string specifying the method for variance estimation. The default method is derived from the Louis formula.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>other parameters passed to <code>cureph.control</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function can handle left truncation.
</p>
<p><code>"BFGS-Newton"</code> method optimizes the discretized nonparametric likelihood directly. It has 3 steps. First, it roughly search for a local maximal by BFGS method with default setup. Second, it rescales the parameters proportional to the reciprocal of current gradient in another BFGS optimization. Finally, it searches for a solution to the score equations through a Newton's method with Armijo line search.
</p>
<p>The <code>"EM"</code> method uses a “ghost copy” algorithm to accomodate left-truncation.
</p>
<p>Both variance estimation methods are asymptotically correct, but they have undercoverage issue in case of a small event number. <code>"Louis"</code> is recommended among the two.
</p>
<p>See <cite>Hou et al. (2016)</cite> for detail.
</p>


<h3>Author(s)</h3>

<p>Jue (Marquis) Hou
</p>


<h3>References</h3>

<p>Hou, J., Chambers, C. and Xu, R. (2016). "A nonparametric maximum likelihood approach for partially
observed cured data with left truncation and right-censoring". To be submitted.
</p>


<h3>See Also</h3>

<p><code>cureph.object</code>, <code>summary.cureph</code>, <code>survpred.cureph</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# A simulated data set
data('sim.cureph.data')
# Or you may generate another one
sim.cureph.data = cureph.simgen()

# Check out the true coefficients and baseline survival
attributes(sim.cureph.data)

# Fit logistic-CoxPH cure-rate model
fit=cureph(Surv.cure(time,time2,event,origin=0,end=20)~Z1+Z2+Z3+Z4,data=sim.cureph.data)

# Check out the summary
summary(fit)

# Baseline cummulative hazard
basehaz.cureph(fit)

</code></pre>


</div>