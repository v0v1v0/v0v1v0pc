<div class="container">

<table style="width: 100%;"><tr>
<td>COPPS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cross-validation with Order-Preserved Sample-Splitting</h2>

<h3>Description</h3>

<p>Tuning parameters are selected by a generalised <abbr><span class="acronym">COPPS</span></abbr> procedure. All functions use Order-Preserved Sample-Splitting, meaning that the folds will be the odd and even indexed observations. The three functions differ in which cross-validation criterion they are using. <code>COPPS</code> is the original <abbr><span class="acronym">COPPS</span></abbr> procedure <cite>Zou et al. (2020)</cite>, i.e. uses quadratic error loss. <code>CV1</code> and <code>CVmod</code> use absolute error loss and the modified quadratic error loss, respectively.</p>


<h3>Usage</h3>

<pre><code class="language-R">COPPS(Y, param = 5L, estimator = leastSquares,
      output = c("param", "fit", "detailed"), ...)
CV1(Y, param = 5L, estimator = leastSquares,
    output = c("param", "fit", "detailed"), ...)
CVmod(Y, param = 5L, estimator = leastSquares,
      output = c("param", "fit", "detailed"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>the observations, can be any data type that supports the function <code>length</code> and the operator <code>[]</code> and can be passed to <code>estimator</code> and the <code>cross-validation criterion</code>, e.g. a numeric vector or a list. Support for <code>matrices</code>, i.e. for multivariate data, is planned but not implemented so far</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>a <code>list</code> giving the possible tuning parameters. Alternatively, a single integer which will be interpreted as the maximal number of change-points and converted to <code>as.list(0:param)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimator</code></td>
<td>
<p>a function providing a local estimate. For pre-implemented estimators see estimators. The function must have the arguments <code>Y</code>, <code>param</code> and <code>...</code>, where <code>Y</code> will be a subset of the observations, and <code>param</code> and <code>...</code> will be the corresponding arguments of the called function. Note that <code>...</code> will be passed to <code>estimator</code> and the <code>cross-validation criterion</code>. The return value must be either a list of length <code>length(param)</code> with each entry containing the estimated change-point locations for the given entry in <code>param</code> or a list containing the named entries <code>cps</code> and <code>value</code>. In this case <code>cps</code> has to be a list of the estimated change-points as before and <code>value</code> has to be a list of the locally estimated values for each entry in <code>param</code>, i.e. each list entry has to be a list itself of length one entry longer than the corresponding entry in <code>cps</code>. The function <code>convertSingleParam</code> offers the conversion of an estimator allowing a single parameter into an estimator allowing multiple parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>a string specifying the output, either <code>"param"</code>, <code>"fit"</code> or <code>"detailed"</code>. For details what they mean see <cite>Value</cite></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters that are passed to <code>estimator</code> and the <code>cross-validation criterion</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>if <code>output == "param"</code>, the selected tuning parameter, i.e. an entry from <code>param</code>. If <code>output == "fit"</code>, a list with the entries <code>param</code>, giving the selected tuning parameter, and <code>fit</code>. The named entry <code>fit</code> is a list giving the returned fit obtained by applying <code>estimator</code> to the whole data <code>Y</code> with the selected tuning parameter. The returned value is transformed to a list with an entry <code>cps</code> giving the estimated change-points and, if provided by <code>estimator</code>, an entry <code>value</code> giving the estimated local values. If <code>output == "detailed"</code>, the same as for <code>output == "fit"</code>, but additionally the entries <code>CP</code>, <code>CVodd</code>,  and <code>CVeven</code> giving the calculated cross-validation criteria for all <code>parameter</code> entries. <code>CVodd</code> and <code>CVeven</code> are the criteria when the odd / even observations are in the test set, respectively. <code>CP</code> is the sum of those two.
</p>


<h3>References</h3>

<p>Pein, F., and Shah, R. D. (2021) Cross-validation for change-point regression: pitfalls and solutions. <em>arXiv:2112.03220</em>.
</p>
<p>Zou, C., Wang, G., and Li, R. (2020) Consistent selection of the number of change-points via sample-splitting. <em>The Annals of Statistics</em>, <b>48</b>(1), 413â€“439.
</p>


<h3>See Also</h3>

<p>estimators, criteria, <code>convertSingleParam</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># call with default parameters:
# 2-folds cross-validation with ordereded folds, absolute error loss,
# least squares estimation, and possible parameters being 0 to 5 change-points
CV1(Y = rnorm(100))
# the same, but with modified error loss
CVmod(Y = rnorm(100))
# the same, but with quadratic error loss, indentical to COPPS procedure
COPPS(Y = rnorm(100))

# more interesting data and more detailed output
set.seed(1L)
Y &lt;- c(rnorm(50), rnorm(50, 5), rnorm(50), rnorm(50, 5))
CV1(Y = Y, output = "detailed")
# finds the correct change-points at 50, 100, 150
# (plus the start and end points 0 and 200)

# list of parameters, only allowing 1 or 2 change-points
CVmod(Y = Y, param = as.list(1:2))

# COPPS potentially fails to provide a good selection when large changes occur at odd locations
# Example 1 in (Pein and Shah, 2021), see Section 2.2 in this paper for more details
set.seed(1)
exampleY &lt;- rnorm(102, c(rep(10, 46), rep(0, 5), rep(30, 51)))
# misses one change-point
COPPS(Y = exampleY) 

# correct number of change-points when modified criterion (or absolute error loss) is used
CVmod(Y = exampleY)

# PELT as a local estimator instead of least squares estimation
# param must contain parameters that are acceptable for the given estimator
CV1(Y = Y, estimator = pelt, output = "detailed", param = list("SIC", "MBIC", 3 * log(length(Y))))

# argument minseglen of pelt specified in ...
CVmod(Y = Y, estimator = pelt, output = "detailed", param = list("SIC", "MBIC", 3 * log(length(Y))),
                  minseglen = 30)
</code></pre>


</div>