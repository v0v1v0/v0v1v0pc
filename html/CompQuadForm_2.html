<div class="container">

<table style="width: 100%;"><tr>
<td>farebrother</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Ruben/Farebrother method</h2>

<h3>Description</h3>

<p>Distribution function (survival function in fact) of quadratic forms in normal variables using Farebrother's algorithm.
</p>


<h3>Usage</h3>

<pre><code class="language-R">farebrother(q, lambda, h = rep(1, length(lambda)),
            delta = rep(0, length(lambda)), maxit = 100000,
            eps = 10^(-10), mode = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>value point at which distribution function is to be evaluated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>the weights <code class="reqn">\lambda_1, \lambda_2, ..., \lambda_n</code>, i.e. the distinct non-zero characteristic roots of <code class="reqn">A\Sigma</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>vector of the respective orders of multiplicity <code class="reqn">m_i</code> of the <code class="reqn">\lambda</code>s</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>the non-centrality parameters <code class="reqn">\delta_i</code> (should be positive)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>the maximum number of term K in equation below</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>the desired level of accuracy</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode</code></td>
<td>
<p>if 'mode' &gt; 0 then <code class="reqn">\beta=mode*\lambda_{min}</code> otherwise <code class="reqn">\beta=\beta_B=2/(1/\lambda_{min}+1/\lambda_{max})</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Computes P[Q&gt;q] where <code class="reqn">Q=\sum_{j=1}^n\lambda_j\chi^2(m_j,\delta_j^2)</code>. P[Q&lt;q] is approximated by <code class="reqn">\sum_k=0^{K-1} a_k P[\chi^2(m+2k)&lt;q/\beta]</code> where <code class="reqn">m=\sum_{j=1}^n m_j</code> and <code class="reqn">\beta</code> is an arbitrary constant (as given by argument mode).
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dnsty</code></td>
<td>
<p>the density of the linear form</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ifault</code></td>
<td>
<p>the fault indicator. -i: one or more of the constraints
<code class="reqn">\lambda_i&gt;0</code></p>
</td>
</tr>
</table>
<p>, <code class="reqn">m_i&gt;0</code> and <code class="reqn">\delta_i^2\geq0</code> is not
satisfied. 1: non-fatal underflow of <code class="reqn">a_0</code>. 2: one or more of the
constraints <code class="reqn">n&gt;0</code>, <code class="reqn">q&gt;0</code>, <code class="reqn">maxit&gt;0</code> and <code class="reqn">eps&gt;0</code> is not
satisfied. 3: the current estimate of the probability is greater than
2. 4: the required accuracy could not be obtained in 'maxit'
iterations. 5: the value returned by the procedure does not satisfy
<code class="reqn">0\leq RUBEN\leq 1</code>. 6: 'dnsty' is negative. 9: faults 4 and
5. 10: faults 4 and 6. 0: otherwise.
</p>
<table><tr style="vertical-align: top;">
<td><code>Qq</code></td>
<td>
<p><code class="reqn">P[Q&gt;q]</code></p>
</td>
</tr></table>
<h3>Author(s)</h3>

<p>Pierre Lafaye de Micheaux (<a href="mailto:lafaye@dms.umontreal.ca">lafaye@dms.umontreal.ca</a>) and
Pierre Duchesne (<a href="mailto:duchesne@dms.umontreal.ca">duchesne@dms.umontreal.ca</a>)</p>


<h3>References</h3>

<p>P. Duchesne, P. Lafaye de Micheaux, Computing the distribution of quadratic forms: Further comparisons between the Liu-Tang-Zhang approximation and exact methods, <em>Computational Statistics and Data Analysis</em>, Volume 54, (2010), 858-862
</p>
<p>Farebrother R.W., Algorithm AS 204: The distribution of a Positive Linear
Combination of chi-squared random variables, Journal of the Royal
Statistical Society, Series C (applied Statistics), Vol. 33, No. 3
(1984), p. 332-339</p>


<h3>Examples</h3>

<pre><code class="language-R"># Some results from Table 3, p.327, Davies (1980)

 1 - farebrother(1, c(6, 3, 1), c(1, 1, 1), c(0, 0, 0))$Qq

</code></pre>


</div>