<div class="container">

<table style="width: 100%;"><tr>
<td>ORDSUMcop</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Ordinal Sums of M-Copula</h2>

<h3>Description</h3>

<p>Compute <em>ordinal sums of a copula</em> (Nelsen, 2006, p. 63) or <em>M-ordinal sum of the summands</em> (Klement <em>et al.</em>, 2017) within <code class="reqn">\mathcal{I}^2</code> into <code class="reqn">n</code> partitions (possibly infinite) within <code class="reqn">\mathcal{I}^2</code>. According to Nelsen, letting <code class="reqn">\mathcal{J}</code> denote a <em>partition</em> of <code class="reqn">\mathcal{I}^2</code> and <code class="reqn">\mathcal{J}_i = [a_i,\, b_i]</code> be the <code class="reqn">i</code>th partition that does not overlap with others and letting also <code class="reqn">\mathbf{C}_i</code> be a copula for the <code class="reqn">i</code>th partition, then the <em>ordinal sum</em> of these <code class="reqn">\mathbf{C}_i</code> with parameters <code class="reqn">\Theta_i</code> <em>with respect to</em> <code class="reqn">\mathcal{J}_i</code> is the copula <code class="reqn">\mathbf{C}</code> given by
</p>
<p style="text-align: center;"><code class="reqn">\mathbf{C}\bigl(u,v; \mathcal{J}_i, \mathbf{C}_i, \Theta_i, i \in 1,2,\cdots,n\bigr) = a_i + (b_i-a_i)\mathbf{C}_i\biggl(\frac{u-a_i}{b_i-a_i},\, \frac{v-a_i}{b_i-a_i};  \Theta_i\biggr)\  \mbox{for}\ (u,v) \in \mathcal{J}^2\mbox{,}</code>
</p>

<p>for points within the partitions, and for points otherwise outside the partitions the coupla is given by
</p>
<p style="text-align: center;"><code class="reqn">\mathbf{C}\bigl(u,v; \mathcal{J}_i, \mathbf{C}_i, i \in 1,2,\cdots,n\bigr) = \mathbf{M}(u,v)\  \mathrm{for}\ (u,v) \ni \mathcal{J}^2\mbox{, and}</code>
</p>

<p>let <code class="reqn">\mathbf{C}_\mathcal{J}(u,v)</code> be a convenient abbreviation for the copula. Finally, Nelsen (2006, theorem 3.2.1) states that a copula is an ordinal sum if and only if for a <code class="reqn">t</code> if <code class="reqn">\mathbf{C}(t,t)=t</code> for <code class="reqn">t \in (0,1)</code>. The <em>diagonal of a coupla</em> can be useful for quick assessment (see <b>Examples</b>) of this theorem. (See <code>ORDSUWcop</code>, <em>W-ordinal sum of the summands</em>.)
</p>


<h3>Usage</h3>

<pre><code class="language-R">ORDSUMcop(u,v, para=list(cop=W, para=NA, part=c(0,1)), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>Nonexceedance probability <code class="reqn">u</code> in the <code class="reqn">X</code> direction;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>Nonexceedance probability <code class="reqn">v</code> in the <code class="reqn">Y</code> direction;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>para</code></td>
<td>
<p>A list of sublists for the coupla, parameters, and partitions (see <b>Examples</b>) and some attempt for intelligent in-fill of <code>para</code> is made within the sources (the default <code>para</code> is an example for which <code>cop</code> and <code>para</code> elements are converted to lists). The user is responsible that <code>part</code> element properly canvases by end-point alignment all of <code class="reqn">\mathcal{I}^2</code>; and</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to pass.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Value(s) for the copula are returned.
</p>


<h3>Author(s)</h3>

<p>W.H. Asquith</p>


<h3>References</h3>

<p>Nelsen, R.B., 2006, An introduction to copulas: New York, Springer, 269 p.
</p>
<p>Klement, E.P., Kolesárová, A., Mesiar, R., Saminger-Platz, S., 2017, Copula constructions using ultramodularity (chap. 9) <em>in</em> Copulas and dependence models with applications—Contributions in honor of Roger B. Nelsen, <em>eds.</em> Flores, U.M., Amo Artero, E., Durante, F., Sánchez, J.F.: Springer, Cham, Switzerland, ISBN 978–3–319–64220–9, <a href="https://doi.org/10.1007/978-3-319-64221-5">doi:10.1007/978-3-319-64221-5</a>.
</p>


<h3>See Also</h3>

<p><code>copBasic-package</code>, <code>W_N5p12a</code>, <code>ORDSUWcop</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
  para &lt;- list(cop=c(CLcop, M, PLcop, GHcop), para=list(4, NA, 0.1, c(3,4)),
              part=list(c(0,0.25), c(0.25,0.35), c(0.35,0.85), c(0.85,1)))
  UV &lt;- simCOP(n=100, cop=ORDSUMcop, para=para, ploton=FALSE)
  plot(c(0,1), c(0,1), xlab="U, NONEXCEEDANCE PROBABILITY", type="n",
                       ylab="V, NONEXCEEDANCE PROBABILITY")
  for(k in seq_len(length(para$part))) {         #  to draw the partitions
    a &lt;- para$part[[k]][1]; b &lt;- para$part[[k]][2]
    polygon(c(a, b, b, a, a), c(a,a,b,b,a), lty=2, lwd=0.8, col="lightgreen")
    text((a+b)/2, (a+b)/2, k, cex=3, col="blue") # numbered by partition
  }
  points(UV, pch=21, cex=0.8, col=grey(0.1), bg="white") #
## End(Not run)

## Not run: 
  para &lt;- list(cop=c(GHcop), para=list(c(2,3)), # internally replicated
               part=list(c(0,0.2), c(0.2,0.3), c(0.3,0.5), c(0.5,0.7), c(0.7,1)))
  UV &lt;- simCOP(n=100, cop=ORDSUMcop, para=para, ploton=FALSE)
  plot(c(0,1), c(0,1), xlab="U, NONEXCEEDANCE PROBABILITY", type="n",
                       ylab="V, NONEXCEEDANCE PROBABILITY")
  for(k in seq_len(length(para$part))) {         #  to draw the partitions
    a &lt;- para$part[[k]][1]; b &lt;- para$part[[k]][2]
    polygon(c(a, b, b, a, a), c(a,a,b,b,a), lty=2, lwd=0.8, col="lightgreen")
    text((a+b)/2, (a+b)/2, k, cex=3, col="blue") # numbered by partition
  }
 points(UV, pch=21, cex=0.8, col=grey(0.1), bg="white") #
## End(Not run)

## Not run: 
  # In this example, it is important that the delt is of the resolution
  # matching the  edges of the partitions.
  para &lt;- list(cop=P, para=list(NULL),
               part=list(c(0,0.257), c(0.257,0.358), c(0.358,1)))
  DI &lt;- diagCOP(cop=ORDSUMcop, para=para, delt=0.001)
  if(sum(DI$diagcop == DI$t) &gt;= 1) {
    message("The ORDSUMcop() operation is an ordinal sum if there exists\n",
            "a t=(0,1) exists such that C(t,t)=t by Nelsen (2006, theorem 3.2.1).")
  }
  abline(0,1, col="red") #
## End(Not run)
</code></pre>


</div>