<div class="container">

<table style="width: 100%;"><tr>
<td>prepare_data</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Prepare data for corpus exploration</h2>

<h3>Description</h3>

<p>Convert data frame or character vector to a ‘corporaexplorerobject’
for subsequent exploration.
</p>


<h3>Usage</h3>

<pre><code class="language-R">prepare_data(dataset, ...)

## S3 method for class 'data.frame'
prepare_data(
  dataset,
  date_based_corpus = TRUE,
  text_column = "Text",
  grouping_variable = NULL,
  within_group_identifier = "sequential",
  columns_doc_info = c("Date", "Title", "URL"),
  corpus_name = NULL,
  use_matrix = TRUE,
  matrix_without_punctuation = TRUE,
  tile_length_range = c(1, 10),
  columns_for_ui_checkboxes = NULL,
  ...
)

## S3 method for class 'character'
prepare_data(
  dataset,
  corpus_name = NULL,
  use_matrix = TRUE,
  matrix_without_punctuation = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dataset</code></td>
<td>
<p>Object to convert to corporaexplorerobject:
</p>

<ul>
<li>
<p> A data frame with a specified column containing text (default column name: "Text") (class
character), and optionally other columns.
If <code>date_based_corpus</code> is <code>TRUE</code> (the default),
<code>dataset</code> must contain a column "Date" (of class Date).
</p>
</li>
<li>
<p> Or a non-empty character vector.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments to be passed to <code>prepare_data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>date_based_corpus</code></td>
<td>
<p>Logical. Set to <code>FALSE</code> if the corpus
is not to be organised according to document dates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text_column</code></td>
<td>
<p>Character. Default: "Text".
The column in <code>dataset</code> containing texts to be explored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grouping_variable</code></td>
<td>
<p>Character string indicating column name in dataset.
If date_based_corpus is TRUE, this argument is ignored.
If date_based_corpus is FALSE, this argument is used to group the documents,
e.g., if dataset is organised by chapters belonging to different books.
The order of groups in the app is determined as follows:
</p>

<ul>
<li>
<p> If grouping_variable is a factor column, the factor levels determine the order.
</p>
</li>
<li>
<p> If grouping_variable is not a factor, the order is determined by the
sequence in which unique values first appear in the dataset.</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>within_group_identifier</code></td>
<td>
<p>Character string indicating column name in <code>dataset</code>.
If <code>date_based_corpus</code> is <code>TRUE</code>, this argument is ignored.
If <code>date_based_corpus</code> is <code>FALSE</code>,
<code>"sequential"</code>, the default, means the rows in each group are assigned
a numeric sequence 1:n where n is the number of rows in the group.
Used in document tab title in non-date based corpora.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>columns_doc_info</code></td>
<td>
<p>Character vector. The columns from <code>dataset</code> to display in
the "document information" tab in the corpus exploration app. By default
"Date", "Title" and "URL" will be
displayed, if included. If <code>columns_doc_info</code> includes a column which is not
present in dataset, it will be ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corpus_name</code></td>
<td>
<p>Character string with name of corpus.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_matrix</code></td>
<td>
<p>Logical. Should the function create a document term matrix
for fast searching? If <code>TRUE</code>, data preparation will run longer and demand
more memory. If <code>FALSE</code>, the returning corporaexplorerobject will be more light-weight, but
searching will be slower.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>matrix_without_punctuation</code></td>
<td>
<p>Should punctuation and digits be stripped
from the text before constructing the document term matrix? If <code>TRUE</code>,
the default:
</p>

<ul>
<li>
<p> The corporaexplorer object will be lighter and most searches in
the corpus exploration app will be faster.
</p>
</li>
<li>
<p> Searches including punctuation and digits will be carried out in
the full text documents.
</p>
</li>
<li>
<p> The only "risk" with this strategy is that the corpus exploration
app in some cases can produce false positives. E.g. searching for the
term "donkey" will also find the term "don%key".
This should not be a problem for the vast majority of use cases, but if
one so desires, there are three different solutions: set this parameter to
<code>FALSE</code>, create a corporaexplorerobject without a matrix by setting
the <code>use_matrix</code> parameter to <code>FALSE</code>, or run
<code>explore</code> with the
<code>use_matrix</code> parameter set to <code>FALSE</code>.
</p>
</li>
</ul>
<p>If <code>FALSE</code>, the corporaexplorer object will be larger, and most
simple searches will be slower.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tile_length_range</code></td>
<td>
<p>Numeric vector of length two.
Fine-tune the tile lengths in document wall
and day corpus view. Tile length is calculated by
<code>scales::rescale(nchar(dataset[[text_column]]),
to = tile_length_range,
from = c(0, max(.)))</code>
Default is <code>c(1, 10)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>columns_for_ui_checkboxes</code></td>
<td>
<p>Character. Character or factor column(s) in dataset.
Include sets of checkboxes in the app sidebar for
convenient filtering of corpus.
Typical useful for columns with a small set of unique
(and short) values.
Checkboxes will be arranged by <code>sort()</code>,
unless <code>columns_for_ui_checkboxes</code>
is a vector of factors, in which case the order will be according to
factor level order (easy relevelling with <code>forcats::fct_relevel()</code>).
To use a different
label in the sidebar than the columnn name,
simply pass a named character vector to <code>columns_for_ui_checkboxes</code>.
If <code>columns_for_ui_checkboxes</code> includes a column which is not
present in dataset, it will be ignored.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For data.frame: Each row in <code>dataset</code> is treated as a base differentiating unit in the corpus,
typically chapters in books, or a single document in document collections.
The following column names are reserved and cannot be used in <code>dataset</code>:
"Date_",
"cx_ID",
"Text_original_case",
"Text_column_",
"Tile_length",
"Year_",
"cx_Seq",
"Weekday_n",
"Day_without_docs",
"Invisible_fake_date",
"Tile_length".
</p>
<p>A character vector will be converted to a simple corporaexplorerobject
with no metadata.
</p>


<h3>Value</h3>

<p>A <code>corporaexplorer</code> object to be passed as argument to
<code>explore</code> and
<code>run_document_extractor</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## From data.frame
# Constructing test data frame:
dates &lt;- as.Date(paste(2011:2020, 1:10, 21:30, sep = "-"))
texts &lt;- paste0(
  "This is a document about ", month.name[1:10], ". ",
  "This is not a document about ", rev(month.name[1:10]), "."
)
titles &lt;- paste("Text", 1:10)
test_df &lt;- tibble::tibble(Date = dates, Text = texts, Title = titles)

# Converting to corporaexplorerobject:
corpus &lt;- prepare_data(test_df, corpus_name = "Test corpus")

if(interactive()){
# Running exploration app:
explore(corpus)

# Running app to extract documents:
run_document_extractor(corpus)
}

## From character vector
alphabet_corpus &lt;- prepare_data(LETTERS)

if(interactive()){
# Running exploration app:
explore(alphabet_corpus)
}
</code></pre>


</div>