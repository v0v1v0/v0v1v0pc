<div class="container">

<table style="width: 100%;"><tr>
<td>pwCheck</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculates the number of measurements that can be made between two lineages for each pairwise comparison within a set of putatively convergent tips (group identity may also be taken into account). Useful for determining which comparisons are not informative, and constructing a group object before running calcConvCt or convSigCt.</h2>

<h3>Description</h3>

<p>pwCheck Calculates the number of measurements that can be made between two lineages for each pairwise comparison within a set of putatively convergent tips (group identity may also be taken into account). Useful for determining which comparisons are not informative, and constructing a group object before running calcConvCt or convSigCt.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pwCheck(phy, focaltaxa, groups = NULL, conservative = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phy</code></td>
<td>
<p>The time calibrated phylogeny of interest in phylo format</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>focaltaxa</code></td>
<td>
<p>a vector of tip labels for the putatively convergent taxa to be compared</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>an optional vector of groups with names matching focaltaxa. Indicates the group identity of all putatively convergent taxa and limits Ct measures to intergroup comparisons only</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conservative</code></td>
<td>
<p>logical value indicating whether candidate nodes for measurement of Dmax.t should be restricted to occurr before the oldest stem lineage of the two groups involved in each pairwise comparison. Stem lineage age for each group is defined as the height of the parent node of the branch subtending the most recent common ancestor of tips within a group. Where groups include a single tip, the parent node of the tip's subtending branch is used. Requires group object to be provided by user.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of the following components:
</p>
<p>taxa a matrix of uninformative tip comparisons
</p>
<p>path a vector with the number of measurements for all pairwise comparisons - a summary of this is also printed when running the function
</p>


<h3>References</h3>

<p>Grossnickle DM, Brightly WH, Weaver LN, Stanchak KE, Roston RA, Pevsner SK, Stayton CT, Polly PD, Law CJ. 2022. A cautionary note on quantitative measures of phenotypic convergence. in revision
Zelditch ML, Ye J, Mitchell JS, Swiderski DL. 2017. Rare ecomorphological convergence on a complex adaptive landscape: Body size and diet mediate evolution of jaw shape in squirrels (Sciuridae). Evolution 71: 633-649
Stayton CT. 2015. The definition, recognition, and interpretation of convergent evolution and two new measures for quantifying and assessing the significance of convergence. Evolution 69(8): 2140-2153.
Revell, L. J. (2012) phytools: An R package for phylogenetic comparative biology (and other things). Methods Ecol. Evol., 3, 217-223.
Felsenstein, J. 1985. Phylogenies and the comparative method. American Naturalist, 125, 1-15.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library(phytools)
library(geiger)

# create time calibrated tree
mytree&lt;-rtree(100)
mycalibration &lt;- makeChronosCalib(mytree, node="root", age.max=50)
phy &lt;- chronos(mytree, lambda = 1, model = "correlated", calibration = mycalibration, 
control = chronos.control() )
class(phy)&lt;-"phylo"

# create three normally distributed phenotypic traits
traits &lt;- cbind(rnorm(Ntip(phy)),rnorm(Ntip(phy)),rnorm(Ntip(phy)))
rownames(traits) &lt;- phy$tip.label

#	select two random tips, excluding sister taxa
pairs &lt;- apply(combn(phy$tip.label,2),2,function(x) nodepath(phy,which(phy$tip.label == x[1]),
which(phy$tip.label == x[2])))
nosis &lt;- combn(phy$tip.label,2)[,unlist(lapply(pairs, function(x) length(x) &gt; 3))]
focaltaxa &lt;- nosis[,sample(1:ncol(nosis),1)]

pwCheck(phy,focaltaxa)

## End(Not run)
</code></pre>


</div>