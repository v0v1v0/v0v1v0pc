<div class="container">

<table style="width: 100%;"><tr>
<td>lateonset.simu</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Conduct one simulation using the calibration-free odds type (CFO-type) design with late-onset toxicity for phase I trials.</h2>

<h3>Description</h3>

<p>Based on the toxicity outcomes of the enrolled cohorts, the function is used to conduct one single simulation and find the
maximum tolerated dose (MTD) for the CFO-type designs with late-onset toxicities for phase I trials, specifically,
including time-to-event CFO (TITE-CFO) design, fractional CFO (fCFO) design, benchmark CFO design,
time-to-event accumulative CFO (TITE-aCFO) design, fractional accumulative CFO (f-aCFO) design and benchmark aCFO design.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lateonset.simu(design, target, p.true, init.level = 1, ncohort, cohortsize,
       assess.window, tte.para, accrual.rate, accrual.dist,  
       prior.para = list(alp.prior = target, bet.prior = 1 - target), 
       cutoff.eli = 0.95, early.stop = 0.95, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>
<p>option for selecting different designs, which can be set as <code>'TITE-CFO'</code>, <code>'TITE-aCFO'</code>,
<code>'fCFO'</code>, <code>'f-aCFO'</code>, <code>'bCFO'</code>, and <code>'b-aCFO'</code>. Specifically, <code>'bCFO'</code> refers
to the benchmark CFO design, and <code>'b-aCFO'</code> denotes the benchmark aCFO design.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>
<p>the target DLT rate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.true</code></td>
<td>
<p>the true DLT rates under the different dose levels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init.level</code></td>
<td>
<p>the dose level assigned to the first cohort. The default value <code>init.level</code> is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncohort</code></td>
<td>
<p>the total number of cohorts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cohortsize</code></td>
<td>
<p>the number of patients of each cohort.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>assess.window</code></td>
<td>
<p>the maximal assessment window size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tte.para</code></td>
<td>
<p>the parameter related with the distribution of the time to DLT events. The time to DLT is sampled from a Weibull
distribution, with <code>tte.para</code> representing the proportion of DLTs occurring within the first half of the
assessment window.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accrual.rate</code></td>
<td>
<p>the accrual.rate rate, i.e., the number of patients accrued per unit time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accrual.dist</code></td>
<td>
<p>the distribution of the arrival times of patients. When <code>accrual.dist = 'fix'</code>, it corresponds to all
patients in each cohort arriving simultaneously at a given accrual rate. When <code>accrual.dist = 'unif'</code>,
it corresponds to a uniform distribution, and when <code>accrual.dist = 'exp'</code>, it corresponds to an
exponential distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior.para</code></td>
<td>
<p>the prior parameters for a beta distribution, where set as <code>list(alp.prior = target, bet.prior = 1 - target)</code>
by default, <code>alp.prior</code> and <code>bet.prior</code> represent the parameters of the prior distribution for
the true DLT rate at any dose level. This prior distribution is specified as Beta(<code>alpha.prior</code>, <code>beta.prior</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff.eli</code></td>
<td>
<p>the cutoff to eliminate overly toxic doses for safety. We recommend
the default value of <code>cutoff.eli = 0.95</code> for general use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>early.stop</code></td>
<td>
<p>the threshold value for early stopping. The default value <code>early.stop = 0.95</code>
generally works well.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>an integer to set as the seed of the random number generator for reproducible results. The default value is set to NULL.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The <code>lateonset.simu()</code> function returns a list object comprising the following components:
</p>

<ul>
<li>
<p> target: the target DLT rate.
</p>
</li>
<li>
<p> MTD: the selected MTD. <code>MTD = 99</code> indicates that this trial is terminated due to early stopping.
</p>
</li>
<li>
<p> correct: a binary indicator of whether the recommended dose level matches the correct MTD (1 for yes).
The correct MTD is the dose level at which the true DLT rate is closest to the target DLT rate.
</p>
</li>
<li>
<p> npatients: the total number of patients allocated to all dose levels
</p>
</li>
<li>
<p> ntox: the total number of DLTs observed for all dose levels.
</p>
</li>
<li>
<p> over.doses: a vector indicating whether each dose is overdosed or not (1 for yes).
</p>
</li>
<li>
<p> cohortdose: a vector including the dose level assigned to each cohort.
</p>
</li>
<li>
<p> ptoxic: the percentage of subjects assigned to dose levels with a DLT rate greater than the target.
</p>
</li>
<li>
<p> patientDLT: a vector including the DLT outcome observed for each patient.
</p>
</li>
<li>
<p> sumDLT: the total number of DLT observed.
</p>
</li>
<li>
<p> earlystop: a binary indicator of whether the trial is early stopped (1 for yes).
</p>
</li>
<li>
<p> totaltime: the duration of the trial.
</p>
</li>
<li>
<p> entertimes: the time that each participant enters the trial.
</p>
</li>
<li>
<p> DLT.times: the time to DLT for each subject in the trial. If no DLT occurs for a certain subject,
<code>DLT.times</code> is 0.
</p>
</li>
</ul>
<h3>Note</h3>

<p>The early stopping and dose elimination rules are incorporated into the design
to ensure patient safety and benefit.
</p>


<h3>Author(s)</h3>

<p>Jialu Fang, Wenliang Wang, Ninghao Zhang, and Guosheng Yin
</p>


<h3>References</h3>

<p>Jin H, Yin G (2022). CFO: Calibration-free odds design for phase I/II clinical trials.
<em>Statistical Methods in Medical Research</em>, 31(6), 1051-1066. <br>
Jin H, Yin G (2023). Time‐to‐event calibration‐free odds design: A robust efficient design for
phase I trials with late‐onset outcomes. <em>Pharmaceutical Statistics</em>. 22(5), 773–783.<br>
Yin G, Zheng S, Xu J (2013). Fractional dose-finding methods with late-onset toxicity in
phase I clinical trials. <em>Journal of Biopharmaceutical Statistics</em>, 23(4), 856-870. <br>
Fang J, Yin G (2024). Fractional accumulative calibration‐free odds (f‐aCFO) design for delayed toxicity
in phase I clinical trials. <em>Statistics in Medicine</em>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">target &lt;- 0.2; ncohort &lt;- 12; cohortsize &lt;- 3; init.level &lt;- 1
p.true &lt;- c(0.01, 0.07, 0.20, 0.35, 0.50, 0.65, 0.80)
assess.window &lt;- 3; accrual.rate &lt;- 2; tte.para &lt;- 0.5; accrual.dist &lt;- 'unif'
## find the MTD for a single TITE-CFO simulation
TITECFOtrial &lt;- lateonset.simu (design = 'TITE-CFO', target, p.true, init.level,  
                ncohort, cohortsize, assess.window, tte.para, accrual.rate, accrual.dist, seed = 1)
summary(TITECFOtrial)
plot(TITECFOtrial)
## find the MTD for a single TITE-aCFO simulation
TITEaCFOtrial &lt;- lateonset.simu (design = 'TITE-aCFO', target, p.true, init.level,  
                ncohort, cohortsize, assess.window, tte.para, accrual.rate, accrual.dist, seed = 1)
summary(TITEaCFOtrial)
plot(TITEaCFOtrial)
## find the MTD for a single fCFO simulation
fCFOtrial &lt;- lateonset.simu (design = 'fCFO', target, p.true, init.level,  
                ncohort, cohortsize, assess.window, tte.para, accrual.rate, accrual.dist, seed = 1)
summary(fCFOtrial)
plot(fCFOtrial)
## find the MTD for a single f-aCFO simulation
faCFOtrial &lt;- lateonset.simu (design = 'f-aCFO', target, p.true, init.level,  
                ncohort, cohortsize, assess.window, tte.para, accrual.rate, accrual.dist, seed = 1)
summary(faCFOtrial)
plot(faCFOtrial)
</code></pre>


</div>