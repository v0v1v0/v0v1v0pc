<div class="container">

<table style="width: 100%;"><tr>
<td>WeatherRegime</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function for Calculating the Cluster analysis</h2>

<h3>Description</h3>

<p>This function computes the weather regimes from a cluster analysis.
It can be applied over the dataset with dimensions c(year/month, month/day, 
lon, lat), or by using PCs obtained from the application of the EOFs analysis 
to filter the dataset. The cluster analysis can be performed with the 
traditional k-means or those methods included in the hclust (stats package).
</p>


<h3>Usage</h3>

<pre><code class="language-R">WeatherRegime(
  data,
  ncenters = NULL,
  EOFs = TRUE,
  neofs = 30,
  varThreshold = NULL,
  lon = NULL,
  lat = NULL,
  method = "kmeans",
  iter.max = 100,
  nstart = 30,
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>An array containing anomalies with named dimensions with at least 
start date 'sdate', forecast time 'ftime', latitude 'lat' and longitude 
'lon'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncenters</code></td>
<td>
<p>Number of clusters to be calculated with the clustering 
function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EOFs</code></td>
<td>
<p>Whether to compute the EOFs (default = 'TRUE') or not (FALSE) to 
filter the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>neofs</code></td>
<td>
<p>Number of modes to be kept only if EOFs = TRUE has been selected. 
(default = 30).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varThreshold</code></td>
<td>
<p>Value with the percentage of variance to be explained by 
the PCs. Only sufficient PCs to explain this much variance will be used in 
the clustering.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lon</code></td>
<td>
<p>Vector of longitudes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lat</code></td>
<td>
<p>Vector of latitudes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Different options to estimate the clusters. The most traditional 
approach is the k-means analysis (default=’kmeans’) but the function also 
support the different methods included in the hclust . These methods are:
"ward.D", "ward.D2", "single", "complete", "average" (= UPGMA), "mcquitty" 
(= WPGMA), "median" (= WPGMC) or "centroid" (= UPGMC). For more details 
about these methods see the hclust function documentation included in the 
stats package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter.max</code></td>
<td>
<p>Parameter to select the maximum number of iterations allowed 
(Only if method = 'kmeans' is selected).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nstart</code></td>
<td>
<p>Parameter for the cluster analysis determining how many random 
sets to choose (Only if method='kmeans' is selected).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>The number of multicore threads to use for parallel computation.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with elements <code>$composite</code> (array with at least 3-d ('lat', 
'lon', 'cluster') containing the composites k = 1,..,K for case (*1) or only k = 1 
for any specific cluster, i.e., case (*2)), <code>pvalue</code> (array with at least 
3-d ('lat','lon','cluster') with the pvalue of the composites obtained through 
a t-test that accounts for the serial dependence of the data with the same 
structure as Composite.), <code>cluster</code> (A matrix or vector with integers 
(from 1:k) indicating the cluster to which each time step is allocated.),
<code>persistence</code> (Percentage of days in a month/season before a cluster is 
replaced for a new one (only if method=’kmeans’ has been selected.)),
<code>frequency</code> (Percentage of days in a month/season belonging to each 
cluster (only if method=’kmeans’ has been selected).),
</p>


<h3>Author(s)</h3>

<p>Verónica Torralba - BSC, <a href="mailto:veronica.torralba@bsc.es">veronica.torralba@bsc.es</a>
</p>


<h3>References</h3>

<p>Cortesi, N., V., Torralba, N., González-Reviriego, A., Soret, and 
F.J., Doblas-Reyes (2019). Characterization of European wind speed variability 
using weather regimes. Climate Dynamics,53, 4961–4976, 
doi: <a href="https://doi.org/10.1007/s00382-019-04839-5">10.1007/s00382-019-04839-5</a>.
</p>
<p>Torralba, V. (2019) Seasonal climate prediction for the wind 
energy sector: methods and tools for the development of a climate service. 
Thesis. Available online: <a href="https://eprints.ucm.es/56841/">https://eprints.ucm.es/56841/</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data &lt;- array(abs(rnorm(1280, 283.7, 6)), dim = c(dataset = 2, member = 2,  
                                                 sdate = 3, ftime = 3, 
                                                 lat = 4, lon = 4))
lat &lt;- seq(47, 44)
res &lt;- WeatherRegime(data = data, lat = lat,  
                    EOFs = FALSE, ncenters = 4)
</code></pre>


</div>