<div class="container">

<table style="width: 100%;"><tr>
<td>ptest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Permutation test for group differences at within-subject levels</h2>

<h3>Description</h3>

<p>Perform permutation tests for differences between two groups at given within-subject levels in a long-formatted dataframe
</p>


<h3>Usage</h3>

<pre><code class="language-R">ptest(
  data,
  outcome,
  within,
  between,
  at.within,
  at.between,
  pn = 1000,
  progress.bar = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>dataframe that contains the data in long format.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outcome</code></td>
<td>
<p>outcome variable (i.e., the variable for which the difference should be tested).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>within</code></td>
<td>
<p>within-subject variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>between</code></td>
<td>
<p>between-subjects variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>at.within</code></td>
<td>
<p>determine for which within-subject levels (e.g., which timepoint) the difference should be tested.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>at.between</code></td>
<td>
<p>determine the groups in the difference test (should always be of length 2).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pn</code></td>
<td>
<p>the number of permutations that should be performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress.bar</code></td>
<td>
<p>indicates whether a progress bar will be shown.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In every permutation cycle, the outcome variable gets permutated and the Welch t test statistic is calculated.
</p>


<h3>Value</h3>

<p><code>ptest</code> produces an object of class <code>"clusbootptest"</code>, containing the following relevant components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>perm.statistics</code></td>
<td>
<p>A matrix of <code>length(at.within)</code> rows and <code>pn</code> columns, containing the Welch t-test statics for all permutations within the <code>at.within</code> level in the columns. The first column contains the t statistic for the observed data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalues</code></td>
<td>
<p>Data frame containing the p values for every <code>at.within</code> level.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Mathijs Deen, Mark de Rooij
</p>


<h3>See Also</h3>

<p>A useful method for the obtained <code>clusbootptest</code> class object is <code>plot.clusbootptest</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
medication &lt;- medication[medication$time %% 1 == 0,]
set.seed(1)
permtest.1 &lt;- ptest(data = meds, outcome = pos, within = time, between = treat, 
                    at.within = c(0,2,4,6), at.between = c(0,1), pn = 2000)
permtest.1$pvalues
## End(Not run)
</code></pre>


</div>