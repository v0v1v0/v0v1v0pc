<div class="container">

<table style="width: 100%;"><tr>
<td>clupaSpectra</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Hierarchical Cluster-Based Peak Alignment on a Spectra Object</h2>

<h3>Description</h3>

<p>This function is a wrapper to several functions in the <span class="pkg">speaq</span> package.
It implements the CluPA algorithm described in the reference.
</p>


<h3>Usage</h3>

<pre><code class="language-R">clupaSpectra(spectra, bT = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>spectra</code></td>
<td>
<p>An object of S3 class <code>Spectra()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bT</code></td>
<td>
<p>Numeric.  The baseline threshold. Defaults to five percent of the
range of the data, in <code>spectra$data</code>.  Passed to
<code>detectSpecPeaks</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments to be passed to the underlying functions.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A modifed <code>Spectra</code> object.
</p>


<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University).
</p>


<h3>References</h3>

<p>Vu TN, Valkenborg D, Smets K, Verwaest KA, Dommisse R, Lemiere F, Verschoren
A, Goethals B, Laukens K. "An integrated workflow for robust alignment and
simplified quantitative analysis of NMR spectrometry data" BMC
Bioinformatics vol. 12 pg. 405 (2011).
</p>


<h3>See Also</h3>

<p>Additional documentation at <a href="https://bryanhanson.github.io/ChemoSpec/">https://bryanhanson.github.io/ChemoSpec/</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># You need to install package speaq for this example
# This example assumes the graphics output is set to ggplot2 (see ?GraphicsOptions).
if (requireNamespace("speaq", quietly = TRUE)) {
  library("ggplot2")
  data(alignMUD)

  p1 &lt;- plotSpectra(alignMUD, which = 1:20, lab.pos = 4.5, offset = 0.1,
    yrange = c(0, 5000), amp = 500)
  p1 &lt;- p1 + ggtitle("Misaligned NMR Spectra") +
    coord_cartesian(xlim = c(1.5, 1.8), ylim = c(0, 1900))
  p1

  aMUD &lt;- clupaSpectra(alignMUD)

  p2 &lt;- plotSpectra(aMUD, which = 1:20, lab.pos = 4.5, offset = 0.1,
    yrange = c(0, 5000), amp = 500)
  p2 &lt;- p2 +  ggtitle("Aligned NMR Spectra") +
    coord_cartesian(xlim = c(1.5, 1.8), ylim = c(0, 1900))
  p2
}

</code></pre>


</div>