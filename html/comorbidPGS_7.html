<div class="container">

<table style="width: 100%;"><tr>
<td>multiassoc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multiple PGS Associations from a Data Frame</h2>

<h3>Description</h3>

<p><code>multiassoc()</code> take a data frame with distribution(s) of PGS and Phenotype(s),
and a table of associations to make from this data frame
</p>
<p>return a data frame showing the association results
</p>


<h3>Usage</h3>

<pre><code class="language-R">multiassoc(
  df = NULL,
  assoc_table = NULL,
  scale = TRUE,
  covar_col = NA,
  verbose = TRUE,
  log = "",
  parallel = FALSE,
  num_cores = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>a dataframe with individuals on each row, and at least the following
columns:
</p>

<ul>
<li>
<p> one ID column,
</p>
</li>
<li>
<p> one PGS column, with numerical continuous values following a normal distribution,
</p>
</li>
<li>
<p> one Phenotype column, can be numeric (Continuous Phenotype), character, boolean or factors (Discrete Phenotype)
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>assoc_table</code></td>
<td>
<p>a dataframe or matrix specifying the associations to
make from df, with 2 columns: PGS and Phenotype (in this order)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>a boolean specifying if scaling of PGS should be done before testing</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covar_col</code></td>
<td>
<p>a character vector specifying the covariate column names (facultative)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>a boolean (TRUE by default) to write in the console/log messages.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>a connection, or a character string naming the file to print to.
If "" (by default), it prints to the standard output connection, the console unless redirected by sink.
If parallel = TRUE, the log will be incomplete</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>a boolean, if TRUE, <code>multiassoc()</code> parallelise the association analysis to run it faster (no log available with this option, does not work with Windows machine)
If FALSE (default), the association analysis will not be parallelised (useful for debugging process)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_cores</code></td>
<td>
<p>an integer, if parallel = TRUE (default), <code>multiassoc()</code> parallelise the association analysis to run it faster using num_cores as the number of cores.
If nothing is provided, it detects the number of cores of the machine and use num_cores-1</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>return a data frame showing the association of the PGS(s) on the Phenotype(s)
with the following columns:
</p>

<ul>
<li>
<p> PGS: the name of the PGS
</p>
</li>
<li>
<p> Phenotype: the name of Phenotype
</p>
</li>
<li>
<p> Phenotype_type: either <code>'Continuous'</code>, <code>'Ordered Categorical'</code>, <code>'Categorical'</code> or <code>'Cases/Controls'</code>
</p>
</li>
<li>
<p> Stat_method: association function detects what is the phenotype type and what is the best way to analyse it, either <code>'Linear regression'</code>, <code>'Binary logistic regression'</code>, <code>'Ordinal logistic regression'</code> or <code>'Multinomial logistic regression'</code>
</p>
</li>
<li>
<p> Covar: list all the covariates used for this association
</p>
</li>
<li>
<p> N_cases: if Phenotype_type is Cases/Controls, gives the number of cases
</p>
</li>
<li>
<p> N_controls: if Phenotype_type is Cases/Controls, gives the number of controls
</p>
</li>
<li>
<p> N: the number of individuals/samples
</p>
</li>
<li>
<p> Effect: if Phenotype_type is Continuous, it represents the Beta coefficient of linear regression, OR of logistic regression otherwise
</p>
</li>
<li>
<p> SE: standard error of the related Effect (Beta or OR)
</p>
</li>
<li>
<p> lower_CI: lower confidence interval of the related Effect (Beta or OR)
</p>
</li>
<li>
<p> upper_CI: upper confidence interval of the related Effect (Beta or OR)
</p>
</li>
<li>
<p> P_value: associated P-value
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">assoc_table &lt;- expand.grid(
  c("t2d_PGS", "ldl_PGS"),
  c("ethnicity","brc","t2d","log_ldl","sbp_cat")
)
results &lt;- multiassoc(
  df = comorbidData,
  assoc_table = assoc_table,
  covar_col = c("age", "sex", "gen_array"),
  parallel = FALSE,
  verbose = FALSE
)
print(results)

</code></pre>


</div>