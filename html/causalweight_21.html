<div class="container">

<table style="width: 100%;"><tr>
<td>RDDcovar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sharp regression discontinuity design conditional on covariates</h2>

<h3>Description</h3>

<p>Nonparametric (kernel regression-based) sharp regression discontinuity controlling for covariates that are permitted to jointly affect the treatment assignment and the outcome at the threshold of the running variable, see Frölich and Huber (2019).
</p>


<h3>Usage</h3>

<pre><code class="language-R">RDDcovar(
  y,
  z,
  x,
  boot = 1999,
  bw0 = NULL,
  bw1 = NULL,
  regtype = "ll",
  bwz = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Dependent variable, must not contain missings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>Running variable. Must be coded such that the treatment is zero for <code>z</code> being smaller than zero and one for <code>z</code> being larger than or equal to zero. Must not contain missings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Covariates, must not contain missings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot</code></td>
<td>
<p>Number of bootstrap replications for estimating standard errors. Default is 1999.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw0</code></td>
<td>
<p>Bandwidth for a kernel regression of <code>y</code> on <code>z</code> and <code>x</code> below the threshold (for treatment equal to zero), using the Epanechnikov kernel. Default is <code>NULL</code>, implying that the bandwidth is estimated by least squares cross-validation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw1</code></td>
<td>
<p>Bandwidth for a kernel regression of <code>y</code> on <code>z</code> and <code>x</code> above the threshold (for treatment equal to one), using the Epanechnikov kernel. Default is <code>NULL</code>, implying that the bandwidth is estimated by least squares cross-validation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>regtype</code></td>
<td>
<p>Defines the type of the kernel regressions of <code>y</code> on <code>z</code> and <code>x</code> below and above the threshold.  Must either be set to <code>"ll"</code> for local linear regression or to <code>"ll"</code> for local constant regression. Default is <code>"ll"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bwz</code></td>
<td>
<p>Bandwidth for the (Epanechnikov) kernel function on <code>z</code>. Default is <code>NULL</code>, implying that the bandwidth is estimated by least squares cross-validation.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Sharp regression discontinuity design conditional on covariates to control for observed confounders jointly affecting the treatment assignment and outcome at the threshold of the running variable as discussed in Frölich and Huber (2019). This is implemented by running kernel regressions of the outcome on the running variable and the covariates separately above and below the threshold and by applying a kernel smoother to the running variable around the threshold. The procedure permits choosing kernel bandwidths by cross-validation, even though this does in general not yield the optimal bandwidths for treatment effect estimation (checking the robustness of the results by varying the bandwidths is therefore highly recommended). Standard errors are based on bootstrapping.
</p>


<h3>Value</h3>

<p><code>effect</code>: Estimated treatment effect at the threshold.
</p>
<p><code>se</code>: Bootstrap-based standard error of the effect estimate.
</p>
<p><code>pvalue</code>: P-value based on the t-statistic.
</p>
<p><code>bw0</code>: Bandwidth for kernel regression of <code>y</code> on <code>z</code> and <code>x</code> below the threshold (for treatment equal to zero).
</p>
<p><code>bw1</code>: Bandwidth for kernel regression of <code>y</code> on <code>z</code> and <code>x</code> above the threshold (for treatment equal to one).
</p>
<p><code>bwz</code>: Bandwidth for the kernel function on <code>z</code>.
</p>


<h3>References</h3>

<p>Frölich, M. and Huber, M. (2019): "Including covariates in the regression discontinuity design", Journal of Business &amp; Economic Statistics, 37, 736-748.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# load unemployment duration data
data(ubduration)
# run sharp RDD conditional on covariates with user-defined bandwidths
output=RDDcovar(y=ubduration[,1],z=ubduration[,2],x=ubduration[,c(-1,-2)],
 bw0=c(0.17, 1, 0.01, 0.05, 0.54, 70000, 0.12, 0.91, 100000),
 bw1=c(0.59, 0.65, 0.30, 0.06, 0.81, 0.04, 0.12, 0.76, 1.03),bwz=0.2,boot=19)
cat("RDD effect estimate: ",round(c(output$effect),3),", standard error: ",
 round(c(output$se),3), ", p-value: ", round(c(output$pvalue),3))
## End(Not run)
</code></pre>


</div>