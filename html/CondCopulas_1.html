<div class="container">

<table style="width: 100%;"><tr>
<td>bCond.estParamCopula</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimation of the conditional parameters of a parametric conditional
copula with discrete conditioning events.</h2>

<h3>Description</h3>

<p>By Sklar's theorem, any conditional distribution function
can be written as
</p>
<p style="text-align: center;"><code class="reqn">F_{1,2|A}(x_1, x_2) = c_{1,2|A}(F_{1|A}(x_1), F_{2,A}(x_2)),</code>
</p>

<p>where <code class="reqn">A</code> is an event and
<code class="reqn">c_{1,2|A}</code> is a copula depending on the event <code class="reqn">A</code>.
In this function, we assume that we have a partition <code class="reqn">A_1,... A_p</code>
of the probability space, and that for each <code class="reqn">k=1,...,p</code>,
the conditional copula is parametric according to the following model
</p>
<p style="text-align: center;"><code class="reqn">c_{1,2|Ak} = c_{\theta(Ak)},</code>
</p>

<p>for some parameter <code class="reqn">\theta(Ak)</code> depending on the realized event <code class="reqn">Ak</code>.
This function uses canonical maximum likelihood to estimate
<code class="reqn">\theta(Ak)</code> and the corresponding copulas <code class="reqn">c_{1,2|Ak}</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bCond.estParamCopula(U1, U2, family, partition)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>U1</code></td>
<td>
<p>vector of <code>n</code> conditional pseudo-observations
of the first conditioned variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>U2</code></td>
<td>
<p>vector of <code>n</code> conditional pseudo-observations
of the second conditioned variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>the family of conditional copulas
used for each conditioning event <code class="reqn">A_k</code>. If not of length <code class="reqn">p</code>,
it is recycled to match the number of events <code class="reqn">p</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>partition</code></td>
<td>
<p>matrix of size <code>n * p</code>,
where <code>p</code> is the number of conditioning events that are considered.
partition[i,j] should be the indicator of whether the <code>i</code>-th observation
belongs or not to the <code>j</code>-th conditioning event</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list of size <code>p</code> containing the <code>p</code> conditional copulas
</p>


<h3>References</h3>

<p>Derumigny, A., &amp; Fermanian, J. D. (2017).
About tests of the “simplifying” assumption for conditional copulas.
Dependence Modeling, 5(1), 154-197.
<a href="https://doi.org/10.1515/demo-2017-0011">doi:10.1515/demo-2017-0011</a>
</p>
<p>Derumigny, A., &amp; Fermanian, J. D. (2022)
Conditional empirical copula processes and generalized dependence measures
Electronic Journal of Statistics, 16(2), 5692-5719.
<a href="https://doi.org/10.1214/22-EJS2075">doi:10.1214/22-EJS2075</a>
</p>


<h3>See Also</h3>

<p><code>bCond.pobs</code> for the computation
of (conditional) pseudo-observations in this framework.
</p>
<p><code>bCond.simpA.param</code> for a test of the simplifying assumption
that all these conditional copulas are equal
(assuming they all belong to the same parametric family).
<code>bCond.simpA.CKT</code> for a test of the simplifying assumption
that all these conditional copulas are equal,
based on the equality of conditional Kendall's tau.
</p>


<h3>Examples</h3>

<pre><code class="language-R">n = 800
Z = stats::runif(n = n)
CKT = 0.2 * as.numeric(Z &lt;= 0.3) +
  0.5 * as.numeric(Z &gt; 0.3 &amp; Z &lt;= 0.5) +
  - 0.8 * as.numeric(Z &gt; 0.5)
simCopula = VineCopula::BiCopSim(N = n,
  par = VineCopula::BiCopTau2Par(CKT, family = 1), family = 1)
X1 = simCopula[,1]
X2 = simCopula[,2]
partition = cbind(Z &lt;= 0.3, Z &gt; 0.3 &amp; Z &lt;= 0.5, Z &gt; 0.5)
condPseudoObs = bCond.pobs(X = cbind(X1, X2), partition = partition)

estimatedCondCopulas = bCond.estParamCopula(
  U1 = condPseudoObs[,1], U2 = condPseudoObs[,2],
  family = 1, partition = partition)
print(estimatedCondCopulas)
# Comparison with the true conditional parameters: 0.2, 0.5, -0.8.


</code></pre>


</div>