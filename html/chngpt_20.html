<div class="container">

<table style="width: 100%;"><tr>
<td>chngpt.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Threshold Model Hypothesis Testing
</h2>

<h3>Description</h3>

<p>Hypothesis testing for threshold models. Only linear models and logistic models are supported at this point.
</p>


<h3>Usage</h3>

<pre><code class="language-R">
chngpt.test (formula.null, formula.chngpt, family=c("binomial","gaussian"), data, 
    type=c("step","hinge","segmented","stegmented"),
    test.statistic=c("lr","score"), # support for score is gradually descreasing
    chngpts=NULL, lb.quantile=.1, ub.quantile=.9, 
    chngpts.cnt=50, #this is set to 25 if int is weighted.two.sided or weighted.one.sided
    prec.weights=NULL,
    p.val.method=c("MC","param.boot"), 
    mc.n=5e4, # 1e3 won't cut it, the p values estimated could be smaller than nominal
    boot.B=1e4,
    robust=FALSE,
    keep.fits=FALSE, verbose=FALSE
) 


antoch.test (formula, data, chngpt.var, plot.=FALSE)

## S3 method for class 'chngpt.test'
plot(x, by.percentile=TRUE, both=FALSE, main=NULL, ...) 

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula.null</code></td>
<td>

<p>formula for the null model. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula.chngpt</code></td>
<td>

<p>formula for the change point model. 
For example, suppose formula.null=y~z and we want to test whether I(x&gt;cutff) is a significant predictor, formula.chngpt=~x
If instead we are interested in testing the null that neither I(x&gt;cutff) nor z*I(x&gt;cutff) is a significant predictor, formula.chngpt=~x*z
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>Currently only linear and logistic regression are supported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>step: flat before and after change point; hinge: flat before and slope after change point; segmented: slope before and after change point</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test.statistic</code></td>
<td>
<p>method for testing main effects of some threshold model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chngpts</code></td>
<td>

<p>A grid of potential change points to maximize over. If not supplied, they will be 
set to a vector of length chngpt.cnt equally spaced between lb.quantile and ub.quantile.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust</code></td>
<td>

<p>Boolean.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lb.quantile</code></td>
<td>

<p>number. The lower bound in the search for change point in the unit of quantile.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ub.quantile</code></td>
<td>

<p>number. The upper bound in the search for change point in the unit of quantile.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chngpts.cnt</code></td>
<td>

<p>integer. Number of potential change points to maximize over.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mc.n</code></td>
<td>

<p>integer. Number of multivariate normal samples to generate in the Monte Carlo procedure to evaluate p-value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>Boolean. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chngpt.var</code></td>
<td>

<p>string. Name of the predictor to detect change point
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.</code></td>
<td>

<p>Boolean. Whether to make a plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>

<p>formula.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>An object of type chngpt.test. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments passed to or from methods</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by.percentile</code></td>
<td>

<p>tbd
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>both</code></td>
<td>

<p>tbd
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>

<p>tbd
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prec.weights</code></td>
<td>

<p>tbd
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.val.method</code></td>
<td>

<p>tbd
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot.B</code></td>
<td>

<p>tbd
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep.fits</code></td>
<td>

<p>tbd
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The model under the altnerative is the model under the null plus terms involving the threshold. For example, when the type is segmented and formula.null=~z, formula.chngpt=~x, the model under the null is ~z+x and the model under the alternative is ~z+x+(x-e)_+.
</p>
<p>If there are missing values in the chngpt formula, those rows will be removed from the whole dataset, including null model and chngpt model.
</p>
<p>antoch.test is only implemented for main effect only and is based on Antoch et al. (2004). Also see Fong et al. (2014).
</p>


<h3>Value</h3>

<p>A list of class htest and chngpt.test
</p>
<table>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>P-value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>Family from input</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Method from input</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Fong, Y., Huang, Y., Gilbert, P., Permar S. (2017) chngpt: threshold regression model estimation and inference, BMC Bioinformatics, 18(1):454.
</p>
<p>Fong Y, Di C, and Permar S. (2015) Change-Point Testing in Logistic Regression Models with Interaction Term. Statistics in Medicine. 34:1483â€“1494
</p>
<p>Pastor-Barriuso, R. and Guallar, E. and Coresh, J. (2003) Transition models for change-point estimation in logistic regression. Statistics in Medicine. 22:13141
</p>
<p>Antoch, J. and Gregoire, G. and Jaruskova, D. (2004) Detection of structural changes in generalized linear models. Statistics and probability letters. 69:315
</p>


<h3>Examples</h3>

<pre><code class="language-R">

dat=sim.chngpt("thresholded", "step", n=200, seed=1, beta=1, alpha=-1, x.distr="norm", e.=4, 
    family="binomial")
test=chngpt.test(formula.null=y~z, formula.chngpt=~x, dat, type="step", family="binomial",
    mc.n=10)
test
plot(test)

dat=sim.chngpt("thresholded", "segmented", n=200, seed=1, beta=1, alpha=-1, x.distr="norm", e.=4,
    family="binomial")
test=chngpt.test(formula.null=y~z, formula.chngpt=~x, dat, type="segmented", family="binomial",
    mc.n=10)
test
plot(test)

test = chngpt.test (formula.null=Volume~1, formula.chngpt=~Girth, family="gaussian", data=trees, 
    type="segmented", mc.n=1e4, verbose=FALSE, chngpts.cnt=100, test.statistic="lr")
test
plot(test)


## Not run: 
# not run because otherwise the examples take &gt;5s and that is a problem for R CMD check

# has interaction
test = chngpt.test(formula.null=y~z, formula.chngpt=~x*z, dat, type="step", family="binomial")
test
plot(test)


## End(Not run)


</code></pre>


</div>