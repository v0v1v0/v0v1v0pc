<div class="container">

<table style="width: 100%;"><tr>
<td>lm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Linear Model Fitting for Complex or Numeric Variables</h2>

<h3>Description</h3>

<p>An adaptation of lm that is compatible with complex variables. If the response is not complex, it calls the standard <code>stats::lm()</code>
Note: It is not capable of dealing with contrasts in the complex case.
The formula interpretation is also unable of handle algebraic expressions in <code>formula</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lm(
  formula,
  data,
  subset,
  weights,
  na.action,
  method = "qr",
  model = TRUE,
  x = TRUE,
  y = FALSE,
  qr = TRUE,
  singular.ok = TRUE,
  contrasts = NULL,
  offset,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class "formula" (or one that can be coerced to that class): a symbolic description of the model to be fitted.
For complex variables there are restrictions on what kinds of formula can be comprehended. See zmodel.matrix for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame, list or environment (or object
coercible by <code>as.data.frame</code> to a data frame) containing
the variables in the model.  If not found in <code>data</code>, the
variables are taken from <code>environment(formula)</code>,
typically the environment from which <code>lm</code> is called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional vector specifying a subset of observations
to be used in the fitting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>an optional vector of weights to be used in the fitting
process.  Should be <code>NULL</code> or a numeric vector.
If non-NULL, weighted least squares is used with weights
<code>weights</code> (that is, minimizing <code>sum(w*e^2)</code>); otherwise
ordinary least squares is used.  See also ‘Details’,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function which indicates what should happen
when the data contain <code>NA</code>s.  The default is set by
the <code>na.action</code> setting of <code>options</code>, and is
<code>na.fail</code> if that is unset.  The ‘factory-fresh’
default is <code>na.omit</code>.  Another possible value is
<code>NULL</code>, no action.  Value <code>na.exclude</code> can be useful.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the method to be used; for fitting, currently only
<code>method = "qr"</code> is supported; <code>method = "model.frame"</code> returns
the model frame (the same as with <code>model = TRUE</code>, see below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>logicals.  If <code>TRUE</code> the corresponding
components of the fit (the model frame, the model matrix, the
response, the QR decomposition) are returned.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>logical. If <code>TRUE</code> return the model matrix of the fit. Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>logicals.  If <code>TRUE</code> the corresponding
components of the fit (the model frame, the model matrix, the
response, the QR decomposition) are returned.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qr</code></td>
<td>
<p>logicals.  If <code>TRUE</code> the corresponding
components of the fit (the model frame, the model matrix, the
response, the QR decomposition) are returned.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>singular.ok</code></td>
<td>
<p>logical. If <code>FALSE</code> (the default in S but
not in <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>) a singular fit is an error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p>Not implemented for complex variables. See zmodel.matrix for details. Default is <code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>this can be used to specify an <em>a priori</em> known
component to be included in the linear predictor during fitting.
This should be <code>NULL</code> or a numeric vector or matrix of extents
matching those of the response.  One or more <code>offset</code> terms can be
included in the formula instead or as well, and if more than one are
specified their sum is used.  See <code>model.offset</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to be passed to the low level
regression fitting functions (see below).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Like stats::lm the models are specified symbolically using the standard R formula notation:
<code>response ~ terms</code>
Meaning <code>response</code> is a linear combination of the predictor variables in <code>terms</code>.
For compatibility with complex numbers <code>complexlm::lm</code> uses zmodel.matrix to build the model matrix
from the model formula. As such it is limited to terms consisting of predictor names connected by <code>+</code> and/or <code>:</code> operators.
Anything more complicated will result in an error.
</p>
<p>If response is a matrix, then then <code>lm()</code> fits a model to each column, and returns an object with class "mlm".
</p>
<p>For complex input, this function calls zlm.wfit.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>c("zlm", "lm")</code>, or for multiple responses <code>c("zlm", "mlm", "lm")</code>.
</p>
<p>The functions summary and anova are used to obtain and print a summary and analysis of variance table of the results.
The generic functions coefficients, effects, fitted.values and residuals extract various useful features of the value returned by lm.
Of course these things can also be accessed by simply using the get element symbol <code>$</code>.
</p>
<p>Objects of class "zlm" are lists with the following components.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>a named vector of coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>the residuals, that is response minus fitted values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>
<p>The fitted values, which are response values obtained by feeding the predictors into the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rank</code></td>
<td>
<p>The numeric rank of the fitted linear model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Numeric. The user supplied weights for the linear fit. If none were given, a vector of <code>1</code>s of length equal to that of the input data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df.residual</code></td>
<td>
<p>The residual degrees of freedom.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The matched call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>terms</code></td>
<td>
<p>the terms object used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p>The contrasts used, as these are not supported this component will probably be <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlevels</code></td>
<td>
<p>(only where relevant) a record of the levels of the factors used in fitting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>the offset used (missing if none were used).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>if requested, the response used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the model matrix used, unless requested to not return it.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>if requested, the model frame used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>(where relevant) information returned by model.frame on the special handling of NAs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>assign</code></td>
<td>
<p>Used by extractor functions like summary and effects to understand variable names. Not included in null fits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effects</code></td>
<td>
<p>Complex list. See effects for explanation. Not included in null fits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qr</code></td>
<td>
<p>unless declined, the output of the qr object created in the process of fitting. Not included in null fits.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>In <code>complexlm</code>, the <code>x</code> parameter defaults to <code>TRUE</code> so that followup
methods such as predict.lm have access to the model matrix.
</p>


<h3>See Also</h3>

<p>lm.fit, lm.wfit, zlm.wfit, zmodel.matrix, complexdqlrs, stats::lm
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(4242)
n &lt;- 8
slop &lt;- complex(real = 4.23, imaginary = 2.323)
interc &lt;- complex(real = 1.4, imaginary = 1.804)
e &lt;- complex(real=rnorm(n)/6, imaginary=rnorm(n)/6)
xx &lt;- complex(real= rnorm(n), imaginary= rnorm(n))
tframe &lt;- data.frame(x= xx, y= slop*xx + interc + e)
lm(y ~ x, data = tframe, weights = rep(1,n))
</code></pre>


</div>