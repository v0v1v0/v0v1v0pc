<div class="container">

<table style="width: 100%;"><tr>
<td>fCFA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Stepwise CFA approaches</h2>

<h3>Description</h3>

<p>These CFA methods detect and eliminate stepwise types/antitypes
cells by specifying an appropriate contrast in the design matrix.
The procedures stop when model fit is achieved. Functional CFA (fCFA) uses a residual
criterion, Kieser-Victor CFA (kvCFA) a LR-criterion.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fCFA(m.i,  X, tabdim, alpha = 0.05)
kvCFA(m.i, X, tabdim, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>m.i</code></td>
<td>
<p>Vector of observed frequencies.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Design Matrix of the base model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tabdim</code></td>
<td>
<p>Vector of table dimensions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Significance level.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>restable</code></td>
<td>
<p>Fit results for each step</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design.mat</code></td>
<td>
<p>Final design matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>struc.mat</code></td>
<td>
<p>Structural part of the design matrix for each step</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>typevec</code></td>
<td>
<p>Type or antitype for each step</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resstep</code></td>
<td>
<p>Design matrix, expected frequency vector, and fit results for each step</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Patrick Mair, Alexander von Eye</p>


<h3>References</h3>

<p>von Eye, A., and Mair, P. (2008). A functional approach to configural frequency analysis. 
Austrian Journal of Statistics, 37, 161-173.
</p>
<p>Kieser, M., and Victor, N. (1999). Configural frequency analysis (CFA) revisited: A new look at an old approach. 
Biometrical Journal, 41, 967-983. 
</p>


<h3>Examples</h3>

<pre><code class="language-R">
#Functional CFA for a internet terminal usage data set by Wurzer 
#(An application of configural frequency analysis: Evaluation of the
#usage of internet terminals, 2005, p.82)
dd &lt;- data.frame(a1=gl(3,4),b1=gl(2,2,12),c1=gl(2,1,12))
X &lt;- model.matrix(~a1+b1+c1,dd,contrasts=list(a1="contr.sum",b1="contr.sum",
    c1="contr.sum"))
ofreq &lt;- c(121,13,44,37,158,69,100,79,24,0,26,3)
tabdim &lt;- c(3,2,2)

res1 &lt;- fCFA(ofreq, X, tabdim=tabdim)
res1
summary(res1)


# Kieser-Vector CFA for Children's temperament data from 
# von Eye  (Configural Frequency Analysis, 2002, p. 192) 
dd &lt;- data.frame(a1=gl(3,9),b1=gl(3,3,27),c1=gl(3,1,27))
X &lt;- model.matrix(~a1+b1+c1,dd,contrasts=list(a1="contr.sum",
    b1="contr.sum",c1="contr.sum"))
ofreq &lt;- c(3,2,4,23,23,6,39,33,9,11,29,13,19,36,19,21,26,18,13,30,
         41,12,14,23,8,6,7)
tabdim &lt;- c(3,3,3)

res2 &lt;- kvCFA(ofreq, X, tabdim=tabdim)
res2
summary(res2)
</code></pre>


</div>