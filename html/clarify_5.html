<div class="container">

<table style="width: 100%;"><tr>
<td>misim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate model coefficients after multiple imputation</h2>

<h3>Description</h3>

<p><code>misim()</code> simulates model parameters from multivariate normal or t distributions after multiple imputation that are then used by <code>sim_apply()</code> to calculate quantities of interest.
</p>


<h3>Usage</h3>

<pre><code class="language-R">misim(fitlist, n = 1000, vcov = NULL, coefs = NULL, dist = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fitlist</code></td>
<td>
<p>a list of model fits, one for each imputed dataset, or a <code>mira</code> object (the output of a call to <code>with()</code> applied to a <code>mids</code> object in <code>mice</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>the number of simulations to run for each imputed dataset; default is 1000. More is always better but resulting calculations will take longer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcov</code></td>
<td>
<p>a square covariance matrix of the coefficient covariance estimates, a function to use to extract it from <code>fit</code>, or a list thereof with an element for each imputed dataset. By default, uses <code>stats::vcov()</code> or <code>insight::get_varcov()</code> if that doesn't work.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefs</code></td>
<td>
<p>a vector of coefficient estimates, a function to use to extract it from <code>fit</code>, or a list thereof with an element for each imputed dataset. By default, uses <code>stats::coef()</code> or <code>insight::get_parameters()</code> if that doesn't work.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>
<p>a character vector containing the name of the multivariate distribution(s) to use to draw simulated coefficients. Should be one of <code>"normal"</code> (multivariate normal distribution) or <code>"t_{#}"</code> (multivariate t distribution), where <code style="white-space: pre;">⁠{#}⁠</code> corresponds to the desired degrees of freedom (e.g., <code>"t_100"</code>). If <code>NULL</code>, the right distributions to use will be determined based on heuristics; see <code>sim()</code> for details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>misim()</code> essentially combines multiple <code>sim()</code> calls applied to a list of model fits, each fit in an imputed dataset, into a single combined pool of simulated coefficients. When simulation-based inference is to be used with multiply imputed data, many imputations are required; see Zhou and Reiter (2010).
</p>


<h3>Value</h3>

<p>A <code>clarify_misim</code> object, which inherits from <code>clarify_sim</code> and has the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>sim.coefs</code></td>
<td>
<p>a matrix containing the simulated coefficients with a column for each coefficient and a row for each simulation for each imputation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefs</code></td>
<td>
<p>a matrix containing the original coefficients extracted from <code>fitlist</code> or supplied to <code>coefs</code>, with a row per imputation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>the list of model fits supplied to <code>fitlist</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>imp</code></td>
<td>
<p>a identifier of which imputed dataset each set of simulated coefficients corresponds to.</p>
</td>
</tr>
</table>
<p>The <code>"dist"</code> attribute contains <code>"normal"</code> if the coefficients were sampled from a multivariate normal distribution and <code>"t({df})"</code> if sampled from a multivariate t distribution. The <code>"clarify_hash"</code> attribute contains a unique hash generated by <code>rlang::hash()</code>.
</p>


<h3>References</h3>

<p>Zhou, X., &amp; Reiter, J. P. (2010). A Note on Bayesian Inference After Multiple Imputation. <em>The American Statistician</em>, 64(2), 159–163. <a href="https://doi.org/10.1198/tast.2010.09109">doi:10.1198/tast.2010.09109</a>
</p>


<h3>See Also</h3>


<ul>
<li> <p><code>sim()</code> for simulating model coefficients for a single dataset
</p>
</li>
<li> <p><code>sim_apply()</code> for applying a function to each set of simulated coefficients
</p>
</li>
<li> <p><code>sim_ame()</code> for computing average marginal effects in each simulation draw
</p>
</li>
<li> <p><code>sim_setx()</code> for computing marginal predictions and first differences at typical values in each simulation draw
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">
data("africa", package = "Amelia")

# Multiple imputation using Amelia
a.out &lt;- Amelia::amelia(x = africa, m = 10,
                        cs = "country",
                        ts = "year", logs = "gdp_pc",
                        p2s = 0)

fits &lt;- with(a.out, lm(gdp_pc ~ infl * trade))

# Simulate coefficients
s &lt;- misim(fits)
s

</code></pre>


</div>