<div class="container">

<table style="width: 100%;"><tr>
<td>cvTuning</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cross-validation for tuning parameter selection</h2>

<h3>Description</h3>

<p>Select tuning parameters of a model by estimating the respective prediction
errors via (repeated) <code class="reqn">K</code>-fold cross-validation.  It is thereby possible
to supply a model fitting function or an unevaluated function call to a
model fitting function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cvTuning(object, ...)

## S3 method for class ''function''
cvTuning(
  object,
  formula,
  data = NULL,
  x = NULL,
  y,
  tuning = list(),
  args = list(),
  cost = rmspe,
  K = 5,
  R = 1,
  foldType = c("random", "consecutive", "interleaved"),
  grouping = NULL,
  folds = NULL,
  names = NULL,
  predictArgs = list(),
  costArgs = list(),
  selectBest = c("min", "hastie"),
  seFactor = 1,
  envir = parent.frame(),
  seed = NULL,
  ...
)

## S3 method for class 'call'
cvTuning(
  object,
  data = NULL,
  x = NULL,
  y,
  tuning = list(),
  cost = rmspe,
  K = 5,
  R = 1,
  foldType = c("random", "consecutive", "interleaved"),
  grouping = NULL,
  folds = NULL,
  names = NULL,
  predictArgs = list(),
  costArgs = list(),
  selectBest = c("min", "hastie"),
  seFactor = 1,
  envir = parent.frame(),
  seed = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>a function or an unevaluated function call for fitting
a model (see <code>call</code> for the latter).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to be passed down.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a <code>formula</code> describing the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame containing the variables required for fitting the
models.  This is typically used if the model in the function call is
described by a <code>formula</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric matrix containing the predictor variables.  This is
typically used if the function call for fitting the models requires the
predictor matrix and the response to be supplied as separate arguments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a numeric vector or matrix containing the response.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tuning</code></td>
<td>
<p>a list of arguments giving the tuning parameter values to be
evaluated.  The names of the list components should thereby correspond to
the argument names of the tuning parameters.  For each tuning parameter, a
vector of values can be supplied.  Cross-validation is then applied over the
grid of all possible combinations of tuning parameter values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args</code></td>
<td>
<p>a list of additional arguments to be passed to the model
fitting function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cost</code></td>
<td>
<p>a cost function measuring prediction loss.  It should expect
the observed values of the response to be passed as the first argument and
the predicted values as the second argument, and must return either a
non-negative scalar value, or a list with the first component containing
the prediction error and the second component containing the standard
error.  The default is to use the root mean squared prediction error
(see <code>cost</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>an integer giving the number of folds into which the data should
be split (the default is five).  Keep in mind that this should be chosen
such that all folds are of approximately equal size.  Setting <code>K</code>
equal to the number of observations or groups yields leave-one-out
cross-validation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>an integer giving the number of replications for repeated
<code class="reqn">K</code>-fold cross-validation.  This is ignored for for leave-one-out
cross-validation and other non-random splits of the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>foldType</code></td>
<td>
<p>a character string specifying the type of folds to be
generated.  Possible values are <code>"random"</code> (the default),
<code>"consecutive"</code> or <code>"interleaved"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grouping</code></td>
<td>
<p>a factor specifying groups of observations.  If supplied,
the data are split according to the groups rather than individual
observations such that all observations within a group belong to the same
fold.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>folds</code></td>
<td>
<p>an object of class <code>"cvFolds"</code> giving the folds of the
data for cross-validation (as returned by <code>cvFolds</code>).  If
supplied, this is preferred over the arguments for generating
cross-validation folds.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>names</code></td>
<td>
<p>an optional character vector giving names for the arguments
containing the data to be used in the function call (see “Details”).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predictArgs</code></td>
<td>
<p>a list of additional arguments to be passed to the
<code>predict</code> method of the fitted models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>costArgs</code></td>
<td>
<p>a list of additional arguments to be passed to the
prediction loss function <code>cost</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selectBest</code></td>
<td>
<p>a character string specifying a criterion for selecting
the best model.  Possible values are <code>"min"</code> (the default) or
<code>"hastie"</code>.  The former selects the model with the smallest prediction
error.  The latter is useful for models with a tuning parameter controlling
the complexity of the model (e.g., penalized regression).  It selects the
most parsimonious model whose prediction error is no larger than
<code>seFactor</code> standard errors above the prediction error of the best
overall model.  Note that the models are thereby assumed to be ordered
from the most parsimonious one to the most complex one.  In particular
a one-standard-error rule is frequently applied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seFactor</code></td>
<td>
<p>a numeric value giving a multiplication factor of the
standard error for the selection of the best model.  This is ignored if
<code>selectBest</code> is <code>"min"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>envir</code></td>
<td>
<p>the <code>environment</code> in which to evaluate the
function call for fitting the models (see <code>eval</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>optional initial seed for the random number generator (see
<code>.Random.seed</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>(Repeated) <code class="reqn">K</code>-fold cross-validation is performed in the following
way.  The data are first split into <code class="reqn">K</code> previously obtained blocks of
approximately equal size.  Each of the <code class="reqn">K</code> data blocks is left out once
to fit the model, and predictions are computed for the observations in the
left-out block with the <code>predict</code> method of the fitted
model.  Thus a prediction is obtained for each observation.
</p>
<p>The response variable and the obtained predictions for all observations are
then passed to the prediction loss function <code>cost</code> to estimate the
prediction error.  For repeated cross-validation, this process is replicated
and the estimated prediction errors from all replications as well as their
average are included in the returned object.
</p>
<p>Furthermore, if the response is a vector but the
<code>predict</code> method of the fitted models returns a matrix,
the prediction error is computed for each column.  A typical use case for
this behavior would be if the <code>predict</code> method returns
predictions from an initial model fit and stepwise improvements thereof.
</p>
<p>If <code>formula</code> or <code>data</code> are supplied, all variables required for
fitting the models are added as one argument to the function call, which is
the typical behavior of model fitting functions with a
<code>formula</code> interface.  In this case, the accepted values
for <code>names</code> depend on the method.  For the <code>function</code> method, a
character vector of length two should supplied, with the first element
specifying the argument name for the formula and the second element
specifying the argument name for the data (the default is to use
<code>c("formula", "data")</code>).  Note that names for both arguments should be
supplied even if only one is actually used.  For the <code>call</code> method,
which does not have a <code>formula</code> argument, a character string specifying
the argument name for the data should be supplied (the default is to use
<code>"data"</code>).
</p>
<p>If <code>x</code> is supplied, on the other hand, the predictor matrix and the
response are added as separate arguments to the function call.  In this
case, <code>names</code> should be a character vector of length two, with the
first element specifying the argument name for the predictor matrix and the
second element specifying the argument name for the response (the default is
to use <code>c("x", "y")</code>).  It should be noted that the <code>formula</code> or
<code>data</code> arguments take precedence over <code>x</code>.
</p>


<h3>Value</h3>

<p>If <code>tuning</code> is an empty list, <code>cvFit</code> is called to return
an object of class <code>"cv"</code>.
</p>
<p>Otherwise an object of class <code>"cvTuning"</code> (which inherits from class
<code>"cvSelect"</code>) with the following components is returned:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>an integer giving the number of observations or groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>an integer giving the number of folds.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>an integer giving the number of replications.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tuning</code></td>
<td>
<p>a data frame containing the grid of tuning parameter
values for which the prediction error was estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>best</code></td>
<td>
<p>an integer vector giving the indices of the optimal
combinations of tuning parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv</code></td>
<td>
<p>a data frame containing the estimated prediction errors for
all combinations of tuning parameter values.  For repeated cross-validation,
those are average values over all replications.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>a data frame containing the estimated standard errors of the
prediction loss for all combinations of tuning parameter values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selectBest</code></td>
<td>
<p>a character string specifying the criterion used for
selecting the best model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seFactor</code></td>
<td>
<p>a numeric value giving the multiplication factor of
the standard error used for the selection of the best model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reps</code></td>
<td>
<p>a data frame containing the estimated prediction errors
from all replications for all combinations of tuning parameter values.  This
is only returned for repeated cross-validation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>the seed of the random number generator before
cross-validation was performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched function call.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The same cross-validation folds are used for all combinations of
tuning parameter values for maximum comparability.
</p>


<h3>Author(s)</h3>

<p>Andreas Alfons
</p>


<h3>References</h3>

<p>Hastie, T., Tibshirani, R. and Friedman, J. (2009) <em>The Elements of
Statistical Learning: Data Mining, Inference, and Prediction</em>.  Springer,
2nd edition.
</p>


<h3>See Also</h3>

<p><code>cvTool</code>, <code>cvFit</code>, <code>cvSelect</code>,
<code>cvFolds</code>, <code>cost</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library("robustbase")
data("coleman")

## evaluate MM regression models tuned for 85% and 95% efficiency
tuning &lt;- list(tuning.psi = c(3.443689, 4.685061))

## via model fitting function
# perform cross-validation
# note that the response is extracted from 'data' in 
# this example and does not have to be supplied
cvTuning(lmrob, formula = Y ~ ., data = coleman, tuning = tuning, 
    cost = rtmspe, K = 5, R = 10, costArgs = list(trim = 0.1), 
    seed = 1234)

## via function call
# set up function call
call &lt;- call("lmrob", formula = Y ~ .)
# perform cross-validation
cvTuning(call, data = coleman, y = coleman$Y, tuning = tuning, 
    cost = rtmspe, K = 5, R = 10, costArgs = list(trim = 0.1), 
    seed = 1234)
</code></pre>


</div>