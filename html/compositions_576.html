<div class="container">

<table style="width: 100%;"><tr>
<td>rAitchison</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Aitchison Distribution</h2>

<h3>Description</h3>

<p>The Aitchison distribution is a class of distributions the simplex,
containing the normal and the Dirichlet as subfamilies.  
</p>


<h3>Usage</h3>

<pre><code class="language-R">dAitchison(x,
           theta=alpha+sigma %*% clr(mu),
           beta=-1/2*gsi.svdinverse(sigma),
           alpha=mean(theta),
           mu=clrInv(c(sigma%*%(theta-alpha))),
           sigma=-1/2*gsi.svdinverse(beta),
           grid=30,
           realdensity=FALSE,
           expKappa=AitchisonDistributionIntegrals(theta,beta,
                        grid=grid,mode=1)$expKappa)
rAitchison(n,
           theta=alpha+sigma %*% clr(mu),
           beta=-1/2*gsi.svdinverse(sigma),
           alpha=mean(theta),
           mu=clrInv(c(sigma%*%(theta-alpha))),
           sigma=-1/2*gsi.svdinverse(beta), withfit=FALSE)
AitchisonDistributionIntegrals(
           theta=alpha+sigma %*% clr(mu),
           beta=-1/2*gsi.svdinverse(sigma),
           alpha=mean(theta),
           mu=clrInv(c(sigma%*%(theta-alpha))),
           sigma=-1/2*gsi.svdinverse(beta),
           grid=30,
           mode=3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>acomp-compositions the density should be computed for.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>integer: number of datasets to be simulated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>numeric vector: Location parameter vector </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>matrix: Spread parameter matrix (clr or ilr)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>positiv scalar: departure from normality parameter (positive scalar)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>acomp-composition, normal reference mean parameter composition</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p> matrix: normal reference variance matrix (clr or ilr)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p> integer: number of discretisation points along each side of the simplex </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>realdensity</code></td>
<td>
<p>logical: if true the density is given with respect
to the Haar measure of the real simplex, if false the density is
given with respect to the Aitchison measure of the simplex.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode</code></td>
<td>
<p>integer: desired output:
-1: Compute nothing, only transform parameters,<br>
0: Compute only oneIntegral and kappaIntegral,<br>
1: compute also the clrMean,<br>
2: compute also the clrSqExpectation,<br>
3: same as 2, but compute clrVar instead of clrSqExpectation<br></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expKappa</code></td>
<td>
<p>The closing divisor of the density</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>withfit</code></td>
<td>
<p>Should a pre-spliting of the Aitchison density be used for 
simulation?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Aitchison Distribution is a joint generalisation of the Dirichlet
Distribution and the additive log-normal distribution (or normal on the
simplex). It can be parametrized by Ait(theta,beta) or by
Ait(alpha,mu,Sigma). Actually, beta and Sigma can be easily
transformed into each other, such that only one of them is
necessary. Parameter theta is a vector in <code class="reqn">R^D</code>, alpha is its sum, mu is a
composition in <code class="reqn">S^D</code>, and beta and sigma are symmetric matrices, which
can either be expressed  in ilr or clr space.
The parameters are transformed as
</p>
<p style="text-align: center;"><code class="reqn">\beta=-1/2 \Sigma^{-1}</code>
</p>
 
<p style="text-align: center;"><code class="reqn">\theta=clr(\mu)\Sigma+\alpha (1,\ldots,1)^t</code>
</p>

<p>The distribution exists, if either,
<code class="reqn">\alpha\geq 0</code> and Sigma is positive definite (or beta
negative definite) in
ilr-coordinates, or if each theta is strictly positive and Sigma has
at least one positive eigenvalue (or beta has at least one negative
eigenvalue). The simulation procedure currently only works with the
first case. 
<br>
AitchisonDistributionIntegral is a convenience function to compute the
parameter transformation and several functions of these
parameters. This is done by numerical integration over a
multinomial simplex lattice of D parts with <code>grid</code> many elements
(see <code>xsimplex</code>). 
<br>
The density of the Aitchison distribution is given by:
</p>
<p style="text-align: center;"><code class="reqn">f(x,\theta,\beta)=exp((\theta-1)^t \log(x)+ilr(x)^t \beta ilr(x))/exp(\kappa_{Ait(\theta,\beta)})</code>
</p>

<p>with respect to the classical Haar measure on the simplex, and as
</p>
<p style="text-align: center;"><code class="reqn">f(x,\theta,\beta)=exp(\theta^t \log(x)+ilr(x)^t \beta
  ilr(x))/exp(\kappa_{Ait(\theta,\beta)})</code>
</p>
<p> with respect to the Aitchison
measure of the simplex. The closure constant expKappa is computed
numerically, in <code>AitchisonDistributionIntegrals</code>.
</p>
<p>The random composition generation is done by rejection sampling based on
an optimally fitted additive logistic normal distribution. Thus, it only
works if the correponding Sigma in ilr would be positive definite.  
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dAitchison</code></td>
<td>
<p>Returns the density of the Aitchison distribution
evaluated at x as a numeric vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rAitchison</code></td>
<td>
<p>Returns a sample of size n of simulated compostions
as an acomp object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AitchisondistributionIntegrals</code></td>
<td>
<p>Returns a list with
</p>

<dl>
<dt>theta</dt>
<dd>
<p>the theta parameter given or computed</p>
</dd>
<dt>beta</dt>
<dd>
<p>the beta parameter given or computed</p>
</dd>
<dt>alpha</dt>
<dd>
<p>the alpha parameter given or computed</p>
</dd>
<dt>mu</dt>
<dd>
<p>the mu parameter given or computed</p>
</dd>
<dt>sigma</dt>
<dd>
<p>the sigma parameter given or computed</p>
</dd>
<dt>expKappa</dt>
<dd>
<p>the integral over the density without closing
constant. I.e. the inverse of the closing constant and the exp
of <code class="reqn">\kappa_{Ait(\theta,\beta)}</code></p>
</dd>
<dt>kappaIntegral</dt>
<dd>
<p>The expected value of the mean of the logs of
the components as numerically computed</p>
</dd>
<dt>clrMean</dt>
<dd>
<p>The mean of the clr transformed random variable,
computed numerically</p>
</dd>
<dt>clrSqExpectation</dt>
<dd>
<p>The expectation of <code class="reqn">clr(X)clr(X)^t</code>
computed numerically.</p>
</dd>
<dt>clrVar</dt>
<dd>
<p>The variance covariance matrix of clr(X),
computed numerically</p>
</dd>
</dl>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The simulation procedure currently only works with a
positive definite Sigma. You need a relatively high grid constant for
precise values in the numerical integration.</p>


<h3>Author(s)</h3>

<p>K.Gerald v.d. Boogaart, R. Tolosana-Delgado <a href="http://www.stat.boogaart.de">http://www.stat.boogaart.de</a></p>


<h3>References</h3>

<p>Aitchison, J. (1986) <em>The Statistical Analysis of Compositional
Data</em> Monographs on Statistics and Applied Probability. Chapman &amp;
Hall Ltd., London (UK). 416p.<br></p>


<h3>See Also</h3>

<p><code>runif.acomp</code>, <code>rnorm.acomp</code>,
<code>rDirichlet.acomp</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">(erg&lt;-AitchisonDistributionIntegrals(c(-1,3,-2),ilrvar2clr(-diag(c(1,2))),grid=20))

(myvar&lt;-with(erg, -1/2*ilrvar2clr(solve(clrvar2ilr(beta)))))
(mymean&lt;-with(erg,myvar%*%theta))

with(erg,myvar-clrVar)
with(erg,mymean-clrMean)

</code></pre>


</div>