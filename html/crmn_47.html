<div class="container">

<table style="width: 100%;"><tr>
<td>standardsFit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Standards model</h2>

<h3>Description</h3>

<p>Fit a model which describes the variation of the labeled internal
standards from the biological factors.
</p>


<h3>Usage</h3>

<pre><code class="language-R">standardsFit(object, factors, ncomp = NULL, lg = TRUE, fitfunc = lm, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an <code>ExpressionSet</code> or a <code>matrix</code>.   Note
that if you pass a<code>matrix</code> have to specify the identity of
the standards by   passing the appropriate argument to
<code>standards</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>factors</code></td>
<td>
<p>the biological factors described in the pheno data
slot if <code>object</code> is an <code>ExpressionSet</code> or a design
matrix if <code>object</code> is a <code>matrix</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncomp</code></td>
<td>
<p>number of PCA components to use.   Determined by
cross-validation if left <code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lg</code></td>
<td>
<p>logical indicating that the data should be log
transformed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitfunc</code></td>
<td>
<p>the function that creates the model fit for
normalization, must use the same interfaces as <code>lm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>passed on to <code>Q2</code>, <code>pca</code> (if pcaMethods &gt;
1.26.0), <code>standards</code> and <code>analytes</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>There is often unwanted variation in among the labeled internal
standards which is related to the experimental factors due to
overlapping peaks etc. This function fits a model that describes
that overlapping variation using a scaled and centered PCA /
multiple linear regression model. Scaling is done outside the PCA
model.
</p>


<h3>Value</h3>

<p>a list containing the PCA/MLR model, the recommended number of
components for that model, the standard deviations and mean values
and Q2/R2 for the fit.
</p>


<h3>Author(s)</h3>

<p>Henning Redestig
</p>


<h3>See Also</h3>

<p><code>makeX</code>, <code>standardsPred</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(mix)
sfit &lt;- standardsFit(mix, "type", ncomp=3)
slplot(sfit$fit$pc)
## same thing
Y &lt;- exprs(mix)
G &lt;- model.matrix(~-1+mix$type)
isIS &lt;- fData(mix)$tag == 'IS'
sfit &lt;- standardsFit(Y, G, standards=isIS, ncomp=3)
</code></pre>


</div>