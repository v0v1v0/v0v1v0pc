<div class="container">

<table style="width: 100%;"><tr>
<td>calcLR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate the likelihood ratio</h2>

<h3>Description</h3>

<p>Takes a <code>compitem</code> object which represents some control item, and a
<code>compitem</code> object which represents a recovered item, then uses information
from a <code>compcovar</code> object, which represents the information from the
population, to calculate a likelihood ratio (LR) as a measure of the evidence
given by the observations for the same/different source propositions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">calcLR(control, recovered, background, method = c("mvn", "kde", "lindley"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a <code>compitem</code> object with the control item information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>recovered</code></td>
<td>
<p>a <code>compitem</code> object with the recovered item information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>background</code></td>
<td>
<p>a <code>compcovar</code> object with the population information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a choice of the method used to calculate the LR. Presently there
are three methods, <code>"mvn"</code> - multivariate normal approximation, <code>"kde"</code> - (multivariate) kernel
density estimates and <code>"lindely"</code> which uses the method published by Lindley (1977).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an estimate of the likelihood ratio
</p>


<h3>References</h3>

<p>Aitken, C.G.G. &amp; Lucy, D. (2004) Evaluation of trace evidence in the form of multivariate data. <em>Applied Statistics</em>: <b>53</b>(1); 109-122.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(glass)

controlMeasurements = subset(glass, item == "s1")
control = makeCompItem(item ~ logKO + logCaO + logFeO, 
                       data = controlMeasurements[1:6,])
recovered.1 = makeCompItem(item ~ logKO + logCaO + logFeO, 
                       data = controlMeasurements[7:12,])
recoveredMeasurements = subset(glass, item == "s2")
recovered.2 = makeCompItem(item ~ logKO + logCaO + logFeO,
                           data = recoveredMeasurements[7:12,])
                           
background = makeCompVar(item ~ logKO + logCaO + logFeO, data = glass)
                           
## Same source comparison using a multivariate normal (MVN) approximation
calcLR(control, recovered.1, background)

## Same source comparison using a multivariate kernel density estimate (MVK) approximation
calcLR(control, recovered.1, background, "kde")

## Different source comparison using a multivariate normal (MVN) approximation
calcLR(control, recovered.2, background)

## Different source comparison using a multivariate kernel density estimate (MVK) approximation
calcLR(control, recovered.2, background, "kde")

</code></pre>


</div>