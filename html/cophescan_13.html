<div class="container">

<table style="width: 100%;"><tr>
<td>cophe.single</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayesian cophescan analysis using Approximate Bayes Factors</h2>

<h3>Description</h3>

<p>Bayesian cophescan analysis under single causal variant assumption
</p>


<h3>Usage</h3>

<pre><code class="language-R">cophe.single(
  dataset,
  querysnpid,
  querytrait,
  MAF = NULL,
  pa = 3.82e-05,
  pc = 0.00182,
  p1 = NULL,
  p2 = NULL,
  p12 = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dataset</code></td>
<td>
<p>a list with specifically named elements defining the query trait dataset
to be analysed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>querysnpid</code></td>
<td>
<p>Id of the query variant, (id in dataset$snp)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>querytrait</code></td>
<td>
<p>Query trait name</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MAF</code></td>
<td>
<p>Minor allele frequency vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pa</code></td>
<td>
<p>prior probability that a non-query variant is causally associated with the query trait (cophescan prior), default 3.82e-5</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pc</code></td>
<td>
<p>prior probability that the query variant is causally associated with the query trait (cophescan prior), default 1.82e-3 (cophescan prior)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p1</code></td>
<td>
<p>prior probability a SNP is associated with trait 1, (coloc prior), pc derived by using <code class="reqn">pc =  p12/p1+p12</code>; use p1, p2, p12 only when pa and pc are unavailable (See vignettes)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p2</code></td>
<td>
<p>prior probability a SNP is associated with trait 2,  (coloc prior), pa derived by using <code class="reqn">pa = p2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p12</code></td>
<td>
<p>prior probability a SNP is associated with both traits,  (coloc prior), pc derived by using <code class="reqn">pc =  p12/p1+p12</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function calculates posterior probabilities of different
causal variant configurations under the assumption of a single
causal variant for each trait.
</p>
<p>If regression coefficients and variances are available, it
calculates Bayes factors for association at each SNP.  If only p
values are available, it uses an approximation that depends on the
SNP's MAF and ignores any uncertainty in imputation.  Regression
coefficients should be used if available. Find more input data structure details
in the coloc package
</p>


<h3>Value</h3>

<p>a list of two <code>data.frame</code>s:
</p>

<ul>
<li>
<p> summary is a vector giving the number of SNPs analysed, and the posterior probabilities of Hn (no shared causal variant), Ha (two distinct causal variants) and Hc (one common causal variant)
</p>
</li>
<li>
<p> results is an annotated version of the input data containing log Approximate Bayes Factors and intermediate calculations, and the posterior probability SNP.PP.Hc of the SNP being causal for the shared signal <em>if</em> Hc is true. This is only relevant if the posterior support for Hc in summary is convincing.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Ichcha Manipur
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(cophescan)
data(cophe_multi_trait_data)
query_trait_1 &lt;- cophe_multi_trait_data$summ_stat[['Trait_1']]
querysnpid &lt;- cophe_multi_trait_data$querysnpid
res.single &lt;- cophe.single(query_trait_1, querysnpid = querysnpid, querytrait='Trait_1')
summary(res.single)
</code></pre>


</div>