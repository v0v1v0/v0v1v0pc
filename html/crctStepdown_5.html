<div class="container">

<table style="width: 100%;"><tr>
<td>permutation_test_impl</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generates realisations of the permutational test statistic distribution</h2>

<h3>Description</h3>

<p>Generates realisations of the permutational test statistic distribution from a given matrix of permutations
</p>


<h3>Usage</h3>

<pre><code class="language-R">permutation_test_impl(
  resids,
  tr_mat,
  xb,
  invS,
  family2,
  Z,
  weight,
  iter = 1000L,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>resids</code></td>
<td>
<p>A numeric vector of generalised residuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tr_mat</code></td>
<td>
<p>A matrix. Each column is a new random treatment allocation with 1s (treatment group) and 0s (control group)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xb</code></td>
<td>
<p>A numeric vector of fitted linear predictors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>invS</code></td>
<td>
<p>A matrix. If using the weighted statistic then it should be the inverse covariance matrix of the observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family2</code></td>
<td>
<p>A string naming the link function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>A matrix with columns indicating cluster membership</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p>Logical value indicating whether to use the weighted statistic (TRUE) or the unweighted statistic (FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>Integer. Number of permutation test iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical indicating whether to report detailed output</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A numeric vector of quasi-score test statistics for each of the permutations
</p>


</div>