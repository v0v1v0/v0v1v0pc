<div class="container">

<table style="width: 100%;"><tr>
<td>rand.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Randomization Test</h2>

<h3>Description</h3>

<p>Performs randomization test on treatment effects.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  rand.test(data, Reps = 200, method = c("HuHuCAR", "PocSimMIN", "StrBCD", 
                                       "StrPBR", "DoptBCD", "AdjBCD"), 
          conf = 0.95, binwidth = 30, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame. It consists of patients' profiles, treatment assignments and outputs. See <code>getData</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Reps</code></td>
<td>
<p>an integer. It is the number of randomized replications used in the randomization test. The default is <code>200</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the randomization procedure to be used for testing. This package provides tests for <code>"HuHuCAR"</code>, <code>"PocSimMIN"</code>, <code>"StrBCD"</code>, <code>"StrPBR"</code>, <code>"AdjBCD"</code>, and <code>"DoptBCD"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf</code></td>
<td>
<p>confidence level of the interval. The default is <code>0.95</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binwidth</code></td>
<td>
<p>the number of bins for each bar in histogram. The default is 30.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments to be passed to <code>method</code>. These arguments depend on the randomization method used and the following arguments are accepted:
</p>

<dl>
<dt>omega</dt>
<dd>
<p>a vector of weights at the overall, within-stratum, and within-covariate-margin levels. It is required that at least one element is larger than 0. Note that <code>omega</code> is only needed when <code>HuHuCAR</code> is to be used.</p>
</dd>
<dt>weight</dt>
<dd>
<p>a vector of weights for within-covariate-margin imbalances. It is required that at least one element is larger than 0. Note that <code>weight</code> is only needed when <code>PocSimMIN</code> is to be used.</p>
</dd>
<dt>p</dt>
<dd>
<p>the biased coin probability. <code>p</code> should be larger than <code>1/2</code> and less than <code>1</code>. Note that <code>p</code> is only needed when <code>"HuHuCAR", "PocSimMIN"</code> and <code>"StrBCD"</code> are to be used.</p>
</dd>
<dt>a</dt>
<dd>
<p>a design parameter governing the degree of randomness. Note that <code>a</code> is only needed when <code>"AdjBCD"</code> is to be used.</p>
</dd>
<dt>bsize</dt>
<dd>
<p>the block size for stratified randomization. It is required to be a multiple of 2. Note that <code>bsize</code> is only needed when <code>"StrPBR"</code> is to be used.</p>
</dd>
</dl>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The randomization test is described as follows:
1) For the observed responses <code class="reqn">Y_1,\dots,Y_n</code> and the treatment assignments <code class="reqn">T_1,T_2,\dots,T_n</code>, compute the observed test statistic
</p>
<p style="text-align: center;"><code class="reqn">S_{obs} = \frac{-\sum_{i=1}^nY_i*(T_i-2)}{n_1}-\frac{\sum_{i=1}^n Y_i*(T_i-1)}{n_0}</code>
</p>

<p>where <code class="reqn">n_1</code> is the number of patients assigned to treatment <code class="reqn">1</code> and <code class="reqn">n_0</code> is the number of patients assigned to treatment <code class="reqn">2</code>;
</p>
<p>2) Perform the covariate-adaptive randomization procedure to obtain the new treatment assignments and calculate the corresponding test statistic <code class="reqn">S_i</code>. And repeat this process <code class="reqn">L</code> times;
</p>
<p>3) Calculate the two-sided Monte Carlo p-value estimator
</p>
<p style="text-align: center;"><code class="reqn">p = \frac{\sum_{l=1}^L I(|S_l|\ge |S_{obs}|)}{L}</code>
</p>



<h3>Value</h3>

<p>It returns an object of class <code>"htest"</code>.
</p>
<p>An object of class <code>"htest"</code> is a list containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>p-value of the test, the null hypothesis is rejected if the p-value is less than <code>sl</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>the estimated difference in treatment effects between treatment <code>1</code> and treatment <code>2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.int</code></td>
<td>
<p>a confidence interval under the chosen level <code>conf</code> for the difference in treatment effect between treatment <code>1</code> and treatment <code>2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string indicating what type of test was performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p>a character string giving the name(s) of the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>the value of the t-statistic. As the randomization test is a nonparametric method, we cannot calculate the t-statistic, so it is hidden in this result.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Ma W, Ye X, Tu F, Hu F. <em>carat: Covariate-Adaptive Randomization for Clinical Trials</em>[J]. Journal of Statistical Software, 2023, 107(2): 1-47.
</p>
<p>Rosenberger W F, Lachin J M. Randomization in clinical trials: <em>theory and practice</em>[M]. John Wiley &amp; Sons, 2015.
</p>


<h3>Examples</h3>

<pre><code class="language-R">##generate data
set.seed(100)
n = 1000
cov_num = 5
level_num = c(2,2,2,2,2)
pr = rep(0.5,10)
beta = c(0.1,0.4,0.3,0.2,0.5,0.5,0.4,0.3,0.2,0.1)
mu1 = 0
mu2 = 0.01
sigma = 1
type = "linear"
p = 0.85

dataS = getData(n, cov_num, level_num, pr, type,
               beta, mu1, mu2, sigma, "StrBCD", p)

#run the randomization test
library("ggplot2")
Strt = rand.test(data = dataS, Reps = 200,method = "StrBCD", 
                conf = 0.95, binwidth = 30,
                p = 0.85)
Strt
</code></pre>


</div>