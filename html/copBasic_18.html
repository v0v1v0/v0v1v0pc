<div class="container">

<table style="width: 100%;"><tr>
<td>composite2COP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Composition of Two Copulas with Two Compositing Parameters</h2>

<h3>Description</h3>

<p>The <em>composition of two copulas</em> (Salvadori <em>et al.</em>, 2007, p. 266, prop. C.3) provides for more sophisticated structures of dependence between variables than many single parameter copula can provide. Further, <em>asymmetrical copulas</em> are readily obtained from <em>symmetrical copulas</em>. Let <code class="reqn">\mathbf{A}</code> and <code class="reqn">\mathbf{B}</code> be copulas with respective parameters <code class="reqn">\Theta_\mathbf{A}</code> and <code class="reqn">\Theta_\mathbf{B}</code>, then
</p>
<p style="text-align: center;"><code class="reqn">\mathbf{C}_{\alpha,\beta}(u,v) = \mathbf{A}(u^\alpha,    v^\beta) \cdot
                              \mathbf{B}(u^{1-\alpha},v^{1-\beta})\mbox{,}</code>
</p>

<p>defines a family of copulas <code class="reqn">\mathbf{C}_{\alpha,\beta; \Theta_\mathbf{A}, \Theta_\mathbf{B}}</code> with <b>two</b> <em>compositing parameters</em> <code class="reqn">\alpha,\beta \in \mathcal{I}:[0,1]</code>. In particular if <code class="reqn">\alpha = \beta = 1</code>, then <code class="reqn">\mathbf{C}_{1,1} = \mathbf{A}</code>, and if <code class="reqn">\alpha = \beta = 0</code>, then <code class="reqn">\mathbf{C}_{0,0} = \mathbf{B}</code>. For <code class="reqn">\alpha \ne \beta</code>, the <code class="reqn">\mathbf{C}_{\alpha,\beta}</code> is in general asymmetric that is <code class="reqn">\mathbf{C}(u,v) \ne \mathbf{C}(v,u)</code> for some <code class="reqn">(u,v) \in \mathcal{I}^2</code>. This construction technique is named <em>Khoudraji device</em> within the <span class="pkg">copula</span> package (see <code>khoudrajiCopula</code> therein).
</p>
<p>It is important to stress that copulas <code class="reqn">\mathbf{A}_{\Theta_A}</code> and <code class="reqn">\mathbf{B}_{\Theta_B}</code> can be of different families and each copula parameterized accordingly by the vector of parameters <code class="reqn">\Theta_A</code> and <code class="reqn">\Theta_B</code>. This is an interesting feature in the context of building complex structures when pursuing asymmetric measures of dependency such as the <em>L-comoments</em>.  Do the copulas <code class="reqn">\mathbf{A}</code> and <code class="reqn">\mathbf{B}</code> need be symmetric? The Salvadori reference makes no stated restriction to that effect. Symmetry of the copula <code class="reqn">\mathbf{C}</code> is required for the situation that follows, however.
</p>
<p>It is possible to simplify the construction of an asymmetric copula from a symmetric copula by the following. Let <code class="reqn">\mathbf{C}(u,v)</code> be a symmetric copula, <code class="reqn">\mathbf{C} \ne \mathbf{\Pi}</code> (for <code class="reqn">\mathbf{\Pi}</code> see <code>P</code>). A family of asymmetric copulas <code class="reqn">\mathbf{C}_{\alpha,\beta}</code> with <b>two</b> <em>composition parameters</em> <code class="reqn">0 &lt; \alpha,\beta &lt; 1, \mbox{and\ } \alpha \ne \beta</code> that also includes <code class="reqn">\mathbf{C}(u,v)</code> as a limiting case and is given by
</p>
<p style="text-align: center;"><code class="reqn">\mathbf{C}_{\alpha,\beta}(u,v) = u^\alpha v^\beta \cdot \mathbf{C}(u^{1-\alpha},v^{1-\beta})\mbox{.}</code>
</p>

<p>The <code>composite2COP</code> function is based on the more general result given in the former rather than the later mathematical definition to provide additional flexibility. For simpler case of composition involving only one copula, <code>composite1COP</code> is available, and a more complex (extended) composition is available in <code>composite3COP</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">composite2COP(u, v, para, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>Nonexceedance probability <code class="reqn">u</code> in the <code class="reqn">X</code> direction;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>Nonexceedance probability <code class="reqn">v</code> in the <code class="reqn">Y</code> direction;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>para</code></td>
<td>
<p>A special parameter <code>list</code> (see <b>Note</b>); and</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to pass to the copulas.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Value(s) for the composited copula is returned.
</p>


<h3>Note</h3>

<p>The following descriptions list in detail the structure and content of the <code>para</code> argument:
</p>

<dl>
<dt><code>alpha</code></dt>
<dd>
<p>— The <code class="reqn">\alpha</code> compositing parameter;</p>
</dd>
<dt><code>beta</code></dt>
<dd>
<p>— The <code class="reqn">\beta</code> compositing parameter;</p>
</dd>
<dt><code>cop1</code></dt>
<dd>
<p>— Function of the first copula <code class="reqn">\mathbf{A}</code>;</p>
</dd>
<dt><code>cop2</code></dt>
<dd>
<p>— Function of the second copula  <code class="reqn">\mathbf{B}</code>;</p>
</dd>
<dt><code>para1</code></dt>
<dd>
<p>— Vector of parameters <code class="reqn">\Theta_\mathbf{A}</code> for  <code class="reqn">\mathbf{A}</code>; and</p>
</dd>
<dt><code>para2</code></dt>
<dd>
<p>— Vector of parameters <code class="reqn">\Theta_\mathbf{B}</code> for  <code class="reqn">\mathbf{B}</code>.</p>
</dd>
</dl>
<p>The <code>para</code> argument of this function also can be passed to <code>composite1COP</code>; albeit, the second copula and its parameters would not be used. A more complex (extended) composition in <code>composite3COP</code> extends this basic parameter structure.
</p>


<h3>Author(s)</h3>

<p>W.H. Asquith</p>


<h3>References</h3>

<p>Salvadori, G., De Michele, C., Kottegoda, N.T., and Rosso, R., 2007, Extremes in Nature—An approach using copulas: Springer, 289 p.
</p>


<h3>See Also</h3>

<p><code>COP</code>, <code>breveCOP</code>, <code>composite1COP</code>, <code>composite3COP</code>,
<code>convexCOP</code>, <code>glueCOP</code></p>


<h3>Examples</h3>

<pre><code class="language-R">alpha &lt;- 0.24; beta &lt;- 0.23; Theta1 &lt;- NA; Theta2 &lt;- NA
# The W() and PSP() copulas do not take parameters, but example shows how the
# parameters would be set should either or both of the copulas require parameters.
para &lt;- list(alpha=alpha, beta=beta, cop1=W, cop2=PSP, para1=Theta1, para2=Theta2)
print(composite2COP(0.4, 0.6, para)) # 0.2779868

# In this example, the N4212cop uses "3" as its parameter value.
para &lt;- list(alpha=alpha, beta=beta, cop1=W, cop2=N4212cop, para1=Theta1, para2=3)
print(composite2COP(0.4, 0.6, para)) # 0.3387506

## Not run: 
# This example does a great job of showing a composited copula with a near singularity,
# but with leakage of chance to the upper left. The example is also critical because
# it shows that gridCOP is returning a matrix in the proper orientation relative to
# the level.curvesCOP and simCOP functions. Example is cross-ref'ed from gridCOP() docs.
layout(matrix(1:2,byrow=TRUE))
para &lt;- list(alpha=0.5, beta=0.90, cop1=M, cop2=N4212cop, para1=NA, para2=1.4)
image(gridCOP(cop=composite2COP, para=para, delta=0.01), col=terrain.colors(30),
      xlab="U, NONEXCEEDANCE PROBABILITY", ylab="V, NONEXCEEDANCE PROBABILITY")
D &lt;- simCOP(n=2000, cop=composite2COP, para=para, ploton=FALSE, pch=4, col=4, cex=0.75)
level.curvesCOP(cop=composite2COP, para=para, ploton=FALSE, delt=0.05)
mtext("Theoretical composited copula, level curves, and simulation")

emp &lt;- EMPIRgrid(para=D, deluv=0.05)     # CPU heavy
image(emp$empcop, col=terrain.colors(30) ) # image orientation is correct!
# Depending on balance between sample size, deluv, delu, and delt, one or more:
# Error in uniroot(func, interval = c(0, 1), u = u, LHS = t, cop = cop,  :
#   f() values at end points not of opposite sign
# warnings might be triggered. This is particularly true because of the flat derivative
# above the near singularity in this example composited copula.
points(D$U, D$V, pch=4, col=4, cex=0.75)
level.curvesCOP(cop=EMPIRcop, para=D, ploton=FALSE, delu=0.02, delt=0.05)
mtext("Empirical copula from n=2000 simulation") #
## End(Not run)
</code></pre>


</div>