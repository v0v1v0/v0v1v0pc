<div class="container">

<table style="width: 100%;"><tr>
<td>sim.gdina</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Simulation of the GDINA model
</h2>

<h3>Description</h3>

<p>The function <code>sim.gdina.prepare</code> creates necessary design matrices
<code>Mj</code>, <code>Aj</code> and <code>necc.attr</code>. In most cases, only the list
of item parameters <code>delta</code> must be modified by the user when
applying the simulation function <code>sim.gdina</code>. The distribution of latent
classes <code class="reqn">\alpha</code> is represented by an underlying multivariate normal distribution
<code class="reqn">\alpha^\ast</code> for which a mean vector <code>thresh.alpha</code> and a
covariance matrix <code>cov.alpha</code> must be specified.
Alternatively, a matrix of skill classes <code>alpha</code>
can be given as an input.
</p>
<p>Note that this version of <code>sim.gdina</code> only works for dichotomous attributes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim.gdina(n, q.matrix, delta, link="identity",  thresh.alpha=NULL,
    cov.alpha=NULL, alpha=NULL, Mj, Aj, necc.attr)

sim.gdina.prepare( q.matrix )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>Number of persons
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q.matrix</code></td>
<td>

<p>Q-matrix (see <code>sim.din</code>)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>

<p>List with <code class="reqn">J</code> entries where <code class="reqn">J</code> is the number of items.
Every list element corresponds to the parameter of an item.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>

<p>Link function. Choices are <code>identity</code> (default), <code>logit</code> and <code>log</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresh.alpha</code></td>
<td>

<p>Vector of thresholds (means) of <code class="reqn">\alpha^\ast</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov.alpha</code></td>
<td>

<p>Covariance matrix of <code class="reqn">\alpha^\ast</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>Matrix of skill classes if they should not be simulated
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Mj</code></td>
<td>

<p>Design matrix, see <code>gdina</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Aj</code></td>
<td>

<p>Design matrix, see <code>gdina</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>necc.attr</code></td>
<td>

<p>List with <code class="reqn">J</code> entries containing necessary attributes
for each item
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The output of <code>sim.gdina</code> is a list with following entries:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Simulated item responses</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Data frame with simulated attributes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q.matrix</code></td>
<td>
<p>Used Q-matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>Used delta item parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Aj</code></td>
<td>
<p>Design matrices <code class="reqn">A_j</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Mj</code></td>
<td>
<p>Design matrices <code class="reqn">M_j</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>
<p>Used link function</p>
</td>
</tr>
</table>
<p>The function <code>sim.gdina.prepare</code> possesses the following values as output
in a list: <code>delta</code>, <code>necc.attr</code>, <code>Aj</code> and <code>Mj</code>.
</p>


<h3>References</h3>

<p>de la Torre, J. (2011). The generalized DINA model framework.
<em>Psychometrika, 76</em>, 179â€“199.
</p>


<h3>See Also</h3>

<p>For estimating the GDINA model see <code>gdina</code>.
</p>
<p>See the <code>GDINA::simGDINA</code> function in the
<span class="pkg">GDINA</span> package for similar functionality.
</p>
<p>See <code>sim_model</code> for a general simulation function.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#############################################################################
# EXAMPLE 1: Simulating the GDINA model
#############################################################################

n &lt;- 50             # number of persons
# define Q-matrix
q.matrix &lt;- matrix(  c(1,1,0, 0,1,1, 1,0,1, 1,0,0,
    0,0,1, 0,1,0,  1,1,1,  0,1,1, 0,1,1), ncol=3, byrow=TRUE)
# thresholds for attributes alpha^\ast
thresh.alpha &lt;- c( .65, 0, -.30 )
# covariance matrix for alpha^\ast
cov.alpha &lt;- matrix(1,3,3)
cov.alpha[1,2] &lt;- cov.alpha[2,1] &lt;- .4
cov.alpha[1,3] &lt;- cov.alpha[3,1] &lt;- .6
cov.alpha[3,2] &lt;- cov.alpha[2,3] &lt;- .8

# prepare design matrix by applying sim.gdina.prepare function
rp &lt;- CDM::sim.gdina.prepare( q.matrix )
delta &lt;- rp$delta
necc.attr &lt;- rp$necc.attr
Aj &lt;- rp$Aj
Mj &lt;- rp$Mj
# define delta parameters
# intercept - main effects - second order interactions - ...
str(delta)  #=&gt; modify the delta parameter list which contains only zeroes as default
##   List of 9
##    $ : num [1:4] 0 0 0 0
##    $ : num [1:4] 0 0 0 0
##    $ : num [1:4] 0 0 0 0
##    $ : num [1:2] 0 0
##    $ : num [1:2] 0 0
##    $ : num [1:2] 0 0
##    $ : num [1:8] 0 0 0 0 0 0 0 0
##    $ : num [1:4] 0 0 0 0
##    $ : num [1:4] 0 0 0 0
delta[[1]] &lt;- c( .2, .1, .15, .4 )
delta[[2]] &lt;- c( .2, .3, .3, -.2 )
delta[[3]] &lt;- c( .2, .2, .2, 0 )
delta[[4]] &lt;- c( .15, .6 )
delta[[5]] &lt;- c( .1, .7 )
delta[[6]] &lt;- c( .25, .65 )
delta[[7]] &lt;- c( .25, .1, .1, .1, 0, 0, 0, .25 )
delta[[8]] &lt;- c( .2, 0, .3, -.1 )
delta[[9]] &lt;- c( .2, .2, 0, .3 )

#******************************************
# Now, the "real simulation" starts
sim.res &lt;- CDM::sim.gdina( n=n, q.matrix=q.matrix, delta=delta, link="identity",
                thresh.alpha=thresh.alpha, cov.alpha=cov.alpha,
                Mj=Mj, Aj=Aj, necc.attr=necc.attr)
# sim.res$data      # simulated data
# sim.res$alpha     # simulated alpha

## Not run: 
#############################################################################
# EXAMPLE 2: Simulation based on already estimated GDINA model for data.ecpe
#############################################################################

data(data.ecpe)
dat &lt;- data.ecpe$data
q.matrix &lt;- data.ecpe$q.matrix

#***
# (1) estimate GDINA model
mod &lt;- CDM::gdina( data=dat[,-1], q.matrix=q.matrix )

#***
# (2) simulate data according to GDINA model
set.seed(977)

# prepare design matrix by applying sim.gdina.prepare function
rp &lt;- CDM::sim.gdina.prepare( q.matrix )
necc.attr &lt;- rp$necc.attr

# number of subjects to be simulated
n &lt;- 3000
# simulate attribute patterns
probs &lt;- mod$attribute.patt$class.prob   # probabilities
patt &lt;- mod$attribute.patt.splitted      # response patterns
alpha &lt;- patt[ sample( 1:(length(probs) ), n, prob=probs, replace=TRUE), ]

# simulate data using estimated item parameters
sim.res &lt;- CDM::sim.gdina( n=n, q.matrix=q.matrix, delta=mod$delta, link="identity",
                alpha=alpha, Mj=mod$Mj, Aj=mod$Aj, necc.attr=rp$necc.attr)
# extract data
dat &lt;- sim.res$data

#############################################################################
# EXAMPLE 3: Simulation based on already estimated RRUM model for data.ecpe
#############################################################################

dat &lt;- CDM::data.ecpe$data
q.matrix &lt;- CDM::data.ecpe$q.matrix

#***
# (1) estimate reduced RUM model
mod &lt;- CDM::gdina( data=dat[,-1], q.matrix=q.matrix, rule="RRUM" )
summary(mod)

#***
# (2) simulate data according to RRUM model
set.seed(977)

# prepare design matrix by applying sim.gdina.prepare function
rp &lt;- CDM::sim.gdina.prepare( q.matrix )
necc.attr &lt;- rp$necc.attr

# number of subjects to be simulated
n &lt;- 5000
# simulate attribute patterns
probs &lt;- mod$attribute.patt$class.prob   # probabilities
patt &lt;- mod$attribute.patt.splitted      # response patterns
alpha &lt;- patt[ sample( 1:(length(probs) ), n, prob=probs, replace=TRUE), ]

# simulate data using estimated item parameters
sim.res &lt;- CDM::sim.gdina( n=n, q.matrix=q.matrix, delta=mod$delta, link=mod$link,
                alpha=alpha, Mj=mod$Mj, Aj=mod$Aj, necc.attr=rp$necc.attr)
# extract data
dat &lt;- sim.res$data

## End(Not run)
</code></pre>


</div>