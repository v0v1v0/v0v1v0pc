<div class="container">

<table style="width: 100%;"><tr>
<td>plot_surv_rmst</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Plot the Effect of a Continuous Variable on the Restricted Mean Survival Time
</h2>

<h3>Description</h3>

<p>Using a previously fit time-to-event model, this function plots the restricted mean survival time (RMST) as a function of a continuous variable.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_surv_rmst(time, status, variable, group=NULL,
               data, model, na.action=options()$na.action,
               tau, horizon=NULL, custom_colors=NULL,
               size=1, linetype="solid", alpha=1, color="black",
               xlab=variable, ylab="Restricted Mean Survival Time",
               title=NULL, subtitle=NULL,
               legend.title=variable, legend.position="right",
               gg_theme=ggplot2::theme_bw(),
               facet_args=list(), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>

<p>A single character string specifying the time-to-event variable. Needs to be a valid column name of a variable in <code>data</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>status</code></td>
<td>

<p>A single character string specifying the status variable, indicating if a person has experienced an event or not. Needs to be a valid column name of a variable in <code>data</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variable</code></td>
<td>

<p>A single character string specifying the continuous variable of interest, for which the survival curves should be estimated. This variable has to be contained in the <code>data.frame</code> that is supplied to the <code>data</code> argument.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>

<p>An optional single character string specifying a factor variable in <code>data</code>. When used, the plot is created conditional on this factor variable, meaning that a facetted plot is produced with one facet for each level of the factor variable. See <code>curve_cont</code> for a detailed description of the estimation strategy. Set to <code>NULL</code> (default) to use no grouping variable.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>A <code>data.frame</code> containing all required variables.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>

<p>A model describing the time-to-event process (such as an <code>coxph</code> model). Needs to include <code>variable</code> as an independent variable. It also has to have an associated <code>predictRisk</code> method. See <code>?predictRisk</code> for more details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>

<p>How missing values should be handled. Can be one of: <code>na.fail</code>, <code>na.omit</code>, <code>na.pass</code>, <code>na.exclude</code> or a user-defined custom function. Also accepts strings of the function names. See <code>?na.action</code> for more details. By default it uses the na.action which is set in the global options by the respective user.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>

<p>The point in time to which the RMST should be calculated. Can be a vector of numbers. If multiple values are supplied, one curve is drawn for each of them.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>horizon</code></td>
<td>

<p>A numeric vector containing a range of values of <code>variable</code> for which the survival curves should be calculated or <code>NULL</code> (default). If <code>NULL</code>, the horizon is constructed as a sequence from the lowest to the highest value observed in <code>variable</code> with 100 equally spaced steps.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>custom_colors</code></td>
<td>

<p>An optional character vector of colors to use when there are multiple values in <code>tau</code>. Ignored if <code>length(tau)==1</code>, in which case the <code>color</code> argument can be used to specify the color of the single line.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>

<p>A single number specifying how thick the lines should be drawn.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linetype</code></td>
<td>

<p>The linetype of the drawn lines. See documentation of <span class="pkg">ggplot2</span> for more details on allowed values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>The transparency level of the lines.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color</code></td>
<td>

<p>The color of the curve if <code>tau</code> is a single value. If a numeric vector was supplied to <code>tau</code>, use the <code>custom_colors</code> argument to specify them instead.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>

<p>A character string used as the x-axis label of the plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>

<p>A character string used as the y-axis label of the plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>

<p>A character string used as the title of the plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subtitle</code></td>
<td>

<p>A character string used as the subtitle of the plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.title</code></td>
<td>

<p>A character string used as the legend title of the plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.position</code></td>
<td>

<p>Where to put the legend. See <code>?theme</code> for more details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gg_theme</code></td>
<td>

<p>A <span class="pkg">ggplot2</span> theme which is applied to the plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>facet_args</code></td>
<td>

<p>A named list of arguments that are passed to the <code>facet_wrap</code> function call when creating a plot separated by groups. Ignored if <code>group=NULL</code>. Any argument except the <code>facets</code> argument of the <code>facet_wrap</code> function can be used. For example, if the user wants to allow free y-scales, this argument could be set to <code>list(scales="free_y")</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Further arguments passed to <code>curve_cont</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Similar to the <code>plot_surv_at_t</code> and <code>plot_surv_quantiles</code> plots, this function produces a plot of a survival curve summary statistic as a function of a continuous variable. The summary statistic in question is the restricted mean survival time (RMST), which is the area under a survival curve up to a specific point in time <code>tau</code>. It can be interpreted as the mean survival time of the population up to <code>tau</code>.
</p>
<p>First, a range of value-specific survival curves are estimated. The RMST is then calculated for each one using step function interpolation. This only works for survival curves, not for CIFs. If the area under the CIF should be used instead, the <code>plot_surv_rmtl</code> function can be used.
</p>
<p>An advantage of this method over the <code>plot_surv_at_t</code> and <code>plot_surv_quantiles</code> function is, that it does take the whole survival curve into account, kind of. Although it is the area under it, it is only calculated up to <code>tau</code> which makes the output dependent on the choice of <code>tau</code>. This, again, can result in deceiving plots in some cases. Plots visualizing the entire survival curves such as <code>plot_surv_contour</code> and <code>plot_surv_area</code> might be preferable.
</p>


<h3>Value</h3>

<p>Returns a <code>ggplot2</code> object.
</p>


<h3>Author(s)</h3>

<p>Robin Denz
</p>


<h3>References</h3>

<p>Eng, K. H.; Schiller, E. &amp; Morrell, K. On Representing the Prognostic Value of Continuous Gene Expression Biomarkers with the Restricted Mean Survival Curve. In: Oncotarget, 2015, 6, 36308-36318
</p>
<p>Robin Denz, Nina Timmesfeld (2023). "Visualizing the (Causal) Effect of a Continuous Variable on a Time-To-Event Outcome". In: Epidemiology 34.5
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(contsurvplot)
library(riskRegression)
library(survival)
library(ggplot2)
library(splines)

# using data from the survival package
data(nafld, package="survival")

# take a random sample to keep example fast
set.seed(42)
nafld1 &lt;- nafld1[sample(nrow(nafld1), 150), ]

# fit cox-model with age
model &lt;- coxph(Surv(futime, status) ~ age, data=nafld1, x=TRUE)

# plot effect of age on the RMST for ages 50 to 80
plot_surv_rmst(time="futime",
               status="status",
               variable="age",
               data=nafld1,
               model=model,
               horizon=seq(50, 80, 1),
               tau=2500)

# plot RMST for multiple tau values for ages 50 to 80
plot_surv_rmst(time="futime",
               status="status",
               variable="age",
               data=nafld1,
               model=model,
               horizon=seq(50, 80, 1),
               tau=c(2000, 3000, 5000))

## showing non-linear effects

# fit cox-model with bmi modeled using B-Splines,
# adjusting for age and sex
model2 &lt;- coxph(Surv(futime, status) ~ age + male + bs(bmi, df=3),
                data=nafld1, x=TRUE)

# plot effect of bmi on survival
plot_surv_rmst(time="futime",
               status="status",
               variable="bmi",
               data=nafld1,
               model=model2,
               tau=c(2000, 3000, 5000))
</code></pre>


</div>