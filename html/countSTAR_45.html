<div class="container">

<table style="width: 100%;"><tr>
<td>predict.lmstar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Predict method for response in STAR linear model</h2>

<h3>Description</h3>

<p>Outputs predicted values based on an lmstar fit and optionally prediction intervals based
on the the (plug-in) predictive distribution for the STAR linear model
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'lmstar'
predict(object, newdata = NULL, interval = FALSE, level = 0.95, N = 1000, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>Object of class "lmstar" as output by <code>lm_star</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>An optional matrix/data frame  in which to look for variables with which to predict.
If omitted, the fitted values are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interval</code></td>
<td>
<p>logical; whether or not to include prediction intervals (default FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>Level for prediction intervals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>number of Monte Carlo samples from the posterior predictive distribution
used to approximate intervals; default is 1000</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Ignored</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If interval=TRUE, then <code>predict.lmstar</code> uses a Monte Carlo approach to estimating the (plug-in)
predictive distribution for the STAR linear model. The algorithm iteratively samples
(i) the latent data given the observed data, (ii) the latent predictive data given the latent data from (i),
and (iii) (inverse) transforms and rounds the latent predictive data to obtain a
draw from the integer-valued predictive distribution.
</p>
<p>The appropriate quantiles of these Monte Carlo draws are computed and reported as the prediction interval.
</p>


<h3>Value</h3>

<p>Either a a vector of predictions (if interval=FALSE) or a matrix of predictions and
bounds with column names fit, lwr, and upr
</p>


<h3>Note</h3>

<p>The â€œplug-in" predictive distribution is a crude approximation. Better
approaches are available using the Bayesian models, e.g. <code>blm_star</code>, which provide samples
from the posterior predictive distribution.
</p>
<p>For highly skewed responses, prediction intervals especially at lower levels may
not include the predicted value itself, since the mean is often much larger than the median.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Simulate data with count-valued response y:
x = seq(0, 1, length.out = 100)
y = rpois(n = length(x), lambda = exp(1.5 + 5*(x -.5)^2))

# Estimate model--assume a quadratic effect (better for illustration purposes)
fit = lm_star(y~x+I(x^2), transformation = 'sqrt')

#Compute the predictive draws for the test points (same as observed points here)
#Also compute intervals using plug-in predictive distribution
y_pred = predict(fit, interval=TRUE)

# Plot the results
plot(x, y, ylim = range(y, y_pred), main = 'STAR: Predictions and 95% PI')
lines(x,y_pred[,"fit"], col='black', type='s', lwd=4)
lines(x, y_pred[,"lwr"], col='darkgray', type='s', lwd=4)
lines(x, y_pred[,"upr"], col='darkgray', type='s', lwd=4)

</code></pre>


</div>