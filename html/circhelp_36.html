<div class="container">

<table style="width: 100%;"><tr>
<td>weighted_sem</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Weighted standard error of the mean (SEM_w)</h2>

<h3>Description</h3>

<p>Computes the variance of a weighted mean following the definitions given by Kirchner (2006).
</p>


<h3>Usage</h3>

<pre><code class="language-R">weighted_sem(x, w, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>variable to compute the SEM for</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>should NAs be removed</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>James Kirchner describes two different cases when the weighted variance is computed. The code here implements Case I where "one wants to give more weight to some points than to others, because they are considered to be more important" and "the weights differ but the uncertainties associated with the individual xi are assumed to be the same" (Kirchner, 2006, p. 1). The formula used is:
\[SEM_w = \sqrt{\left(\sum_{i = 1}^{N} (w_{i} x_i^2)-\bar{x}^2\right)\frac{\sum_{i = 1}^{N} w_i^2}{1-\sum_{i = 1}^{N} w_i^2}} \]
The expected error is within 5% of the bootstrapped SEM (at larger sample sizes).
</p>


<h3>Value</h3>

<p>weighted standard error of the mean
</p>


<h3>References</h3>



<ul>
<li>
<p> Kirchner, J. 2006. Data Analysis Toolkit #12: Weighted averages and their uncertainties. <a href="https://seismo.berkeley.edu/~kirchner/Toolkits/Toolkit_12.pdf">https://seismo.berkeley.edu/~kirchner/Toolkits/Toolkit_12.pdf</a>.  Retrieved on 04.07.2024.
</p>
</li>
<li>
<p> Bevington, P. R. 1969. Data Reduction and Error Analysis for the Physical Sciences. McGraw-Hill, 336 pp.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)
n_obs &lt;- 200
w &lt;- runif(n_obs)
w &lt;- w/sum(w)
x &lt;- rnorm(n_obs, sd = 5)
weighted_sem(x, w)
</code></pre>


</div>