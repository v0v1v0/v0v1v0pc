<div class="container">

<table style="width: 100%;"><tr>
<td>cpss.em</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Detecting changes in exponential family</h2>

<h3>Description</h3>

<p>Detecting changes in exponential family
</p>


<h3>Usage</h3>

<pre><code class="language-R">cpss.em(
  dataset,
  family,
  size = NULL,
  algorithm = "BS",
  dist_min = floor(log(n)),
  ncps_max = ceiling(n^0.4),
  pelt_pen_val = NULL,
  pelt_K = 0,
  wbs_nintervals = 500,
  criterion = "CV",
  times = 2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dataset</code></td>
<td>
<p>a numeric matrix of dimension <code class="reqn">n\times d</code>, where each row represents an observation and each column stands for a variable. A numeric vector is also acceptable for univariate observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>a character string specifying the underlying distribution. In the current version, detecting changes in binomial ("<code>binom</code>"), multinomial ("<code>multinom</code>"), Poisson ("<code>pois</code>"), exponential ("<code>exp</code>"), geometric ("<code>geom</code>"), Dirichlet ("<code>diri</code>"), gamma ("<code>gamma</code>"), beta ("<code>beta</code>"), chi-square ("<code>chisq</code>") and inverse gaussian ("<code>invgauss</code>") distributions are supported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>an integer indicating the number of trials only if <code>family = "binom"</code> or <code>family = "multinom"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>algorithm</code></td>
<td>
<p>a character string specifying the change-point searching algorithm, one of the following choices: "SN" (segment neighborhood), "BS" (binary segmentation), "WBS" (wild binary segmentation) and "PELT" (pruned exact linear time) algorithms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist_min</code></td>
<td>
<p>an integer specifying minimum searching distance (length of feasible segments).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncps_max</code></td>
<td>
<p>an integer specifying an upper bound of the number of true change-points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pelt_pen_val</code></td>
<td>
<p>a numeric vector specifying candidate values of the penalty only if <code>algorithm = "PELT"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pelt_K</code></td>
<td>
<p>a numeric value for pruning adjustment only if <code>algorithm = "PELT"</code>. It is usually taken to be 0 if the negative log-likelihood is used as a cost, see Killick et al. (2012).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wbs_nintervals</code></td>
<td>
<p>an integer specifying the number of random intervals drawn only if <code>algorithm = "WBS"</code>, see Fryzlewicz (2014).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>
<p>a character string specifying the model selection criterion, "CV" ("cross-validation") or "MS" ("multiple-splitting").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>
<p>an integer specifying how many times of sample-splitting should be performed; It should be 2 if <code>criterion = "CV"</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>cpss.em</code> returns an object of an S4 class, called "<code>cpss</code>", which collects data and information required for further change-point analyses and summaries. See <code>cpss.custom</code>.
</p>


<h3>References</h3>

<p>Killick, R., Fearnhead, P., and Eckley, I. A. (2012). Optimal Detection of Changepoints With a Linear Computational Cost. Journal of the American Statistical Association, 107(500):1590–1598.
</p>
<p>Fryzlewicz, P. (2014). Wild binary segmentation for multiple change-point detection. The Annals of Statistics, 42(6): 2243–2281.
</p>


<h3>See Also</h3>

<p><code>cpss.meanvar</code> <code>cpss.mean</code> <code>cpss.var</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library("cpss")
set.seed(666)
n &lt;- 1000
tau &lt;- c(100, 300, 700, 900)
tau_ext &lt;- c(0, tau, n)
theta &lt;- c(1, 0.2, 1, 0.2, 1)
seg_len &lt;- diff(c(0, tau, n))
y &lt;- unlist(lapply(seq(1, length(tau) + 1), function(k) {
  rexp(seg_len[k], theta[k])
}))
res &lt;- cpss.em(
  y, family = "exp", algorithm = "WBS", ncps_max = 10,
  criterion = "MS", times = 10
)
cps(res)
# [1] 100 299 705 901
</code></pre>


</div>