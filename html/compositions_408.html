<div class="container">

<table style="width: 100%;"><tr>
<td>logratioVariogram</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Empirical variograms for compositions</h2>

<h3>Description</h3>

<p>Computes the matrix of logratio variograms.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  logratioVariogram(data, ...)
  
  ## S3 method for class 'acomp'
logratioVariogram(data,
                          loc,
                          maxdist=max(dist(loc))/2,
                          nbins=20,
                          dists=seq(0,maxdist,length.out=nbins+1),
                          bins=cbind(dists[-length(dists)],dists[-1]),
                          azimuth=0,
                          azimuth.tol=180,
                          comp=data,
                          ...
                          )
          </code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an acomp compositional dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments for generic functionality</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loc</code></td>
<td>
<p>a matrix or dataframe providing the observation locations
of the compositions. Any number of dimension &gt;= 2 is supported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxdist</code></td>
<td>
<p>the maximum distance to compute the variogram for.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbins</code></td>
<td>
<p>The number of distance bins to compute the variogram for</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dists</code></td>
<td>
<p>The distances seperating the bins</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bins</code></td>
<td>
<p>a matrix with lower and upper limit for the distances of
each bin. A pair is counted if min&lt;h&lt;=max. min and max are provided
as columns. bins is computed from maxdist,nbins and dists. If it is
provided, it is used directly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>azimuth</code></td>
<td>
<p> For directional variograms the direction, either as an
azimuth  angle (i.e. a single real number) for 2D
datasets or a unit vector pointing of the same dimension as the
locations. The angle is clockwise from North in degree. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>azimuth.tol</code></td>
<td>
<p> The angular tolerance it should be below 90 if a
directional variogram is intended. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>comp</code></td>
<td>
<p>do not use, only provided for backwards compatibility. Use <code>data</code> instead</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The logratio-variogram is the set of variograms of each of the pairwise
logratios. It can be proven that it carries the same information as a
usual multivariate variogram. The great advantage is that all the
funcitions have a direct interpreation and can be estimated even with
(MAR) missings in the dataset. 
</p>


<h3>Value</h3>

<p>A list of class <code>"logratioVariogram"</code>.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>vg</code></td>
<td>
<p>A nbins x D x D array containing the logratio variograms</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>A nbins x D x D array containing the mean distance the
value is computed on. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>A nbins x D x D array containing the
number of nonmissing pairs used for the corresponding value.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>K.Gerald v.d. Boogaart <a href="http://www.stat.boogaart.de">http://www.stat.boogaart.de</a></p>


<h3>References</h3>

<p>Tolosana, van den Boogaart, Pawlowsky-Glahn (2009) Estimating and
modeling variograms of compositional data with occasional missing
variables in R, StatGis09
</p>
<p>Pawlowsky-Glahn, Vera and Olea, Ricardo A. (2004) Geostatistical
Analysis of Compositional Data, Oxford University Press, Studies in
Mathematical Geology
</p>


<h3>See Also</h3>

<p><code>vgram2lrvgram</code>,
<code>CompLinModCoReg</code>,
<code>vgmFit</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data(juraset)
X &lt;- with(juraset,cbind(X,Y))
comp &lt;- acomp(juraset,c("Cd","Cu","Pb","Co","Cr"))
lrv &lt;- logratioVariogram(comp,X,maxdist=1,nbins=10)
plot(lrv)

## End(Not run)
</code></pre>


</div>