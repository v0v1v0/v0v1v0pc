<div class="container">

<table style="width: 100%;"><tr>
<td>safeUroot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>One-dimensional Root (Zero) Finding - Extra "Safety" for Convenience</h2>

<h3>Description</h3>

<p><code>safeUroot()</code> as a “safe” version of
<code>uniroot()</code> searches for a root (that is, zero) of the
function <code>f</code> with respect to its first argument.
</p>
<p>“Safe” means searching for the correct <code>interval
    = c(lower,upper)</code> if <code>sign(f(x))</code> does not satisfy the
requirements at the interval end points; see the ‘Details’
section.
</p>


<h3>Usage</h3>

<pre><code class="language-R">safeUroot(f, interval, ...,
       lower = min(interval), upper = max(interval),
       f.lower = f(lower, ...), f.upper = f(upper, ...),
       Sig = NULL, check.conv = FALSE,
       tol = .Machine$double.eps^0.25, maxiter = 1000, trace = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interval</code></td>
<td>
<p>interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional named or unnamed arguments to be passed
to <code>f</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower, upper</code></td>
<td>
<p>lower and upper endpoint of search interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f.lower, f.upper</code></td>
<td>
<p>function value at <code>lower</code> or <code>upper</code>
endpoint, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sig</code></td>
<td>
<p><em>desired</em> sign of <code>f(upper)</code>, or <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check.conv</code></td>
<td>
<p>logical indicating whether a convergence warning of the
underlying <code>uniroot</code> should be caught as an error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>the desired accuracy, that is, convergence tolerance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>maximal number of iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>number determining tracing</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If it is <em>known how</em> <code class="reqn">f</code> changes sign at the root
<code class="reqn">x_0</code>, that is, if the function is increasing or decreasing there,
<code>Sig</code> can be specified, typically as <code class="reqn">S := \pm 1</code>,
to require <code class="reqn">S = \mathrm{sign}(f(x_0 + \epsilon))</code>
at the solution.  In that case, the search interval <code class="reqn">[l,u]</code> must
be such that <code class="reqn">S * f(l) &lt;= 0</code> and <code class="reqn">S * f(u) &gt;= 0</code>.
</p>
<p>Otherwise, by default, when <code>Sig=NULL</code>, the search interval
<code class="reqn">[l,u]</code> must satisfy <code class="reqn">f(l) * f(u) &lt;= 0</code>.
</p>
<p>In both cases, when the requirement is not satisfied, <code>safeUroot()</code>
tries to enlarge the interval until the requirement <em>is</em> satisfied.
</p>





<h3>Value</h3>

<p>A list with four components, <code>root</code>, <code>f.root</code>, <code>iter</code>
and <code>estim.prec</code>; see <code>uniroot</code>.
</p>


<h3>See Also</h3>

<p><code>uniroot</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">f1 &lt;- function(x) (121 - x^2)/(x^2+1)
f2 &lt;- function(x) exp(-x)*(x - 12)

try(uniroot(f1, c(0,10)))
try(uniroot(f2, c(0,2)))
##--&gt; error: f() .. end points not of opposite sign

## where as safeUroot() simply first enlarges the search interval:
safeUroot(f1, c(0,10),trace=1)
safeUroot(f2, c(0,2), trace=2)

## no way to find a zero of a positive function:
try( safeUroot(exp, c(0,2), trace=TRUE) )

## Convergence checking :
safeUroot(sinc, c(0,5), maxiter=4) #-&gt; "just" a warning
try( # an error, now with  check.conv=TRUE
  safeUroot(sinc, c(0,5), maxiter=4, check.conv=TRUE) )
</code></pre>


</div>