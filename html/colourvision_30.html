<div class="container">

<table style="width: 100%;"><tr>
<td>RNLthres</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Colour thresholds based on the Receptor Noise Limited Model (Vorobyev &amp; Osorio 1998).
</h2>

<h3>Description</h3>

<p>Colour thresholds based on receptor noise for any number of photoreceptor types (Vorobyev &amp; Osorio 1998).
</p>


<h3>Usage</h3>

<pre><code class="language-R">RNLthres(photo=ncol(C)-1, Rb, I, C, noise=TRUE, v=NA, n=NA, e=NA,
         interpolate=TRUE, nm=seq(300,700,1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>photo</code></td>
<td>

<p>Number of photoreceptor types. Model accepts any number of photoreceptor types (<code>&gt;=2</code>). For instance, dichromatic: <code>photo=2</code>; trichromatic: <code>photo=3</code>; tetrachromatic: <code>photo=4</code>, etc. Default gets number of photoreceptor types from <code>C</code> argument.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rb</code></td>
<td>

<p>Background reflectance. A data frame with two columns only: first column corresponding to wavelength values and second column with reflectance values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>I</code></td>
<td>

<p>Irradiance spectrum. A data frame with two columns only: first column corresponding to wavelength values and second column with irradiance values. Irradiance values must be in quantum flux units.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>

<p>Photoreceptor sensitivity curves, from lowest to longest lambda-max. A data frame: first column corresponding to wavelength values and following columns with photoreceptor sensitivity values (see function <code>photor</code>). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noise</code></td>
<td>

<p>Logical. Whether receptor noise is provided (<code>noise = TRUE</code>) or calculated from photoreceptor relative abundances (<code>noise = FALSE</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>e</code></td>
<td>

<p>Receptor noise of each photoreceptor type. Used when <code>noise = TRUE</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>Relative number of each photoreceptor type in the retina. Usually increases with lambda-max. Used to calculate <code>e</code> when <code>noise = FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>

<p>Noise-to-signal ratio of a single photoreceptor. Used to calculate <code>e</code> when <code>noise = FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interpolate</code></td>
<td>

<p>Whether data files should be interpolated before further calculations. See <code>approx</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nm</code></td>
<td>

<p>A sequence of numeric values specifying where interpolation is to take place. See <code>approx</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Colour thresholds based on receptor noise limited model as in Vorobyev and Osorio (1998). In lack of a direct measurement, receptor noise (<code class="reqn">e_i</code>) can be estimated by the relative abundance of photoreceptor types in the retina, and a measurement of a single photoreceptor noise-to-signal ratio:
</p>
<p style="text-align: center;"><code class="reqn">e_i=\frac{\nu}{\sqrt{\eta _i}}</code>
</p>

<p>where <code class="reqn">\nu</code> is the noise-to-signal ratio of a single photoreceptor, and <code class="reqn">\eta</code> is the relative abundance of photoreceptor i in the retina. Alternatively, noise may be dependent of the intensity, but this possibility is not implement in <code>colourvision</code> yet. Noise dependent of intensity usually holds for low light conditions only (Vorobyev et al. 1998). 
</p>


<h3>Value</h3>

<p>A data.frame with the following columns:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>nm</code></td>
<td>
<p>Wavelength in nm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T</code></td>
<td>
<p>Colour threshold value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>Log of sensitivity value (inverse of threshold).</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Felipe M. Gawryszewski <a href="mailto:f.gawry@gmail.com">f.gawry@gmail.com</a>
</p>


<h3>References</h3>

<p>Vorobyev, M., and D. Osorio. 1998. Receptor noise as a determinant of colour thresholds. Proceedings of the Royal Society B 265:351-358.
</p>


<h3>See Also</h3>

<p><code>photor</code>, <code>RNLmodel</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">###Bee photoreceptors normalized to max=1.
data("bee")
C&lt;-bee
C[,2]&lt;-C[,2]/max(C[,2])
C[,3]&lt;-C[,3]/max(C[,3])
C[,4]&lt;-C[,4]/max(C[,4])

##Grey background:
Rb &lt;- data.frame(300:700, rep(0.1, length(300:700)))

## CIE D65 illuminant:
data("D65")

#Thresholds
thres&lt;-RNLthres(photo=3, Rb=Rb, I=D65, C=C,
       noise=TRUE, e = c(0.13, 0.06, 0.12))

plot(thres)     
</code></pre>


</div>