<div class="container">

<table style="width: 100%;"><tr>
<td>weightedEM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Estimates location and scatter on incomplete data with case weights
</h2>

<h3>Description</h3>

<p>Carries out a rowwise weighted EM algorithm to estimate mu and Sigma of incomplete Gaussian data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">weightedEM(X, w=NULL, lmin=NULL, crit=1e-4, 
                      maxiter=1000, initEst=NULL, computeloglik=F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>n by d data matrix or data frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>vector with n nonnegative rowwise (casewise)
weights. If <code>NULL</code>, all weights are set to 1 so
an unweighted EM is carried out.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lmin</code></td>
<td>
<p>if not <code>NULL</code>, a lower bound on the eigenvalues
of the estimated EM covariance matrix on the
standardized data, to avoid singularity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crit</code></td>
<td>
<p>convergence criterion of successive mu
and Sigma estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>maximal number of iteration steps.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initEst</code></td>
<td>
<p>if not <code>NULL</code>, a list with initial estimates <code>$mu</code> of the mean, <code>$Sigma</code> of the covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>computeloglik</code></td>
<td>
<p>if <code>TRUE</code>, the log(likelihood) is computed in
every step and reported. Default is <code>FALSE</code>
to save computation time.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with components: <br></p>

<ul>
<li>
<p><code>mu</code><br> the estimated location vector.
</p>
</li>
<li>
<p><code>Sigma</code><br> the estimated covariance matrix.
</p>
</li>
<li>
<p><code>impX</code><br> the imputed data matrix.
</p>
</li>
<li>
<p><code>niter</code><br> the number of iteration steps taken.
</p>
</li>
<li>
<p><code>loglikhd</code><br> vector with the total log(likelihood) at every
iteration step. When <code>computeloglik = FALSE</code> this
array contains NA's.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>P.J. Rousseeuw
</p>


<h3>References</h3>

<p>P.J. Rousseeuw (2023). Analyzing cellwise weighted data. Econometrics and Statistics, appeared online. <a href="https://doi.org/10.1016/j.ecosta.2023.01.007">doi:10.1016/j.ecosta.2023.01.007</a>(link to open access pdf)
</p>


<h3>See Also</h3>

 
<p><code>unpack</code>,
<code>cwLocScat</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
Sigma &lt;- matrix(0.7, 3, 3); diag(Sigma) &lt;- 1
set.seed(12345); X &lt;- MASS::mvrnorm(1000, rep(0, 3), Sigma)
X[1, 3] &lt;- X[2, 2] &lt;- X[3, 1] &lt;- X[4, 1] &lt;- X[5, 2] &lt;- NA
w &lt;- runif(1000, 0, 1) # rowwise weights
out &lt;- weightedEM(X, w, crit = 1e-12, computeloglik = TRUE)
out$niter # number of iteration steps taken
plot(1:out$niter, out$loglikhd[1:out$niter], type = 'l',
     lty = 1, col = 4, xlab = 'step', ylab = 'log(likelihood)',
     main = 'log(likelihood) of weighted EM iterations')
out$mu # estimated center
round(out$Sigma, 6) # estimated covariance matrix
head(X) # the data has NA's
head(out$impX) # imputed data, has no NA's

# For more examples, we refer to the vignette:
## Not run: 
vignette("cellwise_weights_examples")

## End(Not run)
</code></pre>


</div>