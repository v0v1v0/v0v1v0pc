<div class="container">

<table style="width: 100%;"><tr>
<td>CBS_ITC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>CBS_ITC</h2>

<h3>Description</h3>

<p>Fit either a 1-piece or 2-piece CBS latent utility function to binary intertemporal choice data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CBS_ITC(choice, Amt1, Delay1, Amt2, Delay2, numpiece, numfit = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>choice</code></td>
<td>
<p>Vector of 0s and 1s. 1 if the choice was option 1, 0 if the choice was option 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Amt1</code></td>
<td>
<p>Vector of positive real numbers. Reward amount of choice 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Delay1</code></td>
<td>
<p>Vector of positive real numbers. Delay until the reward of choice 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Amt2</code></td>
<td>
<p>Vector of positive real numbers. Reward amount of choice 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Delay2</code></td>
<td>
<p>Vector of positive real numbers. Delay until the reward of choice 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numpiece</code></td>
<td>
<p>Either 1 or 2. Number of CBS pieces to use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numfit</code></td>
<td>
<p>Number of model fits to perform from different starting points. If not provided, numfit = 10*numpiece</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The input data has n choices (ideally n &gt; 100) between two reward options.
Option 1 is receiving <code>Amt1</code> in <code>Delay1</code> and Option 2 is receiving <code>Amt2</code> in <code>Delay2</code> (e.g., $40 in 20 days vs. $20 in 3 days).
One of the two options may be immediate (i.e., delay = 0; e.g., $40 in 20 days vs. $20 today).
<code>choice</code> should be 1 if option 1 is chosen, 0 if option 2 is chosen.
</p>


<h3>Value</h3>

<p>A list containing the following:
</p>

<ul>
<li> <p><code>type</code>: either 'CBS1' or 'CBS2' depending on the number of pieces
</p>
</li>
<li> <p><code>LL</code>: log likelihood of the model
</p>
</li>
<li> <p><code>numparam</code>: number of total parameters in the model
</p>
</li>
<li> <p><code>scale</code>: scaling factor of the logit model
</p>
</li>
<li> <p><code>xpos</code>: x coordinates of the fitted CBS function
</p>
</li>
<li> <p><code>ypos</code>: y coordinates of the fitted CBS function
</p>
</li>
<li> <p><code>AUC</code>: area under the curve of the fitted CBS function. Normalized to be between 0 and 1.
</p>
</li>
<li> <p><code>normD</code> : The domain of CBS function runs from 0 to <code>normD</code>. Specifically, this is the constant used to normalize all delays between 0 and 1, since CBS is fitted in a unit square first and then scaled up.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R"># Fit example ITC data with 2-piece CBS function.
# Load example data (included with package).
# Each row is a choice between option 1 (Amt at Delay) vs option 2 (20 now).
Amount1 = ITCdat$Amt1
Delay1 = ITCdat$Delay1
Amount2 = 20
Delay2 = 0
Choice = ITCdat$Choice

# Fit the model
out = CBS_ITC(Choice,Amount1,Delay1,Amount2,Delay2,2)

# Plot the choices (x = Delay, y = relative amount : 20 / delayed amount)
plot(Delay1[Choice==1],20/Amount1[Choice==1],type = 'p',col="blue",xlim=c(0, 180), ylim=c(0, 1))
points(Delay1[Choice==0],20/Amount1[Choice==0],type = 'p',col="red")

# Plot the fitted CBS
x = 0:out$normD
lines(x,CBSfunc(out$xpos,out$ypos,x),col="black")
</code></pre>


</div>