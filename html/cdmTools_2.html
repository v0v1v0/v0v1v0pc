<div class="container">

<table style="width: 100%;"><tr>
<td>estQ</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Empirical Q-matrix estimation</h2>

<h3>Description</h3>

<p>Empirical Q-matrix estimation based on the <em>discrete factor loading</em> method (Wang, Song, &amp; Ding, 2018) as used in Nájera, Abad, and Sorrel (2021).
Apart from the conventional dichotomization criteria, the procedure based on loading differences described in Garcia-Garzon, Abad, and Garrido (2018) is also available.
Furthermore, the bagging bootstrap implementation (Xu &amp; Shang, 2018) can be applied; it is recommended when working with small sample sizes.
The <code>psych</code> package (Revelle, 2020) is used for estimating the required exploratory factor analysis (EFA).
</p>


<h3>Usage</h3>

<pre><code class="language-R">estQ(
  r,
  K,
  n.obs = NULL,
  criterion = "row",
  boot = FALSE,
  efa.args = list(cor = "tet", rotation = "oblimin", fm = "uls"),
  boot.args = list(N = 0.8, R = 100, verbose = TRUE, seed = NULL)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>A correlation matrix or raw data (<code>matrix</code> or <code>data.frame</code>). If a correlation matrix is used, it must have dimensions <em>J</em> items × <em>J</em> items. Please note that tetrachoric or polychoric correlations should be used when working with dichotomous or polytomous items, respectively. If raw data is used, it must have dimensions <em>N</em> individuals × <em>J</em> items. Missing values need to be coded as <code>NA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>Number of attributes to use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.obs</code></td>
<td>
<p>Number of individuals if <code>r</code> is a correlation matrix. If <code>n.obs</code> is provided, <code>r</code> will be treated as a correlation matrix. Use <code>NULL</code> if <code>r</code> is raw data. The default is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>
<p>Dichotomization criterion to transform the factor loading matrix into the Q-matrix. The possible options include <code>"row"</code> (for row means), <code>"col"</code> (for column means), <code>"loaddiff"</code> (for the procedure based on loading differences), or a value between 0 and 1 (for a specific threshold). The default is <code>"row"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot</code></td>
<td>
<p>Apply the bagging bootstrap implementation? Only available if <code>r</code> is raw data. If <code>FALSE</code>, the EFA will be applied once using the whole sample size. If <code>TRUE</code>, several EFAs will be applied with different subsamples; the estimated Q-matrix will be dichotomized from the bootstrapped Q-matrix, but the EFA fit indices, factor loadings, and communalities will be computed from the EFA with the whole sample size. The default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>efa.args</code></td>
<td>
<p>A list of arguments for the EFA estimation:
</p>

<dl>
<dt><code>cor</code></dt>
<dd>
<p>Type of correlations to use. It includes <code>"cor"</code> (for Pearson correlations) and <code>"tet"</code> (for tetrachoric/polychoric correlations), among others. See <code>fa</code> function from the <code>psych</code> R package for additional details. The default is <code>"tet"</code>.</p>
</dd>
<dt><code>rotation</code></dt>
<dd>
<p>Rotation procedure to use. It includes <code>"oblimin"</code>, <code>"varimax"</code>, and <code>"promax"</code>, among others. An oblique rotation procedure is usually recommended. See <code>fa</code> function from the <code>psych</code> R package for additional details. The default is <code>"oblimin"</code>.</p>
</dd>
<dt><code>fm</code></dt>
<dd>
<p>Factoring method to use. It includes <code>"uls"</code> (for unweighted least squares), <code>"ml"</code> (for maximum likelihood), and <code>"wls"</code> (for weighted least squares), among others. See <code>fa</code> function from the <code>psych</code> R package for additional details. The default is <code>"uls"</code>.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot.args</code></td>
<td>
<p>A list of arguments for the bagging bootstrap implementation (ignored if <code>boot = FALSE</code>):
</p>

<dl>
<dt><code>N</code></dt>
<dd>
<p>Sample size (or proportion of the total sample size, if lower than 1) to use in each bootstrap replication. The default is .8.</p>
</dd>
<dt><code>R</code></dt>
<dd>
<p>Number of bootstrap replications. The default is 100.</p>
</dd>
<dt><code>verbose</code></dt>
<dd>
<p>Show progress? The default is <code>TRUE</code>.</p>
</dd>
<dt><code>seed</code></dt>
<dd>
<p>A seed for obtaining consistent results. If <code>NULL</code>, no seed is used. The default is <code>NULL</code>.</p>
</dd>
</dl>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>estQ</code> returns an object of class <code>estQ</code>.
</p>

<dl>
<dt><code>est.Q</code></dt>
<dd>
<p>Estimated Q-matrix (<code>matrix</code>).</p>
</dd>
<dt><code>efa.loads</code></dt>
<dd>
<p>Factor loading matrix (<code>matrix</code>).</p>
</dd>
<dt><code>efa.comm</code></dt>
<dd>
<p>EFA communalities (<code>vector</code>).</p>
</dd>
<dt><code>efa.fit</code></dt>
<dd>
<p>EFA model fit indices (<code>vector</code>).</p>
</dd>
<dt><code>boot.Q</code></dt>
<dd>
<p>Bagging bootstrap Q-matrix before dichotomization. Only if <code>boot = TRUE</code> (<code>matrix</code>).</p>
</dd>
<dt><code>is.Qid</code></dt>
<dd>
<p>Q-matrix identifiability information (<code>list</code>).</p>
</dd>
<dt><code>specifications</code></dt>
<dd>
<p>Function call specifications (<code>list</code>).</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Pablo Nájera, Universidad Pontificia Comillas
</p>


<h3>References</h3>

<p>Garcia-Garzon, E., Abad, F. J., &amp; Garrido, L. E. (2018). Improving bi-factor exploratory modelling: Empirical target rotation based on loading differences. <em>Methodology</em>, <em>15</em>, 45–55. https://doi.org/10.1027/1614-2241/a000163
</p>
<p>Nájera, P., Abad, F. J., &amp; Sorrel, M. A. (2021). Determining the number of attributes in cognitive diagnosis modeling. <em>Frontiers in Psychology</em>, <em>12</em>:614470. https://doi.org/10.3389/fpsyg.2021.614470
</p>
<p>Revelle, W. (2019). <em>psych: Procedures for Psychological, Psychometric, and Personality Research</em>. R package version 1.9.12. https://CRAN.R-project.org/package=psych.
</p>
<p>Wang, W., Song, L., &amp; Ding, S. (2018). An exploratory discrete factor loading method for Q-matrix specification in cognitive diagnosis models. In: M. Wilberg, S. Culpepper, R. Janssen, J. Gonzalez, &amp; D. Molenaar (Eds.), <em>Quantitative Psychology. IMPS 2017. Springer Proceedings in Mathematics &amp; Statistics</em> (Vol. 233, pp. 351–362). Springer.
</p>
<p>Xu, G., &amp; Shang, Z. (2018). Identifying latent structures in restricted latent class models. <em>Journal of the American Statistical Association</em>, <em>113</em>, 1284–1295. https://doi.org/10.1080/01621459.2017.1340889
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(GDINA)
dat &lt;- sim30GDINA$simdat
Q &lt;- sim30GDINA$simQ

#------------------------------
# Using default specifications
#------------------------------
sugQ1 &lt;- estQ(r = dat, K = 5) # Estimate Q-matrix
sugQ1$est.Q &lt;- orderQ(sugQ1$est.Q, Q)$order.Q # Reorder Q-matrix attributes
mean(sugQ1$est.Q == Q) # Check similarity with the generating Q-matrix

#------------------------------------
# Using the bagging bootstrap method
#------------------------------------
# In boot.args argument, R &gt;= 100 is recommended (R = 20 is here used for illustration purposes)
sugQ2 &lt;- estQ(r = dat, K = 5, boot = TRUE, boot.args = list(R = 20, seed = 123)) # Estimate Q-matrix
sugQ2$est.Q &lt;- orderQ(sugQ2$est.Q, Q)$order.Q # Reorder Q-matrix attributes
sugQ2$boot.Q # Proportion of replicas a q-entry was specified in the estimated Q-matrix
mean(sugQ2$est.Q == Q) # Check similarity with the generating Q-matrix
</code></pre>


</div>