<div class="container">

<table style="width: 100%;"><tr>
<td>wasserstein</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate the Wasserstein Distance</h2>

<h3>Description</h3>

<p>The Wasserstein distance is calculated based on the Euclidean distance
between two copula PDFs on a grid, or between a copula PDF and
pseudo-observations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">wasserstein(
  copula,
  copula2 = NULL,
  theta = NULL,
  x = NULL,
  n_grid = 2500,
  p = 2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>copula</code></td>
<td>
<p><span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> object of class '<code>cyl_copula</code>'.
or '<code>Copula</code>' (package '<span class="pkg">copula</span>', only 2-dimensional).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>copula2</code></td>
<td>
<p><span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> object of class '<code>cyl_copula</code>'.
or '<code>Copula</code>' (package '<span class="pkg">copula</span>', only 2-dimensional).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>(alternatively) numeric vector of angles
(measurements of a circular variable) or "circular" component of pseudo-observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>(alternatively) numeric vector of step lengths
(measurements of a linear variable) or "linear" component of pseudo-observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_grid</code></td>
<td>
<p>integer number of grid cells at which the PDF of the copula(s) is calculated
Default is 2500</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>integer power (1 or 2) to which the Euclidean distance
between points is taken in order to compute transportation costs.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Note that when comparing 2 copula PDFs (i.e. <code>theta = NULL</code> and <code>x = NULL</code>),
the calculated Wasserstein distance will depend on the number of grid cells
(<code>n_grid</code>) used to approximate the PDFs. The distance will converge to a certain
value with a higher number of grid cells, but the computational time will also increase.
The default of 2500 seems to be a good (empirically determined) compromise.
The same is true when calculating the Wasserstein distance between a copula
PDF and pseudo-observations. There, it is also important to only compare distances
that use the same number of observations.
</p>
<p>The code is based on the functions <code>transport::wasserstein()</code>
and <code>transport::semidiscrete()</code>.
</p>


<h3>Value</h3>

<p>numeric, the pth Wasserstein distance
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1234)
copula1 &lt;- cyl_quadsec(0.1)
copula2 &lt;- cyl_rect_combine(copula::frankCopula(2))
wasserstein(copula=copula1,copula2 = copula2,p=2,n_grid=20)
wasserstein(copula=copula1,copula2 = copula1,p=2,n_grid=20)
wasserstein(copula=copula1,copula2 = copula::frankCopula(2),p=2,n_grid=20)

 sample &lt;- rjoint(10,
  copula1,
  marginal_1 = list(name = "vonmises", coef  = list(0, 1)),
  marginal_2 = list(name = "weibull", coef = list(3,4))
)

wasserstein(copula=copula1, theta=sample[,1], x=sample[,2], n_grid=20)
</code></pre>


</div>