<div class="container">

<table style="width: 100%;"><tr>
<td>singlescan</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Runs marker regression on each individual genetic marker</h2>

<h3>Description</h3>

<p>This function performs marker regression to associate
individual markers with traits (or eigentraits).
If n_perm is greater than 0, permutations are run to 
determine effect size thresholds for the alpha values
provided. The default alpha values are 0.05 and 0.01.
Covariates are specified in the cape parameter file.
</p>


<h3>Usage</h3>

<pre><code class="language-R">singlescan(
  data_obj,
  geno_obj,
  kin_obj = NULL,
  n_perm = 0,
  alpha = c(0.01, 0.05),
  model_family = "gaussian",
  run_parallel = FALSE,
  n_cores = 4,
  verbose = FALSE,
  overwrite_alert = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data_obj</code></td>
<td>
<p>a <code>Cape</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>geno_obj</code></td>
<td>
<p>a genotype object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kin_obj</code></td>
<td>
<p>a kinship object. If NULL, the kinship correction is not performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_perm</code></td>
<td>
<p>integer number of permutations. Permutation results are only
used in <code>plot_singlescan</code>. They are not used for any other piece
of the Cape analysis and may be safely omitted. The default number of permutations
is 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>significance level if permutations are being run. If permutations are
run effect size thresholds for each alpha level are cacluated using the extreme value
distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model_family</code></td>
<td>
<p>A vector indicating the model family of the phenotypes. This can 
be either "gaussian" or "binomial." If length 1, all phenotypes will be assigned to the 
same family. Phenotypes can be assigned different model families by
providing a vector of the same length as the number of phenotypes,
indicating how each phenotype should be modeled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>run_parallel</code></td>
<td>
<p>Whether to run on parallel CPUs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_cores</code></td>
<td>
<p>The number of CPUs to use if run_parallel is TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Whether to print progress to the screen</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overwrite_alert</code></td>
<td>
<p>Used</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>model_family indicates the model family of the phenotypes
This can be either "gaussian" or "binomial". If this argument
is length 1, all phenotypes will be assigned to the same
family. Phenotypes can be assigned different model families by
providing a vector of the same length as the number of phenotypes,
indicating how each phenotype should be modeled.
</p>


<h3>Value</h3>

<p>Returns a list of the singlescan results. The list is
of length seven, and has the following elements: 
alpha: The alpha values set in the argument alpha
alpha_thresh: The calculated effect size thresholds at each alpha if permutations are run.
ref_allele: The allele used as the reference allele
singlescan_effects: The effect sizes (beta coefficients) from the single-locus linear models
singlescan_t_stats: The t statistics from the single-locus linear models
locus.p_vals: Marker-level p values
locus_score_scores: Marker-level test statistics.
</p>


<h3>See Also</h3>

<p><code>plot_singlescan</code>
</p>


</div>