<div class="container">

<table style="width: 100%;"><tr>
<td>make_pheno_trend_plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Make image showing phenology response to temperatures during two phases</h2>

<h3>Description</h3>

<p>The timing of many developmental stages of temperate plants is understood to
depend on temperatures during two phases. This function seeks to illustrate
this dependency by plotting phenological dates as colored surface, as a
function of mean temperatures during both phases, which are indicated on the
x and y axes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">make_pheno_trend_plot(
  weather_data_frame,
  split_month = 6,
  pheno,
  use_Tmean = FALSE,
  Start_JDay_chill,
  End_JDay_chill,
  Start_JDay_heat,
  End_JDay_heat,
  outpath,
  file_name,
  plot_title,
  ylabel = NA,
  xlabel = NA,
  legend_label = NA,
  image_type = "png",
  colorscheme = "normal",
  fonttype = "serif"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>weather_data_frame</code></td>
<td>
<p>a dataframe containing daily minimum and maximum
temperature data (in columns called Tmin and Tmax, respectively), and/or
mean daily temperature (in a column called Tmean). There also has to be a
column for Year and one for JDay (the Julian date, or day of the year).
Alternatively, the date can also be given in three columns (Year, Month and
Day).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>split_month</code></td>
<td>
<p>the procedure analyzes data by phenological year, which
can start and end in any month during the calendar year (currently only at
the beginning of a month). This variable indicates the last month (e.g. 5
for May) that should be included in the record for a given phenological
year. All subsequent months are assigned to the following phenological year.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pheno</code></td>
<td>
<p>a data frame that contains information on the timing of
phenological events by year. It should consist of two columns called Year
and pheno. Data in the pheno column should be in Julian date (day of the
year).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_Tmean</code></td>
<td>
<p>boolean variable indicating whether or not the column Tmean
from the weather_data_frame should be used as input for the PLS analysis. If
this is set to FALSE, Tmean is calculated as the arithmetic mean of Tmin and
Tmax.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Start_JDay_chill</code></td>
<td>
<p>the Julian date, on which the first relevant period
(e.g. the chilling phase) starts</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>End_JDay_chill</code></td>
<td>
<p>the Julian date, on which the first relevant period
(e.g. the chilling phase) ends</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Start_JDay_heat</code></td>
<td>
<p>the Julian date, on which the second relevant period
(e.g. the forcing phase) starts</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>End_JDay_heat</code></td>
<td>
<p>the Julian date, on which the second relevant period
(e.g. the forcing phase) ends</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outpath</code></td>
<td>
<p>the output path</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file_name</code></td>
<td>
<p>the output file name</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_title</code></td>
<td>
<p>the title of the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylabel</code></td>
<td>
<p>the label for the y-axis. There is a default, but in many
cases, it may be desirable to customize this</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlabel</code></td>
<td>
<p>the label for the x-axis. There is a default, but in many
cases, it may be desirable to customize this</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend_label</code></td>
<td>
<p>the label for the legend (color scheme). There is a
default, but in many cases, it may be desirable to customize this</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>image_type</code></td>
<td>
<p>the type of image to produce. This currently has only two
options: "tiff" or anything else (the default). If this is not "tiff", a png
image is produced. The "tiff" option was added to produce publishable
figures that adhere to the requirements of most scientific journals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colorscheme</code></td>
<td>
<p>the color scheme for the figure. This currently has only
two options: "bw" or anythings else (the default). "bw" produces a grayscale
image, otherwise the figure will be in color</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fonttype</code></td>
<td>
<p>font style to be used for the figure. Can be 'serif'
(default) or 'sans'.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The generation of the color surface is based on the Kriging technique, which
is typically used for interpolation of spatial data. The use for this
particular purpose is a bit experimental. The function uses the Krig
function from the fields package.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pheno</code></td>
<td>
<p>data frame containing all data needed for reproducing
the plot: Year (during which the phenological event occurred - the year in
which the phenological season indicated by split_month ended), pheno (the
date on which the phenological event occurred), Chill_Tmean (mean
temperature during the first relevant phase), Heat_Tmean (mean temperature
during the second relevant phase) and Year_Tmean (mean annual temperature -
not actually used in the plot)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylabel</code></td>
<td>
<p>character string used for
labeling the y axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlabel</code></td>
<td>
<p>character string used for labeling the x
axis</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Eike Luedeling
</p>


<h3>References</h3>

<p>Guo L, Dai J, Wang M, Xu J, Luedeling E, 2015. Responses of
spring phenology in temperate zone trees to climate warming: a case study of
apricot flowering in China. Agricultural and Forest Meteorology 201, 1-7.
</p>
<p>Guo L, Dai J, Ranjitkar S, Xu J, Luedeling E, 2013. Response of chestnut
phenology in China to climate variation and change. Agricultural and Forest
Meteorology 180, 164-172.
</p>
<p>Luedeling E, Guo L, Dai J, Leslie C, Blanke M, 2013. Differential responses
of trees to temperature variation during the chilling and forcing phases.
Agricultural and Forest Meteorology 181, 33-42.
</p>
<p>the interpolation was done according to:
</p>
<p>Furrer, R., Nychka, D. and Sain, S., 2012. Fields: Tools for spatial data. R
package version 6.7.
</p>
<p>Reference to the chillR package:
</p>
<p>Luedeling E, Kunz A and Blanke M, 2013. Identification of chilling and heat
requirements of cherry trees - a statistical approach. International Journal
of Biometeorology 57,679-689.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
weather&lt;-fix_weather(KA_weather)

#the output of the PLS function (PLS_pheno, plotted with plot_PLS) can be used to select
#phases that are likely relevant for plant phase timing. See respective examples for running
#these functions.

file_path&lt;-paste(getwd(),"/",sep="")

#mpt&lt;-make_pheno_trend_plot(weather_data_frame = weather$weather, split_month = 6,
#      pheno = KA_bloom, use_Tmean = FALSE, Start_JDay_chill = 260, 
#      End_JDay_chill = 64, Start_JDay_heat = 44, End_JDay_heat = 103,
#      outpath = file_path, file_name = "pheno_trend_plot",
#      plot_title = "Impacts of chilling and forcing temperatures on cherry phenology",
#      ylabel = NA, xlabel = NA, legend_label = NA, image_type = "png", 
#      colorscheme = "normal")

</code></pre>


</div>