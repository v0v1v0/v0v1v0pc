<div class="container">

<table style="width: 100%;"><tr>
<td>hk_ext</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate values related to Extended Hanson–Koopmans tolerance bounds</h2>

<h3>Description</h3>

<p>Calculates values related to Extended Hanson–Koopmans tolerance bounds
as described by Vangel (1994).
</p>


<h3>Usage</h3>

<pre><code class="language-R">hk_ext_z(n, i, j, p, conf)

hk_ext_z_j_opt(n, p, conf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>the sample size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>i</code></td>
<td>
<p>the first order statistic (1 &lt;= i &lt; j)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>j</code></td>
<td>
<p>the second order statistic (i &lt; j &lt;= n)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>the content of the tolerance bound (normally 0.90 or 0.99)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf</code></td>
<td>
<p>the confidence level (normally 0.95)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Hanson (1964) presents a nonparametric method for determining
tolerance bounds based on consecutive order statistics.
Vangel (1994) extends this method using non-consecutive order statistics.
</p>
<p>The extended Hanson–Koopmans method calculates a tolerance bound
(basis value) based on two order statistics and a weighting value
<code>z</code>. The value of <code>z</code> is based on the sample size, which
order statistics are selected, the desired content of the tolerance
bond and the desired confidence level.
</p>
<p>The function <code>hk_ext_z</code> calculates the weighting variable <code>z</code>
based on selected order statistics <code>i</code> and <code>j</code>. Based on this
value <code>z</code>, the tolerance bound can be calculated as:
</p>
<p style="text-align: center;"><code class="reqn">S = z X_{(i)} + (1 - z) X_{(j)}</code>
</p>

<p>Where <code class="reqn">X_{(i)}</code> and <code class="reqn">X_{(j)}</code> are the <code>i-th</code>
and <code>j-th</code> ordered observation.
</p>
<p>The function <code>hk_ext_z_j_opt</code> determines the value of <code>j</code> and
the corresponding value of <code>z</code>, assuming <code>i=1</code>. The value
of <code>j</code> is selected such that the computed tolerance limit is
nearest to the desired population quantile for a standard normal
distribution when the order statistics are equal to the expected
value of the order statistics for the standard normal distribution.
</p>


<h3>Value</h3>

<p>For <code>hk_ext_z</code>, the return value is a numeric value representing
the parameter z (denoted as k in CMH-17-1G).
</p>
<p>For <code>hk_ext_z_j_opt</code>, the return value is named list containing
<code>z</code> and <code>k</code>. The former is the value of z, as defined by
Vangel (1994), and the latter is the corresponding order statistic.
</p>


<h3>References</h3>

<p>M. Vangel, “One-Sided Nonparametric Tolerance Limits,”
Communications in Statistics - Simulation and Computation,
vol. 23, no. 4. pp. 1137–1154, 1994.
</p>
<p>D. L. Hanson and L. H. Koopmans,
“Tolerance Limits for the Class of Distributions with Increasing
Hazard Rates,” The Annals of Mathematical Statistics,
vol. 35, no. 4. pp. 1561–1570, 1964.
</p>


<h3>See Also</h3>

<p><code>basis_hk_ext()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># The factors from Table 1 of Vangel (1994) can be recreated
# using the hk_ext_z function. For the sample size n=21,
# the median is the 11th ordered observation. The factor
# required for calculating the tolerance bound with a content
# of 0.9 and a confidence level of 0.95 based on the median
# and first ordered observation can be calculated as follows.
hk_ext_z(n = 21, i = 1, j = 11, p = 0.9, conf = 0.95)

## [1] 1.204806

# The hk_ext_z_j_opt function can be used to refine this value
# of z by finding an optimum value of j, rather than simply
# using the median. Here, we find that the optimal observation
# to use is the 10th, not the 11th (which is the median).
hk_ext_z_j_opt(n = 21, p = 0.9, conf = 0.95)

## $z
## [1] 1.217717
##
## $j
## [1] 10

</code></pre>


</div>