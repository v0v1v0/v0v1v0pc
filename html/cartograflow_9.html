<div class="container">

<table style="width: 100%;"><tr>
<td>flowmap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Mapping of an origin-destination flow matrix</h2>

<h3>Description</h3>

<p>Mapping of an origin-destination flow matrix
</p>


<h3>Usage</h3>

<pre><code class="language-R">flowmap(
  tab,
  fij,
  origin.f,
  destination.f,
  bkg = NULL,
  crs,
  nodes = NULL,
  code,
  nodes.X,
  nodes.Y,
  filter,
  plota,
  threshold,
  taille,
  a.head,
  a.length,
  a.angle,
  a.col,
  add = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tab</code></td>
<td>
<p>the input flow dataset in .csv format. See Details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fij</code></td>
<td>
<p>the flow value between origin and destination places</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>origin.f</code></td>
<td>
<p>the place of origin code</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>destination.f</code></td>
<td>
<p>the place of destination code</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bkg</code></td>
<td>
<p>a spatial feature layer, as a map background, in .shp or .json or other format</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crs</code></td>
<td>
<p>the coordinate reference system (CRS)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nodes</code></td>
<td>
<p>the input points file in .csv format</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>code</code></td>
<td>
<p>the spatial features code</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nodes.X</code></td>
<td>
<p>the X coordinate of the point or places</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nodes.Y</code></td>
<td>
<p>the Y coordinate of the point or places</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filter</code></td>
<td>
<p>is to filter or not the flow values. See details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plota</code></td>
<td>
<p>is to add spatial features as map background to the flows's plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>the value of the threshold criterion to filter flows. Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taille</code></td>
<td>
<p>the value of the width of the flow feature</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a.head</code></td>
<td>
<p>for arrow's head is the arrow head parameter code.
It allows to choose the kind of arrow. See Details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a.length</code></td>
<td>
<p>for arrow's length is the length of the edges of the arrow head (in inches)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a.angle</code></td>
<td>
<p>for arrow's angle is the angle from the shaft of the arrow to the edge of the arrow head</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a.col</code></td>
<td>
<p>for arrow's color</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>is to allow to overlay flow features on external spatial features background</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Adds the set of variables of the arrow function</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The input .csv flow dataset must be first converted to a dataframe
for optimal performance (troubles remains with tibble format)<br><br></p>
<p>- filter is "FALSE" means that all the flow value will be plot as segments [(n*(n-1)],
i.e. all the OD matrice's cells out of the main diagonal will be plot.<br>
- filter is "TRUE" means only non-zero values will be plot,
i.e. existing links with or without threshold.<br>
The default threshold is set to 1.<br></p>
<p>Flow features are plot as segments betwwen (x0,y0) and (x1,y1)<br>
- a.head is for applying an arrow or not to a segment:<br>
– code="0" : the link has no head - no arrow<br>
– code="1" : an arrow is draw at (x0[i], y0[i])<br>
– code="2" : an arrow is draw at (x1[j], y1[j])<br>
– code="3" : an arrow is draw at both nodes.<br></p>


<h3>Value</h3>

<p>a matrix or a list with the correct flow dataframe ID code
</p>
<p>The resulting flowmap
</p>


<h3>Examples</h3>

<pre><code class="language-R">rm(list=ls())
library(cartograflow)
library(sf)
data(flowdata)
# example with the background
map &lt;- st_read(system.file("shape/MGP_TER.shp", package = "cartograflow"))
par(bg = "NA")
plot(st_geometry(map), col = "blue")
flowmap(
  tab = flows, fij = "Fij", origin.f = "i", destination.f = "j",
  bkg = map,add=TRUE, code = "EPT_NUM", nodes.X = "X", nodes.Y = "Y",
  filter = FALSE
)
</code></pre>


</div>