<div class="container">

<table style="width: 100%;"><tr>
<td>rc_scmprisk_sp_copula_pen</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Penalized copula regression models with Cox semiparametric margins for semi-competing risk data under right-censoring.</h2>

<h3>Description</h3>

<p>Fits a penalized copula model with Cox semiparametric margins for semi-competing risk data under right-censoring.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rc_scmprisk_sp_copula_pen(
  data,
  var_list1,
  var_list2,
  m1,
  m2,
  initial,
  a,
  b,
  pen1,
  pen2,
  copula
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame; must have <code>id</code> (subject id), <code>ind</code> (1,2 for two margins),
<code>obs_time</code>, <code>status</code> (0 for right-censoring, 1 for event).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var_list1</code></td>
<td>
<p>the list of covariates to be fitted into the copula model for non-terminal event.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var_list2</code></td>
<td>
<p>the list of covariates to be fitted into the copula model for terminal event.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m1</code></td>
<td>
<p>integer, degree of Bernstein polynomials for non-terminal event; default is 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m2</code></td>
<td>
<p>integer, degree of Bernstein polynomials for terminal event; default is 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial</code></td>
<td>
<p>a vector of initial values for all parameters, including phi1 and phi2
(two Bernstein polynomials parameters), beta1 and beta2 (regression coefficients in Cox margins),
<code>eta</code> (copula parameters).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>Tuning parameters in penalty function for non-terminal event.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>Tuning parameters in penalty function for terminal event.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pen1</code></td>
<td>
<p>Types of penalty function for non-terminal event, including <code>"NOPEN"</code>, <code>"RIDGE"</code>,
<code>"BAR"</code>, <code>"LASSO"</code>, <code>"MCP"</code>, <code>"SCAD"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pen2</code></td>
<td>
<p>Types of penalty function for terminal event, including <code>"NOPEN"</code>, <code>"RIDGE"</code>,
<code>"BAR"</code>, <code>"LASSO"</code>, <code>"MCP"</code>, <code>"SCAD"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>copula</code></td>
<td>
<p>Types of copula, including <code>"Clayton"</code>, <code>"Gumbel"</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>parameter estimates and BIC
</p>


<h3>Source</h3>

<p>Tao Sun, Weijie Liang, Gongzi Zhang, Danhui Yi, Ying Ding, Lihai Zhang (2023+). Penalized semiparametric
copula method for semi-competing risks data: Application to hip fracture in elderly. JRSSC.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data("data_sim_scmprisk_vs")
var_list = paste0('x',seq(1,5,1))
phi1_ini = c(0,0,0,0)
phi2_ini = c(0,0,0,0)
beta1_ini = c(0,0,0,0,0)
beta2_ini = c(0,0,0,0,0)
eta_ini = 1
initial = c(phi1_ini,phi2_ini,beta1_ini, beta2_ini, eta_ini)
# obtain initial parameter estimates by ridge penalty
fit0 = rc_scmprisk_sp_copula_pen(data=data_sim_scmprisk_vs,
                                 var_list1 = var_list, var_list2 = var_list,
                                 m1=3, m2=3, initial=initial,
                                 a=0.1, b=0.1, pen1='RIDGE', pen2='RIDGE',
                                 copula='Clayton')
est_ini = c(fit0$Est_phi1,fit0$Est_phi2,fit0$Est_beta1,fit0$Est_beta2,fit0$Est_eta)

fit = rc_scmprisk_sp_copula_pen(data=data_sim_scmprisk_vs,
                                var_list1 = var_list, var_list2 = var_list,
                                m1=3, m2=3, initial=est_ini,
                                a=0.2, b=0.2, pen1='MCP', pen2='MCP',
                                copula='Clayton')
fit$Est_beta1
fit$Est_beta2

## End(Not run)
</code></pre>


</div>