<div class="container">

<table style="width: 100%;"><tr>
<td>confint.cgaim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Confidence intervals</h2>

<h3>Description</h3>

<p>Computes confidence intervals for the CGAIM components.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'cgaim'
confint(object, parm, level = 0.95, type = c("normal",
  "bootstrap"), B = 100, ...)

## S3 method for class 'boot.cgaim'
confint(object, parm, level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A <code>cgaim</code> or <code>boot.cgaim</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parm</code></td>
<td>
<p>The model components for which to get confidence intervals. 
One or several of: <code>"alpha"</code> for index weights,
<code>"beta"</code> for scaling coefficients and <code>"g"</code> for ridge function. By default,
returns confidence intervals for all components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>The level of confidence intervals. Default to 0.95.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>The type of confidence intervals. Either <code>"normal"</code> (the default)
or <code>"bootstrap"</code>. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>The number of samples to be simulated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters to be passed to <code>boot.cgaim</code> for bootstrap confidence intervals.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Two types of confidence intervals are currently implemented in the function.
When <code>type = "normal"</code>, confidence intervals are computed assuming 
components are normally distributed. Beta coefficients are treated as
regular linear regression coefficients and g as regular smooth functions
estimated by (shape-constrained) generalized additive models. For alpha
coefficients, we consider a linear transformation mapping them to a 
Truncated Multivariate Normal distribution (i.e. with only bound constraints). 
Simulation from the TMVN are performed (see <code>tmvnorm</code>) 
and transformed 
back into the original coefficient space (i.e. with linear constraints). The parameter <code>B</code> controls the number of simulations from the TMVN. 
Confidence intervals are computed as the percentiles of these simulated
coefficients, ensuring the confidence region is entirely within the feasible
region defined by the constraints.
</p>
<p>When <code>type = "bootstrap"</code>, confidence intervals are estimated by 
percentile bootstrap. <code>boot.cgaim</code> is called internally
to create <code>B</code> samples of model components, and confidence intervals are then computed
as the percentiles of bootstrap samples. Alternatively, the user can directly
call <code>boot.cgaim</code> and feed the result into 
<code>confint.boot.cgaim</code>.
</p>


<h3>Value</h3>

<p>A list of confidence intervals. Contains one element per model
component in the <code>parm</code> argument.
</p>


<h3>Note</h3>

<p>Confidence intervals for the g functions are evaluated on the 
same <code>n</code> index values as the functions in <code>object</code>.
</p>


<h3>References</h3>

<p>Masselot, P. and others, 2022. Constrained groupwise additive index models.
Biostatistics.
</p>
<p>Pya, N., Wood, S.N., 2015. Shape constrained additive models. 
Stat. Comput. 25, 543–559. 
</p>
<p>Wood, S.N., 2017. Generalized Additive Models: An Introduction with R, 
2nd ed, Texts in Statistical Science. Chapman and Hall/CRC.
</p>
<p>DiCiccio, T.J., Efron, B., 1996. Bootstrap Confidence Intervals. 
Statistical Science 11, 189–212.
</p>
<p>Carpenter, J., Bithell, J., 2000. Bootstrap confidence intervals: 
when, which, what? A practical guide for medical statisticians. 
Statistics in Medicine 19, 1141–1164.
</p>


<h3>See Also</h3>

<p><code>boot.cgaim</code> for bootstrapping.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># A simple CGAIM
n &lt;- 200
x1 &lt;- rnorm(n)
x2 &lt;- x1 + rnorm(n)
z &lt;- x1 + x2
y &lt;- z + rnorm(n)
df1 &lt;- data.frame(y, x1, x2) 
ans &lt;- cgaim(y ~ g(x1, x2, acons = list(monotone = 1)), data = df1)

# Normal confidence intervals
set.seed(1)
ci1 &lt;- confint(ans, B = 1000)
ci1$alpha
ci1$beta

# Select only alphas: identical to above result
set.seed(1)
confint(ans, B = 1000, parm = "alpha")

# Select only betas: identical to above result
set.seed(1)
confint(ans, B = 1000, parm = "beta")

# Confidence intervals by bootstrap (more computationally intensive, B should be increased)
set.seed(2)
ci2 &lt;- confint(ans, type = "boot", B = 10)

# Alternatively, bootstrap samples can be performed beforehand
set.seed(2) 
boot1 &lt;- boot.cgaim(ans, B = 10)
ci3 &lt;- confint(boot1)

</code></pre>


</div>