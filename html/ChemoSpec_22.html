<div class="container">

<table style="width: 100%;"><tr>
<td>hmapSpectra</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Seriated Heat Map for a Spectra Object</h2>

<h3>Description</h3>

<p>Creates a heat map with marginal dendrograms using seriation procedures.
Heirchical cluster analysis is followed by re-ordering the clusters in a coordinated way
across each dimension (controlled by argument <code>method</code>, see <code>hmap</code>).
The vignette for package <span class="pkg">seriation</span> has more details.
</p>


<h3>Usage</h3>

<pre><code class="language-R">hmapSpectra(spectra, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>spectra</code></td>
<td>
<p>An object of S3 class <code>Spectra()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to be passed downstream.  A great deal of
control is available - check <code>hmap</code> for details.  Most of the control
actually derives from the <code>heatmap</code> function in package <span class="pkg">stats</span>.
See the examples.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list as described in <code>hmap</code>. Side effect is a plot.
</p>


<h3>Note</h3>

<p>The underlying <code>stats::heatmap</code> function does certain things automatically for the user.
For instance, if you pass a vector of names to argument <code>row_labels</code> it is automatically
reordered using the <code>rowInd</code> vector that is computed.  The user does not need to
do the reordering.  Another example is the labeling of the columns.  The labels are
automatically turned 90 degrees, and not every column is labeled to keep things readible.
</p>


<h3>Interpretation</h3>

<p>Looking at the 2nd <code>hmapSpectra</code> example, and keeping in mind the nature of the sample
(see <code>SrE.IR</code>), the most similar samples based on the ester peaks (~1740),  are in
the lower right corner of the heatmap.  These are the two outlier samples, composed of triglycerides
which contain the ester functional group (and no detectable carboxylic acid).  The most similar
samples based on the carboxylic acid peaks (~1710) are in the upper left corner.  These samples are
mostly from the "pure" extract group, according to the manufacturer's label.  These samples have a modest
to low amount of the ester functional group, which indicates dilution (or adulteration if you like).
In fact, the first two samples (NP_adSrE and NR_pSrE) are the two samples with the smallest ester
peaks (see first plot in the examples).  This suggests that NP_adSrE was diluted only a little with added
olive oil.
</p>


<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University).
</p>


<h3>See Also</h3>

<p><code>hmap</code> which will get you to the package
(there is no package index page); the vignette is a good place to begin
(<code>browseVignettes("seriation")</code>).  Additional documentation at
<a href="https://bryanhanson.github.io/ChemoSpec/">https://bryanhanson.github.io/ChemoSpec/</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># You need to install package "seriation" for this example
if (requireNamespace("seriation", quietly = TRUE)) {
  data(SrE.IR)

  # Let's look just at the carbonyl region
  IR &lt;- removeFreq(SrE.IR, rem.freq = SrE.IR$freq &gt; 1775 | SrE.IR$freq &lt; 1660)
  p &lt;- plotSpectra(IR, which = 1:16, lab.pos = 1800)

  # Defaults, except for color scheme:
  res &lt;- hmapSpectra(IR, col = heat.colors(5))

  # Label samples and frequencies by passing arguments to stats:heatmap
  # Also make a few other nice plot adjustments
  res &lt;- hmapSpectra(IR,
    col = heat.colors(5),
    row_labels = IR$names, col_labels = as.character(round(IR$freq)),
    margins = c(4, 6)
    )
}

</code></pre>


</div>