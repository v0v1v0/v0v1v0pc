<div class="container">

<table style="width: 100%;"><tr>
<td>bart_est</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The BART estimator</h2>

<h3>Description</h3>

<p>This function estimates the ADRF using Bayesian additive regression trees (BART).
</p>


<h3>Usage</h3>

<pre><code class="language-R">bart_est(Y,
         treat,
         outcome_formula,
         data,
         grid_val,
         ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>is the the name of the outcome variable contained in <code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>treat</code></td>
<td>
<p>is the name of the treatment variable contained in
<code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outcome_formula</code></td>
<td>
<p>is the formula used for fitting the outcome surface.
gps is one of the independent variables to use in the outcome_formula. ie.
<code>Y ~ treat + X.1 + X.2 + ...</code> or a variation of this.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>is a dataframe containing <code>Y</code>, <code>treat</code>, and
<code>X</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid_val</code></td>
<td>
<p>contains the treatment values to be evaluated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to be passed to the bart() outcome function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>BART is a prediction model that is applicable to many settings, one of which
is causal inference problems.  It is a sum of trees fit, but the influence
of each tree is held back by a regularization prior so that each tree only
contributes a small amount to the overall fit.  Priors are put on the
parameters to avoid overfitting the data and so that no single tree has
a significant influence on the model fit.
For more details see Chipman (2010).
</p>
<p>BART does not require fitting a treatment model.  Instead, it fits a
response surface to the whole dataset and if the response surface is
correctly specified, then the causal effect estimate is unbiased.
Although most of the focus on BART is for the binary treatment setting,
Hill (2011) also mentions an extension to the continuous or
multidose treatment setting.  When using BART in this continuous treatment
setting, Hill (2011) compares the outcomes of units with
treatment level <code class="reqn">T_i = t</code> to their outcomes had <code class="reqn">T_i = 0</code>.
This method infers the treatment effect of units had they not received
treatment compared to their actual observed treatment.  The comparison
is between <code class="reqn">Y_i(0)| (I = 1, T_i = t)</code> and <code class="reqn">Y_i(t)| (I = 1, T_i = t)</code>
where <code class="reqn">I = 1</code> means that the unit is part of the treatment group.
The causal effect is comparing the predicted outcome of units that
received treatment with what their predicted outcome would have been
had they received zero treatment.
</p>
<p>This method performs well in simulation studies.
One drawback from BART is the amount of computing time needed.
</p>


<h3>Value</h3>

<p><code>bart_est</code> returns an object of class "causaldrf_simple",
a list that contains the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>parameter estimates for a bart fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out_mod</code></td>
<td>
<p>the result of the bart fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched call.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Schafer, J.L., Galagate, D.L. (2015).  Causal inference with a
continuous treatment and outcome: alternative estimators for parametric
dose-response models. <em>Manuscript in preparation</em>.
</p>
<p>Hill, Jennifer L. (2011). Bayesian nonparametric modeling for causal
inference. <em>Journal of Computational and Graphical Statistics</em>
<b>20.1</b> (2011).
</p>
<p>Chipman, Hugh A and George, Edward I and McCulloch, Robert E and others (2010).
BART: Bayesian additive regression trees.
<em>The Annals of Applied Statistics</em>
<b>4.1</b>, 266â€“298.
</p>


<h3>See Also</h3>

<p><code>nw_est</code>, <code>iw_est</code>, <code>hi_est</code>, <code>gam_est</code>,
<code>add_spl_est</code>, etc. for other estimates.
</p>
<p><code>t_mod</code>, <code>overlap_fun</code> to prepare the <code>data</code>
for use in the different estimates.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Example from Schafer (2015).  bart takes a few minutes to run (depending on computer).

example_data &lt;- sim_data


# This estimate takes a long time to run...
bart_list &lt;- bart_est(Y = Y,
          treat = T,
          outcome_formula = Y ~ T + B.1 + B.2 + B.3 + B.4 + B.5 + B.6 + B.7 + B.8,
          data = example_data,
          grid_val = seq(8, 16, by = 1))

sample_index &lt;- sample(1:1000, 100)

plot(example_data$T[sample_index],
    example_data$Y[sample_index],
    xlab = "T",
    ylab = "Y",
    main = "bart estimate")

lines(seq(8, 16, by = 1),
      bart_list$param,
      lty = 2,
      lwd = 2,
      col = "blue")

legend('bottomright',
        "bart estimate",
        lty=2,
        lwd = 2,
        col = "blue",
        bty='Y',
        cex=1)


rm(example_data, bart_list, sample_index)
</code></pre>


</div>