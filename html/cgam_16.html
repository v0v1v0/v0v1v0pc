<div class="container">

<table style="width: 100%;"><tr>
<td>Ord</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Specify an Ordered Categorical Family in a CGAM Formula</h2>

<h3>Description</h3>

<p>This is a subroutine to specify an ordered catergorical family in a cgam formula. It set things up to a routine called cgam.polr. This is learned from the polr routine in the MASS package, which fits a logistic or probit regression model to an ordered categorical response. Currently only the logistic regression model is allowed. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">Ord(link = "identity")</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>link</code></td>
<td>
<p>The link function. Users don't need specify this term.</p>
</td>
</tr></table>
<h3>Details</h3>

<p>See the polr section in the official manual of the MASS package (<a href="https://cran.r-project.org/package=MASS">https://cran.r-project.org/package=MASS</a>) for details. 
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>muhat</code></td>
<td>
<p>The estimated expected value of a latent variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zeta</code></td>
<td>
<p>Estimated cut-points defining the intervals of a latent 
variable such that the latent variable is between two adjacent cut-points is equivalent to that the ordered categorical response is in a category.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Xiyue Liao
</p>


<h3>References</h3>

<p>Agresti, A. (2002) <em>Categorical Data</em>. Second edition. Wiley.
</p>


<h3>See Also</h3>

<p><code>mental</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
	# Example 1. 
	# generate the predictor and the latenet variable
	n &lt;- 500
	set.seed(123)
	x &lt;- runif(n, 0, 1)
	yst &lt;- 5*x^2 + rlogis(n)
	
	# generate observed ordered response, which has levels 1, 2, 3. 
	cts &lt;- quantile(yst, probs = seq(0, 1, length = 4)) 
	yord &lt;- cut(yst, breaks = cts, include.lowest = TRUE, labels = c(1:3), Ord = TRUE)
	y &lt;- as.numeric(levels(yord))[yord] 

	# regress y on x under the shape-restriction: the latent variable is "increasing-convex"
	# w.r.t x
	ans &lt;- cgam(y ~ s.incr.conv(x), family = Ord)
	
	# check the estimated cut-points
	ans$zeta
	
	# check the estimated expected value of the latent variable
	head(ans$muhat)
	
	# check the estimated probabilities P(y = k), k = 1, 2, 3
	head(fitted(ans))
	
	# check the estimated latent variable
	plot(x, yst, cex = 1, type = "n", ylab = "latent variable")
	cols &lt;- topo.colors(3)
	for (i in 1:3) {
		points(x[y == i], yst[y == i], col = cols[i], pch = i, cex = 0.7)
	}
	for (i in 1:2) {
		abline(h = (ans$zeta)[i], lty = 4, lwd = 1)
	}
	lines(sort(x), (5*x^2)[order(x)], lwd = 2)
	lines(sort(x), (ans$muhat)[order(x)], col = 2, lty = 2, lwd = 2)
	legend("topleft", bty = "n", col = c(1, 2), lty = c(1, 2), 
	c("true latent variable", "increasing-convex fit"), lwd = c(1, 1))

## End(Not run)	
## Not run: 
	# Example 2. mental impairment data set 
	# mental impairment is an ordinal response with 4 categories recorded as 1, 2, 3, and 4
	# two covariates are life event index and socio-economic status (high = 1, low = 0)
	data(mental)
	table(mental$mental)
	
	# model the relationship between the latent variable and life event index as increasing
	# socio-economic status is included as a binary covariate 
	fit.incr &lt;- cgam(mental ~ incr(life) + ses, data = mental, family = Ord)

	# check the estimated probabilities P(mental = k), k = 1, 2, 3, 4
	probs.incr &lt;- fitted(fit.incr)
	head(probs.incr)

## End(Not run)

</code></pre>


</div>