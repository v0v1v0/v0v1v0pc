<div class="container">

<table style="width: 100%;"><tr>
<td>giniCOP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The Gini Gamma of a Copula</h2>

<h3>Description</h3>

<p>Compute the measure of association known as the <em>Gini Gamma</em> <code class="reqn">\gamma_\mathbf{C}</code> (Nelsen, 2006, pp. 180–182), which is defined as
</p>
<p style="text-align: center;"><code class="reqn">\gamma_\mathbf{C} = \mathcal{Q}(\mathbf{C},\mathbf{M}) + \mathcal{Q}(\mathbf{C},\mathbf{W})\mbox{,}</code>
</p>

<p>where <code class="reqn">\mathbf{C}(u,v)</code> is the copula, <code class="reqn">\mathbf{M}(u,v)</code> is the <code>M</code> function, and <code class="reqn">\mathbf{W}(u,v)</code> is the <code>W</code> function. The function <code class="reqn">\mathcal{Q}(a,b)</code> (concordCOP) is a <em>concordance function</em> (Nelsen, 2006, p. 158). Nelsen also reports that “Gini Gamma measures a concordance relation of “distance” between <code class="reqn">\mathbf{C}(u,v)</code> and monotone dependence, as represented by the <em>Fréchet–Hoeffding lower bound</em> and <em>Fréchet–Hoeffding upper bound</em> copulas [<code class="reqn">\mathbf{M}(u,v)</code>, <code>M</code> and <code class="reqn">\mathbf{W}(u,v)</code>, <code>W</code> respectively]”
</p>
<p>A simpler method of computation and the default for <code>giniCOP</code> is to compute <code class="reqn">\gamma_\mathbf{C}</code> by
</p>
<p style="text-align: center;"><code class="reqn">\gamma_\mathbf{C}  = 4\biggl[\int_\mathcal{I} \mathbf{C}(u,u)\,\mathrm{d}u +
                             \int_\mathcal{I} \mathbf{C}(u,1-u)\,\mathrm{d}u\biggr] -
                           2\mbox{,}</code>
</p>

<p>or in terms of the <em>primary diagonal</em> (alt. <em>main diagonal</em>, Genest <em>et al.</em>, 2010) <code class="reqn">\delta(t)</code> and <em>secondary diagonal</em> <code class="reqn">\delta^\star(t)</code> (see <code>diagCOP</code>) by
</p>
<p style="text-align: center;"><code class="reqn">\gamma_\mathbf{C}  = 4\biggl[\int_\mathcal{I} \mathbf{\delta}(t)\,\mathrm{d}t +
                             \int_\mathcal{I} \mathbf{\delta^\star
                             }(t)\,\mathrm{d}t\biggr] -
                           2\mbox{.}</code>
</p>

<p>The simpler method is more readily implemented because single integration is fast. Lastly, Nelsen <em>et al.</em> (2001, p. 281) show that <code class="reqn">\gamma_\mathbf{C}</code> also is computable by
</p>
<p style="text-align: center;"><code class="reqn">\gamma_\mathbf{C} = 2\,\mathcal{Q}(\mathbf{C},\mathbf{A})\mbox{,}</code>
</p>

<p>where <code class="reqn">\mathbf{A}</code> is a <em>convex combination</em> (<code>convex2COP</code>, using <code class="reqn">\alpha = 1/2</code>) of the copulas <code class="reqn">\mathbf{M}</code> and <code class="reqn">\mathbf{W}</code> or <code class="reqn">\mathbf{A} = (\mathbf{M}+\mathbf{W})/2</code>. However, integral convergence errors seem to trigger occasionally, and the first definition by summation <code class="reqn">\mathcal{Q}(\mathbf{C},\mathbf{M}) + \mathcal{Q}(\mathbf{C},\mathbf{W})</code> thus is used. The convex combination is demonstrated in the <b>Examples</b> section.
</p>


<h3>Usage</h3>

<pre><code class="language-R">giniCOP(cop=NULL, para=NULL, by.concordance=FALSE, as.sample=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cop</code></td>
<td>
<p>A copula function;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>para</code></td>
<td>
<p>Vector of parameters or other data structure, if needed, to pass to the copula;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by.concordance</code></td>
<td>
<p>Instead of using the single integrals (Nelsen, 2006, pp. 181–182) to compute <code class="reqn">\gamma_\mathbf{C}</code>, use the concordance function method implemented through <code>concordCOP</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>as.sample</code></td>
<td>
<p>A logical controlling whether an optional <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> <code>data.frame</code> in <code>para</code> is used to compute the <code class="reqn">\hat\gamma_\mathbf{C}</code> (see <b>Note</b>); and</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to pass, which are dispatched to the copula function <code>cop</code> and possibly <code>concordCOP</code> if <code>by.concordance=TRUE</code>, such as <code>delta</code> used by that function.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The value for <code class="reqn">\gamma_\mathbf{C}</code> is returned.
</p>


<h3>Note</h3>

<p>Conceptually, the sample Gini Gamma (<code class="reqn">\hat\gamma</code>; Genest <em>et al.</em>, 2010) is
</p>
<p style="text-align: center;"><code class="reqn">\hat\gamma = \frac{1}{\lfloor n^2/2 \rfloor}\sum_{i=1}^n \mid (n+1-R_i) - S_i \mid- \mid R_i - S_i\mid\mbox{,}</code>
</p>

<p>where <code class="reqn">{\lfloor m \rfloor}</code> denotes the integer part of arbitrary <code class="reqn">m &gt; 0</code>, <code class="reqn">R_i</code> and <code class="reqn">S_i</code> are the respective ranks of <code class="reqn">X</code> and <code class="reqn">Y</code> and <code class="reqn">n</code> is sample size. The sampling variance of <code class="reqn">\hat\gamma</code> under <em>assumption of independence</em> between <code class="reqn">X</code> and <code class="reqn">Y</code> is
</p>
<p style="text-align: center;"><code class="reqn">\mathrm{var}(\hat\gamma)_{n\ \mathrm{even}} = \frac{2}{3}\frac{(n^2 + 2)}{(n-1)n^2}\mbox{\ and}</code>
</p>

<p style="text-align: center;"><code class="reqn">\mathrm{var}(\hat\gamma)_{n\ \mathrm{odd}} = \frac{2}{3}\frac{(n^2 + 3)}{(n-1)(n^2-1)}\mbox{.}</code>
</p>

<p>Genest <em>et al.</em> (2010) present additional equations for estimation of the distribution <code class="reqn">\hat\gamma</code> variance for conditions of dependence based on copulas. For a copula having continuous partial derivatives, then as <code class="reqn">n \rightarrow \infty</code>, the quantity <code class="reqn">(\hat\gamma - \gamma_\mathbf{C})\sqrt{n} \sim \mathrm{Normal}(0, \mathrm{var}(\gamma_\mathbf{C}))</code>. Genest <em>et al.</em> (2010) show variance of <code class="reqn">\hat\gamma</code> for the <em>independence copula</em> (<code class="reqn">\mathbf{C}(u,v) = \mathbf{\Pi}(u,v)</code>) (<code>P</code>) as <code class="reqn">\mathrm{var}(\gamma_\mathbf{C}) = 2/3</code>. For comparison, the <em>Spearman Footrule</em> for independence is smaller at <code class="reqn">\mathrm{var}(\psi_\mathbf{C}) = 2/5</code> (see <code>footCOP</code> <b>Note</b>). In Genest <em>et al.</em> independence and two examples of dependence (p. 941), <code class="reqn">\mathrm{var}(\hat\gamma) &gt; \mathrm{var}(\hat\psi)</code>, but those authors do not appear to remark on whether this inequality holds for all copula.
</p>


<h3>Author(s)</h3>

<p>W.H. Asquith</p>


<h3>References</h3>

<p>Genest, C., Nešlehová, J., and Ghorbal, N.B., 2010, Spearman's footrule and Gini's gamma—A review with complements: Journal of Nonparametric Statistics, v. 22, no. 8, pp. 937–954, <a href="https://doi.org/10.1080/10485250903499667">doi:10.1080/10485250903499667</a>.
</p>
<p>Nelsen, R.B., 2006, An introduction to copulas: New York, Springer, 269 p.
</p>
<p>Nelsen, R.B., Quesada-Molina, J.J., Rodríguez-Lallena, J.A., Úbeda-Flores, M., 2001, Distribution functions of copulas—A class of bivariate probability integral transforms: Statistics and Probability Letters, v. 54, no. 3, pp. 277–282, <a href="https://doi.org/10.1016/S0167-7152%2801%2900060-8">doi:10.1016/S0167-7152(01)00060-8</a>.
</p>


<h3>See Also</h3>

<p><code>blomCOP</code>, <code>footCOP</code>, <code>hoefCOP</code>,
<code>rhoCOP</code>, <code>tauCOP</code>, <code>wolfCOP</code>,
<code>joeskewCOP</code>, <code>uvlmoms</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">giniCOP(cop=PSP)                                 #                 = 0.3819757
## Not run: 
giniCOP( cop=PSP, by.concordance=TRUE)           # Q(C,M) + Q(C,W) = 0.3820045
# use convex combination ---triggers integration warning but returns anyway
cxpara &lt;- list(alpha=1/2, cop1=M, cop2=W) # parameters for convex2COP()
2*tauCOP(cop=PSP, cop2=convex2COP, para2=cxpara) #    2*Q(C,A)     = 0.3819807
# where the later issued warnings on the integration
## End(Not run)

## Not run: 
n &lt;- 2000; UV &lt;- simCOP(n=n, cop=N4212cop, para=9.3, graphics=FALSE)
giniCOP(para=UV, as.sample=TRUE)                     # 0.9475900 (sample version)
giniCOP(cop=N4212cop, para=9.3)                      # 0.9479528 (copula integration)
giniCOP(cop=N4212cop, para=9.3, by.concordance=TRUE) # 0.9480267 (concordance function)
# where the later issued warnings on the integration
## End(Not run)

## Not run: 
# The canoncial example of theoretical and sample estimators of bivariate
# association for the package: Blomqvist Beta, Spearman Footrule, Gini Gamma,
# Hoeffding Phi, Kendall Tau, Spearman Rho, and Schweizer-Wolff Sigma
# and comparison to L-correlation via lmomco::lcomoms2().
n &lt;- 9000; set.seed(56)
para &lt;- list(cop1=PLACKETTcop, cop2=PLACKETTcop, para1=1.45, para2=21.9,
             alpha=0.41, beta=0.08)
D &lt;- simCOP(n=n, cop=composite2COP, para=para, cex=0.5, col=rgb(0,0,0,0.2), pch=16)
blomCOP(cop=composite2COP, para=para)         # 0.4037908 (theoretical)
blomCOP(para=D, as.sample=TRUE)               # 0.4008889 (sample)
footCOP(cop=composite2COP, para=para)         # 0.3721555 (theoretical)
footCOP(para=D, as.sample=TRUE)               # 0.3703623 (sample)
giniCOP(cop=composite2COP, para=para)         # 0.4334687 (theoretical)
giniCOP(para=D, as.sample=TRUE)               # 0.4311698 (sample)
tauCOP(cop=composite2COP,  para=para)         # 0.3806909 (theoretical)
tauCOP(para=D,  as.sample=TRUE)               # 0.3788139 (sample)
rhoCOP(cop=composite2COP,  para=para)         # 0.5257662 (theoretical)
rhoCOP(para=D,  as.sample=TRUE)               # 0.5242380 (sample)
lmomco::lcomoms2(D)$T2      # 1               # 0.5242388 (sample matrix)
                            # 0.5245154 1
hoefCOP(cop=composite2COP, para=para)         # 0.5082776 (theoretical)
subsample &lt;- D[sample(1:n, n/5),] # subsampling for speed
hoefCOP(para=subsample, as.sample=TRUE)       # 0.5033842 (re-sample)
#hoefCOP(para=D, as.sample=TRUE) # major CPU hog, n too big
# because the Ds are already "probabilities" just resample as shown above
wolfCOP(cop=composite2COP, para=para)         # 0.5257662 (theoretical)
#wolfCOP(para=D, as.sample=TRUE) # major CPU hog, n too big
wolfCOP(para=subsample, as.sample=TRUE)       # 0.5338009 (re-sample)
## End(Not run)


## Not run: 
set.seed(1); nsim &lt;- 1000
varGIunderIndpendence &lt;- function(n) {
  if(3 %/% 2 == 3 / 2) { # even
    (2/3)*( (n^2 + 2) ) / ( (n-1)* n^2    ) # Genest et al. (2010)
  } else {
    (2/3)*( (n^2 + 3) ) / ( (n-1)*(n^2-1) ) # Genest et al. (2010)
  }
}
ns &lt;- c(10, 15, 20, 25, 50, 75, 100)
plot(min(ns):max(ns), varGIunderIndpendence(10:max(ns)), type="l",
     xlab="Sample size", ylab="Variance of Sample Estimator", col="darkgreen")
mtext("Sample Gini Gamma Under Independence", col="darkgreen")
for(n in ns) {
  sGI &lt;- vector(length=nsim)
  for(i in seq_len(nsim)) {
    uv &lt;- simCOP(n=n, cop=P, para=2, graphics=FALSE)
    sGI[i] &lt;- giniCOP(para=uv, as.sample=TRUE)
  }
  varGI &lt;- varGIunderIndpendence(n)
  zz &lt;- round(c(n, mean(sGI), var(sGI), varGI), digits=6)
  names(zz) &lt;- c("n", "mean_sim", "var_sim", "var_Genest")
  print(zz)
  points(n, zz[3], cex=2, pch=21, col="darkgreen", bg="lightgreen")
} # results show proper implementation and Genest et al. (2010, sec. 3) 
## End(Not run)
</code></pre>


</div>