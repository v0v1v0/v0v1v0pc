<div class="container">

<table style="width: 100%;"><tr>
<td>mcmc_mix3</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Markov chain Monte Carlo for 3-component discrete extreme value mixture distribution</h2>

<h3>Description</h3>

<p><code>mcmc_mix3</code> returns the posterior samples of the parameters, for fitting the 3-component discrete extreme value mixture distribution. The samples are obtained using Markov chain Monte Carlo (MCMC).
</p>


<h3>Usage</h3>

<pre><code class="language-R">mcmc_mix3(
  x,
  count,
  v_set,
  u_set,
  v,
  u,
  alpha1,
  theta1,
  alpha2,
  theta2,
  shape,
  sigma,
  a_psi1,
  a_psi2,
  a_psiu,
  b_psiu,
  a_alpha1,
  b_alpha1,
  a_theta1,
  b_theta1,
  a_alpha2,
  b_alpha2,
  a_theta2,
  b_theta2,
  m_shape,
  s_shape,
  a_sigma,
  b_sigma,
  powerlaw1,
  positive1,
  positive2,
  a_pseudo,
  b_pseudo,
  pr_power2,
  iter,
  thin,
  burn,
  freq,
  invt,
  mc3_or_marg = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Vector of the unique values (positive integers) of the data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>count</code></td>
<td>
<p>Vector of the same length as x that contains the counts of each unique value in the full data, which is essentially rep(x, count)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v_set</code></td>
<td>
<p>Positive integer vector of the values v will be sampled from</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u_set</code></td>
<td>
<p>Positive integer vector of the values u will be sampled from</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>Positive integer, initial value of the lower threshold</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>Positive integer, initial value of the upper threshold</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha1</code></td>
<td>
<p>Real number greater than 1, initial value of the parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta1</code></td>
<td>
<p>Real number in (0, 1], initial value of the parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha2</code></td>
<td>
<p>Real number greater than 1, initial value of the parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta2</code></td>
<td>
<p>Real number in (0, 1], initial value of the parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape</code></td>
<td>
<p>Real number, initial value of the parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>Positive real number, initial value of the parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a_psi1, a_psi2, a_psiu, b_psiu, a_alpha1, b_alpha1, a_theta1, b_theta1, a_alpha2, b_alpha2, a_theta2, b_theta2, m_shape, s_shape, a_sigma, b_sigma</code></td>
<td>
<p>Scalars, real numbers representing the hyperparameters of the prior distributions for the respective parameters. See details for the specification of the priors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>powerlaw1</code></td>
<td>
<p>Boolean, is the discrete power law assumed for below v?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>positive1</code></td>
<td>
<p>Boolean, is alpha1 positive (TRUE) or unbounded (FALSE)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>positive2</code></td>
<td>
<p>Boolean, is alpha2 positive (TRUE) or unbounded (FALSE)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a_pseudo</code></td>
<td>
<p>Positive real number, first parameter of the pseudoprior beta distribution for theta2 in model selection; ignored if pr_power2 = 1.0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b_pseudo</code></td>
<td>
<p>Positive real number, second parameter of the pseudoprior beta distribution for theta2 in model selection; ignored if pr_power2 = 1.0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pr_power2</code></td>
<td>
<p>Real number in [0, 1], prior probability of the discrete power law (between v and u)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>Positive integer representing the length of the MCMC output</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>
<p>Positive integer representing the thinning in the MCMC</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn</code></td>
<td>
<p>Non-negative integer representing the burn-in of the MCMC</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freq</code></td>
<td>
<p>Positive integer representing the frequency of the sampled values being printed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>invt</code></td>
<td>
<p>Vector of the inverse temperatures for Metropolis-coupled MCMC</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mc3_or_marg</code></td>
<td>
<p>Boolean, is invt for parallel tempering / Metropolis-coupled MCMC (TRUE, default) or marginal likelihood via power posterior (FALSE)?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In the MCMC, a componentwise Metropolis-Hastings algorithm is used. The thresholds v and u are treated as parameters and therefore sampled. The hyperparameters are used in the following priors: psi1 / (1.0 - psiu) ~ Beta(a_psi1, a_psi2); u is such that the implied unique exceedance probability psiu ~ Uniform(a_psi, b_psi); alpha1 ~ Normal(mean = a_alpha1, sd = b_alpha1); theta1 ~ Beta(a_theta1, b_theta1); alpha2 ~ Normal(mean = a_alpha2, sd = b_alpha2); theta2 ~ Beta(a_theta2, b_theta2); shape ~ Normal(mean = m_shape, sd = s_shape); sigma ~ Gamma(a_sigma, scale = b_sigma). If pr_power2 = 1.0, the discrete power law (between v and u) is assumed, and the samples of theta2 will be all 1.0. If pr_power2 is in (0.0, 1.0), model selection between the polylog distribution and the discrete power law will be performed within the MCMC.
</p>


<h3>Value</h3>

<p>A list: $pars is a data frame of iter rows of the MCMC samples, $fitted is a data frame of length(x) rows with the fitted values, amongst other quantities related to the MCMC
</p>


<h3>See Also</h3>

<p><code>mcmc_pol</code> and <code>mcmc_mix2</code> for MCMC for the Zipf-polylog and 2-component discrete extreme value mixture distributions, respectively.
</p>


</div>