<div class="container">

<table style="width: 100%;"><tr>
<td>comparisons</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Create a table of comparisons amongst groups
</h2>

<h3>Description</h3>

<p>Create a table of comparisons based on group estimates and
variance-covariance matrix. Pairwise or custom specified contrasts are estimated and
tested.  
</p>


<h3>Usage</h3>

<pre><code class="language-R">comparisons(estimates, varcovmatrix, errordf = Inf, endptscale,
            mcadjust = FALSE, alpha = 0.05, type = "pairwisereflect",
            contrastmatrix = NULL, n, offset = NULL, cnames = "derive",
            analysisname = "", endptname = "", digits = NULL, addpct = FALSE,
            display = "print") 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>estimates </code></td>
<td>

<p>A named vector of estimates. Each estimate element is a measure of
the center of the group. The name of each group must
be present in the names attribute of the vector.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varcovmatrix </code></td>
<td>

<p>The estimated variance-covariance matrix associated with the
<code>estimates</code>. Must have the same number of columns and rows as the length
of the <code>estimates</code> vector.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>errordf </code></td>
<td>
<p>Can be one of three types of values:
</p>

<dl>
<dt><code>Inf</code></dt>
<dd>
<p>The default, and will just use standard Gaussian
(normal) distribution quantile for the critical points in each
comparison;
</p>
</dd>
<dt><code>numeric</code></dt>
<dd>
<p>A finite positive number that will be used for
the degrees of freedom for the t-distribution quantile;
</p>
</dd>
<dt><code>"approx"</code></dt>
<dd>
<p>Will try to apply a Satterthwaite
approximation based on the <code>variance-covariance</code> matrix and
<code>n</code> to
estimate the degrees of freedom for each comparison. The
variance-covariance matrix will need to be diagonal. Only will be
accepted when <code>mcadjust=FALSE</code>.
</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>endptscale </code></td>
<td>
<p>Must be specified as <code>"log"</code> or
<code>"original"</code>. If <code>"log"</code> then the <code>estimates</code> vector
is assumed to be in the log scale, and calculations will 
transform it to the original scale for the generated table.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcadjust </code></td>
<td>

<p>Do a multiple comparisons adjustment, based on the simultaneous
inference capabilities of the <span class="pkg">multcomp</span> package. See Details
below. The default value is <code>FALSE</code>.
If <code>mcadjust=TRUE</code> is specified, there will be a delay,
usually just for a few seconds, due to computing time of the
critical point in order to conduct the adjusted comparisons.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha </code></td>
<td>
<p>Significance level, by default set to <code>0.05</code> to
correspond to 95% confidence. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type </code></td>
<td>
<p>Can be one of four values:
</p>

<dl>
<dt><code>"pairwisereflect"</code></dt>
<dd>
<p>The default value, it calculates and lists all possible
pairwise comparison permutations, as each pair ordering is
included. In other words, Groups A vs. B and B vs. A will be
included.
</p>
</dd>
<dt><code>"pairwise"</code></dt>
<dd>
<p>Calculates and lists all possible
pairwise comparison combinations. Once a pair such as Groups
A vs. B is specified, then the reflective B vs. A is not
included. So the number of comparisons presented is half that produced
by <code>"pairwisereflect"</code>. The ordering of group levels in the
<code>estimates</code> vector is used to determine which
ordering is included and which is not. If all orderings are
of interest, such as for <code>endptscale=="log"</code>,
use the <code>"pairwisereflect"</code> value above.
</p>
</dd>
<dt><code>"allgroupstocontrol"</code></dt>
<dd>
<p>Takes the first element
group of the <code>estimate</code> vector,
deems it the "control" group, and constructs
pairwise comparisons of all other groups to it.
</p>
</dd>
<dt><code>"custom"</code></dt>
<dd>
<p>Indicates that a custom matrix of
comparisons will be constructed, and that matrix needs to be
specified in the <code>contrastmatrix</code> argument.
</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrastmatrix </code></td>
<td>
<p>Only relevant if <code>type="custom"</code> is
specified. In that case, a numeric matrix with the number of
rows equal to the number of comparisons of interest is needed. The number
of columns must be equal to the number of groups in the
<code>estimate</code> vector. Each row in
the matrix is assumed to represent a contrast of coefficients
amongst the groups that defines the comparison of interest.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n </code></td>
<td>
<p>Needs to be specified only when
<code>errordf="approx"</code>. In this case it needs to be a vector of
group sample sizes, the same in length as the <code>estimates</code> vector.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset </code></td>
<td>
<p><em>Optional</em>, 
If for example a numeric constant was added to all response values
before calculation of the <code>estimates</code> as means in the
<code>"log"</code> scale, this could be used to
adjust the estimates and comparisons appropriately. The default
is <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cnames </code></td>
<td>

<p>If the default value of <code>"derive"</code> is used, row names are
derived for the table that reflect the A vs. B type of
comparison items in each row, using the names attrributes of the
<code>estimates</code> vector and the middle term of <code>"vs."</code> Otherwise,
this can be explicitly specified and needs to be a character vector of
the same length as <code>estimates</code> .
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>analysisname </code></td>
<td>
<p><em>Optional</em>, a character text that will be
printed along with the results table. The default
value is the empty <code>""</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>endptname </code></td>
<td>
<p><em>Optional</em>, a character text that will be
printed along with the results table. The default
value is the empty <code>""</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits </code></td>
<td>
<p><em>Optional</em>, For output display purposes,
values will be rounded to this numeric
value. Only the integers of 0, 1, 2, 3, and 4 are accepted. No
rounding is done during any calculations. The default value is
<code>NULL</code>, which will examine each individual <code>estimates</code>
value and choose the
one that has the maximum number of digits after any trailing
zeroes are ignored. The max number of digits will be 4.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>addpct </code></td>
<td>
<p>Only relevant if <code>endptscale=="original"</code>.
An column of percent differences is added for the
comparisons, as a descriptive supplement to the original scale
differences that are formally estimated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>display </code></td>
<td>
<p>One of three valid values:
</p>

<dl>
<dt><code>"print"</code></dt>
<dd>
<p>The default value; It calls a <code>print</code> method for the
created object, which is
a formatted text output of the table(s).
</p>
</dd>
<dt><code>"none"</code></dt>
<dd>
<p>Supresses any printing. Useful, for example, when just assignment
of the resulting object is desired.
</p>
</dd>
<dt><code>"show"</code></dt>
<dd>
<p>Calls the default <code>showDefault</code> method, which
will just print out the <code>comparisons</code> return object.
</p>
</dd>
</dl>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Only two-sided Wald-type of confidence intervals are possible with
this function. 
</p>
<p>When <code>mcadjust=TRUE</code>, a status message of
<code>"Some time may be needed as the critical point "</code>
<code>"from the multcomp::summary.glht function call is calculated "</code>
is displayed at the console. This computed critical point
is used for all subsequent p-value and confidence interval
calculations.
</p>
<p>The <span class="pkg">multcomp</span> package provides a unified way to calculate
critical points based on the comparisons of interest in a
"family." Thus a user does not need to worry about choosing amongst
the myriad names of multiple comparison procedures.
</p>


<h3>Value</h3>

<p>Creates a return data frame object that specifies the comparison of the
form A vs. B in each row, and with these columns:
</p>

<dl>
<dt><code>estimate</code></dt>
<dd>
<p>The difference in group estimates in the
comparison: A vs. B. If <code>endptscale="log"</code>,
this will be back-transformed to a percent
difference scale.
</p>
</dd>
<dt><code>se</code></dt>
<dd>
<p>The estimated standard error of the difference
<code>estimate</code>. If <code>endptscale="log"</code>,
this estimate will be based on the Delta
method, and will particularly begin to be a poor approximation when the
standard error in the logscale exceeds 0.50. 
</p>
</dd>
<dt><code>lowerci</code></dt>
<dd>
<p>The lower 100 * (1-<code>alpha</code>) % confidence limit of the
difference <code>estimate</code>. With the default <code>alpha=0.05</code>,
this is 95%. If <code>endptscale="log"</code>,
the confidence limit is first computed in the
logarithmic scale of analysis, and then back-transformed to a percent
difference scale.
</p>
</dd>
<dt><code>upperci</code></dt>
<dd>
<p>The upper 100 * (1-<code>alpha</code>) % confidence limit of the
difference <code>estimate</code>. With the default <code>alpha=0.05</code>,
this is 95%. If <code>endptscale="log"</code>,
the confidence limit is first computed in the
logarithmic scale of analysis, and then back-transformed to a percent
difference scale.
</p>
</dd>
<dt><code>pval</code></dt>
<dd>
<p>The computed p-value from the test of the difference <code>estimate</code>.
</p>
</dd>
<dt>
<code>meanA</code> or <code>geomeanA</code>
</dt>
<dd>
<p>The estimated "mean" for the left hand side "A" of the A
vs. B  comparison. If <code>endptscale="log"</code>,
this is a back-transform to the original scale,
and therefore is a "geometric" mean, and will be labelled
<code>geomeanA</code>. Otherwise it is the arithmetic mean and labelled <code>meanA</code>.
</p>
</dd>
<dt><code>seA</code></dt>
<dd>
<p>The estimated standard error of the <code>meanA</code>
<code>estimate</code>. If <code>endptscale="log"</code>, this estimate will be based on the Delta
method, and will particularly begin to be a poor approximation when the
standard error in the logscale exceeds 0.50. 
</p>
</dd>
<dt>
<code>meanB</code> or <code>geomeanB</code>
</dt>
<dd>
<p>The estimated "mean" for the right hand side "B" of the A
vs. B comparison. If <code>endptscale="log"</code>, this is a back-transform to the original scale,
and therefore is a "geometric" mean, and will be labelled
<code>geomeanB</code>.
Otherwise it is the arithmetic mean and labelled <code>meanB</code>.
</p>
</dd>
<dt><code>seB</code></dt>
<dd>
<p>The estimated standard error of the <code>meanB</code>
<code>estimate</code>. If <code>endptscale="log"</code>, this estimate will be based on the Delta
method, and will particularly begin to be a poor approximation when the
standard error in the logscale exceeds 0.50. 
</p>
</dd>
</dl>
<p>An additional column <code>addpct</code> of percent differences is added if
<code>endptscale=="original"</code> and <code>addpct=TRUE</code>,
as a descriptive supplement to the original scale
differences that are formally estimated.
</p>


<h3>Warning</h3>

<p>This function was created for internal use in the <span class="pkg">cg</span> package as
its use can be seen in the <code>comparisonsTable</code> methods
code. Therefore any direct use of it needs to be done cautiously.
</p>


<h3>Note</h3>

<p>Contact <a href="mailto:cg@billpikounis.net">cg@billpikounis.net</a> for bug reports, questions,
concerns, and comments. 
</p>


<h3>Author(s)</h3>

<p>Bill Pikounis [aut, cre, cph], John Oleynick [aut], Eva Ye [ctb]
</p>


<h3>References</h3>

<p>Hothorn, T., Bretz, F., Westfall, P., Heiberger, R.M., and
Schuetzenmeister, A. (2010). The <span class="pkg">multcomp</span> package.
</p>
<p>Hothorn, T., Bretz, F., and Westfall, P. (2008).
"Simultaneous Inference in General Parametric Models",
<em>Biometrical Journal</em>, 50, 3, 346-363.  
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(canine)
canine.data &lt;- prepareCGOneFactorData(canine, format="groupcolumns",
                                      analysisname="Canine",
                                      endptname="Prostate Volume",
                                      endptunits=expression(plain(cm)^3),
                                      digits=1, logscale=TRUE, refgrp="CC")

canine.fit &lt;- fit(canine.data)


## Easier way: notice the comparisonsTable call

comparisonsTable(canine.fit, model="olsonly")

## Manual way
## Instead of comparisonsTable(canine.fit, model="olsonly")

comparisons(estimates=canine.fit@olsfit$coef,
            varcovmatrix=vcov(canine.fit@olsfit),
            errordf=canine.fit@olsfit$df.residual,
            endptscale="log",
            analysisname="Canine",
            digits=1,
            endptname="Prostate Volume")
</code></pre>


</div>