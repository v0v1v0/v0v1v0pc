<div class="container">

<table style="width: 100%;"><tr>
<td>bootstrap_nns</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bootstrap nearest neighbors</h2>

<h3>Description</h3>

<p>Uses bootstrapping –sampling of of texts with replacement–
to identify the top N nearest neighbors based on cosine or inner product
similarity.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bootstrap_nns(
  context = NULL,
  pre_trained = NULL,
  transform = TRUE,
  transform_matrix = NULL,
  candidates = NULL,
  bootstrap = TRUE,
  num_bootstraps = 100,
  confidence_level = 0.95,
  N = 50,
  norm = "l2"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>context</code></td>
<td>
<p>(character) vector of texts - <code>context</code> variable in get_context output</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pre_trained</code></td>
<td>
<p>(numeric) a F x D matrix corresponding to pretrained embeddings.
F = number of features and D = embedding dimensions.
rownames(pre_trained) = set of features for which there is a pre-trained embedding.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transform</code></td>
<td>
<p>(logical) - if TRUE (default) apply the a la carte transformation, if FALSE ouput untransformed averaged embedding.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transform_matrix</code></td>
<td>
<p>(numeric) a D x D 'a la carte' transformation matrix.
D = dimensions of pretrained embeddings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>candidates</code></td>
<td>
<p>(character) vector defining the candidates for nearest neighbors - e.g. output from <code>get_local_vocab</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bootstrap</code></td>
<td>
<p>(logical) if TRUE, bootstrap similarity values - sample from texts with replacement.
Required to get std. errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_bootstraps</code></td>
<td>
<p>(numeric) - number of bootstraps to use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>confidence_level</code></td>
<td>
<p>(numeric in (0,1)) confidence level e.g. 0.95</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>(numeric) number of nearest neighbors to return.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>norm</code></td>
<td>
<p>(character) - how to compute the similarity (see ?text2vec::sim2):
</p>

<dl>
<dt><code>"l2"</code></dt>
<dd>
<p>cosine similarity</p>
</dd>
<dt><code>"none"</code></dt>
<dd>
<p>inner product</p>
</dd>
</dl>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a <code>data.frame</code> with the following columns:
</p>

<dl>
<dt><code>feature</code></dt>
<dd>
<p>(character)  vector of feature terms corresponding to the nearest neighbors.</p>
</dd>
<dt><code>value</code></dt>
<dd>
<p>(numeric) cosine/inner product similarity between
texts and feature. Average over bootstrapped samples if bootstrap = TRUE.</p>
</dd>
<dt><code>std.error</code></dt>
<dd>
<p>(numeric) std. error of the similarity value. Column is dropped if bootstrap = FALSE.</p>
</dd>
<dt><code>lower.ci</code></dt>
<dd>
<p>(numeric) (if bootstrap = TRUE) lower bound of the confidence interval.</p>
</dd>
<dt><code>upper.ci</code></dt>
<dd>
<p>(numeric) (if bootstrap = TRUE) upper bound of the confidence interval.</p>
</dd>
</dl>
<h3>Examples</h3>

<pre><code class="language-R">
# find contexts of immigration
context_immigration &lt;- get_context(x = cr_sample_corpus,
                                   target = 'immigration',
                                   window = 6,
                                   valuetype = "fixed",
                                   case_insensitive = TRUE,
                                   hard_cut = FALSE, verbose = FALSE)

# find local vocab (use it to define the candidate of nearest neighbors)
local_vocab &lt;- get_local_vocab(context_immigration$context, pre_trained = cr_glove_subset)

set.seed(42L)
nns_immigration &lt;- bootstrap_nns(context = context_immigration$context,
                                 pre_trained = cr_glove_subset,
                                 transform_matrix = cr_transform,
                                 transform = TRUE,
                                 candidates = local_vocab,
                                 bootstrap = TRUE,
                                 num_bootstraps = 100,
                                 confidence_level = 0.95,
                                 N = 50,
                                 norm = "l2")

head(nns_immigration)

</code></pre>


</div>