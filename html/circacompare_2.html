<div class="container">

<table style="width: 100%;"><tr>
<td>circacompare_mixed</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>circacompare_mixed</h2>

<h3>Description</h3>

<p><code>circacompare_mixed</code> is similar to <code>circacompare</code> but allows for some simple, user-specified random-effects on the rhythmic parameters of choice.
</p>


<h3>Usage</h3>

<pre><code class="language-R">circacompare_mixed(
  x,
  col_time,
  col_group,
  col_outcome,
  col_id,
  randomeffects = c(),
  period = 24,
  alpha_threshold = 0.05,
  nlme_control = list(),
  nlme_method = "REML",
  weights = NULL,
  suppress_all = FALSE,
  timeout_n = 10000,
  control = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p><code>data.frame</code>.  This is the data.frame which contains the rhythmic data for two groups in a tidy format.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_time</code></td>
<td>
<p>The name of the column within the data.frame, <code>x</code>, which contains time in hours at which the data were collected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_group</code></td>
<td>
<p>The name of the column within the data.frame, <code>x</code>, which contains the grouping variable.  This should only have two levels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_outcome</code></td>
<td>
<p>The name of the column within the data.frame, <code>x</code>, which contains outcome measure of interest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_id</code></td>
<td>
<p>The name of the column within the data.frame, <code>x</code>, which contains the identifying values for the random effect, such as <code>subject_id</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>randomeffects</code></td>
<td>
<p>which rhythmic parameters to allow random effects. The default is to include no rhythmic parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>period</code></td>
<td>
<p>The period of the rhythm. For circadian rhythms, leave this as the default value, <code>24</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_threshold</code></td>
<td>
<p>The level of alpha for which the presence of rhythmicity is considered. Default is to <code>0.05</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlme_control</code></td>
<td>
<p>A list of control values for the estimation algorithm to replace the default values returned by the function nlme::nlmeControl. Defaults to an empty list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlme_method</code></td>
<td>
<p>A character string. If "REML" the model is fit by maximizing the restricted log-likelihood. If "ML" the log-likelihood is maximized. Defaults to "REML".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>An optional numeric vector of (fixed) weights internally passed to <code>nlme::nlme()</code> via <code>nlme::varPower()</code>.
When present, the objective function is weighted least squares.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>suppress_all</code></td>
<td>
<p>Logical. Set to <code>TRUE</code> to avoid seeing errors or messages during model fitting procedure. Default is <code>FALSE</code>. If <code>FALSE</code>, also runs <code>nlme()</code> with <code>verbose = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timeout_n</code></td>
<td>
<p>The upper limit for the model fitting attempts. Default is <code>10000</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p><code>list</code>. Used to control the parameterization of the model.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>list
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Generate some data with within-id correlation for phase-shift (phi1)

set.seed(99)
phi1_in &lt;- 3.15

mixed_data &lt;- function(n) {
  counter &lt;- 1
  for (i in 1:n) {
    x &lt;- make_data(k1 = 0, alpha1 = 0, phi1 = rnorm(1, phi1_in, 0.5), hours = 72, noise_sd = 1)
    x$id &lt;- counter
    counter &lt;- counter + 1
    if (i == 1) {
      res &lt;- x
    } else {
      res &lt;- rbind(res, x)
    }
  }
  return(res)
}
df &lt;- mixed_data(20)
out &lt;- circacompare_mixed(
  x = df,
  col_time = "time",
  col_group = "group",
  col_outcome = "measure",
  col_id = "id",
  control = list(grouped_params = c("phi"), random_params = c("phi1"))
)

# with sample weights (arbitrary weights for demonstration)
sw &lt;- runif(n = nrow(df))
out2 &lt;- circacompare_mixed(
  x = df,
  col_time = "time",
  col_group = "group",
  col_outcome = "measure",
  col_id = "id",
  control = list(grouped_params = c("phi"), random_params = c("phi1")),
  weights = sw
)


</code></pre>


</div>