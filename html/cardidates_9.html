<div class="container">

<table style="width: 100%;"><tr>
<td>fitweibull</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit Four or Six Parametric Weibull Functions</h2>

<h3>Description</h3>

<p>Fit a four- or six-parametric Weibull function to environmental data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitweibull6(x, y = NULL, p0 = NULL, linint = -1, maxit = 2000)

fitweibull4(x, y = NULL, p0 = c(0.1, 50, 5, 100), linint = -1, maxit = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>the x (in day of year) and y coordinates of a set of points.
Alternatively, a single argument x can be provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p0</code></td>
<td>
<p>initial parameters for optimization. In case of <code>p0 = NA</code>
a heuristic algorithm to derive initial values is used for <code>fitweibull6</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linint</code></td>
<td>
<p>control parameter to select interpolation behavior.
Negative values (default) specify automatic selection heuristic,
zero disables interpolation. A positive value is interpreted as mandatory
interpolation time step.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>maximum number of iterations passed to the optimisation functions.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Function <code>fitweibull6</code> uses extensive heuristics to derive initial parameters
for the optimization. It is intended to work with data which are defined over an
interval between 0 and 365, e.g. environmental data and
especially for plankton blooms.
Please note that the function does internal transformation:
</p>
<p style="text-align: center;"><code class="reqn">y_{rel} = y_i / y_{max}</code>
</p>

<p>Note that additional data points are inserted between original measurements
by linear interpolation with time step = 1 before curve fitting if the number
of original data points is too low (currently n &lt; 35).
You can set <code>linint = 0</code> to switch interpolation off.
</p>
<p><code>fitweibull4</code> has only built-in heuristics for data interpolation but not
for guessing initial parameters which must be supplied as
vector <code>p0</code> in the call.
</p>


<h3>Value</h3>

<p>A list with components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>vector of fitted parameters,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ymax</code></td>
<td>
<p>maximum y value used for transformation,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r2</code></td>
<td>
<p>coefficient of determination between transformed and fitted y values,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>data frame with the following columns:
</p>

<ul>
<li>
<p><code>x</code>~data (original or interpolated) used for curve fitting,
</p>
</li>
<li>
<p><code>y</code>~data (transformed-original or interpolated) used for curve fitting,
</p>
</li>
<li>
<p><code>f</code>~estimated function values.
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Note that the heuristics works optimal if unnecessary leading and trailing
data are removed before the call.
</p>


<h3>Author(s)</h3>

<p>Susanne Rolinski (original algorithm) and Thomas Petzoldt (package).
</p>
<p>Maintainer: Thomas Petzoldt &lt;thomas.petzoldt@tu-dresden.de&gt;
</p>


<h3>References</h3>

<p>Rolinski, S., Horn, H., Petzoldt, T., &amp; Paul, L. (2007): Identification of cardinal
dates in phytoplankton time series to enable the analysis of long-term trends.
Oecologia <b>153</b>, 997 - 1008, <a href="https://doi.org/10.1007/s00442-007-0783-2">doi:10.1007/s00442-007-0783-2</a>.
</p>


<h3>See Also</h3>


<p><code>weibull4</code>,
<code>weibull6</code>,

<code>CDW</code>
<code>peakwindow</code>,
<code>cardidates</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## create some test data
set.seed(123)
x &lt;- seq(0, 360, length = 20)
y &lt;- abs(rnorm(20, mean = 1, sd = 0.1))
y[5:10] &lt;- c(2, 4, 7, 3, 4, 2)

## fit Weibull function with 6 free parameters
res &lt;- fitweibull6(x, y)

## show some properties
res$r2
p &lt;- res$p
o &lt;- res$fit
f &lt;- res$ymax

## fit 6 parameter Weibull with user-provided start parameters

x &lt;- seq(0, 150)
y &lt;- fweibull6(x, c(0.8, 40, 5, 0.2, 80, 5)) + rnorm(x, sd = 0.1)
plot(x, y)
res &lt;- fitweibull6(x, y, p0 = c(0, 40, 1, 1, 60, 0))
plot(res)
</code></pre>


</div>