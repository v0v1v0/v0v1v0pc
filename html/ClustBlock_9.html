<div class="container">

<table style="width: 100%;"><tr>
<td>cluscata</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Perform a cluster analysis of subjects from a CATA experiment</h2>

<h3>Description</h3>

<p>Clustering of subjects (blocks) from a CATA experiment. Each cluster of blocks is associated with a compromise
computed by the CATATIS method. The hierarchical clustering is followed by a partitioning algorithm (consolidation).
Non-binary data are accepted.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cluscata(Data, nblo, NameBlocks=NULL, NameVar=NULL, Noise_cluster=FALSE,
        Itermax=30, Graph_dend=TRUE, Graph_bar=TRUE, printlevel=FALSE,
        gpmax=min(6, nblo-2), rhoparam=NULL, Testonlyoneclust=FALSE, alpha=0.05,
        nperm=50, Warnings=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Data</code></td>
<td>
<p>data frame or matrix where the blocks of binary variables are merged horizontally. If you have a different format, see <code>change_cata_format</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nblo</code></td>
<td>
<p>numerical. Number of blocks (subjects).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NameBlocks</code></td>
<td>
<p>string vector. Name of each block (subject). Length must be equal to the number of blocks. If NULL, the names are S1,...Sm. Default: NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NameVar</code></td>
<td>
<p>string vector. Name of each variable (attribute, the same names for each subject). Length must be equal to the number of attributes. If NULL, the colnames of the first block are taken. Default: NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Noise_cluster</code></td>
<td>
<p>logical. Should a noise cluster be computed? Default: FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Itermax</code></td>
<td>
<p>numerical. Maximum of iteration for the partitioning algorithm. Default:30</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Graph_dend</code></td>
<td>
<p>logical. Should the dendrogram be plotted? Default: TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Graph_bar</code></td>
<td>
<p>logical. Should the barplot of the difference of the criterion and the barplot of the overall homogeneity at each merging step of the hierarchical algorithm be plotted? Default: TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>printlevel</code></td>
<td>
<p>logical. Print the number of remaining levels during the hierarchical clustering algorithm? Default: FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gpmax</code></td>
<td>
<p>logical. What is maximum number of clusters to consider? Default: min(6, nblo-2)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rhoparam</code></td>
<td>
<p>numerical. What is the threshold for the noise cluster? Between 0 and 1, high value can imply lot of blocks set aside. If NULL, automatic threshold is computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Testonlyoneclust</code></td>
<td>
<p>logical. Test if there is more than one cluster? Default: FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>numerical between 0 and 1. What is the threshold to test if there is more than one cluster? Default: 0.05</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nperm</code></td>
<td>
<p>numerical. How many permutations are required to test if there is more than one cluster? Default: 50</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Warnings</code></td>
<td>
<p>logical. Display warnings about the fact that none of the subjects in some clusters checked an attribute or product? Default: FALSE</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Each partitionK contains a list for each number of clusters of the partition, K=1 to gpmax with:
</p>

<ul>
<li>
<p> group: the clustering partition after consolidation. If Noise_cluster=TRUE, some subjects could be in the noise cluster ("K+1")
</p>
</li>
<li>
<p> rho: the threshold for the noise cluster
</p>
</li>
<li>
<p> homogeneity: homogeneity index (
</p>
</li>
<li>
<p> s_with_compromise: similarity coefficient of each subject with its cluster compromise
</p>
</li>
<li>
<p> weights: weight associated with each subject in its cluster
</p>
</li>
<li>
<p> compromise: the compromise of each cluster
</p>
</li>
<li>
<p> CA: list. the correspondance analysis results on each cluster compromise (coordinates, contributions...)
</p>
</li>
<li>
<p> inertia: percentage of total variance explained by each axis of the CA for each cluster
</p>
</li>
<li>
<p> s_all_cluster: the similarity coefficient between each subject and each cluster compromise
</p>
</li>
<li>
<p> criterion: the CLUSCATA criterion error
</p>
</li>
<li>
<p> param: parameters called
</p>
</li>
<li>
<p> type: parameter passed to other functions
</p>
</li>
</ul>
<p>There is also at the end of the list:
</p>

<ul>
<li>
<p> dend: The CLUSCATA dendrogram
</p>
</li>
<li>
<p> cutree_k: the partition obtained by cutting the dendrogram in K clusters (before consolidation).
</p>
</li>
<li>
<p> overall_homogeneity_ng: percentage of overall homogeneity by number of clusters before consolidation (and after if there is no noise cluster)
</p>
</li>
<li>
<p> diff_crit_ng: variation of criterion when a merging is done before consolidation (and after if there is no noise cluster)
</p>
</li>
<li>
<p> test_one_cluster: decision and pvalue to know if there is more than one cluster
</p>
</li>
<li>
<p> param: parameters called
</p>
</li>
<li>
<p> type: parameter passed to other functions
</p>
</li>
</ul>
<h3>References</h3>

<p>Llobell, F., Cariou, V., Vigneau, E., Labenne, A., &amp; Qannari, E. M. (2019). A new approach for the analysis of data and the clustering of subjects in a CATA experiment. Food Quality and Preference, 72, 31-39.<br>
Llobell, F., Giacalone, D., Labenne, A.,  Qannari, E.M. (2019).	Assessment of the agreement and cluster analysis of the respondents in a CATA experiment.	Food Quality and Preference, 77, 184-190.
</p>


<h3>See Also</h3>

<p><code>plot.cluscata</code>, <code>summary.cluscata</code> , <code>catatis</code>, <code>cluscata_kmeans</code>, <code>change_cata_format</code>, <code>change_cata_format2</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(straw)
#with 40 subjects
res=cluscata(Data=straw[,1:(16*40)], nblo=40)
#plot(res, ngroups=3, Graph_dend=FALSE)
summary(res, ngroups=3)
#With noise cluster
res2=cluscata(Data=straw[,1:(16*40)], nblo=40, Noise_cluster=TRUE,
Graph_dend=FALSE, Graph_bar=FALSE)
#With noise cluster and defined rho threshold
#(high threshold for this example, you can put low threshold
#(ex: 0.2 or 0.3) to avoid set aside lot of respondents)
res3=cluscata(Data=straw[,1:(16*40)], nblo=40, Noise_cluster=TRUE,
Graph_dend=FALSE, Graph_bar=FALSE, rhoparam=0.6)
#with all subjects
res=cluscata(Data=straw, nblo=114, printlevel=TRUE)


#Vertical format
data("fish")
Data=fish[1:66,2:30]
chang2=change_cata_format2(Data, nprod= 6, nattr= 27, nsub = 11, nsess= 1)
res3=cluscata(Data= chang2$Datafinal, nblo = 11, NameBlocks =  chang2$NameSub)


</code></pre>


</div>