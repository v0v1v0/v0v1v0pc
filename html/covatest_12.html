<div class="container">

<table style="width: 100%;"><tr>
<td>covablocks-class</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Class "covablocks"</h2>

<h3>Description</h3>

<p>A class for the sample spatio-temporal covariances to be computed for each
block of data and for the selected spatial and temporal lags fixed
in <code>stpairs</code> (output from <code>couples</code>). Depending on the type of
test the empirical variance, the sample spatial and temporal marginal
covariances for each block of data are also computed. Moreover, the sample
covariances between the spatio-temporal covariances at the specified spatial
and temporal lags are determined.
</p>


<h3>Usage</h3>

<pre><code class="language-R">covablocks(stblocks, stpairs, typetest = "sym")

## S4 method for signature 'covablocks'
show(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>stblocks</code></td>
<td>
<p>object of class <code>blocks</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stpairs</code></td>
<td>
<p>object of class <code>couples</code>, containing the spatial
points and the corresponding temporal lags to be analyzed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>typetest</code></td>
<td>
<p>character, set <code>typetest ="sym"</code> for symmetry test
(default choice), <code>typetest ="sep"</code> for separability test, <code>typetest ="tnSep"</code>
for type of non separability test,<code>typetest ="productSum"</code> for the test
on the product-sum class of models, <code>typetest ="intProduct"</code> for the test
on the integrated product class of models, <code>typetest ="gneiting"</code> for the
test on the Gneiting class of models</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>object of class <code>covablocks</code> for method <code>show</code></p>
</td>
</tr>
</table>
<h3>Details</h3>



<ul>
<li>
<p> If <code>typetest</code> is equal to <code>"sym"</code> (symmetry test) or <code>"intProduct"</code>
(test on the integrated product class of models) <code>mat.cova.h</code> and <code>mat.cova.u</code>
are not available
</p>
</li>
<li>
<p> If <code>typetest</code> is equal to <code>"gneiting"</code> (test on the Gneiting
class of models) <code>mat.cova.h</code> is not available
</p>
</li>
<li>
<p> If temporal lags in <code>stpairs</code> are not consistent with block length
(<code>lb</code>) in <code>stblocks</code> an error message will be returned
</p>
</li>
<li>
<p> If the proportion between the maximum temporal lag in <code>stpairs</code> and
the block length (<code>lb</code>) in <code>stblocks</code> is greater than 0.25 a warning
message will be returned since the covariance estimation might not be reliable
</p>
</li>
</ul>
<h3>Slots</h3>


<dl>
<dt><code>mat.cova</code></dt>
<dd>
<p>matrix of sample spatio-temporal covariances for each block,
computed for the spatial and temporal lags given in <code>stpairs</code>
(object of class <code>couples</code>)</p>
</dd>
<dt><code>mat.cova.h</code></dt>
<dd>
<p>matrix of sample spatial marginal covariances
for the specified lags</p>
</dd>
<dt><code>mat.cova.u</code></dt>
<dd>
<p>matrix of sample temporal marginal covariances
for the specified lags</p>
</dd>
<dt><code>mat.cova.cova</code></dt>
<dd>
<p>matrix of sample covariances between space-time
covariances for each block, computed for the spatial and temporal lags given
in <code>stpairs</code> (object of class <code>couples</code>)</p>
</dd>
<dt><code>typetest</code></dt>
<dd>
<p>character, contains the code of the test to be performed</p>
</dd>
</dl>
<h3>References</h3>

<p>Cappello, C., De Iaco, S., Posa, D., 2018, Testing the type of
non-separability and some classes of space-time covariance function models.
Stochastic Environmental Research and Risk Assessment,
<b>32</b> 17–35
</p>
<p>Cappello, C., De Iaco, S., Posa, D., 2020, covatest: An R Package for
Selecting a Class of Space-Time Covariance Functions.
Journal of Statistical Software, <b>94(1)</b> 1–42.
</p>
<p>De Iaco, S., Palma, M., Posa, D., 2016. A general procedure for selecting a
class of fully symmetric space-time covariance functions.
Environmentrics, <b>27(4)</b> 212–224.
</p>
<p>Li, B., Genton, M.G., Sherman, M., 2007, A nonparametric assessment
of properties of spacetime covariance functions.
Journal of the American Statistical Association, <b>102</b> 736–744.
</p>


<h3>See Also</h3>

<p>blocks
</p>
<p>couples
</p>


<h3>Examples</h3>

<pre><code class="language-R"># --start define the STFDF rr_13-- #
library(sp)
library(spacetime)
#library(gstat)
data(air)
ls()
if (!exists("rural")) rural = STFDF(stations, dates, data.frame(PM10 =
as.vector(air)))
rr = rural[,"2005::2010"]
unsel = which(apply(as(rr, "xts"), 2, function(x) all(is.na(x))))
r5to10 = rr[-unsel,]
rr_13 &lt;- r5to10[c("DEHE046","DESN049","DETH026","DENW063","DETH061","DEBY047",
"DENW065","DEUB029","DENW068","DENI019","DEHE051","DERP016","DENI051"),
"2005::2006"]
# --end define the STFDF rr_13-- #

sel.staz.sym &lt;- c("DERP016", "DENW065", "DEHE051", "DETH026", "DENW063", "DENI019",
"DENW068", "DEHE046", "DEUB029", "DEBY047", "DETH061", "DESN049")

sp.couples.in.sym &lt;- matrix(data = c("DERP016", "DENW065", "DEHE051", "DETH026",
"DENW063", "DENI019", "DENW068", "DEHE046", "DEUB029", "DEBY047", "DETH061", "DESN049"),
ncol = 2, byrow = TRUE)

t.couples.in.sym &lt;- c(1, 2)

couples.sym &lt;- couples(sel.staz = sel.staz.sym, sp.couples.in = sp.couples.in.sym,
t.couples.in = t.couples.in.sym, typetest = "sym", typecode = character())

block.sym &lt;- blocks(lb = 40, ls = 10, matdata = rr_13, pardata1 = 1, pardata2 = 1,
stpairs = couples.sym)

covabl.sym &lt;- covablocks(stblocks = block.sym, stpairs = couples.sym, typetest = "sym")

### method for covablock
#1. show
covabl.sym

</code></pre>


</div>