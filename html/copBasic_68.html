<div class="container">

<table style="width: 100%;"><tr>
<td>isCOP.PQD</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The Positively Quadrant Dependency State of a Copula</h2>

<h3>Description</h3>

<p>Numerically determine the global property of the <em>positively quadrant dependency</em> (PQD) characteristic of a copula as described by Nelsen (2006, p. 188). The random variables <code class="reqn">X</code> and <code class="reqn">Y</code> are PQD if for all <code class="reqn">(x,y)</code> in <code class="reqn">\mathcal{R}^2</code> when
<code class="reqn">H(x,y) \ge F(x)G(x)</code> for all <code class="reqn">(x,y)</code> in <code class="reqn">\mathcal{R}^2</code>
and thus by the copula <code class="reqn">\mathbf{C}(u,v) \ge uv</code> for all <code class="reqn">(u,v)</code> in <code class="reqn">\mathcal{I}^2</code>. Alternatively, this means that <code class="reqn">\mathbf{C}(u,v) \ge \mathbf{\Pi}</code>, and thus it can be said that it is globally “greater” than independence (<code class="reqn">uv = \Pi</code>; <code>P</code>).
</p>
<p>Nelsen (2006) shows that a copula is PQD when
</p>
<p style="text-align: center;"><code class="reqn">0 \le \beta_\mathbf{C} \mbox{,\ } 0 \le \gamma_\mathbf{C}\mbox{,\ and\ } 0 \le \rho_\mathbf{C} \le 3\tau_\mathbf{C}\mbox{,}</code>
</p>

<p>where <code class="reqn">\beta_\mathbf{C}</code>, <code class="reqn">\gamma_\mathbf{C}</code>, <code class="reqn">\rho_\mathbf{C}</code>, and <code class="reqn">\tau_\mathbf{C}</code> are various copula measures of association or concordance that are respectively described in <code>blomCOP</code>, <code>giniCOP</code>, <code>rhoCOP</code>, and <code>tauCOP</code>.
The concept of negatively quadrant dependency (NQD) is the reverse: <code class="reqn">\mathbf{C}(u,v) \le \mathbf{\Pi}</code> for all <code class="reqn">(u,v)</code> in <code class="reqn">\mathcal{I}^2</code>; so NQD is globally “smaller” than independence.
</p>
<p>Conceptually, PQD is related to the probability that two random variables are simultaneously small (or simultaneously large) is at least as great as it would be if they were <em>independent</em>. The graph of a PQD copula lies on or above the copulatic surface of the <em>independence copula</em> <code class="reqn">\mathbf{\Pi}</code>, and conversely a NQD copula lies on or below <code class="reqn">\mathbf{\Pi}</code>.
</p>
<p>Albeit a “global” property of a copula, there can be “local” variations in the PQD/NQD state. Points in <code class="reqn">\mathcal{I}^2</code> where <code class="reqn">\mathbf{C}(u,v) - \mathbf{\Pi} \ge 0</code> are locally PQD, whereas points in <code class="reqn">\mathcal{I}^2</code> where <code class="reqn">\mathbf{C}(u,v) - \mathbf{\Pi} \le 0</code> and locally NQD. Lastly, readers are directed to the last examples in <code>wolfCOP</code> because as those examples involve the copulatic difference from independence <code class="reqn">\mathbf{C}(u,v) - \mathbf{\Pi} = \mathbf{C}(u,v) - \mathbf{\Pi}</code> with 3-D renderings.
</p>


<h3>Usage</h3>

<pre><code class="language-R">isCOP.PQD(cop=NULL, para=NULL, uv=NULL, empirical=FALSE, verbose=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cop</code></td>
<td>
<p>A copula function;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>para</code></td>
<td>
<p>Vector of parameters or other data structure, if needed, to pass to the copula;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uv</code></td>
<td>
<p>An optional <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> <code>data.frame</code> of <code class="reqn">U</code> and <code class="reqn">V</code> nonexceedance probabilities <code class="reqn">u</code> and <code class="reqn">v</code> for the random variables <code class="reqn">X</code> and <code class="reqn">Y</code>. This argument triggers different value return behavior (see <b>Value</b>);</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>empirical</code></td>
<td>
<p>A logical that will use sample versions for <em>Gini Gamma</em>, <em>Spearman Rho</em>, and <em>Kendall Tau</em>. This feature is <em>only</em> applicable if the copula is empirical and therefore the <code>para</code> argument is the <code>data.frame</code> of <code class="reqn">u</code> and <code class="reqn">v</code>, which will be passed along to sample version functions instead of copula (see <b>Note</b>);</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A logical that will report the four concordance measures; and</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to pass, which are then passed to subordinate functions.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If <code>uv=NULL</code> then a logical for the global property of PQD is returned but if argument <code>uv</code> is a <code>data.frame</code>, then an <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> <code>list</code> is returned, and that list holds the global condition in <code>global.PQD</code> and  local condition assessments in <code>local.PQD</code> and <code>local.NQD</code>.
</p>


<h3>Note</h3>

<p>The function <code>isCOP.PQD</code> will try <code>brute</code> force computations if subordinate calls to one or more functions fails. The user can use <code>...</code> to set the <code>delta</code> argument for <code>giniCOP</code>, <code>rhoCOP</code>, and (or) <code>tauCOP</code>.
</p>
<p>This function is not guaranteed to work using a <em>bivariate empirical copula</em> such as the following operation: <code>copPQD(cop=EMPIRcop, para=the.data)</code>. An evidently open problem for <span class="pkg">copBasic</span> is how to support PQD assessment (either globally or locally) for empirical copulas. The <code class="reqn">\tau_\mathbf{C}</code> for the bivariate empirical copula example <code>brute=TRUE|FALSE</code> to unity and <code class="reqn">\gamma_\mathbf{C}</code> and <code class="reqn">\rho_\mathbf{C}</code> reach maximum number of subdivisions on the numerical integration and thus fail. If an empirical bivariate copula is “Tau'd” to itself, is <code class="reqn">\tau_\mathbf{C} \equiv 1</code> guaranteed? The <code class="reqn">\tau_\mathbf{C}</code> computation relies on numerical partial derivatives of the copula, whereas the <code class="reqn">\gamma_\mathbf{C}</code> and <code class="reqn">\rho_\mathbf{C}</code> use the copula itself. It seems in the end that use of sample versions of <code class="reqn">\gamma_\mathbf{C}</code>, <code class="reqn">\rho_\mathbf{C}</code>, and <code class="reqn">\tau_\mathbf{C}</code> would be appropriate and leave the <code class="reqn">\beta_\mathbf{C}</code> as either copula or direct sample computation (see <b>Examples</b>).
</p>
<p><em>SPECIAL DEMONSTRATION 1</em>—Given the following,
</p>
<pre>
  para &lt;- list(cop1=PLACKETTcop, cop2=PLACKETTcop, para1=c(14.5),para2=c(1.45),
               alpha=0.51, beta=0.15, kappa=0.45, gamma=0.78)
  D &lt;- simCOP(n=500, cop=composite3COP, para=para, cex=0.5, col=1, pch=16)
</pre>
<p>the two different call types to <code>isCOP.PQD</code> for an empirical copula are illustrative:
</p>
<pre>
  global.only &lt;- isCOP.PQD(cop=EMPIRcop, para=D, empirical=TRUE)
</pre>
<p>and
</p>
<pre>
  PQD.list &lt;- isCOP.PQD(cop=EMPIRcop, para=D, empirical=TRUE, uv=D)
  points(D, col=PQD.list$local.PQD+2, lwd=2) # red (if present) is local NQD
</pre>
<p>which in the former only returns the global PQD and the later returns an <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> <code>list</code> with global (<code>global.PQD</code>), local (<code>local.PQD</code> as well as <code>local.NQD</code>), and the four statistics (<code>beta</code> <code class="reqn">\beta_\mathbf{C}</code>, <code>gamma</code> <code class="reqn">\gamma_\mathbf{C}</code>, <code>rho</code> <code class="reqn">\rho_\mathbf{C}</code>, <code>tau</code> <code class="reqn">\tau_\mathbf{C}</code>) used to determine global PQD.
</p>
<p><em>SPECIAL DEMONSTRATION 1</em>—Lastly, the <code>ctype=</code><code>"bernstein"</code> argument to the empirical copula can be used. Repeated iterations of the following will show that local quadrant dependency can appear slightly different when the <code>bernstein</code> argument is present. The simulation sample size is reduced considerably for this second example because of the CPU effort triggered by the <em>Bernstein extension</em> (see <code>EMPIRcop</code>) having been turned on.
</p>
<pre>
  para &lt;- list(cop1=PLACKETTcop,  cop2=PLACKETTcop, para1=14.5, para2=1.45,
               alpha=0.51, beta=0.15, kappa=0.45, gamma=0.78)
  D &lt;- simCOP(n=50, cop=composite3COP, para=para, cex=0.5, col=1, pch=16)
  PQD.A&lt;- isCOP.PQD(cop=EMPIRcop, para=D, empirical=TRUE, uv=D)
  points(D, col=PQD.A$local.PQD+2, lwd=2) # red (if present) is local NQD
  PQD.B&lt;- isCOP.PQD(cop=EMPIRcop,para=D,empirical=TRUE,uv=D,ctype="bernstein")
  points(D, col=PQD.B$local.PQD+2, lwd=1, pch=3, cex=1.5)
</pre>


<h3>Author(s)</h3>

<p>W.H. Asquith</p>


<h3>References</h3>

<p>Nelsen, R.B., 2006, An introduction to copulas: New York, Springer, 269 p.
</p>


<h3>See Also</h3>

<p><code>blomCOP</code>, <code>giniCOP</code>, <code>rhoCOP</code>, <code>tauCOP</code>, <code>isCOP.LTD</code>, <code>isCOP.RTI</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
isCOP.PQD(cop=PSP) # TRUE
## End(Not run)

## Not run: 
# Example concerning Empirical Bivariate Copula and sample versions for comparison.
set.seed(10); n &lt;- 1000
para &lt;- list(cop1=PLACKETTcop, cop2=PLACKETTcop, para1=0.145,  para2=1.45,
             alpha=0.81, beta=0.8)
D &lt;- simCOP(n=n, cop=composite2COP, para=para, cex=0.5, col=rgb(0,0,0,0.2), pch=16)
#tauCOP(cop=EMPIRcop, para=D)   # ??? but == 1
cor(D$U, D$V, method="kendall") # -0.3224705
blomCOP(cop=EMPIRcop, para=D)   # -0.332
giniCOP(cop=EMPIRcop, para=D)   # -0.3692037
GINI &lt;- sum(abs(rank(D$U)+rank(D$V)-n-1)) - sum(abs(rank(D$U)-rank(D$V)))
print(GINI/as.integer(n^2/2))   # -0.369996
rhoCOP(cop=EMPIRcop, para=D)    # ??? but fails
cor(D$U, D$V, method="spearman")      # -0.456694
lmomco::lcomoms2(D)$T2     #  1.0000000 -0.4568357
                           # -0.4567859  1.0000000
## End(Not run)
</code></pre>


</div>