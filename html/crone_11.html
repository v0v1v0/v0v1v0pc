<div class="container">

<table style="width: 100%;"><tr>
<td>invfousynth</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>From density to structure factors using inverse Fourier synthesis</h2>

<h3>Description</h3>

<p>Given a density as vector calculated in N grid points, the unit cell
size and an array of Miller indices hidx, this function calculates
amplitudes and phases of the structure factors corresponding to this
density, via inverse Fourier transform.
</p>


<h3>Usage</h3>

<pre><code class="language-R">invfousynth(a, rho, hidx)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>A real number. The unit cell side length.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>A vector of N real numbers representing the 1D density at
each of the regular N grid point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hidx</code></td>
<td>
<p>A vector of integer numbers. The set of 1D Miller indices
corresponding to the set of structure factors F, to be calculated.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A vector of N real numbers representing the calculated 1D 
density at each one of the regular N grid points.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># First create the crystal structure (in P1)
a &lt;- 10
SG &lt;- "P1"
x0 &lt;- c(1,4,6.5)
Z &lt;- c(8,26,6)
B &lt;- c(18,20,17)
occ &lt;- c(1,1,1)
sdata &lt;- standardise_sdata(a,SG,x0,Z,B,occ)

# 10 Miller indices plus DC component
hidx &lt;- 0:10

# Compute structure factors
ftmp1 &lt;- strufac(hidx,sdata)

# Number of grid points
N &lt;- 1000

# Density
rtmp &lt;- fousynth(a,ftmp1$Fmod,ftmp1$Fpha,hidx,N)

# Using inverse Fourier to obtain structure factors
ftmp2 &lt;- invfousynth(a,rtmp$rr,hidx)

# Comparison
print(abs(ftmp1$Fmod-ftmp2$Fmod))
print(abs(ftmp1$Fpha-ftmp2$Fpha))

</code></pre>


</div>