<div class="container">

<table style="width: 100%;"><tr>
<td>cmps_segment_plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot the selected basis segment and its cross-correlation curve at all scales based on the
results of CMPS algorithm</h2>

<h3>Description</h3>

<p>This function plots the selected basis segment with the comparison signature. One can visualize the
scaled segment and its corresponding cross-correlation curve. The number of marked correlation peaks
at each segment scale is determined by <code>npeaks_set</code> of <code>extract_feature_cmps</code>. The red vertical dashed
line indicates the congruent registration position for all segments; the green vertical dashed line
indicates the position of the consistent correlation peak (if any); the blue vertical dashed line
indicates the tolerance zone (determined by <code>Tx</code>)
</p>


<h3>Usage</h3>

<pre><code class="language-R">cmps_segment_plot(cmps_result, seg_idx = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cmps_result</code></td>
<td>
<p>a list generated by <code>extract_feature_cmps</code>. <code>cmps_result</code> is required to have
the following names: <code>parameters</code>, <code>congruent_pos</code>, <code>segments</code>, <code>nseg</code>, i.e. one should at least have
<code>include = c("parameters", "congruent_pos", "segments", "nseg")</code> when computing <code>cmps_result</code>.
However, <code style="white-space: pre;">⁠include = "full_result⁠</code> is still recommended.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seg_idx</code></td>
<td>
<p>an integer. The index of a basis segment that we want to plot for.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list of n elements, where n is the length of <code>npeaks_set</code>, i.e. the number of scales for
each basis segment. And each one of these n elements is also a list, a list of two plots:
</p>

<ul>
<li> <p><code>segment_plot</code>: The basis segment of current scale is plotted at different positions where the
segment obtains correlation peak. The comparison signature is also plotted.
</p>
</li>
<li> <p><code>scale_ccf_plot</code>: This is the plot of the cross-correlation curve between the comparison signature
and the segment of the current scale.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">library(cmpsR)
library(ggpubr)

data("bullets")
land2_3 &lt;- bullets$sigs[bullets$bulletland == "2-3"][[1]]
land1_2 &lt;- bullets$sigs[bullets$bulletland == "1-2"][[1]]

# compute cmps

# algorithm with multi-peak insepction at three different segment scales
cmps_with_multi_scale &lt;- extract_feature_cmps(land2_3$sig, land1_2$sig, include = "full_result" )

# generate plots using cmps_signature_plot
seg_plot &lt;- cmps_segment_plot(cmps_with_multi_scale, seg_idx = 3)

pp &lt;- ggarrange(plotlist = unlist(seg_plot, recursive = FALSE), nrow = 3, ncol = 2)

</code></pre>


</div>