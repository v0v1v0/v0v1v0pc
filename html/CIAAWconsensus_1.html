<div class="container">

<table style="width: 100%;"><tr>
<td>abundances2ratios</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Isotope ratios of a chemical element from isotopic abundances</h2>

<h3>Description</h3>

<p>This function calculates the isotope ratios of a chemical element from the given isotopic abundances and their uncertainties.
The uncertainty evaluation is done using the propagation of uncertainty and the missing correlations between the isotopic abundances are reconstructed using Monte Carlo methods.
</p>


<h3>Usage</h3>

<pre><code class="language-R">abundances2ratios(x, ux, ref=1, iterations=1e4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A vector of isotopic abundances of an element</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ux</code></td>
<td>
<p>Standard uncertainties of <code>x</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ref</code></td>
<td>
<p>Index to specify the desired reference isotope for isotope amount ratios</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterations</code></td>
<td>
<p>Number of iterations for isotopic abundance correlation mapping</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Situations are often encountered where isotopic abundances are reported but not the isotope ratios.
In such cases we reconstruct the isotope ratios that are consistent with the abundances and their uncertainties. 
Given only the abundances and their uncertainties, for elements with four or more isotopes one cannot unambiguously infer the uncertainties of the ratios due to the unknown correlations between isotopic abundances.
This missing information can be reconstructed by mapping all possible correlations between isotopic abundances.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>Isotope ratio vector, excluding the trivial ratio</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R.u</code></td>
<td>
<p>Standard uncertainties of the isotope ratios</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R.cov</code></td>
<td>
<p>Isotope ratio covariance matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Number of sucessful Monte Carlo iterations</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Juris Meija &lt;juris.meija@nrc-cnrc.gc.ca&gt; and Antonio Possolo</p>


<h3>References</h3>

<p>J. Meija and Z. Mester (2008) <a href="http://dx.doi.org/10.1088/0026-1394/45/4/012">Atomic weight uncertainty calculation from isotopic composition of the elements</a>. <em>Metrologia</em>, 45, 459
</p>
<p>J. Meija and A. Possolo (2017) <a href="https://doi.org/10.1088/1681-7575/aa634d">Data reduction framework for standard atomic weights and isotopic compositions of the elements</a>. <em>Metrologia</em>, 54, 229-238
</p>
<p>JCGM 101:2008 Evaluation of measurement data - Supplement 1 to the "Guide to the expression of uncertainty in measurement" - Propagation of distributions using a Monte Carlo method
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Isotope ratios of zinc from the isotopic abundances
x = c(0.48630, 0.27900, 0.04100, 0.18750, 0.00620)
ux = c(0.00091, 0.00076, 0.00031, 0.00135, 0.00010)
abundances2ratios(x,ux,ref=2)

## The corresponding atomic weight can be obtained using at.weight(z$R,z$R.cov,"zinc","66Zn")
</code></pre>


</div>