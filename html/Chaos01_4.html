<div class="container">

<table style="width: 100%;"><tr>
<td>fast.rqa</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function to compute diagonal RQA measures for given time series</h2>

<h3>Description</h3>

<p>This function computes results of the RQA from the numeric vector (time series).
</p>


<h3>Usage</h3>

<pre><code class="language-R">fast.rqa(TS, dim = 2, lag = 1, eps, theta = 1, lmin = 3,
  include.TS = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>TS</code></td>
<td>
<p>the input vector, This should be a numeric vector. (e.g. ts object is also accepted)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dim</code></td>
<td>
<p>integer, embedding dimension. See details for more information. Default is 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lag</code></td>
<td>
<p>integer, embedding lag/delay. See details for more information. Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>double, threshold/neighbourhood size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>integer, Theiler window, number of diagonal lines which should be skipped from the main diagonal. 
</p>

<ul>
<li>
<p> 0 - include main diagonal/LOS into computation
</p>
</li>
<li>
<p> 1 - do not include main diagonal.
</p>
</li>
<li>
<p> 2 - skip main diagonal and 1 diagonal closest to main diagonal.
</p>
</li>
<li>
<p> 3 - etc.
</p>
</li>
</ul>
<p>Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lmin</code></td>
<td>
<p>integer, minimal length of line to be considered for recurrence line. Default is 3</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include.TS</code></td>
<td>
<p>logical, if TRUE input time series will be added to the list of outputs. Default is FALSE.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>RQA analysis tool is included in this package because '0-1 test for chaos' can determine whether the dynamics of the system is chaotic or regular, but cannot distinguish between chaotic and random dynamics.
</p>
<p>It should be possible to determine whether the system si deterministic or not based on the evolution of RQA measure with increasing thresholds 'eps'. For this it is necessary to compute RQA many times and therefore this
fast version of RQA computation is provided. To further improve workflow in examining the system <code>rqa.seq</code> is provided to compute RQA for sequence of 'eps' values and resulting object can be easily visualized by the plot function.
</p>
<p>This version of RQA is based on the optimized algorithms for RQA computation given at <a href="https://code.it4i.cz/ADAS/RQA_HPC">https://code.it4i.cz/ADAS/RQA_HPC</a>. Main difference is in reduction of the memory complexity by not storing histogram. Due to this Shannon entropy is not computed,
but the algorithm is faster. Additionally, distance metric is set to the maximum distance. This is due to the fact, that for eps = diff(range(TS)), all the points will be counted as the recurrences. This fact is used when
studying the characteristics of the time series dependent on the 'eps' value using the <code>rqa.seq</code> function.
</p>
<p>Usually, RQA is computed from a state-space reconstruction of the dynamical system. In this case Takens embedding is used [3]. It is necessary to set two parameters for Takens embedding: embeding dimension and delay time.
If You have no prior knowledge about the system, it is possible to estimate best values for these parameters according to the first minimal value of the mutual information of the time series and the minimal value of the false 
nearest neighbour algorithm. These routines can be found in e.g. 'nonlinearTseries' package and 'fNonlinear' package.
</p>
<p>There are other ways how to test whether the data have non-linear characteristics, have stochastic nature, or are just colored noise. To this end You can use tests included in 'nonlinearTseries' package or 'fNonlinear' package. 'nonlinearTseries' package also include
RQA function, which stores more results, but are significantly slower and memory expensive, especially for the longer time series. Similar test could be found in other packages focused on nonlinear time series analysis.
</p>


<h3>Value</h3>

<p>Returns "chaos01.rqa" object (to differentiate from the 'rqa' object given by the 'nonlinearTseries' package), which contains list of RQA results and list of settings. Additionaly, if include.TS = TRUE, it adds input time series to the end of the list.
</p>

<ul>
<li>
<p> "RR"    - Recurrence rate
</p>
</li>
<li>
<p> "DET"   - Determinism, count recurrence points in diagonal lines of length &gt;= lmin 
</p>
</li>
<li>
<p> "RATIO" - DET/RR
</p>
</li>
<li>
<p> "AVG"   - average length of diagonal lines of length &gt;= lmin
</p>
</li>
<li>
<p> "MAX"   - maximal length of diagonal lines of length &gt;= lmin
</p>
</li>
<li>
<p> "DIV"   - Divergence, 1/MAX
</p>
</li>
<li>
<p> "LAM"   - Laminarity, VLRP/TR
</p>
</li>
<li>
<p> "TT"    - Trapping time, average length of vertical lines of length &gt;= lmin
</p>
</li>
<li>
<p> "MAX_V" - maximal length of vertical lines of length &gt;= lmin
</p>
</li>
<li>
<p> "TR"    - Total number of recurrence points
</p>
</li>
<li>
<p> "DLRP"  - Recurrence points on the diagonal lines of length of length &gt;= lmin
</p>
</li>
<li>
<p> "DLC"   - Count of diagonal lines of length of length &gt;= lmin
</p>
</li>
<li>
<p> "VLRP"  - Recurrence points on the vertical lines of length of length &gt;= lmin
</p>
</li>
<li>
<p> "VLC"   - Count of vertical lines of length of length &gt;= lmin
</p>
</li>
</ul>
<h3>References</h3>

<p>[1] Marwan; M. C. Romano; M. Thiel; J. Kurths (2007). "Recurrence Plots for the Analysis of Complex Systems". Physics Reports. 438 (5-6): 237. Bibcode:2007PhR...438..237M. doi:10.1016/j.physrep.2006.11.001.
</p>
<p>[2] Zbilut, J.; Webber C., L. (2006). "Recurrence Quantification Analysis". Wiley Encylopedia of Biomedical Engineering, SN: 9780471740360, doi: 10.1002/9780471740360.ebs1355
</p>
<p>[3] F. Takens (1981). "Detecting strange attractors in turbulence". In D. A. Rand and L.-S. Young. Dynamical Systems and Turbulence, Lecture Notes in Mathematics, vol. 898. Springer-Verlag. pp. 366â€“381.
</p>


<h3>See Also</h3>

<p><code>rqa.seq</code>, <code>plot.chaos01.rqa.sequence</code>, <code>summary.chaos01.rqa</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">vec.x &lt;- gen.logistic(mu = 3.55, iter = 2000)

res &lt;- fast.rqa(vec.x, dim = 3, lag = 10, eps = 0.3)
summary(res)
</code></pre>


</div>