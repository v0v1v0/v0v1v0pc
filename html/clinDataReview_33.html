<div class="container">

<table style="width: 100%;"><tr>
<td>errorbarClinData</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Interactive plot of confidence interval/error interval of clinical data.</h2>

<h3>Description</h3>

<p>This plot is designed to display summary statistics
of a continuous variable with (confidence) intervals.<br>
The intervals are either displayed:
</p>

<ul>
<li>
<p> vertically if <code>yErrorVar</code> is specified
</p>
</li>
<li>
<p> horizontally if <code>xErrorVar</code> is specified
</p>
</li>
</ul>
<p>Error bars can visualized by group, via the color variable parameter.<br>
Different symbols are set for each central point of the error bar
via the shape variable parameter.
</p>


<h3>Usage</h3>

<pre><code class="language-R">errorbarClinData(
  data,
  xVar,
  xLab = getLabelVar(xVar, labelVars = labelVars),
  xLabVar = NULL,
  yVar,
  yLab = getLabelVar(yVar, labelVars = labelVars),
  yLabVar = NULL,
  yErrorVar = NULL,
  yErrorLab = getLabelVar(yErrorVar, labelVars = labelVars),
  xErrorVar = NULL,
  xErrorLab = getLabelVar(xErrorVar, labelVars = labelVars),
  xLabVars = NULL,
  xAxisLab = paste(c(xLab, xErrorLab), collapse = " and "),
  yAxisLab = paste(c(yLab, yErrorLab), collapse = " and "),
  colorVar = NULL,
  colorLab = getLabelVar(colorVar, labelVars = labelVars),
  colorPalette = NULL,
  shapeVar = NULL,
  shapeLab = getLabelVar(shapeVar, labelVars = labelVars),
  shapePalette = NULL,
  size = 6,
  title = paste(c(paste(yAxisLab, "vs", xAxisLab), titleExtra), collapse = "&lt;br&gt;"),
  titleExtra = NULL,
  subtitle = NULL,
  caption = NULL,
  labelVars = NULL,
  mode = "markers",
  legendPosition = "bottom",
  width = NULL,
  height = NULL,
  pathVar = NULL,
  pathLab = getLabelVar(pathVar, labelVars = labelVars),
  hoverVars,
  hoverLab,
  id = paste0("plotClinData", sample.int(n = 1000, size = 1)),
  selectVars = NULL,
  selectLab = getLabelVar(selectVars, labelVars = labelVars),
  table = FALSE,
  tableVars,
  tableLab,
  tableButton = TRUE,
  tablePars = list(),
  watermark = NULL,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data.frame with data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xVar</code></td>
<td>
<p>String with column of <code>data</code> containing x-variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xLab</code></td>
<td>
<p>String with label for <code>xVar</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xLabVar</code></td>
<td>
<p>(optional) Character vector with column(s) of <code>data</code> 
containing variable(s) to display in the label of the x-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yVar</code></td>
<td>
<p>String with column of <code>data</code> containing y-variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yLab</code></td>
<td>
<p>String with label for <code>xVar</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yLabVar</code></td>
<td>
<p>(optional) Character vector with column(s) of <code>data</code> 
containing variable(s) to display in the label of the y-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xErrorVar, yErrorVar</code></td>
<td>
<p>String with variable of <code>data</code>
containing the width of the interval (from
the center of the interval) for
horizontal or vertical intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xErrorLab, yErrorLab</code></td>
<td>
<p>String with labels
for <code>xErrorVar</code>/<code>yErrorVar</code> variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xLabVars</code></td>
<td>
<p>(vertical error bars) 
Character vector with variable(s) to be displayed 
as the labels of the ticks in the x-axis.<br>
By default, <code>xVar</code> is displayed.<br>
In case the variable(s) contain different elements 
by <code>xVar</code>, they are combined
and displayed below each other.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xAxisLab, yAxisLab</code></td>
<td>
<p>Label for the x/y-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colorVar</code></td>
<td>
<p>(optional) String with color variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colorLab</code></td>
<td>
<p>String with label for <code>colorVar</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colorPalette</code></td>
<td>
<p>(optional) Named character vector with color palette.
If not specified, the viridis color palette is used.<br>
See <code>clinColors</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shapeVar</code></td>
<td>
<p>(optional) String with shape variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shapeLab</code></td>
<td>
<p>String with label for <code>shapeVar</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shapePalette</code></td>
<td>
<p>(optional) Named character vector with 
shape palette, <code>clinShapes</code>
by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>Integer with size of markers in pixels, 
6 by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>String with title for the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>titleExtra</code></td>
<td>
<p>String with extra title for the plot (appended after <code>title</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subtitle</code></td>
<td>
<p>String with subtitle.<br>
The subtitle is included at the top left of the plot,
below the title.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>caption</code></td>
<td>
<p>String with caption. <br>
The caption is included at the bottom right of the plot.
Please note that this might overlap with 
vertical or rotated x-axis labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labelVars</code></td>
<td>
<p>Named character vector containing variable labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode</code></td>
<td>
<p>String with the mode of the plot,
'markers' by default, so only data points are displayed. <br>
This can also be set to 'lines' to include a line connecting
the center of the error bars instead; or 'lines+markers' 
to include both a marker and a line.<br>
See <code>mode</code> attribute for plotly scatter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legendPosition</code></td>
<td>
<p>String with position of the legend,
among: 'top'/'left'/'bottom'/'right', 'bottom' by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>Numeric, width of the plot in pixels,
800 by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>height</code></td>
<td>
<p>Numeric, height of the plot in pixels,
500 by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pathVar</code></td>
<td>
<p>String with variable of <code>data</code> containing hyperlinks 
with path to the subject-specific report, formatted as: <br></p>
<pre>&lt;a href="./path-to-report"&gt;label&lt;/a&gt;</pre>
<p>.<br> 
If multiple, they should be separated by: ', '.<br>
The report(s) will be:
</p>

<ul>
<li>
<p> compressed to a zip file and downloaded 
if the user clicks on the 'p' (a.k.a 'profile') key
when hovering on a point of the plot
</p>
</li>
<li>
<p> included in a collapsible row, and clickable with hyperlinks
in the table
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pathLab</code></td>
<td>
<p>String with label for <code>pathVar</code>,
included in the collapsible row in the table.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hoverVars</code></td>
<td>
<p>Character vector with variable(s) to be displayed in the hover,
by default any position (and axis) and aesthetic variables displayed in the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hoverLab</code></td>
<td>
<p>Named character vector with labels for <code>hoverVars</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>String with general id for the plot:
</p>

<ul>
<li>
<p> 'id' is used as <code>group</code> for the <code>SharedData</code>
</p>
</li>
<li>
<p> 'button:[id]' is used as button ID if <code>table</code> is TRUE
</p>
</li>
</ul>
<p>If not specified, a random id, as 'plotClinData[X]' is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selectVars</code></td>
<td>
<p>(optional) Character vector with variable(s) from <code>data</code>
for which a selection box should be included. This enables to select the data
displayed in the plot (and associated table).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selectLab</code></td>
<td>
<p>(Named) character vector with label for <code>selectVars</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>table</code></td>
<td>
<p>Logical, if TRUE (FALSE by default)
returns also a <code>datatable</code> containing the plot data.
(The plot and the table are not linked.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tableVars</code></td>
<td>
<p>Character vector with variables to be included 
in the table.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tableLab</code></td>
<td>
<p>Named character vector with labels
for each <code>tableVars</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tableButton</code></td>
<td>
<p>Logical, if TRUE (by default)
the table is included within an HTML button.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tablePars</code></td>
<td>
<p>List with parameters passed to the
<code>getClinDT</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>watermark</code></td>
<td>
<p>(optional) String with path to a file containing a watermark.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical, if TRUE (FALSE by default) progress messages are printed
in the current console.
For the visualizations, progress messages during download
of subject-specific report are displayed in the browser console.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Either:
</p>

<ul>
<li>
<p> if a <code>table</code> is requested: a <code>clinDataReview</code> object, 
a.k.a a list with the 'plot' (<code>plotly</code> object) and 'table'
(<code>datatable</code> object)
</p>
</li>
<li>
<p> otherwise: a <code>plotly</code> object
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Laure Cougnaud
</p>


<h3>See Also</h3>

<p>Other visualizations of summary statistics for clinical data: 
<code>barplotClinData()</code>,
<code>boxplotClinData()</code>,
<code>plotCountClinData()</code>,
<code>sunburstClinData()</code>,
<code>treemapClinData()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(clinUtils)

data(dataADaMCDISCP01)
labelVars &lt;- attr(dataADaMCDISCP01, "labelVars")

## Summary plot with vertical error bars

dataVSDIABP &lt;- subset(dataADaMCDISCP01$ADVS, 
	PARAMCD == "DIABP" &amp; ANL01FL == "Y" &amp;
	AVISIT %in% c("Baseline", "Week 2", "Week 4", "Week 6", "Week 8")
)

# compute summary statistics by visit
if (requireNamespace("inTextSummaryTable", quietly = TRUE)) {
	
summaryTableVSDIABP &lt;- inTextSummaryTable::computeSummaryStatisticsTable(
	data = dataVSDIABP,
	rowVar = c("AVISIT", "ATPT"),
	var = "AVAL",
	stats = inTextSummaryTable::getStats(c("n", "Mean", "SE")),
	labelVars = labelVars
)
dataPlot &lt;- subset(summaryTableVSDIABP, !isTotal)

errorbarClinData(
	data = dataPlot,
	xVar = "AVISIT",
	colorVar = "ATPT",
	# use non-rounded statistics for the plot
	yVar = "statMean", yErrorVar = "statSE", 
	yLab = "Mean", yErrorLab = "Standard Error",
	# include lines connecting the error bars
	mode = "markers+lines",
	labelVars = labelVars
)

# add number of subjects in labels
dataPlot$nSubj &lt;- with(dataPlot, paste0("N=", n))
errorbarClinData(
	data = dataPlot,
	xVar = "AVISIT", 
	xLabVars = c("AVISIT", "nSubj"),
	colorVar = "ATPT",
	yVar = "statMean", yLab = "Mean",
	yErrorVar = "statSE", yErrorLab = "Standard error",
	mode = "markers+lines",
	title = paste("Diastolic Blood Pressure summary profile by actual visit",
		"and analysis timepoint"),
	labelVars = labelVars
)

## Add a selection box
if(interactive()){
  summaryTable &lt;- inTextSummaryTable::computeSummaryStatisticsTable(
    data = subset(dataADaMCDISCP01$ADVS, 
      ANL01FL == "Y" &amp;
      AVISIT %in% c("Baseline", "Week 2", "Week 4", "Week 6", "Week 8")
    ),
    rowVar = c("PARAM", "AVISIT", "ATPT"),
    var = "AVAL",
    stats = inTextSummaryTable::getStats(c("Mean", "SE")),
    labelVars = labelVars
  )
  dataPlot &lt;- subset(summaryTable, !isTotal)
  errorbarClinData(
    data = dataPlot,
    xVar = "AVISIT", 
    colorVar = "ATPT",
    yVar = "statMean", yLab = "Mean",
    yErrorVar = "statSE", yErrorLab = "Standard error",
    mode = "markers+lines",
    title = paste("Lab parameters summary profile by actual visit",
      "and analysis timepoint"),
    labelVars = labelVars,
    selectVars = "PARAM"
  )
}

## Summary plot with horizontal error bars

# Data of interest: ratio from baseline at week 16
dataLBW8 &lt;- subset(dataADaMCDISCP01$ADLBC, grepl("Week 8", AVISIT))
# compute ratio from baseline
dataLBW8$R2BASE &lt;- with(dataLBW8, AVAL/BASE) 
dataLBW8 &lt;- subset(dataLBW8, !is.na(R2BASE))
# Order actual treatments
dataLBW8$TRTA &lt;- with(dataLBW8, reorder(TRTA, TRTAN))

# compute summary statistics of the ratio per baseline per parameter
summaryTableLBW8 &lt;- inTextSummaryTable::computeSummaryStatisticsTable(
	data = dataLBW8,
	var = "R2BASE",
	rowVar = "PARAM",
	colVar = "TRTA",
	stats = inTextSummaryTable::getStats(x = dataLBW8$R2BASE, type = c("n", "Median", "SD"))
)
dataPlot &lt;- subset(summaryTableLBW8, !isTotal)
# extract direction of ratio
dataPlot$dir &lt;- factor(
	ifelse(dataPlot$statMedian &gt;= 1, "Increase", "Decrease"),
	levels = c("Decrease", "Increase")
)
# compute relative ratio (percentage above 1)
dataPlot$statMedianRelative &lt;- with(dataPlot,
	ifelse(statMedian &lt; 1, 1/statMedian, statMedian)
)
# order based on mean relative ratio across treatment arms
params &lt;- names(sort(with(dataPlot, tapply(statMedianRelative, PARAM, mean))))
dataPlot$PARAM &lt;- factor(dataPlot$PARAM, levels = params)
errorbarClinData(
	data = dataPlot,
	xVar = "statMedianRelative", xErrorVar = "statSD",
	xLab = "Median", xErrorLab = "Standard deviation",
	xAxisLab = "Relative ratio from baseline (Median +- SD)",
	yVar = "PARAM",
	colorVar = "TRTA",
	shapeVar = "dir", shapeLab = "Direction of ratio",
	shapePalette = c(`Decrease` = 25, `Increase` = 24),
	size = 10,
	labelVars = labelVars,
	title = "Summary ratio from baseline at week 8 by treatment"
)

}

</code></pre>


</div>