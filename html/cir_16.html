<div class="container">

<table style="width: 100%;"><tr>
<td>plot.DRtrace</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plotting Methods for DRtrace, doseResponse Objects</h2>

<h3>Description</h3>

<p>Plotting methods for <code>doseResponse</code> and <code>DRtrace</code> classes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'DRtrace'
plot(
  x,
  xlab = "Patient Order",
  ylab = "Dose",
  shape = "circle",
  connect = TRUE,
  mcol = 1,
  dosevals = NULL,
  offset = 0.2,
  ...
)

## S3 method for class 'doseResponse'
plot(
  x,
  xlab = "Dose",
  ylab = "Response",
  pch = "X",
  varsize = TRUE,
  refsize = sqrt(1/mean(x$weight)),
  connect = FALSE,
  mcol = 1,
  dosevals = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the object, whether DRtrace or doseResponse</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab</code></td>
<td>
<p>x-axis and y-axis labels passed on to <code>plot</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape</code></td>
<td>
<p>the plotting shape (DRtrace only): 'circle' (default), 'square', or 'triangle'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>connect</code></td>
<td>
<p>logical: whether to connect the symbols (generic plotting type 'b'). Default <code>TRUE</code> for <code>DRtrace</code> and <code>FALSE</code> for <code>doseResponse</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcol</code></td>
<td>
<p>The color of the main plotting symbols and connecting lines. Default 1 (the current palette's first color). Note: if you change the color and inadvertently use <code>col</code> instead, there will be an error message.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dosevals</code></td>
<td>
<p>Dose values to be plotted along the x-axis (<code>plot.doseResponse</code>) or y-axis (<code>plot.DRtrace</code>) . If <code>NULL</code> (default), those will be the doses in the dataset (i.e.,<code>sort(unique(x$x))</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>(<code>DRtrace</code> only) In case of a cohort-based experiment, the relative vertical offset between symbols for outcomes within the same cohort (as fraction of dose spacing). Default 0.2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments passed on to <code>plot</code>.
</p>
<p>Conversely, putting values on a different scale into <code>dosevals</code>, or even text labels instead of numbers, won't work. For the former, change the scale at the source data (i.e., in the plotted object). For the latter, sorry but no solution at present.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>
<p>the plotting character (doseResponse only), the default being 'X' marks</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varsize</code></td>
<td>
<p>(<code>doseResponse</code> only) logical, should symbol size vary by sample size? Default <code>TRUE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>refsize</code></td>
<td>
<p>(<code>doseResponse</code> only) a reference size by which the plotting sizes will be multiplied. Default is <code>1/sqrt(mean(dr$weight))</code>, scaled so that if <code>varsize = TRUE</code> the weighted-average symbol size is 1. If <code>varsize = FALSE</code>, this argument is equivalent to <code>cex</code> in an ordinary x-y <code>plot()</code> call.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Generic methods for dose-response trajectory/trace (<code>DRtrace</code>), and dose-response summary  (<code>doseResponse</code>) class objects.
The <code>DRtrace</code> plotting uses the typical convention of plotting dose-finding experimental trace, with dose levels (x) in the vertical axis and 1/0 responses (y) denoted via filled/empty circles, respectively. In other words, this generic plotting method is only relevant for binary 0/1 outcomes.
The <code>doseResponse</code> plotting has response rate on the y-axis and dose on the x-axis, and plots symbols whose area is proportional to the weights.
</p>


<h3>Author(s)</h3>

<p>Assaf P. Oron <code>&lt;assaf.oron.at.gmail.com&gt;</code>
</p>


<h3>See Also</h3>

<p><code>doseResponse</code>, <code>DRtrace</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Summary of raw data from the notorious Neuenschwander et al. (Stat. Med., 2008) trial
## Note the use of the 'cohort' argument to specify the cohort order
neundatTrace = DRtrace(x = c(rep(1:4,each=4), 7, 7, rep(6,9)),
                       y = c(rep(0,16), 1,1, rep(c(0,0,1),2), 0,0,0), 
                       cohort = rep(1:8, c(4,4,4,4, 2, 3,3,3)) )
par(mar=c(3,3,3,1), mgp=c(2,.5,0), tcl=-0.25)
layout(t(1:2))
plot(neundatTrace ,main="N. et al. (2008) Cohort Trace", xlab = 'Cohort', 
          ylab="Ordinal Dose Level" ,cex.main=1.5)

## Same data, in 'doseResponse' format with actual doses rather than dose levels
neundatDose = doseResponse(x=c(1,2.5,5,10,20,25), y = c(rep(0,4),2/9,1), wt = c(3,4,5,4,9,2) )
plot(neundatDose ,main="N. et al. (2008) Final Dose-Toxicity", ylim=c(0,1),
	xlab="Dose (mg/sq.m./wk)", ylab="Toxicity Response Curve (F)", cex.main=1.5)
## We can also convert the DRtrace object to doseResponse...
neundatLevel = doseResponse(neundatTrace)

### Now plotting the former, vs. IR/CIR estimates
neunCIR0 = cirPAVA(neundatDose,full=TRUE, adaptiveShrink = TRUE, target = 0.3)
lines(neunCIR0$shrinkage$x, neunCIR0$shrinkage$y, type='b' ,pch=19)
legend(1,1, pch=c(4,19), legend=c('Observations', 'CIR w/bias corr.'), bty='n')
</code></pre>


</div>