<div class="container">

<table style="width: 100%;"><tr>
<td>TotalSpellTimeExceedingThreshold</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Total Spell Time Exceeding Threshold</h2>

<h3>Description</h3>

<p>The number of days (when daily data is provided) that are part of a spell 
(defined by its minimum length e.g. 6 consecutive days) that exceed (or not 
exceed) a threshold are calculated with <code>TotalSpellTimeExceedingThreshold</code>.
This function allows to compute indicators widely used in Climate Services, 
such as:
</p>

<ul><li>
<p>'WSDI', Warm Spell Duration Index that count the total number of days 
with at least 6 consecutive days when the daily temperature 
maximum exceeds its 90th percentile.
</p>
</li></ul>
<p>This function requires the data and the threshold to be in the same units. The 
90th percentile can be translate into absolute values given a reference 
dataset using function <code>Threshold</code> or the data can be transform into 
probabilites by using function <code>AbsToProbs</code>. See section @examples.
</p>


<h3>Usage</h3>

<pre><code class="language-R">TotalSpellTimeExceedingThreshold(
  data,
  threshold,
  spell,
  op = "&gt;",
  dates = NULL,
  start = NULL,
  end = NULL,
  time_dim = "time",
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A multidimensional array with named dimensions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>If only one threshold is used: it can be a multidimensional 
array with named dimensions. It must be in the same units and with the 
common dimensions of the same length as parameter 'data'. It can also be a
vector with the same length of 'time_dim' from 'data' or a scalar. If we 
want to use two thresholds: it can be a vector of two scalars, a list of 
two vectors with the same length of 'time_dim' from 'data' or a list of 
two multidimensional arrays with the common dimensions of the same length 
as parameter 'data'. If two thresholds are used, parameter 'op' must be 
also a vector of two elements.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spell</code></td>
<td>
<p>A scalar indicating the minimum length of the spell.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>op</code></td>
<td>
<p>An operator '&gt;' (by default), '&lt;', '&gt;=' or '&lt;='. If  two thresholds
are used it has to be a vector of a pair of two logical operators: 
c('&lt;', '&gt;'), c('&lt;', '&gt;='), c('&lt;=', '&gt;'), c('&lt;=', '&gt;='), c('&gt;', '&lt;'), 
c('&gt;', '&lt;='), c('&gt;=', '&lt;'),c('&gt;=', '&lt;=')).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dates</code></td>
<td>
<p>A multidimensional array of dates with named dimensions matching 
the temporal dimensions on parameter 'data'. By default it is NULL, to  
select aperiod this parameter must be provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>An optional parameter to defined the initial date of the period 
to select from the data by providing a list of two elements: the initial 
date of the period and the initial month of the period. By default it is set
to NULL and the indicator is computed using all the data provided in 
<code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>end</code></td>
<td>
<p>An optional parameter to define the final date of the period to 
select from the data by providing a list of two elements: the final day of 
the period and the final month of the period. By default it is set to NULL 
and the indicator is computed using all the data provided in <code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time_dim</code></td>
<td>
<p>A character string indicating the name of the dimension to 
compute the indicator. By default, it is set to 'time'. It can only
indicate one time dimension.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>An integer indicating the number of cores to use in parallel 
computation.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function considers NA values as the end of the spell. For a 
different behaviour consider to modify the 'data' input by substituting NA 
values by values exceeding the threshold.
</p>


<h3>Value</h3>

<p>A multidimensional array with named dimensions containing the number 
of days that are part of a spell within a threshold with dimensions of the 
input parameter 'data' except the dimension where the indicator has been 
computed.
</p>


<h3>See Also</h3>

<p>[Threshold()] and [AbsToProbs()].
</p>


<h3>Examples</h3>

<pre><code class="language-R">data &lt;- array(1:100, c(member = 5, sdate = 3, time = 214, lon = 2))
Dates &lt;- c(seq(as.Date("01-05-2000", format = "%d-%m-%Y"), 
              as.Date("30-11-2000", format = "%d-%m-%Y"), by = 'day'),
          seq(as.Date("01-05-2001", format = "%d-%m-%Y"), 
              as.Date("30-11-2001", format = "%d-%m-%Y"), by = 'day'),
          seq(as.Date("01-05-2002", format = "%d-%m-%Y"), 
              as.Date("30-11-2002", format = "%d-%m-%Y"), by = 'day'))
dim(Dates) &lt;- c(sdate = 3, time = 214)

threshold &lt;- array(1:4, c(lat = 4))
total &lt;- TotalSpellTimeExceedingThreshold(data, threshold, dates = Dates, 
                                         spell = 6, start = list(21, 4), 
                                         end = list(21, 6))

</code></pre>


</div>