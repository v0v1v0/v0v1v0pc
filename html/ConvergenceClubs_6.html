<div class="container">

<table style="width: 100%;"><tr>
<td>coreG</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Find core (primary) group</h2>

<h3>Description</h3>

<p>Find the Core (primary) group according to step 2 of the clustering algorithm
by Phillips and Sul (2007, 2009)
</p>


<h3>Usage</h3>

<pre><code class="language-R">coreG(
  X,
  dataCols,
  time_trim,
  threshold = -1.65,
  HACmethod = c("FQSB", "AQSB"),
  type = c("max", "all")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>dataframe containing data (preferably filtered data in order to remove business cycles).
Data must not contain any NA or NaN values, otherwise the clustering procedure will be stopped with an error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataCols</code></td>
<td>
<p>integer vector with the column indices of the data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time_trim</code></td>
<td>
<p>a numeric value between 0 and 1, representing the portion of
time periods to trim when running log t regression model.
Phillips and Sul (2007, 2009) suggest to discard the first third of the period.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>numeric value indicating the threshold to be used to perform
the one-tail t test; default is -1.65.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>HACmethod</code></td>
<td>
<p>string indicating whether a Fixed Quadratic Spheric Bandwidth (<code>HACmethod="FQSB"</code>) or
an Adaptive Quadratic Spheric Bandwidth (<code>HACmethod="AQSB"</code>) should be used for the truncation
of the Quadratic Spectral kernel in estimating the <em>log t</em> regression model
with heteroskedasticity and autocorrelation consistent standard errors.
The default method is "FQSB".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>one of "max" or "all";
"max" includes only the region with maximum t-value. The default option is "max";
"all" includes all units that pass the test t in the core formation (step 2).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>According to the second step of the Phillips and Sul clustering algorithm (2007, 2009),
the <em>log t</em> regression should be run for the first k units <code class="reqn">2 &lt; k &lt; N</code>
maximizing k under the condition that <code class="reqn">t-value &gt; -1.65</code>.
In other words, the core group size <code class="reqn">k^*</code> is chosen as follows:
</p>
<p style="text-align: center;"><code class="reqn"> k^* = argmax_{k} \{t_k\} </code>
</p>
<p>  subject to
</p>
<p style="text-align: center;"><code class="reqn">\min{t_k} &gt; -1.65</code>
</p>

<p>Such behavior is obtained with <code>type="max"</code>; if <code>type="all"</code>,
all units that satisfy <code class="reqn">t_k &gt; -1.65</code> are added to core group.
</p>
<p>If the condition <code class="reqn">t_k &gt; -1.65</code> does not hold for <code class="reqn">k = 2</code> (the first two units),
the algorithm drops the first unit and repeats the same procedure for the next pair of units.
If <code class="reqn">t_k &gt; -1.65</code> does not hold for any couple of units, the whole panel diverges.
</p>


<h3>Value</h3>

<p>A numeric vector containing the row indices of the units included
in the core group; if a core group cannot be found, returns <code>FALSE</code>.
</p>


<h3>References</h3>

<p>Phillips, P. C.; Sul, D., 2007. Transition modeling and econometric convergence tests. Econometrica 75 (6), 1771-1855.
</p>
<p>Phillips, P. C.; Sul, D., 2009. Economic transition and growth. Journal of Applied Econometrics 24 (7), 1153-1185.
</p>


</div>