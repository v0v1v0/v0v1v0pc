<div class="container">

<table style="width: 100%;"><tr>
<td>hclustgeo</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Ward clustering with soft contiguity contraints</h2>

<h3>Description</h3>

<p>Implements a Ward-like hierarchical clustering 
algorithm including soft contiguity constraints. The algorithm takes as
input two dissimilarity matrices <code>D0</code> and <code>D1</code> and a mixing 
parameter alpha between 0 an 1. The dissimilarities can be non euclidean 
and the weights of the observations can be non uniform. The first matrix 
gives the dissimilarities in the "feature space". The second matrix gives 
the dissimilarities in the  "constraint" space. For instance, <code>D1</code>
can be a matrix of geographical distances or a matrix  build from 
a contiguity matrix. The mixing parameter <code>alpha</code> sets the importance 
of the constraint in the clustering process.
</p>


<h3>Usage</h3>

<pre><code class="language-R">hclustgeo(D0, D1 = NULL, alpha = 0, scale = TRUE, wt = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>D0</code></td>
<td>
<p>an object of class <code>dist</code> with the dissimilarities between the n observations. 
The function <code>as.dist</code> can be used to transform an object of 
class <code>matrix</code> to object of class <code>dist</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D1</code></td>
<td>
<p>an object of class "dist" with other dissimilarities between the 
same n observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>a real value between 0 and 1. This mixing parameter gives the 
relative importance of <code>D0</code> compared to <code>D1</code>.
By default, this parameter is equal to 0 and <code>D0</code> is used alone in the
clustering process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>if TRUE the two dissimilarity matric <code>D0</code> and <code>D1</code> 
are scaled i.e. divided by their max. If <code>D1</code>=NULL, this parameter 
is no used and D0 is not scaled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wt</code></td>
<td>
<p>vector with the weights of the observations. By default, wt=NULL corresponds to
the case where all observations are weighted by 1/n.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The criterion minimized at each stage is a convex combination of
the homogeneity criterion calculated with <code>D0</code> and the homogeneity 
criterion calculated with <code>D1</code>. The parameter <code>alpha</code> (the weight
of this convex combination) controls the importance of the constraint 
in the quality of the solutions. When <code>alpha</code> increases, 
the homogeneity calculated with <code>D0</code> decreases whereas the
homogeneity calculated with <code>D1</code> increases.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>hclust</code>.
</p>


<h3>References</h3>

<p>M. Chavent, V. Kuentz-Simonet, A. Labenne, J. Saracco. ClustGeo: an R package
for hierarchical clustering with spatial constraints.
Comput Stat (2018) 33: 1799-1822.
</p>


<h3>See Also</h3>

<p><code>choicealpha</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(estuary)
# with one dissimilarity matrix
w &lt;- estuary$map@data$POPULATION # non uniform weights 
D &lt;- dist(estuary$dat)
tree &lt;- hclustgeo(D,wt=w)
sum(tree$height)
inertdiss(D,wt=w)
inert(estuary$dat,w=w)
plot(tree,labels=FALSE)
part &lt;- cutree(tree,k=5)
sp::plot(estuary$map, border = "grey", col = part)

# with two dissimilarity matrix
D0 &lt;- dist(estuary$dat) # the socio-demographic distances
D1 &lt;- as.dist(estuary$D.geo) # the geographical distances
alpha &lt;- 0.2 # the mixing parameter
tree &lt;- hclustgeo(D0,D1,alpha=alpha,wt=w)
plot(tree,labels=FALSE)
part &lt;- cutree(tree,k=5)
sp::plot(estuary$map, border = "grey", col = part)

</code></pre>


</div>