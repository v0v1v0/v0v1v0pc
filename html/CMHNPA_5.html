<div class="container">

<table style="width: 100%;"><tr>
<td>CMH</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>CMH Test</h2>

<h3>Description</h3>

<p><code>CMH</code> returns the test statistics and p-values for the four CMH tests.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CMH(
  treatment,
  response,
  strata = NULL,
  a_ij = NULL,
  b_hj = NULL,
  test_OPA = TRUE,
  test_GA = TRUE,
  test_MS = TRUE,
  test_C = TRUE,
  cor_breakdown = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>treatment</code></td>
<td>
<p>a factor vector representing the treatment applied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>
<p>a factor vector giving the response category for the
corresponding elements of <code>treatment</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strata</code></td>
<td>
<p>a factor vector giving the strata or block for the
corresponding elements of <code>treatment</code> and <code>response</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a_ij</code></td>
<td>
<p>a t x b matrix of treatment scores. The matrix allows for
different scores to be used over different strata. If a t x 1 vector of
scores is provided, it is assumed that the scores are the same across strata
and a warning provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b_hj</code></td>
<td>
<p>a c x b matrix of response scores. The matrix allows for
different scores to be used over different strata. If a c x 1 vector of
scores is provided, it is assumed that the scores are the same across strata
and a warning provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test_OPA</code></td>
<td>
<p>TRUE or FALSE flag to include the calculation of the OPA
test values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test_GA</code></td>
<td>
<p>TRUE or FALSE flag to include the calculation of the GA
test values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test_MS</code></td>
<td>
<p>TRUE or FALSE flag to include the calculation of the MS
test values. If response scores are not included, this test will not be
performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test_C</code></td>
<td>
<p>TRUE or FALSE flag to include the calculation of the C
test values. If response scores and treatment scores are not included, this
test will not be performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cor_breakdown</code></td>
<td>
<p>TRUE or FALSE flag to indicate if a correlation
breakdown over the strata is required.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Provided the required information is used in the function, the function will
return all four CMH test results.
</p>


<h3>Value</h3>

<p>The CMH test results for the four tests assuming the required
information is supplied.
</p>


<h3>References</h3>

<p>Rayner, J.C.W and Livingston, G. C. (2022). An Introduction to Cochran-Mantel-Haenszel Testing and Nonparametric ANOVA. Wiley.
</p>


<h3>Examples</h3>

<pre><code class="language-R">CMH(treatment = marriage$religion, response = marriage$opinion,
strata = marriage$education, test_OPA = FALSE, test_MS = FALSE)
</code></pre>


</div>