<div class="container">

<table style="width: 100%;"><tr>
<td>CUBE</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Main function for CUBE models</h2>

<h3>Description</h3>

<p>Main function to estimate and validate a CUBE model for given ratings,
explaining uncertainty, feeling and overdispersion.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CUBE(Formula,data,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Formula</code></td>
<td>
<p>Object of class Formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data frame from which model matrices and response variables are taken.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to be passed for the specification of the model, Including Y, W, Z for
explanatory variables for uncertainty, feeling and overdispersion. Set expinform=TRUE if inference should
be based on expected information matrix for model with no covariate. Set starting = ... to pass initial
values for EM iterations.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>It is the main function for CUBE models, calling for the corresponding functions whenever
covariates are specified: it is possible to select covariates for explaining all the three parameters
or only the feeling component. <br>
The program also checks if the estimated variance-covariance matrix is positive definite: if not,
it prints a warning message and returns a matrix and related results with NA entries.
The optimization procedure is run via "optim". If covariates are included only for feeling,
the variance-covariance matrix is computed as the inverse of the returned numerically differentiated
Hessian matrix (option: hessian=TRUE as argument for "optim"), and the estimation procedure is not
iterative, so a NULL result for $niter is produced.
If the estimated variance-covariance matrix is not positive definite, the function returns a
warning message and produces a matrix with NA entries.
</p>


<h3>Value</h3>

<p>An object of the class "GEM"-"CUBE" is a list containing the following results:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>estimates</code></td>
<td>
<p>Maximum likelihood estimates: <code class="reqn">(\pi, \xi, \phi)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>Log-likelihood function at the final estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varmat</code></td>
<td>
<p>Variance-covariance matrix of final estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niter</code></td>
<td>
<p>Number of executed iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BIC</code></td>
<td>
<p>BIC index for the estimated model</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Iannario M. (2014). Modelling Uncertainty and Overdispersion in Ordinal Data,
<em>Communications in Statistics - Theory and Methods</em>, <b>43</b>, 771–786 <br>
Piccolo D. (2015). Inferential issues for CUBE models with covariates,
<em>Communications in Statistics. Theory and Methods</em>, <b>44</b>(23), 771–786. <br>
Iannario M. (2015). Detecting latent components in ordinal data with overdispersion by means
of a mixture distribution, <em>Quality &amp; Quantity</em>, <b>49</b>, 977–987 <br>
Iannario M. (2016). Testing the overdispersion parameter in CUBE models.
<em>Communications in Statistics: Simulation and Computation</em>, <b>45</b>(5), 1621–1635.<br></p>


<h3>See Also</h3>

<p><code>probcube</code>, <code>loglikCUBE</code>, <code>loglikcuben</code>,  <code>inibestcube</code>,
<code>inibestcubecsi</code>, <code>inibestcubecov</code>,
<code>varmatCUBE</code>
</p>


</div>