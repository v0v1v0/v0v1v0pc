<div class="container">

<table style="width: 100%;"><tr>
<td>anomaly_map</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>A 'cmsaf' extension for creating an anomaly map.</h2>

<h3>Description</h3>

<p>This plotting routine generates a graph showing the anomaly of a
given variable within the given time range and area. The intended
application is for daily accumulated data, such as sunshine duration.
Dependent on the output format a PNG or MP4 is created.
</p>


<h3>Usage</h3>

<pre><code class="language-R">anomaly_map(
  config = NULL,
  variable = NULL,
  accumulate = FALSE,
  mean_value = FALSE,
  infile = NULL,
  temp_dir = tempdir(),
  out_dir = getwd(),
  climate_dir = NULL,
  climate_year_start = 1983,
  climate_year_end = 2018,
  start_date = NULL,
  end_date = NULL,
  country_code = "S_A",
  lon_min = NULL,
  lon_max = NULL,
  lat_min = NULL,
  lat_max = NULL,
  outfile_name = NULL,
  output_format = "animation",
  animation_pace = 0.07,
  freeze_animation = FALSE,
  min_value = NULL,
  max_value = NULL,
  color_pal = 1,
  relative = FALSE,
  nbreaks = NULL,
  language = "eng",
  keep_files = TRUE,
  states = FALSE,
  attach = FALSE,
  infile_attach = "auto",
  dwd_logo = FALSE,
  verbose = TRUE,
  nc = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>config</code></td>
<td>
<p>Path to YAML config file (character). The config file does not have
to specify all arguments. Each addressed argument has to be formatted according to the example config file: (#TODO: LINK EXAMPLE CONFIG FILE!).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variable</code></td>
<td>
<p>Name of variable in infile (<code>NULL</code> or character). If <code>NULL</code> then the first variable from the infile is taken.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accumulate</code></td>
<td>
<p>Whether the input file should be accumulated (logical).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean_value</code></td>
<td>
<p>Whether the input file should be averaged (logical).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>infile</code></td>
<td>
<p>Path to NetCDF file (<code>NULL</code> or character). If <code>NULL</code> then it needs to be specified in the config file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>temp_dir</code></td>
<td>
<p>Path to temporary working directory (character).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out_dir</code></td>
<td>
<p>Path to output directory (character).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>climate_dir</code></td>
<td>
<p>Path to directory in which climatology is computed or contained (<code>NULL</code> or character). If <code>NULL</code> then the temp_dir directory is taken.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>climate_year_start</code></td>
<td>
<p>Start year of climatology (integer).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>climate_year_end</code></td>
<td>
<p>End year of climatology (integer).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start_date</code></td>
<td>
<p>Start date in format of 'YYYY-MM-DD' (<code>NULL</code> or character). If <code>NULL</code> then the first date of the infile is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>end_date</code></td>
<td>
<p>End date in format of 'YYYY-MM-DD' (<code>NULL</code> or character). If <code>NULL</code> then the last date of the infile is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>country_code</code></td>
<td>
<p>Either a country code in iso3c format or from the following: 'AFR' for Africa, 'EUR' for Europe, 'TOT' for the total disc,
or 'S_A' for an arbitrary region selection (character). If a country is passed the data from within this country is extracted,
else a rectangular box is visualized. Directly provided latitude and longitude ranges will be ignored in case of 'AFR', 'EUR' or 'TOT'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lon_min</code></td>
<td>
<p>Longitude of lower left corner (<code>NULL</code> or numeric). If <code>NULL</code> then the smallest longitude of the infile is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lon_max</code></td>
<td>
<p>Longitude of upper right left corner (<code>NULL</code> or numeric). If <code>NULL</code> then the largest longitude of the infile is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lat_min</code></td>
<td>
<p>Latitude of lower left corner (<code>NULL</code> or numeric). If <code>NULL</code> then the smallest latitude of the infile is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lat_max</code></td>
<td>
<p>Latitude of upper right corner (<code>NULL</code> or numeric). If <code>NULL</code> then the largest latitude of the infile is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outfile_name</code></td>
<td>
<p>Filename of the PNG or MP4 outfile (<code>NULL</code> or character).
If <code>NULL</code> then a name is computed from the current configuration.
Please match the file ending according to the output_format.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output_format</code></td>
<td>
<p>Specification of output format (either 'graphic' for PNG or 'animation' for MP4).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>animation_pace</code></td>
<td>
<p>Pace of the animation in seconds (positive numeric). This only has an effect if <code>output_format == 'animation'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freeze_animation</code></td>
<td>
<p>If TRUE then the animation will freeze at the last frame (logical).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_value</code></td>
<td>
<p>Lower values than this are ignored (<code>NULL</code> or numeric). If <code>NULL</code>, no values are ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_value</code></td>
<td>
<p>Larger values than this are ignored (<code>NULL</code> or numeric). If <code>NULL</code>, no values are ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color_pal</code></td>
<td>
<p>Color option for stripe and anomaly plots</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>relative</code></td>
<td>
<p>Use relative values for anomaly plots</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbreaks</code></td>
<td>
<p>Number of color breaks (<code>NULL</code> or positive integer). A value will be computed if <code>NULL</code> is passed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>language</code></td>
<td>
<p>Language used for title, legend, etc. in plots (either 'eng' for English or 'deu' for German).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep_files</code></td>
<td>
<p>A flag indicating whether all files created in the process of obtaining the output file should be kept (logical).
If false, all intermediate results are deleted, otherwise all are kept. Keeping these files could improve performance in further function calls.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>states</code></td>
<td>
<p>Whether to crop/plot administration level of states (logical).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>attach</code></td>
<td>
<p>Whether to temporaly merge the infile to an already existing one. (logical).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>infile_attach</code></td>
<td>
<p>File to attach the infile to. When 'auto', a suitable file will be searched in out_dir.
If attach is false, this will be ignored(character).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dwd_logo</code></td>
<td>
<p>Whether to add the DWD logo (logical).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Whether to display progress messages (logical).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nc</code></td>
<td>
<p>Alternatively to <code>infile</code> you can specify the input as an
object of class <code>ncdf4</code> (as returned from <code>ncdf4::nc_open</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>You can pass a YAML config file and / or specify the arguments directly.
Argument prioritization is done in the following way:
Direct argument &gt; config argument &gt; default argument.
Thus, if you pass a existing config file but also want to modify a specific
argument you can do that easily.
</p>


</div>