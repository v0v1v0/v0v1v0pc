<div class="container">

<table style="width: 100%;"><tr>
<td>measurementCohort</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create cohorts measurement based cohorts</h2>

<h3>Description</h3>

<p><code>measurementCohort()</code> creates cohorts based on patient records contained
in the measurement table. This function extends the <code>conceptCohort()</code> as it
allows for measurement values associated with the records to be specified.
</p>

<ul>
<li>
<p> If <code>valueAsConcept</code> and <code>valueAsNumber</code> are NULL then no requirements on
of the values associated with measurement records and using
<code>measurementCohort()</code> will lead to the same result as using <code>conceptCohort()</code>
(so long as all concepts are from the measurement domain).
</p>
</li>
<li>
<p> If one of <code>valueAsConcept</code> and <code>valueAsNumber</code> is not NULL then records
will be required to have values that satisfy the requirement specified.
</p>
</li>
<li>
<p> If both <code>valueAsConcept</code> and <code>valueAsNumber</code> are not NULL, records will
be required to have values that fulfill <em>either</em> of the requirements
</p>
</li>
</ul>
<h3>Usage</h3>

<pre><code class="language-R">measurementCohort(
  cdm,
  conceptSet,
  name,
  valueAsConcept = NULL,
  valueAsNumber = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cdm</code></td>
<td>
<p>A cdm reference.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conceptSet</code></td>
<td>
<p>A conceptSet, which can either be a codelist
or a conceptSetExpression.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>Name of the new cohort table created in the cdm object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>valueAsConcept</code></td>
<td>
<p>A vector of cohort IDs used to filter measurements.
Only measurements with these values in the <code>value_as_concept_id</code> column of
the measurement table will be included. If NULL all entries independently of
their value as concept will be considered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>valueAsNumber</code></td>
<td>
<p>A named list indicating the range of values and the unit
they correspond to, as follows:
list("unit_concept_id" = c(rangeValue1, rangeValue2)). If NULL, all entries
independently of their value as number will be included.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A cohort table
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(CohortConstructor)
cdm &lt;- mockCohortConstructor(con = NULL)
cdm$concept &lt;- cdm$concept |&gt;
  dplyr::union_all(
    dplyr::tibble(
      concept_id = c(4326744, 4298393, 45770407, 8876, 4124457),
      concept_name = c("Blood pressure", "Systemic blood pressure",
                       "Baseline blood pressure", "millimeter mercury column",
                       "Normal range"),
      domain_id = "Measurement",
      vocabulary_id = c("SNOMED", "SNOMED", "SNOMED", "UCUM", "SNOMED"),
      standard_concept = "S",
      concept_class_id = c("Observable Entity", "Observable Entity",
                           "Observable Entity", "Unit", "Qualifier Value"),
      concept_code = NA,
      valid_start_date = NA,
      valid_end_date = NA,
      invalid_reason = NA
    )
  )
cdm$measurement &lt;- dplyr::tibble(
  measurement_id = 1:4,
  person_id = c(1, 1, 2, 3),
  measurement_concept_id = c(4326744, 4298393, 4298393, 45770407),
  measurement_date = as.Date(c("2000-07-01", "2000-12-11", "2002-09-08",
                                "2015-02-19")),
  measurement_type_concept_id = NA,
  value_as_number = c(100, 125, NA, NA),
  value_as_concept_id = c(0, 0, 0, 4124457),
  unit_concept_id = c(8876, 8876, 0, 0)
)
cdm &lt;- CDMConnector::copyCdmTo(
  con = DBI::dbConnect(duckdb::duckdb()),
  cdm = cdm, schema = "main")

cdm$cohort &lt;- measurementCohort(
  cdm = cdm,
  name = "cohort",
  conceptSet = list("normal_blood_pressure" = c(4326744, 4298393, 45770407)),
  valueAsConcept = c(4124457),
  valueAsNumber = list("8876" = c(70, 120))
)

cdm$cohort

</code></pre>


</div>