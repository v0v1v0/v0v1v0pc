<div class="container">

<table style="width: 100%;"><tr>
<td>copula.sim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>To generate simulated datasets from empirical data by utilizing the copula invariance property.</h2>

<h3>Description</h3>

<p>Based on the empirical data, generating simulated datasets through the copula invariance property.
</p>


<h3>Usage</h3>

<pre><code class="language-R">copula.sim(
  data.input,
  id.vec,
  arm.vec,
  n.patient,
  n.simulation,
  seed = NULL,
  validation.type = "none",
  validation.sig.lvl = 0.05,
  rmvnorm.matrix.decomp.method = "svd",
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data.input</code></td>
<td>
<p>The empirical patient-level data to be used to simulate new virtual patient data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id.vec</code></td>
<td>
<p>The ID for individual patient in the input data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arm.vec</code></td>
<td>
<p>The column to identify the arm in clinical trial.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.patient</code></td>
<td>
<p>The targeted number of patients in each simulated dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.simulation</code></td>
<td>
<p>The number of simulated datasets.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>The random seed. Default is NULL to use the current seed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>validation.type</code></td>
<td>
<p>A string to specify the hypothesis test used to detect the difference
between input data and the simulated data. Default is "none". Possible methods are
energy distance ("energy") and  ball divergence ("ball"). The R packages "energy" and "Ball" are needed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>validation.sig.lvl</code></td>
<td>
<p>The significant level (alpha) value for the hypothesis test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rmvnorm.matrix.decomp.method</code></td>
<td>
<p>The method to do the matrix decomposition used in the function <code>rmvnorm</code>. Default is "svd".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A logical value to specify whether to print message for simulation process or not.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A copula.sim object with four elements.
</p>

<ol>
<li>
<p> data.input: empirical data (wide-form)
</p>
</li>
<li>
<p> data.input.long: empirical data (long-form)
</p>
</li>
<li>
<p> data.transform: quantile transformation of data.input
</p>
</li>
<li>
<p> data.simul: simulated data
</p>
</li>
</ol>
<h3>Author(s)</h3>

<p>Pei-Shan Yen, Xuemin Gu
</p>


<h3>References</h3>

<p>Sklar, A. (1959). Functions de repartition an dimensionset leursmarges., Paris: PublInst Stat.
</p>
<p>Nelsen, R. B. (2007). An introduction to copulas. Springer Science &amp; Business Media.
</p>
<p>Ross, S. M. (2013). Simulation. Academic Press.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(copulaSim)

## Generate Empirical Data
 # Assume the 2-arm, 5-dimensional empirical data follows multivariate normal data.
library(mvtnorm)
arm1 &lt;- rmvnorm(n = 40, mean  = rep(10, 5), sigma = diag(5) + 0.5)
arm2 &lt;- rmvnorm(n = 40, mean  = rep(12, 5), sigma = diag(5) + 0.5)
test_data &lt;- as.data.frame(cbind(1:80, rep(1:2, each = 40), rbind(arm1, arm2)))
colnames(test_data) &lt;- c("id","arm",paste0("time_", 1:5))

## Generate 100 simulated datasets
copula.sim(data.input = test_data[,-c(1,2)], id.vec = test_data$id, arm.vec = test_data$arm,
n.patient = 100 , n.simulation = 100, seed = 2022)
</code></pre>


</div>