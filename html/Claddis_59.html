<div class="container">

<table style="width: 100%;"><tr>
<td>ordinate_cladistic_matrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Principal Coordinates on a Cladistic Matrix</h2>

<h3>Description</h3>

<p>Performs Principal Coordinates Analysis (PCoA) on a cladistic matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ordinate_cladistic_matrix(
  cladistic_matrix,
  distance_metric = "mord",
  ged_type = "wills",
  distance_transformation = "arcsine_sqrt",
  distance_polymorphism_behaviour = "min_difference",
  distance_uncertainty_behaviour = "min_difference",
  distance_inapplicable_behaviour = "missing",
  character_dependencies = NULL,
  alpha = 0.5,
  correction = "cailliez",
  time_tree = NULL,
  estimate_all_nodes = FALSE,
  estimate_tip_values = FALSE,
  inapplicables_as_missing = FALSE,
  ancestral_polymorphism_behaviour = "equalp",
  ancestral_uncertainty_behaviour = "equalp",
  threshold = 0.01,
  all_missing_allowed = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cladistic_matrix</code></td>
<td>
<p>A character-taxon matrix in the format imported by read_nexus_matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance_metric</code></td>
<td>
<p>See calculate_morphological_distances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ged_type</code></td>
<td>
<p>See calculate_morphological_distances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance_transformation</code></td>
<td>
<p>See calculate_morphological_distances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance_polymorphism_behaviour</code></td>
<td>
<p>See calculate_morphological_distances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance_uncertainty_behaviour</code></td>
<td>
<p>See calculate_morphological_distances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance_inapplicable_behaviour</code></td>
<td>
<p>See calculate_morphological_distances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>character_dependencies</code></td>
<td>
<p>See calculate_morphological_distances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>See calculate_morphological_distances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correction</code></td>
<td>
<p>The negative eigenvalue correction to use (one of "lingoes", "none", or "cailliez" - the default). See pcoa for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time_tree</code></td>
<td>
<p>If a phylmorphospace is desired then a tree with root age and branch-lengths must be included.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate_all_nodes</code></td>
<td>
<p>See estimate_ancestral_states.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate_tip_values</code></td>
<td>
<p>See estimate_ancestral_states.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inapplicables_as_missing</code></td>
<td>
<p>See estimate_ancestral_states.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ancestral_polymorphism_behaviour</code></td>
<td>
<p>See estimate_ancestral_states.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ancestral_uncertainty_behaviour</code></td>
<td>
<p>See estimate_ancestral_states.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>See estimate_ancestral_states.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>all_missing_allowed</code></td>
<td>
<p>See estimate_ancestral_states.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Takes a cladistic matrix in the format imported by read_nexus_matrix and performs Principal Coordinates (Gower 1966) analysis on it.
</p>
<p>This function is effectively a wrapper for the pipeline:
</p>
<p>estimate_ancestral_states -&gt; calculate_morphological_distances -&gt; pcoa
</p>
<p>With the first part being optional (if wanting a phylomorphospace) and the latter coming from the ape package (the user is referred there for some of the options, e.g., using the Caillez 1983 approach to avoiding negative eigenvalues). (See Lloyd 2016 for more on disparity pipelines.)
</p>
<p>If providing a tree and inferring ancestral states then options to also infer missing or uncertain tips and whether to infer values for all characters at all internal nodes are provided by the estimate_ancestral_states part.
</p>
<p>Other options within the function concern the distance metric to use and the transformation to be used if selecting a propotional distance (see calculate_morphological_distances).
</p>
<p>IMPORTANT: The function can remove taxa (or if including a tree, nodes as well) if they lead to an incomplete distance matrix (see trim_matrix for more details).
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>time_tree</code></td>
<td>
<p>The tree (if supplied). Note this may be pruned from the input tree by trim_matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance_matrix</code></td>
<td>
<p>The distance matrix. Note this may be pruned by trim_matrix and thus not include all taxa.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>removed_taxa</code></td>
<td>
<p>A vector of taxa and/or nodes removed by trim_matrix. Returns NULL if none were removed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>note</code></td>
<td>
<p>See pcoa.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>values</code></td>
<td>
<p>See pcoa.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vectors</code></td>
<td>
<p>See pcoa. Note: this will be the same as <code>vectors.cor</code> from the pcoa output if a correction was applied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>See pcoa. Note: this will be the same as <code>trace.cor</code> from the pcoa output if a correction was applied.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Graeme T. Lloyd <a href="mailto:graemetlloyd@gmail.com">graemetlloyd@gmail.com</a>
</p>


<h3>References</h3>

<p>Cailliez, F., 1983. The analytical solution of the additive constant problem. <em>Psychometrika</em>, <b>48</b>, 305-308.
</p>
<p>Gower, J. C., 1966. Some distance properties of latent root and vector methods used in multivariate analysis. <em>Biometrika</em>, <b>53</b>, 325-338.
</p>


<h3>See Also</h3>

<p>assign_taxa_to_bins, plot_chronophylomorphospace, plot_morphospace_stack, plot_morphospace, plot_multi_morphospace
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Run on Michaux (1989) data set with default settings:
x &lt;- ordinate_cladistic_matrix(cladistic_matrix = michaux_1989)

# Show entire output:
x

# Generate a (made up) tree:
time_tree &lt;- ape::rtree(n = length(x = rownames(x = michaux_1989$matrix_1$matrix)))

# Add taxon names to it:
time_tree$tip.label &lt;- rownames(x = michaux_1989$matrix_1$matrix)

# Set root time by making youngest taxon extant:
time_tree$root.time &lt;- max(diag(x = ape::vcv(phy = time_tree)))

# Run with tree:
y &lt;- ordinate_cladistic_matrix(cladistic_matrix = michaux_1989, time_tree = time_tree)

# Show new output:
y
</code></pre>


</div>