<div class="container">

<table style="width: 100%;"><tr>
<td>lcomCOP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>L-comoments and Bivariate L-moments of a Copula</h2>

<h3>Description</h3>

<p>Compute the <em>L-comoments</em> (Serfling and Xiao, 2007; Asquith, 2011) through the <em>bivariate L-moments (ratios)</em> (<code class="reqn">\delta^{[\ldots]}_{k;\mathbf{C}}</code>) of a copula <code class="reqn">\mathbf{C}(u,v; \Theta)</code>  The L-comoments include <em>L-correlation</em> (<em>Spearman Rho</em>), <em>L-coskew</em>, and <em>L-cokurtosis</em>.  As described by Brahimi <em>et al.</em> (2015), the first four bivariate L-moments <code class="reqn">\delta^{[12]}_k</code> for random variable <code class="reqn">X^{(1)}</code> or <code class="reqn">U</code> with respect to (<em>wrt</em>) random variable <code class="reqn">X^{(2)}</code> or <code class="reqn">V</code> are defined as
</p>
<p style="text-align: center;"><code class="reqn">\delta^{[12]}_{1;\mathbf{C}} = 2\int\!\!\int_{\mathcal{I}^2}
\mathbf{C}(u,v)\,\mathrm{d}u\mathrm{d}v - \frac{1}{2}\mbox{,}</code>
</p>

<p style="text-align: center;"><code class="reqn">\delta^{[12]}_{2;\mathbf{C}} = \int\!\!\int_{\mathcal{I}^2}
(12v - 6)
\mathbf{C}(u,v)\,\mathrm{d}u\mathrm{d}v - \frac{1}{2}\mbox{,}</code>
</p>

<p style="text-align: center;"><code class="reqn">\delta^{[12]}_{3;\mathbf{C}} = \int\!\!\int_{\mathcal{I}^2}
(60v^2 - 60v + 12)
\mathbf{C}(u,v)\,\mathrm{d}u\mathrm{d}v - \frac{1}{2}\mbox{, and}</code>
</p>

<p style="text-align: center;"><code class="reqn">\delta^{[12]}_{4;\mathbf{C}} = \int\!\!\int_{\mathcal{I}^2}
(280v^3 - 420v^2 + 180v - 20)
\mathbf{C}(u,v)\,\mathrm{d}u\mathrm{d}v - \frac{1}{2}\mbox{,}</code>
</p>

<p>where the bivariate L-moments are related to the L-comoment ratios by
</p>
<p style="text-align: center;"><code class="reqn">6\delta^{[12]}_k = \tau^{[12]}_{k+1}\mbox{\quad and \quad}6\delta^{[21]}_k = \tau^{[21]}_{k+1}\mbox{,}</code>
</p>

<p>where in otherwords, “the third bivariate L-moment <code class="reqn">\delta^{[12]}_3</code> is one sixth the L-cokurtosis <code class="reqn">\tau^{[12]}_4</code>.” The first four bivariate L-moments yield the first five L-comoments. The terms and nomenclature are not easy and also the English grammar adjective “ratios” is not always consistent in the literature. The <code class="reqn">\delta^{[\ldots]}_{k;\mathbf{C}}</code> are <b>ratios</b>. The sample L-comoments are supported by the <span class="pkg">lmomco</span> package, and in particular for the bivariate case, they are supported by the <code>lcomoms2()</code> function of that package.
</p>
<p>Similarly, the <code class="reqn">\delta^{[21]}_k</code> are computed by switching <code class="reqn">u \rightarrow v</code> in the polynomials within the above integrals multiplied to the copula in the system of equations with <code class="reqn">u</code>. In general, <code class="reqn">\delta^{[12]}_k \not= \delta^{[21]}_k</code> for <code class="reqn">k &gt; 1</code> unless in the case of <em>permutation symmetric</em> (<code>isCOP.permsym</code>) copulas. By theory, <code class="reqn">\delta^{[12]}_1 = \delta^{[21]}_1 = \rho_\mathbf{C}/6</code> where <code class="reqn">\rho_\mathbf{C}</code> is the <em>Spearman Rho</em> <code>rhoCOP</code>.
</p>
<p>The integral for <code class="reqn">\delta^{[12]}_{4;\mathbf{C}}</code> does not appear in Brahimi <em>et al.</em> (2015) but this and the other forms are verified in the <b>Examples</b> and discussion in <b>Note</b>. The four <code class="reqn">k \in (1,2,3,4)</code> for <code class="reqn">U</code> <em>wrt</em> <code class="reqn">V</code> and <code class="reqn">V</code> <em>wrt</em> <code class="reqn">U</code> comprise a full spectrum of system of seven (not eight) equations. One equation is lost because <code class="reqn">\delta^{[12]}_1 = \delta^{[21]}_1</code>.
</p>
<p>Chine and Benatia (2017) describe <em>trimmed L-comoments</em> as the multivariate extensions of the univariate <em>trimmed L-moments</em> (Elamir and Seheult, 2003) that are implemented in <span class="pkg">lmomco</span>. These are not yet implemented in <span class="pkg">copBasic</span>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lcomCOP(cop=NULL, para=NULL, as.bilmoms=FALSE, orders=2:5, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cop</code></td>
<td>
<p>A copula function;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>para</code></td>
<td>
<p>Vector of parameters or other data structure, if needed, to pass to the copula;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>as.bilmoms</code></td>
<td>
<p>A logical to trigger return of the <code class="reqn">\delta_k</code> and the return vectors will be named differently;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>orders</code></td>
<td>
<p>The orders of the L-comoments to return, which is internally adjusted if the argument <code>as.bilmoms</code> is set. There is no first order L-comoment and the first index on returned values is set to <code>NA</code> to remain index consistent with the <span class="pkg">lmomco</span> package. An order greater than 5 is not supported; and</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to pass to the <code>densityCOP</code> function.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> <code>list</code> of the L-comoments or bivariate L-moments is returned depending on <code>as.bilmoms</code> setting.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>bilmomUV</code></td>
<td>
<p>The bivariate L-moments <code class="reqn">\delta^{[12]}_k</code> of <code class="reqn">U</code> with respect to <code class="reqn">V</code> for <code class="reqn">k \in [1,2,3,4]</code> if <code>orders</code> is <code>2:5</code> and there is no <code>NA</code> index as for the L-comoments;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bilmomVU</code></td>
<td>
<p>The bivariate L-moments <code class="reqn">\delta^{[21]}_k</code> of <code class="reqn">V</code> with respect to <code class="reqn">U</code> for <code class="reqn">k \in [1,2,3,4]</code> if <code>orders</code> is <code>2:5</code> and there is no <code>NA</code> index as for the L-comoments;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lcomUV</code></td>
<td>
<p>The L-comoments <code class="reqn">\tau^{[12]}_k</code> of <code class="reqn">V</code> with respect to <code class="reqn">U</code> for <code class="reqn">k \in [2,3,4,5]</code> if <code>orders</code> is <code>2:5</code> and index 1 is <code>NA</code>; and</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lcomVU</code></td>
<td>
<p>The L-comoments <code class="reqn">\tau^{[21]}_k</code> of <code class="reqn">V</code> with respect to <code class="reqn">U</code> for <code class="reqn">k \in [2,3,4,5]</code> if <code>orders</code> is <code>2:5</code> and index 1 is <code>NA</code>.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The documention here is highly parallel to <code>bilmoms</code> for which that function was developed some years before <code>lmomCOP</code> was developed in January 2019. Also, <code>bilmoms</code> is based on gridded or Monte Carlo integration, and <code>bilmoms</code> is to be considered <b>deprecated</b>. However, it is deliberate that related background and various algorithm testing are still documented in <code>bilmoms</code>.
</p>


<h3>Author(s)</h3>

<p>W.H. Asquith</p>


<h3>References</h3>

<p>Asquith, W.H., 2011, Distributional analysis with L-moment statistics using the R environment for statistical computing: Createspace Independent Publishing Platform, ISBN 978–146350841–8.
</p>
<p>Brahimi, B., Chebana, F., and Necir, A., 2015, Copula representation of bivariate L-moments—A new estimation method for multiparameter two-dimensional copula models: Statistics, v. 49, no. 3, pp. 497–521.
</p>
<p>Chine, Amel, and Benatia, Fatah, 2017, Bivariate copulas parameters estimation using the trimmed L-moments methods: Afrika Statistika, v. 12, no. 1, pp. 1185–1197.
</p>
<p>Elamir, E.A.H, and Seheult, A.H., 2003, Trimmed L-moments: Computational Statistics and Data Analysis, v. 43, p. 299–314.
</p>
<p>Nelsen, R.B., 2006, An introduction to copulas: New York, Springer, 269 p.
</p>
<p>Serfling, R., and Xiao, P., 2007, A contribution to multivariate L-moments—L-comoment matrices: Journal of Multivariate Analysis, v. 98, pp. 1765–1781.
</p>


<h3>See Also</h3>

<p><code>bilmoms</code>, <code>lcomCOPpv</code>, <code>uvlmoms</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
para &lt;- list(alpha=0.5, beta=0.93, para1=4.5, cop1=GLcop, cop2=PSP)
copBasic:::lcomCOP(cop=composite2COP, para=para)$lcomUV[3]
# Lcomom:T3[12]=  +0.156
copBasic:::lcomCOP(cop=composite2COP, para=para)$lcomVU[3]
# Lcomom:T3[21]=  -0.0668
bilmoms(cop=composite2COP, n=10000, para=para, sobol=TRUE)$bilcomoms$T3
# Tau3[12]=+0.1566, Tau3[21]=-0.0655
# The numerical default Monte Carlo integration of bilmoms()
# matches the numerical integration of lcomCOP albeit with a
# substantially slower and less elegant means in bilmoms().
## End(Not run)

## Not run: 
# The following Spearman Rho and L-coskew values are predicted for a monitoring
# location of the relation between peak streamflow (V) and time into the
# water year (U) where U and V are "U-statistics."
site_srho  &lt;-  0.15536430
site_T3_12 &lt;-  0.03866056
site_T3_21 &lt;- -0.03090144

# Create an objective function for 3D optimization with some explicit intention that
# transforms are used to keep the parameters in acceptable parameter space for the
# alpha [0,1] and beta [0,1] and theta for the Plackett copula and the composite1COP
# used to add two more parameters to the Plackett.
ofunc &lt;- function(par, srho=NA, T3_12=NA, T3_21=NA) {
  alpha &lt;- pnorm(par[1]) # takes -Inf to +Inf ---&gt; 0 to 1 # compositing domain
  beta  &lt;- pnorm(par[2]) # takes -Inf to +Inf ---&gt; 0 to 1 # compositing domain
  theta &lt;-   exp(par[3]) # takes -Inf to +Inf ---&gt; 0 to +Inf # Plackett domain
  lmr &lt;- lcomCOP(cop=composite1COP,
                 para=list(alpha=alpha, beta=beta, para1=theta, cop1=PLcop))
  return((lmr$lcomUV[2] - srho )^2 + # look carefully, the 2, 3, 3 index
         (lmr$lcomUV[3] - T3_12)^2 + # use on the lmr list are correct, so do not
         (lmr$lcomVU[3] - T3_21)^2)  # expect to see 1, 2, 3 or 2, 3, 4.
}
# initial parameter guess ('middle' [0.5] compositing and independence [1]) and
# showing the transformations involved.
para_init &lt;- c(qnorm(0.5), qnorm(0.5), log(1))
rt &lt;- optim(par=para_init, ofunc,
            srho=site_srho, T3_12=site_T3_12, T3_21=site_T3_21)
lcom_para &lt;- list(alpha=pnorm(rt$par[1]), beta=pnorm(rt$par[2]),
                  para1=exp(rt$par[3]), cop1=PLcop)
sUV &lt;- simCOP(10000, cop=composite1COP, para=lcom_para, col=grey(0, 0.2), pch=16)
# Now as an exercise, consider increasing site_srho or negating it. Consider
# switching the signs on the L-coskews or increasing their magnitudes and study
# the resulting simulation to develop a personal feeling for L-coskew meaning. #
## End(Not run)
</code></pre>


</div>