<div class="container">

<table style="width: 100%;"><tr>
<td>cfda-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Categorical Functional Data Analysis</h2>

<h3>Description</h3>

<p>cfda provides functions for the analysis of categorical functional data.
</p>
<p>The main contribution is the computation of an optimal encoding (real functional variable) of each state of the categorical
functional data.
This can be done using the <code>compute_optimal_encoding</code> function that takes in arguments the data in a specific
format and a basis of functions created using the <code>fda</code> package (cf. <code>create.basis</code>).
The output can be analysed with <code>summary.fmca</code>, <code>plot.fmca</code>, <code>get_encoding</code>,
<code>plotEigenvalues</code> and <code>plotComponent</code>.
</p>
<p>Moreover, <code>cfda</code> contains functions to visualize and compute some statistics about categorical functional data.
A summary of the dataset is available with <code>summary_cfd</code>.
<code>plotData</code> shows a graphical representation of the dataset.
Basic statistics can be computed: the number of jumps (<code>compute_number_jumps</code>), the duration
(<code>compute_duration</code>), the time spent in each state (<code>compute_time_spent</code>),
the probability to be in each state at any given time (<code>estimate_pt</code>), the transition table
(<code>statetable</code>).
</p>
<p>The parameters of a Markov process can be estimated using <code>estimate_Markov</code> function.
</p>
<p>In order to test the different functions, a real dataset is provided (<code>biofam2</code>) as well as two functions
for generating data: (<code>generate_Markov</code> and <code>generate_2State</code>).
</p>


<h3>Details</h3>

<p>See the vignette for a detailed example and mathematical background:
<code>RShowDoc("cfda", package = "cfda")</code>
</p>


<h3>References</h3>


<ul>
<li>
<p> Deville J.C. (1982) Analyse de données chronologiques qualitatives : comment analyser des calendriers ?,
Annales de l'INSEE, No 45, p. 45-104.
</p>
</li>
<li>
<p> Deville J.C. et  Saporta G. (1980) Analyse harmonique qualitative, DIDAY et al. (editors),
Data Analysis and Informatics, North Holland, p. 375-389.
</p>
</li>
<li>
<p> Saporta G. (1981) Méthodes exploratoires d'analyse de données temporelles, Cahiers du B.U.R.O,
Université Pierre et Marie Curie, 37-38, Paris.
</p>
</li>
<li>
<p> Preda C, Grimonprez Q, Vandewalle V. Categorical Functional Data Analysis. The cfda R Package.
Mathematics. 2021; 9(23):3074. https://doi.org/10.3390/math9233074
</p>
</li>
</ul>
<h3>See Also</h3>

<p>compute_optimal_encoding
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Simulate the Jukes-Cantor model of nucleotide replacement
K &lt;- 4
Tmax &lt;- 5
PJK &lt;- matrix(1 / 3, nrow = K, ncol = K) - diag(rep(1 / 3, K))
lambda_PJK &lt;- c(1, 1, 1, 1)
d_JK &lt;- generate_Markov(n = 10, K = K, P = PJK, lambda = lambda_PJK, Tmax = Tmax)
d_JK2 &lt;- cut_data(d_JK, Tmax)

# create basis object
m &lt;- 5
b &lt;- create.bspline.basis(c(0, Tmax), nbasis = m, norder = 4)

# compute encoding
encoding &lt;- compute_optimal_encoding(d_JK2, b, computeCI = FALSE, nCores = 1)
summary(encoding)

# plot eigenvalues
plotEigenvalues(encoding, cumulative = TRUE, normalize = TRUE)

# plot the two first components
plotComponent(encoding, comp = c(1, 2))

# plot the encoding using the first harmonic
plot(encoding)

# extract the encoding using the first harmonic
encod &lt;- get_encoding(encoding)
</code></pre>


</div>