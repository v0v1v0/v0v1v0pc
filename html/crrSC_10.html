<div class="container">

<table style="width: 100%;"><tr>
<td>psh.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Goodness-of-fit test for proportional subdistribution hazards model</h2>

<h3>Description</h3>

<p>This Goodness-of-fit test  proposed a modified weighted Schoenfeld residuals to test the proportionality of subdistribution hazards for the Fine and Gray model
</p>


<h3>Usage</h3>

<pre><code class="language-R">psh.test(time, fstatus, z, D=c(1,1), tf=function(x) cbind(x,x^2), init)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>vector of failure times</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fstatus</code></td>
<td>
<p>  failure status =0 if censored</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>covariates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>components of z that are tested for time-varying effect</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tf</code></td>
<td>
<p>functions of t for z being tested on the same location</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>initial values of regression parameters (default=all 0)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The proposed score test employs Schoenfeld residuals adapted to competing risks data. The form of the
test is established assuming that the non-proportionality arises via time-dependent coefficients in the
Fine-Gray model, similar to the test of Grambsch and Therneau.
</p>


<h3>Value</h3>

<p>Returns a data.frame with percentage of cens, cause 1, Test Statistic,  d.f. ,p-value
</p>


<h3>Author(s)</h3>

<p>Bingqing Zhou, <a href="mailto:bingqing.zhou@yale.edu">bingqing.zhou@yale.edu</a></p>


<h3>References</h3>

<p>Zhou B, Fine JP, Laird, G. (2013). Goodness-of-fit test for proportional subdistribution hazards mode.
Statistics in Medicine. In Press.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(bce)
attach(bce)
lognodes &lt;- log(nnodes)
Z1 &lt;- cbind(lognodes, tsize/10, age, trt)  
# trt = 0 if placebo, = 0 treatment
# testing for linear time varying effect of trt
psh.test(time=time, fstatus=type, z=Z1, D=c(0,0,0,1), tf=function(x) x)
# testing for quadratic time varying effect of trt
psh.test(time=time, fstatus=type, z=Z1, D=c(0,0,0,1), tf=function(x) x^2)
# testing for log time varying effect of trt
psh.test(time=time, fstatus=type, z=Z1, D=c(0,0,0,1), 
tf=function(x) log(x))
# testing for both linear and quadratic time varying effect of trt
psh.test(time=time, fstatus=type, z=Z1, 
D=matrix(c(0,0,0,1,0,0,0,1), 4,2),  tf=function(x) cbind(x,x^2))

</code></pre>


</div>