<div class="container">

<table style="width: 100%;"><tr>
<td>get_feature_stability</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Evaluate Feature Set Stability</h2>

<h3>Description</h3>

<p>Evaluate the stability of clusterings obtained
based on incremental subsets of a given feature set.
</p>


<h3>Usage</h3>

<pre><code class="language-R">get_feature_stability(
  data_matrix,
  feature_set,
  steps,
  feature_type,
  n_repetitions = 100,
  seed_sequence = NULL,
  graph_reduction_type = "PCA",
  npcs = 30,
  ecs_thresh = 1,
  ncores = 1,
  algorithm = 4,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data_matrix</code></td>
<td>
<p>A data matrix having the features on the rows
and the observations on the columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>feature_set</code></td>
<td>
<p>A set of feature names that can be found on the rownames of
the data matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>steps</code></td>
<td>
<p>Vector containing the sizes of the subsets; negative values will
be interpreted as using all features.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>feature_type</code></td>
<td>
<p>A name associated to the feature_set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_repetitions</code></td>
<td>
<p>The number of repetitions of applying the pipeline with
different seeds; ignored if seed_sequence is provided by the user.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed_sequence</code></td>
<td>
<p>A custom seed sequence; if the value is NULL, the
sequence will be built starting from 1 with a step of 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>graph_reduction_type</code></td>
<td>
<p>The graph reduction type, denoting if the graph
should be built on either the PCA or the UMAP embedding.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npcs</code></td>
<td>
<p>The number of principal components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ecs_thresh</code></td>
<td>
<p>The ECS threshold used for merging similar clusterings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>The number of parallel R instances that will run the code. If
the value is set to 1, the code will be run sequentially.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>algorithm</code></td>
<td>
<p>An index indicating which community detection algorithm will
be used: Louvain (1), Louvain refined (2), SLM (3) or Leiden (4). More details
can be found in the Seurat's <code>FindClusters</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments passed to the umap method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list having one field associated with a step value. Each step
contains a list with three fields:
</p>

<ul>
<li>
<p> ecc - the EC-Consistency of the partitions obtained on all repetitions
</p>
</li>
<li>
<p> embedding - one UMAP embedding generated on the feature subset
</p>
</li>
<li>
<p> most_frequent_partition - the most common partition obtained across repetitions
</p>
</li>
</ul>
<h3>Note</h3>

<p>The algorithm assumes that the feature_set is already sorted when performing
the subsetting. For example, if the user wants to analyze highly variable feature set,
they should provide them sorted by their variability.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(2021)
# create an artificial expression matrix
expr_matrix = matrix(c(runif(100*10), runif(100*10, min = 3, max = 4)), nrow = 200, byrow = TRUE)
rownames(expr_matrix) = as.character(1:200)
colnames(expr_matrix) = paste("feature", 1:10)

feature_stability_result = get_feature_stability(data_matrix = t(expr_matrix),
   feature_set = colnames(expr_matrix),
   feature_type = "feature_name",
   steps = 5,
   npcs = 2,
   n_repetitions = 10,
   algorithm = 1,
   # the following parameters are used by the umap function and are not mandatory
   n_neighbors = 3,
   approx_pow = TRUE,
   n_epochs = 0,
   init = "random",
   min_dist = 0.3)
plot_feature_stability_boxplot(feature_stability_result)
</code></pre>


</div>