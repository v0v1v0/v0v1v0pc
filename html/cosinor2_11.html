<div class="container">

<table style="width: 100%;"><tr>
<td>population.cosinor.lm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Population-Mean Cosinor</h2>

<h3>Description</h3>

<p>Calculates the population-mean cosinor.
</p>


<h3>Usage</h3>

<pre><code class="language-R">population.cosinor.lm(data, time, period, na.action = na.omit,
  alpha = 0.05, plot = T)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame containing responses of subjects collected over time, with subjects in the rows and timepoints in the columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>A vector containing the times at which the data was collected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>period</code></td>
<td>
<p>Duration of one cycle of rhythm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>Action to be performed on missing values. Defaults to <code>na.omit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Significance level for calculating population cosinor parameters confidence intervals. Defaults to .05 (confidence intervals are 5% risk intervals).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>Logical, display plot after calculation? Defaults to <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>According to the procedure described in Cornélissen (2014), to calculate population-mean cosinor, single cosinors are first performed on each subject and linearized parameters are averaged, which allows for calculation of delinearized parameters. After such a procedure is completed, confidence intervals of population-mean cosinor parameters can be calculated as described in Bingham et al. (1982) using the following formulae:
</p>
<p style="text-align: center;"><code class="reqn">\widehat{M} \pm \frac{t_{1-\frac{\alpha}{2}}\widehat{\sigma}_M}{\sqrt{k}}</code>
</p>

<p style="text-align: center;"><code class="reqn">\widehat{\phi}+arctan(\frac{c_{23} t_{1-\frac{\alpha}{2}}^2 \pm t_{1-\frac{\alpha}{2}}\sqrt{c_{33}} \sqrt{\widehat{A}^2-\frac{(c_{22}c_{33}-c_{23}^2)t_{1-\frac{\alpha}{2}}^2}{c_{33}}}}{\widehat{A}^2 - c_{22} t_{1-\frac{\alpha}{2}}^2})</code>
</p>

<p style="text-align: center;"><code class="reqn">\widehat{A} \pm t_{1-\frac{\alpha}{2}} \sqrt{c_{22}}</code>
</p>

<p>where <code class="reqn">c_{22}</code>, <code class="reqn">c_{23}</code> and <code class="reqn">c_{33}</code> are elements of the sampling scheme matrix, calculated as follows:
</p>
<p style="text-align: center;"><code class="reqn">c_{22}=\frac{\widehat{\sigma}^2_{\beta}\widehat{\beta}^2+2\widehat{\sigma}_{\beta \gamma}\widehat{\beta}\widehat{\gamma}+\widehat{\sigma}^2_{\gamma}\widehat{\gamma}^2}{k\widehat{A}^2}</code>
</p>

<p style="text-align: center;"><code class="reqn">c_{23}=\frac{-(\widehat{\sigma}^2_{\beta}-\widehat{\sigma}^2_{\gamma})(\widehat{\beta}\widehat{\gamma})+\widehat{\sigma}_{\beta \gamma}(\widehat{\beta}^2-\widehat{\gamma}^2)}{k\widehat{A}^2}</code>
</p>

<p style="text-align: center;"><code class="reqn">c_{33}=\frac{\widehat{\sigma}^2_{\beta}\widehat{\gamma}^2-2\widehat{\sigma}_{\beta \gamma}\widehat{\beta}\widehat{\gamma}+\widehat{\sigma}^2_{\gamma}\widehat{\beta}^2}{k\widehat{A}^2}</code>
</p>

<p>where <code class="reqn">\widehat{M}</code>, <code class="reqn">\widehat{A}</code>, <code class="reqn">\widehat{\phi}</code>, <code class="reqn">\widehat{\beta}</code> and <code class="reqn">\widehat{\gamma}</code> are population-mean cosinor parameters, <code class="reqn">\widehat{\sigma}_M</code>, <code class="reqn">\widehat{\sigma}_{\beta}</code> and <code class="reqn">\widehat{\sigma}_{\gamma}</code> are the standard deviations of the single cosinor parameters, <code class="reqn">\widehat{\sigma}_{\beta \gamma}</code> is the covariance of the single cosinor <code class="reqn">\beta</code> and <code class="reqn">\gamma</code> coefficients, <code class="reqn">k</code> is the number of subjects in a population and <code class="reqn">t_{1-\frac{\alpha}{2}}</code> is the two-tailed inverse of the t-distribution with <code class="reqn">\alpha</code> level of significance and <code class="reqn">k - 1</code> degrees of freedom.
</p>


<h3>Value</h3>

<p>Object of the <code>population.cosinor.lm</code> class containing the following objects:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>single.cos</code></td>
<td>
<p>A list of objects containing all performed single cosinors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pop.mat</code></td>
<td>
<p>A data frame containing the cosinor parameters of each subject in the population.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>Delinearized population-mean cosinor coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>emp.mean</code></td>
<td>
<p>Empirical mean of the data across all timepoints.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>
<p>Estimated values of the rhythm caclculated using the cosinor model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>The difference between empirical mean and the fitted values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.int</code></td>
<td>
<p>Values of upper and lower limits of confidence intervals of delinearized cosinor parameters.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>If the confidence interval of the population amplitude includes zero, confidence interval of the acrophase cannot be calculated reliably. If this case occurs while using this function, the user will be warned and acrophase confidence interval limits will be set to NA.
</p>


<h3>References</h3>

<p>Cornélissen, G. (2014). Cosinor-Based Rhythmometry. <em>Theoretical Biology and Medical Modeling</em>, <em>11</em>, Article 16.
</p>
<p>Bingham, C., Arbogast, B., Guillaume Cornélissen, G., Lee, J.K. &amp; Halberg, F. (1982). Inferential Statistical Methods for Estimating and Comparing Cosinor Parameters. <em>Chronobiologia</em>, <em>9(4)</em>, 397-439.
</p>


<h3>Examples</h3>

<pre><code class="language-R">population.cosinor.lm(data = PANAS_november, time = PANAS_time,
period = 7, na.action = "na.exclude")
</code></pre>


</div>