<div class="container">

<table style="width: 100%;"><tr>
<td>add.risk</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Additional risk function</h2>

<h3>Description</h3>

<p>Additional risk function estimated from the object <code>fit</code>
</p>


<h3>Usage</h3>

<pre><code class="language-R">add.risk(y, x, fit, mcmc, a, alpha=0.05, 
x.grid=NULL, y.grid=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>optional numeric vector for the response used in <code>comire.gibbs</code>. If <code>y</code> is missing, <code>y.grid</code> must be provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>numeric vector for the covariate relative to the dose of exposure used in <code>comire.gibbs</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>the output of <code>comire.gibbs</code>. an object of the class <code>classCoMiRe</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcmc</code></td>
<td>
<p>a list giving the MCMC parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>threshold of clinical interest for the response variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>level of the credible bands.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.grid</code></td>
<td>
<p>optional numerical vector giving the actual values of the grid for x for plotting the additional risk function. If <code class="reqn">x.gird</code> is not provided, standard grids are automatically used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.grid</code></td>
<td>
<p>optional numerical vector giving the actual values of the grid for y for plotting the additional risk function. If <code class="reqn">y.gird</code> is not provided, standard grids are automatically used.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of arguments for generating posterior output. It contains:
</p>

<ul>
<li>
<p><code>mcmc.risk</code> a matrix containing in the lines the MCMC chains, after thinning, of the additional risk function over <code>x.grid</code>, in the columns. 
</p>
</li>
<li>
<p><code>summary.risk</code> a data frame with four variables: the posterior means of the additional risk function over <code>x.grid</code>, the respective <code class="reqn">\alpha/2</code> and <code class="reqn">1-\alpha/2</code> quantiles, and <code>x.grid</code>.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Antonio Canale, Arianna Falcioni
</p>


<h3>Examples</h3>

<pre><code class="language-R">{
data(CPP)
attach(CPP)

n &lt;- NROW(CPP)
J &lt;- H &lt;- 10

premature &lt;- as.numeric(gestage&lt;=37)

mcmc &lt;- list(nrep=5000, nb=2000, thin=5, ndisplay=4)

## too few iterations to be meaningful. see below for safer and more comprehensive results

mcmc &lt;- list(nrep=10, nb=2, thin=1, ndisplay=4) 

prior &lt;- list(mu.theta=mean(gestage), k.theta=10, eta=rep(1, J)/J, 
              alpha=rep(1,H)/H, a=2, b=2, J=J, H=H)
              
fit.dummy &lt;- comire.gibbs(gestage, dde, family="continuous", 
                     mcmc=mcmc, prior=prior, seed=1, max.x=180)
                     
risk.data &lt;- add.risk(y = gestage, x = dde, fit = fit.dummy, mcmc = mcmc, 
    a = 37, x.grid = seq(0, max(dde), length = 100))
riskplot(risk.data$summary.risk, xlab="DDE", x = dde, xlim = c(0,150))
                    

## safer procedure with more iterations (it may take some time)

mcmc &lt;- list(nrep=5000, nb=2000, thin=5, ndisplay=4)

## Fit the model for continuous y 

prior &lt;- list(mu.theta=mean(gestage), k.theta=10, eta=rep(1, J)/J, 
              alpha=rep(1,H)/H, a=2, b=2, J=J, H=H)
              
fit1 &lt;- comire.gibbs(gestage, dde, family="continuous", 
                     mcmc=mcmc, prior=prior, seed=5, max.x=180)
 
risk.data &lt;- add.risk(y = gestage, x = dde, fit = fit1, mcmc = mcmc, 
a = 37, x.grid = seq(0, max(dde), length = 100))
riskplot(risk.data$summary.risk, xlab="DDE", x = dde, xlim = c(0,150))


}
</code></pre>


</div>