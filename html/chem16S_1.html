<div class="container">

<table style="width: 100%;"><tr>
<td>chem16S-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Chemical metrics for microbial communities</h2>

<h3>Description</h3>

<p>Functions and data to calculate chemical metrics for reference proteomes for microbial (archaeal and bacterial) communities.
Amino acid compositions of community reference proteomes are generated by combining reference proteomes of taxa (derived from GTDB or RefSeq) with taxonomic classifications of 16S rRNA gene sequences.
</p>


<h3>Details</h3>


<ul>
<li> <p><code>read_RDP</code> - Read and filter an RDP Classifier table
</p>
</li>
<li> <p><code>map_taxa</code> - Map RDP Classifier assignments to the NCBI taxonomy
</p>
</li>
<li> <p><code>get_metrics</code> - Get chemical metrics for community reference proteomes
</p>
</li>
<li> <p><code>get_metadata</code> - Example function for retrieving sample metadata
</p>
</li>
<li> <p><code>plot_metrics</code> - Plot metrics with symbols and colors based on metadata
</p>
</li>
<li> <p><code>physeq</code> - Functions designed to analyze <code>phyloseq-class</code> objects
</p>
</li>
</ul>
<p>History:
</p>

<ol>
<li>
<p> Work begun in 2021. The combination of RefSeq reference proteomes with taxonomic abundances to compute community-level chemical metrics was described by Dick and Tan (2023). <span class="pkg">chem16S</span> originated as code in the <span class="pkg">JMDplots</span> package (<a href="https://github.com/jedick/JMDplots">https://github.com/jedick/JMDplots</a>).
</p>
</li>
<li>
<p> Development in 2022. Dick and Meng (2023) compared community <i>Z</i><sub>C</sub> with redox potential measurements from local to global scales. The term “community reference proteomes” was first applied, and <span class="pkg">chem16S</span> was split into a separate package.
</p>
</li>
<li>
<p> Late 2022. GTDB r207 was added as a reference database.
</p>
</li>
<li>
<p> June–July 2023. Integration with <span class="pkg">phyloseq</span> and addition of vignettes: <em>Chemical metrics of reference proteomes</em>, <em>Integration of chem16S with phyloseq</em>, and <em>Plotting two chemical metrics</em>. Default reference database changed to GTDB r207.
</p>
</li>
<li>
<p> April 2024. Updated to GTDB r214.
</p>
</li>
</ol>
<h3>Options set in package chem16S</h3>

<p><span class="pkg">chem16S</span> sets an option using the global <code>options</code> mechanism in R.
This option will be set when package <span class="pkg">chem16S</span> (or its namespace) is loaded if not already set.
</p>

<dl>
<dt><code>manual_mappings</code></dt>
<dd>
<p>A data frame of mappings between RDP and NCBI (RefSeq) taxonomies, which is read from ‘<span class="file">extdata/manual_mappings.csv</span>’.
The columns include <code>RDP.rank</code>, <code>RDP.name</code>, <code>NCBI.rank</code>, <code>NCBI.name</code>, and <code>notes</code>.
This option is made available so the user can modify the manual mappings used by <code>map_taxa</code> at runtime.
</p>
</dd>
</dl>
<h3>Files in RefDB/RefSeq_206</h3>

<p>NOTE: None of the ‘<span class="file">*.R</span>’ files in the ‘<span class="file">extdata</span>’ directories are included in the package submitted to CRAN; see GitHub or Zenodo for these files.
</p>
<p>This directory contains two sets of files:
1) scripts to process source RefSeq sequence files to generate amino acid compositions of species-level reference proteomes and taxonomic names;
2) script and output for amino acid compositions of higher-level taxa.
The files are based on RefSeq release 206 of 2021-05-21 (O'Leary et al., 2016).
</p>

<dl>
<dt>‘<span class="file">README.txt</span>’</dt>
<dd>
<p>Description of steps to generate reference proteomes of species-level taxa (including downloads and shell commands).</p>
</dd>
<dt>‘<span class="file">gencat.sh</span>’</dt>
<dd>
<p>Helper script to extract microbial protein records from the RefSeq catalog.</p>
</dd>
<dt>‘<span class="file">genome_AA.R</span>’</dt>
<dd>
<p>R code to sum the amino acid compositions of all proteins for each bacterial, archaeal, and viral species in the NCBI Reference Sequence database.
NOTE: To save space in this package, the output file (‘<span class="file">genome_AA.csv</span>’) is stored in the <code>RefDB/RefSeq_206</code> directory of the JMDplots package on GitHub (<a href="https://github.com/jedick/JMDplots">https://github.com/jedick/JMDplots</a>.
The first five columns are: <code>protein</code> (“refseq”), <code>organism</code> (taxonomic id), <code>ref</code> (organism name), <code>abbrv</code> (empty), <code>chains</code> (number of protein sequences for this organism).
Columns 6 to 25 have the counts of amino acids.
</p>
</dd>
<dt>‘<span class="file">taxonomy.R</span>’</dt>
<dd>
<p>R code for processing taxonomic IDs; the output file is ‘<span class="file">taxonomy.csv</span>’.
The columns are NCBI taxonomic ID (taxid), and names at different taxonomic rank (species, genus, family, order, class, phylum, superkingdom).
</p>
</dd>
<dt>‘<span class="file">taxon_AA.R</span>’</dt>
<dd>
<p>Functions to create the files listed below:</p>
</dd>
<dt>‘<span class="file">taxon_AA.csv.xz</span>’</dt>
<dd>
<p>Average amino acid composition of reference proteomes for all species in each genus, family, order, class, phylum, and superkingdom.</p>
</dd>
</dl>
<h3>Files in RefDB/GTDB_214</h3>


<dl>
<dt>‘<span class="file">taxon_AA.R</span>’</dt>
<dd>
<p>Functions to process GTDB source files (Parks et al., 2022) and produce the following output file:</p>
</dd>
<dt>‘<span class="file">taxon_AA.csv.xz</span>’</dt>
<dd>
<p>Average amino acid composition of reference proteomes for all species in each genus, family, order, class, phylum, and domain.
In both this file and the corresponding file for RefSeq (see above), the <code>protein</code>, <code>organism</code>, <code>ref</code>, and <code>abbrv</code> columns contain the rank, taxon name, number of species used to generate the amino acid composition of this taxon, and parent taxon.
<code>chains</code> is <code>1</code>, denoting a single polypeptide chain, so the amino acid composition represents the average per-protein amino acid composition in this taxon, and the sum of amino acid counts is the average protein length.
</p>
</dd>
</dl>
<h3>Files in extdata/metadata</h3>


<dl>
<dt>‘<span class="file">BGPF13.csv</span>’</dt>
<dd>
<p>Metadata for Heart Lake Geyser Basin, Yellowstone (Bowen De León et al., 2012).</p>
</dd>
<dt>‘<span class="file">HLA+16.csv</span>’</dt>
<dd>
<p>Metadata for the Baltic Sea (Herlemann et al., 2016).</p>
</dd>
<dt>‘<span class="file">SMS+12.csv</span>’</dt>
<dd>
<p>Metadata for Bison Pool, Yellowstone (Swingley et al., 2012).</p>
</dd>
</dl>
<h3>Files in extdata/RDP</h3>

<p>Output of RDP Classifier with the default training set.
</p>

<dl>
<dt>‘<span class="file">pipeline.R</span>’</dt>
<dd>
<p>Pipeline for sequence data processing (uses external programs fastq-dump, vsearch, seqtk, RDP Classifier).
This was used to make the files in both ‘<span class="file">RDP</span>’ and ‘<span class="file">RDP-GTDB_207</span>’ (the latter with <code>GTDB = TRUE</code> in the script).
</p>
</dd>
<dt>‘<span class="file">BGPF13.tab.xz</span>’</dt>
<dd>
<p>Heart Lake Geyser Basin.</p>
</dd>
<dt>‘<span class="file">HLA+16.tab.xz</span>’</dt>
<dd>
<p>Baltic Sea.</p>
</dd>
<dt>‘<span class="file">SMS+12.tab.xz</span>’</dt>
<dd>
<p>Bison Pool.</p>
</dd>
</dl>
<h3>Files in extdata/RDP-GTDB_207</h3>

<p>Output of RDP Classifer using the GTDB r207 SSU training set (<a href="https://doi.org/10.5281/zenodo.7633100">doi:10.5281/zenodo.7633100</a>).
</p>

<dl>
<dt>‘<span class="file">BGPF13.tab.xz</span>’</dt>
<dd>
<p>Heart Lake Geyser Basin.</p>
</dd>
<dt>‘<span class="file">HLA+16.tab.xz</span>’</dt>
<dd>
<p>Baltic Sea.</p>
</dd>
<dt>‘<span class="file">SMS+12.tab.xz</span>’</dt>
<dd>
<p>Bison Pool.</p>
</dd>
</dl>
<h3>Files in extdata/DADA2-GTDB_214</h3>

<p>Identification and taxonomic classification of sequences using DADA2 with GTDB r214.
</p>

<dl>
<dt>‘<span class="file">FEN+22</span>’</dt>
<dd>
<p>Analysis of data from Fonseca et al. (2022) for marine sediment from the Humboldt Sulfuretum.
‘<span class="file">pipeline.R</span>’ has the commands used to process the 16S rRNA gene sequence data and was adapted by Jeffrey Dick from the DADA2 pipeline tutorial (Callahan, 2020).
‘<span class="file">SraRunInfo.csv</span>’ was obtained from the NCBI Sequence Read Archive (SRA) (<a href="https://www.ncbi.nlm.nih.gov/sra/?term=PRJNA251688">https://www.ncbi.nlm.nih.gov/sra/?term=PRJNA251688</a>).
‘<span class="file">sample_data.csv</span>’ has data obtained from NCBI BioSample records for BioProject PRJNA251688.
‘<span class="file">*.png</span>’ are several plots created while running the DADA2 pipeline.
‘<span class="file">ps_FEN+22.rds</span>’ contains the phyloseq object with (including <code>otu_table</code>, <code>sample_data</code>, and <code>refseq</code> objects) created at the end of the DADA2 pipeline.
</p>
</dd>
</dl>
<dl>
<dt>‘<span class="file">ZFZ+23</span>’</dt>
<dd>
<p>Analysis of data from Zhang et al. (2023) for hot springs in the Qinghai-Tibet Plateau.
‘<span class="file">pipeline.R</span>’ has the commands used to process the 16S rRNA gene sequence data and was adapted by Jeffrey Dick from the DADA2 pipeline tutorial (Callahan, 2020).
‘<span class="file">SraRunInfo.csv</span>’ was obtained from the NCBI Sequence Read Archive (SRA) (<a href="https://www.ncbi.nlm.nih.gov/sra/?term=PRJNA860942">https://www.ncbi.nlm.nih.gov/sra/?term=PRJNA860942</a>).
‘<span class="file">sample_data.csv</span>’ has data obtained from NCBI BioSample records for BioProject PRJNA860942.
‘<span class="file">*.png</span>’ are several plots created while running the DADA2 pipeline.
‘<span class="file">ps_ZFZ+23.rds</span>’ contains the phyloseq object with (including <code>otu_table</code>, <code>sample_data</code>, and <code>refseq</code> objects) created at the end of the DADA2 pipeline.
</p>
</dd>
</dl>
<h3>References</h3>

<p>Bowen De León K, Gerlach R, Peyton BM, Fields MW. 2013. Archaeal and bacterial communities in three alkaline hot springs in Heart Lake Geyser Basin, Yellowstone National Park. <em>Frontiers in Microbiology</em> <b>4</b>: 330. <a href="https://doi.org/10.3389/fmicb.2013.00330">doi:10.3389/fmicb.2013.00330</a>
</p>
<p>Callahan B. 2020. DADA2 Pipeline Tutorial (1.16). <a href="https://benjjneb.github.io/dada2/tutorial.html">https://benjjneb.github.io/dada2/tutorial.html</a>, accessed on 2023-06-14.
</p>
<p>Dick JM, Meng D. 2023. Community- and genome-based evidence for a shaping influence of redox potential on bacterial protein evolution. <em>mSystems</em> <b>8</b>(3): e00014-23. <a href="https://doi.org/10.1128/msystems.00014-23">doi:10.1128/msystems.00014-23</a>
</p>
<p>Dick JM, Tan J. 2023. Chemical links between redox conditions and estimated community proteomes from 16S rRNA and reference protein sequences. <em>Microbial Ecology</em> <b>85</b>: 1338–1355. <a href="https://doi.org/10.1007/s00248-022-01988-9">doi:10.1007/s00248-022-01988-9</a>
</p>
<p>Fonseca A, Espinoza C, Nielsen LP, Marshall IPG, Gallardo VA. 2022. Bacterial community of sediments under the Eastern Boundary Current System shows high microdiversity and a latitudinal spatial pattern. <em>Frontiers in Microbiology</em> <b>13</b>: 1016418. <a href="https://doi.org/10.3389/fmicb.2022.1016418">doi:10.3389/fmicb.2022.1016418</a>
</p>
<p>Herlemann DPR, Lundin D, Andersson AF, Labrenz M, Jürgens K. 2016. Phylogenetic signals of salinity and season in bacterial community composition across the salinity gradient of the Baltic Sea. <em>Frontiers in Microbiology</em> <b>7</b>: 1883. <a href="https://doi.org/10.3389/fmicb.2016.01883">doi:10.3389/fmicb.2016.01883</a>
</p>
<p>O'Leary NA et al. 2016. Reference sequence (RefSeq) database at NCBI: current status, taxonomic expansion, and functional annotation. <em>Nucleic Acids Research</em> <b>44</b>: D733-D745. <a href="https://doi.org/10.1093/nar/gkv1189">doi:10.1093/nar/gkv1189</a>
</p>
<p>Parks DH, Chuvochina M, Rinke C, Mussig AJ, Chaumeil P-A, Hugenholtz P. 2022. GTDB: an ongoing census of bacterial and archaeal diversity through a phylogenetically consistent, rank normalized and complete genome-based taxonomy. <em>Nucleic Acids Research</em> <b>50</b>: D785–D794. <a href="https://doi.org/10.1093/nar/gkab776">doi:10.1093/nar/gkab776</a>
</p>
<p>Swingley WD, Meyer-Dombard DR, Shock EL, Alsop EB, Falenski HD, Havig JR, Raymond J. 2012. Coordinating environmental genomics and geochemistry reveals metabolic transitions in a hot spring ecosystem. <em>PLOS One</em> <b>7</b>(6): e38108. <a href="https://doi.org/10.1371/journal.pone.0038108">doi:10.1371/journal.pone.0038108</a>
</p>
<p>Zhang H-S, Feng Q-D, Zhang D-Y, Zhu G-L, Yang L. 2023. Bacterial community structure in geothermal springs on the northern edge of Qinghai-Tibet plateau. <em>Frontiers in Microbiology</em> <b>13</b>: 994179. <a href="https://doi.org/10.3389/fmicb.2022.994179">doi:10.3389/fmicb.2022.994179</a>
</p>


</div>