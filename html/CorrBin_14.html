<div class="container">

<table style="width: 100%;"><tr>
<td>jointprobs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate joint event probabilities for multinomial data</h2>

<h3>Description</h3>

<p>An exchangeable multinomial distribution with <code class="reqn">K+1</code> categories <code class="reqn">O_1,\ldots,O_{K+1}</code>, can be
parameterized by the joint probabilities of events
</p>
<p style="text-align: center;"><code class="reqn">\tau_{r_1,\ldots,r_{K}|n} = P\big[X_1=\cdots=X_{r_1}=O_1,\ldots, X_{\sum_{i=1}^{K-1}r_i+1} =\cdots=X_{\sum_{i=1}^{K}r_i}=O_K\big] </code>
</p>

<p>where <code class="reqn">r_i \geq 0</code> and <code class="reqn">r_1+\cdots +r_K\leq n</code>.
The <code>jointprobs</code> function estimates these probabilities under various settings. 
Note that when some of the <code class="reqn">r_i</code>'s equal zero, then no restriction on the number of outcomes of the 
corresponding type are imposed, so the resulting probabilities are marginal.
</p>


<h3>Usage</h3>

<pre><code class="language-R">jointprobs(cmdata, type = c("averaged", "cluster", "mc"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cmdata</code></td>
<td>
<p>a <code>CMData</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>character string describing the desired type of estimate:
</p>

<dl>
<dt>"averaged"</dt>
<dd>
<p> - averaged over the observed cluster-size distribution within each treatment</p>
</dd>
<dt>"cluster"</dt>
<dd>
<p> - separately for each cluster size within each treatment</p>
</dd>
<dt>"mc"</dt>
<dd>
<p> - assuming marginal compatibility, ie that <code class="reqn">\tau</code> does not depend on the cluster-size</p>
</dd>
</dl>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list with an array of estimates for each treatment. For a multinomial distribution with
<code class="reqn">K+1</code> categories the arrays will have either <code class="reqn">K+1</code> or <code class="reqn">K</code> dimensions, depending on whether 
cluster-size specific estimates (<code>type="cluster"</code>) or pooled estimates 
(<code>type="averaged"</code> or <code>type="mc"</code>) are requested. For the cluster-size specific estimates 
the first dimension is the cluster-size. Each additional dimension is a possible outcome.
</p>


<h3>See Also</h3>

<p><code>mc.est</code> for estimating the distribution under marginal compatibility,
<code>uniprobs</code> and <code>multi.corr</code> for extracting the univariate marginal event
probabilities, and the within-multinomial correlations from the joint probabilities.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(dehp)
# averaged over cluster-sizes
tau.ave &lt;- jointprobs(dehp, type="ave")
# averaged P(X1=X2=O1, X3=O2) in the 1500 dose group
tau.ave[["1500"]]["2","1"]  # there are two type-1, and one type-2 outcome

#plot P(X1=O1) - the marginal probability of a type-1 event over cluster-sizes
tau &lt;- jointprobs(dehp, type="cluster")
ests &lt;- as.data.frame(lapply(tau, function(x)x[,"1","0"]))
matplot(ests, type="b")
</code></pre>


</div>