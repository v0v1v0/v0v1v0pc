<div class="container">

<table style="width: 100%;"><tr>
<td>estCopC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Pseudo maximum likelihood estimator of the copula parameter</h2>

<h3>Description</h3>

<p>Obtains the pseudo maximum likelihood estimator of the copula parameter based on censored time series.
</p>


<h3>Usage</h3>

<pre><code class="language-R">estCopC(cop="Gaussian",Yc,d,delta,nIS=500,jumps=NULL,MARGIN=NULL,...,interval=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cop</code></td>
<td>
<p>the choice of copula function.
There are currently five available copula funcitons,
including Clayton copula, Gaussian copula, Gumbel copula, Joe copula and Frank copula.
Specify one from "Clayton","Gaussian","Gumbel","Joe" and "Frank".
The default is "Gaussian".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Yc</code></td>
<td>
<p>the Nx1 vector of observed response variable
that is subject to lower detection limit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>the lower detection limit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>the Nx1 vector of censoring indicator
with 1 indicating uncensored and 0 indicating left censored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nIS</code></td>
<td>
<p>the size for sequential importance sampling.
The default is 500.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jumps</code></td>
<td>
<p>the Nx1 vector indicating whether
each time t is a start of a new time series, which is deemed to be
independent from the previous series.
By default, <code>jumps</code> = c(1,rep(0,n-1)) indicating the data is one Markov sequence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MARGIN</code></td>
<td>
<p>the marginal distribution function of the latent time series.
The default is the empirical cdf:
</p>
<p style="text-align: center;"><code class="reqn">\frac{1}{n+1}\sum_{t=1}^n I_{Y_t&lt;=y}</code>
</p>
<p>.
MARGIN can also be specified as
other existing distribution functions such as pnorm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters for the marginal distribution of the latent time series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interval</code></td>
<td>
<p>the lower and upper bound for the copula paraameter.
By default,  <code>interval</code>=
c(-1,1) for Gaussian copula,
c(-1,Inf) for Clayton copula,
c(1,Inf) for Gumbel and Joe copula and
c(-Inf,Inf) for Frank copula.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>estCopC</code> returns a list of components including.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>para</code></td>
<td>
<p>the pseudo maximum likelihood estimator of the copula parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>likelihood</code></td>
<td>
<p>the negative log-likelihood value corresponding to the estimated copula parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>copula</code></td>
<td>
<p>the estimated copula object, with estimated copula parameter plugged in.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Li, F., Tang, Y. and Wang, H. (2018).
Copula-based Semiparametric Analysis for Time Series Data with Detection Limits, technical report.
</p>


<h3>Examples</h3>

<pre><code class="language-R">### Using a simulated data for demonstration:
set.seed(20)
Y = genLatentY(cop="Clayton",1,30,MARGIN.inv = qt,df=3)
d = -1
Yc = pmax(d,Y)
delta = (Y&gt;d)
## CopC estimator
estCopC(cop = "Clayton",Yc,d,delta,nIS = 50,interval = c(1,10))
## Omniscient estimator
estCopC(cop = "Clayton",Y,d,delta=rep(TRUE,length(Y)),interval = c(1,10))
## CopC estimator under true marginal
estCopC(cop = "Clayton",Yc,d,delta,nIS = 50,MARGIN=pt,df=3,interval = c(1,10))
### Analyze the water quality data:
attach(water)
Yc = TNH3[1:30]
delta = Delta[1:30]
jumps = Indep[1:30]
set.seed(1)
estCopC(cop="Clayton",Yc=Yc,d=0.02,delta=delta,jumps=jumps,interval = c(1,10),nIS=50)
</code></pre>


</div>