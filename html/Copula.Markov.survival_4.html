<div class="container">

<table style="width: 100%;"><tr>
<td>ClaytonFrank.Weibull.MLE</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Parameter estimation based on the Clayton copula for serial dependence and the Frank copula for dependent censoring with the Weibull distributions</h2>

<h3>Description</h3>

<p>Perform two-stage estimation based on the Clayton copula C_theta for serial dependence and the Frank copula tilde(C)_alpha for dependent censoring with the marginal distributions Weib(scale1, shape1) and Weib(scale2, shape2). The jackknife method estimates the asymptotic covariance matrix. Parametric bootstrap is applied while doing Kolmogorov-Smirnov tests and Cramer-von Mises test. The guide for using this function shall be explained by Huang (2019) and Huang, Wang and Emura (2020).
</p>


<h3>Usage</h3>

<pre><code class="language-R">ClaytonFrank.Weibull.MLE(subject, t.event, event, t.death, death, stageI, Weibull.plot,
                                jackknife, plot, GOF, GOF.plot, rep.GOF, digit)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>subject</code></td>
<td>
<p>a vector for numbers of subject</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t.event</code></td>
<td>
<p>a vector for event times</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>event</code></td>
<td>
<p>a vector for event indicator (=1 if recurrent; =0 if censoring)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t.death</code></td>
<td>
<p>a vector for death times</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>death</code></td>
<td>
<p>a vector for death indicator (=1 if death; =0 if censoring)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stageI</code></td>
<td>
<p>an option to select MLE or LSE method for the 1st-stage optimization</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Weibull.plot</code></td>
<td>
<p>if TRUE, show the Weibull probability plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jackknife</code></td>
<td>
<p>if TRUE, the jackknife method is used for estimate covariance matrix (default = TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>if TRUE, the plots for marginal distributions are shown (default = FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GOF</code></td>
<td>
<p>if TRUE, show the p-values for KS-test and CvM-test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GOF.plot</code></td>
<td>
<p>if TRUE, show the model diagnostic plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rep.GOF</code></td>
<td>
<p>repetition number of parametric bootstrap</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digit</code></td>
<td>
<p>accurate to some decimal places</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When jackknife=FALSE, the corresponding standard error and confidence interval values are shown as NA.
</p>


<h3>Value</h3>

<p>A list with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Sample_size</code></td>
<td>
<p>Sample size N</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Case</code></td>
<td>
<p>Count for event occurences</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale1</code></td>
<td>
<p>Scale parameter for Weib(scale1, shape1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape1</code></td>
<td>
<p>Shape parameter for Weib(scale1, shape1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale2</code></td>
<td>
<p>Scale parameter for Weib(scale2, shape2)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape2</code></td>
<td>
<p>Shape parameter for Weib(scale2, shape2)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>Copula parameter for the Clayton copula C_theta</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Copula parameter for the Frank copula tilde(C)_alpha</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>COV</code></td>
<td>
<p>Asymptotic covariance estimated by the jackknife method</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>KS</code></td>
<td>
<p>Kolmogorov-Smirnov test statistics</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.KS</code></td>
<td>
<p>P-values for Kolmogorov-Smirnov tests</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CM</code></td>
<td>
<p>Cramer-von Mises test statistics</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.CM</code></td>
<td>
<p>P-values for Cramer-von Mises tests</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Convergence</code></td>
<td>
<p>Convergence results for each stage</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Jackknife_error</code></td>
<td>
<p>Count for error in jackknife repititions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Log_likelihood</code></td>
<td>
<p>Log-likelihood values</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Xinwei Huang
</p>


<h3>References</h3>

<p>Huang XW, Wang W, Emura T (2020) A copula-based Markov chain model for serially dependent event times with a dependent terminal event. Japanese Journal of Statistics &amp; Data Science. Accepted.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data = ClaytonFrank.Weibull.data(N = 30, scale1 = 1, shape1 =0.5, theta = 2,
                                 scale2 = 0.45, shape2 = 0.5, alpha = 2, b = 10, l = 300)

ClaytonFrank.Weibull.MLE(subject = data$Subject,
                           t.event = data$T_ij, event = data$delta_ij,
                           t.death = data$T_i_star, death = data$delta_i_star,
                           jackknife= TRUE, plot = TRUE)


</code></pre>


</div>