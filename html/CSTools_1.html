<div class="container">

<table style="width: 100%;"><tr>
<td>CST_AdamontAnalog</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>CST_AdamontAnalog finds analogous data in the reference dataset to experiment
data based on weather types</h2>

<h3>Description</h3>

<p>This function searches for analogs in a reference dataset for 
experiment data, based on corresponding weather types. The experiment data is
typically a hindcast, observations are typically provided by reanalysis data.
</p>
<p>This function searches for analogs in a reference dataset for 
experiment data, based on corresponding weather types. The experiment data is
typically a hindcast, observations are typically provided by reanalysis data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CST_AdamontAnalog(
  exp,
  obs,
  wt_exp,
  wt_obs,
  nanalogs,
  method = "pattcorr",
  thres = NULL,
  search_obsdims = c("member", "sdate", "ftime"),
  londim = "lon",
  latdim = "lat"
)

AdamontAnalog(
  exp,
  obs,
  wt_exp,
  wt_obs,
  nanalogs = 5,
  method = "pattcorr",
  thres = NULL,
  search_obsdims = c("member", "sdate", "ftime"),
  londim = "lon",
  latdim = "lat"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>exp</code></td>
<td>
<p>A multidimensional array with named dimensions containing the 
experiment data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs</code></td>
<td>
<p>A multidimensional array with named dimensions containing the 
reference data. Note that lat/lon dimensions need to be the same as 
<code>exp</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wt_exp</code></td>
<td>
<p>Corresponding weather types (same dimensions as <code>exp$data</code> 
but lat/lon).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wt_obs</code></td>
<td>
<p>Corresponding weather types (same dimensions as <code>obs$data</code>
but lat/lon).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nanalogs</code></td>
<td>
<p>Integer defining the number of analog values to return
(default: 5).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A character string indicating the method used for analog
definition. It can be:
</p>

<ul>
<li>
<p>'pattcorr': pattern correlation.
</p>
</li>
<li>
<p>'rain1' (for precip patterns): rain occurrence consistency.
</p>
</li>
<li>
<p>'rain01' (for precip patterns): rain occurrence/non occurrence 
consistency
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thres</code></td>
<td>
<p>Real number indicating the threshold to define rain 
occurrence/non occurrence in rain (0)1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>search_obsdims</code></td>
<td>
<p>List of dimensions in <code>obs</code> along which analogs are
searched for.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>londim</code></td>
<td>
<p>Name of longitude dimension.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>latdim</code></td>
<td>
<p>Name of latitude dimension.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>analog_vals An object of class <code>s2dv_cube</code> containing 
nanalogs analog values for each value of <code>exp</code> input data.
</p>
<p>analog_vals An array containing nanalogs analog values.
</p>


<h3>Author(s)</h3>

<p>Paola Marson, <a href="mailto:paola.marson@meteo.fr">paola.marson@meteo.fr</a> for PROSNOW version
</p>
<p>Lauriane Batt√©, <a href="mailto:lauriane.batte@meteo.fr">lauriane.batte@meteo.fr</a> for CSTools adaptation
</p>


<h3>Examples</h3>

<pre><code class="language-R">wt_exp &lt;- sample(1:3, 15*6*3, replace = TRUE)
dim(wt_exp) &lt;- c(dataset = 1, member = 15, sdate = 6, ftime = 3)
wt_obs &lt;- sample(1:3, 6*3, replace = TRUE)
dim(wt_obs) &lt;- c(dataset = 1, member = 1, sdate = 6, ftime = 3)
exp &lt;- NULL
exp$data &lt;- 1 : c(1 * 15 * 6 * 3 * 8 * 8)
dim(exp$data) &lt;- c(dataset = 1, member = 15, sdate = 6, ftime = 3,
                  lat = 8, lon = 8)
class(exp) &lt;- 's2dv_cube'
obs &lt;- NULL
obs$data &lt;- 101 : c(100 + 1 * 1 * 6 * 3 * 8 * 8)
dim(obs$data) &lt;- c(dataset = 1, member = 1, sdate = 6, ftime = 3,
                  lat = 8, lon = 8)
class(obs) &lt;- 's2dv_cube'
analog_vals &lt;- CST_AdamontAnalog(exp = exp, obs = obs, wt_exp = wt_exp, 
                                wt_obs = wt_obs, nanalogs = 2)
wt_exp &lt;- sample(1:3, 15*6*3, replace = TRUE)
dim(wt_exp) &lt;- c(dataset = 1, member = 15, sdate = 6, ftime = 3)
wt_obs &lt;- sample(1:3, 6*3, replace = TRUE)
dim(wt_obs) &lt;- c(dataset = 1, member = 1, sdate = 6, ftime = 3)
exp &lt;- 1 : c(1 * 15 * 6 * 3 * 8 * 8)
dim(exp) &lt;- c(dataset = 1, member = 15, sdate = 6, ftime = 3, lat = 8, lon = 8)
obs &lt;- 101 : c(100 + 1 * 1 * 6 * 3 * 8 * 8)
dim(obs) &lt;- c(dataset = 1, member = 1, sdate = 6, ftime = 3, lat = 8, lon = 8)
analog_vals &lt;- AdamontAnalog(exp = exp, obs = obs, wt_exp = wt_exp, 
                            wt_obs = wt_obs, nanalogs = 2)
</code></pre>


</div>