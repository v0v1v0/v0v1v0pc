<div class="container">

<table style="width: 100%;"><tr>
<td>set_exposure</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Set exposure time-series</h2>

<h3>Description</h3>

<p><em>Exposure</em> refers to the toxicant concentration an organism is exposed to.
In case of aquatic organisms, this would commonly be the concentration of a
toxicant in water. Other interpretations are possible depending on model
assumptions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">set_exposure(scenarios, series, ...)

## S4 method for signature 'ANY,ANY'
set_exposure(scenarios, series)

## S4 method for signature 'EffectScenario,data.frame'
set_exposure(scenarios, series, ...)

## S4 method for signature 'EffectScenario,ExposureSeries'
set_exposure(scenarios, series, reset_times = TRUE)

## S4 method for signature 'EffectScenario,list'
set_exposure(scenarios, series, ...)

## S4 method for signature 'list,list'
set_exposure(scenarios, series, ...)

## S4 method for signature 'list,ANY'
set_exposure(scenarios, series, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>scenarios</code></td>
<td>
<p><code>vector</code> of scenarios</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>series</code></td>
<td>
<p><code>vector</code> of  ExposureSeries objects or a single <code>data.frame</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reset_times</code></td>
<td>
<p><code>logical</code>, if <code>TRUE</code>, the exposure time-series' time points
will be set as output times. Defaults to <code>TRUE</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Exposure time-series are generally represented by a <code>data.frame</code> containing two
columns. The first column for time, the second representing the
exposure level. The ordering of columns is mandatory. The column names
are non-relevant but sensible names may help documenting the
scenario and its data. The <code>data.frame</code>'s rows must be ordered chronologically.
A time-series can consist of only a single row; in this case it will represent constant
exposure.
</p>
<p>For convenience, a time-series with zero exposure can be set using
<code>set_noexposure()</code>.
</p>


<h4>Computational efficiency</h4>

<p>Handling time-series is a costly task for the ODE solver due to consistency
checks and interpolation between time steps. How the solver interpolates
the time-series can be controlled by optional arguments to functions
such as <code>simulate()</code> and <code>effect()</code>. Please refer to <code>simulate()</code> for a brief
overview and deSolve::forcings for a detailed description.
</p>
<p>Exposure time-series should be kept as short as possible and as complex as
needed for optimal computational efficiency.
</p>



<h4>Output times</h4>

<p>By default, the exposure time-series' time points will also be used as output
times of the scenario. Any output times previously set by <code>set_times()</code> will
be lost. If this behavior is undesired, set the function argument
<code>reset_times=FALSE</code>.
</p>



<h4>Multiple exposure series and scenarios</h4>

<p>The functions supports modifying multiple scenarios at once: by
calling it with lists of scenario and ExposureSeries
objects. The cartesian product of all scenarios and exposure series will
be returned, iff the parameter <code>expand = TRUE</code> is set.
</p>
<p>As an example for the <em>expand</em> mode, two scenarios <code>A</code> and <code>B</code> and one
exposure series <code>g</code> will result in two scenarios <code>Ag</code> and <code>Bg</code>, both
using exposure series <code>g</code>. Two scenarios <code>A</code> and <code>B</code> as well as two
exposure seres <code>g</code> and <code>h</code> will result in four scenarios <code>Ag</code>,<code>Ah</code>,<code>Bg</code>,
and <code>Bh</code>.
</p>



<h3>Value</h3>

<p><code>list</code> of <code>EffectScenario</code> objects
</p>


<h3>Examples</h3>

<pre><code class="language-R"># set a data.frame as exposure series
Lemna_Schmitt() %&gt;% set_exposure(data.frame(time=c(0, 1, 2, 3), conc=c(1, 1, 0, 0)))

# set one ExposureSeries
es1 &lt;- ExposureSeries(data.frame(time=0, conc=0))
Lemna_Schmitt() %&gt;% set_exposure(es1)

# set two ExposureSeries to create two scenarios
es2 &lt;- ExposureSeries(data.frame(time=5:10, conc=1))
Lemna_Schmitt() %&gt;% set_exposure(c(es1, es2))

# set one ExposureSeries without resetting existing output times
Lemna_Schmitt() %&gt;%
  set_times(0:5) %&gt;%
  set_exposure(es1, reset_times=FALSE)
</code></pre>


</div>