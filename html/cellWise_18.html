<div class="container">

<table style="width: 100%;"><tr>
<td>estLocScale</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Estimate robust location and scale
</h2>

<h3>Description</h3>

<p>Estimate a robust location estimate and scale estimate of every column in <code>X</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">estLocScale(X, type = "wrap", precScale = 1e-12,
center = TRUE, alpha = 0.5, nLocScale = 25000, silent = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>The input data. It must be an <code class="reqn">n</code> by <code class="reqn">d</code> matrix or a data frame.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>The type of estimators used. One of:
</p>

<ul>
<li>
<p><code>"1stepM"</code>: <br> The location is the 1-step M-estimator with the biweight psi function. The scale estimator is the 1-step M-estimator using a Huber rho function with <code class="reqn">b = 2.5</code>.

</p>
</li>
<li>
<p><code>"mcd"</code>: <br> the location is the weighted univariate MCD estimator with cutoff <br><code class="reqn">\sqrt(qchisq(0.975,1))</code>. The scale is the corresponding weighted univariate MCD estimator, with a correction factor to make it approximately unbiased at gaussian data.
</p>
</li>
<li>
<p><code>"wrap"</code>: <br> Starting from the initial estimates corresponding to option <code>"mcd"</code>, the location is the 1-step M-estimator with the wrapping psi function with <code class="reqn">b = 1.5</code> and <code class="reqn">c = 4</code>. The scale estimator is the same as in option <code>"mcd"</code>.

</p>
</li>
</ul>
<p>Defaults to "wrap".
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>precScale</code></td>
<td>

<p>The precision scale used throughout the algorithm. Defaults to <code class="reqn">1e-12</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>

<p>Whether or not the data has to be centered before calculating the scale. Not in use for <code>type = "mcd"</code>. Defaults to <code>TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>The value of <code class="reqn">\alpha</code> in the univariate mcd, must be between 0.5 and 1. The subsetsize is <code class="reqn">h = \lceil \alpha n \rceil</code>. Only used for <code>type = "mcd"</code>. Defaults to <code class="reqn">\alpha = 0.5</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nLocScale</code></td>
<td>

<p>If <code>nLocScale</code> <code class="reqn">&lt; n</code>, <code>nLocScale</code> observations are sampled to compute the location and scale. This speeds up the computation if <code class="reqn">n</code> is very large. When <code>nLocScale</code> <code class="reqn">= 0</code> all observations are used. Defaults to <code>nLocScale</code> <code class="reqn">= 25000</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>

<p>Whether or not a warning message should be printed when very small scales are found. Defauts to <code>FALSE</code>.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with components: <br></p>

<ul>
<li>
<p><code>loc</code> <br>
A vector with the estimated locations.

</p>
</li>
<li>
<p><code>scale</code> <br>
A vector with the estimated scales.

</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Raymaekers, J. and Rousseeuw P.J.
</p>


<h3>References</h3>

<p>Raymaekers, J., Rousseeuw P.J. (2019). Fast robust correlation for high dimensional data. <em>Technometrics</em>, <b>63</b>(2), 184-198. <a href="https://www.tandfonline.com/doi/full/10.1080/00401706.2019.1677270">(link to open access pdf)</a>
</p>


<h3>See Also</h3>

<p><code>wrap</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(MASS) 
set.seed(12345) 
n = 100; d = 10
X = mvrnorm(n, rep(0, 10), diag(10))
locScale = estLocScale(X)
# For more examples, we refer to the vignette:
## Not run: 
vignette("wrap_examples")

## End(Not run)
</code></pre>


</div>