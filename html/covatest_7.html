<div class="container">

<table style="width: 100%;"><tr>
<td>couples-class</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Class "couples"</h2>

<h3>Description</h3>

<p>A class for spatial points and the corresponding temporal lags to be
analyzed in order to test some covariance properties and some well known
classes of space-time covariance functions models
<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script></p>


<h3>Usage</h3>

<pre><code class="language-R">couples(
  sel.staz,
  sp.couples.in,
  t.couples.in,
  typetest = "sym",
  typecode = numeric()
)

## S4 method for signature 'couples'
show(object)

## S4 method for signature 'couples'
x[i, by.row = FALSE, drop = FALSE]

## S4 method for signature 'couples'
summary(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sel.staz</code></td>
<td>
<p>vector, the sequence of ID codes which denote the spatial
points to be analyzed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sp.couples.in</code></td>
<td>
<p>two-column matrix: rows corresponding to the couples
of different spatial points, chosen among the ones fixed in <code>sel.staz</code>
argument, to be compared</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t.couples.in</code></td>
<td>
<p>vector of only positive (negative) temporal lags to be
analyzed. The corresponding negative (positive) temporal lags are included
authomatically for <code>typetest = "sym", "sep", "tnSep"</code>. If some temporal
lags, corresponding to some couples of spatial points, are not required for
the specific test, they can be set equal to zero, through the specific
<code>setzero</code> method</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>typetest</code></td>
<td>
<p>character, set <code>typetest = "sym"</code> for symmetry test
(default choice), <code>typetest = "sep"</code> for separability test,
<code>typetest = "tnSep"</code> for type of non separability test,
<code>typetest = "productSum"</code> for the test on the product-sum class of models,
<code>typetest = "intProduct"</code> for the test on the integrated product class
of models, <code>typetest = "gneiting"</code> for the test on the Gneiting class
of models</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>typecode</code></td>
<td>
<p>type of object, i.e. numeric() or character(), specifies the
type of codification of the spatial points in the <code>data frame</code> or in the
STFDF/STSDF</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>object of class <code>couples</code> for methods <code>show</code> and <code>summary</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>object of class <code>couples</code> for method <code>extract</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>i</code></td>
<td>
<p>index specifying rows or columns of the slot <code>@couples.st</code>.
Rows or columns depending on the logical parameter <code>by.row</code> to be set</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by.row</code></td>
<td>
<p>logical, if <code>TRUE</code> rows of the slot <code>@couples.st</code> are
selected (the temporal lags associated to the i-th spatial couple are given).
If <code>FALSE</code> (the default) columns of the slot <code>@couples.st</code> are
selected. In particular, the spatial couples associated to the i-th temporal
lag (i &gt;= 3, temporal lags are stored from the third column) are given</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop</code></td>
<td>
<p>logical, the argument is set, by default, equal to <code>FALSE</code> to
preserve the structure of the object. It is advisable not to change this option</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>It is important to point out that:
</p>

<ul>
<li>
<p> both positive and negative temporal lags are automatically considered in
the slot <code>@couples.st</code> and <code>@tl.couples</code> for symmetry test
(<code>typetest = "sym"</code>), separability test (<code>typetest = "sep"</code>) and
type of non separability tests
(<code>typetest = "tnSep"</code>). If the symmetry hyphotesis has not been rejected, only
positive temporal lags might be considered for the test on separability and type
of non separability (<code>typetest = "sep"</code> and <code>typetest = "tnSep"</code>), hence the
specific <code>setzero</code> method must be used to set the negative temporal
lags equal to zero
</p>
</li>
<li>
<p> for <code>typetest = "tnSep"</code> the temporal lags should be chosen according to
the results of the sample non separability ratios, plotted through a boxplot
classified for temporal lags (see sepindex for more details)
</p>
</li>
<li>
<p> for model tests (<code>typetest</code> equal to <code>"productSum"</code>,
<code>"intProduct"</code> and <code>"gneiting"</code>), the number of analyzed spatial
points must be used to create at least 3 spatial couples or multiple of 3,
such that each triplet satisfies the condition
\[||\mathbf{h}_{1}||^{2\gamma} - ||\mathbf{h}_{2}||^{2\gamma} = ||\mathbf{h}_{2}||^{2\gamma}-||\mathbf{h}_{3}||^{2\gamma}\]
where \(\gamma \in ]0,1]\) only for <code>typetest = "intProduct"</code>
and <code>"gneiting"</code>.
The number of positive temporal lags must be at least 3, or multiple
of 3, too. The condition \[u_{1}^{2\alpha}-u_{2}^{2\alpha}=u_{2}^{2\alpha}-u_{3}^{2\alpha}\]
where \(\alpha \in ]0,1]\) must be satisfied for each triplet
(only for <code>typetest = "intProduct"</code> and <code>"gneiting"</code>), as clarified
in Cappello et al., 2018. The values of \(\gamma\) and \(\alpha\)  are usually fixed
equal to 0.5 or 1 according that the behavior near the origin of the spatial
and temporal marginal covariograms is linear or quadratic, respectively.
Note that for each spatial triplet and each temporal triplet, 6 contrasts can
be defined. However, for <code>typetest = "intProduct"</code> (test on the integrated
model) the user has to set arbitrarily one temporal lag equal to zero for each
spatial triplet in order to delete redundant contrasts, through the specific
<code>setzero</code> method
</p>
</li>
</ul>
<h3>Slots</h3>


<dl>
<dt><code>couples.st</code></dt>
<dd>
<p>matrix, in which the first two columns contain the
couples of spatial points (denoted with order numbers) to be analyzed
and the other columns the temporal lags associated with each spatial couples</p>
</dd>
<dt><code>sel.staz</code></dt>
<dd>
<p>numeric or character, contains the ID codes of the
selected spatial points</p>
</dd>
<dt><code>sp.couples</code></dt>
<dd>
<p>data.frame, contains the couples of order numbers
associated with the spatial points to be analyzed and the couples of the
ID codes</p>
</dd>
<dt><code>tl.couples</code></dt>
<dd>
<p>numeric, contains the temporal lags associated to the
couples of the selected spatial points</p>
</dd>
<dt><code>typetest</code></dt>
<dd>
<p>character; contains the code of the test to be performed</p>
</dd>
</dl>
<h3>Note</h3>


<p>Errors occur if
</p>

<ul>
<li>
<p> some spatial points, given in the sequence at the beginning of the
function, have not been used to generate the couples of spatial points
</p>
</li>
<li>
<p> there is at least one spatial couple with no specification of
temporal lags
</p>
</li>
<li>
<p> no temporal lags have been specified
</p>
</li>
<li>
<p> the number of spatial points fixed in <code>sel.staz</code> is less than 2
</p>
</li>
<li>
<p> the construction of the <code>sp.couples.in</code> is not consistent with the
test to be performed
</p>
</li>
</ul>
<h3>References</h3>

<p>Cappello, C., De Iaco, S., Posa, D., 2020, covatest: An R Package for
Selecting a Class of Space-Time Covariance Functions.
Journal of Statistical Software, <b>94(1)</b> 1â€“42.
</p>


<h3>See Also</h3>

<p><code>setzero</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">sel.staz.sym &lt;- c("DERP016", "DENW065", "DEHE051", "DETH026", "DENW063", "DENI019",
"DENW068", "DEHE046", "DEUB029", "DEBY047", "DETH061", "DESN049")

sp.couples.in.sym &lt;- matrix(data = c("DERP016", "DENW065", "DEHE051", "DETH026",
"DENW063", "DENI019", "DENW068", "DEHE046", "DEUB029", "DEBY047", "DETH061", "DESN049"),
ncol = 2, byrow = TRUE)

t.couples.in.sym &lt;- c(1, 2)

couples.sym &lt;- couples(sel.staz = sel.staz.sym, sp.couples.in = sp.couples.in.sym,
t.couples.in = t.couples.in.sym, typetest = "sym", typecode = character())

### methods for couples
#1. show
couples.sym

#2. [ extract
couples.sym[3, by.row = FALSE]
couples.sym[3, by.row = TRUE]

#3. summary
summary(couples.sym)

</code></pre>


</div>