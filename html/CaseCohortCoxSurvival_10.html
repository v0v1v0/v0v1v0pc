<div class="container">

<table style="width: 100%;"><tr>
<td>dataexample.stratified</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Example of case-cohort with stratified sampling of the subcohort, and set of auxiliary variables
</h2>

<h3>Description</h3>

<p>List with <code>cohort</code> and <code>A</code>.
</p>
<p><code>cohort</code> is a simulated cohort with 20 000 subjects. It contains:
</p>
<p><code>id</code> is the subject identifier.
</p>
<p><code>X1</code> is a continuous baseline covariate. Its measurements are only available for subjects in the case-cohort, i.e., on subjects with <code>subcohort = 1</code> and/or <code>status = 1</code>.
</p>
<p><code>X2</code> is a categorical baseline covariate, with categories 0, 1, and 2. It is measured on all cohort subjects.
</p>
<p><code>X3</code> is a continuous baseline covariate. Its measurements are only available for subjects in the case-cohort.
</p>
<p><code>W</code> is a baseline categorical variable,  with categories 0, 1, 2, and 3. It depends on predictors of <code>X1</code> and <code>X2</code>. It is measured on all cohort subjects. The stratified sampling of the subcohort was based on the 4 strata defined by <code>W</code>.
</p>
<p><code>status</code> indicates case status.
</p>
<p><code>event.time</code> gives the event or censoring time. <code>status</code> indicates whether the subject experienced the event of interest or was censored.
</p>
<p>97, 294, 300, and 380 subjects were sampled (independently of case status) from the 4 strata, respectively. <code>subcohort</code> indicates all these subjects included in the subcohort. The stratified case-cohort (phase-two sample) consists of the subcohort and any other cases not in the subcohort.
</p>
<p><code>strata.n</code> gives the number of subjects in the stratum in the cohort.
</p>
<p><code>strata.m</code> gives the number of subjects sampled from each of the 4 strata (i.e., 97, 294, 300, or 380).
<code>strata.m</code> and <code>strata.n</code> would be used to compute the stratum-specific design weights of non-cases. Because all the cases were included in the case-cohort, they would be assigned a design weight of 1.
</p>
<p><code>strata.n.cases</code> gives the number of cases in each of the 4 strata.
</p>
<p><code>n.cases</code> gives the number of cases in the entire cohort.
</p>
<p><code>X1.proxy</code> is a continuous baseline covariate. It is a proxy of <code>X1</code>, with 0.8 correlation. It is measured on all cohort subjects. It can be used for design weights calibration in the argument <code>predictors.cox.phase2</code> of function <code>caseCohortCoxSurvival</code>, as one would need to predict <code>X1</code> on the entire cohort.
</p>
<p><code>X3.proxy</code> is a continuous baseline covariate. It is a proxy of <code>X3</code>, with 0.8 correlation. It is measured on all cohort subjects. It can be used for design weights calibration in the argument <code>predictors.cox.phase2</code> of function <code>caseCohortCoxSurvival</code>, as one would need to predict <code>X3</code> on the entire cohort.
</p>
<p><code>X1.pred</code> is a prediction of <code>X1</code>, available for all cohort subjects. The predictions were obtained by weighted linear regression on <code>X1.proxy</code> and <code>W</code>, with the design weights.
</p>
<p><code>X3.pred</code> is a prediction of <code>X3</code>, available for all cohort subjects. The predictions were obtained by weighted linear regression on <code>X1.proxy</code>,  <code>X2</code>, and <code>X3.proxy</code>, with the design weights.
</p>
<p><code>A</code> contains auxiliary variables, obtained as proposed by Breslow et al. (2009) and Shin et al. (2020). <code>A</code> can be used with argument <code>aux.var</code> of function <code>caseCohortCoxSurvival</code>.
</p>
<p>Predictions of <code>X1</code> were obtained by weighted linear regression on <code>X1.proxy</code> and <code>W</code>, with the design weights. Predictions of <code>X3</code> were obtained by weighted linear regression on <code>X1.proxy</code>,  <code>X2</code>, and <code>X3.proxy</code>, with the design weights. Then the Cox model with <code>X2</code> and the predicted values of <code>X1</code> and <code>X3</code> (available for all cohort subjects) was run. <code>A.X1</code>, <code>A.X2</code>, and <code>A.X3</code> contain the influences on the estimated log-RHs (available for all cohort subjects).
</p>
<p>Second, design weights were then calibrated based on <code>A.1</code>, <code>A.X1</code>, <code>A.X2</code>, and <code>A.X3</code>, with <code>A.1</code> that is identically equal to 1. The log-RH parameter was then estimated from the case-cohort data with these calibrated weights. Finally, the log-RH estimate was used with <code>X2</code> and the predicted values of <code>X1</code> and <code>X3</code> (available for all cohort subjects), and exponentiated. <code>A.Shin</code> contains the product of this quantity with the total follow-up time on interval (0,8].
</p>


<h3>References</h3>

<p>Etievant, L., Gail, M. H. (2024). Cox model inference for relative hazard and pure risk from stratified weight-calibrated case-cohort data. Lifetime Data Analysis, 30, 572-599.
</p>
<p>Etievant, L., Gail, M. H. (2024). Software Application Profile: CaseCohortCoxSurvival: an R package for case-cohort inference for relative hazard and pure risk under the Cox model. Submitted.
</p>
<p>Shin Y.E., Pfeiffer R.M., Graubard B.I., Gail M.H. (2020) Weight calibration to improve
the efficiency of pure risk estimates from case-control samples nested in a cohort.
Biometrics, 76, 1087-1097
</p>
<p>Breslow, N.E., Lumley, T., Ballantyne, C.M., Chambless, L.E. and Kulich, M. (2009).
Improved Horvitz-Thompson Estimation of Model Parameters from Two-phase Stratified Samples:
Applications in Epidemiology. Statistics in Biosciences, 1, 32-49.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
 data(dataexample.stratified, package="CaseCohortCoxSurvival")

 # Display some of the data
 dataexample.stratified$cohort[1:5, ]

 dataexample.stratified$A[1:5, ] # auxiliary variable values in the cohort
</code></pre>


</div>