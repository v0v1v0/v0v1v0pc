<div class="container">

<table style="width: 100%;"><tr>
<td>crossmatchtest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The Cross-Match Test</h2>

<h3>Description</h3>

<p>A test for comparing two multivariate distributions by using the distance between the observations. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">crossmatchtest(z, D)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>A binary vector corresponding to observations class labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>A distance matrix of dimensions NxN, where N is the total number of observations. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Observations are divided into pairs to minimize the total distance within pairs, using a polynomial
time algorithm made available in R by Lu, B., Greevy, R., Xu, X., and Beck, C in the R package "nbpMatching".
The cross-match test takes as the test statistic the number of times a subject from one group was
paired with a subject from another group, rejecting the hypothesis of equal distribution for small values
of the statistic; see Rosenbaum (2005) for details. 
</p>


<h3>Value</h3>

<p>A list with the following
</p>
<table>
<tr style="vertical-align: top;">
<td><code>a1 </code></td>
<td>
<p>The number of cross-matches</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ea1 </code></td>
<td>
<p>The expected number of cross-matches under the null</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Va1 </code></td>
<td>
<p>The variance of number of cross-matches under the null</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dev</code></td>
<td>
<p>The observed difference from expectation under null in SE units</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval</code></td>
<td>
<p>The p-value based on exact null distribution (NA for datasets with 340 observations or more)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>approxpval</code></td>
<td>
<p>The approximate p-value based on normal approximation</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Ruth Heller 
</p>


<h3>References</h3>

<p>Rosenbaum, P.R. (2005),
An exact distribution-free test comparing two multivariate distributions based on adjacency,
<em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em>, <b>67</b>, 4, 515-530.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## The example in Section 2 of the article (see References)

#The data consists of 2 outcomes measured on 9 treated cases and 9 controls: 
dat &lt;- rbind(c(0.47,0.39,0.47,0.78,1,1,0.54,1,0.38,1,0.27,0.63,0.22,0,-1,-0.42,-1,-1),
             c(0.03,0.11,0.16,-0.1,-0.05,0.16,0.12,0.4,0.04,0.71,0.01,0.21,-0.18,
               -0.08,-0.35,0.26,-0.6,-1.0))
z &lt;- c(rep(0,9),rep(1,9))
X &lt;- t(dat)

## Rank based Mahalanobis distance between each pair:
X &lt;- as.matrix(X)
n &lt;- dim(X)[1]
k &lt;- dim(X)[2]
for (j in 1:k) X[,j] &lt;- rank(X[,j])
cv &lt;- cov(X)
vuntied &lt;- var(1:n)
rat &lt;- sqrt(vuntied/diag(cv))
cv &lt;- diag(rat) %*% cv %*% diag(rat)
out &lt;- matrix(NA,n,n)

library(MASS)

icov &lt;- ginv(cv)
for (i in 1:n) out[i,] &lt;- mahalanobis(X,X[i,],icov,inverted=TRUE)

dis &lt;- out

## The cross-match test:

crossmatchtest(z,dis)
</code></pre>


</div>