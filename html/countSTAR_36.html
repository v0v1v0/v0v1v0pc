<div class="container">

<table style="width: 100%;"><tr>
<td>lm_star</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fitting frequentist STAR linear model via EM algorithm</h2>

<h3>Description</h3>

<p>Compute the MLEs and log-likelihood for the STAR linear model.
The regression coefficients are estimated using least squares within
an EM algorithm.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lm_star(
  formula,
  data = NULL,
  transformation = "np",
  y_max = Inf,
  sd_init = 10,
  tol = 10^-10,
  max_iters = 1000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class "<code>formula</code>" (see <code>lm</code> for details on model specification)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame, list or environment (or object coercible by as.data.frame to a data frame)
containing the variables in the model; like <code>lm</code>, if not found in data,
the variables are taken from <code>environment(formula)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transformation</code></td>
<td>
<p>transformation to use for the latent data; must be one of
</p>

<ul>
<li>
<p> "identity" (identity transformation)
</p>
</li>
<li>
<p> "log" (log transformation)
</p>
</li>
<li>
<p> "sqrt" (square root transformation)
</p>
</li>
<li>
<p> "np" (nonparametric transformation estimated from empirical CDF)
</p>
</li>
<li>
<p> "pois" (transformation for moment-matched marginal Poisson CDF)
</p>
</li>
<li>
<p> "neg-bin" (transformation for moment-matched marginal Negative Binomial CDF)
</p>
</li>
<li>
<p> "box-cox" (box-cox transformation with learned parameter)
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_max</code></td>
<td>
<p>a fixed and known upper bound for all observations; default is <code>Inf</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd_init</code></td>
<td>
<p>add random noise for EM algorithm initialization scaled by <code>sd_init</code>
times the Gaussian MLE standard deviation; default is 10</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>tolerance for stopping the EM algorithm; default is 10^-10;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_iters</code></td>
<td>
<p>maximum number of EM iterations before stopping; default is 1000</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Standard function calls including
<code>coefficients</code>, <code>fitted</code>, and <code>residuals</code> apply. Fitted values are the expectation
at the MLEs, and as such are not necessarily count-valued.
</p>


<h3>Value</h3>

<p>an object of <code>class</code> "lmstar", which is a list with the following elements:
</p>

<ul>
<li> <p><code>coefficients</code> the MLEs of the coefficients
</p>
</li>
<li> <p><code>fitted.values</code> the fitted values at the MLEs
</p>
</li>
<li> <p><code>g.hat</code> a function containing the (known or estimated) transformation
</p>
</li>
<li> <p><code>ginv.hat</code> a function containing the inverse of the transformation
</p>
</li>
<li> <p><code>sigma.hat</code> the MLE of the standard deviation
</p>
</li>
<li> <p><code>mu.hat</code> the MLE of the conditional mean (on the transformed scale)
</p>
</li>
<li> <p><code>z.hat</code> the estimated latent data (on the transformed scale) at the MLEs
</p>
</li>
<li> <p><code>residuals</code> the Dunn-Smyth residuals (randomized)
</p>
</li>
<li> <p><code>residuals_rep</code> the Dunn-Smyth residuals (randomized) for 10 replicates
</p>
</li>
<li> <p><code>logLik</code> the log-likelihood at the MLEs
</p>
</li>
<li> <p><code>logLik0</code> the log-likelihood at the MLEs for the *unrounded* initialization
</p>
</li>
<li> <p><code>lambda</code> the Box-Cox nonlinear parameter
</p>
</li>
<li>
<p> and other parameters that
(1) track the parameters across EM iterations and
(2) record the model specifications
</p>
</li>
</ul>
<h3>Note</h3>

<p>Infinite latent data values may occur when the transformed
Gaussian model is highly inadequate. In that case, the function returns
the *indices* of the data points with infinite latent values, which are
significant outliers under the model. Deletion of these indices and
re-running the model is one option, but care must be taken to ensure
that (i) it is appropriate to treat these observations as outliers and
(ii) the model is adequate for the remaining data points.
</p>


<h3>References</h3>

<p>Kowal, D. R., &amp; Wu, B. (2021).
Semiparametric count data regression for self‚Äêreported mental health.
<em>Biometrics</em>. <a href="https://doi.org/10.1111/biom.13617">doi:10.1111/biom.13617</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Simulate data with count-valued response y:
sim_dat = simulate_nb_lm(n = 100, p = 3)
y = sim_dat$y; X = sim_dat$X

# Fit model
fit_em = lm_star(y~X)

# Fitted coefficients:
coef(fit_em)
# Fitted values:
y_hat = fitted(fit_em)
plot(y_hat, y);

# Residuals:
plot(residuals(fit_em))
qqnorm(residuals(fit_em)); qqline(residuals(fit_em))
</code></pre>


</div>