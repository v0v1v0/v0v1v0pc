<div class="container">

<table style="width: 100%;"><tr>
<td>cvmaPLFAM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cross-Validation Model Averaging (CVMA) for Partial Linear Functional Additive Models (PLFAMs)</h2>

<h3>Description</h3>

<p>Summarize the estimate of weights for averaging across all candidate models for PLFAMs, using multi-fold cross-validation criterion,
and the corresponding mean squared prediction error risk. Additionally, the results of AIC, BIC, SAIC and SBIC are delivered simultaneously.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cvmaPLFAM(
  Y,
  scalars,
  functional,
  Y.test = NULL,
  scalars.test = NULL,
  functional.test = NULL,
  tt,
  nump,
  numfpcs,
  nbasis,
  nfolds,
  ratio.train = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>The vector of the scalar response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scalars</code></td>
<td>
<p>The design matrix of scalar predictors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>functional</code></td>
<td>
<p>The matrix including records/measurements of the functional predictor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y.test</code></td>
<td>
<p>Test data: The vector of the scalar response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scalars.test</code></td>
<td>
<p>Test data: The design matrix of scalar predictors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>functional.test</code></td>
<td>
<p>Test data: The matrix including records/measurements of the functional predictor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tt</code></td>
<td>
<p>The vector of recording/measurement points for the functional predictor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nump</code></td>
<td>
<p>The number of scalar predictors in candidate models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numfpcs</code></td>
<td>
<p>The number of functional principal components (FPCs) for the functional predictor in candidate models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbasis</code></td>
<td>
<p>The number of basis functions used for spline approximation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nfolds</code></td>
<td>
<p>The number of folds used in cross-validation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratio.train</code></td>
<td>
<p>The ratio of data for training, if test data are <code>NULL</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>list</code> of
</p>
<table>
<tr style="vertical-align: top;">
<td><code>aic</code></td>
<td>
<p>Mean squared error risk in training data set, produced by AIC model selection method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bic</code></td>
<td>
<p>Mean squared error risk in training data set, produced by BIC model selection method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>saic</code></td>
<td>
<p>Mean squared error risk in training data set, produced by SAIC model averaging method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sbic</code></td>
<td>
<p>Mean squared error risk in training data set, produced by SBIC model averaging method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv</code></td>
<td>
<p>Mean squared error risk in training data set, produced by CVMA method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>waic</code></td>
<td>
<p>The selected candidate model by AIC model selection method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wbic</code></td>
<td>
<p>The selected candidate model by BIC model selection method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wsaic</code></td>
<td>
<p>The weights for each candidate model by SAIC model averaging method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wsbic</code></td>
<td>
<p>The weights for each candidate model by SBIC model averaging method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wcv</code></td>
<td>
<p>The weights for each candidate model by CVMA method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predaic</code></td>
<td>
<p>Mean squared prediction error risk in test data set, produced by AIC model selection method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predbic</code></td>
<td>
<p>Mean squared prediction error risk in test data set, produced by BIC model selection method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predsaic</code></td>
<td>
<p>Mean squared prediction error risk in test data set, produced by SAIC model averaging method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predsbic</code></td>
<td>
<p>Mean squared prediction error risk in test data set, produced by SBIC model averaging method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predcv</code></td>
<td>
<p>Mean squared prediction error risk in test data set, produced by CVMA method.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R"># Generate simulated data
simdata = data_gen(R = 0.7, K = 1, n = 50, M0 = 20, typ = 1, design = 3)
dat1 = simdata[[1]]
scalars = dat1[,1:20]
fd = dat1[,21:120]
Y = dat1[,122]
tps = seq(0, 1, length.out = 100)

# Estimation
est_res = cvmaPLFAM(Y=Y, scalars = scalars, functional = fd, tt = tps,
       nump = 2, numfpcs = 3, nbasis = 50, nfolds = 5, ratio.train = 0.8)
# Weights estimated by CVMA method
est_res$wcv
# Prediction error risk on test data set
est_res$predcv

</code></pre>


</div>