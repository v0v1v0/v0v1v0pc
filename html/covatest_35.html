<div class="container">

<table style="width: 100%;"><tr>
<td>covastat-class</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Class "covastat"</h2>

<h3>Description</h3>

<p>A class for the sample spatio-temporal covariances for the specified spatial
and temporal lags, given in <code>stpairs</code> (object of class <code>couples</code>),
for symmetry, separability and type of non separability tests.
Depending on the type of test, the empirical variance, the sample spatial
and temporal marginal covariances are also computed
</p>


<h3>Usage</h3>

<pre><code class="language-R">covastat(matdata, pardata1, pardata2, stpairs, typetest = "sym")

## S4 method for signature 'covastat'
show(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>matdata</code></td>
<td>
<p>STFDF/STSDF or <code>data.frame</code>, which contains the
coordinates of the spatial points, the identification code of the spatial
points, the indentification code of the temporal points and the values of
the variable, typically output from <code>read.STdata</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pardata1</code></td>
<td>
<p>integer, it represents the column in which the spatial ID is
stored (if the spatio-temporal data set is given as data.frame) or the number of
variables in the STFDF/STSDF (if the data are given as a STFDF/STSDF)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pardata2</code></td>
<td>
<p>integer, it represents the column in which the values of the
variable are stored (if the spatio-temporal data set is given as data.frame) or
the slot in which the values of the variable of interest are stored
(if the data are given as a STFDF/STSDF). Note that for STFDF/STSDF the
argument is set, by default, equal to 1 if the number of variables is equal to 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stpairs</code></td>
<td>
<p>object of class <code>couples</code>, containing the spatial
points and the corresponding temporal lags to be analyzed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>typetest</code></td>
<td>
<p>character, set <code>typetest = "sym"</code> for symmetry test
(default choice), <code>typetest = "sep"</code> for separability test, <code>typetest = "tnSep"</code>
for type of non separability test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>object of class <code>covastat</code> for method <code>show</code></p>
</td>
</tr>
</table>
<h3>Details</h3>



<ul>
<li>
<p> A message appears on the user's console if the <code>G</code> vector
contains spatio-temporal negative covariances. The message returns the negative
value/values and it will help to identify the spatial and the temporal lags
involved
</p>
</li>
<li>
<p> If <code>typetest = "sym"</code> (symmetry test) <code>cova.h</code>, <code>cova.u</code>,
<code>f.G</code> and <code>B</code> are not available
</p>
</li>
</ul>
<h3>Slots</h3>


<dl>
<dt><code>G</code></dt>
<dd>
<p>matrix, containing the spatio-temporal covariances for the specified
lags. For all tests, except for the symmetry test (<code>typetest = "sym"</code>), the
sample variance and the sample spatial and temporal marginal covariances are
also computed and stored in <code>G</code></p>
</dd>
<dt><code>cova.h</code></dt>
<dd>
<p>matrix, containing the sample spatial marginal covariances
for the specified lags</p>
</dd>
<dt><code>cova.u</code></dt>
<dd>
<p>matrix, containing the sample temporal marginal covariances
for the specified lags</p>
</dd>
<dt><code>f.G</code></dt>
<dd>
<p>array, containing the computation of specific functions of the
elements of <code>G</code>, see references</p>
</dd>
<dt><code>B</code></dt>
<dd>
<p>matrix, containing the computation of the derivatives of each element
of <code>f.G</code> with respect to each element of <code>G</code></p>
</dd>
<dt><code>A</code></dt>
<dd>
<p>contrast matrix</p>
</dd>
<dt><code>typetest</code></dt>
<dd>
<p>character, contains the code of the test to be performed</p>
</dd>
</dl>
<h3>Note</h3>


<ul>
<li>
<p> A stop occurs if the number of spatial points fixed in <code>stpairs</code>
(object of class <code>couples</code>) is less than 2
</p>
</li>
<li>
<p> A stop occurs if more than 75\
series, since a large number of missing values do not guarantee the reliability
of the tests
</p>
</li>
</ul>
<h3>References</h3>

<p>Cappello, C., De Iaco, S., Posa, D., 2018, Testing the type of
non-separability and some classes of space-time covariance function models.
Stochastic Environmental Research and Risk Assessment,
<b>32</b> 17–35
</p>
<p>Cappello, C., De Iaco, S., Posa, D., 2020, covatest: An R Package for
Selecting a Class of Space-Time Covariance Functions.
Journal of Statistical Software, <b>94(1)</b> 1–42.
</p>
<p>De Iaco, S., Palma, M., Posa, D., 2016. A general procedure for selecting a
class of fully symmetric space-time covariance functions.
Environmentrics, <b>27(4)</b> 212–224.
</p>
<p>Li, B., Genton, M.G., Sherman, M., 2007, A nonparametric assessment
of properties of spacetime covariance functions.
Journal of the American Statistical Association, <b>102</b> 736–744.
</p>


<h3>See Also</h3>

<p>couples
</p>
<p><code>read.STdata</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># --start define the STFDF rr_13-- #
library(sp)
library(spacetime)
#library(gstat)
data(air)
ls()
if (!exists("rural")) rural = STFDF(stations, dates, data.frame(PM10 =
as.vector(air)))
rr = rural[,"2005::2010"]
unsel = which(apply(as(rr, "xts"), 2, function(x) all(is.na(x))))
r5to10 = rr[-unsel,]
rr_13 &lt;- r5to10[c("DEHE046","DESN049","DETH026","DENW063","DETH061","DEBY047",
"DENW065","DEUB029","DENW068","DENI019","DEHE051","DERP016","DENI051"),
"2005::2006"]
# --end define the STFDF rr_13-- #

sel.staz.sym &lt;- c("DERP016", "DENW065", "DEHE051", "DETH026", "DENW063", "DENI019",
"DENW068", "DEHE046", "DEUB029", "DEBY047", "DETH061", "DESN049")

sp.couples.in.sym &lt;- matrix(data = c("DERP016", "DENW065", "DEHE051", "DETH026",
"DENW063", "DENI019", "DENW068", "DEHE046", "DEUB029", "DEBY047", "DETH061", "DESN049"),
ncol = 2, byrow = TRUE)

t.couples.in.sym &lt;- c(1, 2)

couples.sym &lt;- couples(sel.staz = sel.staz.sym, sp.couples.in = sp.couples.in.sym,
t.couples.in = t.couples.in.sym, typetest = "sym", typecode = character())

covast.sym &lt;- covastat(matdata = rr_13, pardata1 = 1, pardata2 = 1,
stpairs = couples.sym, typetest = "sym")

### method for covastat
#1. show
covast.sym

</code></pre>


</div>