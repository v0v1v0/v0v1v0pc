<div class="container">

<table style="width: 100%;"><tr>
<td>RF_Weights</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute climatological weights for RainFARM stochastic precipitation downscaling</h2>

<h3>Description</h3>

<p>Compute climatological ("orographic") weights from a fine-scale 
precipitation climatology file.
</p>


<h3>Usage</h3>

<pre><code class="language-R">RF_Weights(
  zclim,
  latin,
  lonin,
  nf,
  lat,
  lon,
  fsmooth = TRUE,
  lonname = "lon",
  latname = "lat",
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>zclim</code></td>
<td>
<p>A multi-dimensional array with named dimension containing at 
least one precipiation field with spatial dimensions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>latin</code></td>
<td>
<p>A vector indicating the latitudinal coordinates corresponding to 
the <code>zclim</code> parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lonin</code></td>
<td>
<p>A vector indicating the longitudinal coordinates corresponding to 
the <code>zclim</code> parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nf</code></td>
<td>
<p>Refinement factor for downscaling (the output resolution is 
increased by this factor).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lat</code></td>
<td>
<p>Vector of latitudes. The number of longitudes and latitudes is 
expected to be even and the same. If not the function will perform a 
subsetting to ensure this condition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lon</code></td>
<td>
<p>Vector of longitudes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fsmooth</code></td>
<td>
<p>Logical to use smooth conservation (default) or large-scale 
box-average conservation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lonname</code></td>
<td>
<p>A character string indicating the name of the longitudinal 
dimension set as 'lon' by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>latname</code></td>
<td>
<p>A character string indicating the name of the latitudinal 
dimension set as 'lat' by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>An integer that indicates the number of cores for parallel 
computations using multiApply function. The default value is one.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class 's2dv_cube' containing in matrix <code>data</code> the 
weights with dimensions (lon, lat).
</p>


<h3>Author(s)</h3>

<p>Jost von Hardenberg - ISAC-CNR, <a href="mailto:j.vonhardenberg@isac.cnr.it">j.vonhardenberg@isac.cnr.it</a>
</p>


<h3>References</h3>

<p>Terzago, S., Palazzi, E., &amp; von Hardenberg, J. (2018).
Stochastic downscaling of precipitation in complex orography: 
A simple method to reproduce a realistic fine-scale climatology.
Natural Hazards and Earth System Sciences, 18(11),
2825-2840. doi: <a href="https://doi.org/10.5194/nhess-18-2825-2018">10.5194/nhess-18-2825-2018</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">a &lt;- array(1:2500, c(lat = 50, lon = 50))
res &lt;- RF_Weights(a, seq(0.1 ,5, 0.1), seq(0.1 ,5, 0.1), 
                 nf = 5, lat = 1:5, lon = 1:5)
</code></pre>


</div>