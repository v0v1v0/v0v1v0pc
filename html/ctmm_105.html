<div class="container">

<table style="width: 100%;"><tr>
<td>simulate.ctmm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Predict or simulate from a continuous-time movement model</h2>

<h3>Description</h3>

<p>Given a <code>ctmm</code> movement model (and optional <code>telemetry</code> data to condition upon) these functions predict or simulate animal locations over a prescribed set of times.
</p>


<h3>Usage</h3>

<pre><code class="language-R">predict(object,...)

## S3 method for class 'ctmm'
predict(object,data=NULL,VMM=NULL,t=NULL,dt=NULL,res=1,complete=FALSE,...)

## S3 method for class 'telemetry'
predict(object,CTMM=NULL,VMM=NULL,t=NULL,dt=NULL,res=1,complete=FALSE,...)

simulate(object,nsim=1,seed=NULL,...)

## S3 method for class 'ctmm'
simulate(object,nsim=1,seed=NULL,data=NULL,VMM=NULL,t=NULL,dt=NULL,res=1,complete=FALSE,
         precompute=FALSE,...)

## S3 method for class 'telemetry'
simulate(object,nsim=1,seed=NULL,CTMM=NULL,VMM=NULL,t=NULL,dt=NULL,res=1,complete=FALSE,
         precompute=FALSE,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A <code>ctmm</code> movement-model or <code>telemetry</code> object, which requires an additional <code>CTMM</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Optional <code>telemetry</code> object on which the prediction or simulation will be conditioned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CTMM</code></td>
<td>
<p>A <code>ctmm</code> movement model in the same format as the output of <code>ctmm.fit</code> or <code>variogram.fit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VMM</code></td>
<td>
<p>An optional vertical <code>ctmm</code> movement model for 3D predictions and simulations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>Optional array of numeric time values over which the process will be predicted or simulated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dt</code></td>
<td>
<p>Timestep to space the prediction or simulation over if <code>data</code> is specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res</code></td>
<td>
<p>Average number of locations to predict or simulate per <code>data</code> time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>complete</code></td>
<td>
<p>Additionally calculate timestamps and geographic coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>Generates a list of <code>nsim</code> simulations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Optional random seed to fix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>precompute</code></td>
<td>
<p>Precalculate matrices of the Kalman filter (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Unused options.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The prediction or simulation necessarily requires a <code>ctmm</code> model object.
If a <code>telemetry</code> <code>data</code> object is supplied, the output will be conditional on the <code>data</code> (i.e., simulations that run through the data).
If no <code>data</code> is provided then the output will be purely Gaussian, and times <code>t</code> must be provided.
Details of the movement model parameters can be found in <code>ctmm.fit</code>.
</p>
<p>The <code>t</code> argument fixes the output times to a specific array of times.
The <code>dt</code> and <code>res</code> arguments are relative to the sampling schedule present in the optional <code>telemetry</code> object.
The same span of time will be used, while <code>dt</code> will fix the sampling rate absolutely and <code>res</code> will fix the sampling rate relative to that of the data.
</p>
<p>The <code>precompute</code> option can speed up calculations of multiple simulations of the same model, data, and <em>irregular</em> sampling schedule.
First run <code>simulate</code> with <code>precompute=TRUE</code> to calculate and store all of the necessary matrices of the Kalman filter.
A simulated <code>telemetry</code> object will be produced, as usual, and the precomputed objects are stored in the environment.
Subsequent simulations with <code>precompute=-1</code> will then apply these precomputed matrices for a computational cost savings.
If the sampling schedule is irregular, then this can result in faster simulations.
</p>


<h3>Value</h3>

<p> A simulated animal-tracking <code>telemetry</code> object with components <code>t</code>, <code>x</code>, and <code>y</code>, or a predicted <code>telemetry</code> object that also includes <code>x</code>-<code>y</code> covariances for the location point estimates <code>x</code> and <code>y</code>. </p>


<h3>Note</h3>

<p> Predictions are autocorrelated and should not be treated as data. </p>


<h3>Author(s)</h3>

<p> C. H. Fleming. </p>


<h3>References</h3>

<p>C. H. Fleming, J. M. Calabrese, T. Mueller, K.A. Olson, P. Leimgruber, W. F. Fagan,
“From fine-scale foraging to home ranges: A semi-variance approach to identifying movement modes across spatiotemporal scales”,
The American Naturalist, 183:5, E154-E167 (2014) <a href="https://doi.org/10.1086/675504">doi:10.1086/675504</a>.
</p>
<p>C. H. Fleming, D. Sheldon, E. Gurarie, W. F. Fagan, S. LaPoint, J. M. Calabrese,
“Kálmán filters for continuous-time movement models”,
Ecological Informatics, 40, 8-21 (2017) <a href="https://doi.org/10.1016/j.ecoinf.2017.04.008">doi:10.1016/j.ecoinf.2017.04.008</a>.
</p>


<h3>See Also</h3>

 <p><code>ctmm.fit</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">
#Load package
library(ctmm)

#prepare simulation parameters
t &lt;- 1:1000
MODEL &lt;- ctmm(tau=c(100,10),sigma=10,mu=c(0,0))

#simulate data
SIM &lt;- simulate(MODEL,t=t)

#plot data with Gaussian model
plot(SIM,CTMM=MODEL)
</code></pre>


</div>