<div class="container">

<table style="width: 100%;"><tr>
<td>data-transformations</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Data Transformations</h2>

<h3>Description</h3>

<p><em>collapse</em> provides an ensemble of functions to perform common data transformations efficiently and user friendly:
</p>

<ul>
<li> <p><code>dapply</code> <b>applies functions to rows or columns</b> of matrices and data frames, preserving the data format.
</p>
</li>
<li> <p><code>BY</code> is an S3 generic for efficient <b>Split-Apply-Combine computing</b>, similar to <code>dapply</code>.
</p>
</li>
<li>
<p> A set of arithmetic operators facilitates <b>row-wise</b> <code>%rr%</code>, <code>%r+%</code>, <code>%r-%</code>, <code>%r*%</code>, <code>%r/%</code> and
<b>column-wise</b> <code>%cr%</code>, <code>%c+%</code>, <code>%c-%</code>, <code>%c*%</code>, <code>%c/%</code> <b>replacing and sweeping operations</b> involving a vector and a matrix or data frame / list. Since v1.7, the operators <code>%+=%</code>, <code>%-=%</code>, <code>%*=%</code> and <code>%/=%</code> do column- and element- wise math by reference, and the function <code>setop</code> can also perform sweeping out rows by reference.
</p>
</li>
<li> <p><code>(set)TRA</code> is a more advanced S3 generic to efficiently perform <b>(groupwise) replacing and sweeping out of statistics</b>, either by creating a copy of the data or by reference. 
Supported operations are:
</p>

<table>
<tr>
<td style="text-align: left;">
<em> Integer-id </em>  </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> <em> String-id </em>  </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> <em> Description </em>  </td>
</tr>
<tr>
<td style="text-align: left;"> 
                 0 </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> "na" or "replace_na"   </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> replace only missing values </td>
</tr>
<tr>
<td style="text-align: left;">
                 1 </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> "fill" or "replace_fill"   </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> replace everything </td>
</tr>
<tr>
<td style="text-align: left;">
                 2 </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> "replace" </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> replace data but preserve missing values </td>
</tr>
<tr>
<td style="text-align: left;">
                 3 </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> "-"   </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> subtract </td>
</tr>
<tr>
<td style="text-align: left;">
                 4 </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> "-+"  </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> subtract group-statistics but add group-frequency weighted average of group statistics </td>
</tr>
<tr>
<td style="text-align: left;">
                 5 </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> "/"   </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> divide </td>
</tr>
<tr>
<td style="text-align: left;">
                 6 </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> "%"     </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> compute percentages </td>
</tr>
<tr>
<td style="text-align: left;">
                 7 </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> "+" </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> add </td>
</tr>
<tr>
<td style="text-align: left;">
                 8 </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> "*" </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> multiply </td>
</tr>
<tr>
<td style="text-align: left;">
                 9 </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> "%%" </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> modulus </td>
</tr>
<tr>
<td style="text-align: left;">
                 10 </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> "-%%" </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> subtract modulus

</td>
</tr>
</table>
<p>All of <em>collapse</em>'s Fast Statistical Functions have a built-in <code>TRA</code> argument for faster access (i.e. you can compute (groupwise) statistics and use them to transform your data with a single function call).
</p>
</li>
<li> <p><code>fscale/STD</code> is an S3 generic to perform (groupwise and / or weighted) <b>scaling / standardizing</b> of data and is orders of magnitude faster than <code>scale</code>.
</p>
</li>
<li> <p><code>fwithin/W</code> is an S3 generic to efficiently perform (groupwise and / or weighted) <b>within-transformations / demeaning / centering</b> of data. Similarly <code>fbetween/B</code> computes (groupwise and / or weighted) <b>between-transformations / averages</b> (also a lot faster than <code>ave</code>).
</p>
</li>
<li> <p><code>fhdwithin/HDW</code>, shorthand for 'higher-dimensional within transform', is an S3 generic to efficiently <b>center data on multiple groups and partial-out linear models</b> (possibly involving many levels of fixed effects and interactions). In other words, <code>fhdwithin/HDW</code> efficiently computes <b>residuals</b> from linear models. Similarly <code>fhdbetween/HDB</code>, shorthand for 'higher-dimensional between transformation', computes the corresponding means or <b>fitted values</b>.
</p>

</li>
<li> <p><code>flag/L/F</code>, <code>fdiff/D/Dlog</code> and <code>fgrowth/G</code> are S3 generics to compute sequences of <b>lags / leads</b> and suitably lagged and iterated (quasi-, log-) <b>differences</b> and <b>growth rates</b> on time series and panel data. <code>fcumsum</code> flexibly computes (grouped, ordered) cumulative sums. More in Time Series and Panel Series.
</p>
</li>
<li> <p><code>STD, W, B, HDW, HDB, L, D, Dlog</code> and <code>G</code> are parsimonious wrappers around the <code>f-</code> functions above representing the corresponding transformation 'operators'. They have additional capabilities when applied to data-frames (i.e. variable selection, formula input, auto-renaming and id-variable preservation), and are easier to employ in regression formulas, but are otherwise identical in functionality.
</p>
</li>
</ul>
<h3>Table of Functions</h3>


<table>
<tr>
<td style="text-align: left;">
<em> Function / S3 Generic </em>   </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> <em> Methods </em>  </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> <em> Description </em>  </td>
</tr>
<tr>
<td style="text-align: left;"> 
  <code>dapply</code> </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> No methods, works with matrices and data frames </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> Apply functions to rows or columns </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>BY</code> </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> <code>default, matrix, data.frame, grouped_df</code> </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> Split-Apply-Combine computing </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>%(r/c)(r/+/-/*//)%</code> </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> No methods, works with matrices and data frames / lists </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> Row- and column-arithmetic </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>(set)TRA</code> </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> <code>default, matrix, data.frame, grouped_df</code> </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> Replace and sweep out statistics (by reference) </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>fscale/STD</code> </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> <code>default, matrix, data.frame, pseries, pdata.frame, grouped_df</code> </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> Scale / standardize data </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>fwithin/W</code> </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> <code>default, matrix, data.frame, pseries, pdata.frame, grouped_df</code>  </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> Demean / center data </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>fbetween/B</code> </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> <code>default, matrix, data.frame, pseries, pdata.frame, grouped_df</code>  </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> Compute means / average data </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>fhdwithin/HDW</code> </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> <code>default, matrix, data.frame, pseries, pdata.frame</code> </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> High-dimensional centering and lm residuals </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>fhdbetween/HDB</code> </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> <code>default, matrix, data.frame, pseries, pdata.frame</code> </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> High-dimensional averages and lm fitted values </td>
</tr>
<tr>
<td style="text-align: left;">
  
  <code>flag/L/F</code>, <code>fdiff/D/Dlog</code>, <code>fgrowth/G</code>, <code>fcumsum</code> </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> <code>default, matrix, data.frame, pseries, pdata.frame, grouped_df</code>  </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> (Sequences of) lags / leads, differences, growth rates and cumulative sums
</td>
</tr>
</table>
<h3>See Also</h3>

<p>Collapse Overview, Fast Statistical Functions, Time Series and Panel Series
</p>


</div>