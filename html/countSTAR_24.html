<div class="container">

<table style="width: 100%;"><tr>
<td>g_bnp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayesian bootstrap-based transformation</h2>

<h3>Description</h3>

<p>Compute one posterior draw from the smoothed transformation
implied by (separate) Bayesian bootstrap models for the CDFs
of <code>y</code> and <code>X</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">g_bnp(
  y,
  xtSigmax = rep(0, length(y)),
  zgrid = NULL,
  sigma_epsilon = 1,
  approx_Fz = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p><code>n x 1</code> vector of observed counts</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xtSigmax</code></td>
<td>
<p><code>n x 1</code> vector of <code>t(X_i) Sigma_theta X_i</code>,
where <code>Sigma_theta</code> is the prior variance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zgrid</code></td>
<td>
<p>optional vector of grid points for evaluating the CDF
of z (<code>Fz</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma_epsilon</code></td>
<td>
<p>latent standard deviation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>approx_Fz</code></td>
<td>
<p>logical; if TRUE, use a normal approximation for <code>Fz</code>,
the marginal CDF of the latent z, which is faster and more stable</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A smooth monotone function which can be used for evaluations of the transformation
at each posterior draw.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Sample some data:
y = rpois(n = 200, lambda = 5)
# Compute 200 draws of g on a grid:
t = seq(0, max(y), length.out = 100) # grid
g_post = t(sapply(1:500, function(s) g_bnp(y, approx_Fz = TRUE)(t)))
# Plot together:
plot(t, t, ylim = range(g_post), type='n', ylab = 'g(t)',  main = 'Bayesian bootstrap posterior: g')
apply(g_post, 1, function(g) lines(t, g, col='gray'))
# And the posterior mean of g:
lines(t, colMeans(g_post), lwd=3)

</code></pre>


</div>