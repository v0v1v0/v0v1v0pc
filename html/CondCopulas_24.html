<div class="container">

<table style="width: 100%;"><tr>
<td>computeKernelMatrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Computing the kernel matrix</h2>

<h3>Description</h3>

<p>This function computes a matrix of dimensions <code>(length(observedX3), length(newX3))</code>,
whose element at coordinate <code>(i,j)</code> is
<code class="reqn"> K_{h}(</code><code>observedX3</code><code class="reqn">[i] - </code><code>newX3</code><code class="reqn">[j] )</code>,
where <code class="reqn">K_h(x) := K(x/h) / h</code> and <code class="reqn">K</code> is the <code>kernel</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">computeKernelMatrix(observedX, newX, kernel, h)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>observedX</code></td>
<td>
<p>a numeric vector of observations of X3.
on the interval <code class="reqn">[0,1]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newX</code></td>
<td>
<p>a numeric vector of points of X3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel</code></td>
<td>
<p>a character string describing the kernel to be used.
Possible choices are <code>Gaussian</code>, <code>Triangular</code> and <code>Epanechnikov</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>the bandwidth</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a numeric matrix of dimensions <code>(length(observedX), length(newX))</code>
</p>


<h3>See Also</h3>

<p><code>estimateCondCDF_matrix</code>, <code>estimateCondCDF_vec</code>,
</p>


<h3>Examples</h3>

<pre><code class="language-R">Y = MASS::mvrnorm(n = 100, mu = c(0,0), Sigma = cbind(c(1, 0.9), c(0.9, 1)))
matrixK = computeKernelMatrix(observedX = Y[,2], newX = c(0, 1, 2.5),
kernel = "Gaussian", h = 0.8)

# To have an estimator of the conditional expectation of Y1 given Y2 = 0, 1, 2.5
Y[,1] * matrixK[,1] / sum(matrixK[,1])
Y[,1] * matrixK[,2] / sum(matrixK[,2])
Y[,1] * matrixK[,3] / sum(matrixK[,3])

</code></pre>


</div>