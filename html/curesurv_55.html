<div class="container">

<table style="width: 100%;"><tr>
<td>plot.predCuresurv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>plot method for curesurv prediction objects</h2>

<h3>Description</h3>

<p>Produces figures of (excess) hazard, (net) survival and
probability P(t) of being cured at a given time t after diagnosis knowing
that he/she was alive up to time t.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'predCuresurv'
plot(
  x,
  fun = "all",
  conf.int = FALSE,
  conf.type = c("log", "log-log", "plain"),
  legend.out = TRUE,
  xlab = "Time since diagnosis",
  ylab.haz = "excess hazard",
  ylab.surv = "net survival",
  ylab.ptcure = "P(t)",
  ylab.cumhaz = "cumulative excess hazard",
  ylab.logcumhaz = "logarithm of cumulative excess hazard",
  col.haz = "black",
  col.surv = "black",
  col.ptcure = "black",
  col.cumhaz = "black",
  col.logcumhaz = "black",
  col.tau = "red",
  col.ttc = "green4",
  col.p95 = "black",
  col.pi = "blue",
  lty.surv = 1,
  lty.haz = 1,
  lty.ptcure = 1,
  lty.cumhaz = 1,
  lty.logcumhaz = 1,
  lty.pi = 2,
  lty.tau = 2,
  lty.ttc = 3,
  lty.p95 = 4,
  lty.ic = 5,
  lwd.main = 1,
  lwd.sub = 1,
  lwd.ic = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>result of the <code>predCuresurv</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fun</code></td>
<td>
<p>in "haz" or "surv" or "pt_cure", "cumhaz", "logcumhaz", the plot
produced is that of (excess) hazard, or that of (net) survival, or that of
the probability P(t) of being cured at a given time t after diagnosis
knowing that he/she was alive up to time t is provided, or that of
cumulative hazard or that of the logarithm of the cumulative hazard; if
<code>fun = "all"</code>, the plots of the three first indicators are produced.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.int</code></td>
<td>
<p>an argument expected to be TRUE if the confidence intervals of the
related-indicator specified by the argument "fun" are needed. The default
option is FALSE. Confidence intervals are not available for <code>fun="cumhaz"</code> and <code>fun="logcumhaz"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.type</code></td>
<td>
<p>One of "plain", "log", "log-log".
The first option causes the standard intervals curve +- k *se(curve),
where k is determined from conf.int. The log option calculates intervals
based on log(curve). The log-log option bases
the intervals on the log(-log(curve)).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.out</code></td>
<td>
<p>an argument deciding the place of the legend if <code>fun="all"</code>.
The default value is TRUE and forces most of the legend on the empty bottom-right plot slot.
If value is FALSE, the legend will be printed entirely in each subplot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>label for the x-axis of the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab.haz</code></td>
<td>
<p>optional label for the y-axis of the plot of excess hazard</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab.surv</code></td>
<td>
<p>optional label for the y-axis of the plot of net survival</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab.ptcure</code></td>
<td>
<p>optional label for the y-axis of the plot of the probability
<code>P(t)</code> of being cured at a given time t after diagnosis knowing that
he/she was alive up to time t</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab.cumhaz</code></td>
<td>
<p>optional label for the y-axis of the plot of cumulative excess hazard</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab.logcumhaz</code></td>
<td>
<p>optional label for the y-axis of the plot of logarithm of cumulative excess hazard</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.haz</code></td>
<td>
<p>optional argument to specify the color of curve of the excess hazard</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.surv</code></td>
<td>
<p>optional argument to specify the color of curve of the net survival</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.ptcure</code></td>
<td>
<p>optional argument to specify the color of curve of probability
<code>P(t)</code> of being cured at a given time t after diagnosis knowing that
he/she was alive up to time <code>t</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.cumhaz</code></td>
<td>
<p>optional argument to specify the color of curve of cumulative excess hazard</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.logcumhaz</code></td>
<td>
<p>optional argument to specify the color of curve of the logarithm of cumulative excess hazard</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.tau</code></td>
<td>
<p>optional argument to specify the color of curve of time-to-null excess hazard</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.ttc</code></td>
<td>
<p>optional argument to specify the color of curve of time-to-cure</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.p95</code></td>
<td>
<p>optional argument to specify the color for the line highlighting <code class="reqn">\epsilon</code> when <code class="reqn">P(t) \ge 1-\epsilon</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.pi</code></td>
<td>
<p>optional argument to specify the color of cure proportion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty.surv</code></td>
<td>
<p>stands for line types for net survival</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty.haz</code></td>
<td>
<p>stands for line types for excess hazard</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty.ptcure</code></td>
<td>
<p>stands for line types for probability P(t) of being cured
at a given time t after diagnosis knowing that he/she was alive up to time t.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty.cumhaz</code></td>
<td>
<p>stands for line types for cumulative excess hazard</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty.logcumhaz</code></td>
<td>
<p>stands for line types for logarithm cumulative excess hazard</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty.pi</code></td>
<td>
<p>stands for line types for cure proportion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty.tau</code></td>
<td>
<p>stands for line types for time-to-null excess hazard</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty.ttc</code></td>
<td>
<p>stands for line types for time-to-cure</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty.p95</code></td>
<td>
<p>stands for line types for the line highlighting <code class="reqn">\epsilon</code> when <code class="reqn">P(t) \ge 1-\epsilon</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty.ic</code></td>
<td>
<p>stands for line types for confidence intervals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd.main</code></td>
<td>
<p>line width for the main line (haz, surv, pt_cure, cumhaz, logcumhaz)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd.sub</code></td>
<td>
<p>line width for the additionnal lines (ttc, p95, tau...)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd.ic</code></td>
<td>
<p>line width for the confidence intervals lines</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional options as in the classical plot method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>optional label for the y-axis of the plot. Depending to the curve
of interest (hazard, survival, probability of being cured at a given time t,
or all),the argument must be named <code>ylab.haz, ylab.surv, ylab.ptcure</code>.
If missing some default labels are provided depending on the curve of
interest. This name can be found in the data.frame from the result of
the <code>predict.curesurv</code> function.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>No value is returned.
</p>


<h3>Author(s)</h3>

<p>Juste Goungounga, Judith Breaud, Eugenie Blandin, Olayide Boussari, Valerie Jooste
</p>


<h3>See Also</h3>

<p><code>predict.curesurv()</code>, <code>print.curesurv()</code>, <code>curesurv()</code>, <code>browseVignettes("curesurv")</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">


library("curesurv")
library("survival")

 testiscancer$age_crmin &lt;- (testiscancer$age- min(testiscancer$age)) /
              sd(testiscancer$age)

fit_m1_ad_tneh &lt;- curesurv(Surv(time_obs, event) ~ z_tau(age_crmin) +
                          z_alpha(age_crmin),
                          pophaz = "ehazard",
                          cumpophaz = "cumehazard",
                          model = "nmixture", dist = "tneh",
                          link_tau = "linear",
                          data = testiscancer,
                          method_opt = "L-BFGS-B")

 fit_m1_ad_tneh


#'  #mean of age
 newdata1 &lt;- with(testiscancer,
 expand.grid(event = 0, age_crmin = mean(age_crmin), time_obs  = seq(0.001,10,0.1)))

 pred_agemean &lt;- predict(object = fit_m1_ad_tneh, newdata = newdata1)


 #max of age
 newdata2 &lt;- with(testiscancer,
 expand.grid(event = 0,
 age_crmin = max(age_crmin),
  time_obs  = seq(0.001,10,0.1)))

 pred_agemax &lt;- predict(object = fit_m1_ad_tneh, newdata = newdata2)

   # predictions at time 2 years and  of age

   newdata3 &lt;- with(testiscancer,
      expand.grid(event = 0,
      age_crmin = seq(min(testiscancer$age_crmin),max(testiscancer$age_crmin), 0.1),
      time_obs  = 2))

   pred_age_val &lt;- predict(object = fit_m1_ad_tneh, newdata = newdata3)

 #plot of 3 indicators for mean age

 plot(pred_agemean, fun="all")


 #plot of net survival for mean and maximum age (comparison)

oldpar &lt;- par(no.readonly = TRUE)

par(mfrow = c(2, 2),
    cex = 1.0)
plot(pred_agemax$time,
    pred_agemax$ex_haz,
    type = "l",
    lty = 1,
    lwd = 2,
    xlab = "Time since diagnosis",
    ylab = "excess hazard")
lines(pred_agemean$time,
     pred_agemean$ex_haz,
     type = "l",
     lty = 2,
     lwd = 2)

legend("topright",
      horiz = FALSE,
      legend = c("hE(t) age.max = 79.9", "hE(t) age.mean = 50.8"),
      col = c("black", "black"),
      lty = c(1, 2, 1, 1, 2, 2))
grid()

plot(pred_agemax$time,
    pred_agemax$netsurv,
    type = "l",
    lty = 1,
    lwd = 2,
    ylim = c(0, 1),
    xlab = "Time since diagnosis",
    ylab = "net survival")
lines(pred_agemean$time,
     pred_agemean$netsurv,
     type = "l",
     lty = 2,
     lwd = 2)
legend("bottomleft",
       horiz = FALSE,
       legend = c("Sn(t) age.max = 79.9", "Sn(t) age.mean = 50.8"),
       col = c("black", "black"),
      lty = c(1, 2, 1, 1, 2, 2))
grid()

plot(pred_agemax$time,
    pred_agemax$pt_cure,
    type = "l",
    lty = 1,
    lwd = 2,
    ylim = c(0, 1), xlim = c(0,30),
    xlab = "Time since diagnosis",
    ylab = "probability of being cured P(t)")

lines(pred_agemean$time,
     pred_agemean$pt_cure,
     type = "l",
     lty = 2,
     lwd = 2)


abline(v = pred_agemean$tau[1],
      lty = 2,
      lwd = 2,
      col = "blue")
abline(v = pred_agemean$TTC[1],
       lty = 2,
       lwd = 2,
       col = "red")
abline(v = pred_agemax$tau[1],
       lty = 1,
       lwd = 2,
       col = "blue")
abline(v = pred_agemax$TTC[1],
       lty = 1,
       lwd = 2,
      col = "red")
grid()

legend("bottomright",
       horiz = FALSE,
       legend = c("P(t) age.max = 79.9",
                 "P(t) age.mean = 50.8",
                 "TNEH age.max = 79.9",
                 "TTC age.max = 79.9",
                 "TNEH age.mean = 50.8",
                 "TTC age.mean = 50.8"),
      col = c("black", "black", "blue", "red", "blue", "red"),
      lty = c(1, 2, 1, 1, 2, 2))


 val_age &lt;- seq(min(testiscancer$age_crmin),
                max(testiscancer$age_crmin), 0.1) * sd(testiscancer$age) +
                min(testiscancer$age)


 pred_age_val &lt;- predict(object = fit_m1_ad_tneh, newdata = newdata3)


par(mfrow=c(2,2))
 plot(val_age,
     pred_age_val$ex_haz, type = "l",
     lty=1, lwd=2,
     xlab = "age",
     ylab = "excess hazard")
grid()

 plot(val_age,
     pred_age_val$netsurv, type = "l", lty=1,
     lwd=2, xlab = "age", ylab = "net survival")
     grid()

 plot(val_age,
     pred_age_val$pt_cure, type = "l", lty=1, lwd=2,
     xlab = "age",
     ylab = "P(t)")
     grid()
par(oldpar)
 

</code></pre>


</div>