<div class="container">

<table style="width: 100%;"><tr>
<td>adjust.p</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Adjusted p-values for adaptive FDR control</h2>

<h3>Description</h3>

<p>This function computes adjusted p-values for adaptive FDR control from a vector of raw (unadjusted) p-values. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">adjust.p(p, pi0.method = 1, alpha = 0.05, nbins = 20, pz = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Numeric vector of raw p-values. Raw p-values are assumed without missing values, and between 0 and 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi0.method</code></td>
<td>
<p>Numeric value between 0 and 1 corresponding to the proportion of true null hypotheses (non-differentially abundant proteins or peptides), or the name of an estimation method for this proportion among <code>"st.boot"</code>, <code>"st.spline"</code>, <code>"langaas"</code>, <code>"jiang"</code>, <code>"histo"</code>, <code>"pounds"</code>, <code>"abh"</code> or <code>"slim"</code> (see function <code>estim.pi0</code> for details). The two-stage Benjamini and Hochberg procedure (Benjamini et al. (2006)) is also available according to an expected FDR given by the <code>alpha</code> parameter (write <code>pi0.method="bky"</code>). Default is 1 (classical Benjamini and Hochberg procedure (1995) is performed in this case).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>A nominal type I error rate used for estimating the proportion of true null hypotheses (non-differentially abundant proteins or peptides) in the two-stage Benjamini and Hochberg procedure (used only if <code>pi0.method="bky"</code>). Default is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbins</code></td>
<td>
<p>Number of bins. Parameter used for the <code>"jiang"</code> and  <code>"histo"</code> methods in <code>estim.pi0</code>. Default is 20.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pz</code></td>
<td>
<p>P-value threshold such as p-values below are associated to false null hypotheses. Used for the <code>"slim"</code> method in <code>estim.pi0</code>. Default is 0.05.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The procedure uses an estimation of the proportion of true null hypotheses (non-differentially abundant proteins or peptides), the value or the name of which is precised in input. Next, this estimation is multiplied by the adjusted p-values of the Benjamini and Hochberg procedure (1995) to obtain the final adjusted p-values (see section 3 in Craiu and Sun (2008) for details).
</p>
<p>The adjusted p-values of the Benjamini and Hochberg procedure (1995) and of the two-stage Benjamini and Hochberg procedure (Benjamini et al. (2006)) are computed using the R package <code>multtest</code> (Pollard et al. (2005)).
</p>


<h3>Value</h3>

<p>A list composed of :
</p>
<table>
<tr style="vertical-align: top;">
<td><code>pi0</code></td>
<td>
<p>The proportion of true null hypotheses (non-differentially abundant proteins or peptides) used to adjust p-values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjp</code></td>
<td>
<p>A matrix of raw and adjusted p-values with rows corresponding to each test. First column corresponds to raw p-values and second column to adjusted p-values.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Quentin Giai Gianetto &lt;quentin2g@yahoo.fr&gt;
</p>


<h3>References</h3>

<p>Y. Benjamini and Y. Hochberg. Controlling the false discovery rate: a practical and powerful approach to multiple testing. Journal of the Royal Statistical Society. Series B (Methodological), 289-300, 1995.
</p>
<p>Y. Benjamini, A.M. Krieger, and D.Yekutieli. Adaptive linear step-up procedures that control the false discovery rate. Biometrika, 93(3):491-507, 2006.
</p>
<p>R.V. Craiu and L. Sun. Choosing the lesser evil: trade-off between false discovery rate and non-discovery rate. Statistica Sinica, 18:861-879, 2008.
</p>
<p>K.S. Pollard, S. Dudoit and M.J. van der Laan. Multiple Testing Procedures: R multtest Package and Applications to Genomics, in Bioinformatics and Computational Biology Solutions Using R and Bioconductor. Springer. 2005.
</p>


<h3>See Also</h3>

<p><code>estim.pi0</code>, <code>calibration.plot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#get p-values
data(LFQRatio2)
p=LFQRatio2[,7]

#adjust p-values by estimating the proportion of true null hypotheses 
#with the "pounds" method.
res_pounds=adjust.p(p, pi0.method = "pounds")

#proportion of true null hypotheses with the "pounds" method.
res_pounds$pi0

#plot ajusted p-values in function of raw p-values
plot(res_pounds$adjp)

#adjust p-values by estimating the proportion of true null hypotheses
#using the two-stage Benjamini and Hochberg procedure with a FDR of 0.1.
res_bky=adjust.p(p, pi0.method = "bky", alpha = 0.1)

#proportion of true null hypotheses with the two-stage BH procedure.
res_bky$pi0

#plot adjusted p-values in function of raw p-values
plot(res_bky$adjp)

#compare the two-stage Benjamini and Hochberg procedure 
#with the "pounds" method
plot(res_pounds$adjp[,2],res_bky$adjp[,2])

</code></pre>


</div>