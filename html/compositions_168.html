<div class="container">

<table style="width: 100%;"><tr>
<td>CompLinModCoReg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compositional Linear Model of Coregionalisation</h2>

<h3>Description</h3>

<p>Creates a Variogram model according to the linear model of spatial
corregionalisation for a compositional geostatistical analysis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CompLinModCoReg(formula,comp,D=ncol(comp),envir=environment(formula))
          </code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A formula without left side providing a formal
description of a variogram model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>comp</code></td>
<td>
<p>a compositional dataset, needed to provide the frame size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>The dimension of the multivariate dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>envir</code></td>
<td>
<p>The enviroment in which formula should be interpreted.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The linear model of coregionalisation uses the fact that sums of
valid variogram models are valid variograms, and that scalar variograms
multiplied with a positive definite matrix are valid variograms for
vector-valued random functions. 
</p>
<p>This command computes such a variogram function from a
formal description, via a formula without left-hand side. 
The right-hand side of the formula is a sum. Each summand is either a
product of a matrix description and a scalar variogram description or
only a scalar variogram description. Scalar variogram descriptions are
either formal function calls to
</p>

<dl>
<dt><code>sph(range)</code></dt>
<dd>
<p> for spherical variogram with range <code>range</code></p>
</dd>
<dt><code>exp(range)</code></dt>
<dd>
<p> for an exponential variogram with effective range 
<code>range</code></p>
</dd>
<dt><code>gauss(range)</code></dt>
<dd>
<p> for a Gaussian variogram with effective range
<code>range</code></p>
</dd>
<dt><code>gauss(range)</code></dt>
<dd>
<p> for a cardinal sine variogram with range parameter
<code>range</code></p>
</dd>
<dt><code>pow(range)</code></dt>
<dd>
<p> for an power variogram with range parameter
<code>range</code></p>
</dd>
<dt><code>lin(unit)</code></dt>
<dd>
<p> linear variogram 1 at <code>unit</code>.</p>
</dd>
<dt><code>nugget()</code></dt>
<dd>
<p> for adding a nuggeteffect.</p>
</dd>
</dl>
<p>Alternatively it can be any expression, which will be evaluated in
envir and should depende on a dataset of distantce vectrs <code>h</code>.
An effective range is that distance at which one reaches the sill (for spherical)
of 95% of its values (for all other models). Parametric ranges are given for those
models that do not have an effective range formula.
<br>
The matrix description always comes first. It can be <code>R1</code> for a
rank 1 matrix; <code>PSD</code> for a Positive Semidefinite matrix; \(S\)
for a scalar Sill factor to be multiplied with the identity matrix; or any other
construct evaluating to a matrix, like e.g. a function of some parameters with
default values, that if called is evaluated to a positive semidefinite
matrix. <code>R1</code> and <code>PSD</code> can also be written as calls
providing a vector or respectively a matrix providing the parameter.
<br>
The variogram is created with default parameter values. The parameters
can later be modified by modifiying the default parameter with
assignments like <code>formals(vg)$sPSD1 =
    parameterPosdefMat(4*diag(5))</code>.
We would anyway expect you to fit the model to the data by a command
like <code>fit.lmc(logratioVariogram(...),CompLinModCoReg(...))</code>  
</p>


<h3>Value</h3>

<p>A variogram function, with the extra class "<code>CompLinModCoReg</code>". 
</p>


<h3>Author(s)</h3>

<p>K.Gerald v.d. Boogaart <a href="http://www.stat.boogaart.de">http://www.stat.boogaart.de</a></p>


<h3>References</h3>

<p>What to cite??
</p>


<h3>See Also</h3>

<p><code>vgram2lrvgram</code>,
<code>vgmFit2lrv</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data(juraset)
X &lt;- with(juraset,cbind(X,Y))
comp &lt;- acomp(juraset,c("Cd","Cu","Pb","Co","Cr"))
CompLinModCoReg(~nugget()+sph(0.5)+R1*exp(0.7),comp)
CompLinModCoReg(~nugget()+R1*sph(0.5)+R1*exp(0.7)+(0.3*diag(5))*gauss(0.3),comp)
CompLinModCoReg(~nugget()+R1*sph(0.5)+R1(c(1,2,3,4,5))*exp(0.7),comp)

## End(Not run)
</code></pre>


</div>