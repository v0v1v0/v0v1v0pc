<div class="container">

<table style="width: 100%;"><tr>
<td>DRDensityPlot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot Bayes or confidence interval density contours over a grid of points (usually dose or time)</h2>

<h3>Description</h3>

<p>Density plot for distributions conditional on a variable. 
A grid of values are specified for the conditioning variable, which
is plotted on the horizontal axis.  The conditioning variable is 
typically dose or time</p>


<h3>Usage</h3>

<pre><code class="language-R">DRDensityPlot(x,qL,qH,qlevL=c(0.025,0.05,0.10,0.25),
		xlim,ylim,xlab='x',ylab='y')
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A grid of conditioning values to be plotted on the horizontal axis.  This grid typically
represents dose or time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qL</code></td>
<td>
<p>Lower percentiles, confidence or probabiity levels.  <code>qL</code> is a matrix with rows 
corresponding to <code>x</code>, and columns corresponding to <code>qlevL</code>.  The percentiles must be 
increasing in order and less that 0.50.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qH</code></td>
<td>
<p>Upper percentiles, confidence or probabiity levels.  <code>qH</code> levels correspond to
the <code>qL</code> levels but are ordered from highest to lowest (1-<code>qlevL</code>), with the 
smallest greater than 0.50.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qlevL</code></td>
<td>
<p>Density intervals are formed with percentile boundaries at (qlevL,1-qlevL).  
<code>qlevL</code> must be increasing between (0,0.5).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>Plot limits for the x-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>Plot limits for the y-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>x-axis label </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>y-axis label </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function takes as input percentiles defining confidence 
intervals or Bayesian probability 
intervals at different levels (e.g. 5,95, 25,75) for distributions conditional
on a variable that is typically dose or time.  Regions defined by different
confidence/probability levels are represented by different levels of shading.
The input parameter, <code>qlevL</code>, is used only to define the input in the
matrices <code>qL</code> and <code>qH</code>.  The <code>qlevL</code> is not used for any numerical 
calculations, which must be done before executing the function.
</p>


<h3>Value</h3>

<p>Plotted output only.
</p>


<h3>Author(s)</h3>

<p> Neal Thomas </p>


<h3>See Also</h3>

<p><code>plotBdensity</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 
data('metaData')
exdat&lt;-metaData[metaData$taid==32,]

msSat&lt;-sum((exdat$sampsize-1)*(exdat$sd)^2)/(sum(exdat$sampsize)-length(exdat$sampsize))
fitout&lt;-fitEmax(exdat$rslt,exdat$dose,modType=3,count=exdat$sampsize,
								msSat=msSat)

dgrid&lt;-seq(0,100,length=100)
seout95&lt;-predict(fitout,dgrid,clev=0.95)
seout90&lt;-predict(fitout,dgrid,clev=0.9)
seout80&lt;-predict(fitout,dgrid,clev=0.8)
seout50&lt;-predict(fitout,dgrid,clev=0.5)

qlev&lt;-c(0.025,0.05,0.10,0.25)

qL&lt;-cbind(seout95$ubdif,seout90$ubdif,seout80$ubdif,seout50$ubdif)
qH&lt;-cbind(seout95$lbdif,seout90$lbdif,seout80$lbdif,seout50$lbdif)

DRDensityPlot(dgrid,qL,qH,qlevL=qlev,xlab='Dose',ylab='Diff with PBO')


## End(Not run)

</code></pre>


</div>