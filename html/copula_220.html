<div class="container">

<table style="width: 100%;"><tr>
<td>gnacopula</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Goodness-of-fit Testing for (Nested) Archimedean Copulas</h2>

<h3>Description</h3>

<p><code>gnacopula()</code> conducts a goodness-of-fit test for the given
(<code class="reqn">H_0</code>-)copula <code>cop</code> based on the (copula-)data <code>u</code>.
</p>
<p>NOTE: <code>gnacopula()</code> is deprecated, call <code>gofCopula()</code> instead.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gnacopula(u, cop, n.bootstrap,
          estim.method = eval(formals(enacopula)$method),
          include.K=TRUE, n.MC=0, trafo=c("Hering.Hofert", "Rosenblatt"),
          method=eval(formals(gofTstat)$method), verbose=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p><code class="reqn">n\times d</code>-matrix of values in <code class="reqn">[0,1]</code>;
should be (pseudo-/copula-)observations from the copula to be
tested. Consider applying the function <code>pobs()</code> first
in order to obtain <code>u</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cop</code></td>
<td>
<p><code class="reqn">H_0</code>-<code>"outer_nacopula"</code> with specified
parameters to be tested for (currently only Archimedean copulas are
provided).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.bootstrap</code></td>
<td>
<p>positive integer specifying the number of bootstrap
replicates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estim.method</code></td>
<td>
<p><code>character</code>
string determining the estimation method; see
<code>enacopula()</code>.  We currently only recommend the default
<code>"mle"</code> (or maybe <code>"smle"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include.K</code></td>
<td>
<p>logical indicating whether the last component, involving the
Kendall distribution function <code>K()</code>, is used in the transformation
<code>htrafo()</code> of Hering and Hofert (2011).  Note that this only
applies to <code>trafo="Hering.Hofert"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.MC</code></td>
<td>
<p>parameter <code>n.MC</code> for <code>htrafo()</code> (and thus
for <code>K()</code>) if <code>trafo="Hering.Hofert"</code> and for
<code>cCopula()</code> if <code>trafo="Rosenblatt"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trafo</code></td>
<td>
<p>a <code>character</code> string specifying the multivariate
transformation performed for goodness-of-fit testing, which has to be one
(or a unique abbreviation) of
</p>

<dl>
<dt><code>"Hering.Hofert"</code></dt>
<dd>
<p>for the multivariate transformation of
Hering and Hofert (2011); see <code>htrafo()</code>.</p>
</dd>
<dt><code>"Rosenblatt"</code></dt>
<dd>
<p>for the multivariate transformation of
Rosenblatt (1952); see <code>cCopula()</code>.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a <code>character</code> string specifying the
goodness-of-fit test statistic to be used; see <code>gofTstat()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>if <code>TRUE</code>, the progress of the bootstrap is
displayed via <code>txtProgressBar</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments passed to <code>enacopula()</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>gnacopula()</code> performs a parametric bootstrap for the
goodness-of-fit test specified by <code>trafo</code> and <code>method</code>.  The
transformation given by <code>trafo</code> specifies the multivariate
transformation which is first applied to the (copula-) data <code>u</code>
(typically, the pseudo-observations are used); see
<code>htrafo()</code> or <code>cCopula()</code> for more details. The
argument <code>method</code> specifies the particular goodness-of-fit test
carried out, which is either the Anderson-Darling test for the
univariate standard uniform distribution (for <code>method="AnChisq"</code> or
<code>method="AnGamma"</code>) in a one-dimensional setup or the tests
described in Genest et al. (2009) for the
multivariate standard uniform distribution directly in a multivariate
setup.  As estimation method, the method provided by
<code>estim.method</code> is used.
</p>
<p>Note that a finite-sample correction is made when computing p-values;
see <code>gofCopula()</code> for details.
</p>
<p>A word of warning: Do work carefully with the variety of different
goodness-of-fit tests that can be performed with <code>gnacopula()</code>.
For example, among the possible estimation methods at hand, only
MLE is known to be consistent (under conditions to be verified).
Furthermore, for the tests based on the Anderson-Darling test
statistic, it is theoretically not clear whether the parametric bootstrap
converges.  Consequently, the results obtained should be treated with
care.  Moreover, several estimation methods are known to be prone to
numerical errors (see Hofert et al. (2013)) and are thus not
recommended to be used in the parametric bootstrap. A warning is given if
<code>gnacopula()</code> is called with a method not being MLE.
</p>


<h3>Value</h3>

<p><code>gnacopula</code> returns an <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> object of class <code>"htest"</code>.
This object contains a list with the bootstrap results including the
components
</p>

<dl>
<dt>
<code>p.value</code>:</dt>
<dd>
<p>the bootstrapped p-value;</p>
</dd>
<dt>
<code>statistic</code>:</dt>
<dd>
<p>the value of the test statistic computed
for the data <code>u</code>;</p>
</dd>
<dt>
<code>data.name</code>:</dt>
<dd>
<p>the name of <code>u</code>;</p>
</dd>
<dt>
<code>method</code>:</dt>
<dd>
<p>a <code>character</code> describing the
goodness-of-fit test applied;</p>
</dd>
<dt>
<code>estimator</code>:</dt>
<dd>
<p>the estimator computed for the data <code>u</code>;</p>
</dd>
<dt>
<code>bootStats</code>:</dt>
<dd>
<p>a list with component <code>estimator</code>
containing the estimators for all bootstrap replications and
component <code>statistic</code> containing the values of the test statistic
for each bootstrap replication.</p>
</dd>
</dl>
<h3>References</h3>

<p>Genest, C., Rémillard, B., and Beaudoin, D. (2009),
Goodness-of-fit tests for copulas: A review and a power study
<em>Insurance: Mathematics and Economics</em> <b>44</b>, 199–213.
</p>
<p>Rosenblatt, M. (1952),
Remarks on a Multivariate Transformation,
<em>The Annals of Mathematical Statistics</em> <b>23</b>, 3, 470–472.
</p>
<p>Hering, C. and Hofert, M. (2011),
Goodness-of-fit tests for Archimedean copulas in large dimensions,
submitted.
</p>
<p>Hofert, M., Mächler, M., and McNeil, A. J. (2012).
Likelihood inference for Archimedean copulas in high dimensions
under known margins. <em>Journal of Multivariate Analysis</em>
<b>110</b>, 133–150.
</p>


<h3>See Also</h3>

<p><code>gofTstat()</code> for the implemented test statistis,
<code>htrafo()</code> and <code>cCopula()</code> involved and
<code>K()</code> for the Kendall distribution function.
</p>
<p><code>gofCopula()</code> for other (parametric bootstrap) based
goodness-of-fit tests.
</p>


</div>