<div class="container">

<table style="width: 100%;"><tr>
<td>linear_contrast</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate confidence intervals and p-values for linear contrasts of
regression coefficients in a fitted model</h2>

<h3>Description</h3>

<p><code>linear_contrast</code> reports confidence intervals and (optionally) p-values
for linear contrasts of regression coefficients from a fitted model, using a
sandwich estimator for the standard errors and (optionally) a small sample
correction for the critical values. The default small-sample correction is
based on a Satterthwaite approximation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">linear_contrast(
  obj,
  vcov,
  contrasts,
  level = 0.95,
  test = "Satterthwaite",
  ...,
  p_values = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>Fitted model for which to calculate confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcov</code></td>
<td>
<p>Variance covariance matrix estimated using <code>vcovCR</code> or a
character string specifying which small-sample adjustment should be used to
calculate the variance-covariance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p>A contrast matrix, or a list of multiple contrast matrices
to test. See details and examples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>Desired coverage level for confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>Character vector specifying which small-sample corrections to
calculate. <code>"z"</code> returns a z test (i.e., using a standard normal
reference distribution). <code>"naive-t"</code> returns a t test with <code>m -
1</code> degrees of freedom, where <code>m</code> is the number of unique clusters.
<code>"naive-tp"</code> returns a t test with <code>m - p</code> degrees of freedom,
where <code>p</code> is the number of regression coefficients in <code>obj</code>.
<code>"Satterthwaite"</code> returns a Satterthwaite correction. Unlike in
<code>coef_test()</code>, <code>"saddlepoint"</code> is not currently supported in
<code>conf_int()</code> because saddlepoint confidence intervals do not have a
closed-form solution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to <code>vcovCR</code>, which are only
needed if <code>vcov</code> is a character string.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_values</code></td>
<td>
<p>Logical indicating whether to report p-values. The default
value is <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Constraints can be specified directly as q X p matrices or
indirectly through <code>constrain_pairwise</code>,
<code>constrain_equal</code>, or <code>constrain_zero</code>.
</p>


<h3>Value</h3>

<p>A data frame containing estimated contrasts, standard
errors, confidence intervals, and (optionally) p-values.
</p>


<h3>See Also</h3>

<p><code>vcovCR</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data("ChickWeight", package = "datasets")
lm_fit &lt;- lm(weight ~ 0 + Diet + Time:Diet, data = ChickWeight)

# Pairwise comparisons of diet-by-time slopes
linear_contrast(lm_fit, vcov = "CR2", cluster = ChickWeight$Chick, 
                contrasts = constrain_pairwise("Diet.:Time", reg_ex = TRUE))


if (requireNamespace("carData", quietly = TRUE)) withAutoprint({

  data(Duncan, package = "carData")
  Duncan$cluster &lt;- sample(LETTERS[1:8], size = nrow(Duncan), replace = TRUE)

  Duncan_fit &lt;- lm(prestige ~ 0 + type + income + type:income + type:education, data=Duncan)
  # Note that type:income terms are interactions because main effect of income is included
  # but type:education terms are separate slopes for each unique level of type

  # Pairwise comparisons of type-by-education slopes
  linear_contrast(Duncan_fit, vcov = "CR2", cluster = Duncan$cluster,
                  contrasts = constrain_pairwise(":education", reg_ex = TRUE),
                  test = "Satterthwaite")
 
  # Pairwise comparisons of type-by-income interactions
  linear_contrast(Duncan_fit, vcov = "CR2", cluster = Duncan$cluster,
                  contrasts = constrain_pairwise(":income", reg_ex = TRUE, with_zero = TRUE),
                  test = "Satterthwaite")
                  
})

</code></pre>


</div>