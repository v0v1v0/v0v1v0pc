<div class="container">

<table style="width: 100%;"><tr>
<td>bivariate.EM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>EM-algorithm for bivariate normally distributed data</h2>

<h3>Description</h3>

<p>Function</p>


<h3>Usage</h3>

<pre><code class="language-R">bivariate.EM(obs1, obs2, type, data = NULL,
             var1, var2, 
             corr, lambda1, lambda2, p, 
             numiter=5000,acc=1.e-7,class)</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>obs1</code></td>
<td>
<p>the first column of the observations</p>
</td>
</tr></table>
<p><br></p>
<table><tr style="vertical-align: top;">
<td><code>obs2</code></td>
<td>
<p>the second column of the observations</p>
</td>
</tr></table>
<p><br></p>
<table><tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>kind of data</p>
</td>
</tr></table>
<p><br></p>
<table><tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame. If not <code>NULL</code>, <code>obs1</code>, <code>obs2</code>, <code>var1</code>, <code>var2</code> and <code>corr</code> will be looked for in <code>data</code></p>
</td>
</tr></table>
<p><br></p>
<table><tr style="vertical-align: top;">
<td><code>var1</code></td>
<td>
<p>Variance of the first column of the observations(except meta-analysis)</p>
</td>
</tr></table>
<p><br></p>
<table><tr style="vertical-align: top;">
<td><code>var2</code></td>
<td>
<p>Variance of the second column of the observations (except meta-analysis)</p>
</td>
</tr></table>
<p><br></p>
<table><tr style="vertical-align: top;">
<td><code>corr</code></td>
<td>
<p>correlation coefficient</p>
</td>
</tr></table>
<p><br></p>
<table><tr style="vertical-align: top;">
<td><code>lambda1</code></td>
<td>
<p>Means of the first column of the observations</p>
</td>
</tr></table>
<p><br></p>
<table><tr style="vertical-align: top;">
<td><code>lambda2</code></td>
<td>
<p>Means of the second column of the observations</p>
</td>
</tr></table>
<p><br></p>
<table><tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Mixing weight</p>
</td>
</tr></table>
<p><br></p>
<table><tr style="vertical-align: top;">
<td><code>numiter</code></td>
<td>
<p>parameter to control the maximal number of iterations in the  EM loops. Default is 5000.</p>
</td>
</tr></table>
<p><br></p>
<table><tr style="vertical-align: top;">
<td><code>acc</code></td>
<td>
<p>convergence criterion. Default is 1.e-7</p>
</td>
</tr></table>
<p><br></p>
<table><tr style="vertical-align: top;">
<td><code>class</code></td>
<td>
<p>classification of studies?</p>
</td>
</tr></table>
<p><br></p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# 1.EM and classification for bivariate data with starting values
data(rs12363681)
lambda1&lt;-c(1540.97, 837.12, 945.40, 1053.69)
lambda2&lt;-c(906.66, 1371.81 ,1106.01,973.11)
p&lt;-c(0.05,0.15,0.6,0.2)
test&lt;-bivariate.EM(obs1=x, obs2=y, type="bi", lambda1=lambda1,lambda2=lambda2,
                   p=p,data=rs12363681,class="TRUE")
# scatter plot with ellipse
plot(test, ellipse=TRUE)
# scatter plot without ellipse
plot(test, ellipse=FALSE)

## End(Not run)
# 2. EM-algorithm for a diagnostic meta-analysis with bivariate 
#    normally distributed data and study specific fixed variances
data(CT)
p2&lt;-c(0.4,0.6)
lamlog12&lt;-c(2.93,3.22)
lamlog22&lt;-c(2.5,1.5)
ct.m1 &lt;- bivariate.EM(obs1=logitTPR, obs2=logitTNR, 
                      var1=varlogitTPR, var2=varlogitTNR,
                      type="meta", lambda1=lamlog12, lambda2=lamlog22,
                      p=p2,data=CT,class="TRUE")
</code></pre>


</div>