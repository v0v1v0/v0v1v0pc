<div class="container">

<table style="width: 100%;"><tr>
<td>blomCOP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The Blomqvist Beta of a Copula</h2>

<h3>Description</h3>

<p>Compute the <em>Blomqvist Beta</em> <code class="reqn">\beta_\mathbf{C}</code> of a copula (Nelsen, 2006, p. 182), which is defined at the middle or center of <code class="reqn">\mathcal{I}^2</code> as
</p>
<p style="text-align: center;"><code class="reqn">\beta_\mathbf{C} = 4\times\mathbf{C}\biggl(\frac{1}{2},\frac{1}{2}\biggr) - 1\mbox{,}</code>
</p>

<p>where the <code class="reqn">u = v = 1/2</code> and thus shows that <code class="reqn">\beta_\mathbf{C}</code> is based on the <em>median joint probability</em>. The Blomqvist Beta is also called the <em>medial correlation coefficient</em>. Nelsen also reports that “although, the Blomqvist Beta depends only on the copula only through its value at the center of <code class="reqn">\mathcal{I}^2</code>, but that [<code class="reqn">\beta_\mathbf{C}</code>] nevertheless often provides an accurate approximation to both <em>Spearman Rho</em> <code>rhoCOP</code> and <em>Kendall Tau</em> <code>tauCOP</code>.”  Kendall Tau <code class="reqn">\tau_\mathbf{C}</code>, <em>Gini Gamma</em> <code class="reqn">\gamma_\mathbf{C}</code>, and Spearman Rho <code class="reqn">\rho_\mathbf{C}</code> in relation to <code class="reqn">\beta_\mathbf{C}</code> satisfy the following inequalities (Nelsen, 2006, exer. 5.17, p. 185):
</p>
<p style="text-align: center;"><code class="reqn">\frac{1}{4}(1 + \beta_\mathbf{C})^2  - 1 \le \tau_\mathbf{C} \le 1 - \frac{1}{4}(1 - \beta_\mathbf{C})^2\mbox{,}</code>
</p>

<p style="text-align: center;"><code class="reqn">\frac{3}{16}(1 + \beta_\mathbf{C})^3  - 1 \le \rho_\mathbf{C} \le 1 - \frac{3}{16}(1 - \beta_\mathbf{C})^3\mbox{, and}</code>
</p>

<p style="text-align: center;"><code class="reqn">\frac{3}{8}(1 + \beta_\mathbf{C})^2  - 1 \le \tau_\mathbf{C} \le 1 - \frac{3}{8}(1 - \beta_\mathbf{C})^2\mbox{.}</code>
</p>

<p>A curious aside (Joe, 2014, p. 164) about the <em>Gaussian copula</em> is that <em>Blomqvist Beta</em> is equal to <em>Kendall Tau</em> (<code>tauCOP</code>): <code class="reqn">\beta_\mathbf{C} = \tau_\mathbf{C}</code> (see <b>Note</b> in <code>med.regressCOP</code> for a demonstration). Finally, a version of Blomqvist Beta defined outside the median is provided by <code>blomCOPss</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">blomCOP(cop=NULL, para=NULL, as.sample=FALSE,
                  ctype=c("joe", "weibull", "hazen", "1/n",
                                 "bernstein", "checkerboard"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cop</code></td>
<td>
<p>A copula function;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>para</code></td>
<td>
<p>Vector of parameters or other data structure, if needed, to pass to the copula;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>as.sample</code></td>
<td>
<p>A logical controlling whether an optional <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> <code>data.frame</code> in <code>para</code> is used to compute the <code class="reqn">\hat\beta_\mathbf{C}</code> (see <b>Note</b>);</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ctype</code></td>
<td>
<p>Argument of the same as <code>EMPIRcop</code> with the exception of the <code>"joe"</code> specific to the documentation here. The other choices trigger and are given over to the empirical copula; and</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to pass to the copula or down to <code>EMPIRcop</code> if a sample version had been requested.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The value for <code class="reqn">\beta_\mathbf{C}</code> or sample <code class="reqn">\hat\beta_n</code> is returned.
</p>


<h3>Note</h3>

<p>The sample <code class="reqn">\hat\beta_n</code> is most efficiently computed (Joe, 2014, p. 57) by
</p>
<p style="text-align: center;"><code class="reqn">\hat\beta_n = \frac{2}{n} \sum_{i=1}^{n} \mathbf{1}\biggl([r_{i1} - (1 + n)/2]\times
                                                          [r_{i2} - (1 + n)/2] \ge 0\biggr) -
                    1\mbox{,}</code>
</p>

<p>where <code class="reqn">r_{i1}, r_{i2}</code> are the ranks of the data for <code class="reqn">i = 1, \ldots n</code>, and <code class="reqn">\mathbf{1}(.)</code> is an <em>indicator function</em> scoring 1 if condition is true otherwise zero. However, the Joe sample estimator is not fully consistent (or vice versa) with the various versions of the empirical copula, <code class="reqn">\mathbf{C}_n</code>, (<code>EMPIRcop</code>) (see the last example in <b>Examples</b>). Also, the nature of even and odd sample sizes controls how the median is computed and the issue of samples lying on the median lines in <code class="reqn">U</code> and <code class="reqn">V</code> (Genest <em>et al.</em>, 2013). The argument <code>ctype</code> supports triggers to the <code class="reqn">\mathbf{C}_n</code> in lieu of the Joe sample estimator shown in this documentation.
</p>


<h3>Author(s)</h3>

<p>W.H. Asquith</p>


<h3>References</h3>

<p>Genest, C., Carabarín-Aguirre, A., and Harvey, F., 2013, Copula parameter estimation using<br> Blomqvist's beta: Journal de la Soci<code class="reqn">é</code>té Française de Statistique, v. 154, no. 1, pp. 5–24.
</p>
<p>Joe, H., 2014, Dependence modeling with copulas: Boca Raton, CRC Press, 462 p.
</p>
<p>Nelsen, R.B., 2006, An introduction to copulas: New York, Springer, 269 p.
</p>


<h3>See Also</h3>

<p><code>blomCOPss</code>, <code>blomatrixCOPdec</code>, <code>blomatrixCOPiqr</code>,
<code>footCOP</code>, <code>giniCOP</code>, <code>hoefCOP</code>,
<code>rhoCOP</code>, <code>tauCOP</code>, <code>wolfCOP</code>,
<code>joeskewCOP</code>, <code>uvlmoms</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">blomCOP(cop=PSP) # 1/3 precisely

## Not run: 
# Nelsen (2006, exer. 5.17, p. 185) : All if(...) are TRUE
B &lt;- blomCOP(cop=N4212cop, para=2.2); Bp1 &lt;- 1 + B; Bm1 &lt;- 1 - B
G &lt;- giniCOP(cop=N4212cop, para=2.2); a &lt;- 1/4; b &lt;- 3/16; c &lt;- 3/8
R &lt;-  rhoCOP(cop=N4212cop, para=2.2)
K &lt;-  tauCOP(cop=N4212cop, para=2.2, brute=TRUE) # numerical issues without brute
if( a*Bp1^2 - 1 &lt;= K &amp; K &lt;= 1 - a*Bm1^2 ) print("TRUE") #
if( b*Bp1^3 - 1 &lt;= R &amp; R &lt;= 1 - b*Bm1^3 ) print("TRUE") #
if( c*Bp1^2 - 1 &lt;= G &amp; G &lt;= 1 - c*Bm1^2 ) print("TRUE") #
## End(Not run)

## Not run: 
# A demonstration of a special feature of blomCOP for sample data.
# Joe (2014, p. 60; table 60) has 0.749 for GHcop(tau=0.5); n*var(hatB) as n--&gt;infinity
set.seed(1)
theta &lt;- GHcop(tau=0.5)$para; B &lt;- blomCOP(cop=GHcop, para=theta); n &lt;- 1000
H &lt;- sapply(1:1000, function(i) { # Let us test that with pretty large sample size:
	                blomCOP(para=rCOP(n=n, cop=GHcop, para=theta), as.sample=TRUE) })
print(n*var(B-H)) # For 1,000 sims of size n : 0.789, nearly matches Joe's result 
## End(Not run)

## Not run: 
# Joe (2014, p. 57) says that sqrt(n)(B-HatBeta) is Norm(0, 1 - B^2)
set.seed(1)
n &lt;- 10000; B &lt;- blomCOP(cop=PSP) # Beta = 1/3
H &lt;- sapply(1:100, function(i) { message(i,"-", appendLF=FALSE)
	               blomCOP(para=rCOP(n=n, cop=PSP), as.sample=TRUE) })
lmomco::parnor(lmomco::lmoms(sqrt(n)*(H-B))) # mu = -0.038; sigma = 0.970
# Joe (2014) : sqrt(1-B^2) == standard deviation (sigma) : (1-(1/3)^2) approx 0.973 
## End(Not run)

## Not run: 
nn &lt;- 200; set.seed(1)
UV &lt;- simCOP(n=nn+1, cop=PSP, graphics=FALSE)
for(n in nn:(nn+1)) {
  if(as.logical(n %% 2)) { # in source \ percent \ percent for latex
    message("Blomquist Betas for an odd  sample size n=", n)
    uv &lt;- UV
  } else {
    message("Blomquist Betas for an even sample size n=", n)
    uv &lt;- UV[-(nn+1), ] # remove the last and 'odd' indexed value to make even
  }
  message(c(" Joe2014: ", blomCOP(as.sample=TRUE, para=uv, ctype="joe"         )))
  message(c(" Weibull: ", blomCOP(as.sample=TRUE, para=uv, ctype="weibull"     )))
  message(c(" Hazen:   ", blomCOP(as.sample=TRUE, para=uv, ctype="hazen"       )))
  message(c(" 1/n:     ", blomCOP(as.sample=TRUE, para=uv, ctype="1/n"         )))
  message(c(" Bernstn: ", blomCOP(as.sample=TRUE, para=uv, ctype="bernstein"   )))
  message(c(" ChckBrd: ", blomCOP(as.sample=TRUE, para=uv, ctype="checkerboard")))
}
# Blomquist Betas for an even sample size n=200
#  Joe2014: 0.32
#  Weibull: 0.32
#  Hazen:   0.32
#  1/n:     0.32
#  Bernstn: 0.323671819423416
#  ChckBrd: 0.32
# Blomquist Betas for an odd  sample size n=201
#  Joe2014: 0.323383084577114
#  Weibull: 0.333333333333333
#  Hazen:   0.333333333333333
#  1/n:     0.293532338308458
#  Bernstn: 0.327747577290946
#  ChckBrd: 0.313432835820896 #
## End(Not run)
</code></pre>


</div>