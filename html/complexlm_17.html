<div class="container">

<table style="width: 100%;"><tr>
<td>median.complex</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Improved Median for Complex Numbers</h2>

<h3>Description</h3>

<p>By default stats::median handles complex numbers by computing the medians of the real and imaginary components separately.
This is not ideal as the result is not rotationally invariant (the same set of numbers will have a different median if the coordinates are rotated).
This method calculates the complex median as the geometric median, as implemented in pracma::geo_median, which is rotationally invariant.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'complex'
median(x, na.rm = FALSE, tol = 1e-07, maxiter = 200, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric or complex vector, of which the median is to be calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>logical. Should NA values be removed before finding the median?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>numeric. Relative tolerance to be passed to pracma::geo_median. Default is 1e-07.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>maximum number of iterations for calculating geometric median. Not used if x is numeric.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments. Currently ignored.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The geometric median fails if any of the input data are colinear. Meaning that a straight line on the complex plane
can be drawn which intersects with one or more element of <code>x</code>. If this function encounters such an error, it adds a small
amount of random jitter to the data, then calculates the geometric medium again. The jitter is generated by a normal distribution
with a standard deviation equal to the absolute minimum real or imaginary component of <code>x</code>, divided by <code class="reqn">10^8</code> (or 10^-9 if the minimum is zero).
</p>


<h3>Value</h3>

<p>The median of x. If x is complex, the geometric median as calculated by Weiszfeld's algorithm.
</p>


<h3>Note</h3>

<p>This method masks the default method for complex numbers.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p>stats::median and pracma::geo_median
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(4242)
n &lt;- 7
foo &lt;- complex(real = rnorm(n), imaginary = rnorm(n))
median(foo)
</code></pre>


</div>