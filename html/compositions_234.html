<div class="container">

<table style="width: 100%;"><tr>
<td>ellipses</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Draw ellipses</h2>

<h3>Description</h3>

<p>Draws ellipses from a mean and a variance into a plot.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  ## S3 method for class 'acomp'
ellipses(mean,var,r=1,...,steps=72,
                                         thinRatio=NULL,aspanel=FALSE)
  ## S3 method for class 'rcomp'
ellipses(mean,var,r=1,...,steps=72,
                                         thinRatio=NULL,aspanel=FALSE)
  ## S3 method for class 'aplus'
ellipses(mean,var,r=1,...,steps=72,thinRatio=NULL)
  ## S3 method for class 'rplus'
ellipses(mean,var,r=1,...,steps=72,thinRatio=NULL)
  ## S3 method for class 'rmult'
ellipses(mean,var,r=1,...,steps=72,thinRatio=NULL)
          </code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p>a compositional dataset or value of means or midpoints of
the ellipses</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>
<p>a variance matrix or a set of variance matrices given by
<code>var[i,,]</code> (multiple covariance matrices are not consitently
implemented as of today). The principal axis of the variance give
the axis of
the ellipses, whereas the square-root of the eigenvalues times r give the
half-diameters of the ellipse.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>a scaling of the half-diameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further graphical parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>steps</code></td>
<td>
<p>the number of discretisation points to draw the
ellipses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thinRatio</code></td>
<td>
<p>The ellipse function now be default plots the whole
ellipsiod by giving its principle circumferences. However this is
not reasonable for the thinner directions. If a direction other than
the first two eigendirections has an eigenvalue not bigger than
thinRatio*rmax it is not plotted. Thus thinRatio=1 reinstantiates
the old behavior of the function. Later thinratio=NULL will become the
default, in which case the projection of the ellipse is
plotted. However this is not implemented yet. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aspanel</code></td>
<td>
<p>Is the function called as slave to draw in a panel of a
gsi.pairs plot, or as a user function setting up the plots. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The ellipsoid/ellipse drawn is given by the solutions of
</p>
<p style="text-align: center;"><code class="reqn">(x-mean)^tvar^{-1}(x-mean)=r^2</code>
</p>

<p>in the respective geometry of the parameter space. Note that
these ellipses can be added to panel plots (by means of 
orthogonal projections in the corresponding geometry).
</p>
<p>There are actually three possibilities of drawing a a hyperdimensional
ellipsoid or ellipse and non of them is perfect.
</p>

<dl>
<dt>thinRatio=1.1</dt>
<dd>
<p>This works like, what was implemented in the older versions of
compositons, but never correctly documented. It draws an ellipse
with main axes given by the two largest Eigendirections of the
<code>var</code>-Matrix given. 
</p>
</dd>
<dt>thinRatio=0</dt>
<dd>
<p>Draws all the ellipses given by every pair of eigendirections. In
this way we get a visual impression of the high dimensional
ellipsoid represend by the variance matrix. However the plots gets
fastly cluttered in dimensions, when D&gt;4. A 0&lt;thinRatio&lt;1 can avoid
using eigendirection with small extend (i.e. smaller than
thinRatio*largest Eigenvalue. 
</p>
</dd>
<dt>thinRatio=NULL</dt>
<dd>
<p>Draws in each Panel a two dimensional ellipse representing the
marginal variance in the projection of the plot, if var was to be
interpreted as a variance matrix. This can be seen as some sort of
projection of the high dimensional ellipsoid, but is not necessarily
its visual outline. 
</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>K.Gerald v.d. Boogaart <a href="http://www.stat.boogaart.de">http://www.stat.boogaart.de</a></p>


<h3>See Also</h3>

<p><code>plot.acomp</code>, 
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(SimulatedAmounts)

plot(acomp(sa.lognormals))
tt&lt;-acomp(sa.lognormals); ellipses(mean(tt),var(tt),r=2,col="red")
tt&lt;-rcomp(sa.lognormals); ellipses(mean(tt),var(tt),r=2,col="blue")

plot(aplus(sa.lognormals[,1:2]))
tt&lt;-aplus(sa.lognormals[,1:2]); ellipses(mean(tt),var(tt),r=2,col="red")
tt&lt;-rplus(sa.lognormals[,1:2]); ellipses(mean(tt),var(tt),r=2,col="blue")

plot(rplus(sa.lognormals[,1:2]))
tt&lt;-aplus(sa.lognormals[,1:2]); ellipses(mean(tt),var(tt),r=2,col="red")
tt&lt;-rplus(sa.lognormals[,1:2]); ellipses(mean(tt),var(tt),r=2,col="blue")
tt&lt;-rmult(sa.lognormals[,1:2]); ellipses(mean(tt),var(tt),r=2,col="green")

</code></pre>


</div>