<div class="container">

<table style="width: 100%;"><tr>
<td>targetCI</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute the dose with confidence interval exceeding a target
change from placebo for each simulated example in an emaxsim object. </h2>

<h3>Description</h3>

<p>Selects the lowest dose from a user-specified grid of doses with confidence interval exceeding a targetted
change from placebo for each simulated data set in an emaxsim object.  
</p>


<h3>Usage</h3>

<pre><code class="language-R">targetCI (object,
	target,
	dgrid,
	clev=0.90,
	high= TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p> An emaxsim object </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>
<p>Target improvement from placebo</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dgrid</code></td>
<td>
<p>The lowest dose is found by a search over a
user-specified grid of doses.  If dgrid is a single value, it is
interpreted as the number of equally-spaced doses to select from 
zero to the highest dose in the simulated design.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clev</code></td>
<td>
<p>One-sided confidence interval level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>high</code></td>
<td>
<p>When TRUE, lower bounds are computed and must be higher
than the target.  When FALSE, upper bounds must be less than the target.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a vector with the lowest dose meeting the criteria.  If a
simulated example does not have a qualifying dose, Inf is returned.
</p>


<h3>Note</h3>

<p>If the grid is very large (&gt;200), execution will slow as a large 
number of estimates and SEs are computed.
</p>


<h3>Author(s)</h3>

<p>Neal Thomas </p>


<h3>See Also</h3>

<p><code>emaxsim, predict.emaxsim</code>, targetD</p>


<h3>Examples</h3>

<pre><code class="language-R">	## Not run: 

		# emaxsim changes the random number seed
		nsim&lt;-100
		doselev&lt;-c(0,5,25,50,100)
		n&lt;-c(78,81,81,81,77)

		### population parameters for simulation
		e0&lt;-2.465375 
		ed50&lt;-67.481113 
		
		dtarget&lt;-100
		diftarget&lt;-9.032497
		emax&lt;-solveEmax(diftarget,dtarget,log(ed50),1,e0)

		sdy&lt;-7.967897
		pop&lt;-c(log(ed50),emax,e0)    
		meanlev&lt;-emaxfun(doselev,pop)  

		###FixedMean is specialized constructor function for emaxsim
		gen.parm&lt;-FixedMean(n,doselev,meanlev,sdy)  

		D1 &lt;- emaxsim(nsim,gen.parm,modType=3)

		target&lt;-6
		tD&lt;- ( (target*ed50)/(emax-target) )
		selectedDose&lt;-targetCI(D1,target,dgrid=c(1:100)+0.5,clev=0.80,high=TRUE)
	
## End(Not run)
	
</code></pre>


</div>