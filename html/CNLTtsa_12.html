<div class="container">

<table style="width: 100%;"><tr>
<td>pre.per</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Functions to form periodogram objects with a common time and scale bins for bivariate series with different sampling grids for each component
</h2>

<h3>Description</h3>

<p>The CNLT forms detail coefficients for each component of a bivariate series.  Due to the two components having different sampling grids, the details (and associated scales) won't have a common association for both series.  Hence the details are sampled and mapped to a common timescale and a common set of scales via binning and averaging.  These functions compute spectral objects on these common times / scales
</p>


<h3>Usage</h3>

<pre><code class="language-R">pre.per(x, det, lre, lreA, scale.range = NULL, time.range = NULL, Arange = NULL, 
Jstar = 20, Tstar = 50)
pre.per.comb(spec1, spec2)
pre.per.sample(spec1, spec2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A vector corrsponding to the sampling grid of a component of a series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>det</code></td>
<td>
<p>A list of (real or imaginary parts of) the detail coefficients from a CNLT decomposition, such as from the output of <code>cnlt.biv</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lre</code></td>
<td>
<p>A list of scales (removed integral lengths) corresponding to <span class="env">det</span> from a CNLT decomposition, such as from the output of <code>cnlt.biv</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lreA</code></td>
<td>
<p>A list of asymmetry values from a CNLT decomposition, such as from the output of <code>cnlt.biv</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.range</code></td>
<td>
<p>An optional two-vector specifying the range of scales to be considered in the resulting output spectrum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.range</code></td>
<td>
<p>An optional two-vector specifying the range of times to be considered in the resulting output spectrum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Arange</code></td>
<td>
<p>An optional two-vector specifying whether the values used in forming the output spectrum should be limited to those from a specific range of asymmetry values,
see Sanderson (2010), chapter 6.2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Jstar</code></td>
<td>
<p>The number of artificial scales in the output spectrum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tstar</code></td>
<td>
<p>The number of artificial times in the output spectrum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spec1</code></td>
<td>
<p>A periodogram corresponding to the first component of a bivariate series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spec2</code></td>
<td>
<p>A periodogram corresponding to the second component of a bivariate series.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For a bivariate series where the two components have different sampling grids, the co- /quadrature periodogram values are first formed using <code>pre.per</code>, 
using a vector of <span class="env">Tstar</span> equal time intervals, specified by setting <span class="env">Tstar</span> and optionally <span class="env">time.range</span>; they are also binned into <span class="env">Jstar</span> 
equal artificial levels by setting <span class="env">Jstar</span> and optionally <span class="env">scale.range</span>.  The details are sampled using a common sampling vector with <code>pre.per.sample</code>, 
and then combined using <code>pre.per.comb</code>. The periodogram is then smoothed over time. See Hamilton et al (2018), section 2.3 for more details. 
</p>


<h3>Value</h3>

<p>For <code>pre.per</code>, a list with components:<br></p>
<table>
<tr style="vertical-align: top;">
<td><code>spec</code></td>
<td>
<p>A matrix of dimension <code>Jstar x Tstar</code> corrsponding to a quadrature periodogram / co-periodogram of a bivariate series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mscale</code></td>
<td>
<p>A vector of scales (of length <span class="env">Jstar</span>) corresponding to the rows of the spectrum <code>spec</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mtime</code></td>
<td>
<p>A vector of times (of length <span class="env">Tstar</span>) corresponding to the columns of the spectrum <code>spec</code>.</p>
</td>
</tr>
</table>
<p>For <code>pre.per.sample</code>, a list with components:<br></p>
<table>
<tr style="vertical-align: top;">
<td><code>spec1</code></td>
<td>
<p>A matrix of dimension <code>Jstar x Tstar</code> corrsponding to a periodogram of the first component of a bivariate series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spec2</code></td>
<td>
<p>A matrix of dimension <code>Jstar x Tstar</code> corrsponding to a periodogram of the second component of a bivariate series.</p>
</td>
</tr>
</table>
<p>For <code>pre.per.comb</code>, a list with components:<br></p>
<table><tr style="vertical-align: top;">
<td><code>spec</code></td>
<td>
<p>A matrix of dimension <code>Jstar x Tstar</code> corrsponding to a periodogram / quadrature periodogram / co-periodogram of a bivariate series.</p>
</td>
</tr></table>
<h3>Note</h3>

<p>Note that these functions aren't intended to be used directly, but are called internally from the function <code>cnlt.spec.DG</code>.  <br>
Note also that the argument <span class="env">Tstar</span> should be chosen small enough so that the range of the sampling grid <span class="env">x</span> can be divided into equally spaced intervals, 
with *at least one* gridpoint in an interval.  
</p>


<h3>Author(s)</h3>

<p>Jean Hamilton, Matt Nunes
</p>


<h3>References</h3>

<p>Hamilton, J., Nunes, M. A., Knight, M. I. and Fryzlewicz, P. (2018) Complex-valued wavelet lifting and applications.
<em>Technometrics</em>, <b>60</b> (1), 48-60, DOI 10.1080/00401706.2017.1281846.
</p>


<h3>See Also</h3>

<p><code>cnlt.spec.DG</code>,
<code>smooth.over.time</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# simulate data, e.g. two sinusoids
dat &lt;- seq(from=1, to=3, by=0.1)
x1 &lt;- cumsum(sample(dat, 200, TRUE))
x2 &lt;- cumsum(sample(dat, 200, TRUE))

y1 &lt;-sin(2*pi*(1/25)*x1) + sin(2*pi*(1/50)*x1)+ 1*sin(2*pi*(1/10)*x1)+ rnorm(length(x1), 0,0.2)
y3 &lt;- sin(2*pi*(1/25)*x2[97:196]) + rnorm(length(x2), 0,0.1)

## Not run: 
y1y3.dec&lt;-cnlt.biv(x1, f1=y1, f2=y3, P = 500)

# compute the co-periodogram for the first component...

C1 &lt;- pre.per(x1, sapply(y1y3.dec$det1,Re), y1y3.dec$lre1, y1y3.dec$lreA1, Jstar = 10)

# .. and for the second component
C2 &lt;- pre.per(x1, sapply(y1y3.dec$det2,Re), y1y3.dec$lre2, y1y3.dec$lreA2, Jstar = 10)

## End(Not run)

</code></pre>


</div>