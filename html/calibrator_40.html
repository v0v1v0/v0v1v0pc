<div class="container">

<table style="width: 100%;"><tr>
<td>p.eqn8.supp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>A postiori probability of hyperparameters</h2>

<h3>Description</h3>

<p>Function to determine the a-postiori probability of hyperparameters
<code class="reqn">\rho</code>, <code class="reqn">\lambda</code> and <code class="reqn">\psi_2</code>,
given observations and <code class="reqn">\psi_1</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">p.eqn8.supp(theta, D1, D2, H1, H2, d, include.prior=FALSE,
lognormally.distributed=FALSE, return.log=FALSE, phi)
p.eqn8.supp.vector(theta, D1, D2, H1, H2, d, include.prior=FALSE,
lognormally.distributed=FALSE, return.log=FALSE, phi)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>Parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D1</code></td>
<td>
<p>Matrix of code run points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D2</code></td>
<td>
<p>Matrix of observation points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H1</code></td>
<td>
<p>Regression function for D1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H2</code></td>
<td>
<p>Regression function for D2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>Vector of code output values and observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include.prior</code></td>
<td>
<p>Boolean, with <code>TRUE</code>
meaning to include the prior PDF for <code class="reqn">\theta</code> and default
<code>FALSE</code> meaning  return the likelihood, multiplied by an
undetermined constant</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lognormally.distributed</code></td>
<td>
<p>Boolean, with <code>TRUE</code> meaning to
assume prior is lognormal (see <code>prob.theta()</code> for more info)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.log</code></td>
<td>
<p>Boolean, with default <code>FALSE</code> meaning to return
the probability; <code>TRUE</code> means to return the (natural) logarithm
of the answer</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>Hyperparameters</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The user should always use <code>p.eqn8.supp()</code>, which is a wrapper
for <code>p.eqn8.supp.vector()</code>.  The forms differ in their treatment
of <code class="reqn">\theta</code>.  In the former, <code class="reqn">\theta</code> must be a
vector; in the latter, <code class="reqn">\theta</code> may be a matrix, in which
case <code>p.eqn8.supp.vector()</code> is applied to the rows
</p>


<h3>Author(s)</h3>

<p>Robin K. S. Hankin</p>


<h3>References</h3>


<ul>
<li>
<p>M. C. Kennedy and A. O'Hagan 2001. <em>Bayesian
calibration of computer models</em>.  Journal of the Royal Statistical
Society B, 63(3) pp425-464
</p>
</li>
<li>
<p>M. C. Kennedy and A. O'Hagan 2001.  <em>Supplementary details on
Bayesian calibration of computer models</em>, Internal report, University
of Sheffield.  Available at
<a href="http://www.tonyohagan.co.uk/academic/ps/calsup.ps">http://www.tonyohagan.co.uk/academic/ps/calsup.ps</a>
</p>
</li>
<li>
<p>R. K. S. Hankin 2005. <em>Introducing BACCO, an R bundle for
Bayesian analysis of computer code output</em>, Journal of Statistical
Software, 14(16)
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>W2</code>,<code>stage1</code></p>


<h3>Examples</h3>

<pre><code class="language-R">data(toys)
p.eqn8.supp(theta=theta.toy, D1=D1.toy, D2=D2.toy, H1=H1.toy, H2=H2.toy,
d=d.toy, phi=phi.toy)

## Now try using the true hyperparameters, and data directly drawn from
## the appropriate multivariate distn:

phi.true &lt;- phi.true.toy(phi=phi.toy)
jj &lt;- create.new.toy.datasets(D1.toy , D2.toy)
d.toy &lt;- jj$d.toy
p.eqn8.supp(theta=theta.toy, D1=D1.toy, D2=D2.toy, H1=H1.toy,
     H2=H2.toy, d=d.toy, phi=phi.true)


## Now try p.eqn8.supp() with a vector of possible thetas:
p.eqn8.supp(theta=sample.theta(n=11,phi=phi.true), D1=D1.toy,
     D2=D2.toy, H1=H1.toy, H2=H2.toy,  d=d.toy, phi=phi.true)

</code></pre>


</div>