<div class="container">

<table style="width: 100%;"><tr>
<td>codep_PACKAGE</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multiscale Codependence Analysis</h2>

<h3>Description</h3>

<p>Computation of Multiscale Codependence Analysis and spatial eigenvector maps.
Multiscale Codependence Analysis (MCA) consists in assessing the coherence of
pairs of variables in space (or time) using the product of their correlation
coefficients with series of spatial (or temporal) eigenfunctions. That
product, which is positive or negative when variables display similar or
opposing trends, respectively, is called a codependence coefficient.
</p>
<p>The eigenfunctions used in the calculation are obtained in three steps: 1) a
distance matrix is calculated from the locations of samples in space (or the
sampling organisation through time). 2) From that distance matrix, a matrix
of Moran spatial weights is obtained; this is the same matrix as used to
calculate Moran's autocorrelation index, hence the name. And 3) the spatial
weight matrix is eigenvalue-decomposed after centring the rows and columns of
the spatial weight matrix.
</p>
<p>The statistical significance of codependence coefficients is tested using
parametric or permutational testing of a tau statistic. The 'tau' statistic
is the product of the Student's 't' statistics obtained from comparison of
the two variables with a given eigenfunction. The 'tau' statistic can take
either positive or negative values, thereby allowing one to perform
one-tailed or two-tailed testing. For multiple response variables, testing is
performed using the 'phi' statistic instead of 'tau'. That statistic follows
the distribution of the product of two Fisher-Snedocor F statistics (see
product-distribution for details).
</p>


<h3>Details</h3>

<p>Function <code>MCA</code> performs Multiscale Codependence Analysis
(MCA). Functions <code>test.cdp</code> and <code>permute.cdp</code> handle
parametric or permutation testing of the codependence coefficients,
respectively.
</p>
<p>Methods are provided to print and plot cdp-class objects
(<code>print.cdp</code> and <code>plot.cdp</code>, respectively) as well as
summary (<code>summary.cdp</code>), fitted values
(<code>fitted.cdp</code>), residuals (<code>residuals.cdp</code>), and for
making predictions (<code>predict.cdp</code>).
</p>
<p>Function <code>eigenmap</code> calculates spatial eigenvector maps following
the approach outlined in Dray et al. (2006), and which are necessary to
calculate <code>MCA</code>. It returns a eigenmap-class object. The
package also features methods to print (<code>print.eigenmap</code>) and
plot (<code>plot.eigenmap</code>) these objects. Function
<code>eigenmap.score</code> can be used to make predictions for spatial
models built from the eigenfunctions of <code>eigenmap</code> using
distances between one or more target locations and the sampled locations for
which the spatial eigenvector map was built.
</p>
<p>The package also features an exemplary dataset salmon containing 76
sampling site positions along a 1520 m river segment. It also contains
functions <code>cthreshold</code> and <code>minpermute</code>, which
compute the testwise type I error rate threshold corresponding to a given
familywise threshold and the minimal number of permutations needed for
testing Multiscale Codependence Analysis given the alpha threshold,
respectively.
</p>
<p>The DESCRIPTION file:
</p>

<table>
<tr>
<td style="text-align: left;">
Package: </td>
<td style="text-align: left;"> codep</td>
</tr>
<tr>
<td style="text-align: left;">
Type: </td>
<td style="text-align: left;"> Package</td>
</tr>
<tr>
<td style="text-align: left;">
Version: </td>
<td style="text-align: left;"> 1.2-4</td>
</tr>
<tr>
<td style="text-align: left;">
Date: </td>
<td style="text-align: left;"> 2024-09-23</td>
</tr>
<tr>
<td style="text-align: left;">
Encoding: </td>
<td style="text-align: left;"> UTF-8</td>
</tr>
<tr>
<td style="text-align: left;">
Title: </td>
<td style="text-align: left;"> Multiscale Codependence Analysis</td>
</tr>
<tr>
<td style="text-align: left;">
Description: </td>
<td style="text-align: left;"> Computation of Multiscale Codependence Analysis and spatial eigenvector maps.</td>
</tr>
<tr>
<td style="text-align: left;">
Authors@R: </td>
<td style="text-align: left;"> c(
    person(
      given = "Guillaume",
      family = "Guénard",
      role = c("aut","cre"),
      email = "guillaume.guenard@umontreal.ca",
      comment = c(ORCID = "0000-0003-0761-3072")),
    person(
      given = "Pierre",
      family = "Legendre",
      role = "ctb",
      email = "pierre.legendre@umontreal.ca",
      comment = c(ORCID = "0000-0002-3838-3305")
    ),
    person(
      given = "Bertrand",
      family = "Pages",
      role = "ctb"
    )
  )</td>
</tr>
<tr>
<td style="text-align: left;">
Depends: </td>
<td style="text-align: left;"> R (&gt;= 3.5.0)</td>
</tr>
<tr>
<td style="text-align: left;">
Suggests: </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
Imports: </td>
<td style="text-align: left;"> grDevices, graphics, stats, parallel</td>
</tr>
<tr>
<td style="text-align: left;">
License: </td>
<td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
<td style="text-align: left;">
LazyLoad: </td>
<td style="text-align: left;"> yes</td>
</tr>
<tr>
<td style="text-align: left;">
NeedsCompilation: </td>
<td style="text-align: left;"> yes</td>
</tr>
<tr>
<td style="text-align: left;">
Repository: </td>
<td style="text-align: left;"> CRAN</td>
</tr>
<tr>
<td style="text-align: left;">
RoxygenNote: </td>
<td style="text-align: left;"> 7.3.1</td>
</tr>
<tr>
<td style="text-align: left;">
Author: </td>
<td style="text-align: left;"> Guillaume Guénard [aut, cre] (ORCID:
    &lt;https://orcid.org/0000-0003-0761-3072&gt;),
  Pierre Legendre [ctb] (ORCID: &lt;https://orcid.org/0000-0002-3838-3305&gt;),
  Bertrand Pages [ctb]</td>
</tr>
<tr>
<td style="text-align: left;">
Maintainer: </td>
<td style="text-align: left;"> Guillaume Guénard &lt;guillaume.guenard@umontreal.ca&gt;</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>Index of help topics:
</p>
<pre>
Doubs                   The Doubs Fish Data
Euclid                  Calculation of the Euclidean Distance
LGDat                   Legendre and Gallagher Synthetic Example
LGTransforms            Transformation for Species Abundance Data
MCA                     Multiple-descriptors, Multiscale Codependence
                        Analysis
cdp-class               Class and Methods for Multiscale Codependence
                        Analysis (MCA)
codep_PACKAGE           Multiscale Codependence Analysis
cthreshold              Familywise Type I Error Rate
eigenmap                Spatial Eigenvector Maps
eigenmap-class          Class and Methods for Spatial Eigenvector Maps
geodesics               Calculation of Geodesic Distances
minpermute              Number of Permutations for MCA
mite                    The Oribatid Mite Data Set
product-distribution    Frequency Distributions for MCA Parametric
                        Testing
salmon                  The St. Marguerite River Altantic Salmon Parr
                        Transect
weighting-functions     Weighting Functions for Spatial Eigenvector Map
</pre>


<h3>Author(s)</h3>

<p>Guillaume Guénard [aut, cre] (ORCID:
    &lt;https://orcid.org/0000-0003-0761-3072&gt;),
  Pierre Legendre [ctb] (ORCID: &lt;https://orcid.org/0000-0002-3838-3305&gt;),
  Bertrand Pages [ctb]
Maintainer: Guillaume Guénard &lt;guillaume.guenard@umontreal.ca&gt;
</p>


<h3>References</h3>

<p>Dray, S.; Legendre, P. and Peres-Neto, P. 2006. Spatial modelling: a
comprehensive framework for principal coordinate analysis of neighbor
matrices (PCNM). Ecol. Modelling 196: 483-493
</p>
<p>Guénard, G., Legendre, P., Boisclair, D., and Bilodeau, M. 2010. Multiscale
codependence analysis: an integrated approach to analyse relationships across
scales. Ecology 91: 2952-2964
</p>
<p>Guénard, G. Legendre, P. 2018. Bringing multivariate support to multiscale
codependence analysis: Assessing the drivers of community structure across
spatial scales. Meth. Ecol. Evol. 9: 292-304
</p>


<h3>See Also</h3>

<p>Legendre, P. and Legendre, L. 2012. Numerical Ecology, 3rd English edition.
Elsevier Science B.V., Amsterdam, The Neatherlands.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(mite)
emap &lt;- eigenmap(x = mite.geo, weighting = wf.RBF, wpar = 0.1)
emap

## Organize the environmental variables
mca0 &lt;- MCA(Y = log1p(mite.species), X = mite.env, emobj = emap)
mca0_partest &lt;- test.cdp(mca0, response.tests = FALSE)
summary(mca0_partest)
plot(mca0_partest, las = 2, lwd = 2)
plot(mca0_partest, col = rainbow(1200)[1L:1000], las = 3, lwd = 4,
     main = "Codependence diagram", col.signif = "white")

rng &lt;- list(x = seq(min(mite.geo[,"x"]) - 0.1, max(mite.geo[,"x"]) + 0.1, 0.05),
            y = seq(min(mite.geo[,"y"]) - 0.1, max(mite.geo[,"y"]) + 0.1, 0.05))
grid &lt;- cbind(x = rep(rng[["x"]], length(rng[["y"]])),
              y = rep(rng[["y"]], each = length(rng[["x"]])))
newdists &lt;- matrix(NA, nrow(grid), nrow(mite.geo))
for(i in 1L:nrow(grid)) {
  newdists[i,] &lt;- ((mite.geo[,"x"] - grid[i,"x"])^2 +
                   (mite.geo[,"y"] - grid[i,"y"])^2)^0.5
}

spmeans &lt;- colMeans(mite.species)
pca0 &lt;- svd(log1p(mite.species) - rep(spmeans, each = nrow(mite.species)))

prd0 &lt;- predict(
  mca0_partest,
  newdata = list(target = eigenmap.score(emap, newdists))
)
Uprd0 &lt;- (prd0 - rep(spmeans, each = nrow(prd0))) %*% pca0$v %*%
  diag(pca0$d^-1)

## Printing the response variable
prmat &lt;- Uprd0[,1L]
dim(prmat) &lt;- c(length(rng$x), length(rng$y))
zlim &lt;- c(min(min(prmat), min(pca0$u[,1L])), max(max(prmat), max(pca0$u[,1L])))
image(z = prmat, x = rng$x, y = rng$y, asp = 1, zlim = zlim,
      col = rainbow(1200L)[1L:1000], ylab = "y", xlab = "x")
points(
  x = mite.geo[,"x"], y = mite.geo[,"y"], pch = 21,
  bg = rainbow(1200L)[round(1+(999*(pca0$u[,1L] - zlim[1L])/
                    (zlim[2L] - zlim[1L])),0)]
)

</code></pre>


</div>