<div class="container">

<table style="width: 100%;"><tr>
<td>EMmodel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Endler and Mielke (2005) colour vision model
</h2>

<h3>Description</h3>

<p>Endler and Mielke (2005) colour vision model extended to animals with any number of photoreceptor types.
</p>


<h3>Usage</h3>

<pre><code class="language-R">EMmodel(photo = ncol(C)-1, type="length", R, I, Rb, C,
        interpolate=TRUE, nm=seq(300,700,1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>photo</code></td>
<td>

<p>Number of photoreceptor types. Model accepts any number of photoreceptor types (<code>&gt;=2</code>). For instance, dichromatic: <code>photo=2</code>; trichromatic: <code>photo=3</code>; tetrachromatic: <code>photo=4</code>, etc. Default gets number of photoreceptor types from <code>C</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Whether the colour space should be built with a fixed vector length (<code>type="length"</code>), or a fixed edge length (distance between vertices; <code>type="edge")</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>

<p>Reflectance of observed objects. A data frame with first column corresponding to wavelength values and following columns with reflectance values. <code>R</code> must be in the same scale as <code>Rb</code> (percentage or proportion).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>I</code></td>
<td>

<p>Irradiance spectrum. A data frame with two columns only: first column corresponding to wavelength values and second column with irradiance values. Irradiance values must be in quantum flux units.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rb</code></td>
<td>

<p>Background reflectance. A data frame with two columns only: first column corresponding to wavelength values and second column with reflectance values. <code>Rb</code> must be in the same scale as <code>R</code> (percentage or proportion).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>

<p>Photoreceptor sensitivity curves, from lowest to longest lambda-max. A data frame: first column corresponding to wavelength values and following columns with photoreceptor sensitivity values (see function <code>photor</code>). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interpolate</code></td>
<td>

<p>Whether data files should be interpolated before further calculations. See <code>approx</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nm</code></td>
<td>

<p>A sequence of numeric values specifying where interpolation is to take place. See <code>approx</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The original model is available for tetrachromatic animals only. In <code>colourvision</code>, the model was extended to any number of photoreceptors types (see also Pike 2012 formula).
</p>
<p>First, relative quantum catches are log-transformed:
</p>
<p style="text-align: center;"><code class="reqn">f_{i} = \ln{q_i}</code>
</p>

<p>where <code class="reqn">q_i</code> is the relative quantum catch of photoreceptor type i, given by <code>Qr</code>. The model uses only relative output values, so that photoreceptor outputs are given by:
</p>
<p style="text-align: center;"><code class="reqn">E_i = \frac{f_i}{\sum_{i=1}^n f_i}</code>
</p>

<p>For tetrachromatic vision (Endler and Mielke 2005):
</p>
<p style="text-align: center;"><code class="reqn">X1 = \sqrt{\frac{3}{2}}(\frac{1-2E_2-E_3-E_1}{2})</code>
</p>

<p style="text-align: center;"><code class="reqn">X2 = \frac{-1+3E_3+E_1}{2\sqrt{2}}</code>
</p>

<p style="text-align: center;"><code class="reqn">X3 = E_1-\frac{1}{4}</code>
</p>

<p>Tetrachromatic chromaticity diagram (tetrahedron) in Endler and Mielke (2005) has a vector of length = 0.75 and and edge length = sqrt(3/2). The chromaticity coordinates for other colour spaces may preserve either the same vector length or edge length. 
</p>
<p>For instance, for dichromatic vision coordinate (X1) in the colour space preserving the same vector length is found by:
</p>
<p style="text-align: center;"><code class="reqn">X1 = \frac{3}{4}(E_2-E_1)</code>
</p>

<p>Whereas for trichromatic vision coordinates (X1 and X2) are found by:
</p>
<p style="text-align: center;"><code class="reqn">X1 = \frac{3\sqrt{3}}{8}(E_2-E_1)</code>
</p>

<p style="text-align: center;"><code class="reqn">X2 = \frac{3}{4}(E_3-\frac{E_2+E_1}{2})</code>
</p>



<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Qri</code></td>
<td>
<p>Photoreceptor photon catch values after the von Kries transformation (see function <code>Qr</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ei</code></td>
<td>
<p>Photoreceptor outputs after conversion to relative values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xi</code></td>
<td>
<p>Coordinates in the colour space.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deltaS</code></td>
<td>
<p>Euclidean distance to the origin of the colour space. It represents the conspicuousness of the stimulus (<code>R</code>) in relation to the background (<code>Rb</code>).</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Felipe M. Gawryszewski <a href="mailto:f.gawry@gmail.com">f.gawry@gmail.com</a>
</p>


<h3>References</h3>

<p>Endler, J. A., and P. Mielke. 2005. Comparing entire colour patterns as birds see them. Biol J Linn Soc 86:405-431.
</p>
<p>Pike, T.W. 2012. Generalised chromaticity diagrams for animals with n-chromatic colour vision. Journal of Insect Behavior 255: 277-286.
</p>


<h3>See Also</h3>

<p><code>EMline</code>, <code>EMtriangle</code>, <code>EMtetrahedron</code>, <code>photor</code>, <code>CTTKmodel</code>, <code>RNLmodel</code>, <code>GENmodel</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">##Photoreceptor sensitivity curves
##with lambda max at 350nm, 450nm and 550nm:
C&lt;-photor(lambda.max=c(350,450,550))

##Gray background
##with 7 percent reflectance from 300 to 700nm:
Rb &lt;- data.frame(300:700, rep(7, length(300:700)))

## Read CIE D65 standard illuminant
data("D65")

##Reflectance data
## with a sigmoid spectrum and midpoint at 500nm and 550 nm
R1&lt;-logistic(x=seq(300,700,1), x0=500, L=50, k=0.04)
R2&lt;-logistic(x=seq(300,700,1), x0=550, L=50, k=0.04)
R&lt;-cbind(R1, R2[,2])
R[,2]&lt;-R[,2]+10
R[,3]&lt;-R[,3]+10

## Run model 
model&lt;-EMmodel(photo=3, type="edge",
       R=R, I=D65, Rb=Rb, C=C)

plot(model)
</code></pre>


</div>