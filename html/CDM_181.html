<div class="container">

<table style="width: 100%;"><tr>
<td>vcov</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Asymptotic Covariance Matrix, Standard Errors and Confidence Intervals</h2>

<h3>Description</h3>

<p>Computes the asymptotic covariance matrix for
<code>din</code> objects. The covariance matrix is computed using the
empirical cross-product approach (see Paek &amp; Cai, 2014).
</p>
<p>In addition, an S3 method <code>IRT.se</code> is defined which produces
an extended output including <code>vcov</code> and <code>confint</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'din'
vcov(object, extended=FALSE, infomat=FALSE,ind.item.skillprobs=TRUE,
       ind.item=FALSE, diagcov=FALSE, h=.001,...)

## S3 method for class 'din'
confint(object, parm, level=.95, extended=FALSE,
      ind.item.skillprobs=TRUE, ind.item=FALSE, diagcov=FALSE, h=.001, ... )

IRT.se(object, ...)

## S3 method for class 'din'
IRT.se( object, extended=FALSE, parm=NULL, level=.95,
      infomat=FALSE, ind.item.skillprobs=TRUE, ind.item=FALSE,
      diagcov=FALSE, h=.001, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object inheriting from class <code>din</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extended</code></td>
<td>
<p>An optional logical indicating whether the covariance
matrix should be calculated for an extended set of parameters
(estimated and derived parameters).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>infomat</code></td>
<td>
<p>An optional logical indicating whether the
information matrix instead of the covariance matrix should be
the output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ind.item.skillprobs</code></td>
<td>
<p>Optional logical indicating whether the covariance
between item parameters and skill class probabilities are assumed
to be zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ind.item</code></td>
<td>
<p>Optional logical indicating whether covariances of
item parameters between different items are zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diagcov</code></td>
<td>
<p>Optional logical indicating whether all covariances
between estimated parameters are set to zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>Parameter used for numerical differentiation for computing
the derivative of the log-likelihood function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parm</code></td>
<td>
<p>Vector of parameters. If it is missing, then for all estimated
parameters a confidence interval is calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>Confidence level</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to be passed.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>coef</code>: A vector of parameters.
</p>
<p><code>vcov</code>: A covariance matrix. The corresponding coefficients can be extracted
as the attribute <code>coef</code> from this object.
</p>
<p><code>IRT.se</code>: A data frame containing coefficients, standard errors
and confidence intervals for all parameters.
</p>


<h3>References</h3>

<p>Paek, I., &amp; Cai, L. (2014). A comparison of item parameter standard error
estimation procedures for unidimensional and multidimensional item response
theory modeling. <em>Educational and Psychological Measurement, 74</em>(1),
58-76.
</p>


<h3>See Also</h3>

<p><code>din</code>, <code>coef.din</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
#############################################################################
# EXAMPLE 1: DINA model sim.dina
#############################################################################

data(sim.dina, package="CDM")
data(sim.qmatrix, package="CDM")

dat &lt;- sim.dina
q.matrix &lt;- sim.qmatrix

#****** Model 1: DINA Model
mod1 &lt;- CDM::din( dat, q.matrix=q.matrix, rule="DINA")
# look into parameter table of the model
mod1$partable
# covariance matrix
covmat1 &lt;- vcov(mod1 )
# extract coefficients
coef(mod1)
# extract standard errors
sqrt( diag( covmat1))
# compute confidence intervals
confint( mod1, level=.90 )
# output table with standard errors
IRT.se( mod1, extended=TRUE )

#****** Model 2: Constrained DINA Model

# fix some slipping parameters
constraint.slip &lt;- cbind( c(2,3,5), c(.15,.20,.25) )
# set some skill class probabilities to zero
zeroprob.skillclasses &lt;- c(2,4)
# estimate model
mod2 &lt;- CDM::din( dat, q.matrix=q.matrix, guess.equal=TRUE,
     constraint.slip=constraint.slip, zeroprob.skillclasses=zeroprob.skillclasses)
# parameter table
mod2$partable
# freely estimated coefficients
coef(mod2)
# covariance matrix (estimated parameters)
vmod2a &lt;- vcov(mod2)
sqrt( diag( vmod2a))        # standard errors
colnames( vmod2a )
names( attr( vmod2a, "coef") )    # extract coefficients

# covariance matrix (more parameters, extended=TRUE)
vmod2b &lt;- vcov(mod2, extended=TRUE)
sqrt( diag( vmod2b))
attr( vmod2b, "coef")
# attach standard errors to parameter table
partable2 &lt;- mod2$partable
partable2 &lt;- partable2[ ! duplicated( partable2$parnames ), ]
partable2 &lt;- data.frame( partable2, "se"=sqrt( diag( vmod2b)) )
partable2

# confidence interval for parameter "skill1" which is not in the model
#   cannot be calculated!
confint(mod2, parm=c( "skill1", "all_guess" ) )
# confidence interval for only some parameters
confint(mod2, parm=paste0("prob_skill", 1:3 ) )

# compute only information matrix
infomod2 &lt;- vcov(mod2, infomat=TRUE)

## End(Not run)
</code></pre>


</div>