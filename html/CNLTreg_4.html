<div class="container">

<table style="width: 100%;"><tr>
<td>denoisepermC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Denoises a signal using the complex-valued lifting transform and multivariate soft thresholding
</h2>

<h3>Description</h3>

<p>Denoises an input signal contaminated by noise. First the signal is decomposed using the complex-valued lifting 
scheme (see <code>fwtnppermC</code>) using an order of point removal. The resulting complex-valued wavelet
coefficients are then thresholded using a soft thresholding rule on the details' magnitude.  
The transform is inverted and an estimate of the noisy signal is obtained.
</p>


<h3>Usage</h3>

<pre><code class="language-R">denoisepermC(x, f, returnall = FALSE, sdtype = "adlift", verbose = FALSE, ...)



</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Vector of any length (not necessarily equally spaced) that gives the grid on which the signal is 
observed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>Vector of the same length as <code>x</code> that gives the signal values corresponding to the 
<code>x</code>-locations. </p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>returnall</code></td>
<td>
<p>Indicates whether the function returns useful variables or just the denoised datapoints.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdtype</code></td>
<td>
<p>Options are either <code>"adlift"</code> or <code>"complex"</code>, indicating whether the noise variance is estimated with the average of the mean absolute deviations of both real and imaginary components of the finest wavelet coefficients, or just the real component, as in <code>denoise</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Indicates whether useful messages should be printed to the console during the procedure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Any other arguments to be passed to <code>fwtnppermC</code>, see documentation for this function for more details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>After the complex lifting transform is applied, the wavelet coeficients are divided into artificial levels. 
The details from the lifting scheme have different variances, and will therefore be normalized 
to have the same variance as the noise, by using the lifting matrix. Those normalized details falling into the finest artificial level will 
be used for estimating the standard deviation of the noise that contaminated the signal.  The variable <span class="env">sdtype</span> is used for this estimate, see Appendix B of Hamilton et al. (2018) for more details.  Using this 
estimate,  the normalized details can then be thresholded and un-normalized.  The transform is then inverted to give an estimate of the signal. 
</p>


<h3>Value</h3>

<p>If <span class="env">returnall=FALSE</span>, the estimate of the function after denoising.  If <span class="env">returnall=TRUE</span>, 
a list with components:<br></p>
<table>
<tr style="vertical-align: top;">
<td><code>fhat</code></td>
<td>
<p>Estimated signal after removing the noise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>This is the matrix associated to the modified lifting transform.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indsd</code></td>
<td>
<p>Vector giving the standard deviations of the detail and scaling coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>al</code></td>
<td>
<p>List giving the split of points between the artificial levels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd</code></td>
<td>
<p>Estimated standard deviation of the noise.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Matt Nunes, Marina Knight
</p>


<h3>References</h3>

<p>Hamilton, J., Nunes, M. A., Knight, M. I. and Fryzlewicz, P. (2018) Complex-valued wavelet lifting and applications.
<em>Technometrics</em>, <b>60</b> (1), 48-60, DOI 10.1080/00401706.2017.1281846.
</p>


<h3>See Also</h3>

<p><code>denoisepermCh</code>,
<code>fwtnppermC</code>,
<code>mthreshC</code>,
<code>cnlt.reg</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">    library(adlift)

    # construct an (irregular) observation grid
     x&lt;-runif(256)

     #construct the true, normally unknown, signal
     g&lt;-make.signal2("blocks",x=x)

     #generate noise with mean 0 and signal-to-noise ratio 5
     noise&lt;-rnorm(256,mean=0,sd=sqrt(var(g))/5)

     #generate a noisy version of g
     f&lt;-g+noise

     # perform the complex-valued denoising procedure to the noisy signal (x,f):
     est&lt;-denoisepermC(x,f,LocalPred=AdaptPred,neigh=1,returnall=FALSE)

</code></pre>


</div>