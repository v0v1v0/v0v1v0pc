<div class="container">

<table style="width: 100%;"><tr>
<td>CytofTree</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Binary tree algorithm for mass cytometry data analysis.</h2>

<h3>Description</h3>

<p>Binary tree algorithm for mass cytometry data analysis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CytofTree(
  M,
  minleaf = 1,
  t = 0.1,
  verbose = TRUE,
  force_first_markers = NULL,
  transformation = c("asinh", "biexp", "log10", "none"),
  num_col = 1:ncol(M)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>A matrix of size n x p containing mass cytometry measures
of n cells on p markers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minleaf</code></td>
<td>
<p>An integer indicating the minimum number of cells
per population. Default is <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>A real positive-or-null number used for comparison with
the normalized AIC computed at each node of the tree.
A higher value limits the height of the tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A logical controlling if a text progress bar is displayed 
during the execution of the algorithm. By default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>force_first_markers</code></td>
<td>
<p>a vector of index to split the data on first.
This argument is used in the semi-supervised setting, forcing the algorithm to consider 
those markers first, in the order they appear in this <code>force_first_markers</code> vector, 
and forcing the split at every node. Default is <code>NULL</code>, in which case
the clustering algorithm is unsupervised.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transformation</code></td>
<td>
<p>A string indicating the transformation used among <code>asinh</code> 
<code>biexp</code>, <code>log10</code> and <code>none</code>. Default is <code>asinh</code> transformation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_col</code></td>
<td>
<p>An integer vector of index indicating the columns to be transform. 
Default is <code>1:ncol(M)</code> to transform all the data.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>First of all, data can be transformed using different transformations. 
The algorithm is based on the construction of a binary tree,
the nodes of which are subpopulations of cells. At each node,
observed cells and markers are modeled by both a family of normal
distributions and a family of bi-modal normal mixture distributions.
Splitting is done according to a normalized difference of AIC between
the two families.
</p>


<h3>Value</h3>

<p>An object of class 'cytomeTree' providing a partitioning
of the set of n cells.
</p>

<ul>
<li>
<p><code>annotation</code> A <code>data.frame</code> containing the annotation of each 
cell population underlying the tree pattern.
</p>
</li>
<li>
<p><code>labels</code> The partitioning of the set of n cells.
</p>
</li>
<li>
<p><code>M</code> The transformed matrix of mass cytometry.
</p>
</li>
<li>
<p><code>mark_tree</code> A two level list containing markers used
for node splitting.
</p>
</li>
<li>
<p><code>transformation</code> Transformation used
</p>
</li>
<li>
<p><code>num_col</code> Indexes of columns transformed
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Anthony Devaux, Boris Hejblum
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(IMdata)

# dimension of data
dim(IMdata)

# given the size of the dataset, the code below can take several minutes to run

if(interactive()){
# Don't transform Time et Cell_length column
num_col &lt;- 3:ncol(IMdata)

# Build Cytoftree binary tree
tree &lt;- CytofTree(M = IMdata, minleaf = 1, t = 0.1, transformation = "asinh", num_col = num_col)

# Annotation
annot &lt;- Annotation(tree, plot = FALSE, K2markers = colnames(IMdata))

# Provide subpopulations
annot$combinations
}

</code></pre>


</div>