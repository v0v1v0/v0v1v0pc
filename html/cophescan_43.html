<div class="container">

<table style="width: 100%;"><tr>
<td>run_metrop_priors</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Run the hierarchical Metropolis Hastings model to infer priors</h2>

<h3>Description</h3>

<p>Run the hierarchical Metropolis Hastings model to infer priors
</p>


<h3>Usage</h3>

<pre><code class="language-R">run_metrop_priors(
  multi.dat,
  covar = FALSE,
  covar_vec = NULL,
  is_covar_categorical = FALSE,
  nits = 10000,
  thin = 1,
  posterior = FALSE,
  avg_pik = TRUE,
  avg_posterior = TRUE,
  pik = FALSE,
  alpha_mean = -10,
  alpha_sd = 0.5,
  beta_shape = 2,
  beta_scale = 2,
  gamma_shape = 2,
  gamma_scale = 2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>multi.dat</code></td>
<td>
<p>matrix of bf values, rows=traits, named columns=("lBF.Ha","lBF.Hc","nsnps")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covar</code></td>
<td>
<p>whether to include covariates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covar_vec</code></td>
<td>
<p>vector of covariates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>is_covar_categorical</code></td>
<td>
<p>only two categories supported (default=FALSE) - Experimental</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nits</code></td>
<td>
<p>number of iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>
<p>burnin</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>posterior</code></td>
<td>
<p>default: FALSE, estimate posterior probabilities of the hypotheses</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>avg_pik</code></td>
<td>
<p>default: FALSE, estimate the average of the pik</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>avg_posterior</code></td>
<td>
<p>default: FALSE, estimate the average of the posterior probabilities of the hypotheses</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pik</code></td>
<td>
<p>default: FALSE, inferred prior probabilities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_mean</code></td>
<td>
<p>prior for the mean of  alpha</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_sd</code></td>
<td>
<p>prior for the standard deviation of  alpha</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_shape</code></td>
<td>
<p>prior for the shape (gamma distibution) of beta</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_scale</code></td>
<td>
<p>prior for the scale of beta</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma_shape</code></td>
<td>
<p>prior for the shape (gamma distibution) of gamma</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma_scale</code></td>
<td>
<p>prior for the scale of gamma</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>List containing the posterior distribution of the parameters alpha, beta, gamma (if covariate included) and the loglikelihood
</p>
<p>if avg_posterior=TRUE matrix with average of all the posterior probabilities of Hn, Ha and Hc
</p>
<p>if avg_pik=TRUE matrix with average of all the priors: pn, pa and pc
</p>
<p>data, nits and thin contain the input data, number of iterations and burnin respectively specified for the hierarchical model
</p>


</div>