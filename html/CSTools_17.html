<div class="container">

<table style="width: 100%;"><tr>
<td>CST_Anomaly</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Anomalies relative to a climatology along selected dimension with or without 
cross-validation</h2>

<h3>Description</h3>

<p>This function computes the anomalies relative to a climatology 
computed along the selected dimension (usually starting dates or forecast 
time) allowing the application or not of crossvalidated climatologies. The 
computation is carried out independently for experimental and observational 
data products.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CST_Anomaly(
  exp = NULL,
  obs = NULL,
  dim_anom = "sdate",
  cross = FALSE,
  memb_dim = "member",
  memb = TRUE,
  dat_dim = c("dataset", "member"),
  filter_span = NULL,
  ftime_dim = "ftime",
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>exp</code></td>
<td>
<p>An object of class <code>s2dv_cube</code> as returned by <code>CST_Start</code> 
function, containing the seasonal forecast experiment data in the element 
named <code>$data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs</code></td>
<td>
<p>An object of class <code>s2dv_cube</code> as returned by <code>CST_Start</code> 
function, containing the observed data in the element named <code>$data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dim_anom</code></td>
<td>
<p>A character string indicating the name of the dimension 
along which the climatology will be computed. The default value is 'sdate'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cross</code></td>
<td>
<p>A logical value indicating whether cross-validation should be 
applied or not. Default = FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>memb_dim</code></td>
<td>
<p>A character string indicating the name of the member 
dimension. It must be one dimension in 'exp' and 'obs'. If there is no 
member dimension, set NULL. The default value is 'member'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>memb</code></td>
<td>
<p>A logical value indicating whether to subtract the climatology 
based on the individual members (TRUE) or the ensemble mean over all
members (FALSE) when calculating the anomalies. The default value is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dat_dim</code></td>
<td>
<p>A character vector indicating the name of the dataset and 
member dimensions. If there is no dataset dimension, it can be NULL.
The default value is "c('dataset', 'member')".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filter_span</code></td>
<td>
<p>A numeric value indicating the degree of smoothing. This 
option is only available if parameter <code>cross</code> is set to FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ftime_dim</code></td>
<td>
<p>A character string indicating the name of the temporal 
dimension where the smoothing with 'filter_span' will be applied. It cannot
be NULL if 'filter_span' is provided. The default value is 'ftime'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>An integer indicating the number of cores to use for parallel 
computation. The default value is NULL. It will be used only when 
'filter_span' is not NULL.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with two S3 objects, 'exp' and 'obs', of the class 
's2dv_cube', containing experimental and date-corresponding observational 
anomalies, respectively. These 's2dv_cube's can be ingested by other functions 
in CSTools.
</p>


<h3>Author(s)</h3>

<p>Perez-Zanon Nuria, <a href="mailto:nuria.perez@bsc.es">nuria.perez@bsc.es</a>
</p>
<p>Pena Jesus, <a href="mailto:jesus.pena@bsc.es">jesus.pena@bsc.es</a>
</p>


<h3>See Also</h3>

<p><code>Ano_CrossValid</code>, <code>Clim</code> and 
<code>CST_Start</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">mod &lt;- 1 : (2 * 3 * 4 * 5 * 6 * 7)
dim(mod) &lt;- c(dataset = 2, member = 3, sdate = 4, ftime = 5, lat = 6, lon = 7)
obs &lt;- 1 : (1 * 1 * 4 * 5 * 6 * 7)
dim(obs) &lt;- c(dataset = 1, member = 1, sdate = 4, ftime = 5, lat = 6, lon = 7)
lon &lt;- seq(0, 30, 5)
lat &lt;- seq(0, 25, 5)
coords &lt;- list(lon = lon, lat = lat)
exp &lt;- list(data = mod, coords = coords)
obs &lt;- list(data = obs, coords = coords)
attr(exp, 'class') &lt;- 's2dv_cube'
attr(obs, 'class') &lt;- 's2dv_cube'

anom &lt;- CST_Anomaly(exp = exp, obs = obs, cross = FALSE, memb = TRUE)

</code></pre>


</div>