<div class="container">

<table style="width: 100%;"><tr>
<td>distshape</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Dissimilarity matrix
</h2>

<h3>Description</h3>

<p>This function implements the dissimilarity matrix based on shape and distance of curves.
</p>


<h3>Usage</h3>

<pre><code class="language-R">distshape(Beta, alpha=.5, step=c("both", "shape", "distance"), trace=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Beta</code></td>
<td>

<p>A matrix <kbd>n</kbd> x <kbd>q</kbd>. <kbd>q</kbd> represents the number of curves to cluster and <kbd>n</kbd> is either the length of percentiles used in the quantile regression or the length of the time vector.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>It is the alpha-percentile used for computing the dissimilarity matrix. If not fixed, the algorithm choose alpha=.25 (cluster.effects=TRUE) or alpha=.5 (cluster.effects=FALSE).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step</code></td>
<td>

<p>The steps used in computing the dissimilarity matrix. Default is "both"=("shape" and  "distance")
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>

<p>If TRUE, some informations are printed.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The dissimilarity matrix of class “<code>dist</code>”.
</p>


<h3>Author(s)</h3>

<p>Gianluca Sottile <a href="mailto:gianluca.sottile@unipa.it">gianluca.sottile@unipa.it</a>
</p>


<h3>References</h3>

<p>Sottile, G., Adelfio, G. Clusters of effects curves in quantile regression models. Comput Stat 34, 551–569 (2019). https://doi.org/10.1007/s00180-018-0817-8
</p>
<p>Sottile, G and Adelfio, G (2017). <em>Clustering of effects through quantile regression</em>.
Proceedings 32nd International Workshop of Statistical Modeling, Groningen (NL), vol.2 127-130, https://iwsm2017.webhosting.rug.nl/IWSM_2017_V2.pdf.
</p>
<p>Frumento, P., and Bottai, M. (2015). <em>Parametric modeling of quantile regression coefficient functions</em>. Biometrics, doi: 10.1111/biom.12410.
</p>


<h3>See Also</h3>

<p><code>clustEff</code>,<code>summary.clustEff</code>, <code>plot.clustEff</code>,
for summary and plotting.
<code>extract.object</code> to extract useful objects for the clustering algorithm through a quantile regression coefficient modeling in a multivariate case.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
set.seed(1234)
n &lt;- 300
x &lt;- 1:n/n

Y &lt;- matrix(0, n, 30)

sigma2 &lt;- 4*pmax(x-.2, 0) - 8*pmax(x-.5, 0) + 4*pmax(x-.8, 0)

mu &lt;- sin(3*pi*x)
for(i in 1:10) Y[, i] &lt;- mu + rnorm(length(x), 0, pmax(sigma2, 0))

mu &lt;- cos(3*pi*x)
for(i in 11:23) Y[,i] &lt;- mu + rnorm(length(x), 0, pmax(sigma2,0))

mu &lt;- sin(3*pi*x)*cos(pi*x)
for(i in 24:28) Y[, i] &lt;- mu + rnorm(length(x), 0, pmax(sigma2, 0))

mu &lt;- 0 #sin(1/3*pi*x)*cos(2*pi*x)
for(i in 29:30) Y[, i] &lt;- mu + rnorm(length(x), 0, pmax(sigma2, 0))

diss &lt;- distshape(Y)
diss

</code></pre>


</div>