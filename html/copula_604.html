<div class="container">

<table style="width: 100%;"><tr>
<td>xvCopula</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Model (copula) selection based on <code>k</code>-fold cross-validation</h2>

<h3>Description</h3>

<p>Computes the leave-one-out cross-validation criterion (or a
<code>k</code>-fold version of it) for the hypothesized parametric copula
family using, by default, maximum pseudo-likelihood estimation.
</p>
<p>The leave-one-out criterion is a crossvalidated log likelihood. It is
denoted by <code class="reqn">\widehat{xv}_n</code> in Grønneberg and Hjort
(2014) and defined in equation (42) therein. When computed for several
parametric copula families, it is thus meaningful to select the family
maximizing the criterion.
</p>
<p>For <code class="reqn">k &lt; n</code>, <code class="reqn">n</code> the sample size, the <code>k</code>-fold version is
an approximation of the leave-one-out criterion that uses <code class="reqn">k</code>
randomly chosen (almost) equally sized data blocks instead of <code class="reqn">n</code>.
When <code class="reqn">n</code> is large, <code class="reqn">k</code>-fold cross-validation is considerably
faster (if <code class="reqn">k</code> is “small” compared to <code class="reqn">n</code>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">xvCopula(copula, x, k = NULL, verbose = interactive(),
         ties.method = eval(formals(rank)$ties.method), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>copula</code></td>
<td>
<p>object of class <code>"copula"</code>
representing the hypothesized copula family.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a data matrix that will be transformed to pseudo-observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>the number of data blocks; if <code>k = NULL</code>, <code>nrow(x)</code>
blocks are considered (which corresponds to leave-one-out
cross-validation).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>a logical indicating if progress of the cross validation
should be displayed via <code>txtProgressBar</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ties.method</code></td>
<td>
<p>string specifying how ranks should be computed if
there are ties in any of the coordinate samples of <code>x</code> and
fitting is based on maximum pseudo-likelihood; passed
to <code>pobs</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments passed to <code>fitCopula()</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A real number equal to the cross-validation criterion
multiplied by the sample size.
</p>


<h3>Note</h3>

<p>Note that <code>k</code>-fold cross-validation with <code>k &lt; n</code>
shuffles the lines of <code>x</code> prior to forming the blocks.  The
result thus depends on the value of the random seed.
</p>
<p>The default estimation method is maximum pseudo-likelihood estimation
but this can be changed if necessary along with all the other
arguments of <code>fitCopula()</code>.
</p>


<h3>References</h3>

<p>Grønneberg, S., and Hjort, N.L. (2014)
The copula information criteria.
<em>Scandinavian Journal of Statistics</em> <b>41</b>, 436–459.
</p>


<h3>See Also</h3>

<p><code>fitCopula()</code> for the underlying estimation procedure and
<code>gofCopula()</code> for goodness-of-fit tests.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## A two-dimensional data example ----------------------------------
x &lt;- rCopula(200, claytonCopula(3))


## Model (copula) selection -- takes time: each fits 200 copulas to 199 obs.
xvCopula(gumbelCopula(), x)
xvCopula(frankCopula(), x)
xvCopula(joeCopula(), x)
xvCopula(claytonCopula(), x)
xvCopula(normalCopula(), x)
xvCopula(tCopula(), x)
xvCopula(plackettCopula(), x)


## The same with 5-fold cross-validation [to save time ...]
set.seed(1) # k-fold is random (for k &lt; n) !
xvCopula(gumbelCopula(),  x, k=5)
xvCopula(frankCopula(),   x, k=5)
xvCopula(joeCopula(),     x, k=5)
xvCopula(claytonCopula(), x, k=5)
xvCopula(normalCopula(),  x, k=5)
xvCopula(tCopula(),       x, k=5)
xvCopula(plackettCopula(),x, k=5)
</code></pre>


</div>