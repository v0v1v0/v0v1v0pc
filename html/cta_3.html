<div class="container">

<table style="width: 100%;"><tr>
<td>check.HLP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
HLP Link Status Check
</h2>

<h3>Description</h3>

<p>Checks whether the link function <code class="reqn">L(\cdot)</code> is a candidate HLP link
function.
</p>
<p>Specifically, this program checks whether <code class="reqn">L(\cdot)</code> satisfies
certain necessary conditions that follow from a sufficient condition for HLP
link status.
</p>
<p>If the necessary conditions are satisfied then there is corroborating evidence
that <code class="reqn">L(\cdot)</code> has HLP link status. If the necessary conditions are not satisfied,
then the sufficient condition for HLP link status is not satisfied, so <code class="reqn">L(\cdot)</code>
may or may not have HLP link status.
</p>


<h3>Usage</h3>

<pre><code class="language-R">check.HLP(L.fct, Z, tol = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>L.fct</code></td>
<td>
<p>An <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> function object, indicating the link <code class="reqn">L(\cdot)</code> for HLP
link status check.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>Population (aka strata) matrix <code class="reqn">Z</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>The pre-set tolerance with which <code>norm(diff)</code> is to be compared
with.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The main idea:
</p>
<p>The model <code class="reqn">L(m) = X\beta</code> is an HLP model if <code class="reqn">L(\cdot)</code> is a smooth link function that satisfies the HLP conditions with respect to <code class="reqn">Z</code> (i.e. strata <code class="reqn">s</code>) and <code class="reqn">X</code>. That is,
</p>

<ul>
<li>
<p> (1) <code class="reqn">L(\cdot)</code> has HLP link status with respect to <code class="reqn">Z</code>,   and
</p>
</li>
<li>
<p> (2) The implied constraint function <code class="reqn">h(m) = U'L(m)</code> is <code class="reqn">Z</code> homogeneous.
Here, <code class="reqn">null(U') = span(X)</code>.
</p>
</li>
</ul>
<p>Here, (1) <code class="reqn">L(\cdot)</code> has HLP link status with respect to <code class="reqn">Z</code> if, for <code class="reqn">m = Diag(Z\gamma)p</code>, equivalently, for <code class="reqn">\gamma = Z'm</code> and <code class="reqn">p = Diag^{-1}(ZZ'm)m</code>,
</p>

<ul>
<li>
<p> (1)(a) <code class="reqn">L(m) = a(\gamma) + L(p)</code>, where <code class="reqn">a(\gamma_{1}/\gamma_{2}) - a(1) = a(\gamma_{1}) - a(\gamma_{2})</code>,
i.e. <code class="reqn">a(\gamma)</code> has the form <code class="reqn">C \log\gamma + \texttt{constant}</code>;
or
</p>
</li>
<li>
<p> (1)(b) <code class="reqn">L(m) = G(\gamma) L(p)</code>, where <code class="reqn">G(\gamma)</code> is a diagonal matrix with
diagonal elements that are powers of the <code class="reqn">\gamma</code> elements, i.e. <code class="reqn">L(\cdot)</code>
is <code class="reqn">Z</code> homogeneous (see Lang (2004));
or
</p>
</li>
<li>
<p> (1)(c) The components of <code class="reqn">L(\cdot)</code> are a mixture of types (a) and (b):
<code class="reqn">L_{j}(m) = a_{j}(\gamma) + L_{j}(p)</code> or  <code class="reqn">L_{j}(m) = G_{j}(\gamma) L_{j}(p)</code>,
<code class="reqn">j = 1, \ldots, l</code>.
</p>
</li>
</ul>
<p>N.B. Lang (2005) defined HLP models as those satisfying (1)(a) and (2). <code>mph.fit</code> uses a broader definition of HLP model. Specifically, models
satisfying (1)(b) and (2) or (1)(c) and (2) are also considered HLP models.
</p>
<p>Conditions (1)(b) and (2) can be checked using the <code>check.homog</code> function.
Condition (1)(c) is not checked.
</p>
<p>This function, <code>check.HLP</code>, is concerned with sufficient condition (1)(a) only. If <code class="reqn">L(\cdot)</code> satisfies (1)(a)  then
</p>

<ul>
<li>
<p> (i) <code class="reqn">\texttt{diff1} = [L(Diag(Z\gamma_{1})p_{1}) - L(Diag(Z\gamma_{2})p_{1})] - [L(Diag(Z \gamma_{1}/\gamma_{2})p_{1}) - L(p_{1})] = 0</code>, and
</p>
</li>
<li>
<p> (ii) <code class="reqn">\texttt{diff2} = [L(Diag(Z\gamma_{1})p_{1}) - L(Diag(Z\gamma_{1})p_{2})] - [L(p_{1}) - L(p_{2})] = 0</code>.
</p>
</li>
</ul>
<p>Here <code class="reqn">p_{i} = Diag^{-1}(ZZ'm_{i})m_{i}</code>, where <code class="reqn">m_{i} = Diag(Z\gamma_{i})p_{i}</code>, <code class="reqn">i = 1, 2</code>.
</p>
<p>This program randomly generates <code>g1</code> (<code class="reqn">\gamma_{1}</code>), <code>g2</code> (<code class="reqn">\gamma_{2}</code>), <code>p1</code>, <code>p2</code>, and
computes <code>norm(diff) = sqrt(norm(diff1)^2 + norm(diff2)^2)</code>. It returns a warning if <code>norm(diff)</code> is too far from <code class="reqn">0</code>.
</p>


<h3>Value</h3>

<p><code>check.HLP</code> returns a character string <code>chk</code>. If <code>chk = ""</code>, then
there is corroborating evidence that <code class="reqn">L(\cdot)</code> has HLP link status. If
<code>chk = paste("L(m) may not be an HLP link [based on tol=",tol,"]!")</code>, then the sufficient condition for HLP link status is not satisfied, so <code class="reqn">L(\cdot)</code> may or
may not have HLP link status.
</p>


<h3>Author(s)</h3>

<p>Joseph B. Lang
</p>


<h3>References</h3>

<p>Lang, J. B. (2004) Multinomial-Poisson homogeneous models for contingency tables, <em>Annals of Statistics</em>, <b>32</b>, 340–383.
</p>
<p>Lang, J. B. (2005) Homogeneous linear predictor models for contingency tables, <em>Journal of the American Statistical Association</em>, <b>100</b>, 121–134.
</p>


<h3>See Also</h3>

<p><code>mph.fit</code>, <code>check.homog</code>, <code>check.zero.order.homog</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># 3-by-3-by-3 Table.
# For a description of the model, see Michael Haber's Example 2,
# p. 433, in  Biometrics (in Shorter Communications), Vol. 42,
# No. 2. (Jun., 1986), pp. 429-435.
A &lt;- gl(3, 9, 27)
B &lt;- gl(3, 3, 27)
C &lt;- gl(3, 1, 27)
MAB &lt;- kronecker(diag(9), matrix(1, 1, 3))
MAC &lt;- kronecker(diag(3), kronecker(matrix(1, 1, 3), diag(3)))
MBC &lt;- kronecker(matrix(1, 1, 3), diag(9))
M &lt;- rbind(MAB, MAC, MBC)
Mr &lt;- M[-c(3, 6, 7, 8, 9, 12, 15, 16, 17, 18, 21, 24,
           25, 26, 27), ]
C &lt;- c(1, -1, -1, 1, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 1, -1, -1, 1, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 1, -1, -1, 1)
C &lt;- matrix(C, 3, 12, byrow = TRUE)
L.fct &lt;- function(m) {
  p &lt;- m / sum(m)
  C %*% log(Mr %*% p)
}
Z &lt;- matrix(rep(1, 27), ncol = 1)
check.HLP(L.fct, Z)
</code></pre>


</div>