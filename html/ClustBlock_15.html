<div class="container">

<table style="width: 100%;"><tr>
<td>clustatis</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Perform a cluster analysis of blocks of quantitative variables</h2>

<h3>Description</h3>

<p>Hierarchical clustering of quantitative Blocks followed by a partitioning algorithm (consolidation). Each cluster of blocks is associated with a compromise
computed by the STATIS method. Moreover, a noise cluster can be set up.
</p>


<h3>Usage</h3>

<pre><code class="language-R">clustatis(Data,Blocks,NameBlocks=NULL,Noise_cluster=FALSE,scale=FALSE,
  Itermax=30, Graph_dend=TRUE, Graph_bar=TRUE,
  printlevel=FALSE, gpmax=min(6, length(Blocks)-2),  rhoparam=NULL,
  Testonlyoneclust=FALSE, alpha=0.05, nperm=50)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Data</code></td>
<td>
<p>data frame or matrix. Correspond to all the blocks of variables merged horizontally</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Blocks</code></td>
<td>
<p>numerical vector. The number of variables of each block. The sum must be equal to the number of columns of Data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NameBlocks</code></td>
<td>
<p>string vector. Name of each block. Length must be equal to the length of Blocks vector. If NULL, the names are B1,...Bm. Default: NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Noise_cluster</code></td>
<td>
<p>logical. Should a noise cluster be computed? Default: FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>logical. Should the data variables be scaled? Default: FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Itermax</code></td>
<td>
<p>numerical. Maximum of iteration for the partitioning algorithm. Default: 30</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Graph_dend</code></td>
<td>
<p>logical. Should the dendrogram be plotted? Default: TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Graph_bar</code></td>
<td>
<p>logical. Should the barplot of the difference of the criterion and the barplot of the overall homogeneity at each merging step of the hierarchical algorithm be plotted? Default: TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>printlevel</code></td>
<td>
<p>logical. Print the number of remaining levels during the hierarchical clustering algorithm? Default: FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gpmax</code></td>
<td>
<p>logical. What is maximum number of clusters to consider? Default:  min(6, number of blocks -2)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rhoparam</code></td>
<td>
<p>numerical. What is the threshold for the noise cluster? Between 0 and 1, high value can imply lot of blocks set aside. If NULL, automatic threshold is computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Testonlyoneclust</code></td>
<td>
<p>logical. Test if there is more than one cluster? Default: FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>numerical between 0 and 1. What is the threshold to test if there is more than one cluster? Default: 0.05</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nperm</code></td>
<td>
<p>numerical. How many permutations are required to test if there is more than one cluster? Default: 50</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Each partitionK contains a list for each number of clusters of the partition, K=1 to gpmax with:
</p>

<ul>
<li>
<p> group: the clustering partition of datasets after consolidation. If Noise_cluster=TRUE, some blocks could be in the noise cluster ("K+1")
</p>
</li>
<li>
<p> rho: the threshold for the noise cluster (computed or input parameter)
</p>
</li>
<li>
<p> homogeneity: homogeneity index (
</p>
</li>
<li>
<p> rv_with_compromise: RV coefficient of each block with its cluster compromise
</p>
</li>
<li>
<p> weights: weight associated with each block in its cluster
</p>
</li>
<li>
<p> comp_RV: RV coefficient between the compromises associated with the various clusters
</p>
</li>
<li>
<p> compromise: the W compromise of each cluster
</p>
</li>
<li>
<p> coord: the coordinates of objects of each cluster
</p>
</li>
<li>
<p> inertia: percentage of total variance explained by each axis for each cluster
</p>
</li>
<li>
<p> rv_all_cluster: the RV coefficient between each block and each cluster compromise
</p>
</li>
<li>
<p> criterion: the CLUSTATIS criterion error
</p>
</li>
<li>
<p> param: parameters called in the consolidation
</p>
</li>
<li>
<p> type: parameter passed to other functions
</p>
</li>
</ul>
<p>There is also at the end of the list:
</p>

<ul>
<li>
<p> dend: The CLUSTATIS dendrogram
</p>
</li>
<li>
<p> cutree_k: the partition obtained by cutting the dendrogram for K clusters (before consolidation).
</p>
</li>
<li>
<p> overall_homogeneity_ng: percentage of overall homogeneity by number of clusters before consolidation (and after if there is no noise cluster)
</p>
</li>
<li>
<p> diff_crit_ng: variation of criterion when a merging is done before consolidation (and after if there is no noise cluster)
</p>
</li>
<li>
<p> test_one_cluster: decision and pvalue to know if there is more than one cluster
</p>
</li>
<li>
<p> param: parameters called
</p>
</li>
<li>
<p> type: parameter passed to other functions
</p>
</li>
</ul>
<h3>References</h3>

<p>Llobell, F., Cariou, V., Vigneau, E., Labenne, A., &amp; Qannari, E. M. (2018). Analysis and clustering of multiblock datasets by means of the STATIS and CLUSTATIS methods. Application to sensometrics. Food Quality and Preference, in Press.<br>
Llobell, F., Vigneau, E., Qannari, E. M. (2019). Clustering datasets by means of CLUSTATIS with identification of atypical datasets. Application to sensometrics. Food Quality and Preference, 75, 97-104.
</p>


<h3>See Also</h3>

<p><code>plot.clustatis</code>, <code>summary.clustatis</code> , <code>clustatis_kmeans</code>, <code>statis</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
 data(smoo)
 NameBlocks=paste0("S",1:24)
 cl=clustatis(Data=smoo,Blocks=rep(2,24),NameBlocks = NameBlocks)
 #plot(cl, ngroups=3, Graph_dend=FALSE)
 summary(cl)
 #with noise cluster
 cl2=clustatis(Data=smoo,Blocks=rep(2,24),NameBlocks = NameBlocks,
 Noise_cluster=TRUE, Graph_dend=FALSE, Graph_bar=FALSE)
 #with noise cluster and defined rho threshold
 cl3=clustatis(Data=smoo,Blocks=rep(2,24),NameBlocks = NameBlocks,
 Noise_cluster=TRUE, Graph_dend=FALSE, Graph_bar=FALSE, rhoparam=0.5)

</code></pre>


</div>