<div class="container">

<table style="width: 100%;"><tr>
<td>modelKrigingLikelihood</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate negative log-likelihood</h2>

<h3>Description</h3>

<p>Used to determine theta/lambda/p values for the Kriging model in <code>modelKriging</code>
with Maximum Likelihood Estimation (MLE).
</p>


<h3>Usage</h3>

<pre><code class="language-R">modelKrigingLikelihood(
  xt,
  D,
  y,
  useLambda = FALSE,
  corr = fcorrGauss,
  indefiniteMethod = "none",
  indefiniteType = "PSD",
  indefiniteRepair = FALSE,
  returnLikelihoodOnly = TRUE,
  inverter = "chol",
  ntheta = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xt</code></td>
<td>
<p>vector, containing parameters like theta, p and lambda.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>matrix (or list of multiple matrices) of distances between training samples. In case of multiple distance matrices, theta (part of xt) has to be a vector, giving a weighting parameter for each matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>vector of observations at sample locations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useLambda</code></td>
<td>
<p>whether to use nugget effect, i.e., lambda (FALSE at default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corr</code></td>
<td>
<p>whether to use nugget effect, i.e., lambda (fcorrGauss at default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indefiniteMethod</code></td>
<td>
<p>The specific method used for correction: spectrum <code>"clip"</code>, spectrum <code>"flip"</code>, spectrum <code>"square"</code>, spectrum <code>"diffusion"</code>, feature embedding "feature", nearest definite matrix "near". Default is no correction: <code>"none"</code>. See Zaefferer and Bartz-Beielstein (2016).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indefiniteType</code></td>
<td>
<p>The general type of correction for indefiniteness: <code>"NSD"</code>,<code>"CNSD"</code> or the default <code>"PSD"</code>. See Zaefferer and Bartz-Beielstein (2016).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indefiniteRepair</code></td>
<td>
<p>boolean, whether conditions of the distance matrix (in case of <code>"NSD"</code>,<code>"CNSD"</code> correction type) or correlation matrix (in case of <code>"PSD"</code> correction type) are repaired.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnLikelihoodOnly</code></td>
<td>
<p>boolean, whether the function should return only the likelihood, or a else a list (see return information below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inverter</code></td>
<td>
<p>string, defining the inverter to use. default <code>"chol"</code> is inversion via <code>chol2inv</code>. A different string will lead to use of <code>solve</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntheta</code></td>
<td>
<p>number of kernel parameters.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>the numeric Likelihood value (if <code>returnLikelihoodOnly</code> is TRUE) or a list with elements:
</p>

<dl>
<dt><code>NegLnLike</code></dt>
<dd>
<p> concentrated log-likelihood *-1 for minimising </p>
</dd>
<dt><code>Psi</code></dt>
<dd>
<p> correlation matrix</p>
</dd>
<dt><code>Psinv</code></dt>
<dd>
<p> inverse of correlation matrix (to save computation time in forrRegPredictor)</p>
</dd>
<dt><code>mu</code></dt>
<dd>
<p> MLE of model parameter mu </p>
</dd>
<dt><code>yMu</code></dt>
<dd>
<p> vector of observations y minus mu</p>
</dd>
<dt><code>SSQ</code></dt>
<dd>
<p> MLE of model parameter sigma^2</p>
</dd>
<dt><code>a</code></dt>
<dd>
<p> transformation vector for eigenspectrum transformation, see Zaefferer and Bartz-Beielstein (2016)</p>
</dd>
<dt><code>U</code></dt>
<dd>
<p> Matrix of eigenvectors for eigenspectrum transformation, see Zaefferer and Bartz-Beielstein (2016)</p>
</dd>
<dt><code>isIndefinite</code></dt>
<dd>
<p> whether the uncorrected correlation (kernel) matrix is indefinite</p>
</dd>
</dl>
<h3>References</h3>

<p>Forrester, Alexander I.J.; Sobester, Andras; Keane, Andy J. (2008). Engineering Design via Surrogate Modelling - A Practical Guide. John Wiley &amp; Sons.
</p>
<p>Zaefferer, Martin; Stork, Joerg; Friese, Martina; Fischbach, Andreas; Naujoks, Boris; Bartz-Beielstein, Thomas. (2014). Efficient global optimization for combinatorial problems. In Proceedings of the 2014 conference on Genetic and evolutionary computation (GECCO '14). ACM, New York, NY, USA, 871-878. DOI=10.1145/2576768.2598282
</p>
<p>Zaefferer, Martin; Stork, Joerg; Bartz-Beielstein, Thomas. (2014). Distance Measures for Permutations in Combinatorial Efficient Global Optimization. In Parallel Problem Solving from Nature - PPSN XIII (p. 373-383). Springer International Publishing.
</p>
<p>Martin Zaefferer and Thomas Bartz-Beielstein. (2016). Efficient Global Optimization with Indefinite Kernels. Parallel Problem Solving from Nature-PPSN XIV. Accepted, in press. Springer.
</p>


<h3>See Also</h3>

<p><code>modelKriging</code>
</p>


</div>