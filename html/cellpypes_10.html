<div class="container">

<table style="width: 100%;"><tr>
<td>plot_last</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot the last modified rule or class</h2>

<h3>Description</h3>

<p>Plot the last modified rule or class
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_last(
  obj,
  show_feat = TRUE,
  what = "rule",
  fast = NULL,
  legend_rel_width = 0.3,
  overdispersion = 0.01
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>A cellpypes object, see section <strong>cellpypes Objects</strong> below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_feat</code></td>
<td>
<p>If TRUE (default), a second panel shows the feature plot of
the relevant gene.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>what</code></td>
<td>
<p>Either "rule" or "class".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fast</code></td>
<td>
<p>Set this to TRUE if you want fast plotting in spite of many cells
(using the scattermore package). If NULL (default), cellpypes decides
automatically and fast plotting is done for more than 10k cells, if FALSE
it always uses <code>geom_point</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend_rel_width</code></td>
<td>
<p>Relative width compared to the other two plots
(only relevant if <code>show_feat=TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overdispersion</code></td>
<td>
<p>Defaults to 0.01, only change if you know what you
are doing. See further classify.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a ggplot2 object with the plot.
</p>


<h3>cellpypes Objects</h3>

<p>A cellpypes object is a list with four slots:
</p>

<dl>
<dt><code>raw </code></dt>
<dd>
<p>(sparse) matrix with genes in rows, cells in columns</p>
</dd>
<dt><code>totalUMI </code></dt>
<dd>
<p>the colSums of obj$raw</p>
</dd>
<dt><code>embed </code></dt>
<dd>
<p>two-dimensional embedding of the cells, provided as data.frame
or tibble with two columns and one row per cell.</p>
</dd>
<dt><code>neighbors </code></dt>
<dd>
<p>index matrix with one row per cell and k columns, where
k is the number of nearest neighbors (we recommend 15&lt;k&lt;100, e.g. k=50).
Here are two ways to get the neighbors index matrix:
</p>

<ul>
<li>
<p> Use <code>find_knn(featureMatrix)$idx</code>, where featureMatrix could be
principal components, latent variables or normalized genes (features in
rows, cells in columns).
</p>
</li>
<li>
<p> use <code>as(seurat@graphs[["RNA_nn"]], "dgCMatrix")&gt; .1</code> to extract
the kNN
graph computed on RNA. The <code>&gt; .1</code> ensures this also works with RNA_snn,
wknn/wsnn or any other
available graph â€“ check with <code>names(seurat@graphs)</code>.
</p>
</li>
</ul>
</dd>
</dl>
<h3>Examples</h3>

<pre><code class="language-R">plot_last(rule(simulated_umis, "T", "CD3E","&gt;", 1))
</code></pre>


</div>