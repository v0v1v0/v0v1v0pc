<div class="container">

<table style="width: 100%;"><tr>
<td>amce</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Tidy estimation of AMCEs</h2>

<h3>Description</h3>

<p>Estimate AMCEs for a conjoint analysis and return a tidy data frame of results
</p>


<h3>Usage</h3>

<pre><code class="language-R">amce(
  data,
  formula,
  id = ~0,
  weights = NULL,
  feature_order = NULL,
  feature_labels = NULL,
  level_order = c("ascending", "descending"),
  alpha = 0.05,
  ...
)

amce_by_reference(data, formula, variable, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame containing variables specified in <code>formula</code>. All RHS variables should be factors; the base level for each will be used in estimation and its reported AMCE will be NA (for printing). Optionally, this can instead be an object of class “survey.design” returned by <code>svydesign</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A formula specifying an AMCE model to be estimated. All variables should be factors; all levels across features should be unique. Two-way constraints can be specified with an asterisk (*) between RHS features. The specific constrained level pairs within these features are then detected automatically. Higher-order constraints are not allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>An RHS formula specifying a variable holding respondent identifiers, to be used for clustering standard errors. By default, data are unclustered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>An (optional) RHS formula specifying a variable holding survey weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>feature_order</code></td>
<td>
<p>An (optional) character vector specifying the names of feature (RHS) variables in the order they should be encoded in the resulting data frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>feature_labels</code></td>
<td>
<p>A named list of “fancy” feature labels to be used in output. By default, the function looks for a “label” attribute on each variable in <code>formula</code> and uses that for pretty printing. This argument overrides those attributes or otherwise provides fancy labels for this purpose. This should be a list with names equal to variables on the righthand side of <code>formula</code> and character string values; arguments passed here override variable attributes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level_order</code></td>
<td>
<p>A character string specifying levels (within each feature) should be ordered increasing or decreasing in the final output. This is mostly only consequential for plotting via <code>plot.cj_mm</code>, etc.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>A numeric value indicating the significance level at which to calculate confidence intervals for the MMs (by default 0.95, meaning 95-percent CIs are returned).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>For <code>amce</code>: additional arguments to <code>glm</code> or <code>svyglm</code>, the latter being used if <code>weights</code> is non-NULL. For <code>amce_by_reference</code>: additional arguments passed to <code>amce</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variable</code></td>
<td>
<p>An RHS formula containing a single factor variable from <code>formula</code>. This will be used by <code>amce_by_reference</code> to estimate AMCEs relative to each possible factor level as a reference category. If more than one RHS variables are specified, the first will be used.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>amce</code> provides estimates of AMCEs (or rather, average marginal effects for each feature level). Two-way constraints can be specified with an asterisk (*) between features. The specific constrained level pairs within these features are then detected automatically. The function can also be used for calculating average component interaction effects when combined with <code>interaction</code>, and for balance testing by specifying a covariate rather outcome on the left-hand side of <code>formula</code>. See examples.
</p>
<p><code>amce_by_reference</code> provides a tool for quick sensitivity analysis. AMCEs are defined relative to an arbitrary reference category (i.e., feature level). This function will loop over all feature levels (for a specified feature) to show how interpretation will be affected by choice of reference category. The resulting data frame will be a stacked result from <code>amce</code>, containing an additional <code>REFERENCE</code> column specifying which level of <code>variable</code> was used as the reference category. In unconstrained conjoint designs, only AMCEs for <code>variable</code> will vary by reference category; in constrained designs, AMCEs for any factor constrained by <code>variable</code> may also vary.
</p>
<p>Users may desire to specify a <code>family</code> argument via <code>...</code>, which should be a “family” object such as <code>gaussian</code>. Sensible alternatives are <code>binomial</code> (for binary outcomes) and quasibinomial (for weighted survey data). See <code>family</code> for details. In such cases, effects are always reported on the link (not outcome) scale.
</p>


<h3>Value</h3>

<p>A data frame of class “cj_amce”
</p>


<h3>See Also</h3>

<p><code>amce_diffs</code> <code>mm</code> <code>plot.cj_amce</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("taxes")
# estimating AMCEs
amce(taxes, chose_plan ~ taxrate1 + taxrate2 + taxrate3 + 
     taxrate4 + taxrate5 + taxrate6 + taxrev, id = ~ ID)


data("immigration")
# estimating AMCEs with constraints
amce(immigration, ChosenImmigrant ~ Gender + ReasonForApplication * CountryOfOrigin,
     id = ~CaseID)

# estimating average component interaction effects (AMCEs of feature combinations)
immigration$language_entry &lt;- interaction(immigration$LanguageSkills, 
                                          immigration$PriorEntry, sep = "_")
amce(immigration,ChosenImmigrant ~ language_entry, id = ~CaseID)

# balance testing example
plot(amce(immigration[!is.na(immigration$ethnocentrism),],
     ethnocentrism ~ Gender + Education + LanguageSkills, id = ~ CaseID))

# reference category sensitivity
x &lt;- amce_by_reference(immigration, ChosenImmigrant ~ LanguageSkills + Education, 
       variable = ~ LanguageSkills, id = ~ CaseID)
# plot
plot(x)

</code></pre>


</div>