<div class="container">

<table style="width: 100%;"><tr>
<td>CrossGEEKron</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Run a GEE model for data from a crossover experiment with
repeated measures</h2>

<h3>Description</h3>

<p>Provides a GEE model for the data of a crossover design with S
sequences of T periods. There must be at least two observations of each
experimental unit in each period.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CrossGEEKron(
  response,
  period,
  treatment,
  id,
  time,
  carry,
  covar = NULL,
  data,
  family = gaussian(),
  correlation = "independence",
  formula = NULL,
  tol = 1e-04,
  niter = 100,
  Mv
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>
<p>A character string specifying the name of the
response variable of the crossover experimental design</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>period</code></td>
<td>
<p>A character string specifying the name of vector with the
observation period of the responses of  the crossover experimental design</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>treatment</code></td>
<td>
<p>A character string specifying the name of vector with the
treatment applied at each observation of the crossover experimental design</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>A  character string specifying the name of vector which identifies
the experimental units. The length of ‘id’
should be the same as the number of observations. Data are assumed to be sorted so
that observations on each cluster appear as contiguous rows in data. If data
is not sorted this way, the function will not identify the clusters correctly.
If data is not sorted this way, a warning will be issued.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>A character string specifying the name of the vector with the
measurement time within each period</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>carry</code></td>
<td>
<p>A vector of  character string specifying the name set of dummy
variables that indicates the treatment applied
in the previous period of each experimental unit. They must be 0 in period 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covar</code></td>
<td>
<p>A vector of  character string specifying the name of possible
covariates of the crossover experimental design</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame with all the variables of the crossover experimental design</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>See corresponding documentation to <code>glm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correlation</code></td>
<td>
<p>a character string specifying the correlation structure.
The following are permitted: "independence", "fixed", "stat_M_dep",
"non_stat_M_dep", "exchangeable", "AR-M" and "unstructured"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A formula related the response variable with the explanatory
variables. If it is <code>NULL</code> the formula,
<code>response~period+treatment+carry+time+covar</code> will be evaluated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>the tolerance used in the fitting algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niter</code></td>
<td>
<p>the maximum number of iterations.
<code>response~period+treatment+carry+time+covar</code> will be evaluated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Mv</code></td>
<td>
<p>When correlation is "stat_M_dep", "non_stat_M_dep", or "AR-M"
then Mv must be specified.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>QIC</code> The QIC of the model: The model are fitted by <code>geeglm</code>
</p>
<p><code>model</code> The model fitted by <code>geeglm</code>.
</p>
<p><code>Within</code> The estimated correlation matrix within the period
with the structure determined by <code>correlation</code>.
</p>
<p><code>Between</code> The estimated correlation matrix between periods
</p>


<h3>Source</h3>

<p>https://doi.org/10.1007/s00362-022-01391-z
</p>


<h3>References</h3>

<p>Cruz, N.A., Melo, O.O. &amp; Martinez, C.A.
A correlation structure for the analysis of Gaussian and non-Gaussian
responses in crossover experimental designs with repeated measures.
Statistical Papers 65, 263–290 (2024)
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(Arterial)

carrydata &lt;- createCarry(data=Arterial, treatment = "Treatment",
 period = "Period",id="Subject")

data &lt;- carrydata$data
carry &lt;- carrydata$carryover
model &lt;- CrossGEEKron(response = "Pressure", treatment = "Treatment",
period = "Period", id="Subject", time="Time",
 carry=c("Carry_B","Carry_C"),data=data, correlation = "AR-M", Mv=1)

model$QIC
model$Within
model$Between
summary(model$model)

## Aproximate p-values for model
(pvalues &lt;- 2 * pnorm(abs(coef(summary(model$model))[,5]), lower.tail = FALSE))

model2 &lt;- CrossGEEKron(response = "Pressure", treatment = "Treatment",
 period = "Period", id="Subject", time="Time",
 carry=c("Carry_B","Carry_C"), data=data,
 correlation = "AR-M", Mv=1,formula=Pressure ~ Treatment+
 Period+ Carry_B+Carry_C)

model2$QIC
model2$Within
model2$Between
summary(model2$model)


</code></pre>


</div>