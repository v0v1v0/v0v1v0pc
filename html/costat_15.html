<div class="container">

<table style="width: 100%;"><tr>
<td>localvar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute the time-localized (unconditional) variance for a time series</h2>

<h3>Description</h3>

<p>Compute the time localized variance from an evolutionary
wavelet spectrum of a time series</p>


<h3>Usage</h3>

<pre><code class="language-R">localvar(spec)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>spec</code></td>
<td>
<p>An evolutionary wavelet spectrum, such as that computed
by <code>ewspec</code> in WaveThresh.</p>
</td>
</tr></table>
<h3>Details</h3>

<p>One can compute the local variance of a time series by first
computing its evolutionary wavelet spectrum, e.g., by using
<code>ewspec</code>, and then applying <code>localvar</code> on the
<code>S</code> component of that returned by <code>ewspec</code>.
</p>


<h3>Value</h3>

<p>A vector representing the local variance estimate at successive
times.
</p>


<h3>Author(s)</h3>

<p>Guy Nason</p>


<h3>References</h3>

<p>Cardinali, A. and Nason, Guy P. (2013) Costationarity of
Locally Stationary Time Series Using costat.
<em>Journal of Statistical Software</em>, <b>55</b>, Issue 1.
</p>
<p>Cardinali, A. and Nason, G.P. (2010) Costationarity of locally stationary
time series. <em>J. Time Series Econometrics</em>, <b>2</b>, Issue 2, Article 1.
</p>


<h3>See Also</h3>

<p><code>ewspec</code></p>


<h3>Examples</h3>

<pre><code class="language-R">#
# Let's look at a iid standard normal sequence, variance should be 1, always
# for all times.
#
zsim &lt;- rnorm(64)
#
# Note, in the following I use var as the method of deviance estimation,
# as described in the help there it can be more accurate when transformations
# are not used.
#
z.ews &lt;- ewspec(zsim, smooth.dev=var)$S
#
# Compute the local variance
#
z.lv &lt;- localvar(z.ews)
#
# Plot the local variance against time
#
## Not run: ts.plot(z.lv)
#
# Should be around 1. Note, the vertical scale of the plot might be
# deceptive, as R plots expand the function to the maximum available
# space. If you look again it should be quite close to 1 (e.g. on the
# example I am looking at now the variance is within +/- 0.15 of 1.
#
# However, it might not be close to 1 because the sample size is quite small,
# only 64, so repeat the above analysis with a larger sample size, e.g. 1024.
#
</code></pre>


</div>