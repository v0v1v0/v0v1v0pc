<div class="container">

<table style="width: 100%;"><tr>
<td>imhof</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Imhof method.</h2>

<h3>Description</h3>

<p>Distribution function (survival function in fact) of quadratic forms in normal variables using Imhof's method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">imhof(q, lambda, h = rep(1, length(lambda)),
      delta = rep(0, length(lambda)),
      epsabs = 10^(-6), epsrel = 10^(-6), limit = 10000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>value point at which the survival function is to be evaluated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>distinct non-zero characteristic roots of <code class="reqn">A\Sigma</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>respective orders of multiplicity of the <code class="reqn">\lambda</code>s</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>non-centrality parameters (should be positive)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsabs</code></td>
<td>
<p>absolute accuracy requested</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsrel</code></td>
<td>
<p>relative accuracy requested</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>limit</code></td>
<td>
<p>determines the maximum number of subintervals in the partition of the given integration interval</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Let <code class="reqn">\boldsymbol{X}=(X_1,\ldots,X_n)'</code> be a column random vector which follows a multidimensional normal law with mean vector <code class="reqn">\boldsymbol{0}</code> and non-singular covariance matrix <code class="reqn">\boldsymbol{\Sigma}</code>. 
Let <code class="reqn">\boldsymbol{\mu}=(\mu_1,\ldots,\mu_n)'</code> be a constant vector, and consider the quadratic form
</p>
<p style="text-align: center;"><code class="reqn">Q=(\boldsymbol{x}+\boldsymbol{\mu})'\boldsymbol{A}(\boldsymbol{x}+\boldsymbol{\mu})=\sum_{r=1}^m\lambda_r\chi^2_{h_r;\delta_r}.</code>
</p>

<p>The function <code>imhof</code> computes <code class="reqn">P[Q&gt;q]</code>.
</p>
<p>The <code class="reqn">\lambda_r</code>'s are the distinct non-zero characteristic roots of
<code class="reqn">A\Sigma</code>, the <code class="reqn">h_r</code>'s their respective orders of
multiplicity, the <code class="reqn">\delta_r</code>'s  are certain linear combinations
of <code class="reqn">\mu_1,\ldots,\mu_n</code> and the
<code class="reqn">\chi^2_{h_r;\delta_r}</code> are independent
<code class="reqn">\chi^2</code>-variables with <code class="reqn">h_r</code> degrees of freedom and
non-centrality parameter <code class="reqn">\delta_r</code>. The variable
<code class="reqn">\chi^2_{h,\delta}</code> is defined here by the
relation <code class="reqn">\chi^2_{h,\delta}=(X_1 +
  \delta)^2+\sum_{i=2}^hX_i^2</code>, where <code class="reqn">X_1,\ldots,X_h</code> are
independent unit normal deviates.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Qq</code></td>
<td>
<p><code class="reqn">P[Q&gt;q]</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abserr</code></td>
<td>
<p>estimate of the modulus of the absolute error, which
should equal or exceed abs(i - result)</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Pierre Lafaye de Micheaux (<a href="mailto:lafaye@dms.umontreal.ca">lafaye@dms.umontreal.ca</a>) and
Pierre Duchesne (<a href="mailto:duchesne@dms.umontreal.ca">duchesne@dms.umontreal.ca</a>)</p>


<h3>References</h3>

<p>P. Duchesne, P. Lafaye de Micheaux, Computing the distribution of quadratic forms: Further comparisons between the Liu-Tang-Zhang approximation and exact methods, <em>Computational Statistics and Data Analysis</em>, Volume 54, (2010), 858-862
</p>
<p>J. P. Imhof, Computing the Distribution of Quadratic Forms in Normal Variables, <em>Biometrika</em>, Volume 48, Issue 3/4 (Dec., 1961), 419-426</p>


<h3>Examples</h3>

<pre><code class="language-R"># Some results from Table 1, p.424, Imhof (1961)

# Q1 with x = 2
round(imhof(2, c(0.6, 0.3, 0.1))$Qq, 4)

# Q2 with x = 6
round(imhof(6, c(0.6, 0.3, 0.1), c(2, 2, 2))$Qq, 4)

# Q6 with x = 15
round(imhof(15, c(0.7, 0.3), c(1, 1), c(6, 2))$Qq, 4)

</code></pre>


</div>