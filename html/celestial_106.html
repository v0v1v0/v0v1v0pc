<div class="container">

<table style="width: 100%;"><tr>
<td>skyproj</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Tan Gnomonic and Sine Orthographic Projection System WCS Solver Functions
</h2>

<h3>Description</h3>

<p>Converts RA/Dec (degrees) to x/y (pixels) position using the Tan Gnomonic or Sine Orthographic projection systems, and vice-versa.
Translations adapted from: http://mathworld.wolfram.com/GnomonicProjection.html and http://mathworld.wolfram.com/OrthographicProjection.html.
</p>


<h3>Usage</h3>

<pre><code class="language-R">radec2xy(RA, Dec, header, CRVAL1 = 0, CRVAL2 = 0, CRPIX1 = 0, CRPIX2 = 0, CD1_1 = 1,
CD1_2 = 0, CD2_1 = 0, CD2_2 = 1, CTYPE1 = 'RA--TAN', CTYPE2 = 'DEC--TAN')
xy2radec(x, y, header, CRVAL1 = 0, CRVAL2 = 0, CRPIX1 = 0, CRPIX2 = 0, CD1_1 = 1,
CD1_2 = 0, CD2_1 = 0, CD2_2 = 1, CTYPE1 = 'RA--TAN', CTYPE2 = 'DEC--TAN')
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>RA</code></td>
<td>

<p>Vector or matrix; target right ascension in degrees. If matrix then the first column will be used as RA and the second column as Dec.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Dec</code></td>
<td>

<p>Vector; target declination in degrees. Ignored if <span class="option">RA</span> is a matrix.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>Vector or matrix; target x-pixel. If Matrix then the first column will be used as the x-axis and the second column as y-axis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>Vector; target y-pixel. Ignored if <span class="option">x</span> is a matrix.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CRVAL1</code></td>
<td>

<p>FITS header CRVAL1 for the <span class="option">CTYPE1</span> projection system. This is the RA in degrees at the location of <span class="option">CRPIX1</span>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CRVAL2</code></td>
<td>

<p>FITS header CRVAL2 for the <span class="option">CTYPE2</span> projection system. This is the Dec in degrees at the location of <span class="option">CRPIX2</span>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CRPIX1</code></td>
<td>

<p>FITS header CRPIX1 for the <span class="option">CTYPE1</span> projection system. This is the x pixel value at the location of <span class="option">CRVAL1</span>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CRPIX2</code></td>
<td>

<p>FITS header CRPIX2 for the <span class="option">CTYPE2</span> projection system. This is the y pixel value at the location of <span class="option">CRVAL2</span>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CD1_1</code></td>
<td>

<p>FITS header CD1_1 for the <span class="option">CTYPE1</span> projection system. Change in <span class="option">CTYPE1</span> in degrees along x-Axis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CD1_2</code></td>
<td>

<p>FITS header CD1_2 for the <span class="option">CTYPE1</span> projection system. Change in <span class="option">CTYPE1</span> in degrees along y-Axis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CD2_1</code></td>
<td>

<p>FITS header CD2_1 for the <span class="option">CTYPE2</span> projection system. Change in <span class="option">CTYPE2</span> in degrees along x-Axis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CD2_2</code></td>
<td>

<p>FITS header CD2_2 for the <span class="option">CTYPE2</span> projection system. Change in <span class="option">CTYPE2</span> in degrees along y-Axis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CTYPE1</code></td>
<td>

<p>The RA projection system type. Either 'RA–TAN' for Tan Gnomonic (default), or 'RA–SIN' for Sine Orthographic. 'RA–NCP' is approximated by Sine Orthographic with a warning. Over-ridden by the FITS header.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CTYPE2</code></td>
<td>

<p>The DEC projection system type. Either 'DEC–TAN' for Tan Gnomonic (default), or 'DEC–SIN' for Sine Orthographic. 'DEC–NCP' is approximated by Sine Orthographic with a warning. Over-ridden by the FITS header.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>header</code></td>
<td>

<p>Full FITS header in table or vector format. Legal table format headers are provided by the <code>read.fitshdr</code> function or the <span class="option">hdr</span> list output of <code>read.fits</code> in the <code>astro</code> package). Also the <span class="option">hdr</span> output of <code>readFITS</code> in the <code>FITSio</code> package provides legal vector format inputs. If a header is provided then key words will be taken from here as a priority. Missing header keywords are printed out and other header option arguments are used in these cases.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>These functions encode the standard FITS Tan Gnomonic and Sine Orthographic projection systems for solving an image WCS (covering most moden imaging and radio data). They do not deal with higher order polynomial distortion terms.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>radec2xy</code></td>
<td>

<p>Returns a two column matrix with columns x and y.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xy2radec</code></td>
<td>

<p>Returns a two column matrix with columns RA and Dec (in degrees).
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Aaron Robotham
</p>


<h3>References</h3>

<p>http://mathworld.wolfram.com/GnomonicProjection.html
http://mathworld.wolfram.com/OrthographicProjection.html
</p>


<h3>See Also</h3>

<p><code>deg2dms</code>, <code>deg2hms</code>, <code>dms2deg</code>, <code>hms2deg</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#A simple example:

radec2xy(10, 20)
xy2radec(radec2xy(10, 20))
xy2radec(radec2xy(10, 20, CTYPE1='RA--SIN', CTYPE2='DEC--SIN'),
CTYPE1='RA--SIN',CTYPE2='DEC--SIN')

#A more complicated example, where we transform and rotate large amounts:

exdata_start=expand.grid(1:10,21:30)
plot(exdata_start)
exradec=radec2xy(exdata_start, CRVAL1=20, CRPIX1=100, CRVAL2=30, CRPIX2=130, CD1_1=0.1,
CD1_2=-0.05, CD2_1=0.05, CD2_2=0.1)
plot(exradec)
exdata_end=xy2radec(exradec, CRVAL1=20, CRPIX1=100, CRVAL2=30, CRPIX2=130, CD1_1=0.1,
CD1_2=-0.05, CD2_1=0.05, CD2_2=0.1)
plot(exdata_start,cex=2)
points(exdata_end,col='red')

#The residuals should be very small (in the noice of double precision arithmetic):

plot(density(exdata_start[,1]-exdata_end[,1]))
lines(density(exdata_start[,2]-exdata_end[,2]),col='red')
</code></pre>


</div>