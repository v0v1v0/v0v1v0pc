<div class="container">

<table style="width: 100%;"><tr>
<td>page.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Page test for monotonicity of ranks.</h2>

<h3>Description</h3>

<p>Given <code>N</code> replications of <code>k</code> different treatments/conditions,
tests whether the <em>median ordinal ranks</em> <code class="reqn">m_i</code> of the treatments
are identical </p>
<p style="text-align: center;"><code class="reqn">m_1 = m_2 = \ldots = m_k</code>
</p>
<p> against the alternative
hypothesis </p>
<p style="text-align: center;"><code class="reqn">m_1 \leq m_2 \leq \ldots \leq m_k</code>
</p>
<p> where <em>at least
one</em> of the inequalities is a strict inequality (Siegel and Castellan
1988, p.184). Given that even a single point change in the distribution of
ranks across conditions represents evidence against the null hypothesis,
the Page test is simply a test for <em>some ordered differences in
ranks</em>, but not a 'trend test' in any meaningful way (see also the
<a href="https://kevinstadler.github.io/cultevo/articles/page.test.html">Page test tutorial</a>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">page.test(data, verbose = TRUE)

page.L(data, verbose = TRUE, ties.method = "average")

page.compute.exact(k, N, L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a matrix with the different conditions along its <code>k</code>
columns and the <code>N</code> replications along rows. Conversion of the data
to ordinal ranks is taken care of internally.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>whether to print the final rankings based on which the L
statistic is computed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ties.method</code></td>
<td>
<p>how to resolve tied ranks. Passed on to
<code>rank</code>, should be left on "average" (the default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>number of conditions/generations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>number of replications/chains</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>value of the Page L statistic</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Tests the given matrix for monotonically <em>increasing</em> ranks across <code>k</code>
linearly ordered conditions (along columns) based on <code>N</code> replications
(along rows). To test for monotonically <em>decreasing</em> ranks, either reverse
the order of columns, or simply invert the rank ordering by calling <code>-</code> on
the entire dataset.
</p>
<p>Exact p-values are computed for <code>k</code> up to 22, using the pre-computed null
distributions from the
<a href="https://CRAN.R-project.org/package=pspearman">pspearman</a> package. For
larger <code>k</code>, p-values are computed based on a Normal distribution
approximation (Siegel and Castellan, 1988).
</p>


<h3>Value</h3>

<p><code>page.test</code> returns a list of class <code>pagetest</code> (and
<code>htest</code>) containing the following elements:
</p>

<dl>
<dt><code>statistic</code></dt>
<dd>
<p>value of the L statistic for the data set</p>
</dd>
<dt><code>parameter</code></dt>
<dd>
<p>a named vector specifying the number of
conditions (k) and replications (N) of the data (which is the number of
columns and rows of the data set, respectively)</p>
</dd>
<dt><code>p.value</code></dt>
<dd>
<p>significance level</p>
</dd>
<dt><code>p.type</code></dt>
<dd>
<p>whether the computed p-value is <code>"exact"</code> or
<code>"approximate"</code></p>
</dd>
</dl>
<h3>Functions</h3>


<ul>
<li> <p><code>page.test</code>: See above.
</p>
</li>
<li> <p><code>page.L</code>: Calculate Page's L statistic for the given dataset.
</p>
</li>
<li> <p><code>page.compute.exact</code>: Calculate exact significance levels of the Page L
statistic. Returns a single numeric indicating the null probability of
the Page statistic with the given <code>k</code>, <code>N</code> being greater or equal than the
given <code>L</code>.
</p>
</li>
</ul>
<h3>References</h3>

<p>Siegel, S., and N. J. Castellan, Jr. (1988). Nonparametric
Statistics for the Behavioral Sciences. McGraw-Hill.
</p>


<h3>See Also</h3>

<p><code>rank</code>, <a href="https://kevinstadler.github.io/cultevo/articles/page.test.html">Page test tutorial</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># exact p value computation for N=4, k=4
page.test(t(replicate(4, sample(4))))

# exact p value computation for N=4, k=10
page.test(t(replicate(4, sample(10))))

# approximate p value computation for N=4, k=23
result &lt;- page.test(t(replicate(4, sample(23))), verbose = FALSE)

print(result)

# raw calculation of the significance levels
page.compute.exact(6, 4, 322)
</code></pre>


</div>