<div class="container">

<table style="width: 100%;"><tr>
<td>ctbi.long.term</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>ctbi.long.term</h2>

<h3>Description</h3>

<p>Calculate the long-term trend with a linear interpolation between the mean (or median) of bins defined between two consecutive centers. Bins defined between two consecutive sides are calculated as well to complete for missing values if they have neighbors. Bins without sufficient data are discarded.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ctbi.long.term(data0, n.bin.min, seq.bin.side, outliers.checked)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data0</code></td>
<td>
<p>data.table with the columns x (time series), y (values), side.index (index associated with each bin defined between two consecutive centers) and index.bin (index associated with each bin defined between two consecutive sides)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.bin.min</code></td>
<td>
<p>minimum number of points for a bin to be accepted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seq.bin.side</code></td>
<td>
<p>sequence of the sides of the bins</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outliers.checked</code></td>
<td>
<p>boolean to indicate if the median (outliers.checked = FALSE) or the mean (outliers.checked = TRUE) should be used to calculate the long-term trend</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>data0 with the long-term trend added (column long.term)
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(data.table)
x &lt;- seq(from=as.Date('2001-01-01'),to=as.Date('2010-12-01'),by='1 month')
y &lt;- 3*cos(2*pi*(0:(length(x)-1))/12)+runif(length(x))
outliers.checked &lt;- TRUE
seq.bin.side &lt;- seq(from=as.Date('2001-01-01'),to=as.Date('2011-01-01'),by='1 year')
seq.bin.center &lt;- seq(from=as.Date('2001-06-01'),to=as.Date('2010-06-01'),by='1 year')
index.bin &lt;- findInterval(x,seq.bin.side)
side.index &lt;- findInterval(x,seq.bin.center)+0.5
n.bin.min &lt;- 10 # minimum of 10 months of data for a bin to be accepted
data0 &lt;- data.table(x=x,y=y,index.bin=index.bin,side.index=side.index)
data0.with.long.term &lt;- ctbi.long.term(data0,n.bin.min,seq.bin.side,outliers.checked)
</code></pre>


</div>