<div class="container">

<table style="width: 100%;"><tr>
<td>carscore</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate CAR Scores and Marginal Correlations</h2>

<h3>Description</h3>

<p><code>carscore</code> estimates the vector of CAR scores, either using the standard
empirical estimator of the correlation matrix, or a shrinkage estimator.
</p>


<h3>Usage</h3>

<pre><code class="language-R">carscore(Xtrain, Ytrain, lambda, diagonal=FALSE, verbose=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Xtrain</code></td>
<td>
<p>Matrix of predictors (columns correspond to variables).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ytrain</code></td>
<td>
<p>Univariate response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>The correlation shrinkage intensity (range 0-1).  
If not specified (the default) it is estimated using an
analytic formula from Sch\"afer and Strimmer (2005).  For <code>lambda=0</code>
the empirical correlations are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diagonal</code></td>
<td>
<p>For <code>diagonal=FALSE</code> (the default) CAR scores are computed;
otherwise with <code>diagonal=TRUE</code> marginal correlations.   
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>If <code>verbose=TRUE</code> then the shrinkage intensity 
used in estimating the shrinkage correlation matrix is reported.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The CAR scores are the correlations between the response and the 
Mahalanobis-decorrelated predictors.  CAR score is an abbreviation
for Correlation-Adjusted (marginal) coRelation, where the first 
correlation matrix refers dependencies among predictors.
</p>
<p>In Zuber and Strimmer (2011) it
is argued that squared CAR scores are a natural measure for variable 
importance and it is shown that variable selection based on CAR scores
is highly efficient compared to competing approaches such as elastic net
lasso, or boosting. 
</p>
<p>If the response is binary (or descrete) the corresponding quantity
are CAT scores (see <code>catscore</code>).
</p>


<h3>Value</h3>

<p><code>carscore</code> returns
a vector containing the CAR scores (or marginal correlations for <code>diagonal=TRUE</code>).
</p>


<h3>Author(s)</h3>

<p>Verena Zuber and Korbinian Strimmer (<a href="https://strimmerlab.github.io">https://strimmerlab.github.io</a>).
</p>


<h3>References</h3>

<p>Zuber, V., and K. Strimmer. 2011.  High-dimensional regression and 
variable selection using CAR scores.  Statist. Appl. Genet. Mol. Biol. 10: 34.
&lt;DOI:10.2202/1544-6115.1730&gt;
</p>


<h3>See Also</h3>

<p><code>catscore</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R"># load care library
library("care")

######

# empirical CAR scores for diabetes data
data(efron2004)
xnames = colnames(efron2004$x)
n = dim(efron2004$x)[1]

car = carscore(efron2004$x, efron2004$y, lambda=0)
car

# compare orderings

# variables ordered by squared CAR scores
xnames[order(car^2, decreasing=TRUE)]
# "bmi" "s5"  "bp"  "s3"  "s4"  "s6"  "sex" "age" "s2"  "s1" 

# compare with ordering by t-scores / partial correlations 
pcor = pcor.shrink(cbind(efron2004$y,efron2004$x), lambda=0, verbose=FALSE)[-1,1]
xnames[order(pcor^2, decreasing=TRUE)]
# "bmi" "bp"  "s5"  "sex" "s1"  "s2"  "s4"  "s6"  "s3"  "age"

# compare with ordering by marginal correlations 
mcor = cor(efron2004$y,efron2004$x)
#mcor = carscore(efron2004$x, efron2004$y, diagonal=TRUE, lambda=0)
xnames[order(mcor^2, decreasing=TRUE)]
# "bmi" "s5"  "bp"  "s4"  "s3"  "s6"  "s1"  "age" "s2"  "sex"

# decomposition of R^2
sum(car^2)
slm(efron2004$x, efron2004$y, lambda=0, lambda.var=0)$R2

# pvalues for empirical CAR scores
pval = 1-pbeta(car^2, shape1=1/2, shape2=(n-2)/2)
pval &lt;= 0.05

######

# shrinkage CAR scores for Lu et al. (2004) data
data(lu2004)
dim(lu2004$x)    # 30 403

# compute shrinkage car scores
car = carscore(lu2004$x, lu2004$y)

# most important genes
order(car^2, decreasing=TRUE)[1:10]

# compare with empirical marginal correlations
mcor = cor(lu2004$y, lu2004$x)
order(mcor^2, decreasing=TRUE)[1:10]

# decomposition of R^2
sum(car^2) 
slm(lu2004$x, lu2004$y)$R2

</code></pre>


</div>