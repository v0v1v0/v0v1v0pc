<div class="container">

<table style="width: 100%;"><tr>
<td>g</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Defining terms in CGAIM formula</h2>

<h3>Description</h3>

<p>Functions used to define terms within a <code>cgaim</code> formula. <code>g</code> 
defines an index with ridge function and <code>s</code> a smooth covariate.
</p>


<h3>Usage</h3>

<pre><code class="language-R">g(..., label = NULL, acons = list(), Cmat = NULL, bvec = 0,
  fcons = NULL, s_opts = list())

s(x, fcons = NULL, s_opts = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Variables entering the index. May include vectors and 
matrices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label</code></td>
<td>
<p>Character (or any object that can coerced into one) labeling the index. By default, named after the first variable in <code>...</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>acons</code></td>
<td>
<p>A list of character naming common constraints to be applied to 
the index weights <code>alpha</code>. See <code>build_constraints</code> for 
allowed constraints.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Cmat</code></td>
<td>
<p>A constraint matrix for alpha coefficients. Number of
columns must match the number of variables in the index.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bvec</code></td>
<td>
<p>Numeric vector of constraint bounds. Recycled if necessary.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fcons</code></td>
<td>
<p>The type of shape constraint to be applied on the smooth 
function. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s_opts</code></td>
<td>
<p>A named list of options to be passed to the smoothing of 
ridge functions. Depends on the method used to smooth additive models. 
See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Covariate on which the smooth is applied.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>These functions define nonlinear terms in the formula, with <code>g</code> defining
an index created from a collection of terms passed through the <code>...</code>
argument while <code>s</code> is applied to a single variable, similarly to 
<code>s</code> in <code>mgcv</code>. 
</p>
<p>For indices, <code>g</code> allows the definition of constraints applied to
the index only. This is a convenient alternative to passing the whole
constraint matrix <code>Cmat</code> in <code>cgaim</code>. Constraints can be
defined by a prespecified matrix through the argument <code>Cmat</code> or
through the argument <code>acons</code> for common constraints (see 
<code>build_constraints</code>). Note that any provided <code>Cmat</code> must
match the total number of variables in <code>...</code>, including potential
matrix expansion and factors. Both <code>Cmat</code> and <code>acons</code> can be
passed to the function, which will bind them internally.
</p>
<p>Both <code>g</code> and <code>s</code> allow the definition of shape constraints for the
smooth. Eight shape-constraints are currently available: 
monotone increasing (<code>fcons = "inc"</code>), 
monotone decreasing (<code>fcons = "dec"</code>), 
convex (<code>fcons = "cvx"</code>), 
concave (<code>fcons = "ccv"</code>), 
increasing and convex(<code>fcons = "inccvx"</code>), 
decreasing and convex (<code>fcons = "deccvx"</code>), 
increasing and concave (<code>fcons = "incccv"</code>), 
decreasing and concave (<code>fcons = "decccv"</code>). 
</p>
<p>Smoothing can be controlled by the <code>s_opts</code> parameter. It is a list of
argument depends on the method used for smoothing. See <code>s</code> 
for <code>smooth_method = "scam"</code>. For <code>smooth_method = "cgam"</code>, 
the parameters allowed may vary according to the shape-constraint chosen. 
The full list can be found in <code>cgam</code>, but only the 
constraints beginning with <code>s.</code> are allowed for now. 
No parameter are necessary when <code>smooth_method = "scar"</code> 
(see <code>scar</code>).
</p>


<h3>Value</h3>

<p>A matrix containing the variables passed in <code>...</code> with 
additional attributes:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>fcons</code></td>
<td>
<p>The shape constraint for smoothing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s_opts</code></td>
<td>
<p>Arguments passed to the smoothing function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label</code></td>
<td>
<p>The label of the term.</p>
</td>
</tr>
</table>
<p>The following attributes result from a call to <code>g</code> only:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>term</code></td>
<td>
<p>The terms in the index.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nterms</code></td>
<td>
<p>The number of variables in the index.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Cmat</code></td>
<td>
<p>The constraint matrix for alpha coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bvec</code></td>
<td>
<p>The associated boundary vector.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>cgaim</code> for fitting the CGAIM, 
<code>build_constraints</code> for built-in constraint matrices.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Simulate some data
n &lt;- 200
x1 &lt;- rnorm(n)
x2 &lt;- rnorm(n)
x3 &lt;- rnorm(n)
x4 &lt;- rnorm(n)
mu &lt;- 4 * exp(8 * x1) / (1 + exp(8 * x1)) + exp(x3)
y &lt;- mu + rnorm(n)
df1 &lt;- data.frame(y, x1, x2, x3, x4)

## Fit an unconstrained the model
ans &lt;- cgaim(y ~ g(x1, x2) + g(x3, x4), data = df1)

## Fit constrained model
ans2 &lt;- cgaim(y ~ g(x1, x2, acons = list(monotone = -1)) + 
  g(x3, x4, fcons = "cvx"), data = df1)
  
## Pass constraint matrices instead
ans3 &lt;- cgaim(y ~ g(x1, x2, Cmat = -diff(diag(2))) + 
  g(x3, x4, fcons = "cvx"), data = df1)
  
## Label indices   
ans4 &lt;- cgaim(y ~ g(x1, x2, label = "foo") + g(x3, x4, label = "bar"), 
  data = df1)
  
</code></pre>


</div>