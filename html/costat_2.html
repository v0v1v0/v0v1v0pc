<div class="container">

<table style="width: 100%;"><tr>
<td>AntiAR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Undo autoreflection action for an EWS object (wd stationary)
</h2>

<h3>Description</h3>

<p>The <code>BootTOS</code> function has the ability to
deal with boundary conditions by augmenting the right-hand end of a time
series by a reflected version of that series. So, the series doubles
in length and the new vector has periodic boundary conditions. One
can then compute a local spectrum on this data which returns an EWS
in a <code>wd</code> object, usually with a type attribute of "station".
This function can take this <code>wd</code> object and properly can return
the first half of it, which corresponds to the boundary-correct spectrum
of the original series.
</p>


<h3>Usage</h3>

<pre><code class="language-R">AntiAR(S)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>A <code>wd</code> class object of type "station". This corresponds
to a EWS estimate on a reflected time series.
</p>
</td>
</tr></table>
<h3>Details</h3>

<p>This function arises because using spectral estimation functions,
like <code>ewspec</code> from the <code>wavethresh</code> package doesn't
always work that well at the boundaries. This is because
the wavelet functions in <code>wavethresh</code> usually assume
periodic boundary conditions and this is not appropriate for
a discrete time series where time 1 and time T are usually
very different (and cannot be assumed to be the same).
</p>
<p>Hence, a previous function could generate a new time series by taking the
original, e.g. <code>x</code>, reflecting it with <code>rev(x)</code> and then
sticking the reflected onto the right-hand end of the original. 
Spectral estimation, (e.g. using <code>ewspec</code>) can then be applied
to this new reflected/augmented series and the boundaries are now
roughly correct as the start and end of the series correspond to time 1.
</p>
<p>The spectral estimate so obtained though is double the size of the
the one that is needed, and contains the spectrum of the reflected series.
Hence, this function obtains the first half of the estimate and returns
it.
</p>
<p>Not usually intended for the casual user
</p>


<h3>Value</h3>

<p>A <code>wd</code> class object containing the boundary-corrected
estimate of the spectrum for the original series.
</p>


<h3>Author(s)</h3>

<p>G. P. Nason.
</p>


<h3>References</h3>

<p>Cardinali, A. and Nason, Guy P. (2013) Costationarity of
Locally Stationary Time Series Using costat.
<em>Journal of Statistical Software</em>, <b>55</b>, Issue 1.
</p>
<p>Cardinali, A. and Nason, G.P. (2010) Costationarity of locally stationary
time series. <em>J. Time Series Econometrics</em>, <b>2</b>, Issue 2, Article 1.
</p>


<h3>See Also</h3>

<p><code>BootTOS</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#
# Generate example, temporary series
#
x &lt;- rnorm(128)	
#
# Reflect it about its end point
#
x2 &lt;- c(x, rev(x))
#
# Compute EWS estimate
#
x2ews &lt;- ewspec(x2)
#
# Now get bit corresponding to x into object
#
xews &lt;- AntiAR(x2ews$S)
</code></pre>


</div>