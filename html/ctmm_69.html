<div class="container">

<table style="width: 100%;"><tr>
<td>occurrence</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate a Kriged occurrence distribution estimate</h2>

<h3>Description</h3>

<p>This function calculates an occurrence distribution from <code>telemetry</code> data and a continuous-time movement model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">occurrence(data,CTMM,R=list(),SP=NULL,SP.in=TRUE,H=0,variable="utilization",res.time=10,
           res.space=10,grid=NULL,cor.min=0.05,dt.max=NULL,buffer=TRUE,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p> A <code>telemetry</code> object or list of <code>telemetry</code> objects. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CTMM</code></td>
<td>
<p>A <code>ctmm</code> movement model, as from the output of <code>ctmm.select</code>, or a list of <code>ctmm</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>A named list of raster covariates if <code>CTMM</code> contains an RSF model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SP</code></td>
<td>
<p>SpatialPolygonsDataFrame object for enforcing hard boundaries.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SP.in</code></td>
<td>
<p>Locations are assumed to be inside the <code>SP</code> polygons if <code>SP.in=TRUE</code> and outside of <code>SP</code> if <code>SP.in=FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>
<p>Optional additional bandwidth matrix for future use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variable</code></td>
<td>
<p>Either <code>"utilization"</code> or <code>"revisitation"</code>. Only utilization is accurately estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res.time</code></td>
<td>
<p>Number of temporal grid points per median timestep.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res.space</code></td>
<td>
<p>Number of grid points along each axis, relative to the average diffusion (per median timestep) from a stationary point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>Optional grid specification via <code>raster</code>, <code>UD</code>, or list of arguments (See <code>akde</code> for details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cor.min</code></td>
<td>
<p>Velocity correlation threshold for skipping gaps.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dt.max</code></td>
<td>
<p>Maximum absolute gap size (in seconds) for Kriging interpolation. If left <code>NULL</code>, the median of <code>diff(data$t)</code> will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>buffer</code></td>
<td>
<p>Buffer the observation period, according to the minimum gap specified by <code>cor.min</code> and <code>dt.max</code>, to include more probable locations if possible.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Not used.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The arguments <code>cor.min</code> or <code>dt.max</code> are used to prevent the interpolation of large gaps, which would bias the estimate to more resemble the movement model than the data. Because <code>cor.min</code> can produce an empty range with fractal movement models, the larger of the two rules is employed for interpolation.
</p>
<p>If <code>buffer=TRUE</code>, then the data are also extrapolated according to the minimum of the two rules (<code>cor.min</code> and <code>dt.max</code>) which is limited to cases where persistence of motion is modeled.
</p>


<h3>Value</h3>

<p>Returns a <code>UD</code> object containing the sampled grid line locations <code>x</code> and <code>y</code>, the probability density and cumulative distribution functions evaluated on the sampled grid locations <code>PDF</code> &amp; <code>CDF</code>, the optional bandwidth matrix <code>H</code>, and the area of each grid cell <code>dA</code>.
</p>


<h3>Note</h3>

<p>Large gaps have a tendency to slow down computation and blow up the estimate. This can be avoided with the <code>cor.min</code> or <code>dt.max</code> arguments.
</p>
<p>In the case of coarse grids, the value of <code>PDF</code> in a grid cell actually corresponds to the average probability density over the entire rectangular cell.
</p>
<p>Prior to <code>ctmm</code> v0.5.6, <code>cor.min</code> referred to the location correlation, with a default of 50%.
In <code>ctmm</code> v0.5.6 and above, <code>cor.min</code> refers to the velocity correlation, with a default of 5%.</p>


<h3>Author(s)</h3>

<p> C. H. Fleming. </p>


<h3>References</h3>

<p>C. H. Fleming, W. F. Fagan, T. Mueller, K. A. Olson, P. Leimgruber, J. M. Calabrese,
“Estimating where and how animals travel: An optimal framework for path reconstruction from autocorrelated tracking data”,
Ecology, 97:3, 576-582 (2016) <a href="https://doi.org/10.1890/15-1607.1">doi:10.1890/15-1607.1</a>.
</p>
<p>C. H. Fleming, D. Sheldon, E. Gurarie, W. F. Fagan, S. LaPoint, J. M. Calabrese,
“Kálmán filters for continuous-time movement models”,
Ecological Informatics, 40, 8-21 (2017) <a href="https://doi.org/10.1016/j.ecoinf.2017.04.008">doi:10.1016/j.ecoinf.2017.04.008</a>.
</p>


<h3>See Also</h3>

 <p><code>akde</code>, <code>raster,UD-method</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">
# Load package and data
library(ctmm)
data(buffalo)
Cilla &lt;- buffalo$Cilla

GUESS &lt;- ctmm.guess(Cilla,interactive=FALSE)
FIT &lt;- ctmm.fit(Cilla,GUESS)

# Compute occurence distribution
UD &lt;- occurrence(Cilla,FIT)

# Plot occurrence UD
plot(UD,col.level=NA)
</code></pre>


</div>