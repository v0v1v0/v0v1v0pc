<div class="container">

<table style="width: 100%;"><tr>
<td>RNLmodel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Receptor Noise Limited Models (Vorobyev &amp; Osorio 1998)
</h2>

<h3>Description</h3>

<p>Receptor noise limited colour vision models (Vorobyev &amp; Osorio 1998; Vorobyev et al. 1998) extended to any number of photoreceptor types.
</p>


<h3>Usage</h3>

<pre><code class="language-R">RNLmodel(model = c("linear", "log"), photo=ncol(C)-1,
         R1, R2=Rb, Rb, I, C,
         noise = FALSE, v=NA, n=NA, e=NA,
         interpolate = TRUE, nm = seq(300, 700, 1),
         coord="colourvision")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Linear (<code>"linear"</code>; Vorobyev &amp; Osorio, 1998), or log-linear  (<code>"log"</code>; Vorobyev et al. 1998) RNLmodel version. <code>model="log"</code> is preferred.
</p>
<p><code>model="linear"</code> can be used only if comparison is to be made between two very similar colours.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>photo</code></td>
<td>

<p>Number of photoreceptor types. Model accepts any number of photoreceptor types (<code>&gt;=2</code>). For instance, dichromatic: <code>photo=2</code>; trichromatic: <code>photo=3</code>; tetrachromatic: <code>photo=4</code>, etc. Default gets number of photoreceptor types from <code>C</code> argument.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R1</code></td>
<td>

<p>Reflectance of observed objects. A data frame with first column corresponding to wavelength values and following columns with reflectance values. <code>R1</code> must be in the same scale as <code>R2</code> and <code>Rb</code>(percentage or proportion).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R2</code></td>
<td>

<p>Reflectance to be compared against R1. <code>R2=Rb</code> if comparison is to be made against the background. A data frame with two columns only: first column corresponding to wavelength values and second column with reflectance values. <code>R2</code> must be in the same scale as <code>R1</code> and <code>Rb</code>(percentage or proportion).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rb</code></td>
<td>

<p>Background reflectance. A data frame with two columns only: first column corresponding to wavelength values and second column with reflectance values. <code>Rb</code> must be in the same scale as <code>R1</code> and <code>R2</code> (percentage or proportion).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>I</code></td>
<td>

<p>Irradiance spectrum. A data frame with two columns only: first column corresponding to wavelength values and second column with irradiance values. Irradiance values must be in quantum flux units.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>

<p>Photoreceptor sensitivity curves, from lowest to longest lambda-max. A data frame: first column corresponding to wavelength values and following columns with photoreceptor sensitivity values (see function <code>photor</code>). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noise</code></td>
<td>

<p>Logical. Whether receptor noise is provided (<code>noise = TRUE</code>) or calculated from photoreceptor relative abundances (<code>noise = FALSE</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>e</code></td>
<td>

<p>Receptor noise of each photoreceptor type. Used when <code>noise = TRUE</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>Relative number of each photoreceptor type in the retina. Usually increases with lambda-max. Used to calculate <code>e</code> when <code>noise = FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>

<p>Noise-to-signal ratio of a single photoreceptor. Used to calculate <code>e</code> when <code>noise = FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interpolate</code></td>
<td>

<p>Whether data files should be interpolated before further calculations. See <code>approx</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nm</code></td>
<td>

<p>A sequence of numeric values specifying where interpolation is to take place. See <code>approx</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coord</code></td>
<td>
<p>Whether colour locous coordinates should be calculated by the method (<code>coord="colourvision"</code>) by Gawryszewski (2018), or by alternative (<code>coord="alternative"</code>; available for 2-4 photoreceptor types only) methods (Hempel de Ibarra et al. 2001; Renoult et al. 2017).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The receptor noise limited model was originally developed to calculate <code class="reqn">\Delta S</code> between two reflectance curves directly, without finding colour locus coordinates (e.g. <code>x,y</code>; Vorobyev and Osorio 1998). This function uses later formulae to find colour loci in a chromaticity diagram (similarly to Hempel de Ibarra et al. 2001; Renoult et al. 2015).
</p>
<p>In lack of a direct measurement, receptor noise (<code class="reqn">e_i</code>) can be estimated by the relative abundance of photoreceptor types in the retina, and a measurement of a single photoreceptor noise-to-signal ratio:
</p>
<p style="text-align: center;"><code class="reqn">e_i=\frac{\nu}{\sqrt{\eta _i}}</code>
</p>

<p>where <code class="reqn">\nu</code> is the noise-to-signal ratio of a single photoreceptor, and <code class="reqn">\eta</code> is the relative abundance of photoreceptor i in the retina. Alternatively, noise may be dependent of the intensity, but this possibility is not implement in <code>colourvision</code> yet. Noise dependent of intensity usually holds for low light conditions only (Vorobyev et al. 1998). 
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ei</code></td>
<td>
<p>Noise of photoreceptor channels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Qri_R1</code></td>
<td>
<p>Photoreceptor photon catch values from <code>R1</code>, after the von Kries transformation (see function <code>Qr</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Qri_R2</code></td>
<td>
<p>Photoreceptor photon catch values from <code>R2</code>, after the von Kries transformation (see function <code>Qr</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ei_R1</code></td>
<td>
<p>Photoreceptor outputs from the stimulus (<code>R1</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ei_R2</code></td>
<td>
<p>Photoreceptor outputs from R2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xi_R1</code></td>
<td>
<p>Coordinates in the colour space for R1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xi_R2</code></td>
<td>
<p>Coordinates in the colour space for R2. Equals zero when <code>R1=Rb</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deltaS</code></td>
<td>
<p>Euclidean distance from R1 to R2. It represents the conspicuousness of the stimulus (<code>R1</code>) in relation to the background when <code>R1=Rb</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Felipe M. Gawryszewski <a href="mailto:f.gawry@gmail.com">f.gawry@gmail.com</a>
</p>


<h3>References</h3>

<p>Gawryszewski, F.M. 2018. Colour vision models: Some simulations, a general n-dimensional model, and the colourvision R package. Ecology and Evolution, 10.1002/ece3.4288.
</p>
<p>Hempel de Ibarra, N., M. Giurfa, and M. Vorobyev. 2001. Detection of coloured patterns by honeybees through chromatic and achromatic cues. J Comp Physiol A 187:215-224.
</p>
<p>Renoult, J. P., A. Kelber, and H. M. Schaefer. 2017. Colour spaces in ecology and evolutionary biology. Biol Rev Camb Philos Soc, doi: 10.1111/brv.12230
</p>
<p>Vorobyev, M., and D. Osorio. 1998. Receptor noise as a determinant of colour thresholds. Proceedings of the Royal Society B 265:351-358.
</p>
<p>Vorobyev, M., D. Osorio, A. T. D. Bennett, N. J. Marshall, and I. C. Cuthill. 1998. Tetrachromacy, oil droplets and bird plumage colours. J Comp Physiol A 183:621-633.
</p>


<h3>See Also</h3>

<p><code>photor</code>, <code>RNLthres</code>, <code>CTTKmodel</code>, <code>EMmodel</code>, <code>GENmodel</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#1
## Photoreceptor sensitivity spectra
##with lambda max at 350nm, 450nm and 550nm:
C&lt;-photor(lambda.max=c(350,450,550))

##Grey background
##with 7 percent reflectance from 300 to 700nm:
Rb &lt;- data.frame(300:700, rep(7, length(300:700)))

## Read CIE D65 standard illuminant:
data("D65")

##Reflectance data of R1 and R2
R1.1&lt;-logistic(x=seq(300,700,1), x0=500, L=50, k=0.04)
R1.2&lt;-logistic(x=seq(300,700,1), x0=400, L=50, k=0.04)
w&lt;-R1.1[,1]
R1.1&lt;-R1.1[,2]+10
R1.2&lt;-R1.2[,2]+10
R1&lt;-data.frame(w=w, R1.1=R1.1, R1.2=R1.2)

R2&lt;-logistic(x=seq(300,700,1), x0=550, L=50, k=0.04)
R2[,2]&lt;-R2[,2]+10

## Run model 
model&lt;-RNLmodel(photo=3, model="log",
       R1=R1, R2=R2, Rb=Rb, I=D65, C=C,
       noise=TRUE, e = c(0.13, 0.06, 0.12))
       
#plot       
plot(model)

#2
#Pentachromatic animal
## Photoreceptor sensitivity spectra
##with lambda max at 350,400,450,500,and 550nm:
C&lt;-photor(lambda.max=c(350,400,450,500,550))

##Grey background
##with 7 percent reflectance from 300 to 700nm:
Rb &lt;- data.frame(300:700, rep(7, length(300:700)))

## Read CIE D65 standard illuminant:
data("D65")

##Reflectance data of R1
R1&lt;-logistic(x=seq(300,700,1), x0=500, L=50, k=0.04)
R1[,2]&lt;-R1[,2]+10

#RNL model
RNLmodel(photo=5, model="log",
       R1=R1, R2=Rb, Rb=Rb, I=D65, C=C,
       noise=TRUE, e = c(0.13, 0.06, 0.12, 0.07, 0.08))
</code></pre>


</div>