<div class="container">

<table style="width: 100%;"><tr>
<td>Sam-class</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Class "Sam"</h2>

<h3>Description</h3>

<p>Implements the "Significance Analysis of Microarrays" approach to
detecting differentially expressed genes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Sam(data, classes, nPerm=100, verbose=TRUE)
## S4 method for signature 'Sam,missing'
plot(x, y, tracks=NULL, xlab='Expected T Statistics (Empirical)',
 ylab='Observed T Statistics', ...)
## S4 method for signature 'Sam'
summary(object, cutoff=1, ...)
## S4 method for signature 'Sam'
selectSignificant(object, cutoff=1, ...)
## S4 method for signature 'Sam'
countSignificant(object, cutoff=1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p> Either a data frame or matrix with numeric values or an
<code>ExpressionSet</code> as defined
in the BioConductor tools for analyzing microarray data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>classes</code></td>
<td>
<p> If <code>data</code> is a data frame or matrix, then classes
must be either a logical vector or a factor. If <code>data</code> is an
<code>ExpressionSet</code>, then <code>classes</code> can be a character string that
names one of the factor columns in the associated
<code>phenoData</code> subobject.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nPerm</code></td>
<td>
<p>An integer; the number of permutations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A logical flag</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A <code>Sam</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Nothing, since it is supposed to be missing. Changes to the Rd
processor require documenting the missing entry.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tracks</code></td>
<td>
<p>a numeric vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>Label for the x axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>Label for the y axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A <code>Sam</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p>A numeric value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>The usual extra arguments to generic functions</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The SAM approach to analyzing microarray data was developed by Tusher
and colleagues; their implementation is widely available.  This is an
independent implementation based on the description in their original
paper, customized to use the same interface (and thus work with
<code>ExpressionSet</code> objects) used
by the rest of the ClassComparison package. The fundamental idea
behind SAM is that the observed distribution of row-by-row two-sample
t-tests should be compared not to the theoretical null distribution
but to a null distribution estimated by a permutation test. The
<code>Sam</code> constructor performs the permutation test.
</p>


<h3>Value</h3>

<p><code>summary</code> returns an object of class <code>SamSummary</code>.
</p>
<p><code>selectSignificant</code> returns a vector of logical values.
</p>
<p><code>countSignificant</code> returns an integer.
</p>


<h3>Creating Objects</h3>

<p>As usual, objects can be created by <code>new</code>, but better methods are
available in the form of the <code>Sam</code> function. The inputs to this
function are the same as those used for row-by-row statistical tests
throughout the ClassComparison package; a detailed description can be
found in the <code>MultiTtest</code> class.
</p>


<h3>Slots</h3>


<dl>
<dt>
<code>t.statistics</code>:</dt>
<dd>
<p>numeric vector containing the observed
t-statistics.</p>
</dd> 
<dt>
<code>observed</code>:</dt>
<dd>
<p>numeric vector containing the sorted
observed t-statistics.</p>
</dd>
<dt>
<code>expected</code>:</dt>
<dd>
<p>numeric vector of the expected
distribution of t-statistics based on a permutation test.</p>
</dd>
<dt>
<code>sim.data</code>:</dt>
<dd>
<p>numeric matrix containing all the t-statistics
from all the permutations.</p>
</dd>
<dt>
<code>call</code>:</dt>
<dd>
<p>object of class <code>call</code> specifying the function
call that was used to create this object.</p>
</dd>
</dl>
<h3>Methods</h3>


<dl>
<dt>summary(object, cutoff=1, ...)</dt>
<dd>
<p>Compute a summary of the object. </p>
</dd>
<dt>plot(x, tracks=NULL, xlab='Expected T Statistics (Empirical)',
ylab='Observed t Statistics', ...)</dt>
<dd>
<p>Plot the observed and expected
t-statistics. The <code>tracks</code> argument causes parallel lines to be
drawn on either side of the quantile-quantile central line, at the
specified offsets. Colors in the plot are controlled by the current
values of <code>oompaColor$CENTRAL.LINE</code> and
<code>oompaColor$CONFIDENCE.CURVE</code> </p>
</dd>
<dt>selectSignificant(object, cutoff=1, ...)</dt>
<dd>
<p>Compute a vector
that selects significant values</p>
</dd>
<dt>countSignificant(object, cutoff=1, ...)</dt>
<dd>
<p>Count the number of
significant values</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Kevin R. Coombes <a href="mailto:krc@silicovore.com">krc@silicovore.com</a>
</p>


<h3>References</h3>

<p>Tusher VG, Tibshirani R, Chu G.<br><em>Significance analysis of microarrays applied to the ionizing radiation
response.</em><br>
Proc Natl Acad Sci U S A (2001) 98, 5116-5121.
</p>


<h3>See Also</h3>

<p><code>Bum</code>,
<code>MultiTtest</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">showClass("Sam")
ng &lt;- 10000
ns &lt;- 50
nd &lt;- 100
dat &lt;- matrix(rnorm(ng*ns), ncol=ns)
dat[1:nd, 1:(ns/2)] &lt;- dat[1:nd, 1:(ns/2)] + 2
dat[(nd+1):(2*nd), 1:(ns/2)] &lt;- dat[(nd+1):(2*nd), 1:(ns/2)] - 2
cla &lt;- factor(rep(c('A', 'B'), each=25))

res &lt;- Sam(dat, cla)
plot(res)

plot(res, tracks=1:3)

summary(res)
summary(res, cutoff=2)

a &lt;- summary(res)
plot(a@significant.calls)
plot(a@significant.calls[1:300])

countSignificant(res, 1)
</code></pre>


</div>