<div class="container">

<table style="width: 100%;"><tr>
<td>map_dollo_changes</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Stochastic Character Map For Dollo Character</h2>

<h3>Description</h3>

<p>Given a tree with binary tip states produces a stochastic Dollo character map.
</p>


<h3>Usage</h3>

<pre><code class="language-R">map_dollo_changes(time_tree, tip_states)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>time_tree</code></td>
<td>
<p>A tree in phylo format with positive branch lengths and a value for <code>$root.time</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tip_states</code></td>
<td>
<p>A named vector of tip states (must be 0 or 1), where the names match <code>tree$tip.label</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The non-ideal solution from Tarver et al. (2018) to the problem of generating a stochastic character map for a Dollo character (i.e., a single gain of the derived state, 1) with any number of losses (1 -&gt; 0).
</p>
<p>The function operates as follows:
</p>
<p>1) Establishes the least inclusive clade exhibiting the derived state (1).
2) Assumes a single gain occurred with equal probability along the branch subtending this clade.
3) Prunes the inclusive clade to generate a subtree with a strong root prior of the derived state (1).
4) Calls <code>make.simmap</code> from the <code>phytools</code> package to generate a stochastic character map using a model where only losses are possible.
5) Outputs both the stochastic character map (time spent in each state on each branch) and a matrix of state changes.
</p>
<p>NB: As the map is stochastic the answer will be different each time the function is run and multiple replicates are strongly advised in order to characterise this uncertainty.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>changes</code></td>
<td>
<p>A matrix of all changes (gains and losses).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stochastic_character_map</code></td>
<td>
<p>The stochastic character map.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Graeme T. Lloyd <a href="mailto:graemetlloyd@gmail.com">graemetlloyd@gmail.com</a>
</p>


<h3>References</h3>

<p>Tarver, J. E., Taylor, R. S., Puttick, M. N., Lloyd, G. T., Pett, W., Fromm, B., Schirrmeister, B. E., Pisani, D., Peterson, K. J. and Donoghue, P. C. J., 2018. Well-annotated microRNAomes do not evidence pervasive miRNA loss. <em>Genome Biology and Evolution</em>, <b>6</b>, 1457-1470.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Build example ten-tip tree:
time_tree &lt;- ape::read.tree(text = paste0("(A:1,(B:1,((C:1,(D:1,(E:1,F:1):1):1):1,",
  "((G:1,H:1):1,(I:1,J:1):1):1):1):1);"))

# Arbitrarily add a root.time value of 100 Ma:
time_tree$root.time &lt;- 100

# Build example tip state values:
tip_states &lt;- c(A = 0, B = 0, C = 1, D = 1, E = 0, F = 1, G = 1, H = 1, I = 0, J = 1)

# Run map_dollo_changes on data and store output:
out &lt;- map_dollo_changes(time_tree, tip_states)

# View matrix of changes:
out$changes

# View stochastic character map (time spent in each state on each branch):
out$stochastic_character_map
</code></pre>


</div>