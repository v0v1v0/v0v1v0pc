<div class="container">

<table style="width: 100%;"><tr>
<td>fit.cgOneFactorData</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Fit models to a cgOneFactorData object
</h2>

<h3>Description</h3>

<p>Fits a one-factor model based on the <code>cgOneFactorData</code> object. The
created object is designed for one-factor / one-way / unpaired samples
collected data, and is of class <code>cgOneFactorFit</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'cgOneFactorData'
fit(data, type="rr", ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>A data object of class <code>cgOneFactorData</code>.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type </code></td>
<td>
<p>Type of model to fit, represented by a character
value. The default value is <code>"rr"</code>. The four current
possibilities are:
</p>

<dl>
<dt><code>"ols"</code></dt>
<dd>
<p>Only fit an ordinary, classical least squares
model with the base <code>lm</code> linear model function. 
</p>
</dd>
<dt><code>"rr"</code></dt>
<dd>
<p>Fit a Resistant / Robust model based on M- and
S-estimation, using the <code>rlm</code> function from the
<span class="pkg">MASS</span> package (Venables and Ripley, 2002).
This is the default character value for the
<code>type</code> argument. See the <code>...</code> argument and
Details below for what options are available when
<code>rlm</code> is used in this wrapper method. 
</p>
</dd>
<dt><code>"aft"</code></dt>
<dd>
<p>Fit an accelerated failure time model, using the
<code>survreg</code> function from the
<span class="pkg">survival</span> package. If the <code>data</code> object has censored
data and a slot state of <code>has.censored=TRUE</code>, then
<code>type="aft"</code> will be set. See the <code>...</code> argument and
Details below for what options are used when
<code>survreg</code> is used in this wrapper method; in
particular, the <code>robust</code> argument. 
</p>
</dd>
<dt><code>"uv"</code></dt>
<dd>
<p>Fit an unequal variances model, with a simple
wrapper method around the <code>gls</code> from the <span class="pkg">nlme</span> package.
No optional arguments are passed down to <code>gls</code>
through the <code>...</code> argument.
</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>... </code></td>
<td>

<p>Additional arguments, both <em>optional</em>, that are allowed to be specified dependent on
the choice of the <code>type</code> argument. Otherwise they have no
effect on the fit:
</p>

<dl>
<dt><code>maxIter</code></dt>
<dd>
<p>If <code>type="rr"</code> or <code>type="aft"</code>,
then <code>maxIter</code> can be specified as a numeric postive
integer. The default value of <code>maxIter</code> is <code>100</code>. For
<code>"rr"</code>, this gets passed to the <code>maxit</code> argument in the
<code>rlm</code> method. For <code>"aft"</code>, this gets
passed to the <code>maxiter</code> argument in the <code>survreg</code> function.
</p>
</dd>
<dt><code>sandaft</code></dt>
<dd>
<p>If <code>type="aft"</code>, then <code>sandaft</code> is passed to the
<code>robust</code> argument of the <code>survreg</code> function. The
default value of <code>sandaft</code> is <code>TRUE</code> when
<code>type="aft"</code>, which applies the Huber-type (1967)
sandwich estimator to the
variance-covariance matrix of the group estimates.
</p>
</dd>
</dl>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In the current version of the <span class="pkg">cg</span> package, most default settings
for <code>rlm</code> are kept for the
<code>fit.cgOneFactorData</code> method wrapper call  when
<code>type="rr"</code>, with no capability to choose
another value for an arguments such as <code>psi</code>, <code>scale.est</code>,
and <code>k2</code>. The <code>method</code> argument is set to <code>"MM"</code>.
</p>
<p>Analogously most <code>survreg</code> default settings are kept for the
<code>fit.cgOneFactorData</code> method wrapper call when
<code>type="aft"</code>, with no capability to modify the
arguments. Most notably the <code>dist</code> argument is set to
<code>"lognormal"</code> or <code>"gaussian"</code>, depending on
whether a log scale analysis request is evident in the
<code>cgOneFactorData</code> object or not, respectively.
</p>


<h3>Value</h3>

<p>Creates an object of class  <code>cgOneFactorFit</code>, with the
following slots:
</p>

<dl>
<dt><code>olsfit</code></dt>
<dd>
<p>The contents of a <code>lm</code> fit to the
data. This is always populated with an <code>lm</code> object
no matter the choice of the
<code>type</code> argument, even though it is certainly inappropriate in
the <code>type="aft"</code> case.
</p>
</dd>
<dt><code>rrfit</code></dt>
<dd>
<p>The contents of a <code>rlm</code> fit to the
data, housed as a <code>rrfit</code> class object.
If <code>type="rr"</code> is not selected, then this is set
to a simple character value of <code>"No fit was selected."</code>.
</p>
</dd>
<dt><code>aftfit</code></dt>
<dd>
<p>The contents of a <code>survreg</code> fit to the
data, with some annotations, to be a <code>aftfit</code> class object.
If <code>type="aft"</code> is not selected, then this is set
to a simple character value of <code>"No fit was selected."</code>.
</p>
</dd>
<dt><code>uvfit</code></dt>
<dd>
<p>The contents of a <code>gls</code> fit to the
data, housed as a <code>uvfit</code> class object.
If <code>type="uv"</code> is not selected, then this is set
to a simple character value of <code>"No fit was selected."</code>.
</p>
</dd>
<dt><code>settings</code></dt>
<dd>
<p>A list of properties carried as-is from the
<code>data</code> argument object of class
<code>cgOneFactorData</code>.
In particular,
if <code>zeroscore</code> is specified as a non-<code>NULL</code> number in
the <code>cgOneFactorData</code> object in the <code>data</code>
argument, then a score value near zero was derived to replace all zeroes for subsequent
log-scale analyses. Alternatively, if <code>addconstant</code> is specified 
as a non-<code>NULL</code> number in the
<code>cgOneFactorData</code> object in the <code>data</code>
argument, then a value was added to shift up all observations for subsequent
log-scale analyses. 
</p>
</dd>
</dl>
<h3>Note</h3>

<p>Contact <a href="mailto:cg@billpikounis.net">cg@billpikounis.net</a> for bug reports, questions,
concerns, and comments. 
</p>


<h3>Author(s)</h3>

<p>Bill Pikounis [aut, cre, cph], John Oleynick [aut], Eva Ye [ctb]
</p>


<h3>References</h3>

<p>Huber, P. J. (1967),
"The Behavior of Maximum Likelihood Estimates Under
Nonstandard Conditions",
<em>Proceedings of the Fifth Berkeley Symposium on Mathematical
Statistics and Probability</em>, Volume 1, 221-233.
</p>
<p>Venables, W. N. and Ripley, B. D. (2002), 
<em>Modern Applied Statistics with S.</em>  Fourth edition. Springer.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(canine)
canine.data &lt;- prepareCGOneFactorData(canine, format="groupcolumns",
                                      analysisname="Canine",
                                      endptname="Prostate Volume",
                                      endptunits=expression(plain(cm)^3),
                                      digits=1, logscale=TRUE, refgrp="CC")
									  
canine.fit &lt;- fit(data=canine.data, type="rr")


data(gmcsfcens)
gmcsfcens.data &lt;- prepareCGOneFactorData(gmcsfcens, format="groupcolumns",
                                         analysisname="cytokine",
                                         endptname="GM-CSF (pg/ml)",
                                         logscale=TRUE)

gmcsfcens.fit &lt;- fit(gmcsfcens.data, type="aft")
</code></pre>


</div>