<div class="container">

<table style="width: 100%;"><tr>
<td>EkfBE</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Correction vector estimation</h2>

<h3>Description</h3>

<p>Batch effect estimation using an extended Kalman filter
</p>


<h3>Usage</h3>

<pre><code class="language-R">EkfBE(
  refBatch,
  queBatch,
  pairs,
  sampling = FALSE,
  numSamples = NULL,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>refBatch</code></td>
<td>
<p>Reference batch.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>queBatch</code></td>
<td>
<p>Query batch.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pairs</code></td>
<td>
<p>A numerical matrix containing MNNs pairs cell indexes. First column corresponds to query batch cells.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampling</code></td>
<td>
<p>Sample MNNs pairs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numSamples</code></td>
<td>
<p>If sampling, number of MNNs pairs samples to use on the estimation process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Print output.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The input batches must have the same number of genes. The model used on the estimation has the form of g_ref = g_que + be, where
the batch effect is represented as a value added to the reference gene expression, causing a linear deviation between the reference and
the query batches.
</p>


<h3>Value</h3>

<p>A list containing the estimated correction vector and the estimation data.
The length of the correction vector is equal to the number of genes.
</p>


</div>