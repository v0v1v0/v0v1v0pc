<div class="container">

<table style="width: 100%;"><tr>
<td>sectionCOP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The Sections or Derivative of the Sections of a Copula</h2>

<h3>Description</h3>

<p>Compute the <em>copula sections</em> or the <em>(partial) derivatives of copula sections</em> of a copula (Nelsen, 2006, pp. 12â€“14). The <em>horizontal section</em> at <code class="reqn">V=a</code> (a constant) is
</p>
<p style="text-align: center;"><code class="reqn">t \mapsto \mathbf{C}(t,a)\mbox{, and}</code>
</p>

<p>the <em>vertical  section</em> at <code class="reqn">U=a</code> (a constant, with respect to <code class="reqn">V</code> or <code>wrtV=TRUE</code>) is
</p>
<p style="text-align: center;"><code class="reqn">t \mapsto \mathbf{C}(a,t)\mbox{.}</code>
</p>

<p>The partial derivatives of the copula sections are <em>conditional cumulative distribution functions</em> (see <code>derCOP</code> and <code>derCOP2</code>). The derivatives are constrained as
</p>
<p style="text-align: center;"><code class="reqn">0 \le \frac{\delta}{\delta u}\mathbf{C}(u,v) \le 1\mbox{, and}</code>
</p>

<p style="text-align: center;"><code class="reqn">0 \le \frac{\delta}{\delta v}\mathbf{C}(u,v) \le 1\mbox{.}</code>
</p>



<h3>Usage</h3>

<pre><code class="language-R">sectionCOP(f, cop=NULL,  para=NULL, wrtV=FALSE, dercop=FALSE, delt=0.005,
              ploton=TRUE, lines=TRUE, xlab="NONEXCEEDANCE PROBABILITY", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>A single value of nonexceedance probability <code class="reqn">u</code> or <code class="reqn">v</code> along the horizontal <code class="reqn">U</code> axis or vertical <code class="reqn">V</code> axis of the unit square <code class="reqn">\mathcal{I}^2</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cop</code></td>
<td>
<p>A copula function;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>para</code></td>
<td>
<p>Vector of parameters, if needed, to pass to the copula;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wrtV</code></td>
<td>
<p>A logical to toggle between with respect to <code class="reqn">v</code> or <code class="reqn">u</code> (default). The default provides the vertical section whereas the horizontal comes from <code>wrtV = TRUE</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dercop</code></td>
<td>
<p>A logical that triggers the derivative of the section;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delt</code></td>
<td>
<p>The increment of the level curves to plot, defaults to 5-percent intervals;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ploton</code></td>
<td>
<p>A logical to toggle on the plot;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lines</code></td>
<td>
<p>Draw the lines of diagonal to the current device;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>A label for the x-axis title passed to <code>plot()</code> in <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>; and</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to pass to the <code>plot()</code> and <code>lines()</code> functions in <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> <code>list</code> is returned.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>The nonexceedance probability along the section. The nomenclature <code class="reqn">t</code> mimics Nelsen (2006) and is <em>not</em> the same as the <code class="reqn">u</code> or <code class="reqn">v</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seccop</code></td>
<td>
<p>The section of the copula or its derivative;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wrt</code></td>
<td>
<p>A text string declaring what the setting for <code>wrtV</code> was;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fvalue</code></td>
<td>
<p>The provided value of nonexceedance probability; and</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>isderivative</code></td>
<td>
<p>A logical stating whether the derivative of the section is <code>seccop</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>W.H. Asquith</p>


<h3>References</h3>

<p>Nelsen, R.B., 2006, An introduction to copulas: New York, Springer, 269 p.
</p>


<h3>See Also</h3>

<p><code>COP</code>, <code>diagCOP</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# EXAMPLE 1, plot the v=0.55 section and then u=0.55 section, which will overlay
# the other because the PSP is a symmetrical copula
tmp &lt;- sectionCOP(0.55, cop=PSP, ylab="COPULA SECTIONS",  lwd=5, col=2)
tmp &lt;- sectionCOP(0.55, cop=PSP, wrtV=TRUE, ploton=FALSE, lwd=2, col=3)
# now add the v=0.85 section and the u=0.85, again overlay each other
tmp &lt;- sectionCOP(0.85, cop=PSP, ploton=FALSE,             lwd=5, col=2, lty=2)
tmp &lt;- sectionCOP(0.85, cop=PSP, wrtV=TRUE, ploton=FALSE,  lwd=2, col=3, lty=2)#
## End(Not run)

## Not run: 
# EXAMPLE 2, v=0.35 section and derivative (the conditional distribution) function
tmp &lt;- sectionCOP(0.35, cop=PSP, ylab="COPULA SECTIONS OR DERIV.", lwd=5, col=3)
tmp &lt;- sectionCOP(0.35, cop=PSP, dercop=TRUE, ploton=FALSE,               col=3)
# The thin green line represents the cumulative distribution function conditional
# on u = 0.35 from the derCOP function.  Then see Example 3
## End(Not run)

## Not run: 
# EXAMPLE 3 (random selection commented out)
#para &lt;- list(cop1=PLACKETTcop,  cop2=PLACKETTcop, alpha=runif(1), beta=runif(1),
#             para1=10^runif(1,min=-4, max=0), para2=10^runif(1,min= 0, max=4))
para &lt;- list(cop1=PLACKETTcop,  cop2=PLACKETTcop, alpha=0.7, beta=0.22,
             para1=0.0155, para2=214.4)
txts &lt;- c("Alpha=",    round(para$alpha,    digits=4),
          "; Beta=",   round(para$beta,     digits=4),
          "; Theta1=", round(para$para1[1], digits=5),
          "; Theta2=", round(para$para2[1], digits=2))
layout(matrix(1:2,byrow=TRUE))
D &lt;- simCOP(n=1000, cop=composite2COP, para=para, cex=0.5, col=rgb(0,0,0,0.2), pch=16)
mtext(paste(txts,collapse=""))
#f &lt;- c(runif(1),runif(1))
f &lt;- c(0.2,0.9) # RED is the horizontal section and BLACK is the vertical section
segments(f[1],0,f[1],1, col=2, lwd=2); segments(0,f[2],1,f[2], lwd=2)
ftxt &lt;- c("Sections (thick) and derivatives (thin) at ", f, " nonexceed. prob.")
tmp &lt;- sectionCOP(f[1],cop=composite2COP,para=para, col=2, lwd=4)
tmp &lt;- sectionCOP(f[1],cop=composite2COP,para=para, dercop=TRUE, ploton=FALSE, col=2)
tmp &lt;- sectionCOP(f[2],cop=composite2COP,para=para,wrtV=TRUE,ploton=FALSE,lwd=4)
tmp &lt;- sectionCOP(f[2],cop=composite2COP,para=para,wrtV=TRUE,ploton=FALSE,dercop=TRUE)
mtext(paste(ftxt, collapse=""))
# The thin lines are the CDFs conditional on the respective values of "f". Carefully
# compare the point densities along and near the sections in the top plot to the
# respective shapes of the CDFs in the bottom plot. If the bottom plot were rotated
# 90 degrees clockwise and then reflected top to bottom, the conditional quantile
# function QDF results. Reflection is needed because, by convention, QDFs are monotonic
# increasing to right---functions derCOPinv() and derCOPinv2() provide the CDF inversion.
## End(Not run)
</code></pre>


</div>