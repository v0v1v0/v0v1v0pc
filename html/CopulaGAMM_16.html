<div class="container">

<table style="width: 100%;"><tr>
<td>EstContinuous</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Copula-based estimation of mixed regression models for continuous response</h2>

<h3>Description</h3>

<p>This function computes the estimation of a copula-based  2-level hierarchical model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">EstContinuous(
  y,
  model,
  family,
  rot = 0,
  clu,
  xc = NULL,
  xm = NULL,
  start,
  LB,
  UB,
  nq = 31,
  dfM = NULL,
  dfC = NULL,
  prediction = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>n x 1 vector of response variable (assumed continuous).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>function for margins: "gaussian" (normal), "t" (Student with known df=dfM), laplace" , "exponential", "weibull".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>copula family: "gaussian" , "t" , "clayton" ,  "frank" , "fgm", "gumbel".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rot</code></td>
<td>
<p>rotation: 0 (default), 90, 180 (survival), or 270</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clu</code></td>
<td>
<p>variable of size n defining the clusters; can be a factor</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xc</code></td>
<td>
<p>covariates of size n for the estimation of the copula, in addition to the constant; default is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xm</code></td>
<td>
<p>covariates of size n for the estimation of the mean of the margin, in addition to the constant; default is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>starting point for the estimation; could be the ones associated with a Gaussian-copula model defined by lmer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LB</code></td>
<td>
<p>lower bound for the parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>UB</code></td>
<td>
<p>upper bound for the parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nq</code></td>
<td>
<p>number of nodes and weighted for Gaussian quadrature of the product of conditional copulas; default is 25.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dfM</code></td>
<td>
<p>degrees of freedom for a Student margin; default is 0 for non-t distribution,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dfC</code></td>
<td>
<p>degrees of freedom for a Student margin; default is 5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prediction</code></td>
<td>
<p>logical variable for prediction of latent variables V; default is TRUE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>Estimated parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd</code></td>
<td>
<p>Standard deviations of the estimated parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tstat</code></td>
<td>
<p>T statistics for the estimated parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval</code></td>
<td>
<p>P-values of the t statistics for the estimated parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gradient</code></td>
<td>
<p>Gradient of the log-likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>Log-likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aic</code></td>
<td>
<p>AIC coefficient</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bic</code></td>
<td>
<p>BIC coefficient</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov</code></td>
<td>
<p>Covariance matrix of the estimations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grd</code></td>
<td>
<p>Gradients by clusters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clu</code></td>
<td>
<p>Cluster values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Matxc</code></td>
<td>
<p>Matrix of covariates defining the copula parameters, including a constant</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Matxm</code></td>
<td>
<p>Matrix of covariates defining the margin parameters, including a constant</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p>Estimated value of the latent variable by clusters (if prediction=TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>Unique values of clusters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>Copula family</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>Kendall's tau by observation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thC0</code></td>
<td>
<p>Estimated parameters of the copula by observation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thF</code></td>
<td>
<p>Estimated parameters of the margins by observation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pcond</code></td>
<td>
<p>Conditional copula cdf</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fcpdf</code></td>
<td>
<p>Margin functions (cdf and pdf)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dfM</code></td>
<td>
<p>Degrees of freedom for Student margin (default is NULL)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dfC</code></td>
<td>
<p>Degrees of freedom for the Student copula (default is NULL)</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Pavel Krupskii, Bouchra R. Nasri and Bruno N. Remillard
</p>


<h3>References</h3>

<p>Krupskii, Nasri &amp; Remillard (2023). On factor copula-based mixed regression models
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(normal) #simulated data with normal margins
start=c(0,0,0,1); LB=c(rep(-10,3),0.001);UB=c(rep(10,3),10)
y=normal$y; clu=normal$clu;xm=normal$xm
out=EstContinuous(y,model="gaussian",family="clayton",rot=90,clu=clu,xm=xm,start=start,LB=LB,UB=UB)
</code></pre>


</div>