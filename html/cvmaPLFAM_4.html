<div class="container">

<table style="width: 100%;"><tr>
<td>fpcscore</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate functional principal component (fpc) scores</h2>

<h3>Description</h3>

<p>Conduct functional principal component analysis (FPCA) on the observation matrix of the functional predictor.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fpcscore(Z, nbasis, tt)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>An <code>n</code> by <code>nT</code> matrix. The recording/measurement matrix of the functional predictor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbasis</code></td>
<td>
<p>The number of basis functions used for spline approximation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tt</code></td>
<td>
<p>The vector of recording/measurement points for the functional predictor.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>list</code> of
</p>
<table>
<tr style="vertical-align: top;">
<td><code>score</code></td>
<td>
<p>An <code>n</code> by <code>nbasis</code> matrix. The estimated functional principal component scores.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eigv</code></td>
<td>
<p>A vector of estimated eigen-values related to FPCA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varp</code></td>
<td>
<p>A vector of percents of variance explained related to FPCA.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R"># Generate a recording/measurement matrix of the functional predictor
fddata = matrix(rnorm(1000), nrow = 10, ncol = 100)
tpoints = seq(0, 1, length.out = 100)

library(fda)
# Using 20 basis functions for spline approximation
fpcscore(fddata, nbasis = 20, tt = tpoints)

# Generate simulated data
simdata = data_gen(R = 0.7, K = 1, n = 20, M0 = 20, typ = 1, design = 1)
# Extract functional data from 'simdata', columns (M0+1):(M0+100)
simfd = simdata[[1]][,21:120]
# Calculate fpc scores
fpcres = fpcscore(simfd, nbasis = 50, tt = seq(0, 1, length.out = 100))
fpcres$score
fpcres$eigv
cumsum(fpcres$varp)

</code></pre>


</div>