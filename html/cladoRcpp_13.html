<div class="container">

<table style="width: 100%;"><tr>
<td>rcpp_calc_anclikes_sp_using_COOprobs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate ancestral likelihoods given a COO-like probability matrix</h2>

<h3>Description</h3>

<p>This function does a pass through a COO-like transition probability matrix 
for a node, inputting the probabilities that have been passed down
from above for the left and right branch, and the sum of weights for
each ancestral state, and returns the ancestral relative probabilities.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rcpp_calc_anclikes_sp_using_COOprobs(Rcpp_leftprobs, Rcpp_rightprobs,
  RCOO_left_i_list, RCOO_right_j_list, RCOO_probs_list, Rsp_rowsums,
  printmat = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Rcpp_leftprobs</code></td>
<td>
<p>Probabilities of the states at the base of the left descendant branch</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rcpp_rightprobs</code></td>
<td>
<p>Probabilities of the states at the base of the right descendant branch</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RCOO_left_i_list</code></td>
<td>
<p>0-based index of the allowed left states<br></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RCOO_right_j_list</code></td>
<td>
<p>0-based index of the allowed right states<br></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RCOO_probs_list</code></td>
<td>
<p>Value of the specified nonzero cells<br></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rsp_rowsums</code></td>
<td>
<p>A vector of size (numstates)  giving the sum of the relative probabilites of 
each combination of descendant states, assuming the probabilities of the left- and right-states are 
all equal (set to 1). This is thus the sum of the weights, and dividing by this normalization vector 
means that the each row of the speciation probability matrix will sum to 1.  Default assumes the 
weights sum to 1 but this is not usually the case. Rsp_rowsums need only be calculated once per 
tree+model combination, stored, and then re-used for each node in the tree, yielding significant 
time savings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>printmat</code></td>
<td>
<p>Should the probability matrix output be printed to screen? (useful for debugging, but 
can be dramatically slow in R.app for some reason for even moderate numbers of states; perhaps 
overrunning the line length...)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This C++ implementation should be slightly faster than the R version,
although for a simple pass through an array the difference may not
be great.
</p>


<h3>Value</h3>

<p><code>R_anc_relprobs</code> Vector of the probabilities of the ancestral states
</p>


<h3>Author(s)</h3>

<p>Nicholas Matzke <a href="mailto:matzke@berkeley.edu">matzke@berkeley.edu</a>
</p>


<h3>See Also</h3>

<p><code>rcpp_calc_anclikes_sp</code>
</p>
<p><code>rcpp_calc_anclikes_sp</code>
#bibliography /Dropbox/_njm/__packages/cladoRcpp_setup/cladoRcpp_refs.bib
@cite Matzke_2013
@cite Matzke_2014
</p>


<h3>Examples</h3>

<pre><code class="language-R"># For the basic logic of a probablistic cladogenesis model, see
?rcpp_calc_anclikes_sp

# For examples of running the functions, see the comparison of all functions at:
# ?cladoRcpp

</code></pre>


</div>