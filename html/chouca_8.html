<div class="container">

<table style="width: 100%;"><tr>
<td>run_meanfield</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Mean field model</h2>

<h3>Description</h3>

<p>Run the mean field model corresponding to a cellular automaton
</p>


<h3>Usage</h3>

<pre><code class="language-R">run_meanfield(mod, init, times, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mod</code></td>
<td>
<p>The cellular automaton model (produced by <code>camodel</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>The initial landscape, or a vector of covers summing to one, whose length 
is equal to the number of states in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>
<p>The points in time for which output is wanted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments are passed to <code>ode</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The mean field approximation to a cellular automaton simply describes the dynamics 
of the global covers using differential equations, assumming that both global 
and local covers are equal (in <code>chouca</code> model specifications, this assumes 
p = q). 
</p>
<p>For example, if we consider a model with two states 'a' and 'b' and transitions 
from and to each other, then the following system of equation is used to describe 
the variations of the proportions of cells in each state: 
</p>
<p style="text-align: center;"><code class="reqn">\frac{da}{dt} = p_b P(b \to a) - p_a P(a \to b)</code>
</p>

<p style="text-align: center;"><code class="reqn">\frac{db}{dt} = p_a P(a \to b) - p_b P(b \to a)</code>
</p>

<p>Running mean-field approximations is useful to understand general dynamics in the 
absence of neighborhood interactions between cells, or simply to obtain an 
fast but approximate simulation of the model. 
</p>
<p>Note that this function uses directly the expressions of the probabilities, so any 
cellular automaton is supported, regardless of whether or not it can be simulated 
exactly by <code>run_camodel</code>.
</p>


<h3>Value</h3>

<p>This function returns the results of the <code>ode</code> 
function, which is a matrix with class 'deSolve'
</p>


<h3>Examples</h3>

<pre><code class="language-R">
if ( requireNamespace("deSolve") ) { 
  # Get the mean-field approximation to the arid vegetation model 
  arid &lt;- ca_library("aridvege") 
  mod &lt;- ca_library("aridvege")
  init &lt;- generate_initmat(mod, rep(1, 3)/3, nrow = 100, ncol = 100)
  times &lt;- seq(0, 128)
  out &lt;- run_meanfield(mod, init, times)
  # This uses the default plot method in deSolve
  plot(out)
  
  # A different model and way to specifiy initial conditions.
  coralmod &lt;- ca_library("coralreef")
  init &lt;- c(ALGAE = 0.2, CORAL = 0.5, BARE = 0.3)
  times &lt;- 10^seq(0, 4, length.out = 64)
  out &lt;- run_meanfield(coralmod, init, times, method = "lsoda")
  plot(out, ylim = c(0, 1))
}

</code></pre>


</div>