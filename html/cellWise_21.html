<div class="container">

<table style="width: 100%;"><tr>
<td>ICPCA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Iterative Classical PCA
</h2>

<h3>Description</h3>

<p>This function carries out classical PCA when the data may contain
missing values, by an iterative algorithm. It is based on a Matlab function from the Missing Data Imputation Toolbox v1.0
by A. Folch-Fortuny, F. Arteaga and A. Ferrer.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ICPCA(X, k, scale = FALSE, maxiter = 20, tol = 0.005,
      tolProb = 0.99, distprob = 0.99) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>the input data, which must be a matrix or a data frame.
It may contain NA's. It must always be provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>the desired number of principal components</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>a value indicating whether and how the original
variables should be scaled. If <code>scale=FALSE</code> (default)
or <code>scale=NULL</code> no scaling is performed (and a vector
of 1s is returned in the <code>$scaleX</code> slot).
If <code>scale=TRUE</code> the variables are scaled to have a
standard deviation of 1. Alternatively scale can be a function like mad,
or a vector of length equal to the number of columns
of x. The resulting scale estimates are returned in the
<code>$scaleX</code> slot of the output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>maximum number of iterations. Default is 20.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>tolerance for iterations. Default is 0.005.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tolProb</code></td>
<td>
<p>tolerance probability for residuals. Defaults to 0.99.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distprob</code></td>
<td>
<p>probability determining the cutoff values for
orthogonal and score distances. Default is 0.99.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with components: <br></p>
<table>
<tr style="vertical-align: top;">
<td><code>scaleX</code></td>
<td>
<p>the scales of the columns of X.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>the number of principal components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loadings</code></td>
<td>
<p>the columns are the k loading vectors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eigenvalues</code></td>
<td>
<p>the k eigenvalues.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p>vector with the fitted center.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covmatrix</code></td>
<td>
<p>estimated covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>It</code></td>
<td>
<p>number of iteration steps.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diff</code></td>
<td>
<p>convergence criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X.NAimp</code></td>
<td>
<p>data with all NA's imputed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scores</code></td>
<td>
<p>scores of X.NAimp.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>OD</code></td>
<td>
<p>orthogonal distances of the rows of X.NAimp.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoffOD</code></td>
<td>
<p>cutoff value for the OD.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SD</code></td>
<td>
<p>score distances of the rows of X.NAimp.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoffSD</code></td>
<td>
<p>cutoff value for the SD.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>highOD</code></td>
<td>
<p>row numbers of cases whose <code>OD</code> is above <code>cutoffOD</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>highSD</code></td>
<td>
<p>row numbers of cases whose <code>SD</code> is above <code>cutoffSD</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residScale</code></td>
<td>
<p>scale of the residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stdResid</code></td>
<td>
<p>standardized residuals. Note that these are NA
for all missing values of <code>X</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indcells</code></td>
<td>
<p>indices of cellwise outliers.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Wannes Van Den Bossche
</p>


<h3>References</h3>

<p>Folch-Fortuny, A., Arteaga, F., Ferrer, A. (2016). Missing Data Imputation Toolbox for MATLAB.
<em>Chemometrics and Intelligent Laboratory Systems</em>, <b>154</b>, 93-100.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(MASS) 
set.seed(12345) 
n &lt;- 100; d &lt;- 10
A &lt;- diag(d) * 0.1 + 0.9
x &lt;- mvrnorm(n, rep(0,d), A)
x[sample(1:(n * d), 100, FALSE)] &lt;- NA
ICPCA.out &lt;- ICPCA(x, k = 2)
plot(ICPCA.out$scores)
</code></pre>


</div>