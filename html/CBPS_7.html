<div class="container">

<table style="width: 100%;"><tr>
<td>CBIV</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Covariate Balancing Propensity Score for Instrumental Variable Estimates
(CBIV)</h2>

<h3>Description</h3>

<p><code>CBIV</code> estimates propensity scores for compliance status in an
instrumental variables setup such that both covariate balance and prediction
of treatment assignment are maximized.  The method, therefore, avoids an
iterative process between model fitting and balance checking and implements
both simultaneously.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CBIV(
  Tr,
  Z,
  X,
  iterations = 1000,
  method = "over",
  twostep = TRUE,
  twosided = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Tr</code></td>
<td>
<p>A binary treatment variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>A binary encouragement variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A pre-treatment covariate matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterations</code></td>
<td>
<p>An optional parameter for the maximum number of iterations
for the optimization.  Default is 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Choose "over" to fit an over-identified model that combines
the propensity score and covariate balancing conditions; choose "exact" to
fit a model that only contains the covariate balancing conditions.  Our
simulations suggest that "over" dramatically outperforms "exact."</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>twostep</code></td>
<td>
<p>Default is <code>TRUE</code> for a two-step GMM estimator, which
will run substantially faster than continuous-updating.  Set to <code>FALSE</code>
to use the continuous-updating GMM estimator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>twosided</code></td>
<td>
<p>Default is <code>TRUE</code>, which allows for two-sided
noncompliance with both always-takers and never-takers.  Set to <code>FALSE</code>
for one-sided noncompliance, which allows only for never-takers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other parameters to be passed through to <code>optim()</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Fits covariate balancing propensity scores for generalizing local average
treatment effect estimates obtained from instrumental variables analysis.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>A named matrix of coefficients, where the first
column gives the complier coefficients and the second column gives the
always-taker coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>
<p>The fitted N x 3 compliance
score matrix.  The first column gives the estimated probability of being a
complier, the second column gives the estimated probability of being an
always-taker, and the third column gives the estimated probability of being
a never-taker.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>The optimal weights: the reciprocal of the
probability of being a complier.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deviance</code></td>
<td>
<p>Minus twice the
log-likelihood of the CBIV fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>converged</code></td>
<td>
<p>Convergence value.
Returned from the call to <code>optim()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>J</code></td>
<td>
<p>The J-statistic at
convergence</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>The number of linearly independent covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bal</code></td>
<td>
<p>The covariate balance associated with the optimal weights,
calculated as the GMM loss of the covariate balance conditions.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Christian Fong
</p>


<h3>References</h3>

<p>Imai, Kosuke and Marc Ratkovic.  2014. “Covariate Balancing
Propensity Score.” Journal of the Royal Statistical Society, Series B
(Statistical Methodology).
<a href="http://imai.princeton.edu/research/CBPS.html">http://imai.princeton.edu/research/CBPS.html</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
###
### Example: propensity score matching
### (Need to fix when we have an actual example).

##Load the LaLonde data
data(LaLonde)
## Estimate CBPS
fit &lt;- CBPS(treat ~ age + educ + re75 + re74 + 
			I(re75==0) + I(re74==0), 
			data = LaLonde, ATT = TRUE)
summary(fit)


</code></pre>


</div>