<div class="container">

<table style="width: 100%;"><tr>
<td>compute_snv_clonality</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function to compute clonality of SNVs</h2>

<h3>Description</h3>

<p>This function takes as input the genomic position of a SNVs and computes the
percentage of genomic homogeneus cells harboring the mutation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">compute_snv_clonality(sample_id, snv_read_count, beta_table, ploidy_table,
  admixture_table, error_tb = error_table, error_rate = 0.05,
  n_digits = 3, n_cores = 1, annotation_style = "VEP", debug = F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sample_id</code></td>
<td>
<p>the id of the analyzed sample. It must be the same value
reported in column sample of tables beta_table, ploidy_table, and
admixture_table</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>snv_read_count</code></td>
<td>
<p>data.frame reporting in each row the genomic coordinates
of an SNV together with number of reference and alternative reads covering
the position in columns rc_ref_tumor and rc_alt_tumor, respectively. See
parameter annotation_style for details about column names</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_table</code></td>
<td>
<p>data.frame formatted as the output of function
<code>compute_beta_table</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ploidy_table</code></td>
<td>
<p>data.frame formatted as the output of function
<code>compute_ploidy</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>admixture_table</code></td>
<td>
<p>data.frame formatted as the output of function
<code>compute_dna_admixture</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>error_tb</code></td>
<td>
<p>data.frame that reports for each combination of coverage and
number informative SNPs the expected estimation error around beta. The
data.frame error_tb must contains 3 columns: </p>
 <dl>
<dt>mean.cov</dt>
<dd>
<p>mean
coverage</p>
</dd> <dt>n.info.snps</dt>
<dd>
<p>number of informative SNPs</p>
</dd>
<dt>adm.estimation.error</dt>
<dd>
<p>estimated error on computed beta on a segment
with coverage mean.cov and n.info.snps informative SNPs</p>
</dd> </dl>
<p> Package CLONETv2
have built in error_tb named error_table (default=error_table)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>error_rate</code></td>
<td>
<p>expected fraction of SNV positions with outlier variant
allelic fraction (default=0.05)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_digits</code></td>
<td>
<p>number of digits in the output table  (default=3)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_cores</code></td>
<td>
<p>number of cores (default=1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>annotation_style</code></td>
<td>
<p>a string that corresponds to the format of the columns
that describe the genomic coordinates of a SNV. Accepted values are VEP and
MAF. <a href="https://www.ensembl.org/info/docs/tools/vep/index.html">VEP annotation</a>
describes genomic coordinates with a single column named Location. <a href="https://docs.gdc.cancer.gov/Data/File_Formats/MAF_Format/">MAF format</a> has
columns Chromosome, Start_position, and End_position for each aberrant
position</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>debug</code></td>
<td>
<p>return extra columns for debugging (default=F)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A data.frame that extends input table snv_read_count with columns
sample, cnA, cnB, t_af, t_af_corr, SNV.clonality, and SNV.clonality.status.
Columns cnA and cnB report the allele specific copy number of the genomic
segment containing the SNV position. Columns t_af and t_af_corr are
respectively raw and ploidy/purity adjusted tumor varian allelic fractions.
SNV.clonality reports the percentage of tumor cells harboring the SNV and
with allele specific copy number cnA and cnB. SNV.clonality.status column
lists dicretized SNV.clonality values. Discrete states are clonal,
uncertain.clonal, uncertain.subclonal, and subclonal based in threshold
automatically computed on the SNV.clonality values. Empty
SNV.clonality.status of an SNV indicates that clonality cannot be assessed.
</p>


<h3>Author(s)</h3>

<p>Davide Prandi, Tarcisio Fedrizzi
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Compute SNVs clonality
snv_clonality_table_toy &lt;- compute_snv_clonality("toy_sample",
  snv_reads_toy, bt_toy, pl_table_toy, adm_table_toy)

</code></pre>


</div>