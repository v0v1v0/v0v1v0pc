<div class="container">

<table style="width: 100%;"><tr>
<td>piecewiseRQA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute recurrence plots for long time-series data series
using a block (piece-wise) method.</h2>

<h3>Description</h3>

<p>This is a convenience function which breaks down 
the computation of large recurrence plots into a collection of
smaller recurrence plots. It can ease speed and memory issues
if an appropriate size for the block is found.</p>


<h3>Usage</h3>

<pre><code class="language-R">piecewiseRQA(ts1, ts2, blockSize, delay, embed, rescale, radius,
normalize, mindiagline, minvertline, tw, whiteline, recpt, side, 
method, metric, datatype, typeRQA, windowsize)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ts1</code></td>
<td>
<p>First time-series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ts2</code></td>
<td>
<p>Second time-series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>blockSize</code></td>
<td>
<p>The dimension of the time-series subunit in which the-recurrence plot will be computed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delay</code></td>
<td>
<p>The delay unit by which the series are lagged.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>embed</code></td>
<td>
<p>The number of embedding dimension for
phase-reconstruction, i.e., the lag intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rescale</code></td>
<td>
<p>Rescale the distance matrix;
if rescale = 0 (do nothing);
if rescale = 1 (mean distance of entire matrix);
if rescale = 2 (maximum distance of entire matrix).
if rescale = 3 (minimum distance of entire matrix).
if rescale = 4 (euclidean distance of entire matrix).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>radius</code></td>
<td>
<p>A threshold, cut-off, constant used to
decide whether two points are recurrent or not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalize</code></td>
<td>
<p>Normalize the time-series;
if normalize = 0 (do nothing);
if normalize = 1 (Unit interval);
if normalize =  2 (z-score).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mindiagline</code></td>
<td>
<p>A minimum diagonal length of
recurrent points. Usually set to 2, as it takes
a minimum of two points to define any line.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minvertline</code></td>
<td>
<p>A minimum vertical length of
recurrent points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tw</code></td>
<td>
<p>The Theiler window parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>whiteline</code></td>
<td>
<p>A logical flag to calculate (TRUE)
or not (FALSE) empty vertical lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>recpt</code></td>
<td>
<p>A logical flag indicating whether
measures of cross-recurrence are calculated directly
from a recurrent plot (TRUE) or not (FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>side</code></td>
<td>
<p>A string indicating whether recurrence measures
should be calculated in the 'upper' triangle of the RP
'lower' triangle of the matrix, or 'both'.
LOC is automatically excluded for 'upper' and 'lower'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A string to indicate the type of recurrence
analysis to peform. There are three options:
rqa (autorecurrence); crqa(cross-recurrence); 
mdcrqa(multidimensional recurrence). Default value is crqa</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metric</code></td>
<td>
<p>A string to indicate the type of 
distance metric used, default is euclidean but 
see help rdist() to list all other possible metrics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>datatype</code></td>
<td>
<p>a string (continuous or categorical) 
to indicate whether the nature of the data type</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>typeRQA</code></td>
<td>
<p>a string (full or diagonal) to indicate
whether piecewise recurrence quantification measures 
should be returned for full plot or for the diagonal profile</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>windowsize</code></td>
<td>
<p>the size of the window around the
diagonal of the recurrence (if typeRQA = diagonal)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>It is important to estimate the size of the block that 
may maximize the speed of the computation. 
We suggest to monitor how speed and memory usage
changes as a result of increasing the time-series and
the block size. 
We also recommend setting whiteline = FALSE, as the current
version of the library does not make use of such
information to extract measures of recurrence.
</p>


<h3>Value</h3>

<p>If an RP can be calculated and recurrence is found, 
the piecewiseRQA will return exactly the same measures 
as crqa() if the typeRQA is set to 'full' and 
drpdfromts() if the typeRQA is set to 'diagonal'.
Please refer to the help file for those two functions 
for details about the measures.
</p>
<table><tr style="vertical-align: top;">
<td><code>RP</code></td>
<td>
<p>The Recurrence Plot sparse matrix data</p>
</td>
</tr></table>
<h3>Author(s)</h3>

<p>Moreno I. Coco (moreno.cocoi@gmail.com) based 
on Matlab code by Sebastian Wallot</p>


<h3>See Also</h3>

<p><code>crqa</code>, <code>spdiags</code>, <code>simts</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
## Uncomment and run locally

## generate some data using pracma

# ts1 = seq(0.1, 200, .1)
# ts1 = sin(ts1) + linspace(0, 1,length(ts1));

# ts2 = ts1

## initialize the parameters
# blockSize = 100; delay  = 15; embed  = 2; rescale = 0; radius = 0.5;
# normalize = 0; mindiagline = 2; minvertline = 2;
# tw = 1; whiteline = FALSE; recpt = FALSE; side = 'both'
# method = "crqa"; metric = 'euclidean'; datatype = "continuous"
# typeRQA = "full"; windowsize = NA

# pieceRP = piecewiseRQA(ts1, ts2, blockSize, delay, embed, rescale,
#                       radius, normalize, mindiagline, minvertline,
#                       tw, whiteline, recpt, side,
#                       method, metric, datatype, typeRQA, 
#                       windowsize)
                       
# print(unlist(pieceRP[1:10]))
                       
</code></pre>


</div>