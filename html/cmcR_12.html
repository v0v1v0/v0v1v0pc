<div class="container">

<table style="width: 100%;"><tr>
<td>decision_CMC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Applies the decision rules of the original method of Song (2013) or the High
CMC method of Tong et al. (2015)</h2>

<h3>Description</h3>

<p>Applies the decision rules of the original method of Song (2013) or the High
CMC method of Tong et al. (2015)
</p>


<h3>Usage</h3>

<pre><code class="language-R">decision_CMC(
  cellIndex,
  x,
  y,
  theta,
  corr,
  xThresh = 20,
  yThresh = xThresh,
  thetaThresh = 6,
  corrThresh = 0.5,
  tau = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cellIndex</code></td>
<td>
<p>vector/tibble column containing cell indices corresponding to
a reference cell</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>vector/tibble column containing x horizontal translation values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>vector/tibble column containing y vertical translation values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>vector/tibble column containing theta rotation values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corr</code></td>
<td>
<p>vector/tibble column containing correlation similarity scores
between a reference cell and its associated target region</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xThresh</code></td>
<td>
<p>used to classify particular x values "congruent" (conditional
on a particular theta value) if they are within xThresh of the
theta-specific median x value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yThresh</code></td>
<td>
<p>used to classify particular y values "congruent" (conditional
on a particular theta value) if they are within yThresh of the
theta-specific median y value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thetaThresh</code></td>
<td>
<p>(original method of Song (2013)) used to classify
particular theta values "congruent" if they are within thetaThresh of the
median theta value. (High CMC) defines how wide a High CMC mode is allowed
to be in the CMC-theta distribution before it's considered too diffuse</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corrThresh</code></td>
<td>
<p>to classify particular correlation values "congruent"
(conditional on a particular theta value) if they are at least corrThresh</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>(optional) parameter required to apply the High CMC method of Tong
et al. (2015). If not given, then the decision rule of the original method
of Song (2013) is applied. This number is subtracted from the maximum CMC
count achieved in the CMC-theta distribution. Theta values with CMC counts
above this value are considered to have "high" CMC counts.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A vector of the same length as the input containing the CMC
classification under one of the two decision rules.
</p>


<h3>See Also</h3>

<p><a href="https://tsapps.nist.gov/publication/get_pdf.cfm?pub_id=911193">https://tsapps.nist.gov/publication/get_pdf.cfm?pub_id=911193</a>
</p>
<p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4730689/pdf/jres.120.008.pdf">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4730689/pdf/jres.120.008.pdf</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data(fadul1.1_processed,fadul1.2_processed)

comparisonDF &lt;- purrr::map_dfr(seq(-30,30,by = 3),
                              ~ comparison_allTogether(fadul1.1_processed,
                                                       fadul1.2_processed,
                                                       theta = .))


comparisonDF &lt;- comparisonDF %&gt;%
dplyr::mutate(originalMethodClassif = decision_CMC(cellIndex = cellIndex,
                                                   x = x,
                                                   y = y,
                                                   theta = theta,
                                                   corr = pairwiseCompCor),
              highCMCClassif = decision_CMC(cellIndex = cellIndex,
                                           x = x,
                                           y = y,
                                           theta = theta,
                                           corr = pairwiseCompCor,
                                           tau = 1))


comparisonDF %&gt;%
dplyr::filter(originalMethodClassif == "CMC" | highCMCClassif == "CMC")

## End(Not run)
</code></pre>


</div>