<div class="container">

<table style="width: 100%;"><tr>
<td>AdjBCD</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Covariate-adjusted Biased Coin Design</h2>

<h3>Description</h3>

<p>Allocates patients to one of two treatments based on covariate-adjusted biased coin design as proposed by Baldi Antognini A, Zagoraiou M (2011) &lt;doi:10.1093/biomet/asr021&gt;. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">AdjBCD(data, a = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame. A row of the dataframe corresponds to the covariate profile of a patient.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>a design parameter governing the degree of randomness. The default is <code>3</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Consider <code class="reqn">I</code> covaraites and <code class="reqn">m_i</code> levels for the <code class="reqn">i</code>th covariate, <code class="reqn">i=1,\ldots,I</code>. <code class="reqn">T_j</code> is the assignment of the <code class="reqn">j</code>th patient and <code class="reqn">Z_j = (k_1,\dots,k_I)</code> indicates the covariate profile of the <code class="reqn">j</code>th patient, <code class="reqn">j=1,\ldots,n</code>. For convenience, <code class="reqn">(k_1,\dots,k_I)</code> and <code class="reqn">(i;k_i)</code> denote stratum and margin, respectively. <code class="reqn">D_j(.)</code> is the difference between numbers of patients assigned to treatment <code class="reqn">1</code> and treatment <code class="reqn">2</code> at the corresponding level after <code class="reqn">j</code> patients have been assigned.
</p>
<p>Let <code class="reqn">F^a</code> be a decreasing and symmetric function of <code class="reqn">D_j(.)</code>, which depends on a design parameter <code class="reqn">a\ge 0</code>. Then, the probability of allocating the <code class="reqn">(j+1)</code>th patient to treatment 1 is <code class="reqn">F^a(D_j(.))</code>, where
</p>
<p style="text-align: center;"><code class="reqn">F^a(x)=\frac{1}{x^a + 1},</code>
</p>
<p>  for <code class="reqn">x\ge 1</code>,
</p>
<p style="text-align: center;"><code class="reqn">F^a(x)=1 / 2, </code>
</p>
<p> for <code class="reqn"> x = 0</code>, and
</p>
<p style="text-align: center;"><code class="reqn">F^a(x)=\frac{|x|^a}{|x|^a + 1}, </code>
</p>
<p> for <code class="reqn">x\le -1.</code>
As <code class="reqn">a</code> goes to <code class="reqn">\infty</code>, the design becomes more deteministic.
</p>
<p>Details of the procedure can be found in Baldi Antognini and M. Zagoraiou (2011).
</p>


<h3>Value</h3>

<p>It returns an object of <code>class</code> <code>"carandom"</code>. 
</p>
<p>An object of class <code>"carandom"</code> is a list containing the following components: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>datanumeric</code></td>
<td>
<p>a bool indicating whether the data is a numeric data frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariates</code></td>
<td>
<p>a character string giving the name(s) of the included covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strt_num</code></td>
<td>
<p>the number of strata.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov_num</code></td>
<td>
<p>the number of covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level_num</code></td>
<td>
<p>a vector of level numbers for each covariate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>the number of patients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Cov_Assig</code></td>
<td>
<p>a <code>(cov_num + 1) * n</code> matrix containing covariate profiles for all patients and the corresponding assignments. The <code class="reqn">i</code>th column represents the <code class="reqn">i</code>th patient. The first <code>cov_num</code> rows include patients' covariate profiles, and the last row contains the assignments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>assignments</code></td>
<td>
<p>the randomization sequence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>All strata</code></td>
<td>
<p>a matrix containing all strata involved.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Diff</code></td>
<td>
<p>a matrix with only one column. There are final differences at the overall, within-stratum, and within-covariate-margin levels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string describing the randomization procedure to be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Data Type</code></td>
<td>
<p>a character string giving the data type, <code>Real</code> or <code>Simulated</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>framework</code></td>
<td>
<p>the framework of the used randomization procedure: stratified randomization, or model-based method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>the data frame.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Baldi Antognini A, Zagoraiou M. <em>The covariate-adaptive biased coin design for balancing clinical trials in the presence of prognostic factors</em>[J]. Biometrika, 2011, 98(3): 519-535.
</p>
<p>Ma W, Ye X, Tu F, Hu F. <em>carat: Covariate-Adaptive Randomization for Clinical Trials</em>[J]. Journal of Statistical Software, 2023, 107(2): 1-47. 
</p>


<h3>See Also</h3>

<p>See <code>AdjBCD.sim</code> for allocating patients with covariate data generating mechanism; 
See <code>AdjBCD.ui</code> for the command-line user interface.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># a simple use
## Real Data
## create a dataframe
df &lt;- data.frame("gender" = sample(c("female", "male"), 1000, TRUE, c(1 / 3, 2 / 3)), 
                 "age" = sample(c("0-30", "30-50", "&gt;50"), 1000, TRUE), 
                 "jobs" = sample(c("stu.", "teac.", "others"), 1000, TRUE), 
                 stringsAsFactors = TRUE)
Res &lt;- AdjBCD(df, a = 2)
## view the output
Res

  ## view all patients' profile and assignments
  Res$Cov_Assig
  

## Simulated Data
n &lt;- 1000
cov_num &lt;- 3
level_num &lt;- c(2, 3, 5) 
# Set pr to follow two tips:
#(1) length of pr should be sum(level_num);
#(2) sum of probabilities for each margin should be 1.
pr &lt;- c(0.4, 0.6, 0.3, 0.4, 0.3, rep(0.2, times = 5))
# set the design parameter
a &lt;- 1.8
# obtain result
Res.sim &lt;- AdjBCD.sim(n, cov_num, level_num, pr, a)

  # view the assignments of patients
  Res.sim$Cov_Assig[cov_num + 1, ]
  # view the differences between treatment 1 and treatment 2 at all levels
  Res.sim$Diff
  
</code></pre>


</div>