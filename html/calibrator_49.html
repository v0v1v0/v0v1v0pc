<div class="container">

<table style="width: 100%;"><tr>
<td>prob.psi1</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>A priori probability of psi1, psi2, and theta</h2>

<h3>Description</h3>

<p>Function to determine the a-priori probability of <code class="reqn">\psi_1</code>
and <code class="reqn">\psi_2</code> of the hyperparameters, and <code class="reqn">\theta</code>,
given the apriori means  and standard deviations.
</p>
<p>Function <code>sample.theta()</code> samples <code class="reqn">\theta</code> from its prior distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">prob.psi1(phi,lognormally.distributed=TRUE)
prob.psi2(phi,lognormally.distributed=TRUE)
prob.theta(theta,phi,lognormally.distributed=FALSE)
sample.theta(n=1,phi)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>Hyperparameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>Parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lognormally.distributed</code></td>
<td>
<p>Boolean variable with 
<code>FALSE</code> meaning to assume a Gaussian distribution and <code>TRUE</code>
meaning to use a lognormal distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>In function <code>sample.theta()</code>, the number of observations
to take</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>These functions use package <code>mvtnorm</code> to calculate the
probability density under the assumption that the PDF is lognormal.
One implication would be that <code>phi$psi2.apriori$mean</code>
and <code>phi$psi1.apriori$mean</code> are the means of the
<strong>logarithms</strong> of the elements of <code>psi1</code> and <code>psi2</code>
(which are thus assumed to be positive).  The <code>sigma</code> matrix is
the covariance matrix of the logarithms as well.
</p>
<p>In these functions, interpretation of argument <code>phi</code> depends on
the value of Boolean argument <code>lognormally.distributed</code>.  Take
<code>prob.theta()</code> as an example.  If <code>lognormally.distributed</code>
is <code>TRUE</code>, then <code>log(theta)</code> is normally distributed with
mean <code>phi$theta.aprior$mean</code> and variance
<code>phi$theta.apriori$sigma</code>.  If <code>FALSE</code>, <code>theta</code> is
normally distributed with mean <code>phi$theta.aprior$mean</code> and
variance <code>phi$theta.apriori$sigma</code>.
</p>
<p>Interpretation of <code>phi$theta.aprior$mean</code> depends on the value of
<code>lognormally.distributed</code>: if <code>TRUE</code> it is the expected
value of <code>log(theta)</code>; if <code>FALSE</code>, it is the expectation of
<code>theta</code>.
</p>
<p>The reason that <code>prob.theta</code> has a different default value for
<code>lognormally.distributed</code> is that some elements of <code>theta</code>
might be negative, contraindicating a lognormal distribution
</p>


<h3>Author(s)</h3>

<p>Robin K. S. Hankin</p>


<h3>References</h3>


<ul>
<li>
<p>M. C. Kennedy and A. O'Hagan 2001. <em>Bayesian
calibration of computer models</em>.  Journal of the Royal Statistical
Society B, 63(3) pp425-464
</p>
</li>
<li>
<p>M. C. Kennedy and A. O'Hagan 2001.  <em>Supplementary details on
Bayesian calibration of computer models</em>, Internal report, University
of Sheffield.  Available at
<a href="http://www.tonyohagan.co.uk/academic/ps/calsup.ps">http://www.tonyohagan.co.uk/academic/ps/calsup.ps</a>
</p>
</li>
<li>
<p>R. K. S. Hankin 2005. <em>Introducing BACCO, an R bundle for
Bayesian analysis of computer code output</em>, Journal of Statistical
Software, 14(16)
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>p.eqn4.supp</code>, <code>stage1</code>, <code>p.eqn8.supp</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(toys)
prob.psi1(phi=phi.toy)
prob.psi2(phi=phi.toy)

prob.theta(theta=theta.toy,phi=phi.toy)

sample.theta(n=4,phi=phi.toy)

</code></pre>


</div>