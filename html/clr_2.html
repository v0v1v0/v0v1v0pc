<div class="container">

<table style="width: 100%;"><tr>
<td>clr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Curve Linear Regression via dimension reduction</h2>

<h3>Description</h3>

<p>Fits a curve linear regression (CLR) model to data, using dimension
reduction based on singular value decomposition.
</p>


<h3>Usage</h3>

<pre><code class="language-R">clr(Y, X, clust = NULL, qx_estimation = list(method = "pctvar", param =
  0.999), ortho_Y = TRUE, qy_estimation = list(method = "pctvar", param
  = 0.999), d_estimation = list(method = "cor", param = 0.5))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>An object of class <code>clrdata</code> or <code>matrix</code>, of the response
curves (one curve a row).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>An object of class <code>clrdata</code> or <code>matrix</code>, of the regressor
curves (one curve a row).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clust</code></td>
<td>
<p>If needed, a list of row indices for each cluster, to obtain
(approximately) homogeneous dependence structure inside each cluster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qx_estimation</code></td>
<td>
<p>A list containing both values for 'method' (among
'ratio', 'ratioM', 'pctvar', 'fixed') and for 'param' (depending on the
selected method), in order to choose how to estimate the dimension of X (in
the sense that its Karhunen-Lo\'eve decomposition has qx terms only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ortho_Y</code></td>
<td>
<p>If TRUE then Y is orthogonalized.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qy_estimation</code></td>
<td>
<p>Same as for qx_estimation, if ortho_Y is set to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d_estimation</code></td>
<td>
<p>A list containing both values for 'method' (among
'ratio', 'pctvar', 'cor') and for 'param' (depending on the
selected method), in order to choose how to estimate the correlation
dimension.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>clr</code>, which can be used to compute
predictions.
This <code>clr</code> object is a list of lists: one list by cluster of data, each
list including:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>The matrix of the residuals of d_hat simple linear
regressions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b_hat</code></td>
<td>
<p>The vector of the estimated coefficient of the d_hat simple
straight line regressions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta</code></td>
<td>
<p>The matrix of the projections of X.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xi</code></td>
<td>
<p>The matrix of the projections of Y.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qx_hat</code></td>
<td>
<p>The estimated dimension of X.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qy_hat</code></td>
<td>
<p>The estimated dimension of Y.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d_hat</code></td>
<td>
<p>The estimated correlation dimension.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X_mean</code></td>
<td>
<p>The mean of the regressor curves.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X_sd</code></td>
<td>
<p>The standard deviation of the regressor curves.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y_mean</code></td>
<td>
<p>The mean of the response curves.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ortho_Y</code></td>
<td>
<p>The value which was selected for ortho_Y.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GAMMA</code></td>
<td>
<p>The standardized transformation for X.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>INV_DELTA</code></td>
<td>
<p>The standardized transformation for Y to predict if ortho_Y
was set to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>The eigenvectors for Y to predict if ortho_Y was set to FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>idx</code></td>
<td>
<p>The indices of the rows selected from X and Y for the current
cluster.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>clr-package</code>, <code>clrdata</code> and
<code>predict.clr</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(clr)
data(gb_load)
data(clust_train)

clr_load &lt;- clrdata(x = gb_load$ENGLAND_WALES_DEMAND,
                    order_by = gb_load$TIMESTAMP,
                    support_grid = 1:48)

## data cleaning: replace zeros with NA
clr_load[rowSums((clr_load == 0) * 1) &gt; 0, ] &lt;- NA
matplot(t(clr_load), ylab = 'Daily loads', type = 'l')

Y &lt;- clr_load[2:nrow(clr_load), ]
X &lt;- clr_load[1:(nrow(clr_load) - 1), ]

begin_pred &lt;- which(substr(rownames(Y), 1, 4) == '2016')[1]
Y_train &lt;- Y[1:(begin_pred - 1), ]
X_train &lt;- X[1:(begin_pred - 1), ]

## Example without any cluster
model &lt;- clr(Y = Y_train, X = X_train)

## Example with clusters
model &lt;- clr(Y = Y_train, X = X_train, clust = clust_train)
</code></pre>


</div>