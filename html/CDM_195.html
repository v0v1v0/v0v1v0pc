<div class="container">

<table style="width: 100%;"><tr>
<td>modelfit.cor</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Assessing Model Fit and Local Dependence by Comparing Observed and Expected
Item Pair Correlations
</h2>

<h3>Description</h3>

<p>This function computes several measures of absolute model fit and local
dependence indices for dichotomous item responses which are
based on comparing observed and expected frequencies of item pairs
(Chen, de la Torre &amp; Zhang, 2013; see Details).
</p>


<h3>Usage</h3>

<pre><code class="language-R">modelfit.cor(data, posterior, probs)
modelfit.cor2(data, posterior, probs)

modelfit.cor.din( dinobj, jkunits=0 )

## S3 method for class 'modelfit.cor.din'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>An <code class="reqn">N \times I</code> data frame of dichotomous item responses
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>posterior</code></td>
<td>

<p>A matrix containing the posterior distribution (e.g. obtained as
an output of the <code>din</code> function).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>

<p>An array of dimension [items,categories,attribute classes]
containing probabilities
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dinobj</code></td>
<td>

<p>An object of class <code>din</code>, <code>gdina</code> or
<code>gdm</code> (only for dichotomous item responses)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>An object of class <code>din</code>, <code>gdina</code> or
<code>gdm</code> (only for dichotomous item responses)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jkunits</code></td>
<td>
<p>Number of Jackknife units. The default is to use 0 units
(no use of jackknifing). If jackknife estimation should be
employed, use (say) at least 20 jackknife units.
The input <code>jkunits</code> can be also a vector of jackknife unit identifiers.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The fit statistics are based on predictions of the pairwise table
<code class="reqn">(X_i, X_j)</code> of item responses. The <code class="reqn">\chi^2</code> statistic <code>X2</code> for
item pairs <code class="reqn">i</code> and <code class="reqn">j</code> is defined as
</p>
<p style="text-align: center;"><code class="reqn"> \chi^2_{ij}=\sum_{k=0}^1 \sum_{l=0}^1 \frac{ (n_{ij,kl}-e_{ij,kl}) ^2 }{ e_{ij,kl} }</code>
</p>

<p>where <code class="reqn">n_{ij,kl}</code> is the absolute frequency of <code class="reqn">\{ X_{i}=k,X_j=l\}</code>
and <code class="reqn">e_{ij,kl}</code> is the expected frequency using the estimated model.
Note that for calculating <code class="reqn">e_{ij,kl}</code>, individual posterior distributions
are evaluated.  The <code class="reqn">\chi^2_{ij} </code> statistic is chi-square distributed with one
degree of freedom and can be used for testing whether items <code class="reqn">i</code> and
<code class="reqn">j</code> are locally dependent. To control for multiple comparisons,
p-value adjustments according to the Holm and FDR method are conducted
(see <code>stats::p.adjust</code>).
</p>


<p>The residual covariance <code>RESIDCOV</code> of item pairs <code class="reqn">(i,j)</code> is calculated
as </p>
<p style="text-align: center;"><code class="reqn"> RESIDCOV_{ij}=
    \frac{ n_{ij,11} n_{ij,00} - n_{ij,10} n_{ij,01} }{n^2 } -
        \frac{ e_{ij,11} e_{ij,00} - e_{ij,10} e_{ij,01} }{n^2 } </code>
</p>

<p>where <code>MRESIDCOV</code> is the average of all <code>RESIDCOV</code> statistics
and is the total sample size.
</p>
<p>The statistic <code>MADcor</code> denotes the average absolute deviation between
observed correlations <code class="reqn">r_{ij}</code> and model predicted correlations
<code class="reqn">\hat{r}_{ij}</code> of item pairs <code class="reqn">(i,j)</code>:
</p>
<p style="text-align: center;"><code class="reqn"> MADcor=\frac{1}{ J(J-1)/2 } \sum_{i &lt; j} | r_{ij} - \hat{r}_{ij} |</code>
</p>

<p>The SRMSR (standardized root mean square root of squared residuals,
Maydeu-Olivares, 2013) is also based on comparing these correlations
</p>
<p style="text-align: center;"><code class="reqn"> SRMSR=\sqrt{ \frac{1}{ J(J-1)/2 } \sum_{i &lt; j}
    ( r_{ij} - \hat{r}_{ij} )^2 } </code>
</p>

<p>For calculating <code>MADQ3</code> and <code>MADaQ3</code>,
residuals <code class="reqn">\varepsilon_{ni}=X_{ni} - e_{ni}</code> of
observed and expected responses for respondents <code class="reqn">n</code> and items <code class="reqn">i</code> are
constructed. Then, the average of the absolute values of pairwise correlations
of these residuals is computed for <code>MADQ3</code>. For <code>MADaQ3</code>, the average
of the centered pairwise values (i.e. by subtracting the average Q3 statistic)
is calculated.
</p>
<p>The difference of Fisher transformed correlations (Chen et al., 2013) is also
computed and used for assessing statistical inference.
</p>
<p>For every of the fit statistics <code>MADcor</code>, <code>MADacor</code>, <code>SRMSR</code>, <code>MX2</code>,
<code>100*MADRESIDCOV</code> and <code>MADQ3</code> it holds that smaller values
(values near to zero) indicate better fit.
</p>
<p>Standard errors and confidence intervals of fit statistics are obtained
by Jackknife estimation.
</p>


<h3>Value</h3>

<p>A list with following entries
</p>
<table>
<tr style="vertical-align: top;">
<td><code>modelfit.stat</code></td>
<td>
<p>Model fit statistics:
</p>
<p><code>MADcor</code>: mean of absolute deviations in observed and expected correlations
(DiBello, Roussos &amp; Stout, 2007)
</p>
<p><code>SRMSR</code>: standardized mean square root of squared residuals
(Maydeu-Olivares, 2013; Maydeu-Olivares &amp; Joe, 2014)
</p>


<p><code>MADRESIDCOV</code>: Mean of absolute deviations of residual covariances
(McDonald &amp; Mok, 1995)
</p>
<p><code>MADQ3</code>: Mean of absolute values of <code class="reqn">Q_3</code> statistic (Yen, 1984)
</p>
<p><code>MADaQ3</code>: Mean of absolute values of centered <code class="reqn">Q_3</code> statistic
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modelfit.test</code></td>
<td>
<p>Test of global absolute model fit using test
statistics of all item pairs. The statistic <code>max(X2)</code> is the
maximum of all <code class="reqn">\chi^2_{ij}</code> statistics accompanied with a p value
obtained by the Holm procedure. A similar statistic <code>abs(fcor)</code>
is created as the absolute value of the deviations of Fisher
transformed correlations as used in Chen et al. (2013).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>itempairs</code></td>
<td>

<p>Fit of itempairs which can be used for inspection of local
dependence. The <code class="reqn">\chi^2_{ij}</code> statistic is denoted by <code>X2</code>
(Chen &amp; Thissen, 1997), the statistic <code class="reqn">r_{ij}</code> based on absolute
deviations of observed and predicted correlations is <code>fcor</code>
(Chen et al., 2013).
</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The function does not handle sample weights properly.
</p>
<p>The function <code>modelfit.cor2</code> has the same functionality as
<code>modelfit.cor</code> but it is much faster because it is based on
<span class="pkg">Rcpp</span> code.
</p>


<h3>References</h3>

<p>Chen, J., de la Torre, J., &amp; Zhang, Z. (2013).
Relative and absolute fit evaluation in cognitive diagnosis modeling.
<em>Journal of Educational Measurement, 50</em>, 123-140.
</p>
<p>Chen, W., &amp; Thissen, D. (1997). Local dependence indexes for item pairs
using item response theory. <em>Journal of Educational and Behavioral Statistics,
22</em>, 265-289.
</p>
<p>DiBello, L. V., Roussos, L. A., &amp; Stout, W. F. (2007). Review of
cognitively diagnostic assessment and a summary of psychometric models.
In C. R. Rao and S. Sinharay (Eds.), <em>Handbook of Statistics</em>,
Vol. 26 (pp. 979â€“1030). Amsterdam: Elsevier.
</p>
<p>Maydeu-Olivares, A. (2013). Goodness-of-fit assessment of item response
theory models (with discussion).
<em>Measurement: Interdisciplinary Research and Perspectives,
11</em>, 71-137.
</p>
<p>Maydeu-Olivares, A., &amp; Joe, H. (2014). Assessing approximate fit in categorical
data analysis. <em>Multivariate Behavioral Research, 49</em>, 305-328.
</p>
<p>McDonald, R. P., &amp; Mok, M. M.-C. (1995). Goodness of fit in item response models.
<em>Multivariate Behavioral Research, 30</em>, 23-40.
</p>
<p>Yen, W. M. (1984). Effects of local item dependence on the fit and equating
performance of the three-parameter logistic model.
<em>Applied Psychological Measurement, 8</em>, 125-145.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
#############################################################################
# EXAMPLE 1: Model fit for sim.dina
#############################################################################

data(sim.dina, package="CDM")
data(sim.qmatrix, package="CDM")
dat &lt;- sim.dina
q.matrix &lt;- sim.qmatrix

#*** Model 1: DINA model for DINA simulated data
mod1 &lt;- CDM::din(dat, q.matrix=q.matrix, rule="DINA" )
fmod1 &lt;- CDM::modelfit.cor.din(mod1, jkunits=10)
summary(fmod1)
  ##   Test of Global Model Fit
  ##          type value     p
  ##   1   max(X2) 8.728 0.113
  ##   2 abs(fcor) 0.143 0.080
  ##
  ##   Fit Statistics
  ##                     est jkunits jk_est jk_se est_low est_upp
  ##   MADcor          0.030      10  0.020 0.005   0.010   0.030
  ##   SRMSR           0.040      10  0.023 0.006   0.011   0.035
  ##   100*MADRESIDCOV 0.671      10  0.445 0.125   0.200   0.690
  ##   MADQ3           0.062      10  0.037 0.008   0.021   0.052
  ##   MADaQ3          0.059      10  0.034 0.008   0.019   0.050

# look at first five item pairs with highest degree of local dependence
itempairs &lt;- fmod1$itempairs
itempairs &lt;- itempairs[ order( itempairs$X2, decreasing=TRUE ), ]
itempairs[ 1:5, c("item1","item2", "X2", "X2_p", "X2_p.holm", "Q3") ]
  ##      item1 item2       X2        X2_p X2_p.holm          Q3
  ##   29 Item5 Item8 8.728248 0.003133174 0.1127943 -0.26616414
  ##   32 Item6 Item8 2.644912 0.103881881 1.0000000  0.04873154
  ##   21 Item3 Item9 2.195011 0.138458201 1.0000000  0.05948456
  ##   10 Item2 Item4 1.449106 0.228671389 1.0000000 -0.08036216
  ##   30 Item5 Item9 1.393583 0.237800911 1.0000000 -0.01934420

#*** Model 2: DINO model for DINA simulated data
mod2 &lt;- CDM::din(dat, q.matrix=q.matrix, rule="DINO" )
fmod2 &lt;- CDM::modelfit.cor.din(mod2, jkunits=10 )   # 10 jackknife units
summary(fmod2)
  ##   Test of Global Model Fit
  ##          type  value     p
  ##   1   max(X2) 13.139 0.010
  ##   2 abs(fcor)  0.199 0.001
  ##
  ##   Fit Statistics
  ##                     est jkunits jk_est jk_se est_low est_upp
  ##   MADcor          0.056      10  0.041 0.007   0.026   0.055
  ##   SRMSR           0.072      10  0.045 0.019   0.007   0.083
  ##   100*MADRESIDCOV 1.225      10  0.878 0.183   0.519   1.236
  ##   MADQ3           0.073      10  0.055 0.012   0.031   0.080
  ##   MADaQ3          0.073      10  0.066 0.012   0.042   0.089

#*** Model 3: estimate DINA model with gdina function
mod3 &lt;- CDM::gdina( dat, q.matrix=q.matrix, rule="DINA" )
fmod3 &lt;- CDM::modelfit.cor.din( mod3, jkunits=0 )  # no Jackknife estimation
summary(fmod3)
  ##   Test of Global Model Fit
  ##          type value     p
  ##   1   max(X2) 8.756 0.111
  ##   2 abs(fcor) 0.143 0.078
  ##
  ##   Fit Statistics
  ##                     est
  ##   MADcor          0.030
  ##   SRMSR           0.040
  ##   MX2             0.719
  ##   100*MADRESIDCOV 0.668
  ##   MADQ3           0.062
  ##   MADaQ3          0.059

#############################################################################
# EXAMPLE 2: Simulated Example DINA model
#############################################################################

set.seed(9765)
# specify Q-matrix
Q &lt;- matrix( c(1,0, 0,1, 1,1 ), nrow=3, ncol=2, byrow=TRUE )
q.matrix &lt;- Q[ rep(1:3,4), ]
I &lt;- nrow(q.matrix)

# simulate data
guess &lt;- stats::runif(I, 0, .3 )
slip &lt;- stats::runif( I, 0, .4 )
N &lt;- 150   # number of persons
dat &lt;- CDM::sim.din( N=N, q.matrix=q.matrix, slip=slip, guess=guess )$dat

#*** estmate DINA model
mod1 &lt;- CDM::din( dat, q.matrix=q.matrix, rule="DINA" )
fmod1 &lt;- CDM::modelfit.cor.din(mod1, jkunits=10)
summary(fmod1)
  ##  Test of Global Model Fit
  ##         type  value     p
  ##  1   max(X2) 10.697 0.071
  ##  2 abs(fcor)  0.277 0.026
  ##
  ##  Fit Statistics
  ##                    est jkunits jk_est jk_se est_low est_upp
  ##  MADcor          0.052      10  0.026 0.010   0.006   0.045
  ##  SRMSR           0.074      10  0.048 0.013   0.022   0.074
  ##  100*MADRESIDCOV 1.259      10  0.646 0.213   0.228   1.063
  ##  MADQ3           0.080      10  0.047 0.010   0.027   0.068
  ##  MADaQ3          0.079      10  0.046 0.010   0.027   0.065

## End(Not run)
</code></pre>


</div>