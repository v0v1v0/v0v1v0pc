<div class="container">

<table style="width: 100%;"><tr>
<td>trend</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Determine linear trends.</h2>

<h3>Description</h3>

<p>The function determines the trend from data of a single CM SAF NetCDF input
file basing on a simple linear model. Depending on the file size, this
function could be very time consuming, thus there are two available options.
Option 1 (default) is using an apply approach and will read the whole data in
once. This option is quite fast, but requires enough memory. Option 2 is using
the same calculation, but reads the data pixel by pixel, which is very slow,
but can also be applied for large data files, which would not fit into the
memory at once.
</p>


<h3>Usage</h3>

<pre><code class="language-R">trend(
  var,
  infile,
  outfile,
  option = 1,
  nc34 = 4,
  overwrite = FALSE,
  verbose = FALSE,
  nc = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>
<p>Name of NetCDF variable (character).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>infile</code></td>
<td>
<p>Filename of input NetCDF file. This may include the directory
(character).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outfile</code></td>
<td>
<p>Filename of output NetCDF file. This may include the directory
(character).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>option</code></td>
<td>
<p>The way of data handling. Option = 1 is fast but memory
consuming (default). Option = 2 is slow, but needs much less memory. Input
is either 1 or 2 (numeric).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nc34</code></td>
<td>
<p>NetCDF version of output file. If <code>nc34 = 3</code> the output file will be
in NetCDFv3 format (numeric). Default output is NetCDFv4.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overwrite</code></td>
<td>
<p>logical; should existing output file be overwritten?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical; if TRUE, progress messages are shown</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nc</code></td>
<td>
<p>Alternatively to <code>infile</code> you can specify the input as an
object of class <code>ncdf4</code> (as returned from <code>ncdf4::nc_open</code>).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A NetCDF file including three data layers is written. One layer
(trend1) contains the linear trend multiplied by the number of time steps.
In older versions of the package (&lt;= 1.7) the trend was given in the same
way as trend1. Another layer (trend2) contains just the calculated linear
trend. An additional layer contains a measure for the significance of the
calculated trends, which was derived using the 95 % confidence interval.
The significance is calculated from the lower and upper value of the
95% confidence interval:
lower or upper value &lt; 0: sig = 0 (not significant);
lower and upper value &lt; 0: sig = -1 (negative significant);
lower and upper value &gt; 0: sig = 1  (positive significant)
</p>


<h3>See Also</h3>

<p>Other temporal operators: 
<code>cmsaf.detrend()</code>,
<code>cmsaf.mk.test()</code>,
<code>cmsaf.regres()</code>,
<code>num_above()</code>,
<code>num_below()</code>,
<code>num_equal()</code>,
<code>timavg()</code>,
<code>timmax()</code>,
<code>timmean()</code>,
<code>timmin()</code>,
<code>timpctl()</code>,
<code>timsd()</code>,
<code>timsum()</code>,
<code>trend_advanced()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Create an example NetCDF file with a similar structure as used by CM
## SAF. The file is created with the ncdf4 package.  Alternatively
## example data can be freely downloaded here: &lt;https://wui.cmsaf.eu/&gt;

library(ncdf4)

## create some (non-realistic) example data

lon &lt;- seq(5, 15, 0.5)
lat &lt;- seq(45, 55, 0.5)
time &lt;- seq(as.Date("2000-01-01"), as.Date("2010-12-31"), "month")
origin &lt;- as.Date("1983-01-01 00:00:00")
time &lt;- as.numeric(difftime(time, origin, units = "hour"))
data &lt;- array(250:350, dim = c(21, 21, 132))

## create example NetCDF

x &lt;- ncdim_def(name = "lon", units = "degrees_east", vals = lon)
y &lt;- ncdim_def(name = "lat", units = "degrees_north", vals = lat)
t &lt;- ncdim_def(name = "time", units = "hours since 1983-01-01 00:00:00",
 vals = time, unlim = TRUE)
var1 &lt;- ncvar_def("SIS", "W m-2", list(x, y, t), -1, prec = "short")
vars &lt;- list(var1)
ncnew &lt;- nc_create(file.path(tempdir(),"CMSAF_example_file.nc"), vars)
ncvar_put(ncnew, var1, data)
ncatt_put(ncnew, "lon", "standard_name", "longitude", prec = "text")
ncatt_put(ncnew, "lat", "standard_name", "latitude", prec = "text")
nc_close(ncnew)

## Determine the trend of the example CM SAF NetCDF file and write the
## output to a new file.
trend(var = "SIS", infile = file.path(tempdir(),"CMSAF_example_file.nc"), 
 outfile = file.path(tempdir(),"CMSAF_example_file_trend.nc"))

unlink(c(file.path(tempdir(),"CMSAF_example_file.nc"), 
 file.path(tempdir(),"CMSAF_example_file_trend.nc")))
</code></pre>


</div>