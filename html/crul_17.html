<div class="container">

<table style="width: 100%;"><tr>
<td>HttpRequest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>HTTP request object</h2>

<h3>Description</h3>

<p>Create HTTP requests
</p>


<h3>Details</h3>

<p>This R6 class doesn't do actual HTTP requests as does
<code>HttpClient()</code> - it is for building requests to use for async HTTP
requests in <code>AsyncVaried()</code>
</p>
<p>Note that you can access HTTP verbs after creating an <code>HttpRequest</code>
object, just as you can with <code>HttpClient</code>. See examples for usage.
</p>
<p>Also note that when you call HTTP verbs on a <code>HttpRequest</code> object you
don't need to assign the new object to a variable as the new details
you've added are added to the object itself.
</p>
<p>See <code>HttpClient()</code> for information on parameters.
</p>


<h3>R6 classes</h3>

<p>This is an R6 class from the package <span class="pkg">R6</span>. Find out more
about R6 at <a href="https://r6.r-lib.org/">https://r6.r-lib.org/</a>. After creating an instance of an R6
class (e.g., <code>x &lt;- HttpClient$new(url = "https://hb.opencpu.org")</code>) you can
access values and methods on the object <code>x</code>.
</p>


<h3>Public fields</h3>

<div class="r6-fields">

<dl>
<dt><code>url</code></dt>
<dd>
<p>(character) a url</p>
</dd>
<dt><code>opts</code></dt>
<dd>
<p>(list) named list of curl options</p>
</dd>
<dt><code>proxies</code></dt>
<dd>
<p>a <code>proxy()</code> object</p>
</dd>
<dt><code>auth</code></dt>
<dd>
<p>an <code>auth()</code> object</p>
</dd>
<dt><code>headers</code></dt>
<dd>
<p>(list) named list of headers, see http-headers</p>
</dd>
<dt><code>handle</code></dt>
<dd>
<p>a <code>handle()</code></p>
</dd>
<dt><code>progress</code></dt>
<dd>
<p>only supports <code>httr::progress()</code>, see progress</p>
</dd>
<dt><code>payload</code></dt>
<dd>
<p>resulting payload after request</p>
</dd>
</dl>
</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-HttpRequest-print"><code>HttpRequest$print()</code></a>
</p>
</li>
<li> <p><a href="#method-HttpRequest-new"><code>HttpRequest$new()</code></a>
</p>
</li>
<li> <p><a href="#method-HttpRequest-get"><code>HttpRequest$get()</code></a>
</p>
</li>
<li> <p><a href="#method-HttpRequest-post"><code>HttpRequest$post()</code></a>
</p>
</li>
<li> <p><a href="#method-HttpRequest-put"><code>HttpRequest$put()</code></a>
</p>
</li>
<li> <p><a href="#method-HttpRequest-patch"><code>HttpRequest$patch()</code></a>
</p>
</li>
<li> <p><a href="#method-HttpRequest-delete"><code>HttpRequest$delete()</code></a>
</p>
</li>
<li> <p><a href="#method-HttpRequest-head"><code>HttpRequest$head()</code></a>
</p>
</li>
<li> <p><a href="#method-HttpRequest-verb"><code>HttpRequest$verb()</code></a>
</p>
</li>
<li> <p><a href="#method-HttpRequest-retry"><code>HttpRequest$retry()</code></a>
</p>
</li>
<li> <p><a href="#method-HttpRequest-method"><code>HttpRequest$method()</code></a>
</p>
</li>
<li> <p><a href="#method-HttpRequest-clone"><code>HttpRequest$clone()</code></a>
</p>
</li>
</ul>
<hr>
<a id="method-HttpRequest-print"></a>



<h4>Method <code>print()</code>
</h4>

<p>print method for <code>HttpRequest</code> objects
</p>


<h5>Usage</h5>

<div class="r"><pre>HttpRequest$print(x, ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>x</code></dt>
<dd>
<p>self</p>
</dd>
<dt><code>...</code></dt>
<dd>
<p>ignored</p>
</dd>
</dl>
</div>


<hr>
<a id="method-HttpRequest-new"></a>



<h4>Method <code>new()</code>
</h4>

<p>Create a new <code>HttpRequest</code> object
</p>


<h5>Usage</h5>

<div class="r"><pre>HttpRequest$new(url, opts, proxies, auth, headers, handle, progress)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>url</code></dt>
<dd>
<p>(character) A url. One of <code>url</code> or <code>handle</code> required.</p>
</dd>
<dt><code>opts</code></dt>
<dd>
<p>any curl options</p>
</dd>
<dt><code>proxies</code></dt>
<dd>
<p>a <code>proxy()</code> object</p>
</dd>
<dt><code>auth</code></dt>
<dd>
<p>an <code>auth()</code> object</p>
</dd>
<dt><code>headers</code></dt>
<dd>
<p>named list of headers, see http-headers</p>
</dd>
<dt><code>handle</code></dt>
<dd>
<p>a <code>handle()</code></p>
</dd>
<dt><code>progress</code></dt>
<dd>
<p>only supports <code>httr::progress()</code>, see progress</p>
</dd>
<dt><code>urls</code></dt>
<dd>
<p>(character) one or more URLs</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>A new <code>HttpRequest</code> object
</p>


<hr>
<a id="method-HttpRequest-get"></a>



<h4>Method <code>get()</code>
</h4>

<p>Define a GET request
</p>


<h5>Usage</h5>

<div class="r"><pre>HttpRequest$get(path = NULL, query = list(), disk = NULL, stream = NULL, ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>path</code></dt>
<dd>
<p>URL path, appended to the base URL</p>
</dd>
<dt><code>query</code></dt>
<dd>
<p>query terms, as a named list</p>
</dd>
<dt><code>disk</code></dt>
<dd>
<p>a path to write to. if NULL (default), memory used.
See <code>curl::curl_fetch_disk()</code> for help.</p>
</dd>
<dt><code>stream</code></dt>
<dd>
<p>an R function to determine how to stream data. if
NULL (default), memory used. See <code>curl::curl_fetch_stream()</code>
for help</p>
</dd>
<dt><code>...</code></dt>
<dd>
<p>curl options, only those in the acceptable set from
<code>curl::curl_options()</code> except the following: httpget, httppost, post,
postfields, postfieldsize, and customrequest</p>
</dd>
</dl>
</div>


<hr>
<a id="method-HttpRequest-post"></a>



<h4>Method <code>post()</code>
</h4>

<p>Define a POST request
</p>


<h5>Usage</h5>

<div class="r"><pre>HttpRequest$post(
  path = NULL,
  query = list(),
  body = NULL,
  disk = NULL,
  stream = NULL,
  encode = "multipart",
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>path</code></dt>
<dd>
<p>URL path, appended to the base URL</p>
</dd>
<dt><code>query</code></dt>
<dd>
<p>query terms, as a named list</p>
</dd>
<dt><code>body</code></dt>
<dd>
<p>body as an R list</p>
</dd>
<dt><code>disk</code></dt>
<dd>
<p>a path to write to. if NULL (default), memory used.
See <code>curl::curl_fetch_disk()</code> for help.</p>
</dd>
<dt><code>stream</code></dt>
<dd>
<p>an R function to determine how to stream data. if
NULL (default), memory used. See <code>curl::curl_fetch_stream()</code>
for help</p>
</dd>
<dt><code>encode</code></dt>
<dd>
<p>one of form, multipart, json, or raw</p>
</dd>
<dt><code>...</code></dt>
<dd>
<p>curl options, only those in the acceptable set from
<code>curl::curl_options()</code> except the following: httpget, httppost, post,
postfields, postfieldsize, and customrequest</p>
</dd>
</dl>
</div>


<hr>
<a id="method-HttpRequest-put"></a>



<h4>Method <code>put()</code>
</h4>

<p>Define a PUT request
</p>


<h5>Usage</h5>

<div class="r"><pre>HttpRequest$put(
  path = NULL,
  query = list(),
  body = NULL,
  disk = NULL,
  stream = NULL,
  encode = "multipart",
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>path</code></dt>
<dd>
<p>URL path, appended to the base URL</p>
</dd>
<dt><code>query</code></dt>
<dd>
<p>query terms, as a named list</p>
</dd>
<dt><code>body</code></dt>
<dd>
<p>body as an R list</p>
</dd>
<dt><code>disk</code></dt>
<dd>
<p>a path to write to. if NULL (default), memory used.
See <code>curl::curl_fetch_disk()</code> for help.</p>
</dd>
<dt><code>stream</code></dt>
<dd>
<p>an R function to determine how to stream data. if
NULL (default), memory used. See <code>curl::curl_fetch_stream()</code>
for help</p>
</dd>
<dt><code>encode</code></dt>
<dd>
<p>one of form, multipart, json, or raw</p>
</dd>
<dt><code>...</code></dt>
<dd>
<p>curl options, only those in the acceptable set from
<code>curl::curl_options()</code> except the following: httpget, httppost, post,
postfields, postfieldsize, and customrequest</p>
</dd>
</dl>
</div>


<hr>
<a id="method-HttpRequest-patch"></a>



<h4>Method <code>patch()</code>
</h4>

<p>Define a PATCH request
</p>


<h5>Usage</h5>

<div class="r"><pre>HttpRequest$patch(
  path = NULL,
  query = list(),
  body = NULL,
  disk = NULL,
  stream = NULL,
  encode = "multipart",
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>path</code></dt>
<dd>
<p>URL path, appended to the base URL</p>
</dd>
<dt><code>query</code></dt>
<dd>
<p>query terms, as a named list</p>
</dd>
<dt><code>body</code></dt>
<dd>
<p>body as an R list</p>
</dd>
<dt><code>disk</code></dt>
<dd>
<p>a path to write to. if NULL (default), memory used.
See <code>curl::curl_fetch_disk()</code> for help.</p>
</dd>
<dt><code>stream</code></dt>
<dd>
<p>an R function to determine how to stream data. if
NULL (default), memory used. See <code>curl::curl_fetch_stream()</code>
for help</p>
</dd>
<dt><code>encode</code></dt>
<dd>
<p>one of form, multipart, json, or raw</p>
</dd>
<dt><code>...</code></dt>
<dd>
<p>curl options, only those in the acceptable set from
<code>curl::curl_options()</code> except the following: httpget, httppost, post,
postfields, postfieldsize, and customrequest</p>
</dd>
</dl>
</div>


<hr>
<a id="method-HttpRequest-delete"></a>



<h4>Method <code>delete()</code>
</h4>

<p>Define a DELETE request
</p>


<h5>Usage</h5>

<div class="r"><pre>HttpRequest$delete(
  path = NULL,
  query = list(),
  body = NULL,
  disk = NULL,
  stream = NULL,
  encode = "multipart",
  ...
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>path</code></dt>
<dd>
<p>URL path, appended to the base URL</p>
</dd>
<dt><code>query</code></dt>
<dd>
<p>query terms, as a named list</p>
</dd>
<dt><code>body</code></dt>
<dd>
<p>body as an R list</p>
</dd>
<dt><code>disk</code></dt>
<dd>
<p>a path to write to. if NULL (default), memory used.
See <code>curl::curl_fetch_disk()</code> for help.</p>
</dd>
<dt><code>stream</code></dt>
<dd>
<p>an R function to determine how to stream data. if
NULL (default), memory used. See <code>curl::curl_fetch_stream()</code>
for help</p>
</dd>
<dt><code>encode</code></dt>
<dd>
<p>one of form, multipart, json, or raw</p>
</dd>
<dt><code>...</code></dt>
<dd>
<p>curl options, only those in the acceptable set from
<code>curl::curl_options()</code> except the following: httpget, httppost, post,
postfields, postfieldsize, and customrequest</p>
</dd>
</dl>
</div>


<hr>
<a id="method-HttpRequest-head"></a>



<h4>Method <code>head()</code>
</h4>

<p>Define a HEAD request
</p>


<h5>Usage</h5>

<div class="r"><pre>HttpRequest$head(path = NULL, ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>path</code></dt>
<dd>
<p>URL path, appended to the base URL</p>
</dd>
<dt><code>...</code></dt>
<dd>
<p>curl options, only those in the acceptable set from
<code>curl::curl_options()</code> except the following: httpget, httppost, post,
postfields, postfieldsize, and customrequest</p>
</dd>
</dl>
</div>


<hr>
<a id="method-HttpRequest-verb"></a>



<h4>Method <code>verb()</code>
</h4>

<p>Use an arbitrary HTTP verb supported on this class
Supported verbs: get, post, put, patch, delete, head
</p>


<h5>Usage</h5>

<div class="r"><pre>HttpRequest$verb(verb, ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>verb</code></dt>
<dd>
<p>an HTTP verb supported on this class: get,
post, put, patch, delete, head. Also supports retry.</p>
</dd>
<dt><code>...</code></dt>
<dd>
<p>curl options, only those in the acceptable set from
<code>curl::curl_options()</code> except the following: httpget, httppost, post,
postfields, postfieldsize, and customrequest</p>
</dd>
</dl>
</div>



<h5>Examples</h5>

<div class="r example copy">
<pre>z &lt;- HttpRequest$new(url = "https://hb.opencpu.org/get")
res &lt;- z$verb('get', query = list(hello = "world"))
res$payload
</pre>
</div>


<hr>
<a id="method-HttpRequest-retry"></a>



<h4>Method <code>retry()</code>
</h4>

<p>Define a RETRY request
</p>


<h5>Usage</h5>

<div class="r"><pre>HttpRequest$retry(
  verb,
  ...,
  pause_base = 1,
  pause_cap = 60,
  pause_min = 1,
  times = 3,
  terminate_on = NULL,
  retry_only_on = NULL,
  onwait = NULL
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>verb</code></dt>
<dd>
<p>an HTTP verb supported on this class: get,
post, put, patch, delete, head. Also supports retry.</p>
</dd>
<dt><code>...</code></dt>
<dd>
<p>curl options, only those in the acceptable set from
<code>curl::curl_options()</code> except the following: httpget, httppost, post,
postfields, postfieldsize, and customrequest</p>
</dd>
<dt><code>pause_base, pause_cap, pause_min</code></dt>
<dd>
<p>basis, maximum, and minimum for
calculating wait time for retry. Wait time is calculated according to the
exponential backoff with full jitter algorithm. Specifically, wait time is
chosen randomly between <code>pause_min</code> and the lesser of <code>pause_base * 2</code> and
<code>pause_cap</code>, with <code>pause_base</code> doubling on each subsequent retry attempt.
Use <code>pause_cap = Inf</code> to not terminate retrying due to cap of wait time
reached.</p>
</dd>
<dt><code>times</code></dt>
<dd>
<p>the maximum number of times to retry. Set to <code>Inf</code> to
not stop retrying due to exhausting the number of attempts.</p>
</dd>
<dt><code>terminate_on, retry_only_on</code></dt>
<dd>
<p>a vector of HTTP status codes. For
<code>terminate_on</code>, the status codes for which to terminate retrying, and for
<code>retry_only_on</code>, the status codes for which to retry the request.</p>
</dd>
<dt><code>onwait</code></dt>
<dd>
<p>a callback function if the request will be retried and
a wait time is being applied. The function will be passed two parameters,
the response object from the failed request, and the wait time in seconds.
Note that the time spent in the function effectively adds to the wait time,
so it should be kept simple.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-HttpRequest-method"></a>



<h4>Method <code>method()</code>
</h4>

<p>Get the HTTP method (if defined)
</p>


<h5>Usage</h5>

<div class="r"><pre>HttpRequest$method()</pre></div>



<h5>Returns</h5>

<p>(character) the HTTP method
</p>


<hr>
<a id="method-HttpRequest-clone"></a>



<h4>Method <code>clone()</code>
</h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>HttpRequest$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt>
<dd>
<p>Whether to make a deep clone.</p>
</dd>
</dl>
</div>




<h3>See Also</h3>

<p>http-headers, writing-options
</p>
<p>Other async: 
<code>Async</code>,
<code>AsyncQueue</code>,
<code>AsyncVaried</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
x &lt;- HttpRequest$new(url = "https://hb.opencpu.org/get")
## note here how the HTTP method is shown on the first line to the right
x$get()

## assign to a new object to keep the output
z &lt;- x$get()
### get the HTTP method
z$method()

(x &lt;- HttpRequest$new(url = "https://hb.opencpu.org/get")$get())
x$url
x$payload

(x &lt;- HttpRequest$new(url = "https://hb.opencpu.org/post"))
x$post(body = list(foo = "bar"))

HttpRequest$new(
  url = "https://hb.opencpu.org/get",
  headers = list(
    `Content-Type` = "application/json"
  )
)

# retry
(x &lt;- HttpRequest$new(url = "https://hb.opencpu.org/post"))
x$retry("post", body = list(foo = "bar"))

## End(Not run)

## ------------------------------------------------
## Method `HttpRequest$verb`
## ------------------------------------------------

z &lt;- HttpRequest$new(url = "https://hb.opencpu.org/get")
res &lt;- z$verb('get', query = list(hello = "world"))
res$payload
</code></pre>


</div>