<div class="container">

<table style="width: 100%;"><tr>
<td>crossval</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generic Function for Cross Valdidation </h2>

<h3>Description</h3>

<p><code>crossval</code> performs K-fold cross validation with B repetitions.  If <code>Y</code> is a factor then balanced sampling is used (i.e. in each fold each category is represented in appropriate proportions).
</p>


<h3>Usage</h3>

<pre><code class="language-R">crossval(predfun, X, Y, K=10, B=20, verbose=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>predfun</code></td>
<td>
<p>Prediction function (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Matrix of predictors (columns correspond to variables).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Univariate response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>Number of folds.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>Number of repetitions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>If <code>verbose=TRUE</code> then status messages appear during cross validation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments for <code>predfun</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The argument <code>predfun</code> must be a function of the form 
<code>predfun(Xtrain, Ytrain, Xtest, Ytest, ...)</code>.  
</p>


<h3>Value</h3>

<p><code>crossval</code> returns a list with three entries:
</p>
<p>stat.cv:  the statistic returned by predfun for each cross validation run.
</p>
<p>stat: the statistic returned by predfun averaged over all cross validation runs.
</p>
<p>stat.se: the corresponding standard error.
</p>


<h3>Author(s)</h3>

<p>Korbinian Strimmer (<a href="https://strimmerlab.github.io">https://strimmerlab.github.io</a>).
</p>


<h3>See Also</h3>

<p><code>confusionMatrix</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R"># load "crossval" package
library("crossval")

# classification examples

# set up lda prediction function
predfun.lda = function(train.x, train.y, test.x, test.y, negative)
{
  require("MASS") # for lda function

  lda.fit = lda(train.x, grouping=train.y)
  ynew = predict(lda.fit, test.x)$class

  # count TP, FP etc.
  out = confusionMatrix(test.y, ynew, negative=negative)

  return( out )
}


# Student's Sleep Data
data(sleep)
X = as.matrix(sleep[,1, drop=FALSE]) # increase in hours of sleep 
Y = sleep[,2] # drug given 
plot(X ~ Y)
levels(Y) # "1" "2"
dim(X) # 20  1

set.seed(12345)
cv.out = crossval(predfun.lda, X, Y, K=5, B=20, negative="1")

cv.out$stat
diagnosticErrors(cv.out$stat)


# linear regression example

data("attitude")
y = attitude[,1] # rating variable
x = attitude[,-1] # date frame with the remaining variables
is.factor(y) # FALSE

summary( lm(y ~ . , data=x) )

# set up lm prediction function
predfun.lm = function(train.x, train.y, test.x, test.y)
{
  lm.fit = lm(train.y ~ . , data=train.x)
  ynew = predict(lm.fit, test.x )

  # compute squared error risk (MSE)
  out = mean( (ynew - test.y)^2 )

  return( out )
}


# prediction MSE using all variables
set.seed(12345)
cv.out = crossval(predfun.lm, x, y, K=5, B=20)
c(cv.out$stat, cv.out$stat.se)

# and only two variables
cv.out = crossval(predfun.lm, x[,c(1,3)], y, K=5, B=20)
c(cv.out$stat, cv.out$stat.se) 



# for more examples (e.g. using cross validation in a regression or classification context)
# see the R packages "sda", "care", or "binda".

</code></pre>


</div>