<div class="container">

<table style="width: 100%;"><tr>
<td>Plot2WayANOVA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot a 2 Way ANOVA using dplyr and ggplot2</h2>

<h3>Description</h3>

<p>Takes a formula and a dataframe as input, conducts an analysis of variance
prints the results (AOV summary table, table of overall model information
and table of means) then uses ggplot2 to plot an interaction graph (line
or bar) .  Also uses Brown-Forsythe test for homogeneity of
variance.  Users can also choose to save the plot out as a png file.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Plot2WayANOVA(formula,
               dataframe = NULL,
               confidence=.95,
               plottype = "line",
               errorbar.display = "CI",
               xlab = NULL,
               ylab = NULL,
               title = NULL,
               subtitle = NULL,
               interact.line.size = 2,
               ci.line.size = 1,
               mean.label = FALSE,
               mean.ci = TRUE,
               mean.size = 4,
               mean.shape = 23,
               mean.color = "darkred",
               mean.label.size = 3,
               mean.label.color = "black",
               offset.style = "none",
               overlay.type = NULL,
               posthoc.method = "scheffe",
               show.dots = FALSE,
               PlotSave = FALSE,
               ggtheme = ggplot2::theme_bw(),
               package = "RColorBrewer",
               palette = "Dark2",
               ggplot.component = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula with a numeric dependent (outcome) variable,
and two independent (predictor) variables e.g. <code>mpg ~ am * vs</code>.
The independent variables are coerced to factors (with warning) if
possible.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataframe</code></td>
<td>
<p>a dataframe or an object that can be coerced to a dataframe</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>confidence</code></td>
<td>
<p>what confidence level for confidence intervals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plottype</code></td>
<td>
<p>bar or line (quoted)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>errorbar.display</code></td>
<td>
<p>default "CI" (confidence interval), which type of
errorbar should be displayed around the mean point? Other options
include "SEM" (standard error of the mean) and "SD" (standard dev).
"none" removes it entirely much like <code>interaction.plot</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab</code></td>
<td>
<p>Labels for 'x' and 'y' axis variables. If 'NULL' (default),
variable names for 'x' and 'y' will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>The text for the plot title. A generic default is provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subtitle</code></td>
<td>
<p>The text for the plot subtitle. If 'NULL' (default), key
model information is provided as a subtitle.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interact.line.size</code></td>
<td>
<p>Line size for the line connecting the group means
(Default: '2').</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci.line.size</code></td>
<td>
<p>Line size for the confidence interval bracketing
the group means (Default: '1').</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.label</code></td>
<td>
<p>Logical that decides whether the value of the group
mean is to be displayed (Default: 'FALSE').</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.ci</code></td>
<td>
<p>Logical that decides whether the confidence interval for
group means is to be displayed (Default: 'TRUE').</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.size</code></td>
<td>
<p>Point size for the data point corresponding to mean
(Default: '4').</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.shape</code></td>
<td>
<p>Shape of the plot symbol for the mean
(Default: '23' which is a diamond).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.color</code></td>
<td>
<p>Color for the data point corresponding to mean (Default:
'"darkred"').</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.label.size, mean.label.color</code></td>
<td>
<p>Aesthetics for
the label displaying mean. Defaults: '3', '"black"', respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset.style</code></td>
<td>
<p>A character string (e.g., '"wide"' or '"narrow"',
or '"none"') which controls whether items are offset from the
centerline for clarity. Useful when you want to add individual
datapoints or confdence interval lines overlap. (Default: '"none"').</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overlay.type</code></td>
<td>
<p>A character string (e.g., '"box"' or '"violin"'),
if you wish to overlay that information on factor1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>posthoc.method</code></td>
<td>
<p>A character string, one of "hsd", "bonf", "lsd",
"scheffe", "newmankeuls", defining the method for the pairwise comparisons.
(Default: '"scheffe"').</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.dots</code></td>
<td>
<p>Logical that decides whether the individual data points
are displayed (Default: 'FALSE').</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PlotSave</code></td>
<td>
<p>a logical indicating whether the user wants to save the plot
as a png file</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ggtheme</code></td>
<td>
<p>A function, ggplot2 theme name. Default value is ggplot2::theme_bw().
Any of the ggplot2 themes, or themes from extension packages are allowed (e.g.,
hrbrthemes::theme_ipsum(), etc.).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>package</code></td>
<td>
<p>Name of package from which the palette is desired as string
or symbol.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>palette</code></td>
<td>
<p>Name of palette as string or symbol.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ggplot.component</code></td>
<td>
<p>A ggplot component to be added to the plot prepared.
The default is NULL. The argument should be entered as a function.
for example to change the size and color of the x axis text you use:
'ggplot.component = theme(axis.text.x = element_text(size=13, color="darkred"))'
depending on what theme is in use the ggplot component might not work as expected.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Details about how the function works in order of steps taken.
</p>

<ol>
<li>
<p> Some basic error checking to ensure a valid formula and dataframe.
Only accepts fully *crossed* formula to check for interaction term
</p>
</li>
<li>
<p> Ensure the dependent (outcome) variable is numeric and that the two
independent (predictor) variables are or can be coerced to factors – user
warned on the console
</p>
</li>
<li>
<p> Remove missing cases – user warned on the console
</p>
</li>
<li>
<p> Calculate a summarized table of means, sds, standard errors of the
means, confidence intervals, and group sizes.
</p>
</li>
<li>
<p> Use <code>aov</code> function to execute an Analysis of
Variance (ANOVA)
</p>
</li>
<li>
<p> Use <code>sjstats::anova_stats</code> to calculate eta squared
and omega squared values per factor. If the design is unbalanced warn
the user and use Type II sums of squares
</p>
</li>
<li>
<p> Produce a standard ANOVA table with additional columns
</p>
</li>
<li>
<p> Use the <code>PostHocTest</code> for producing a table
of post hoc comparisons for all effects that were significant
</p>
</li>
<li>
<p> Testing Homogeneity
of Variance assumption with Brown-Forsythe test
</p>
</li>
<li>
<p> Use the <code>PostHocTest</code> for conducting
post hoc tests for effects that were significant
</p>
</li>
<li>
<p> Use the <code>shapiro.test</code> for testing normality
assumption with Shapiro-Wilk
</p>
</li>
<li>
<p> Use <code>ggplot2</code> to plot an interaction plot of the type the
user specified.</p>
</li>
</ol>
<p>The defaults are deliberately constructed to emphasize the nature
of the interaction rather than focusing on distributions. So
while a violin plot of the first factor by level is displayed
along with dots for individual data points shaded by the second
factor, the emphasis is on the interaction lines.
</p>


<h3>Value</h3>

<p>A list with 5 elements which is returned invisibly. These items
are always sent to the console for display but for user convenience
the function also returns a named list with the following items
in case the user desires to save them or further process them -
<code>$ANOVATable</code>, <code>$ModelSummary</code>, <code>$MeansTable</code>,
<code>$PosthocTable</code>, <code>$BFTest</code>, and <code>$SWTest</code>.
The plot is always sent to the default plot device
</p>


<h3>Author(s)</h3>

<p>Chuck Powell
</p>


<h3>References</h3>

<p>: ANOVA: Delacre, Leys, Mora, &amp; Lakens, *PsyArXiv*, 2018
</p>


<h3>See Also</h3>

<p><code>aov</code>, <code>BrownForsytheTest</code>,
<code>sjstats::anova_stats</code>, <code>replications</code>,
<code>shapiro.test</code>, <code>interaction.plot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
Plot2WayANOVA(mpg ~ am * cyl, mtcars, plottype = "line")
Plot2WayANOVA(mpg ~ am * cyl,
  mtcars,
  plottype = "line",
  overlay.type = "box",
  mean.label = TRUE
)

library(ggplot2)
Plot2WayANOVA(mpg ~ am * vs, 
  mtcars, 
  confidence = .99,
  ggplot.component = theme(axis.text.x = element_text(size=13, color="darkred")))
  
</code></pre>


</div>