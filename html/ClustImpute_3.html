<div class="container">

<table style="width: 100%;"><tr>
<td>ClustImpute</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>K-means clustering with build-in missing data imputation</h2>

<h3>Description</h3>

<p>Clustering algorithm that produces a missing value imputation using  on the go. The (local) imputation distribution is defined by the currently assigned cluster. The first draw is by random imputation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ClustImpute(
  X,
  nr_cluster,
  nr_iter = 10,
  c_steps = 1,
  wf = default_wf,
  n_end = 10,
  seed_nr = 150519,
  assign_with_wf = TRUE,
  shrink_towards_global_mean = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Data frame with only numeric values or NAs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nr_cluster</code></td>
<td>
<p>Number of clusters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nr_iter</code></td>
<td>
<p>Iterations of procedure</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c_steps</code></td>
<td>
<p>Number of clustering steps per iteration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wf</code></td>
<td>
<p>Weight function. Linear up to n_end by default. Used to shrink X towards zero or the global mean (default). See shrink_towards_global_mean</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_end</code></td>
<td>
<p>Steps until convergence of weight function to 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed_nr</code></td>
<td>
<p>Number for set.seed()</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>assign_with_wf</code></td>
<td>
<p>Default is TRUE. If set to False, then the weight function is only applied in the centroid computation, but ignored in the cluster assignment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shrink_towards_global_mean</code></td>
<td>
<p>By default TRUE. The weight matrix w is applied on the difference of X from the global mean m, i.e, (x-m)*w+m</p>
</td>
</tr>
</table>
<h3>Value</h3>


<dl>
<dt>complete_data</dt>
<dd>
<p>Completed data without NAs</p>
</dd>
<dt>clusters</dt>
<dd>
<p>For each row of complete_data, the associated cluster</p>
</dd>
<dt>centroids</dt>
<dd>
<p>For each cluster, the coordinates of the centroids in tidy format</p>
</dd>
<dt>centroids_matrix</dt>
<dd>
<p>For each cluster, the coordinates of the centroids in matrix format</p>
</dd>
<dt>imp_values_mean</dt>
<dd>
<p>Mean of the imputed variables per draw</p>
</dd>
<dt>imp_values_sd</dt>
<dd>
<p>Standard deviation of the imputed variables per draw</p>
</dd>
</dl>
<h3>Examples</h3>

<pre><code class="language-R"># Random Dataset
set.seed(739)
n &lt;- 750 # numer of points
nr_other_vars &lt;- 2
mat &lt;- matrix(rnorm(nr_other_vars*n),n,nr_other_vars)
me&lt;-4 # mean
x &lt;- c(rnorm(n/3,me/2,1),rnorm(2*n/3,-me/2,1))
y &lt;- c(rnorm(n/3,0,1),rnorm(n/3,me,1),rnorm(n/3,-me,1))
dat &lt;- cbind(mat,x,y)
dat&lt;- as.data.frame(scale(dat)) # scaling

# Create NAs
dat_with_miss &lt;- miss_sim(dat,p=.1,seed_nr=120)

# Run ClustImpute
res &lt;- ClustImpute(dat_with_miss,nr_cluster=3)

# Plot complete data set and cluster assignment
ggplot2::ggplot(res$complete_data,ggplot2::aes(x,y,color=factor(res$clusters))) +
ggplot2::geom_point()

# View centroids
res$centroids

</code></pre>


</div>