<div class="container">

<table style="width: 100%;"><tr>
<td>CFO.next</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Determination of the dose level for next cohort in the calibration-free odds (CFO) design for phase I trials</h2>

<h3>Description</h3>

<p>In the CFO design for phase I trials, the function is used to determine the dose movement based on the toxicity outcomes of the enrolled cohorts.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CFO.next(target, cys, cns, currdose, 
       prior.para = list(alp.prior = target, bet.prior = 1 - target),
       cutoff.eli = 0.95, early.stop = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>
<p>the target DLT rate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cys</code></td>
<td>
<p>the cumulative numbers of DLTs observed at the left, current, and right dose levels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cns</code></td>
<td>
<p>the cumulative numbers of patients treated at the left, current, and right dose levels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>currdose</code></td>
<td>
<p>the current dose level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior.para</code></td>
<td>
<p>the prior parameters for a beta distribution, where set as <code>list(alp.prior = target, bet.prior = 1 - target)</code>
by default, <code>alp.prior</code> and <code>bet.prior</code> represent the parameters of the prior distribution for
the true DLT rate at any dose level. This prior distribution is specified as Beta(<code>alpha.prior</code>, <code>beta.prior</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff.eli</code></td>
<td>
<p>the cutoff to eliminate overly toxic doses for safety. We recommend
the default value of <code>cutoff.eli = 0.95</code> for general use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>early.stop</code></td>
<td>
<p>the threshold value for early stopping. The default value <code>early.stop = 0.95</code>
generally works well.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The CFO design determines the dose level for the next cohort by assessing evidence from the current
dose level and its adjacent levels. This evaluation is based on odds ratios denoted as <code class="reqn">O_k</code>, where
<code class="reqn">k = L, C, R</code> represents left, current (central), and right dose levels. Additionally, we define <code class="reqn">\overline{O}_k = 1/O_k</code>.
The ratio <code class="reqn">O_C / \overline{O}_{L}</code> indicates the inclination for de-escalation, while <code class="reqn">\overline{O}_C / O_R</code>
quantifies the tendency for escalation. Threshold values <code class="reqn">\gamma_L</code> and <code class="reqn">\gamma_R</code> are chosen to
minimize the probability of making incorrect decisions. The decision process is summarized in Table 1
of Jin and Yin (2022).
The early stopping and dose elimination rules are implemented to ensure patient safety. If the data suggest excessive
toxicity at the current dose level, we exclude that dose level and those higher levels. If the lowest dose level is overly toxic,
the trial will be terminated according to the early stopping rule.
</p>


<h3>Value</h3>

<p>The <code>CFO.next()</code> function returns a list object comprising the following elements:
</p>

<ul>
<li>
<p> target: the target DLT rate.
</p>
</li>
<li>
<p> cys: the cumulative counts of DLTs observed at the left, current, and right dose levels.
</p>
</li>
<li>
<p> cns: the cumulative counts of patients treated at the left, current, and right dose levels.
</p>
</li>
<li>
<p> decision: the decision in the CFO design, where <code>left</code>, <code>stay</code>, and <code>right</code> represent the
movement directions, and <code>stop</code> indicates stopping the experiment.
</p>
</li>
<li>
<p> currdose: the current dose level.
</p>
</li>
<li>
<p> nextdose: the recommended dose level for the next cohort. <code>nextdose = 99</code> indicates that the trial is
terminated due to early stopping.
</p>
</li>
<li>
<p> overtox: the situation regarding which positions experience over-toxicity. The dose level indicated
by <code>overtox</code> and all the dose levels above experience over-toxicity. <code>overtox = NA</code> signifies that
the occurrence of over-toxicity did not happen.
</p>
</li>
<li>
<p> toxprob: the expected toxicity probability, <code class="reqn">Pr(p_k &gt; \phi | x_k, m_k)</code>, at the left, current, and
right dose levels, where <code class="reqn">p_k</code>, <code class="reqn">x_k</code>, and <code class="reqn">m_k</code> is the dose-limiting toxicity (DLT) rate, the
numbers of observed DLTs, and the numbers of patients at dose level <code class="reqn">k</code>.
</p>
</li>
</ul>
<h3>Note</h3>

<p>When the current dose level is the lowest or highest (i.e., at the boundary), the parts in <code>cys</code>,
<code>cns</code>, and <code>toxprob</code> where there is no data are filled with <code>NA</code>. <br>
The dose level indicated by <code>overtox</code> and all the dose levels above experience over-toxicity, and these dose levels will be eliminated.
</p>


<h3>Author(s)</h3>

<p>Jialu Fang, Wenliang Wang, Ninghao Zhang, and Guosheng Yin
</p>


<h3>References</h3>

<p>Jin H, Yin G (2022). CFO: Calibration-free odds design for phase I/II clinical trials.
<em>Statistical Methods in Medical Research</em>, 31(6), 1051-1066.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## determine the dose level for the next cohort of new patients
cys &lt;- c(0, 1, 0); cns &lt;- c(3, 6, 0)
decision &lt;- CFO.next(target=0.2, cys=cys, cns=cns, currdose=3)
summary(decision)

cys &lt;- c(NA, 3, 0); cns &lt;- c(NA, 3, 0)
decision &lt;- CFO.next(target=0.2, cys=cys, cns=cns, currdose=1)
summary(decision)

cys &lt;- c(0, 3, NA); cns &lt;- c(3, 3, NA)
decision &lt;- CFO.next(target=0.2, cys=cys, cns=cns, currdose=7)
summary(decision)

</code></pre>


</div>