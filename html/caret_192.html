<div class="container">

<table style="width: 100%;"><tr>
<td>pcaNNet</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Neural Networks with a Principal Component Step</h2>

<h3>Description</h3>

<p>Run PCA on a dataset, then use it in a neural network model
</p>


<h3>Usage</h3>

<pre><code class="language-R">pcaNNet(x, ...)

## S3 method for class 'formula'
pcaNNet(
  formula,
  data,
  weights,
  ...,
  thresh = 0.99,
  subset,
  na.action,
  contrasts = NULL
)

## Default S3 method:
pcaNNet(x, y, thresh = 0.99, ...)

## S3 method for class 'pcaNNet'
print(x, ...)

## S3 method for class 'pcaNNet'
predict(object, newdata, type = c("raw", "class", "prob"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>matrix or data frame of <code>x</code> values for examples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments passed to <code>nnet</code>, such as
<code>size</code>, <code>decay</code>, etc.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A formula of the form <code>class ~ x1 + x2 + ...{}</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data frame from which variables specified in <code>formula</code> are
preferentially to be taken.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>(case) weights for each example - if missing defaults to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresh</code></td>
<td>
<p>a threshold for the cumulative proportion of variance to
capture from the PCA analysis. For example, to retain enough PCA components
to capture 95 percent of variation, set <code>thresh = .95</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>An index vector specifying the cases to be used in the
training sample.  (NOTE: If given, this argument must be named.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>A function to specify the action to be taken if <code>NA</code>s
are found. The default action is for the procedure to fail.  An alternative
is na.omit, which leads to rejection of cases with missing values on any
required variable.  (NOTE: If given, this argument must be named.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p>a list of contrasts to be used for some or all of the
factors appearing as variables in the model formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>matrix or data frame of target values for examples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of class <code>pcaNNet</code> as returned by
<code>pcaNNet</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>matrix or data frame of test examples. A vector is considered
to be a row vector comprising a single case.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Type of output</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function first will run principal component analysis on the data. The
cumulative percentage of variance is computed for each principal component.
The function uses the <code>thresh</code> argument to determine how many
components must be retained to capture this amount of variance in the
predictors.
</p>
<p>The principal components are then used in a neural network model.
</p>
<p>When predicting samples, the new data are similarly transformed using the
information from the PCA analysis on the training data and then predicted.
</p>
<p>Because the variance of each predictor is used in the PCA analysis, the code
does a quick check to make sure that each predictor has at least two
distinct values. If a predictor has one unique value, it is removed prior to
the analysis.
</p>


<h3>Value</h3>

<p>For <code>pcaNNet</code>, an object of <code>"pcaNNet"</code> or
<code>"pcaNNet.formula"</code>. Items of interest in the output are: </p>
<table>
<tr style="vertical-align: top;">
<td><code>pc
</code></td>
<td>
<p>the output from <code>preProcess</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model </code></td>
<td>
<p>the model
generated from <code>nnet</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>names </code></td>
<td>
<p>if any predictors had
only one distinct value, this is a character string of the remaining
columns. Otherwise a value of <code>NULL</code></p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>These are heavily based on the <code>nnet</code> code from Brian Ripley.
</p>


<h3>References</h3>

<p>Ripley, B. D. (1996) <em>Pattern Recognition and Neural
Networks.</em> Cambridge.
</p>


<h3>See Also</h3>

<p><code>nnet</code>, <code>preProcess</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(BloodBrain)
modelFit &lt;- pcaNNet(bbbDescr[, 1:10], logBBB, size = 5, linout = TRUE, trace = FALSE)
modelFit

predict(modelFit, bbbDescr[, 1:10])

</code></pre>


</div>