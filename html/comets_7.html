<div class="container">

<table style="width: 100%;"><tr>
<td>plm_equiv_test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Equivalence test for the parameter in a partially linear model</h2>

<h3>Description</h3>

<p>Equivalence test for the parameter in a partially linear model
</p>


<h3>Usage</h3>

<pre><code class="language-R">plm_equiv_test(Y, X, Z, from, to, scale = c("plm", "cov", "cor"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Vector or matrix of response values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Matrix or data.frame of covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>Matrix or data.frame of covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>from</code></td>
<td>
<p>Lower bound of the equivalence margin</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>to</code></td>
<td>
<p>Upper bound of the equivalence margin</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>Scale on which to specify the equivalence margin. Default
<code>"plm"</code> corresponds to the partially linear model parameter
described in the details. <code>"cov"</code> corresponds to the conditional
covariance and <code>"cor"</code> to conditional correlation which lies in
<code class="reqn">[-1, 1]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to <code>gcm</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The partially linear model postulates </p>
<p style="text-align: center;"><code class="reqn">Y = X \theta + g(Z) + \epsilon,</code>
</p>

<p>and the target of inference is theta. The target is closely related to
the conditional covariance between Y and X given Z:
</p>
<p style="text-align: center;"><code class="reqn">\theta = E[cov(X, Y | Z)] / E[Var(X | Z)].</code>
</p>
<p> The equivalence test (based
on the GCM test) tests <code class="reqn">H_0: \theta \not\in [{\tt from}, {\tt to}]</code> versus
<code class="reqn">H_1: \theta \in [{\tt from}, {\tt to}]</code>. Y, X (and theta) can only be
one-dimensional. There are no restrictions on Z. The equivalence test can
also be performed on the conditional covariance scale directly (using
<code>scale = "cov"</code>) or on the conditional correlation scale:
</p>
<p style="text-align: center;"><code class="reqn">E[cov(X, Y | Z)] / \sqrt{E[Var(X | Z)]E[Var(Y | Z)]}</code>
</p>
<p>,
using <code>scale = "cor"</code>.
</p>


<h3>Value</h3>

<p>Object of class '<code>gcm</code>' and '<code>htest</code>'
</p>


<h3>Examples</h3>

<pre><code class="language-R">n &lt;- 150
X &lt;- rnorm(n)
Z &lt;- matrix(rnorm(2 * n), ncol = 2)
colnames(Z) &lt;- c("Z1", "Z2")
Y &lt;- X^2 + Z[, 2] + rnorm(n)
plm_equiv_test(Y, X, Z, from = -1, to = 1)
</code></pre>


</div>