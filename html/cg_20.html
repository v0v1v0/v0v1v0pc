<div class="container">

<table style="width: 100%;"><tr>
<td>comparisonsTable.cgOneFactorFit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Create a table of comparisons amongst groups with the cgOneFactorFit object
</h2>

<h3>Description</h3>

<p>Create a table of comparisons based on the cgOneFactorFit
object. Pairwise or custom specified contrasts are estimated and
tested.  A cgOneFactorComparisonsTable class object is created.    
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'cgOneFactorFit'
comparisonsTable(fit, type="pairwisereflect",
 alpha=0.05, addpct=FALSE, display="print", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fit </code></td>
<td>

<p>An object of class <code>cgOneFactorFit</code>.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type </code></td>
<td>
<p>Can be one of four values:
</p>

<dl>
<dt><code>"pairwisereflect"</code></dt>
<dd>
<p>The default value, it calculates and lists all possible
pairwise comparison permutations, as each pair order is
included. In other words, Groups A vs. B and B vs. A will be
included.
</p>
</dd>
<dt><code>"pairwise"</code></dt>
<dd>
<p>Calculates and lists all possible
pairwise comparison combinations. Once a pair such as Groups
A vs. B is specified, then the reflective B vs. A is not
included. So the number of comparisons is half that produced
by <code>"pairwisereflect"</code>. The ordering of group levels in the
<code>fit</code> object is used to determine which
ordering is included and which is not. If all orderings are
of interest, such as for <code>settings$endptscale=="log"</code> in the fit
objects, use the <code>"pairwisereflect"</code> value above.
</p>
</dd>
<dt><code>"allgroupstocontrol"</code></dt>
<dd>
<p>Takes the value of
<code>settings$refgrp</code> in the <span class="pkg">cg</span> <code>fit</code>
object, deems it the "control" group, and constructs
pairwise comparisons of all other groups to it. This setting is
required when the <code>refgrp</code> argument is specified in the
call (see ...  section below.)
</p>
</dd>
<dt><code>"custom"</code></dt>
<dd>
<p>Indicates the a custom matrix of
comparisons will be constructed, and that matrix needs to be
specified in the <code>contrastmatrix</code> argument.
</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha </code></td>
<td>
<p>Significance level, by default set to <code>0.05</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>addpct </code></td>
<td>
<p>Only relevant if <code>settings$endptscale=="original"</code> in the 
fit object. An column of percent differences is added for the
comparisons, as a descriptive supplement to the original scale
differences that are formally estimated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>display </code></td>
<td>
<p>One of three valid values:
</p>

<dl>
<dt><code>"print"</code></dt>
<dd>
<p>The default value; It calls a <code>print</code> method for the
created <br><code>cgOneFactorComparisonsTable</code> object, which is
a formatted text output of the table(s).
</p>
</dd>
<dt><code>"none"</code></dt>
<dd>
<p>Supresses any printing. Useful, for example, when just assignment
of the resulting object is desired.
</p>
</dd>
<dt><code>"show"</code></dt>
<dd>
<p>Calls the default <code>showDefault</code> method, which
will just print out the <code>cgOneFactorComparisonsTable</code> components.
</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>... </code></td>
<td>

<p>Additional arguments.  
</p>

<dl>
<dt>
<code>mcadjust</code> </dt>
<dd>
<p>Do a multiple comparisons adjustment, based on the simultaneous
inference capabilities of the <span class="pkg">multcomp</span> package. See Details
below. The default value is <code>FALSE</code>.
If <code>mcadjust=TRUE</code> is specified, there will be a delay,
usually just for a few seconds, due to computing time of the
critical point in order to conduct the adjusted comparisons.
</p>
</dd>
<dt>
<code>contrastmatrix</code> </dt>
<dd>
<p>Only relevant if <code>type="custom"</code> is
specified. In that case, a numeric matrix with the number of
rows equal to the number of comparisons of interest. The number
of columns must be equal to the number of group means. Each row in
the matrix is assumed to represent a contrast of coefficients
amongst the groups that defines the comparison of interest.
</p>
</dd>
<dt>
<code>refgrp</code> </dt>
<dd>
<p>If left at the default value of <code>NULL</code>, it will
be set to the <code>settings$refgrp</code> value in the <span class="pkg">cg</span> <code>fit</code>
object. When set, it is deemed the "reference", or "control" group, so that
pairwise comparisons of all other groups to it will be
constructed when <code>type="allgroupstocontrol"</code>. Please note the
<code>type="allgroupstocontrol"</code> setting is
REQUIRED when the <code>refgrp</code> argument is specified in the
call with a valid non-<code>NULL</code> value.
</p>
</dd>
<dt>
<code>model</code> </dt>
<dd>
<p>For <code>cgOneFactorFit</code> <code>fit</code> objects that have 
classical least squares <code>lm</code> or resistant &amp; robust
<code>rlm</code> fits, the following argument values are possible:
</p>

<dl>
<dt><code>"both"</code></dt>
<dd>
<p>Comparison tables based on both the ordinary 
classical least squares and resistant &amp; robust fits are
created. This is the default when both fits are present in
the <code>cgOneFactorFit</code> object specified in the <code>fit</code>
argument. If the resistant &amp; robust fit is not available,
this value is not relevant.
</p>
</dd>
<dt><code>"olsonly"</code></dt>
<dd>
<p>Only a comparison table based on the ordinary 
classical least squares <code>olsfit</code> fit slot is performed.
</p>
</dd>
<dt><code>"rronly"</code></dt>
<dd>
<p>Only a comparison table based on the resistant and
robust <code>rrfit</code> fit slot is performed.
</p>
</dd>
</dl>
</dd>
</dl>
<p>For other possible <code>cgOneFactorFit</code> fit components such as
accelerated failure time or unequal variance models, the <code>model</code>
argument is not relevant, and the appropriate comparisons table will
be calculated for these model types.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When <code>mcadjust=TRUE</code>, a status message of <code>"Some time may be
    needed as the critical point"</code><br><code>"from the multcomp::summary.glht function
    call is calculated"</code> is displayed at the console. This computed critical point
is used for all subsequent p-value and confidence interval
calculations.
</p>
<p>The <span class="pkg">multcomp</span> package provides a unified way to calculate
critical points based on the comparisons of interest in a
"family". Thus a user does not need to worry about choosing amongst
the myriad names of multiple comparison procedures.
</p>


<h3>Value</h3>

<p>Creates an object of class  <code>cgOneFactorComparisonsTable</code>, with the
following slots:
</p>

<dl>
<dt><code>ols.comprs</code></dt>
<dd>
<p>The table of comparisons based on the
<code>olsfit</code> component of the <code>cgOneFactorFit</code>,
unless <code>model="rronly"</code> is specified. In that case the slot
value is <code>NULL</code>. Will not be appropriate in
the case where a valid <code>aftfit</code> component is present in the
<code>cgOneFactorFit</code> object. See below for the data frame structure
of the table.
</p>
</dd>
<dt><code>rr.comprs</code></dt>
<dd>
<p>The table of comparisons based on the
<code>rrfit</code> component of the <code>cgOneFactorFit</code>
object, if a valid resistant &amp; robust fit object is present.
If <code>rrfit</code> is a simple character value of
<code>"No fit was selected."</code>, or <code>model="olsonly"</code> was
specified, then the value is <code>NULL</code>. See below for the data frame structure
of the table.
</p>
</dd>
<dt><code>aft.comprs</code></dt>
<dd>
<p>The table of comparisons based on the
<code>aftfit</code> component of the <code>cgOneFactorFit</code>
object if a valid accelerated failure time fit object is present.
If <code>aftfit</code> is a simple character value of
<code>"No fit was selected."</code>, then the value is <code>NULL</code>.
See below for the data frame structure
of the table.
</p>
</dd>
<dt><code>uv.comprs</code></dt>
<dd>
<p>The table of comparisons based on the
<code>uvfit</code> component of the <code>cgOneFactorFit</code>
object if a valid unequal variances fit object is present.
The error degrees of freedom for each comparison estimate and
test is individually estimated
with a Satterthwaite approximation. See below for the data frame structure
of the table.
</p>
</dd>
<dt><code>settings</code></dt>
<dd>
<p>A list of settings carried from the
<code>cgOneFactorFit</code> <code>fit</code> object, and the addition
of some specified arguments in the method call above: <code>alpha</code>,
<code>mcadjust</code>, <code>type</code>, and <code>addpct</code>. These are used
for the <code>print.cgOneFactorComparisonsTable</code> method,
invoked for example when
<code>display="print"</code>.
</p>
</dd>
</dl>
<p>The data frame structure of the comparisons table in a <code>*.comprs</code>
slot consists of <code>row.names</code> that specify the comparison of the
form A vs. B, and these columns:
</p>

<dl>
<dt><code>estimate</code></dt>
<dd>
<p>The difference in group means in the
comparison: A vs. B. If <code>settings$endptscale=="log"</code> in the
<code>fit</code> object, this will be back-transformed to a percent
difference scale.
</p>
</dd>
<dt><code>se</code></dt>
<dd>
<p>The estimated standard error of the difference
<code>estimate</code>. If <code>settings$endptscale=="log"</code> in the
<code>fit</code> object, this estimate will be based on the Delta
method, and will particularly begin to be a poor approximation when the
standard error in the logscale exceeds 0.50. 
</p>
</dd>
<dt><code>lowerci</code></dt>
<dd>
<p>The lower 100 * (1-<code>alpha</code>) % confidence limit of the
difference <code>estimate</code>. With the default <code>alpha=0.05</code>,
this is 95%. If <code>settings$endptscale=="log"</code> in the
<code>fit</code> object, the confidence limit is first computed in the
logarithmic scale of analysis, and then back-transformed to a percent
difference scale.
</p>
</dd>
<dt><code>upperci</code></dt>
<dd>
<p>The upper 100 * (1-<code>alpha</code>) % confidence limit of the
difference <code>estimate</code>. With the default <code>alpha=0.05</code>,
this is 95%. If <code>settings$endptscale=="log"</code> in the
<code>fit</code> object, the confidence limit is first computed in the
logarithmic scale of analysis, and then back-transformed to a percent
difference scale.
</p>
</dd>
<dt><code>pval</code></dt>
<dd>
<p>The computed p-value from the test of the difference <code>estimate</code>.
</p>
</dd>
<dt>
<code>meanA</code> or <code>geomeanA</code>
</dt>
<dd>
<p>The estimated mean for the
left hand side "A" of the A vs. B  comparison.
If <code>settings$endptscale=="log"</code> in the
<code>fit</code> object, this is a back-transform to the original scale,
and therefore is a geometric mean, and will be labelled
<code>geomeanA</code>.
Otherwise it is the arithmetic mean and labelled <code>meanA</code>.
</p>
</dd>
<dt><code>seA</code></dt>
<dd>
<p>The estimated standard error of the <code>meanA</code>
<code>estimate</code>. If <code>settings$endptscale=="log"</code> in the
<code>fit</code> object, this estimate will be based on the Delta
method, and will particularly begin to be a poor approximation when the
standard error in the logscale exceeds 0.50. 
</p>
</dd>
<dt>
<code>meanB</code> or <code>geomeanB</code>
</dt>
<dd>
<p>The estimated mean for the
right hand side "B" of the A vs. B comparison.
If <code>settings$endptscale=="log"</code> in the
<code>fit</code> object, this is a back-transform to the original scale,
and therefore is a geometric mean, and will be labelled
<code>geomeanB</code>.
Otherwise it is the arithmetic mean and labelled <code>meanB</code>.
</p>
</dd>
<dt><code>seB</code></dt>
<dd>
<p>The estimated standard error of the <code>meanB</code>
<code>estimate</code>. If <code>settings$endptscale=="log"</code> in the
<code>fit</code> object, this estimate will be based on the Delta
method, and will particularly begin to be a poor approximation when the
standard error in the logscale exceeds 0.50. 
</p>
</dd>
</dl>
<p>An additional column <code>addpct</code> of percent differences is added if
<code>endptscale=="original"</code> and <code>addpct=TRUE</code>,
as a descriptive supplement to the original scale
differences that are formally estimated.
</p>


<h3>Note</h3>

<p>Contact <a href="mailto:cg@billpikounis.net">cg@billpikounis.net</a> for bug reports, questions,
concerns, and comments. 
</p>


<h3>Author(s)</h3>

<p>Bill Pikounis [aut, cre, cph], John Oleynick [aut], Eva Ye [ctb]
</p>


<h3>References</h3>

<p>Hothorn, T., Bretz, F., Westfall, P., Heiberger, R.M., and
Schuetzenmeister, A. (2010). The <code>multcomp</code> package.
</p>
<p>Hothorn, T., Bretz, F., and Westfall, P. (2008).
"Simultaneous Inference in General Parametric Models",
<em>Biometrical Journal</em>, 50, 3, 346-363.  
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(canine)
canine.data &lt;- prepareCGOneFactorData(canine, format="groupcolumns",
                                      analysisname="Canine",
                                      endptname="Prostate Volume",
                                      endptunits=expression(plain(cm)^3),
                                      digits=1, logscale=TRUE, refgrp="CC")
canine.fit &lt;- fit(canine.data)

canine.comps0 &lt;- comparisonsTable(canine.fit)

canine.comps1 &lt;- comparisonsTable(canine.fit,  mcadjust=TRUE,
                                   type="allgroupstocontrol", refgrp="CC")


data(gmcsfcens)
gmcsfcens.data &lt;- prepareCGOneFactorData(gmcsfcens, format="groupcolumns",
                                         analysisname="cytokine",
                                         endptname="GM-CSF (pg/ml)",
                                         logscale=TRUE)

gmcsfcens.fit &lt;- fit(gmcsfcens.data, type="aft")

gmcsfcens.comps &lt;- comparisonsTable(gmcsfcens.fit)

</code></pre>


</div>