<div class="container">

<table style="width: 100%;"><tr>
<td>cluspred</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function used for clustering and fitting the regression model</h2>

<h3>Description</h3>

<p>Estimation of the group-variable Z based on covariates X and estimation of the parameters of the regression of Y on (U, Z)
</p>


<h3>Usage</h3>

<pre><code class="language-R">cluspred(
  y,
  x,
  u = NULL,
  K = 2,
  model.reg = "mean",
  tau = 0.5,
  simultaneous = TRUE,
  np = TRUE,
  nbinit = 20,
  nbCPU = 1,
  tol = 0.01,
  band = (length(y)^(-1/5)),
  seed = 134
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>numeric vector of the traget variable (must be numerical)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>matrix used for clustering (can contain numerical and factors)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>matrix of the covariates used for regression (can contain numerical and factors)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>number of clusters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.reg</code></td>
<td>
<p>indicates the type of the loss ("mean", "quantile", "expectile", "logcosh", "huber"). Only the losses "mean" and "quantile" are implemented if simultaneous=FALSE or np=FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>specifies the level for the loss (quantile, expectile or huber)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simultaneous</code></td>
<td>
<p>oolean indicating whether the clustering and the regression are performed simultaneously (TRUE) or not (FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>np</code></td>
<td>
<p>boolean indicating whether nonparameteric model is used (TRUE) or not (FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbinit</code></td>
<td>
<p>number of random initializations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbCPU</code></td>
<td>
<p>number of CPU only used for linux</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>to specify the stopping rule</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>band</code></td>
<td>
<p>bandwidth selection</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>value of the seed (used for drawing the starting points)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>cluspred returns a list containing the model parameters (param), the posterior probabilities of cluster memberships (tik), the partition (zhat) and the (smoothed) loglikelihood)
</p>


<h3>References</h3>

<p>Simultaneous semi-parametric estimation of clustering and regression, Matthieu Marbac and Mohammed Sedki and Christophe Biernacki and Vincent Vandewalle (2020) &lt;arXiv:2012.14159&gt;.
</p>


<h3>Examples</h3>

<pre><code class="language-R">require(ClusPred)
# data loading
data(simdata)

# mean regression with two latent groups in parametric framework and two covariates
res &lt;- cluspred(simdata$y, simdata$x, simdata$u, K=2,
 np=FALSE, nbCPU = 1, nbinit = 10)
# coefficient of the regression
res$param$beta
# proportions of the latent groups
res$param$pi
# posterior probability of the group memberships
head(res$tik)
# partition
res$zhat
# loglikelihood
res$loglike
# prediction (for possible new observations)
pred &lt;- predictboth(simdata$x, simdata$u, res, np = FALSE)
# predicted cluster membreships
pred$zhat
# predicted value of the target variable
pred$yhat


# median regression with two latent groups in nonparametric framework and two covariates
res &lt;- cluspred(simdata$y, simdata$x, simdata$u, K=2,
model.reg = "quantile", tau = 0.5, nbinit = 10)
# coefficient of the regression
res$param$beta
# proportions of the latent groups
res$param$pi
# posterior probability of the group memberships
head(res$tik)
# partition
res$zhat
# smoothed loglikelihood
res$logSmoothlike
# prediction (for possible new observations)
pred &lt;- predictboth(simdata$x, simdata$u, res, np = TRUE)
# predicted cluster membreships
pred$zhat
# predicted value of the target variable
pred$yhat



</code></pre>


</div>