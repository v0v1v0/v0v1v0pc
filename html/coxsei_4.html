<div class="container">

<table style="width: 100%;"><tr>
<td>coxseiest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>

Function to estimate the parametric part of the Cox (proportional
intensity) self-exciting point process (CoxSEI) model
</h2>

<h3>Description</h3>

<p>Estimate the parametric part of the CoxSEI model using (conditionally)
right-censored counting process data. 

</p>


<h3>Usage</h3>

<pre><code class="language-R">coxseiest(dat, par.init, m = 2, mit = 1000, tr = TRUE,
          method = "L-BFGS-B", lower=c(rep(-Inf,ncol(dat)-3),-Inf,0),
          upper=rep(Inf,ncol(dat)-3 + 2),
          gfun = function(x, pa) {
           ifelse(x &lt;= 0, rep(0, length(x)), pa[1] * exp(-pa[2] * x))
          })
coxseiest2(dat, par.init, m = 2, mit = 1000, tr = TRUE,
           method = "L-BFGS-B", lower=c(rep(-Inf,ncol(dat)-3),-Inf,0),
           upper=rep(Inf,ncol(dat)-3 + 2),
           gfun = function(x, pa) {
             ifelse(x &lt;= 0, rep(0, length(x)), pa[1] * exp(-pa[2] * x))
           })
coxseiest3(dat, par.init, m = 2, mit = 1000, tr = TRUE,
           method = "L-BFGS-B", lower=c(rep(-Inf,ncol(dat)-3),-Inf,0),
           upper=rep(Inf,ncol(dat)-3 + 2))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>


<p>a data frame with columns <code>Y</code> containing the censored
event times of each individual process arranged in ascending order
with the last time always being the the censoring time, <code>delta</code>
containing the event time indicator with value indicator an event
time and 0 a censoring time, <code>id</code> specifying the id (process
number) of each event time recorded, and the others giving the value
of the associated covariate process at the corresponding event
times. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par.init</code></td>
<td>


<p>init guess of the value of the parameters to start the optimization
iteration with.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>


<p>order of "autoregression" of the excitation term.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mit</code></td>
<td>


<p>maximum number of iteration in the optimization routine
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tr</code></td>
<td>


<p>if set to <code>TRUE</code>, print some summary information while the
optimization routine is running.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>


<p>method of optimization
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>

<p>vector of lower boundary values of the parameter space
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>

<p>vector of upper boundary of the parameter space
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gfun</code></td>
<td>


<p>the excitation function. Defaults to the exponential decay function 
</p>
<p style="text-align: center;"><code class="reqn">g(t;\gamma)=\gamma_1 \gamma_2 e^{-\gamma_2 t}</code>
</p>

</td>
</tr>
</table>
<h3>Details</h3>


<p><code>coxseiest</code> uses only R code; <code>coxseiest2</code> uses external C
code, and is expected to be 3~4 times fasters than the former;
<code>coxseiest3</code> assumes the excitation function is the exponential
function as defaulted by the former two, and hardwares it in the C
side of the code, and therefore is much faster than the former two
when the exponential excitation function is desired. 
</p>


<h3>Value</h3>






<p>A list as that returned by the call to the optimizer routine. For
instance, 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p>gives the estimate of the parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hessian</code></td>
<td>
<p>gives the inverse of the estimate of the
variance-covariance matrix</p>
</td>
</tr>
</table>
<h3>Note</h3>


<p>the excitation function has to contain exactly two parameters; a
feature that does not seem desiable and might change later.
</p>


<h3>Author(s)</h3>


<p>Feng Chen &lt;feng.chen@unsw.edu.au&gt;
</p>


<h3>References</h3>


<p>Feng Chen and Kani Chen. (2014). Modeling Event Clustering Using the m-Memory
Cox-Type
Self-Exciting Intensity Model. International Journal of Statistics and
Probability. 3(3): 126-137. doi:10.5539/ijsp.v3n3p126  URL:
http://dx.doi.org/10.5539/ijsp.v3n3p126
</p>
<p>Feng Chen and Kani Chen. (2014). Case-cohort analysis of clusters of
recurrent events. 20(1): 1-15. doi: 10.1007/s10985-013-9275-3
</p>


<h3>See Also</h3>


<p>See <code>optim</code> for the components of the returned value
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("dat")
## this takes over 15 minutes
##est0 &lt;- coxseiest(dat,par.init=c(0.2,0.4,0.6,0.6,5))
## this one takes about 4 minutes
##est1 &lt;- coxseiest2(dat,par.init=c(0.2,0.4,0.6,0.6,5))
## this one takes about 10 seconds
est2 &lt;- coxseiest3(dat,par.init=c(0.2,0.4,0.6,0.6,5))
</code></pre>


</div>