<div class="container">

<table style="width: 100%;"><tr>
<td>permute_treeshapes</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Permute all treeshapes of N tips</h2>

<h3>Description</h3>

<p>Given a number of tips, permutes all rooted unlabelled multifurcating trees (i.e., treeshapes).
</p>


<h3>Usage</h3>

<pre><code class="language-R">permute_treeshapes(n_tips, sort_by_resolution = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n_tips</code></td>
<td>
<p>The number of tips required. Note that it may be very slow or not run at all if this value is too large.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sort_by_resolution</code></td>
<td>
<p>Whether or not to sort the output by number of internal nodes (from 1 to N - 1). Defaults to <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A treeshape is essentially an unlabelled phylogenetic tree. Like other phylogenetic trees it has a root and tips, but (as you might expect) because it is unlabelled the tips have no specific identity. Thus the only information it contains is its' "shape" - the number of internal nodes and their descendants. This function permutes all <em>unique</em> treeshapes and allows for multifurcations.
</p>
<p>Note that unique means it excludes alternative rotations of individual branch points. For example, the trees ((2),1); and (1,(2)); are identical in information content and this function would only permute one of them.
</p>
<p>The algorithm used here is loosely based on the partitions approach suggested in Felsenstein (2004), although to the best of my knowledge nobody else has formally created an algorithm to do this. (Felsenstein also lays out the expected number of such treeshapes for each value of N.)
</p>
<p>Here treeshapes are encoded and output in a pseudo-Newick style format where labels are replaced with the number of tips, e.g.:
</p>
<p>(((3),1),(1,(2)));
</p>
<p>Thus each pair of parentheses represents an internal node, each number the number of tips, each comma separates sets of tips, and the semicolon denotes the root clade.
</p>


<h3>Value</h3>

<p>If <code>sort_by_resolution = TRUE</code> then returns a list of length N - 1, where each element is a character vector of treeshapes in Newick-style number format with that many internal nodes. I.e., the first value will always be the star tree. If <code>sort_by_resolution = FALSE</code> then will just be a character vector of treeshapes in Newick-style number format.
</p>


<h3>Author(s)</h3>

<p>Graeme T. Lloyd <a href="mailto:graemetlloyd@gmail.com">graemetlloyd@gmail.com</a>
</p>


<h3>References</h3>

<p>Felsenstein, J., 2004. <em>Inferring Phylogenies</em>. Sinauer Associates, Inc., Sunderland.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Permute all treeshapes of six tips:
permute_treeshapes(n_tips = 6)

</code></pre>


</div>