<div class="container">

<table style="width: 100%;"><tr>
<td>crwSamplePar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create a weighted importance sample for posterior predictive track
simulation.</h2>

<h3>Description</h3>

<p>The <code>crwSamplePar</code> function uses a fitted model object from
<code>crwMLE</code> and a set of prediction times to construct a list from which
<code>crwPostIS</code> will draw a sample from either the posterior
distribution of the state vectors conditional on fitted parameters or a full
posterior draw from an importance sample of the parameters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">crwSamplePar(
  object.sim,
  method = "IS",
  size = 1000,
  df = Inf,
  grid.eps = 1,
  crit = 2.5,
  scale = 1,
  quad.ask = T,
  force.quad
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object.sim</code></td>
<td>
<p>A simulation object from <code>crwSimulator</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Method for obtaining weights for movement parameter samples</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>Size of the parameter importance sample</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>Degrees of freedom for the t approximation to the parameter
posterior</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid.eps</code></td>
<td>
<p>Grid size for <code>method="quadrature"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crit</code></td>
<td>
<p>Criterion for deciding "significance" of quadrature points
(difference in log-likelihood)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>Scale multiplier for the covariance matrix of the t
approximation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quad.ask</code></td>
<td>
<p>Logical, for method='quadrature'. Whether or not the sampler 
should ask if quadrature sampling should take place. It is used to stop the 
sampling if the number of likelihood evaluations would be extreme.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>force.quad</code></td>
<td>
<p>A logical indicating whether or not to force the execution 
of the quadrature method for large parameter vectors.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The crwSamplePar function uses the information in a
<code>crwSimulator</code> object to create a set of weights for importance
sample-resampling of parameters in a full posterior sample of parameters and
locations using <code>crwPostIS</code>. This function is usually called
from <code>crwPostIS</code>. The average user should have no need to call
this function directly.
</p>


<h3>Value</h3>

<p>List with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Longitude coordinate with NA at prediction times</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Similar to above for latitude</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>locType</code></td>
<td>
<p>Indicates prediction types with a "p" or observation times
with an "o"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P1.y</code></td>
<td>
<p>Initial state covariance for latitude</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P1.x</code></td>
<td>
<p>Initial state covariance for longitude</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a1.y</code></td>
<td>
<p>Initial latitude state</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a1.x</code></td>
<td>
<p>Initial longitude state</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.errX</code></td>
<td>
<p>number of longitude error model parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.errY</code></td>
<td>
<p>number of latitude error model parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>vector of time differences</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>driftMod</code></td>
<td>
<p>Logical. indicates random drift model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stopMod</code></td>
<td>
<p>Logical. Indicated stop model fitted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stop.mf</code></td>
<td>
<p>stop model design matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>err.mfX</code></td>
<td>
<p>Longitude error model design matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>err.mfY</code></td>
<td>
<p>Latitude error model design matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mov.mf</code></td>
<td>
<p>Movement model design matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixPar</code></td>
<td>
<p>Fixed values for parameters in model fitting</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Cmat</code></td>
<td>
<p>Covariance matrix for parameter sampling distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lmat</code></td>
<td>
<p>Cholesky decomposition of Cmat</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p>fitted parameter values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Total number of locations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>log likelihood of the fitted model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Time</code></td>
<td>
<p>vector of observation times</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coord</code></td>
<td>
<p>names of coordinate vectors in original data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Time.name</code></td>
<td>
<p>Name of the observation times vector in the original data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thetaSampList</code></td>
<td>
<p>A list containing a data frame of parameter vectors and
their associated probabilities for a resample</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Devin S. Johnson
</p>


<h3>See Also</h3>

<p>See <code>demo(northernFurSealDemo)</code> for example.
</p>


</div>