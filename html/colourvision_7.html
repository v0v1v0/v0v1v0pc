<div class="container">

<table style="width: 100%;"><tr>
<td>CTTKmodel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Chittka (1992) colour vision model
</h2>

<h3>Description</h3>

<p>Chittka (1992) colour hexagon extended to animals with any number of photoreceptors types.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CTTKmodel(photo=ncol(C)-1, R, I, Rb, C,
          interpolate=TRUE, nm=seq(300,700,1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>photo</code></td>
<td>

<p>Number of photoreceptor types. Model accepts any number of photoreceptor types (<code>&gt;=2</code>). For instance, dichromatic: <code>photo=2</code>; trichromatic: <code>photo=3</code>; tetrachromatic: <code>photo=4</code>, etc. Default gets number of photoreceptor types from <code>C</code> argument.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>

<p>Reflectance of observed objects. A data frame with first column corresponding to wavelength values and following columns with reflectance values. <code>R</code> must be in the same scale as <code>Rb</code> (percentage or proportion).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>I</code></td>
<td>

<p>Irradiance spectrum. A data frame with two columns only: first column corresponding to wavelength values and second column with irradiance values. Irradiance values must be in quantum flux units.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rb</code></td>
<td>

<p>Background reflectance. A data frame with two columns only: first column corresponding to wavelength values and second column with reflectance values. <code>Rb</code> must be in the same scale as <code>R</code> (percentage or proportion).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>

<p>Photoreceptor sensitivity curves, from lowest to longest lambda-max. A data frame: first column corresponding to wavelength values and following columns with photoreceptor sensitivity values (see function <code>photor</code>). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interpolate</code></td>
<td>

<p>Whether data files should be interpolated before further calculations. See <code>approx</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nm</code></td>
<td>

<p>A sequence of numeric values specifying where interpolation is to take place. See <code>approx</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The original model is available for trichromatic animals only. Thery and Casas (2002) derived a version for tetrachromatic animals which is implemented here. In <code>colourvision</code>, this model was extended to any number of photoreceptors types (Gawryszewski 2018; see also Pike 2012). The colour hexagon in Chittka (1992) has a vector of length = 1.0 The chromaticity coordinates in <code>colourvision</code> preserve the same vector length.
</p>
<p>Photoreceptor outputs (<code class="reqn">E_i</code>) are calculated by:
</p>
<p style="text-align: center;"><code class="reqn">E_i = \frac{q_i}{q_i+1}</code>
</p>

<p>where <code class="reqn">q_i</code> is given by <code>Qr</code>.
</p>
<p>Then, for trichromatic vision, coordinates in the colour space are found by (Chittka 1992):
</p>
<p style="text-align: center;"><code class="reqn">X_1 = \frac{\sqrt{3}}{2}(E_3-E_1)</code>
</p>

<p style="text-align: center;"><code class="reqn">X_2 = E_2-\frac{1}{2}(E_1+E_3)</code>
</p>

<p>For tetrachromatic vision (Thery and Casas 2002):
</p>
<p style="text-align: center;"><code class="reqn">X_1 = \frac{\sqrt{3}\sqrt{2}}{3}(E_3-E_4)</code>
</p>

<p style="text-align: center;"><code class="reqn">X_2 = E_1-\frac{1}{3}(E_2+E_3+E_4)</code>
</p>

<p style="text-align: center;"><code class="reqn">X_3 = \frac{2\sqrt{2}}{3}(\frac{1}{2}(E_3+E_4)-E_2)</code>
</p>

<p>For a pentachromatic animal following the same vector length:
</p>
<p style="text-align: center;"><code class="reqn">X_1 = \frac{5}{2\sqrt{2}\sqrt{5}}(E_2-E_1)</code>
</p>

<p style="text-align: center;"><code class="reqn">X_2 = \frac{5\sqrt{2}}{2\sqrt{3}\sqrt{5}}(E_3-\frac{E_1+E_2}{2})</code>
</p>

<p style="text-align: center;"><code class="reqn">X_3 = \frac{5\sqrt{3}}{4\sqrt{5}}(E_4-\frac{E_1+E_2+E_3}{3})</code>
</p>

<p style="text-align: center;"><code class="reqn">X_4 = E_5-\frac{E1+E2+E3+E4}{4}</code>
</p>



<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Qri</code></td>
<td>
<p>Photoreceptor photon catch values after the von Kries transformation (see function <code>Qr</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ei</code></td>
<td>
<p>Photoreceptor output values. Values can vary from 0 to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xi</code></td>
<td>
<p>Coordinates in the colour space.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deltaS</code></td>
<td>
<p>Euclidean distance to the origin of the colour space. It represents the conspicuousness of the stimulus (<code>R</code>) in relation to the background (<code>Rb</code>).</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Felipe M. Gawryszewski <a href="mailto:f.gawry@gmail.com">f.gawry@gmail.com</a>
</p>


<h3>References</h3>

<p>Chittka, L. 1992. The colour hexagon: a chromaticity diagram based on photoreceptor excitations as a generalized representation of colour opponency. J Comp Physiol A 170:533-543.
</p>
<p>Gawryszewski, F.M. 2018. Colour vision models: Some simulations, a general n-dimensional model, and the colourvision R package. Ecology and Evolution, 10.1002/ece3.4288.
</p>
<p>Pike, T.W. 2012. Generalised chromaticity diagrams for animals with n-chromatic colour vision. Journal of Insect Behavior 255: 277-286.
</p>
<p>Thery, M., and J. Casas. 2002. Predator and prey views of spider camouflage. Nature 415:133-133.
</p>


<h3>See Also</h3>

<p><code>CTTKhexagon</code>, <code>CTTKhexagon3D</code>, <code>photor</code>, <code>RNLmodel</code>, <code>EMmodel</code>, <code>deltaS</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">##Photoreceptor sensitivity curves
##with lambda max at 350nm, 450nm and 550nm:
C&lt;-photor(lambda.max=c(350,450,550))

## Grey background
## with 10 percent reflectance from 300 to 700nm:
Rb &lt;- data.frame(300:700, rep(10, length(300:700)))

## Read CIE D65 standard illuminant
data("D65")

## Reflectance data
## with a sigmoid spectrum and midpoint at 500nm
R&lt;-logistic(x=seq(300,700,1), x0=500, L=50, k=0.04)

## Run model 
model&lt;-CTTKmodel(photo=3, R=R, I=D65,
    Rb=Rb, C=C)
 
#plot   
plot(model)
</code></pre>


</div>