<div class="container">

<table style="width: 100%;"><tr>
<td>plot_cohen</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Constructs a serial dependence plot based on Cohen's kappa</h2>

<h3>Description</h3>

<p><code>plot_cohen</code> constructs a serial dependence plot of a categorical
time series based on Cohen's kappa
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_cohen(
  series,
  max_lag = 10,
  alpha = 0.05,
  plot = TRUE,
  title = "Serial dependence plot",
  bar_width = 0.12,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>series</code></td>
<td>
<p>An object of type <code>tsibble</code> (see R package <code>tsibble</code>), whose column named Value
contains the values of the corresponding CTS. This column must be of class <code>factor</code> and its levels
must be determined by the range of the CTS.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_lag</code></td>
<td>
<p>The maximum lag represented in the plot (default is 10).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The significance level for the corresponding hypothesis test (default is 0.05).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>Logical. If <code>plot = TRUE</code> (default), returns the serial dependence
plot. Otherwise, returns a list with the values of Cohens's kappa, the critical
value and the corresponding p-values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>The title of the graph.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bar_width</code></td>
<td>
<p>The width of the corresponding bars.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters for the function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Constructs a serial dependence plot based on Cohens's kappa, <code class="reqn">\widehat{\kappa}(l)</code>,
for several lags. A dashed lined is incorporated indicating the critical value
of the test based on the following asymptotic approximation (under the i.i.d. assumption):
</p>
<p style="text-align: center;"><code class="reqn">\sqrt{\frac{T}{V(\widehat{\boldsymbol p})}}\bigg(\widehat{\kappa}(l)+\frac{1}{T}\bigg)\sim N\big(0, 1\big),</code>
</p>
<p> where <code class="reqn">T</code> is the series length,
<code class="reqn">\widehat{\boldsymbol p}=(\widehat{p}_1, \ldots, \widehat{p}_r)</code> is the vector of estimated marginal probabilities for the <code class="reqn">r</code> categories of
the series and <code class="reqn">V(\boldsymbol {\widehat{p}})=1-\frac{1+2\sum_{i=1}^{r}\widehat{p}_i^3-3\sum_{i=1}^{r}\widehat{p}_i^2}{(1-\sum_{i=1}^{r}\widehat{p}_i^2)^2}</code>.
</p>


<h3>Value</h3>

<p>If <code>plot = TRUE</code> (default), returns the serial dependence plot based on Cohens's kappa. Otherwise, the function
returns a list with the values of Cohens's kappa, the critical
value and the corresponding p-values.
</p>


<h3>Author(s)</h3>

<p>Ángel López-Oriona, José A. Vilar
</p>


<h3>References</h3>


<p>Weiß CH (2011).
“Empirical measures of signed serial dependence in categorical time series.”
<em>Journal of Statistical Computation and Simulation</em>, <b>81</b>(4), 411–429.
</p>



<h3>Examples</h3>

<pre><code class="language-R">sequence_1 &lt;- GeneticSequences[which(GeneticSequences$Series==1),]
plot_ck &lt;- plot_cohen(series = sequence_1, max_lag = 3) # Representing
# the serial dependence plot
list_ck &lt;- plot_cohen(series = sequence_1, max_lag = 3, plot = FALSE) # Obtaining
# the values of Cohens's kappa, the critical value and the p-values
</code></pre>


</div>