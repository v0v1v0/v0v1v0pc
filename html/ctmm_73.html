<div class="container">

<table style="width: 100%;"><tr>
<td>overlap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate the overlap between two stationary distributions</h2>

<h3>Description</h3>

<p>This function calculates a useful measure of similarity between distributions known as the <em>Bhattacharyya coefficient</em> in statistics and simply the <em>fidelity</em> or <em>overlap</em> in quantum and statistical mechanics. It is roughly speaking the ratio of the intersection area to the average individual area, but it is a direct comparison between the density functions and does not require an arbitrary quantile to be specified. When applied to <code>ctmm</code> objects, this function returns the overlap of the two Gaussian distributions. When applied to aligned <code>UD</code> objects with corresponding movement models, this function returns the overlap of their (autocorrelated) kernel density estimates.</p>


<h3>Usage</h3>

<pre><code class="language-R"> overlap(object,method="Bhattacharyya",level=0.95,debias=TRUE,...) </code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A <code>list</code> of <code>ctmm</code> fit or aligned <code>UD</code> objects to compare.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Can be <code>"Bhattacharyya"</code> or <code>"Encounter"</code> (see Details below).</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>The confidence level desired for the output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>debias</code></td>
<td>
<p>Approximate debiasing of the overlap.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Not currently used.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The default <code>method="Bhattacharyya"</code> estimates the standard overlap measure <code class="reqn">\int\int \sqrt{p(x,y) \, q(x,y)} \, dx \, dy</code> between the distributions <code class="reqn">p(x,y)</code> and <code class="reqn">q(x,y)</code>,
while <code>method="encounter"</code> estimates the non-standard measure <code class="reqn">\frac{\int\int p(x,y) \, q(x,y) \, dx \, dy}{\sqrt{\int\int p(x',y')^2 \, dx' dy' \int\int q(x'',y'')^2 \, dx'' dy''}}</code>,
which has a numerator proportional to the uncorrelated encounter probability.
Both measures lie between 0 and 1, where 0 indicates no shared support and 1 indicates identical distributions.
</p>


<h3>Value</h3>

<p>An object with slots <code>DOF</code>, containing the effective sample sizes, and <code>CI</code> containing a table of confidence intervals on the overlap estimates. A value of <code>1</code> implies that the two distributions are identical, while a value of <code>0</code> implies that the two distributions share no area in common.</p>


<h3>Note</h3>

<p>In <code>ctmm</code> v0.5.2, direct support for <code>telemetry</code> objects was dropped and the <code>CTMM</code> argument was depreciated for <code>UD</code> objects, simplifying usage.
</p>
<p>Uncertainties in the model fits are propagated into the overlap estimate under the approximation that the Bhattacharyya distance is a chi-square random variable. Debiasing makes further approximations noted in Winner &amp; Noonan et al (2018).</p>


<h3>Author(s)</h3>

<p>C. H. Fleming and K. Winner</p>


<h3>References</h3>

<p>K. Winner, M. J. Noonan, C. H. Fleming, K. Olson, T. Mueller, D. Sheldon, J. M. Calabrese.
“Statistical inference for home range overlap”,
Methods in Ecology and Evolution, 9:7, 1679-1691 (2018) <a href="https://doi.org/10.1111/2041-210X.13027">doi:10.1111/2041-210X.13027</a>.
</p>


<h3>See Also</h3>

 <p><code>akde</code>, <code>ctmm.fit</code>, <code>distance</code>, <code>encounter</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">
# Load package and data
library(ctmm)
data(buffalo)

# fit models for first two buffalo
GUESS &lt;- lapply(buffalo[1:2], function(b) ctmm.guess(b,interactive=FALSE) )
# using ctmm.fit here for speed, but you should almost always use ctmm.select
FITS &lt;- lapply(1:2, function(i) ctmm.fit(buffalo[[i]],GUESS[[i]]) )
names(FITS) &lt;- names(buffalo[1:2])

# Gaussian overlap between these two buffalo
overlap(FITS)

# AKDE overlap between these two buffalo
# create aligned UDs
UDS &lt;- akde(buffalo[1:2],FITS)
# evaluate overlap
overlap(UDS)
</code></pre>


</div>