<div class="container">

<table style="width: 100%;"><tr>
<td>gcm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generalised covariance measure test</h2>

<h3>Description</h3>

<p>Generalised covariance measure test
</p>


<h3>Usage</h3>

<pre><code class="language-R">gcm(
  Y,
  X,
  Z,
  alternative = c("two.sided", "less", "greater"),
  reg_YonZ = "rf",
  reg_XonZ = "rf",
  args_YonZ = NULL,
  args_XonZ = NULL,
  type = c("quadratic", "max"),
  B = 499L,
  coin = TRUE,
  cointrol = list(distribution = "asymptotic"),
  return_fitted_models = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Vector or matrix of response values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Matrix or data.frame of covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>Matrix or data.frame of covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>A character string specifying the alternative hypothesis,
must be one of <code>"two.sided"</code> (default), <code>"greater"</code> or
<code>"less"</code>. Only applies if <code>type = "quadratic"</code> and <code>Y</code> and
<code>X</code> are one-dimensional.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reg_YonZ</code></td>
<td>
<p>Character string or function specifying the regression for
Y on Z. See <code>?regressions</code> for more detail.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reg_XonZ</code></td>
<td>
<p>Character string or function specifying the regression for
X on Z. See <code>?regressions</code> for more detail.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args_YonZ</code></td>
<td>
<p>A list of named arguments passed to <code>reg_YonZ</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args_XonZ</code></td>
<td>
<p>A list of named arguments passed to <code>reg_XonZ</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Type of test statistic, either <code>"quadratic"</code> (default) or
<code>"max"</code>. If <code>"max"</code> is specified, the p-value is computed
based on a bootstrap approximation of the null distribution with
<code>B</code> samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>Number of bootstrap samples. Only applies if <code>type = "max"</code> is
used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coin</code></td>
<td>
<p>Logical; whether or not to use the <code>coin</code> package for
computing the test statistic and p-value. The <code>coin</code> package
computes variances with n - 1 degrees of freedom.
The default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cointrol</code></td>
<td>
<p>List; further arguments passed to
<code>independence_test</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_fitted_models</code></td>
<td>
<p>Logical; whether to return the fitted regressions
(default is <code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to <code>reg_YonZ</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The generalised covariance measure test tests whether the conditional
covariance of Y and X given Z is zero.
</p>


<h3>Value</h3>

<p>Object of class '<code>gcm</code>' and '<code>htest</code>' with the following
components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>The value of the test statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>The p-value for the <code>hypothesis</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameter</code></td>
<td>
<p>In case X is multidimensional, this is the degrees of
freedom used for the chi-squared test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hypothesis</code></td>
<td>
<p>String specifying the null hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null.value</code></td>
<td>
<p>String specifying the null hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The string <code>"Generalised covariance measure test"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p>A character string giving the name(s) of the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rY</code></td>
<td>
<p>Residuals for the Y on Z regression.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rX</code></td>
<td>
<p>Residuals for the X on Z regression.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>models</code></td>
<td>
<p>List of fitted regressions if <code>return_fitted_models</code> is <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Rajen D. Shah, Jonas Peters "The hardness of conditional independence testing
and the generalised covariance measure," The Annals of Statistics, 48(3),
1514-1538. <a href="https://doi.org/10.1214/19-aos1857">doi:10.1214/19-aos1857</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">n &lt;- 1e2
X &lt;- matrix(rnorm(2 * n), ncol = 2)
colnames(X) &lt;- c("X1", "X2")
Z &lt;- matrix(rnorm(2 * n), ncol = 2)
colnames(Z) &lt;- c("Z1", "Z2")
Y &lt;- X[, 2]^2 + Z[, 2] + rnorm(n)
(gcm1 &lt;- gcm(Y, X, Z))

</code></pre>


</div>