<div class="container">

<table style="width: 100%;"><tr>
<td>stepfun.hist</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create a probability density step function from a histogram object</h2>

<h3>Description</h3>

<p>This function creates a step function from the bars in a <code>histogram</code> 
object. By default, the step function will be normalized so that it 
integrates to 1.
</p>


<h3>Usage</h3>

<pre><code class="language-R">stepfun.hist(h, ..., normalize = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>an object of type <code>histogram</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments for the default <code>stepfun</code> 
function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalize</code></td>
<td>
<p>Boolean indicating whether or not to normalize the output 
stepfun so that it integrates to 1. Defaults to <code>TRUE</code>.  If 
<code>FALSE</code>, then the function will integrate to <code>sum(h$counts)</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A function of class <code>stepfun</code>.  The height of the steps will be
divided by the distance between breaks and possibly the total count.
</p>


<h3>Author(s)</h3>

<p>David M. Kaplan <a href="mailto:dmkaplan2000@gmail.com">dmkaplan2000@gmail.com</a>
</p>


<h3>See Also</h3>

<p>See also <code>d.rel.conn.dists.func</code>,
<code>optim.rel.conn.dists</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(ConnMatTools)
data(damselfish.lods)

# Histograms of simulated LODs
l &lt;- seq(-1,30,0.5)
h.in &lt;- hist(damselfish.lods$in.group,breaks=l)
h.out &lt;- hist(damselfish.lods$out.group,breaks=l)

# PDFs for marked and unmarked individuals based on simulations
d.marked &lt;- stepfun.hist(h.in)
d.unmarked &lt;- stepfun.hist(h.out)

# Fraction of adults genotyped at source site
p.adults &lt;- 0.25

# prior.shape1=1 # Uniform prior
prior.shape1=0.5 # Jeffreys prior

# Fraction of eggs from one or more genotyped parents
p &lt;- dual.mark.transmission(p.adults)$p

# PDF for relative connectivity
D &lt;- d.rel.conn.dists.func(damselfish.lods$real.children,
                           d.unmarked,d.marked,p,
                           prior.shape1=prior.shape1)

# Estimate most probable value for relative connectivity
phi.mx &lt;- optim.rel.conn.dists(damselfish.lods$real.children,
                                    d.unmarked,d.marked,p)$phi

# Estimate 95% confidence interval for relative connectivity
Q &lt;- q.rel.conn.dists.func(damselfish.lods$real.children,
                           d.unmarked,d.marked,p,
                           prior.shape1=prior.shape1)

# Plot it up
phi &lt;- seq(0,1,0.001)
plot(phi,D(phi),type="l",
     xlim=c(0,0.1),
     main="PDF for relative connectivity",
     xlab=expression(phi),
     ylab="Probability density")

abline(v=phi.mx,col="green",lty="dashed")
abline(v=Q(c(0.025,0.975)),col="red",lty="dashed")
</code></pre>


</div>