<div class="container">

<table style="width: 100%;"><tr>
<td>aov_pcaSpectra</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>ANOVA-PCA Analysis of Spectra Data</h2>

<h3>Description</h3>

<p>ANOVA-PCA is a combination of both methods developed by Harrington.  The
data is partitioned into submatrices corresponding to each experimental
factor, which are then subjected to PCA separately after adding the residual
error back.  If the effect of a factor is large compared to the residual
error, separation along the 1st PC in the score plot should be evident.
With this method, the significance of a factor can be visually determined
(ANOVA-PCA is not blind to group membership). ANOVA-PCA with only one factor
is the same as standard PCA and gives no additional separation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">aov_pcaSpectra(spectra, fac, type = "class", choice = NULL, showNames = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>spectra</code></td>
<td>
<p>An object of S3 class <code>Spectra()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fac</code></td>
<td>
<p>A vector of character strings giving the factors to be used in
the analysis.  These should be elements of <code>Spectra</code>.  Note that
there should be 2 or more factors, because ANOVA-PCA on one factor is the
same as standard PCA.  See the example.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Either classical ("cls") or robust ("rob"); Results in either
<code>c_pcaSpectra</code> or <code>r_pcaSpectra</code> being called on the
<code>Spectra</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>choice</code></td>
<td>
<p>The type of scaling to be performed.  See
<code>c_pcaSpectra</code> and <code>r_pcaSpectra</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showNames</code></td>
<td>
<p>Logical.  Show the names of the submatrices in the console.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of PCA results, one for each computed submatrix.
</p>


<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University), Matthew J. Keinsley.
</p>


<h3>References</h3>

<p>Pinto, Bosc, Nocairi, Barros, and Rutledge. "Using ANOVA-PCA for
Discriminant Analysis: ..." Analytica Chimica Acta 629.1-2 (2008): 47-55.
</p>
<p>Harrington, Vieira, Espinoza, Nien, Romero, and Yergey. "Analysis of
Varianceâ€“Principal Component Analysis: ..." Analytica Chimica Acta 544.1-2
(2005): 118-27.
</p>


<h3>See Also</h3>

<p>The output of this function is used in
used in <code>aovPCAscores</code> and <code>aovPCAloadings</code>.
Additional documentation at <a href="https://bryanhanson.github.io/ChemoSpec/">https://bryanhanson.github.io/ChemoSpec/</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 
# This example assumes the graphics output is set to ggplot2 (see ?GraphicsOptions).
library("ggplot2")
data(metMUD2)

# Original factor encoding:
levels(metMUD2$groups)

# Split those original levels into 2 new ones (re-code them)
new.grps &lt;- list(geneBb = c("B", "b"), geneCc = c("C", "c"))
mM3 &lt;- splitSpectraGroups(metMUD2, new.grps)

# run aov_pcaSpectra
PCAs &lt;- aov_pcaSpectra(mM3, fac = c("geneBb", "geneCc"))

p1 &lt;- aovPCAscores(mM3, PCAs, submat = 1, ellipse = "cls")
p1 &lt;- p1 + ggtitle("aovPCA: B vs b")
p1

p2 &lt;- aovPCAscores(mM3, PCAs, submat = 2)
p2 &lt;- p2 + ggtitle("aovPCA: C vs c")
p2

p3 &lt;- aovPCAscores(mM3, PCAs, submat = 3)
p3 &lt;- p3 + ggtitle("aovPCA: Interaction Term")
p3

p4 &lt;- aovPCAloadings(spectra = mM3, PCA = PCAs)
p4 &lt;- p4 + ggtitle("aov_pcaSpectra: Bb Loadings")
p4

## End(Not run)
</code></pre>


</div>