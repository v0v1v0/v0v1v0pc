<div class="container">

<table style="width: 100%;"><tr>
<td>residuals</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extract Model Residuals</h2>

<h3>Description</h3>

<p>Extracts model residuals from an <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> object inheriting class ‘<code>cglasso</code>’.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'cglasso'
residuals(object, type = c("observed", "working"), lambda.id, rho.id,
          drop = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> object inheriting class ‘<code>cglasso</code>’, that is, the output of the model-fitting functions <code>cglasso</code> and <code>cggm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>a description of the desired residuals (see section ‘Details’).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.id</code></td>
<td>
<p>a vector of integers used to specify the <code class="reqn">\lambda</code>-values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho.id</code></td>
<td>
<p>a vector of integers used to specify the <code class="reqn">\rho</code>-values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop</code></td>
<td>
<p>logical. Dimensions can only be dropped if their extent is one.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The accessor function ‘<code>residuals</code>’ returns an array storing the ‘observed’ or ‘working’ residuals, depending on the argument <code>type</code>.
</p>
<p>The ‘observed’ residuals are defined as the difference between the observed response values and the corresponding fitted expected values. For missing and censored response values, the ‘observed’ residuals are set equal to ‘<code>NA</code>’.
</p>
<p>The ‘working’ residuals are obtained as a byproduct of the EM-algorithm used to fit the model. In the E-step, the algorithm computes the ‘working’ response matrix, that is, the response matrix with missing values replaced by the conditional expected values of the multivariate normal distribution and censored values replaced by the conditional expected values of the multivariate truncated normal distribution. The ‘working’ residuals are defined as the difference between ‘working’ responses and fitted expected values. 
</p>


<h3>Value</h3>

<p>The accessor function ‘<code>residuals</code>’ returns an array storing the desired residuals.
</p>


<h3>Author(s)</h3>

<p>Luigi Augugliaro (<a href="mailto:luigi.augugliaro@unipa.it">luigi.augugliaro@unipa.it</a>)</p>


<h3>See Also</h3>

<p>Model-fitting functions <code>cglasso</code>, <code>cggm</code> and the accessor functions <code>coef.cglasso</code>, <code>fitted.cglasso</code>, <code>predict.cglasso</code> and <code>impute</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(123)
# Y ~ N(0, Sigma) and probability of left/right censored values equal to 0.05
n &lt;- 1000L
p &lt;- 3L
rho &lt;- 0.3
Sigma &lt;- outer(1L:p, 1L:p, function(i, j) rho^abs(i - j))
Z &lt;- rcggm(n = n, Sigma = Sigma, probl = 0.05, probr = 0.05)
out &lt;- cglasso(. ~ ., data = Z)
residuals(out, type = "observed", rho.id = 3L, drop = TRUE)
residuals(out, type = "working", rho.id = 3L, drop = TRUE)

# Y ~ N(b0 + XB, Sigma)  and probability of left/right censored values equal to 0.05
n &lt;- 1000L
p &lt;- 3L
q &lt;- 2
b0 &lt;- runif(p)
B &lt;- matrix(runif(q * p), nrow = q, ncol = p)
X &lt;- matrix(rnorm(n * q), nrow = n, ncol = q)
rho &lt;- 0.3
Sigma &lt;- outer(1L:p, 1L:p, function(i, j) rho^abs(i - j))
Z &lt;- rcggm(n = n, b0 = b0, X = X, B = B, Sigma = Sigma, probl = 0.05, probr = 0.05)
out &lt;- cglasso(. ~ ., data = Z)
residuals(out, type = "observed", lambda.id = 3L, rho.id = 3L, drop = TRUE)
residuals(out, type = "working", lambda.id = 3L, rho.id = 3L, drop = TRUE)
</code></pre>


</div>