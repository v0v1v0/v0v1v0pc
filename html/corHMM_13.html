<div class="container">

<table style="width: 100%;"><tr>
<td>plotMKmodel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot a Markov model</h2>

<h3>Description</h3>

<p>Plots a diagram of a Markov model from the output of corHMM or a custom index matrix</p>


<h3>Usage</h3>

<pre><code class="language-R">plotMKmodel(corhmm.obj, rate.cat = NULL, display = "column", color = c("blue", "red"), 
arrow.scale = 1, text.scale = 1, vertex.scale = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>corhmm.obj</code></td>
<td>
<p>an object of class corHMM or matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate.cat</code></td>
<td>
<p>if using a custom matrix then the number of rate categories must be indicated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>display</code></td>
<td>
<p>the structure of the plot. one of "column", "square", or "row".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color</code></td>
<td>
<p>Either, 1. a vector of 2 colors to create a gradient from low transition rates (first element) to high transition rates (second element), or 2. "col.blind" which will use the color pallete "plasma" from viridis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arrow.scale</code></td>
<td>
<p>determines the size of the arrows for the Markov diagram.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text.scale</code></td>
<td>
<p>determines the size of the text for the plotted matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vertex.scale</code></td>
<td>
<p>determines the size of the text for the Markov diagram.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Plots Markov models in a ball and stick type diagram next to its corresponding matrix. If plotting a hidden rates model it will produce a compound plot describing how the different rate classes are related to one another. If the input is a <code>corHMM</code> result then arrows are colored by relative rate. If the input is a custom matrix arrows are colored by the paramater index.
</p>


<h3>Value</h3>

<p>Returns a ball and stick diagram of the input model.  
</p>


<h3>Author(s)</h3>

<p>James D. Boyko</p>


<h3>References</h3>

<p>Boyko, J. D., and J. M. Beaulieu. 2021. Generalized hidden Markov models for phylogenetic comparative datasets. Methods in Ecology and Evolution 12:468-478.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(primates)
phy &lt;- primates[[1]]
phy &lt;- multi2di(phy)
data &lt;- primates[[2]]
# create a legend and rate mat from a multi-character dataset.
LegendAndRateMat &lt;- getStateMat4Dat(data)
rate.mat &lt;- LegendAndRateMat$rate.mat
legend &lt;- LegendAndRateMat$legend

# To create a hidden markov model first define your rate classes (state-dependent processes)
# R1 will be a manually created SYM model
R1 &lt;- equateStateMatPars(rate.mat, c(1:6))
# R2 will only allow transitions between 1 and 2
R2 &lt;- dropStateMatPars(rate.mat, c(3,4))
# R1 and R2 will transtion at equal rates (i.e. the parameter process will be ER)
P &lt;- getRateCatMat(2)
P &lt;- equateStateMatPars(P, c(1,2))
# combine our state-dependnet processes and parameter process
HMM &lt;- getFullMat(list(R1, R2), P)
# plot the input
plotMKmodel(HMM, rate.cat = 2)

# This can now be used in a corHMM model
CustomModel &lt;- corHMM(phy = phy, data = data, rate.cat = 2, rate.mat = HMM, node.states = "none")
# plot the output
plotMKmodel(CustomModel)

</code></pre>


</div>