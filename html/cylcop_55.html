<div class="container">

<table style="width: 100%;"><tr>
<td>fit_cylcop_ml</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate Parameters of a Circular-Linear Copula According to Maximum Likelihood</h2>

<h3>Description</h3>

<p>The code of this function is based on <code>copula::fitCopula()</code>.
A circular-linear copula is fit to a set of bivariate observations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit_cylcop_ml(
  copula,
  theta,
  x,
  parameters = NULL,
  start = NULL,
  lower = NULL,
  upper = NULL,
  optim.method = "L-BFGS-B",
  optim.control = list(maxit = 100),
  estimate.variance = FALSE,
  traceOpt = FALSE
)

optML(
  copula,
  theta,
  x,
  parameters = NULL,
  start = NULL,
  lower = NULL,
  upper = NULL,
  optim.method = "L-BFGS-B",
  optim.control = list(maxit = 100),
  estimate.variance = FALSE,
  traceOpt = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>copula</code></td>
<td>
<p><span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> object of class '<code>cyl_copula</code>'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>numeric vector of angles
(measurements of a circular variable) or "circular" component of pseudo-observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>numeric vector of step lengths
(measurements of a linear variable) or "linear" component of pseudo-observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameters</code></td>
<td>
<p>vector of character strings
holding the names of the parameters to be optimized.
These can be any parameters in <code>copula@parameters</code>. Default is to
optimize the first 2 parameters or the single parameter if <code>copula</code> only
has 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>vector of starting values of the parameters. Default is
to take the starting values from <code>copula</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>(optional) vector of lower bounds of the parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>(optional) vector of upper bounds of the parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optim.method</code></td>
<td>
<p>character string, optimizer used in
<code>optim()</code>, can be
<code>"Nelder-Mead"</code>, <code>"BFGS"</code>, <code>"CG"</code>, <code>"L-BFGS-B"</code>,
<code>"SANN"</code>, or <code>"Brent"</code>. Default is "L-BFGS-B".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optim.control</code></td>
<td>
<p>list of additional controls passed to
<code>optim()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate.variance</code></td>
<td>
<p>logical value, denoting whether to include an
estimate of the variance (NOT YET IMPLEMENTED).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>traceOpt</code></td>
<td>
<p>logical value, whether to print information regarding
convergence, current values, etc. during the optimization process.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The data is first converted to pseudo observations to which
the copula is then fit. Therefore, the result of the optimization will be
exactly the same whether measurements (<code>theta=theta</code> and <code>x=x</code>)
or pseudo observations (<code>theta=copula::pobs(theta,x)[,1]</code>
and <code>x=copula::pobs(theta,x)[,2]</code>) are provided.
If you wish to fit parameters of a '<code>Copula</code>' object
(package '<span class="pkg">copula</span>'), use the function <code>copula::fitCopula()</code>.
<code>optML()</code> is an alias for <code>fit_cylcop_ml</code>.
</p>


<h3>Value</h3>

<p>A list of length 3 containing the same type of '<code>cyl_copula</code>'
object as <code>copula</code>, but with optimized parameters, the log-likelihood
and the AIC.
</p>


<h3>References</h3>

<p>Hodel FH, Fieberg JR (2022).
“Circular-Linear Copulae for Animal Movement Data.”
<em>Methods in Ecology and Evolution</em>.
<a href="https://doi.org/10.1111/2041-210X.13821">doi:10.1111/2041-210X.13821</a>.
</p>
<p>Hodel FH, Fieberg JR (2021).
“Cylcop: An R Package for Circular-Linear Copulae with Angular Symmetry.”
<em>bioRxiv</em>.
<a href="https://doi.org/10.1101/2021.07.14.452253">doi:10.1101/2021.07.14.452253</a>, <a href="https://www.biorxiv.org/content/10.1101/2021.07.14.452253v3/">https://www.biorxiv.org/content/10.1101/2021.07.14.452253v3/</a>.
</p>


<h3>See Also</h3>

<p><code>copula::fitCopula()</code>, <code>fit_cylcop_cor()</code>,
<code>opt_auto()</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(123)

sample &lt;- rcylcop(100,cyl_quadsec(0.1))
fit_cylcop_ml(copula = cyl_quadsec(),
  theta = sample[,1],
  x = sample[,2],
  parameters = "a",
  start = 0
)
fit_cylcop_ml(copula = cyl_rect_combine(copula::frankCopula()),
  theta = sample[,1],
  x = sample[,2],
  parameters = "alpha",
  start = 1
)


sample &lt;- rjoint(
  n = 100,
  copula = cyl_cubsec(0.1, -0.08),
  marginal_1 = list(name = "vonmisesmix", coef = list(
     mu = c(pi, 0),
     kappa = c(2, 5),
     prop = c(0.3, 0.7)
    )),
  marginal_2 = list(name = "exp", coef = list(0.3))
  )
  fit_cylcop_ml(copula = cyl_cubsec(),
  theta = sample[,1],
  x = sample[,2],
  parameters = c("a","b"),
  start = c(0,0),
  upper= c(0.1, 1/(2*pi))
)

optML(copula = cyl_quadsec(),
  theta = sample[,1],
  x = sample[,2],
  parameters = "a",
  start = 0
)
</code></pre>


</div>