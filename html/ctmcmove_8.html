<div class="container">

<table style="width: 100%;"><tr>
<td>path2ctmc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Function to turn a discrete-time continuous-space path into a CTMC path.

</h2>

<h3>Description</h3>

<p>This function takes a movement path defined by xyt values (not
necessarily equally spaced in time), and converts it into a CTMC path
(a continuous-time discrete-space path on grid cells in a raster).

</p>


<h3>Usage</h3>

<pre><code class="language-R">path2ctmc(xy, t, rast,directions=4,zero.idx=integer(),print.iter=FALSE,
method="ShortestPath")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xy</code></td>
<td>

<p>A matrix of x,y locations at T time points.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>

<p>A vector of T times associated with the T locations in "xy".

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rast</code></td>
<td>

<p>A raster object or raster stack object that will define the
discrete-space grid cells for the CTMC movement path.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>directions</code></td>
<td>

<p>Integer.  Either 4 (indicating a "Rook's neighborhood" of 4
neighboring grid cells) or 8 (indicating a
"King's neighborhood" of 8 neighboring grid cells).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zero.idx</code></td>
<td>

<p>Integer vector of the indices of raster cells that are not passable
and should be excluded.  These are cells where movement should be
impossible.  Default is zero.idx=integer(). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.iter</code></td>
<td>

<p>Logical.  If true, then the progress stepping through each
observed location in "xy" and "t" will be output in the 
terminal.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>Specifies interpolation method.  Either "ShortestPath", which uses
the shortest graphical path on the raster graph, or "LinearInterp",
which linearly interpolates between observed locations.
"ShortestPath" is slower, slightly more accurate, and allows for
impassible barriers specified through "zero.idx".  "LinearInterp" is
faster but does not allow for impassible barriers.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This takes a xyt path and turns it into a list of the embedded chain
and residence times of a continuous time Markov chain walk on the
graph.  A "zero.idx" indicates impassible grid cells.  When successive
(x,y) locations are not in the same grid cell, a shortest path between
locations is found using the "shortestPath" function from gdistance,
and the time between (x,y) locations is then 
evenly divided between all grid cells in the shortest path.  

</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ec</code></td>
<td>
<p>A vector of the sequential grid cells (the embedded chain)
in the CTMC movement path</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rt</code></td>
<td>
<p>A vector of residence times in each sequential grid cell in
the CTMC movement path</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trans.times</code></td>
<td>
<p>A vector of times in which the movement path enters
the grid cell in "ec".</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Ephraim M. Hanks

</p>


<h3>References</h3>

<p>Hanks, E. M.; Hooten, M. B. &amp; Alldredge, M. W. Continuous-time
Discrete-space Models for Animal Movement The Annals of Applied
Statistics, 2015, 9, 145-165
</p>



<h3>Examples</h3>

<pre><code class="language-R">## For example code, do
##
## &gt; help(ctmcMove)
</code></pre>


</div>