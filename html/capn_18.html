<div class="container">

<table style="width: 100%;"><tr>
<td>pdotsim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulation of Pdot-approximation</h2>

<h3>Description</h3>

<p>The function provides the Pdot-approximation simulation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pdotsim(pdotcoeff, stock, sdot, dsdotds, wval, dwds)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pdotcoeff</code></td>
<td>
<p>An approximation result from <code>pdotaprox</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stock</code></td>
<td>
<p>An array of stock</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdot</code></td>
<td>
<p>An array of ds/dt, <code class="reqn">\dot{s}=\frac{ds}{dt}</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dsdotds</code></td>
<td>
<p>An array of d(sdot)/ds, <code class="reqn">\frac{d \dot{s}}{d s}</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wval</code></td>
<td>
<p>An array of <code class="reqn">W</code>-value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dwds</code></td>
<td>
<p>An array of dw/ds, <code class="reqn">\frac{dW}{ds}</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Let <code class="reqn">\hat{\beta}</code> be the vector of approximation coefficents from the results of <code>pdotaprox</code> function.
The estimated shadow price (accounting) price of stock over the given approximation interval of
<code class="reqn">s \in [a,b]</code>, <code class="reqn">\hat{p}</code> can be calculated as:<br><br><code class="reqn">\hat{p} = \frac{ W_{s} + \mathbf{\mu \beta} }{ \delta - \dot{s}_{s} } </code>.<br><br>
The estimated value function is:<br><br><code class="reqn"> \hat{V} = \frac{1}{\delta} \left( W + \hat{p} \dot{s} \right)  </code>.<br><br>
For more detils see <a href="http://www.journals.uchicago.edu/doi/abs/10.1086/676034">Fenichel and Abbott (2014)</a> and <a href="http://www.pnas.org/content/113/9/2382">Fenichel et al. (2016)</a>.
</p>


<h3>Value</h3>

<p>A list of approximation resuts: shadow (accounting) prices, inclusive wealth, and value function, stock, and W values. Use <code>results$item</code> (or <code>results[["item"]]</code>) to import each result item.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>shadowp</code></td>
<td>
<p>Shadow price</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vfun</code></td>
<td>
<p>Value function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stock</code></td>
<td>
<p>Stock</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wval</code></td>
<td>
<p>W-value</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Fenichel, Eli P. and Joshua K. Abbott. (2014) "<a href="http://www.journals.uchicago.edu/doi/abs/10.1086/676034">Natural Capital: From Metaphor to Measurement</a>."
<em>Journal of the Association of Environmental Economists</em>. 1(1/2):1-27.<br>
Fenichel, Eli P., Joshua K. Abbott, Jude Bayham, Whitney Boone, Erin M. K. Haacker, and Lisa Pfeiffer. (2016) "<a href="http://www.pnas.org/content/113/9/2382">Measuring the Value of Groundwater and Other Forms of Natural Capital</a>."
<em>Proceedings of the National Academy of Sciences </em>.113:2382-2387.
</p>


<h3>See Also</h3>

<p><code>pdotaprox</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## 1-D Reef-fish example: see Fenichel and Abbott (2014)
data("GOM")
nodes &lt;- chebnodegen(param$nodes,param$lowerK,param$upperK)
simuDataPdot &lt;- cbind(nodes,sdot(nodes,param),
                      dsdotds(nodes,param),dsdotdss(nodes,param),
                      dwds(nodes,param),dwdss(nodes,param))
Aspace &lt;- aproxdef(param$order,param$lowerK,param$upperK,param$delta)
pdotC &lt;- pdotaprox(Aspace,simuDataPdot[,1],simuDataPdot[,2],
                   simuDataPdot[,3],simuDataPdot[,4],
                   simuDataPdot[,5],simuDataPdot[,6])
GOMSimPdot &lt;- pdotsim(pdotC,simuDataPdot[,1],simuDataPdot[,2],simuDataPdot[,3],
                      profit(nodes,param),simuDataPdot[,5])
# Shadow Price
plotgen(GOMSimPdot, xlabel="Stock size, s", ylabel="Shadow price")

# Value function and profit
plotgen(GOMSimPdot,ftype="vw",
        xlabel="Stock size, s",
        ylabel=c("Value Function","Profit"))
</code></pre>


</div>