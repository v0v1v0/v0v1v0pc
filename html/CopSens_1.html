<div class="container">

<table style="width: 100%;"><tr>
<td>bcalibrate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calibration for Binary Outcomes</h2>

<h3>Description</h3>

<p>Calibrates the naive estimates to account for unobserved confounding when outcome
variables are binary. The calibration can be done with user-specific sensitivity parameter or
with our pre-provided calibration methods, the worst-case calibration for a single contrast
or multivariate calibration for multiple contrasts.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bcalibrate(
  y,
  tr,
  t,
  gamma,
  R2 = NULL,
  mu_y_t = NULL,
  mu_u_tr = NULL,
  mu_u_t = NULL,
  cov_u_t = NULL,
  nU = NULL,
  nsim = 4000,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p><code>data.frame</code>, <code>matrix</code> or <code>vector</code>. Binary outcome variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tr</code></td>
<td>
<p><code>data.frame</code>. Treatment variables with rows corresponding to observations and columns
to variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p><code>data.frame</code>. Treatment arms of interest.
May contain a single or multiple treatments in rows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>a vector specifying the direction of sensitivity parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R2</code></td>
<td>
<p>an optional scalar or vector specifying the proportion of residual variance in outcome given the
treatment that can be explained by confounders, which determines the magnitude of sensitivity parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu_y_t</code></td>
<td>
<p>an optional scalar or vector that contains naive estimates of treatment effects
ignoring confounding.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu_u_tr</code></td>
<td>
<p>an optional matrix of conditional confounder means for all observed treatments
with latent variables in columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu_u_t</code></td>
<td>
<p>an optional matrix of conditional confounder means for treatments of interest
with latent variables in columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov_u_t</code></td>
<td>
<p>an optional covariance matrix of confounders conditional on treatments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nU</code></td>
<td>
<p>Number of latent confounders to consider.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>an optional scalar specifying the number of sample draws.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to <code>kEstimate</code>or <code>pca</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>data.frame</code> with naive and calibrated estimates of population average outcome receiving
treatment <code>t</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# load the example data #
y &lt;- GaussianT_BinaryY$y
tr &lt;- subset(GaussianT_BinaryY, select = -c(y))
t1 &lt;- tr[1:5,]
t2 &lt;- rep(0, times = ncol(tr))
# calibration #
est_b &lt;- bcalibrate(y = y, tr = tr, t = rbind(t1, t2),
                    nU = 3, gamma = c(1.27, -0.28, 0),
                    R2 = c(0.2, 0.7))
est_b_rr &lt;- list(est_df = est_b$est_df[1:5,] / as.numeric(est_b$est_df[6,]),
                 R2 = c(0.2, 0.7))
plot_estimates(est_b_rr)

</code></pre>


</div>