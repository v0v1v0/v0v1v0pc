<div class="container">

<table style="width: 100%;"><tr>
<td>zhatvalues</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate the Hat Matrix or Leverage Scores of a Complex Linear Model</h2>

<h3>Description</h3>

<p>This function returns either the full hat matrix (AKA the projection matrix) of a complex "lm" or "rlm" object, or the diagonal elements of same.
The later are also known as the influence scores.
It performs the same basic role as stats::hat and stats::hatvalues do for numeric fits, but is quite a bit simpler
and rather less versatile.
<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script></p>


<h3>Usage</h3>

<pre><code class="language-R">zhatvalues(model, full = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>A complex linear fit object, of class "zlm" or "rzlm". An object with numeric residuals will produce a warning and NULL output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>full</code></td>
<td>
<p>Logical. If TRUE, return the entire hat matrix. If FALSE, return a vector of the diagonal elements of the hat matrix. These are the influence scores. Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments. Not used.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For unweighted least-squares fits the hat matrix is calculated from the model matrix, <i>X = </i><code>model$x</code>, as <br>
\[H = X (X^t X)^{-1} X^t\]<br>
For rlm or weighted least-squares fits the hat matrix is calculated as<br>
\[H = X (X^t W X)^{-1} X^t W\]
Where <i>^t</i> represents conjugate transpose, and <i>W</i> is the identity matrix times the user provided weights and the final IWLS weights if present. <br>
Note that this function requires that the model matrix be returned when calling lm or rlm.<br>
The diagonals will be purely real, and are converted to numeric if <code>full == FALSE</code>.
</p>


<h3>Value</h3>

<p>Either a <i>(n x n)</i> complex matrix or a length <i>n</i> numeric vector.
</p>


<h3>See Also</h3>

<p>stats::hatvalues, stats::hat, cooks.distance
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(4242)
n &lt;- 8
slop &lt;- complex(real = 4.23, imaginary = 2.323)
interc &lt;- complex(real = 1.4, imaginary = 1.804)
e &lt;- complex(real=rnorm(n)/6, imaginary=rnorm(n)/6)
xx &lt;- complex(real= rnorm(n), imaginary= rnorm(n))
tframe &lt;- data.frame(x = xx, y= slop*xx + interc + e)
fit &lt;- lm(y ~ x, data = tframe, weights = rep(1,n))
zhatvalues(fit)
</code></pre>


</div>