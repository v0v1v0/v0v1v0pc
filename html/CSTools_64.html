<div class="container">

<table style="width: 100%;"><tr>
<td>RegimesAssign</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function for matching a field of anomalies with 
a set of maps used as a reference (e.g. clusters obtained from the WeatherRegime function).</h2>

<h3>Description</h3>

<p>This function performs the matching between a field of anomalies 
and a set of maps which will be used as a reference. The anomalies will be 
assigned to the reference map for which the minimum Eucledian distance 
(method = 'distance') or highest spatial correlation (method = 'ACC') is 
obtained.
</p>


<h3>Usage</h3>

<pre><code class="language-R">RegimesAssign(
  data,
  ref_maps,
  lat,
  method = "distance",
  composite = FALSE,
  memb = FALSE,
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>An array containing anomalies with named dimensions: dataset, 
member, sdate, ftime, lat and lon.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ref_maps</code></td>
<td>
<p>Array with 3-dimensions ('lon', 'lat', 'cluster') containing 
the maps/clusters that will be used as a reference for the matching.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lat</code></td>
<td>
<p>A vector of latitudes corresponding to the positions provided in 
data and ref_maps.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Whether the matching will be performed in terms of minimum 
distance (default = 'distance') or the maximum spatial correlation 
(method = 'ACC') between the maps.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>composite</code></td>
<td>
<p>A logical parameter indicating if the composite maps are 
computed or not (default = FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>memb</code></td>
<td>
<p>A logical value indicating whether to compute composites for 
separate members (default FALSE) or as unique ensemble (TRUE). This option 
is only available for when parameter 'composite' is set to TRUE and the data 
object has a dimension named 'member'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>The number of multicore threads to use for parallel computation.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with elements <code>$composite</code> (3-d array (lon, lat, k) 
containing the composites k = 1,..,K for case (*1) or only k = 1 for any specific 
cluster, i.e., case (*2)) (only if composite = 'TRUE'), <code>$pvalue</code> (array 
with the same structure as <code>$composite</code> containing the pvalue of the 
composites obtained through a t-test that accounts for the serial dependence 
of the data with the same structure as Composite.) (only if composite='TRUE'),
<code>$cluster</code> (array with the same dimensions as data (except latitude and 
longitude which are removed) indicating the ref_maps to which each point is 
allocated.), <code>$frequency</code> (A vector of integers (from k = 1, ... k n 
reference maps) indicating the percentage of assignations corresponding to 
each map.),
</p>


<h3>Author(s)</h3>

<p>Ver√≥nica Torralba - BSC, <a href="mailto:veronica.torralba@bsc.es">veronica.torralba@bsc.es</a>
</p>


<h3>References</h3>

<p>Torralba, V. (2019) Seasonal climate prediction for the wind 
energy sector: methods and tools for the development of a climate service. 
Thesis. Available online: <a href="https://eprints.ucm.es/56841/">https://eprints.ucm.es/56841/</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data &lt;- array(abs(rnorm(1280, 282.7, 6.4)), dim = c(dataset = 2, member = 2, 
                                                   sdate = 3, ftime = 3, 
                                                   lat = 4, lon = 4))
regimes &lt;- WeatherRegime(data = data, lat = seq(47, 44),
                        EOFs = FALSE, ncenters = 4)$composite
res1 &lt;- RegimesAssign(data = data, ref_maps = drop(regimes), 
                     lat = seq(47, 44), composite = FALSE)
</code></pre>


</div>