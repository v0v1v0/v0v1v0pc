<div class="container">

<table style="width: 100%;"><tr>
<td>getStateMat4Dat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Produce an index matrix and legend from a dataset</h2>

<h3>Description</h3>

<p>Takes a dataset to produce an index matrix that corresponds to a single state-dependent process (i.e. a single rate category) and a legend which matches input data to the rows and columns of the index matrix and corHMM solution.</p>


<h3>Usage</h3>

<pre><code class="language-R">getStateMat4Dat(data, model = "ARD", dual = FALSE, collapse = TRUE, indep = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data matrix containing species information in the same format as the main <code>corHMM</code> function: column[,1] is species names, column[,2:n] are the discrete states.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>One of "ARD", "SYM", or "ER". ARD: all rates differ. SYM: rates between any two states do not differ. ER: all rates are equal.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dual</code></td>
<td>
<p>A boolean indicating whether or not to include dual transitions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>collapse</code></td>
<td>
<p>a boolean indicating whether to collapse multiple character combinations into only the observed states. For example, if true a two character dataset contained (0,0), (1,0), and (1,1), this would be collapsed into 1,2,3. However, if set to false it would 1,2,4. In combination with a custom rate matrix this allows for the estimation of transitions between the unobserved character combination. The default is <code>TRUE</code></p>
</td>
</tr>
</table>
<p>.
</p>
<table><tr style="vertical-align: top;">
<td><code>indep</code></td>
<td>
<p>A boolean indicating whether or not to return an independent or correlated model.</p>
</td>
</tr></table>
<h3>Details</h3>

<p>This function will generate an index matrix based on user provided data. It provides a useful starting point for further modifications using <code>dropStateMatPars</code>, <code>equateStateMatPars</code>, and <code>getFullMat</code>. If more than a single column of data is given double transitions between characters are disallowed. For example, if character 1 is the presence or absence of limbs, and character 2 is the presence or absence of fingers, then the transition from absence of limbs and fingers to presence of limbs and fingers is automatically disallowed. This is consistent with Pagel's (1994) model of correlated character evolution. 
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>$legend</code></td>
<td>
<p>A named vector. The elements of the vector are all the unique state combinations in the user data. The names of the vector are the state number assigned to each combination.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$rate.mat</code></td>
<td>
<p>A rate index matrix describing a single rate class.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>James D. Boyko</p>


<h3>References</h3>

<p>Pagel, M. 1994. Detecting correlated evolution on phylogenies: a gneeral method for the comparative analysis of discrete characters. Proc. R. Soc. Lond. B 255:37-45.
</p>


<h3>See Also</h3>

<p><code>getFullmat</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(primates)
phy &lt;- primates[[1]]
phy &lt;- multi2di(phy)
data &lt;- primates[[2]]
# create a legend and rate mat from a multi-character dataset.
LegendAndRateMat &lt;- getStateMat4Dat(data)
rate.mat &lt;- LegendAndRateMat$rate.mat
legend &lt;- LegendAndRateMat$legend

</code></pre>


</div>