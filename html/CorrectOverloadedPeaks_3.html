<div class="container">

<table style="width: 100%;"><tr>
<td>CorrectOverloadedPeaks</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Correct Overloaded Peaks from GC-MS data.</h2>

<h3>Description</h3>

<p><code>CorrectOverloadedPeaks</code> will take an xcmsRaw data structure 
(or any imported mzXML) and search for overloaded peaks within the mass traces. 
It will correct overloaded peaks automatically using an Gaussian or 
IsotopicRatio approach, generate QC plots and write the corrected data 
back into the original xcmsRaw.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CorrectOverloadedPeaks(
  data = NULL,
  method = c("Isoratio", "Gauss", "EMG"),
  detection_limit = 1,
  ds = NULL,
  silent = TRUE,
  testing = FALSE,
  attotwm = FALSE,
  region = NULL,
  peak = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>An xcmsRaw-object or an mzXML-object as imported by <code>read.mzXML</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Either Gauss or EMG (usually better results) or Isoratio (more robust for non-Gaussian peak shapes).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>detection_limit</code></td>
<td>
<p>If=1 only peaks hitting detector saturation (ds) will be corrected, can be lowered to 0.95 to catch also peaks going into saturation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ds</code></td>
<td>
<p>Detector saturation. Will be determined based on data if not specified explicitly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>QC-plots will be generated if silent=FALSE and additional Warnings() will be generated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>testing</code></td>
<td>
<p>Will automatically set silent=FALSE and store all extracted regions with overloaded peaks in the working directory as <code>cor_df_all.RData</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>attotwm</code></td>
<td>
<p>All-the-Time-of-the-World-Mode. If calculation time doesn't matter try this out. :)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>region</code></td>
<td>
<p>From an initial QC-Plot file you may reprocess a specific overloaded region. Don't forget to specify the ds parameter explicitly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>peak</code></td>
<td>
<p>You may further restrict the reprocessing to a specific peak within the region.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is a high level function to batch pre-process metabolomics data 
which are partially overloaded before continuing with the standard workflow 
of peak identification etc.. It relies internally on <code>FitGaussPeak</code> 
and <code>FitPeakByIsotopicRatio</code> to modify data of individual intensity 
signal. Basically the function aims to identify automatically overloaded regions
and extracts base peak chromatograms for all overloaded m/z traces within these 
regions, which are corrected and put back into the original data structure. 
For simplicity some potentially interesting parameters are hidden at the top of 
the function definition. They have been set to values determined empirically to 
be working for a Bruker impact II MS (high-res QTOF) coupled to GC and LC via 
APCI and ESI respectively. For more details please 
see <a href="https://doi.org/10.1021/acs.analchem.6b02515">doi:10.1021/acs.analchem.6b02515</a>.
</p>


<h3>Value</h3>

<p>An corrected xcmsRaw- or mzXML-object which can be exported to file. Additionally a QC-plot pdf-file if silent=FALSE.
</p>


<h3>References</h3>

<p><a href="https://doi.org/10.1021/acs.analchem.6b02515">doi:10.1021/acs.analchem.6b02515</a>
</p>


<h3>See Also</h3>

<p><code>ModelGaussPeak</code>
</p>
<p><code>FitGaussPeak</code>
</p>
<p><code>FitPeakByIsotopicRatio</code>
</p>
<p><code>read.mzXML</code>
</p>
<p><code>write.mzXML</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
  # load mzXML test data
  data(mzXML_data)
  CorrectOverloadedPeaks(data = mzXML_data, method = "EMG", silent = FALSE)

## End(Not run)

</code></pre>


</div>