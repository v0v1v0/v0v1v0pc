<div class="container">

<table style="width: 100%;"><tr>
<td>WaveDuration</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Heat and cold waves duration for n-dimensional arrays</h2>

<h3>Description</h3>

<p>This function computes the duration of a heat/cold wave as the number of 
consecutive days for which the maximum/minimum temperature is exceeding/below 
a threshold over a minimum number of days in month or seasonal resolution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">WaveDuration(
  data,
  threshold,
  op = "&gt;",
  spell.length = 6,
  by.seasons = TRUE,
  dates = NULL,
  calendar = NULL,
  ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A numeric n-dimensional array containing daily maximum or minimum 
temperature</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>An array with the threshold to be/not to be reach, usually 
given by the 90th/10th percentiles for heat/cold waves computed with the 
<code>Threshold</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>op</code></td>
<td>
<p>A character "&gt;" (by default) or "&gt;=" for heat waves and "&lt;" or "&lt;=" 
for cold waves indicating the operator must be used  to compare data to 
threshold.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spell.length</code></td>
<td>
<p>A number indicating the number of consecutive days with 
extreme temperature to be considered heat or cold wave.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by.seasons</code></td>
<td>
<p>If TRUE (by default), the wave duration is computed for each 
season (DJF/MAM/JJA/SON) separately. If FALSE is specified, the monthly wave 
duration is computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dates</code></td>
<td>
<p>A vector of dates including calendar attributes. If NULL (by 
default), the 'time' attributes of parameter 'data' is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>calendar</code></td>
<td>
<p>A character indicating the calendar type.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>The number of cores to be used when computing the wave duration.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of length 2:
</p>

<ul>
<li>
<p><code>$result</code>, an array with the same dimensions as the input 
<code>data</code>, but with the time dimension reduce from daily to monthly 
or seasonal resolution depending on the selected resolution in 
<code>by.season</code>.
</p>
</li>
<li>
<p><code>$years</code>, a vector of the years and season/months corresponding 
to the resolution selected in <code>by.season</code> and temporal length of 
the input <code>data</code>.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">##Example synthetic data:
data &lt;- 1:(2 * 3 * 31 * 5)
dim(data) &lt;- c(lon = 2, lat = 3, time = 31, model = 5)
time &lt;- as.POSIXct(paste(paste(1900, 1, 1:31, sep = "-"), paste(12, 0, 0.0, 
                  sep = ":")), tz = "CET")
metadata &lt;- list(time = list(standard_name = 'time', long_name = 'time', 
                calendar = 'standard', 
                units = 'days since 1970-01-01 00:00:00', prec = 'double', 
                dim = list(list(name ='time', unlim = FALSE))))
attr(time, "variables") &lt;- metadata                 
attr(data, 'Variables')$dat1$time &lt;- time
threshold &lt;- rep(40, 31)

a &lt;- WaveDuration(data, threshold, op = "&gt;", spell.length = 6, 
                 by.seasons = TRUE, ncores = NULL)
str(a)
</code></pre>


</div>