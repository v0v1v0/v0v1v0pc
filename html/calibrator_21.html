<div class="container">

<table style="width: 100%;"><tr>
<td>EK.eqn10.supp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Posterior mean of K</h2>

<h3>Description</h3>

<p>Estimates the posterior mean of K as per equation 10 of KOH2001S,
section 4.2
</p>


<h3>Usage</h3>

<pre><code class="language-R">EK.eqn10.supp(X.dist, D1, D2, H1, H2, d, hbar.fun,
   lower.theta, upper.theta, extractor, give.info=FALSE,
   include.prior=FALSE, phi, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X.dist</code></td>
<td>
<p>Probability distribution of <code>X</code>, in the form of a
two-element list.  The first element is the mean (which should have
name “<code>mean</code>”), and the second element is the variance
matrix, which should  be a positive definite matrix of the correct
size, and have name “var”</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D1</code></td>
<td>
<p>Matrix whose rows are the code run points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D2</code></td>
<td>
<p>Matrix whose rows are field observation points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H1</code></td>
<td>
<p>Regression function for <code>D1</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H2</code></td>
<td>
<p>Regression function for <code>D2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>Vector of code outputs and field observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include.prior</code></td>
<td>
<p>Boolean; passed to function <code>p.eqn8.supp()</code> (qv)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hbar.fun</code></td>
<td>
<p>Function that gives expectation (with respect to <code>X</code>)
of <code>h1(x,theta)</code> and <code>h2(x)</code> as per section 4.2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.theta</code></td>
<td>
<p>Lower integration limit for <code>theta</code> (NB: a vector)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper.theta</code></td>
<td>
<p>Lower integration limit for <code>theta</code> (NB: a
vector)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extractor</code></td>
<td>
<p>Extractor function; see <code>extractor.toy()</code> for
an example</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>give.info</code></td>
<td>
<p>Boolean, with default <code>FALSE</code> meaning to return
just the answer and <code>TRUE</code> to return the answer along with all
output from both integrations as performed by <code>adaptIntegrate()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>Hyperparameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Extra arguments passed to the integration
function.  If multidimensional (ie <code>length(theta)&gt;1</code>), then the
arguments are passed to <code>adaptIntegrate()</code>; if one dimensional, they
are passed to <code>integrate()</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function evaluates a numerical approximation to equation 10 of
section 4.2 of the supplement.
</p>
<p>Equation 10 integrates over the prior distribution of <code>theta</code>.  If
<code>theta</code> is a vector, multidimensional integration is necessary.
</p>
<p>In the case of multidimensional integration, function
<code>adaptIntegrate()</code> is used.
</p>
<p>In the case of one dimensional integration—theta being a
scalar—function <code>integrate()</code> of the stats package is used.
</p>
<p>Note that equation 10 is conditional on the observed data <strong>and</strong>
the hyperparameters
</p>


<h3>Value</h3>

<p>Returns a scalar
</p>


<h3>Note</h3>

<p>The function was not reviewed by the Journal of Statistical Software.
</p>
<p>The package formely used adapt package, but this is no longer
available on CRAN.  The package now uses the cubature package.
</p>


<h3>Author(s)</h3>

<p>Robin K. S. Hankin</p>


<h3>References</h3>


<ul>
<li>
<p>M. C. Kennedy and A. O'Hagan 2001. <em>Bayesian
calibration of computer models</em>.  Journal of the Royal Statistical
Society B, 63(3) pp425-464
</p>
</li>
<li>
<p>M. C. Kennedy and A. O'Hagan 2001.  <em>Supplementary details on
Bayesian calibration of computer models</em>, Internal report, University
of Sheffield.  Available at
<a href="http://www.tonyohagan.co.uk/academic/ps/calsup.ps">http://www.tonyohagan.co.uk/academic/ps/calsup.ps</a>
</p>
</li>
<li>
<p>R. K. S. Hankin 2005. <em>Introducing BACCO, an R bundle for
Bayesian analysis of computer code output</em>, Journal of Statistical
Software, 14(16)
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">1+1
## Not run: 
# Not run because it takes R CMD check too long

data(toys)
EK.eqn10.supp(X.dist=X.dist.toy, D1=D1.toy, D2=D2.toy,
          H1=H1.toy, H2=H2.toy, d=d.toy,
          hbar.fun=hbar.fun.toy, lower.theta=c(-3,-3,-3),
          upper.theta=c(3,3,3),extractor=extractor.toy,
          phi=phi.toy)

## End(Not run)
</code></pre>


</div>