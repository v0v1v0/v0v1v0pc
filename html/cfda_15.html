<div class="container">

<table style="width: 100%;"><tr>
<td>generate_Markov</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate Markov Trajectories</h2>

<h3>Description</h3>

<p>Simulate individuals from a Markov process defined by a transition matrix,
time spent in each time and initial probabilities.
</p>


<h3>Usage</h3>

<pre><code class="language-R">generate_Markov(
  n = 5,
  K = 2,
  P = (1 - diag(K))/(K - 1),
  lambda = rep(1, K),
  pi0 = c(1, rep(0, K - 1)),
  Tmax = 1,
  labels = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of trajectories to generate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>number of states</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>matrix containing the transition probabilities from one state to another.
Each row contains positive reals summing to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>time spent in each state</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi0</code></td>
<td>
<p>initial distribution of states</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tmax</code></td>
<td>
<p>maximal duration of trajectories</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p>state names. If <code>NULL</code>, integers are used</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For one individual, assuming the current state is <code class="reqn">s_j</code> at time <code class="reqn">t_j</code>,
the next state and time is simulated as follows:
</p>

<ol>
<li>
<p> generate one sample, <code class="reqn">d</code>, of an exponential law of parameter <code>lambda[s_j]</code>
</p>
</li>
<li>
<p> define the next time values as: <code class="reqn">t_{j+1} = t_j + d</code>
</p>
</li>
<li>
<p> generate the new state <code class="reqn">s_{j+1}</code> using a multinomial law with probabilities <code>Q[s_j,]</code>
</p>
</li>
</ol>
<h3>Value</h3>

<p>a data.frame with 3 columns: <code>id</code>, id of the trajectory, <code>time</code>,
time at which a change occurs and <code>state</code>, new state.
</p>


<h3>Author(s)</h3>

<p>Cristian Preda
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Simulate the Jukes-Cantor model of nucleotide replacement
K &lt;- 4
PJK &lt;- matrix(1 / 3, nrow = K, ncol = K) - diag(rep(1 / 3, K))
lambda_PJK &lt;- c(1, 1, 1, 1)
d_JK &lt;- generate_Markov(
  n = 100, K = K, P = PJK, lambda = lambda_PJK, Tmax = 10,
  labels = c("A", "C", "G", "T")
)

head(d_JK)
</code></pre>


</div>