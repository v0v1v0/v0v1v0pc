<div class="container">

<table style="width: 100%;"><tr>
<td>maxCorGrid</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>(Robust) maximum correlation via alternating series of grid searches</h2>

<h3>Description</h3>

<p>Compute the maximum correlation between two data sets via projection pursuit
based on alternating series of grid searches in two-dimensional subspaces of
each data set, with a focus on robust and nonparametric methods.
</p>


<h3>Usage</h3>

<pre><code class="language-R">maxCorGrid(
  x,
  y,
  method = c("spearman", "kendall", "quadrant", "M", "pearson"),
  control = list(...),
  nIterations = 10,
  nAlternate = 10,
  nGrid = 25,
  select = NULL,
  tol = 1e-06,
  standardize = TRUE,
  fallback = FALSE,
  seed = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>each can be a numeric vector, matrix or data frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string specifying the correlation functional to
maximize.  Possible values are <code>"spearman"</code> for the Spearman
correlation, <code>"kendall"</code> for the Kendall correlation, <code>"quadrant"</code>
for the quadrant correlation, <code>"M"</code> for the correlation based on a
bivariate M-estimator of location and scatter with a Huber loss function, or
<code>"pearson"</code> for the classical Pearson correlation (see
<code>corFunctions</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list of additional arguments to be passed to the specified
correlation functional.  If supplied, this takes precedence over additional
arguments supplied via the <code>...</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nIterations</code></td>
<td>
<p>an integer giving the maximum number of iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nAlternate</code></td>
<td>
<p>an integer giving the maximum number of alternate series
of grid searches in each iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nGrid</code></td>
<td>
<p>an integer giving the number of equally spaced grid points on
the unit circle to use in each grid search.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>select</code></td>
<td>
<p>optional; either an integer vector of length two or a list
containing two index vectors.  In the first case, the first integer gives
the number of variables of <code>x</code> to be randomly selected for determining
the order of the variables of <code>y</code> in the corresponding series of grid
searches, and vice versa for the second integer.  In the latter case, the
first list element gives the indices of the variables of <code>x</code> to be used
for determining the order of the variables of <code>y</code>, and vice versa for
the second integer (see “Details”).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>a small positive numeric value to be used for determining
convergence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>standardize</code></td>
<td>
<p>a logical indicating whether the data should be
(robustly) standardized.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fallback</code></td>
<td>
<p>logical indicating whether a fallback mode for robust
standardization should be used.  If a correlation functional other than the
Pearson correlation is maximized, the first attempt for standardizing the
data is via median and MAD.  In the fallback mode, variables whose MADs are
zero (e.g., dummy variables) are standardized via mean and standard
deviation.  Note that if the Pearson correlation is maximized,
standardization is always done via mean and standard deviation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>optional initial seed for the random number generator (see
<code>.Random.seed</code>).  This is only used if <code>select</code> specifies
the numbers of variables of each data set to be randomly selected for
determining the order of the variables of the respective other data set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to be passed to the specified correlation
functional.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The algorithm is based on alternating series of grid searches in
two-dimensional subspaces of each data set.  In each grid search,
<code>nGrid</code> grid points on the unit circle in the corresponding plane are
obtained, and the directions from the center to each of the grid points are
examined.  In the first iteration, equispaced grid points in the interval
<code class="reqn">[-\pi/2, \pi/2)</code> are used.  In each subsequent
iteration, the angles are halved such that the interval
<code class="reqn">[-\pi/4, \pi/4)</code> is used in the second iteration and so
on.  If only one data set is multivariate, the algorithm simplifies
to iterative grid searches in two-dimensional subspaces of the corresponding
data set.
</p>
<p>In the basic algorithm, the order of the variables in a series of grid
searches for each of the data sets is determined by the average absolute
correlations with the variables of the respective other data set.  Since
this requires to compute the full <code class="reqn">(p \times q)</code> matrix of
absolute correlations, where <code class="reqn">p</code> denotes the number of variables of
<code>x</code> and <code class="reqn">q</code> the number of variables of <code>y</code>, a faster
modification is available as well.  In this modification, the average
absolute correlations are computed over only a subset of the variables of
the respective other data set.  It is thereby possible to use randomly
selected subsets of variables, or to specify the subsets of variables
directly.
</p>
<p>Note that also the data sets are ordered according to the maximum average
absolute correlation with the respective other data set to ensure symmetry
of the algorithm.
</p>


<h3>Value</h3>

<p>An object of class <code>"maxCor"</code> with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>cor</code></td>
<td>
<p>a numeric giving the maximum correlation estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>numeric; the weighting vector for <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>numeric; the weighting vector for <code>y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centerX</code></td>
<td>
<p>a numeric vector giving the center estimates used in
standardization of <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centerY</code></td>
<td>
<p>a numeric vector giving the center estimates used in
standardization of <code>y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaleX</code></td>
<td>
<p>a numeric vector giving the scale estimates used in
standardization of <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaleY</code></td>
<td>
<p>a numeric vector giving the scale estimates used in
standardization of <code>y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched function call.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Andreas Alfons
</p>


<h3>References</h3>

<p>A. Alfons, C. Croux and P. Filzmoser (2016) Robust maximum association
between data sets: The <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> Package <span class="pkg">ccaPP</span>.  <em>Austrian Journal of
Statistics</em>, <b>45</b>(1), 71–79.
</p>
<p>A. Alfons, C. Croux and P. Filzmoser (2016) Robust maximum association
estimators.  <em>Journal of the American Statistical Association</em>,
<b>112</b>(517), 435–445.
</p>


<h3>See Also</h3>

<p><code>maxCorProj</code>, <code>ccaGrid</code>,
<code>corFunctions</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("diabetes")
x &lt;- diabetes$x
y &lt;- diabetes$y

## Spearman correlation
maxCorGrid(x, y, method = "spearman")
maxCorGrid(x, y, method = "spearman", consistent = TRUE)

## Pearson correlation
maxCorGrid(x, y, method = "pearson")

</code></pre>


</div>