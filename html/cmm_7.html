<div class="container">

<table style="width: 100%;"><tr>
<td>ConstraintMatrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>ConstraintMatrix</h2>

<h3>Description</h3>

<p>Returns hierarchical model constraint matrix, i.e., nullspace of design matrix
</p>


<h3>Usage</h3>

<pre><code class="language-R">ConstraintMatrix(var, suffconfigs, dim, SubsetCoding = "Automatic")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>
<p>character or numeric vector containing variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>suffconfigs</code></td>
<td>
<p>subvector or list of subvectors of <code>var</code> indicating the sufficient configurations or highest order interactions in model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dim</code></td>
<td>
<p>numeric vector indicating the dimension of <code>var</code> (must be same length as <code>var</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SubsetCoding</code></td>
<td>
<p>allows a (character) type or a matrix to be assigned to variables for each element of <code>suffconfigs</code></p>
</td>
</tr>
</table>
<p>, see examples
</p>


<h3>Details</h3>

<p>The model <code class="reqn">\mu_{ij}=\alpha+\beta_{i}+\gamma_j</code>
has parametric form and can equivalently be described using constraints on the <code class="reqn">\mu_{ij}</code>,
by <code class="reqn">\mu_{ij}-\mu_{il}-\mu_{kj}+\mu_{kl}=0</code>.
Returns the transpose of the null space of <code>DesignMatrix(var,marg,dim)</code>. Rows normally sum to zero.
See <code>DesignMatrix</code> for more details.
</p>


<h3>Value</h3>

<p>matrix
</p>


<h3>Author(s)</h3>

<p>W. P. Bergsma <a href="mailto:w.p.bergsma@lse.ac.uk">w.p.bergsma@lse.ac.uk</a>
</p>


<h3>References</h3>

<p>Bergsma, W. P. (1997).
<em>Marginal models for categorical data</em>.
Tilburg, The Netherlands: Tilburg University Press.
<a href="http://stats.lse.ac.uk/bergsma/pdf/bergsma_phdthesis.pdf">http://stats.lse.ac.uk/bergsma/pdf/bergsma_phdthesis.pdf</a>
</p>
<p>Bergsma, W. P., Croon, M. A., &amp; Hagenaars, J. A. P. (2009).
Marginal models for dependent, clustered, and longitudunal categorical data.
Berlin: Springer.
</p>


<h3>See Also</h3>

<p><code>ConstraintMatrix</code>, <code>DesignMatrix</code>, <code>DirectSum</code>, <code>MarginalMatrix</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Constraint matrix for independence model
var &lt;- c("A","B")
suffconfigs &lt;- list(c("A"),c("B"))
dim &lt;- c(3, 3)
ConstraintMatrix(var,suffconfigs,dim)
# notation in one line
ConstraintMatrix(c("A","B"),list(c("A"),c("B")),c(3,3))


# Constraint matrix for saturated model, two short specifications giving same result
ConstraintMatrix(c("A","B"),c("A","B"),c(3,3))
ConstraintMatrix(c("A","B"),list(c("A","B")),c(3,3))


# Constraint matrix for univariate quadratic regression model
var &lt;- c("A")
suffconfigs &lt;- c("A")
dim &lt;- c(5)
ConstraintMatrix(var,suffconfigs,dim,SubsetCoding=list(c("A"),"Quadratic"))
# notation in one line
ConstraintMatrix(c("A"),c("A"),c(5),SubsetCoding=list(c("A"),"Quadratic"))


# Constraint matrix for linear by nominal model, various methods:
# simplest method which assumes equidistant centered scores:
ConstraintMatrix(
 var = c("A", "B"),
 suffconfigs = c("A", "B"),
 dim = c(3, 3),
 SubsetCoding = list(c("A", "B"), list("Linear", "Nominal")))
# alternative specification with same result as above:
ConstraintMatrix(
 var = c("A", "B"),
 suffconfigs = c("A", "B"),
 dim = c(3, 3),
 SubsetCoding = list(c("A", "B"), list(rbind(c(-1, 0, 1)), rbind(c(1, 0, 0), c(0, 1, 0)))))
# specifying your own category scores
scores &lt;- c(1,2,5);
ConstraintMatrix(
 var = c("A", "B"),
 suffconfigs = c("A", "B"),
 dim = c(3, 3),
 SubsetCoding = list(c("A", "B"), list(rbind(scores), "Nominal")))


# Constraint matrix for nominal by nominal model, equating parameters of 
# last two categories of second variable:
ConstraintMatrix(var = c("A", "B"), suffconfigs = c("A", "B"), dim = c(3,3),
 SubsetCoding = list(c("A", "B"), list("Nominal", rbind(c(1, 0, 0), c(0, 1, 1)))))
</code></pre>


</div>