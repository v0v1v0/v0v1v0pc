<div class="container">

<table style="width: 100%;"><tr>
<td>predict.fitEmaxB</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Estimated mean and posterior intervals
derived from a Bayesian hyperbolic or sigmiodial Emax model.
</h2>

<h3>Description</h3>

<p>The mean/proportion response for different doses estimated from a Bayesian Emax model is
computed along with corresponding posterior intervals.  The results are computed
for a vector of input dose levels. The estimates are posterior means or medians of the
MCMC generated means/proportions.  
For binary outcomes, the estimated response rates are
computed on the logit scale and then back-transformed before forming the 
estimates and posterior intervals.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'fitEmaxB'
predict(object, dosevec, clev = 0.9,
	int = 1, dref = 0, xvec=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>Output of <code>fitEmax</code> with class
"fitEmaxB".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dosevec</code></td>
<td>
<p>Vector of doses to be evaluated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clev</code></td>
<td>
<p>Level for the posterior intervals about the 
mean/proportion at each dosevec.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>int</code></td>
<td>
<p>The index for the protocol (intercept) to use for the predictions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dref</code></td>
<td>
<p>Differences in response between <code>doselev</code>
and <code>dref</code> are computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xvec</code></td>
<td>
<p>The vector of centered baseline values for the prediction model when
<code>xbase</code> was specified in the model fit.  Centering must be done using the
protocol-specific means consistent with <code>int</code>.  See details for the default
calculations when <code>xvec</code> is not specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>No additonal parameters will be utilized.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Results computed from simple tabulations of the MCMC parameters
evaluated in the Emax function.
</p>
<p>If baseline covariates were included in the fit and <code>xvec</code> is not specified, 
then the predicted value is the mean of the predictions for all patients in the
specified protocol.   Note that the protocol must be specified, or the 
prediction defaults to patients from the first protocol.  Note that for binary
data, the distinction between the mean of the predicted values and the predicted
value at the mean of the covariates can be important.
</p>


<h3>Value</h3>

<p>A list with estimated mean/proportion <code>(pred, predMed)</code>, lower bound, upper
bound, posterior SD, and corresponding values for differences
with the reference dose.  One value for each dose in dosevec.
The MCMC response means (proportions for binary data) are in
<code>simResp</code>, and the residual SD for continuous data are in
<code>sigsim</code>.</p>


<h3>Author(s)</h3>

<p>Neal Thomas </p>


<h3>See Also</h3>

<p><code>fitEmaxB</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 
data("metaData")
exdat&lt;-metaData[metaData$taid==6 &amp; metaData$poptype==1,]

prior&lt;-emaxPrior.control(epmu=0,epsca=10,difTargetmu=0,difTargetsca=10,dTarget=80.0,
        p50=3.75,sigmalow=0.01,sigmaup=20)
mcmc&lt;-mcmc.control(chains=3)

msSat&lt;-sum((exdat$sampsize-1)*(exdat$sd)^2)/(sum(exdat$sampsize)-length(exdat$sampsize))
fitout&lt;-fitEmaxB(exdat$rslt,exdat$dose,prior,modType=4,
				count=exdat$sampsize,msSat=msSat,mcmc=mcmc)

predout&lt;-predict(fitout,dosevec=sort(unique(exdat$dose)))

## End(Not run)
</code></pre>


</div>