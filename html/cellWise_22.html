<div class="container">

<table style="width: 100%;"><tr>
<td>MacroPCA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
MacroPCA
</h2>

<h3>Description</h3>

<p>This function performs the MacroPCA algorithm, which can deal with Missing values and Cellwise
and Rowwise Outliers. Note that this function first calls  <code>checkDataSet</code> and analyzes the remaining cleaned data.</p>


<h3>Usage</h3>

<pre><code class="language-R">MacroPCA(X, k = 0, MacroPCApars = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p><code>X</code> is the input data, and must be an <code class="reqn">n</code> by <code class="reqn">d</code> matrix or a data frame. It must always be provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p><code>k</code> is the desired number of principal components.
If <code>k = 0</code> or <code>k = NULL</code>, the algorithm will compute the percentage
of explained variability for <code>k</code> upto <code>kmax</code> and show a scree plot,
and suggest to choose a value of k such that the cumulative percentage of
explained variability is at least 80%.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MacroPCApars</code></td>
<td>
<p>A list of available options detailed below. If MacroPCApars = NULL the defaults below are used.
</p>

<ul>
<li>
<p><code>DDCpars</code> <br> A list with parameters for the first step of the MacroPCA
algorithm (for the complete list see the function
<code>DDC</code>). Default is <code>NULL</code>.
</p>
</li>
<li>
<p><code>kmax</code> <br> The maximal number of principal components to compute. Default
is <code>kmax = 10</code>. If <code>k</code> is provided kmax does not need to be specified,
unless <code>k</code> is larger than 10 in which case you need to set <code>kmax</code>
high enough.
</p>
</li>
<li>
<p><code>alpha</code> <br> This is the coverage, i.e. the fraction of rows the algorithm
should give full weight. Alpha should be between 0.50 and 1, the default is
0.50.
</p>
</li>
<li>
<p><code>scale</code> <br> A value indicating whether and how the original variables should
be scaled. If <code>scale = FALSE</code> or <code>scale = NULL</code> no scaling is
performed (and a vector of 1s is returned in the <code>$scaleX slot</code>).
If <code>scale = TRUE</code> (default) the data are scaled by a 1-step M-estimator of scale with the Tukey biweight weight function to have a robust scale of 1.
Alternatively scale can be a vector of length
equal to the number of columns of <code>x</code>. The resulting scale estimates are
returned in the <code>$scaleX</code> slot of the MacroPCA output.
</p>
</li>
<li>
<p><code>maxdir</code> <br> The maximal number of random directions to use for computing the
outlyingness of the data points. Default is <code>maxdir = 250</code>. If the number
<code class="reqn">n</code> of observations is small all <code class="reqn">n * (n - 1) / 2</code> pairs of
observations are used.
</p>
</li>
<li>
<p><code>distprob</code> <br> The quantile determining the cutoff values
for orthogonal and score distances. Default is 0.99.
</p>
</li>
<li>
<p><code>silent</code> <br>
If TRUE, statements tracking the algorithm's progress will not be printed. Defaults to <code>FALSE</code>.
</p>
</li>
<li>
<p><code>maxiter</code> <br> Maximum number of iterations. Default is 20.
</p>
</li>
<li>
<p><code>tol</code> <br> Tolerance for iterations. Default is 0.005.
</p>
</li>
<li>
<p><code>center</code><br>
if <code>NULL</code>, MacroPCA will compute the center. If a vector with <code class="reqn">d</code> components, this center will be used.
</p>
</li>
<li>
<p><code>bigOutput</code> <br> whether to compute and return NAimp, Cellimp and Fullimp. Defaults to <code>TRUE</code>.
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with components: <br></p>
<table>
<tr style="vertical-align: top;">
<td><code>MacroPCApars</code></td>
<td>
<p>the options used in the call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remX</code></td>
<td>
<p>Cleaned data after <code>checkDataSet</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DDC</code></td>
<td>
<p>results of the first step of MacroPCA. These are needed to run
MacroPCApredict on new data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaleX</code></td>
<td>
<p>the scales of the columns of <code>X</code>. When <code>scale = FALSE</code> these are all <code class="reqn">1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>the number of principal components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loadings</code></td>
<td>
<p>the columns are the <code>k</code> loading vectors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eigenvalues</code></td>
<td>
<p>the <code>k</code> eigenvalues.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p>vector with the center.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p><code>alpha</code> from the input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p><code>h</code> (computed from <code>alpha</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>It</code></td>
<td>
<p>number of iteration steps.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diff</code></td>
<td>
<p>convergence criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X.NAimp</code></td>
<td>
<p>data with all <code>NA</code>'s imputed by <code>MacroPCA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scores</code></td>
<td>
<p>scores of <code>X.NAimp</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>OD</code></td>
<td>
<p>orthogonal distances of the rows of <code>X.NAimp</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoffOD</code></td>
<td>
<p>cutoff value for the OD.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SD</code></td>
<td>
<p>score distances of the rows of <code>X.NAimp</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoffSD</code></td>
<td>
<p>cutoff value for the SD.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>highOD</code></td>
<td>
<p>row numbers of cases whose <code>OD</code> is above <code>cutoffOD</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>highSD</code></td>
<td>
<p>row numbers of cases whose <code>SD</code> is above <code>cutoffSD</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residScale</code></td>
<td>
<p>scale of the residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stdResid</code></td>
<td>
<p>standardized residuals. Note that these are <code>NA</code>
for all missing values of <code>X</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indcells</code></td>
<td>
<p>indices of cellwise outliers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NAimp</code></td>
<td>
<p>various results for the NA-imputed data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Cellimp</code></td>
<td>
<p>various results for the cell-imputed data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Fullimp</code></td>
<td>
<p>various result for the fully imputed data.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Rousseeuw P.J., Van den Bossche W. 
</p>


<h3>References</h3>

<p>Hubert, M., Rousseeuw, P.J., Van den Bossche W. (2019). MacroPCA: An all-in-one PCA method allowing for missing values as well as cellwise and rowwise outliers. <em>Technometrics</em>, <b>61</b>(4), 459-473. <a href="https://www.tandfonline.com/doi/full/10.1080/00401706.2018.1562989">(link to open access pdf)</a>
</p>


<h3>See Also</h3>

<p><code>checkDataSet</code>, <code>cellMap</code>,
<code>DDC</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(MASS) 
set.seed(12345) 
n &lt;- 50; d &lt;- 10
A &lt;- matrix(0.9, d, d); diag(A) = 1
x &lt;- mvrnorm(n, rep(0,d), A)
x[sample(1:(n * d), 50, FALSE)] &lt;- NA
x[sample(1:(n * d), 50, FALSE)] &lt;- 10
MacroPCA.out &lt;- MacroPCA(x, 2)
cellMap(MacroPCA.out$stdResid)

# For more examples, we refer to the vignette:
## Not run: 
vignette("MacroPCA_examples")

## End(Not run)
</code></pre>


</div>