<div class="container">

<table style="width: 100%;"><tr>
<td>LOGLINEAR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Hierarchical loglinear analyses for two or more categorical variables</h2>

<h3>Description</h3>

<p>Provides 'SPSS'- and 'SAS'-like output for hierarchical loglinear analyses 
of two or more categorical variables. The input can be raw data, a contingency
table, or a dataframe with cell frequency counts. The output includes:
(1) a table with the K-Way and higher-order effects;
(2) a table with the K-Way effects;
(3) a table with the the partial associations;
(4) a table with the parameter estimates; 			
(5) a table with the backward elimination statistics;
(6) a table with the final model goodness of fit tests; and
(7) a table with the final model observed and expected frequencies,
standardized residuals, and adjusted residuals.
</p>


<h3>Usage</h3>

<pre><code class="language-R">LOGLINEAR(data, data_type = 'raw', variables=NULL, Freq = 'Freq', verbose=TRUE) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>The input data, which can be raw data or a dataframe 
with cell frequency counts (see the Examples below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data_type</code></td>
<td>

<p>The kind of input data. The options are 'raw' (for raw data), 'cont.table' 
(for a two-dimensional contingency table), or 'counts' (for a dataframe with 
the cell frequency counts).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variables</code></td>
<td>

<p>The variable names. Two or more variable names must be specified, 
as in, variables=c('varA','varB', 'varC').</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Freq</code></td>
<td>

<p>(optional) If data_type = 'counts', then Freq is the name of the column in data
that has the frequency counts. If unspecified, it will be assumed that the column 
is named 'Freq'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>(optional) Should detailed results be displayed in console? <br> The options are: 
TRUE (default) or FALSE.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The purpose of hierarchical loglinear procedures is to find a model that best 
fits data given the model-fitting constraints, and to then provide the model 
parameters. The analyses begin with the saturated model, which includes all 
possible terms and for which there is a perfect fit to data. Terms are then 
tested for possible exclusion, which occurs when removal of a term does not 
result in a statistically significant reduction in fit <em>and</em> when a term is 
not involved in any higher order interactions. This function provides 
statistics for the saturated model, for the hierarchal removal of the model 
terms, for the backward elimination steps, and for the final model.	
</p>
<p>When data_type = 'cont.table', the data must be a two-dimensional contingency 
table that has the names of the table dimensions/variables. See the Examples below.  
</p>


<h3>Value</h3>

<p>A list with the following possible elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>KwayHO</code></td>
<td>
<p>A table with the K-Way and higher-order effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Kway</code></td>
<td>
<p>A table with the K-Way effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PartialAssociations</code></td>
<td>
<p>A table with the partial associations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>paramests</code></td>
<td>
<p>A table with the parameter estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>StepSummTab</code></td>
<td>
<p>A table with the backward elimination statistics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FinalModeltests</code></td>
<td>
<p>A table with the final model goodness of fit tests.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FinalModelcells</code></td>
<td>
<p>A table with the final model observed and expected frequencies and
adjusted residuals.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Brian P. O'Connor</p>


<h3>References</h3>

<p>Agresti, A. (2013). <em>Categorical data analysis (3rd ed).</em> Hobokon, NJ: John Wiley &amp; Sons.
<br><br> Ajzen, R., &amp; Walker, C. M. (2021). <em>Categorical data analysis for the behavioral and 
social sciences (2nd ed.).</em> New York, NY: Routledge.
<br><br> Field, A. (2018). Chapter 18: Categorical data. 
<em>Discovering statistics using SPSS (5th ed.).</em> Los Angeles, CA: Sage.
<br><br> Noursis, M. J. (2012). Chapter 1: Model selection loglinear analysis.
<em>IBM SPSS statistics 19: Advanced statistical 
procedures Companion.</em> Upper Saddle River, NJ: Prentice Hall.
<br><br> Nussbaum, E. M. (2015). <em>Categorical and nonparametric data analysis 
choosing the best statistical technique.</em> New York, NY: Routledge.
<br><br> Stevens, J. P. (2009). Chapter 14: Categorical data analysis: The log linear model. 
<em>Applied multivariate statistics for the social sciences (5th ed.).</em> 
New York, NY: Routledge.
<br><br> Tabachnick, B. G., &amp; Fidell, L. S. (2019). Chapter 16: Multiway 
frequency analysis. <em>Using multivariate statistics.</em> New York, NY: Pearson.
<br><br> von Eye, A., &amp; Mun, E. Y. (2013). <em>Log-Linear modeling concepts, 
interpretation, and application.</em> Hoboken, NJ: Wiley.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Field (2018). Chapter 19: Categorical data -- cats &amp; dogs, entering raw data
LOGLINEAR(data = datasets$Field_2018, 
          data_type = 'counts', 
          variables=c('Animal', 'Training', 'Dance'), 
          Freq = 'Freq' )

# Field (2018). Chapter 19: Categorical data -- cats &amp; dogs, entering raw counts	
LOGLINEAR(data = datasets$Field_2018_raw,  
          data_type = 'raw', 
          variables=c('Animal', 'Training', 'Dance'), 
          Freq = NULL )
          
# Field (2018). Chapter 19: Categorical data -- cats &amp; dogs, entering a table
# example of creating and entering a two-dimensional contingency table for 'data'
food &lt;- c(28, 10)
affection &lt;- c(48, 114)
Field_2018_cats_conTable &lt;- as.table(rbind(food, affection)) 
colnames(Field_2018_cats_conTable) &lt;- c('danced', 'did not dance')
names(attributes(Field_2018_cats_conTable)$dimnames) &lt;- c('Training','Dance') 
LOGLINEAR(data = Field_2018_cats_conTable, 
          data_type = 'cont.table', 
          variables=c('Training', 'Dance') )


# go to this web page to see many more examples of the LOGLINEAR function analyses:
# https://oconnor-psych.ok.ubc.ca/loglinear/LOGLINEAR_vignettes.html

</code></pre>


</div>