<div class="container">

<table style="width: 100%;"><tr>
<td>gsl.bs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>GSL (GNU Scientific Library) B-spline/B-spline Derivatives</h2>

<h3>Description</h3>

 <p><code>gsl.bs</code> generates the B-spline basis matrix for a
polynomial spline and (optionally) the B-spline basis matrix
derivative of a specified order with respect to each predictor </p>


<h3>Usage</h3>

<pre><code class="language-R">gsl.bs(...)
## Default S3 method:
gsl.bs(x,
       degree = 3,
       nbreak = 2,
       deriv = 0,
       x.min = NULL,
       x.max = NULL,
       intercept = FALSE,
       knots = NULL,
       ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> the predictor variable.  Missing values are not allowed </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degree</code></td>
<td>
<p> degree of the piecewise polynomial - default is
‘3’ (cubic spline) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbreak</code></td>
<td>
<p> number of breaks in each interval - default is ‘2’</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deriv</code></td>
<td>
<p> the order of the derivative to be computed-default if
<code>0</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.min</code></td>
<td>
<p> the lower bound on which to construct the spline -
defaults to <code>min(x)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.max</code></td>
<td>
<p> the upper bound on which to construct the spline -
defaults to <code>max(x)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p> if ‘TRUE’, an intercept is included in the
basis; default is ‘FALSE’ </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knots</code></td>
<td>
<p> a vector (default <code>knots="NULL"</code>) specifying knots
for the spline basis (default enables uniform knots, otherwise those
provided are used)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> optional arguments </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Typical usages are (see below for a  list of options and also
the examples at the end of this help file)
</p>
<pre>
    B &lt;- gsl.bs(x,degree=10)
    B.predict &lt;- predict(gsl.bs(x,degree=10),newx=xeval)
  </pre>


<h3>Value</h3>

<p><code>gsl.bs</code> returns a <code>gsl.bs</code> object.  A matrix of dimension
‘c(length(x), degree+nbreak-1)’.  The generic function
<code>predict</code> extracts (or generates) predictions from the
returned object.
</p>
<p>A primary use is in modelling formulas to directly specify a piecewise
polynomial term in a model. See <a href="https://www.gnu.org/software/gsl/">https://www.gnu.org/software/gsl/</a>
for further details.
</p>


<h3>Author(s)</h3>

<p>Jeffrey S. Racine <a href="mailto:racinej@mcmaster.ca">racinej@mcmaster.ca</a>
</p>


<h3>References</h3>

<p>Li, Q. and J.S. Racine (2007), <em>Nonparametric Econometrics:
Theory and Practice,</em> Princeton University Press.
</p>
<p>Ma, S. and J.S. Racine and L. Yang (2015), “Spline
Regression in the Presence of Categorical Predictors,” Journal of
Applied Econometrics, Volume 30, 705-717.
</p>
<p>Ma, S. and J.S. Racine (2013), “Additive Regression
Splines with Irrelevant Categorical and Continuous Regressors,”
Statistica Sinica, Volume 23, 515-541.
</p>


<h3>See Also</h3>

<p><code>bs</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Plot the spline bases and their first order derivatives
x &lt;- seq(0,1,length=100)
matplot(x,gsl.bs(x,degree=5),type="l")
matplot(x,gsl.bs(x,degree=5,deriv=1),type="l")

## Regression example
n &lt;- 1000
x &lt;- sort(runif(n))
y &lt;- cos(2*pi*x) + rnorm(n,sd=.25)
B &lt;- gsl.bs(x,degree=5,intercept=FALSE)
plot(x,y,cex=.5,col="grey")
lines(x,fitted(lm(y~B)))
</code></pre>


</div>