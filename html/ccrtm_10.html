<div class="container">

<table style="width: 100%;"><tr>
<td>foursail2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>R implementation of the foursail2 model with 2 canopy layers.</h2>

<h3>Description</h3>

<p>The foursail2 model is a two layer implementation of the 
foursail model described in Verhoef and Bach (2007).
Layers are assumed identical in particle inclination and
hotspot, but may differ in the relative density and types of
particles (see foursail2b for a layer specific inclination angle).
In comparison to foursail, the background (soil),
can now be non-Lambertain, having it own 4-stream
BDRF (not implemented here but may be input by the user).
There are two types of particles, generalized
to primary and secondary (originally termed "green"
and "brown" particles). The  realtive abundance of
the secondary particle in the top canopy is regulated by
the dissociation paramerter.The model 4SAIL2 combines with
prospect, libery or procosine for the reflectance
and transmittance of the particles, and with the the foursail
or Hapke elements for the background reflectance.
If run alone, these require direct inputs which could be 
measured leaf reflectance.
</p>


<h3>Usage</h3>

<pre><code class="language-R">foursail2(rhoA, tauA, rhoB = NULL, tauB = NULL, bgr, rsobgr = NULL,
  rdobgr = NULL, rsdbgr = NULL, rddbgr = NULL, param)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>rhoA</code></td>
<td>
<p>primary particle reflectance from 400-2500nm (can be measured or modeled)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tauA</code></td>
<td>
<p>primary particle transmittance from 400-2500nm (can be measured or modeled)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rhoB</code></td>
<td>
<p>secondary particle reflectance from 400-2500nm (can be measured or modeled)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tauB</code></td>
<td>
<p>secondary particle reflectance from 400-2500nm (can be measured or modeled)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bgr</code></td>
<td>
<p>background reflectance. Usual input is
soil reflectance spectra from 400-2500nm (can be measured or modeled)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rsobgr</code></td>
<td>
<p>: background bidirectional reflectance (rso)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rdobgr</code></td>
<td>
<p>: background directional hemispherical reflectance (rdo)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rsdbgr</code></td>
<td>
<p>: background hemispherical directional reflectance (rsd)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rddbgr</code></td>
<td>
<p>: background bi-hemispherical diffuse reflectance (rdd)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>A named vector of 4SAIL2 parameter values (note:
program ignores case):
</p>

<ul>
<li>
<p> [1] = Leaf angle distribution function parameter a (LIDFa)
</p>
</li>
<li>
<p> [2] = Leaf angle distribution function parameter b (LIDFb)
</p>
</li>
<li>
<p> [3] = Leaf angle distribution function type (TypeLidf, see ?lidfFun)
</p>
</li>
<li>
<p> [4] = Total Leaf Area Index (LAI), including primary and secondary 
particles (brown and green leafs).
</p>
</li>
<li>
<p> [5] = fraction secondary particles ("brown leaf fraction", fb)
</p>
</li>
<li>
<p> [6] = Canopy dissociation factor for secondary particles ("diss")
</p>
</li>
<li>
<p> [7] = Hot spot effect parameter (hspot). Often defined as the
ratio of mean leaf width and canopy height.
</p>
</li>
<li>
<p> [7] = vertical crown coverage fraction (Cv), models clumping in combination
with parameter zeta. 
</p>
</li>
<li>
<p> [7] = tree shape factor (zeta), defined as the ratio of crown diameter and height.
</p>
</li>
<li>
<p> [6] = Solar zenith angle (tts)
</p>
</li>
<li>
<p> [7] = Observer zenith angle (tto)
</p>
</li>
<li>
<p> [8] = Sun-sensor azimuth angle (psi)
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Value</h3>

<p>spectra matrixwith 4 reflectance factors and canopy transmission 
for wavelengths 400 to 2500nm:
</p>

<ul>
<li>
<p> [1] = bi-hemispherical reflectance (rddt). White-sky albedo: the reflectance of the canopy
under diffuse illumination. The BRDF integrated over all viewing and illumination directions.
Diffuse reflectance for diffuse incidence.
</p>
</li>
<li>
<p> [2] = hemispherical directional reflectance (rsdt). Black-sky albedpo: reflectance of a surface
under direct light without a diffuse component. It is the integral of the BRDF over all viewing
directions. Diffuse reflectance for direct solar incidence.
</p>
</li>
<li>
<p> [3] = directional hemispherical reflectance (rdot). Diffuse reflectance in the vieweing
direction. 
</p>
</li>
<li>
<p> [4] = bi-directional reflectance (rsot). The ratio of reflected radiance in the viewing direction
to the incoming radiant flux in the solar direction. 
</p>
</li>
</ul>
<h3>References</h3>

<p>Verhoef, W., Bach, H. (2007). Coupled soil-leaf-canopy and atmosphere radiative transfer 
modeling to simulate hyperspectral multi-angular surface reflectance and TOA radiance data. 
Remote Sens. Environ. 109, 166-182.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## see ?foursail for lower-level implementations
fRTM(rho~prospect5+foursail2)

</code></pre>


</div>