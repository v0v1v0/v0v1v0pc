<div class="container">

<table style="width: 100%;"><tr>
<td>plot_changes_on_tree</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plots character changes on branches</h2>

<h3>Description</h3>

<p>Plots character changes in boxes on branches.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_changes_on_tree(character_changes, time_tree, label_size = 0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>character_changes</code></td>
<td>
<p>A matrix of character changes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time_tree</code></td>
<td>
<p>Tree on which character changes occur.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label_size</code></td>
<td>
<p>The size of the text for the barnch labels. Default is 0.5.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Takes the <code>character_changes</code> output from test_rates and plots it on the tree used to generate it.
</p>


<h3>Value</h3>

<p>A plot of character changes on a tree.
</p>


<h3>Author(s)</h3>

<p>Graeme T. Lloyd <a href="mailto:graemetlloyd@gmail.com">graemetlloyd@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Set random seed:
set.seed(17)

# Get first MPT for the Michaux data set:
time_tree &lt;- ape::read.tree(text = paste0("(Ancilla:31.6,(Turrancilla:102.7,",
  "(Ancillista:1,Amalda:63.5):1):1);"))

# Set root time for tree:
time_tree$root.time &lt;- 103.7

# Generate two equal length time bins:
time_bins &lt;- matrix(data = c(seq(time_tree$root.time, 0, length.out = 3)[1:2],
  seq(time_tree$root.time, 0, length.out = 3)[2:3]), ncol = 2, dimnames = list(LETTERS[1:2],
  c("fad", "lad")))

# Set class as timeBins:
class(time_bins) &lt;- "timeBins"

# Get discrete character rates (includes changes):
out &lt;- test_rates(
  time_tree = time_tree,
  cladistic_matrix = michaux_1989,
  time_bins = time_bins,
  branch_partitions = list(list(1)),
  alpha = 0.01
)

# Plot character changes on the tree:
plot_changes_on_tree(
  character_changes = out$inferred_character_changes,
  time_tree = time_tree
)
</code></pre>


</div>