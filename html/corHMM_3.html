<div class="container">

<table style="width: 100%;"><tr>
<td>corDISC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Correlated evolution binary traits</h2>

<h3>Description</h3>

<p>Fits a model of correlated evolution between two or three binary traits</p>


<h3>Usage</h3>

<pre><code class="language-R">corDISC(phy,data, ntraits=2, rate.mat=NULL, model=c("ER","SYM","ARD"), 
node.states=c("joint", "marginal", "scaled", "none"), lewis.asc.bias=FALSE, p=NULL, 
root.p=NULL, ip=NULL, lb=0, ub=100, diagn=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phy</code></td>
<td>
<p>a phylogenetic tree, in <code>ape</code> “phylo” format.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data matrix containing species information (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntraits</code></td>
<td>
<p>specifies the number of traits to be included in the analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate.mat</code></td>
<td>
<p>a user-supplied rate matrix index of parameters to be optimized.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>specifies the underlying model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>node.states</code></td>
<td>
<p>method used to calculate ancestral states at internal nodes (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lewis.asc.bias</code></td>
<td>
<p>a logical indicating whether the ascertainment bias correction of Lewis et al. 2001 should be used. The default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>a vector of transition rates. Allows the user to calculate the likelihood given a specified set of parameter values to specified as fixed and calculate the likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>root.p</code></td>
<td>
<p>a vector used to fix the probabilities at the root, but “yang” and “maddfitz” can also be supplied to use the method of Yang (2006) and FitzJohn et al (2009) respectively (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ip</code></td>
<td>
<p>initial values used for the likelihood search. Can be a single value or a vector of unique values for each parameter. The default is <code>ip=1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lb</code></td>
<td>
<p>lower bound for the likelihood search. The default is <code>lb=0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ub</code></td>
<td>
<p>upper bound for the likelihood search. The default is <code>ub=100</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diagn</code></td>
<td>
<p>logical indicating whether diagnostic tests should be performed. The default is <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>__THIS FUNCTION IS NO LONGER NECESSARY AS IT IS NOW ENTIRELY SUBSUMED WITHIN__ <code>corHMM</code> (see _Generalized corHMM_ vignette). But we still provide it for those that are more comfortable using it than exploring the new <code>corHMM</code> function. As before, <code>corDISC</code> takes a tree and a trait file and estimates transition rates and ancestral states for two or three binary characters (see Pagel 1994). Note, however, that rayDISC can be used to evaluate the same models as in corDISC, with the major difference being that, with rayDISC, the rate matrix would have to be manipulated using <code>rate.mat.maker</code> in order to remove parameters associated with dual transitions. With corDISC, the input phylogeny need not be bifurcating as the algorithm is implemented to handle multifucations. Polytomies are allowed by generalizing Felsenstein's (1981) pruning algorithm to be the product of the probability of observing the tip states of n descendant nodes, rather than two, as in the completely bifurcating case. For the trait file, the first column of the trait file must contain the species labels to match to the tree, with the second column onwards corresponding to the binary traits of interest. 
</p>
<p>The user can fix the root state probabilities by supplying a vector to <code>root.p</code>. For example, in the two trait case, if the hypothesis is that the root is 00, then the root vector would be <code>root.p=c(1,0,0,0)</code> for state combinations 00, 01, 10, and 11, respectively. If the user supplies the flag <code>root.p</code>=“yang”, then the estimated transition rates are used to set the weights at the root (see pg. 124 Yang 2006), whereas specifying <code>root.p</code>=“maddfitz” employs the same procedure described by Maddison et al. (2007) and FitzJohn et al. (2009). Note that the default <code>root.p=NULL</code> assumes equal weighting among all possible states.
</p>
<p>We also note that scoring information that is missing for a species can be incorporated in the analysis by including an NA for that particular trait. corDISC will then set the trait vector so that the tip vector will reflect the probabilities that are compatible with our observations. For example, if the scoring for trait 1 is missing, but trait 2 is scored as 0, then the tip vector would be (1,0,1,0), for state combinations 00, 01, 10, and 11 respectively, given our observation that trait 2 is scored 0 (for a good discussion see Felsenstein 2004, pg. 255).
</p>


<h3>Value</h3>

<p><code>corDISC</code> returns an object of class <code>corDISC</code>. This is a list with elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>$loglik</code></td>
<td>
<p>the maximum negative log-likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$AIC</code></td>
<td>
<p>Akaike information criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$AICc</code></td>
<td>
<p>Akaike information criterion corrected for sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$ntraits</code></td>
<td>
<p>The number of traits specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$solution</code></td>
<td>
<p>a matrix containing the maximum likelihood estimates of the transition rates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$solution.se</code></td>
<td>
<p>a matrix containing the approximate standard errors of the transition rates. The standard error is calculated as the square root of the diagonal of the inverse of the Hessian matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$index.mat</code></td>
<td>
<p>The indices of the parameters being estimated are returned. The numbers correspond to the row in the <code>eigvect</code> and can useful for identifying the parameters that are causing the objective function to be at a saddlepoint.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$lewis.asc.bias</code></td>
<td>
<p>The setting describing whether or not the Lewis ascertainment bias correction was used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$opts</code></td>
<td>
<p>Internal settings of the likelihood search</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$data</code></td>
<td>
<p>User-supplied dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$phy</code></td>
<td>
<p>User-supplied tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$states</code></td>
<td>
<p>The likeliest states at each internal node.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$tip.states</code></td>
<td>
<p>NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$iterations</code></td>
<td>
<p>The number of iterations used by the optimization routine.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$eigval</code></td>
<td>
<p>The eigenvalues from the decomposition of the Hessian of the likelihood function. If any <code>eigval&lt;0</code> then one or more parameters were not optimized during the likelihood search</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$eigvect</code></td>
<td>
<p>The eigenvectors from the decomposition of the Hessian of the likelihood function is returned</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jeremy M. Beaulieu</p>


<h3>References</h3>

<p>Beaulieu J.M., and M.J. Donoghue 2013. Fruit evolution and diversification in campanulid angiosperms. Evolution, 67:3132-3144.
</p>
<p>Felsenstein, J. 1981. A likelihood approach to character weighting and what it tells us about parsimony and compatibility. Biological Journal of the Linnean Society 16: 183-196.
</p>
<p>Felsenstein J. 2004. Inferring phylogenies. Sunderland MA: Sinauer Associates.
</p>
<p>FitzJohn, R.G., W.P. Maddison, and S.P. Otto. 2009. Estimating trait-dependent speciation and extinction rates from incompletely resolved phylogenies. Systematic Biology 58:595-611.
</p>
<p>Lewis, P.O. 2001. A likelihood approach to estimating phylogeny from discrete morphological character data. Systematic Biology 50:913-925.
</p>
<p>Maddison, W.P., P.E. Midford, and S.P. Otto. 2007. Estimating a binary characters effect on speciation and extinction. Systematic Biology 56:701-710.
</p>
<p>Pagel, M. 1994. Detecting correlated evolution on phylogenies: a general method for the comparative analysis of discrete characters. Proceedings of the Royal Society, B. 255:37-45.
</p>


</div>