<div class="container">

<table style="width: 100%;"><tr>
<td>anova.CAMAN.object</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>ANOVA for finite mixture models</h2>

<h3>Description</h3>

<p>A common problem in the estimation of mixture models is to determine the
number of components. This may be done using a parametric bootstrap.
This function simulates from a mixture model under the null hypothesis
with <code>k0</code> components. A mixture model with k0 and usually k0 +1 components 
is fit to the data and then the likelihood ratio statistic (LRS) is computed. <br></p>
<p>Based on the bootstrap the distribution of the LRS is obtained which allows to obtain
an approximation to the achieved level of significance corresponding to
the value of <code class="reqn">-2 \log \xi</code> obtained from the original sample.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'CAMAN.object'
anova(object, object1, nboot=2500, limit=0.01, acc=10^(-7), 
     numiter=5000, giveBootstrapData=FALSE, giveLikelihood=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>A CAMAN-object which quantifies a finite mixture model under null hypothesis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object1</code></td>
<td>

<p>A CAMAN-object which quantifies another finite mixture model under the alterative hypothesis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nboot</code></td>
<td>

<p>Number of bootstrap samples.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>limit</code></td>
<td>

<p>parameter to control the limit of union several components. Default is 0.01.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>acc</code></td>
<td>

<p>convergence criterion. VEM and EM loops stop when deltaLL&lt;acc. Default is 10^(-7). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numiter</code></td>
<td>

<p>parameter to control the maximal number of iterations in the VEM and EM loops. Default is 5000. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>giveBootstrapData</code></td>
<td>

<p>A Boolean that indicates whether the bootstrapped data should be returned or not
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>giveLikelihood</code></td>
<td>

<p>Return the likelihood-values of both models for each generated dataset.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Arguments to be passed on to other methods; currently none.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The parameters <code>limit, acc</code> and <code>numiter</code> are used for the VEM algorithm in each bootstrap sample.
</p>


<h3>Value</h3>

<p>The function returns a list with components
</p>

<ul>
<li> <p><code>overview</code>: comparison of the models, including BIC, LL and LL-ratio <br></p>
</li>
<li> <p><code>`LL ratios in bootstrap-data`</code>: 90, 95, 97.5 and 99 percentiles of LL-ratios <br></p>
</li>
<li> <p><code>`simulated p-value`</code>: p-value, quantifying the null model  <br></p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Peter Schlattmann and Johannes Hoehne   
</p>


<h3>References</h3>

<p>McLachlan, G. and Peel, D. (2000). <em>Finite Mixture Models</em>, Chichester: Wiley. <br></p>
<p>Schlattmann, P. (2009). <em>Medical Applications of Finite Mixture Models</em>. Berlin: Springer.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(thai_cohort)
mix0 &lt;- mixalg(obs="counts", weights="frequency", family="poisson", data=thai_cohort,
               numiter=18000, acc=0.00001,startk=25)
em0&lt;-mixalg.EM(mix0,p=c(1),t=c(1))
em1&lt;-mixalg.EM(mix0,p=c(0.7,0.3),t=c(2,9))
## Not run: ll&lt;-anova(em0,em1,nboot=250) #might take some minutes
</code></pre>


</div>