<div class="container">

<table style="width: 100%;"><tr>
<td>rng</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Random number generator for a custom d-dimensional distribution</h2>

<h3>Description</h3>

<p>Brute-force algorithm for drawing random numbers from a d-dimensional distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rng(f, n, min, max, fmax = NULL, quasi = FALSE, start = 1, warn = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>function of a d-vector representing a d-dimensional distribution function. This function must be non-negative on the whole domain. It does not need to be normalized. For fast performance, this function should be vectorized, such that it returns an N-element vector if it is given an N-by-D matrix as argument. An automatic warning is produced if the function is not vectorized in this manner.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of random numbers to be generated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min, max</code></td>
<td>
<p>are d-vectors specifying the domain of distribution function; the domain must be finite and should be as restrictive as possible to keep the number of random trials as low as possible.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fmax</code></td>
<td>
<p>maximum value of <code>f</code> on its domain. If set to <code>NULL</code> (default), this value will be determined automatically, using the <code>optimize</code> (if d=1) and <code>optim</code> (if d&gt;1) function with its default options. A value for <code>fmax</code> should be set, if the automatically determined value (see output list) is incorrect.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quasi</code></td>
<td>
<p>logical flag. If true, quasi-random numbers with low-discrepancy are drawn, based on a Halton sequence. Otherwise, the standard internal pseudo-random generator of <code>runif()</code> is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>starting index of Halton sequence. Only used if <code>quasi=TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warn</code></td>
<td>
<p>logical flag. If true, a warning is produced if the function f is not vectorized.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns list of items:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>n-by-d matrix of n random d-vectors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fmax</code></td>
<td>
<p>maximum value of the distribution function <code>f</code> on the domain.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of random vectors (same as argument <code>n</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntrials</code></td>
<td>
<p>number of trials.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Danail Obreschkow
</p>


<h3>See Also</h3>

<p><code>dpqr</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## 1D random number generation from a sine-function
f = function(x) sin(x)
out.pseudo = rng(f,1e3,0,pi)
out.quasi = rng(f,1e3,0,pi,quasi=TRUE)
hist(out.pseudo$x,100,freq=FALSE,border=NA,xlab='x',main='sine-distribution')
hist(out.quasi$x,100,freq=FALSE,border=NA,col='#ff000066',add=TRUE)
curve(sin(x)/2,0,pi,add=TRUE)

## 2D quasi-random sampling of a disk with exponentially declining surface density
f = function(x) exp(-sqrt(x[,1]^2+x[,2]^2))
out = rng(f,1e4,min=c(-5,-5),max=c(5,5),quasi=TRUE)
plot(out$x,cex=0.3,pch=16,asp=1,main='Quasi-random exponential disk')

## 5D random number generation (5-dimensional sphere)
f = function(x) as.numeric(sum(x^2)&lt;=1)
out = rng(f,1e4,rep(-1,5),rep(1,5))
cat(sprintf('Number of successes over number of trials : %.4f\n',out$n/out$ntrials))
cat(sprintf('Expected ratio for n=\u221E : %.4f\n',pi^(5/2)/gamma(1+5/2)/2^5))

</code></pre>


</div>