<div class="container">

<table style="width: 100%;"><tr>
<td>CST_AnalogsPredictors</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>AEMET Downscaling   
Precipitation and maximum and minimum temperature downscaling method 
based on analogs: synoptic situations and significant predictors.</h2>

<h3>Description</h3>

<p>This function downscales low resolution precipitation data (e.g. 
from Seasonal Forecast Models) through the association with an observational 
high resolution (HR) dataset (AEMET 5 km gridded data of daily precipitation 
(Peral et al., 2017)) and a collection of predictors and past synoptic 
situations similar to estimated day. The method uses three domains: 
</p>

<ul>
<li>
<p>Peninsular Spain and Balearic Islands domain (5 km resolution): HR precipitation 
and the downscaling result domain.
</p>
</li>
<li>
<p>Synoptic domain (low resolution, e.g. 1.5º x 1.5º): it should be 
centered over Iberian Peninsula and cover enough extension to detect 
as much synoptic situations as possible.
</p>
</li>
<li>
<p>Extended domain (low resolution, e.g. 1.5º x 1.5º): it should have the 
same resolution as synoptic domain. It is used for SLP Seasonal 
Forecast Models.
</p>
</li>
</ul>
<h3>Usage</h3>

<pre><code class="language-R">CST_AnalogsPredictors(
  exp,
  slp,
  obs,
  lon,
  lat,
  slp_lon,
  slp_lat,
  var_name,
  hr_obs,
  tdates,
  ddates,
  restrain,
  dim_name_longitude = "lon",
  dim_name_latitude = "lat",
  dim_name_time = "time"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>exp</code></td>
<td>
<p>List of arrays with downscaled period seasonal forecast data. The 
list has to contain model atmospheric variables (instantaneous 12h data) 
that must be indentify by parenthesis name. For precipitation:
</p>

<ul>
<li>
<p>u component of wind at 500 hPa (u500_mod) in m/s.
</p>
</li>
<li>
<p>v component of wind at 500 hPa (v500_mod) in m/s.
</p>
</li>
<li>
<p>temperature at 500 hPa (t500_mod) in K.
</p>
</li>
<li>
<p>temperature at 850 hPa (t850_mod) in K.
</p>
</li>
<li>
<p>specific humidity at 700 hPa (q700_mod) in g/kg. 
</p>
</li>
</ul>
<p>For temperature:
</p>

<ul>
<li>
<p>u component of wind at 500 hPa (u500_mod) in m/s.
</p>
</li>
<li>
<p>v component of wind at 500 hPa (v500_mod) in m/s.
</p>
</li>
<li>
<p>temperature at 500 hPa (t500_mod) in K.
</p>
</li>
<li>
<p>temperature at 700 hPa (t700_mod) in K. 
</p>
</li>
<li>
<p>temperature at 850 hPa (t850_mod) in K.
</p>
</li>
<li>
<p>specific humidity at 700 hPa (q700_mod) in g/kg. 
</p>
</li>
<li>
<p>2 meters temperature (tm2m_mod) in K.
</p>
</li>
</ul>
<p>The arrays must have at least three dimensions with names 'lon', 'lat' and 
'time'. (lon = gridpoints of longitude, lat = gridpoints of latitude, 
time = number of downscaling days) Seasonal forecast variables must have the 
same resolution and domain as reanalysis variables ('obs' parameter, below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slp</code></td>
<td>
<p>Array with atmospheric seasonal forecast model sea level pressure
(instantaneous 12h data) that must be indentify as 'slp' (hPa). It has the  
same resolution as 'exp' and 'obs' paremeters but with an extended domain.
This domain contains extra degrees (most in the north and west part) compare  
to synoptic domain. The array must have at least three dimensions with
names 'lon', 'lat' and 'time'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs</code></td>
<td>
<p>List of arrays with training period reanalysis data. 
The list has to contain reanalysis atmospheric variables (instantaneous 
12h data) that must be indentify by parenthesis name. For precipitation:
</p>

<ul>
<li>
<p>u component of wind at 500 hPa (u500) in m/s.
</p>
</li>
<li>
<p>v component of wind at 500 hPa (v500) in m/s.
</p>
</li>
<li>
<p>temperature at 500 hPa (t500) in K.
</p>
</li>
<li>
<p>temperature at 850 hPa (t850) in K.
</p>
</li>
<li>
<p>sea level pressure (slp) in hPa.
</p>
</li>
<li>
<p>specific humidity at 700 hPa (q700) in g/kg.
</p>
</li>
</ul>
<p>For maximum and minimum temperature:
</p>

<ul>
<li>
<p>u component of wind at 500 hPa (u500) in m/s.
</p>
</li>
<li>
<p>v component of wind at 500 hPa (v500) in m/s.
</p>
</li>
<li>
<p>temperature at 500 hPa (t500) in K.
</p>
</li>
<li>
<p>temperature at 700 hPa (t700) in K.
</p>
</li>
<li>
<p>temperature at 850 hPa (t850) in K.
</p>
</li>
<li>
<p>sea level pressure (slp) in hPa.
</p>
</li>
<li>
<p>specific humidity at 700 hPa (q700) in g/kg
</p>
</li>
<li>
<p>2 meters temperature (tm2m) in K
</p>
</li>
</ul>
<p>The arrays must have at least three dimensions with names 'lon', 'lat' and 
'time'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lon</code></td>
<td>
<p>Vector of the synoptic longitude (from (-180º) to 180º), 
The vector must go from west to east. The same as for the training function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lat</code></td>
<td>
<p>Vector of the synoptic latitude. The vector must go from north to 
south. The same as for the training function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slp_lon</code></td>
<td>
<p>Vector of the extended longitude (from (-180º) to 180º), 
The vector must go from west to east. The same as for the training function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slp_lat</code></td>
<td>
<p>Vector of the extended latitude. The vector must go from north 
to south. The same as for the training function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var_name</code></td>
<td>
<p>Variable name to downscale. There are two options: 'prec' for
precipitation and 'temp' for maximum and minimum temperature.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hr_obs</code></td>
<td>
<p>Local path of HR observational files (maestro and pcp/tmx-tmn). 
For precipitation and temperature can be downloaded from the following link:
<a href="https://www.aemet.es/en/serviciosclimaticos/cambio_climat/datos_diarios?w=2">https://www.aemet.es/en/serviciosclimaticos/cambio_climat/datos_diarios?w=2</a> 
respetively. Maestro file (maestro_red_hr_SPAIN.txt) has gridpoint (nptos), 
longitude (lon), latitude (lat) and altitude (alt) in columns (vector 
structure). Data file (pcp/tmx/tmn_red_SPAIN_1951-201903.txt) includes 5km 
resolution spanish daily data (precipitation or maximum and minimum 
temperature from january 1951 to june 2020. See README file for more 
information. IMPORTANT!: HR observational period must be the same as for 
reanalysis variables. It is assumed that the training period is smaller than 
the HR original one (1951-2019), so it is needed to make a new ascii file 
with the new period and the same structure as original, specifying the 
training dates in the name 
(e.g. 'pcp_red_SPAIN_19810101-19961231.txt' for '19810101-19961231' period).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tdates</code></td>
<td>
<p>Training period dates in format YYYYMMDD(start)-YYYYMMDD(end) 
(e.g. 19810101-20181231).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ddates</code></td>
<td>
<p>Downscaling period dates in format YYYYMMDD(start)-YYYYMMDD(end) 
(e.g. 20191001-20200331).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>restrain</code></td>
<td>
<p>Output (list of matrix) obtained from 'training_analogs' 
function. For precipitation, 'restrain' object must contains um, vm, nger, 
gu92, gv92, gu52, gv52, neni, vdmin, vref, ccm, lab_pred and cor_pred 
variables. For maximum and minimum temperature, 'restrain' object must 
contains um, vm, insol, neni, vdmin y vref. See 'AnalogsPred_train.R' for 
more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dim_name_longitude</code></td>
<td>
<p>A character string indicating the name of the 
longitude dimension, by default 'longitude'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dim_name_latitude</code></td>
<td>
<p>A character string indicating the name of the 
latitude dimension, by default 'latitude'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dim_name_time</code></td>
<td>
<p>A character string indicating the name of the time 
dimension, by default 'time'.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Matrix with seasonal forecast precipitation (mm) or maximum and 
minimum temperature (dozens of ºC) in a 5km x 5km regular grid over peninsular 
Spain and Balearic Islands. The resulted matrices have two dimensions 
('ddates' x 'nptos').(ddates = number of downscaling days and nptos = number 
of 'hr_obs' gridpoints).
</p>


<h3>Author(s)</h3>

<p>Marta Dominguez Alonso - AEMET, <a href="mailto:mdomingueza@aemet.es">mdomingueza@aemet.es</a>
</p>
<p>Nuria Perez-Zanon - BSC, <a href="mailto:nuria.perez@bsc.es">nuria.perez@bsc.es</a>
</p>


</div>