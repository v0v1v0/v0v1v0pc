<div class="container">

<table style="width: 100%;"><tr>
<td>didDML</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Difference-in-Differences in Repeated Cross-Sections for Binary Treatments using Double Machine Learning</h2>

<h3>Description</h3>

<p>This function estimates the average treatment effect on the treated (ATET) in the post-treatment period for a binary treatment using a doubly robust Difference-in-Differences (DiD) approach for repeated cross-sections that is combined with double machine learning. It controls for (possibly time-varying) confounders in a data-driven manner and supports various machine learning methods for estimating nuisance parameters through k-fold cross-fitting.
</p>


<h3>Usage</h3>

<pre><code class="language-R">didDML(
  y,
  d,
  t,
  x,
  MLmethod = "lasso",
  est = "dr",
  trim = 0.05,
  cluster = NULL,
  k = 3
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Outcome variable. Should not contain missing values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>Treatment group indicator (binary). Should not contain missing values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>Time period indicator (binary). Should be 1 for post-treatment period and 0 for pre-treatment period. Should not contain missing values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Covariates to be controlled for. Should not contain missing values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MLmethod</code></td>
<td>
<p>Machine learning method for estimating nuisance parameters using the <code>SuperLearner</code> package. Must be one of <code>"lasso"</code> (default), <code>"randomforest"</code>, <code>"xgboost"</code>, <code>"svm"</code>, <code>"ensemble"</code>, or <code>"parametric"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est</code></td>
<td>
<p>Estimation method. Must be one of <code>"dr"</code> (default) for doubly robust, <code>"ipw"</code> for inverse probability weighting (not doubly robust!), or <code>"reg"</code> for regression (not doubly robust!).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trim</code></td>
<td>
<p>Trimming threshold (in percentage) for discarding observations with too small propensity scores within any subgroup defined by the treatment group and time. Default is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>Optional clustering variable for calculating cluster-robust standard errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Number of folds in k-fold cross-fitting. Default is 3.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function estimates the Average Treatment Effect on the Treated (ATET) in the post-treatment period based on Difference-in-Differences in repeated cross-sections when controlling for confounders in a data-adaptive manner using double machine learning. The function supports different machine learning methods to estimate nuisance parameters (conditional mean outcomes and propensity scores) as well as cross-fitting to mitigate overfitting. Besides double machine learning, the function also provides inverse probability weighting and regression adjustment methods (which are, however, not doubly robust).
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>
<p><code>ATET</code>: Estimate of the Average Treatment Effect on the Treated (ATET) in the post-treatment period.
</p>
<p><code>se</code>: Standard error of the ATET estimate.
</p>
<p><code>pval</code>: P-value of the ATET estimate.
</p>
<p><code>trimmed</code>: Number of discarded (trimmed) observations.
</p>
<p><code>pscores</code>: Propensity scores (4 columns): under treatment in period 1, under treatment in period 0, under control in period 1, under control in period 0.
</p>
<p><code>outcomepred</code>: Conditional outcome predictions (3 columns): in treatment group in period 0, in control group in period 1, in control group in period 0.
</p>


<h3>References</h3>

<p>Chernozhukov, V., Chetverikov, D., Demirer, M., Duflo, E., Hansen, C., Newey, W., Robins, J. (2018): "Double/debiased machine learning for treatment and structural parameters", The Econometrics Journal, 21, C1-C68.
</p>
<p>Zimmert, M. (2020): "Efficient difference-in-differences estimation with high-dimensional common trend confounding", arXiv preprint 1809.01643.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Example with simulated data
n=4000                            # sample size
t=1*(rnorm(n)&gt;0)                  # time period
u=runif(n,0,1)                    # time constant unobservable
x= 0.25*t+runif(n,0,1)            # time varying covariate
d=1*(x+u+2*rnorm(n)&gt;0)            # treatment
y=d*t+t+x+u+2*rnorm(n)            # outcome
# true effect is equal to 1
results=didDML(y=y, d=d, t=t, x=x)
cat("ATET: ", round(results$ATET, 3), ", Standard error: ", round(results$se, 3))

## End(Not run)
</code></pre>


</div>