<div class="container">

<table style="width: 100%;"><tr>
<td>The TFLR model with multiple compositional predictors</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
The TFLR model with multiple compositional predictors
</h2>

<h3>Description</h3>

<p>The TFLR model with multiple compositional predictors
</p>


<h3>Usage</h3>

<pre><code class="language-R">tflr2(y, x, wei = FALSE, xnew = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>A matrix with the compositional data (dependent variable). Zero values are allowed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>A list of matrices with the compositional predictors. Zero values are allowed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wei</code></td>
<td>

<p>Do you want weights among the different simplicial predictors? The default is FALSE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xnew</code></td>
<td>

<p>If you have new data use it, otherwise leave it NULL.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The transformation-free linear regression for compositional responses and predictors is implemented.
The function to be minized is <code class="reqn">-\sum_{i=1}^ny_i\log{y_i/(X_iB)}</code>. This is a self implementation of the function that can be found in the package codalm. This function allows for more than one simplicial predictors and offers the possibility of assigning weights to each simplicial predictor.
</p>


<h3>Value</h3>

<p>A list including:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>ini.mse</code></td>
<td>

<p>The mean squared error when all simplicial predictors carry equal weight.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ini.be</code></td>
<td>

<p>The beta coefficients when all simplicial predictors carry equal weight.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mse</code></td>
<td>

<p>The mean squared error when the simplicial predictors carry unequal weights.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>

<p>The weights in a vector form. A vector of length equal to the number of rows of the matrix of coefficients.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>am</code></td>
<td>

<p>The vector of weights, one for each simplicia predictor. The length of the vector is equal to the number of simplicial predictors.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est</code></td>
<td>

<p>The fitted of xnew if xnew is not NULL.
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Michail Tsagris.
</p>
<p>R implementation and documentation: Michail Tsagris <a href="mailto:mtsagris@uoc.gr">mtsagris@uoc.gr</a>.
</p>


<h3>References</h3>

<p>Fiksel J., Zeger S. and Datta A. (2022). A transformation-free linear regression for compositional outcomes and predictors. Biometrics, 78(3): 974â€“987.
</p>
<p>Tsagris. M. (2024). Constrained least squares simplicial-simplicial regression.
https://arxiv.org/pdf/2403.19835.pdf
</p>


<h3>See Also</h3>

<p><code>cv.scls, tflr, scls.indeptest </code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(MASS)
set.seed(1234)
y &lt;- rdiri(214, runif(4, 1, 3))
x1 &lt;- as.matrix(fgl[, 2:9])
x &lt;- list()
x[[ 1 ]] &lt;- x1 / rowSums(x1)
x[[ 2 ]] &lt;- Compositional::rdiri(214, runif(4))
mod &lt;- tflr2(y, x)
mod
</code></pre>


</div>