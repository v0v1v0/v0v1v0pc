<div class="container">

<table style="width: 100%;"><tr>
<td>click.EM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> EM algorithm for mixtures of Markov models </h2>

<h3>Description</h3>

<p>Runs the EM algorithm for finite mixture models with Markov model components.
</p>


<h3>Usage</h3>

<pre><code class="language-R">click.EM(X, y = NULL, K, eps = 1e-10, r = 100, iter = 5, min.beta = 1e-3,
  min.gamma = 1e-3, scale.const = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X </code></td>
<td>
<p> dataset array (p x p x n) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y </code></td>
<td>
<p> vector of initial states (length n) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K </code></td>
<td>
<p> number of mixture components </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps </code></td>
<td>
<p> tolerance level </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r </code></td>
<td>
<p> number of restarts for initialization</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter </code></td>
<td>
<p> number of iterations for each short EM run</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.beta </code></td>
<td>
<p> lower bound for initial state probabilities </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.gamma </code></td>
<td>
<p> lower bound for transition probabilities </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.const </code></td>
<td>
<p> scaling constant for avoiding numerical issues </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Runs the EM algorithm for finite mixture models with first order Markov model components. The function returns estimated mixing proportions 'alpha' and transition probabilty matrices 'gamma'. If initial states 'y' are not provided, initial state probabilities 'beta' are not estimated and assumed to be equal to 1 / p. In this case, the total number of estimated parameters is given by M = K - 1 + K * p * (p - 1). Otherwise, initial state probabilities 'beta' are also estimated and the total number of parameters is M = K - 1 + K * (p - 1) + K * p * (p - 1).
Notation: p - number of states, n - sample size, K - number of mixture components, d - number of equivalence blocks.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>z </code></td>
<td>
<p> matrix of posterior probabilities (n x K)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id </code></td>
<td>
<p> classification vector (length n)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha </code></td>
<td>
<p> vector of mixing proportions (length K)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta </code></td>
<td>
<p> matrix of initial state probabilities (K x p)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma </code></td>
<td>
<p> array of transition probabilities (p x p x K)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logl </code></td>
<td>
<p> log likelihood value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BIC </code></td>
<td>
<p> Bayesian Information Criterion</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Melnykov, V. (2016) Model-Based Biclustering of Clickstream Data, Computational Statistics and Data Analysis, 93, 31-45.
</p>
<p>Melnykov, V. (2016) ClickClust: An R Package for Model-Based Clustering of Categorical Sequences, Journal of Statistical Software, 74, 1-34.
</p>


<h3>See Also</h3>

<p>click.plot, click.forward, click.backward</p>


<h3>Examples</h3>

<pre><code class="language-R">

set.seed(123)

n.seq &lt;- 50

p &lt;- 5
K &lt;- 2
mix.prop &lt;- c(0.3, 0.7)


TP1 &lt;- matrix(c(0.20, 0.10, 0.15, 0.15, 0.40,
                0.20, 0.20, 0.20, 0.20, 0.20,
                0.15, 0.10, 0.20, 0.20, 0.35,
                0.15, 0.10, 0.20, 0.20, 0.35,
                0.30, 0.30, 0.10, 0.10, 0.20), byrow = TRUE, ncol = p)

TP2 &lt;- matrix(c(0.15, 0.15, 0.20, 0.20, 0.30,
                0.20, 0.10, 0.30, 0.30, 0.10,
                0.25, 0.20, 0.15, 0.15, 0.25,
                0.25, 0.20, 0.15, 0.15, 0.25,
                0.10, 0.30, 0.20, 0.20, 0.20), byrow = TRUE, ncol = p)


TP &lt;- array(rep(NA, p * p * K), c(p, p, K))
TP[,,1] &lt;- TP1
TP[,,2] &lt;- TP2


# DATA SIMULATION

A &lt;- click.sim(n = n.seq, int = c(10, 50), alpha = mix.prop, gamma = TP)
C &lt;- click.read(A$S)


# EM ALGORITHM (without initial state probabilities)

N2 &lt;- click.EM(X = C$X, K = 2)
N2$BIC


# EM ALGORITHM (with initial state probabilities)

M2 &lt;- click.EM(X = C$X, y = C$y, K = 2)
M2$BIC

</code></pre>


</div>