<div class="container">

<table style="width: 100%;"><tr>
<td>cusp3d</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Generate 3D plot of Cusp Catastrophe Model Fit </h2>

<h3>Description</h3>

<p>This function generates a 3D display of the fit (object) of a cusp model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cusp3d(y, alpha = if (!missing(y) &amp;&amp; is.list(y)) y$lin[, "alpha"],
    beta = if (!missing(y) &amp;&amp; is.list(y)) y$lin[, "beta"], w = 0.03,
    theta = 170, phi = 35, B = 4, Y = 3, Yfloor = -15,
    np = 180, n.surface = 30, surface.plot = TRUE,
    surf.alpha = 0.75, surf.gamma = 1.5, surf.chroma = 35, surf.hue = 240,
    surf.ltheta = 0, surf.lphi = 45, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p> object returned by <code>cusp</code> or a vector of observed state values </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p> vector of normal/symmetry factor values corresponding to the state values in <code>y</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p> vector of bifurcation/splitting factor values corresponding to the state values in <code>y</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p> number that specifies the size of the data points plotted on the cusp surface </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta,
phi</code></td>
<td>
<p> Angles defining the viewing direction: <code>theta</code> gives the azimuthal direction, and <code>phi</code> the colatitude. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p> range of the splitting factor axis </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p> range of the state variable axis </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Yfloor</code></td>
<td>
<p> location on state variable axis where the control surface is plotted </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>np</code></td>
<td>
<p> factor that determines the fineness of the drawing </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.surface</code></td>
<td>
<p> factor that determines the fineness of the rendered surface </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>surface.plot</code></td>
<td>
<p> plot the surface? </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>surf.alpha</code></td>
<td>
<p> transparency level of rendered surface </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>surf.gamma</code></td>
<td>
<p> factor that determines the shading of surface facets (<code>surf.gamma</code>&lt;1 diminishes shading, <code>surf.gamma</code>&gt;1 exaggerates shading) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>surf.chroma,
surf.hue</code></td>
<td>
<p> chroma and hue of surface color (see <code>hcl</code>) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>surf.ltheta,
surf.lphi</code></td>
<td>
<p> the surface is shaded as though it was being illuminated from the direction specified by azimuth <code>surf.ltheta</code> and colatitude <code>surf.lphi</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> named parameters that are passed to <code>persp</code> </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is experimental.
</p>


<h3>Value</h3>

<p><code>cusp3d</code> returns the viewing transformation matrix, say <code>VT</code>, a 4 x 4 matrix suitable for projecting 3D coordinates (x,y,z) into the 2D plane using homogeneous 4D coordinates (x,y,z,t). It can be used to superimpose additional graphical elements on the 3D plot, by lines() or points(), using the simple function trans3d().
</p>


<h3>Note</h3>

<p> Currently still somewhat buggy.
</p>


<h3>Author(s)</h3>

<p> Raoul Grasman </p>


<h3>References</h3>

<p> See <code>cusp-package</code> </p>


<h3>See Also</h3>

 <p><code>persp</code>, <code>plot.cusp</code>, <code>cusp3d.surface</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(123)
x1 = runif(150)
x2 = runif(150)
z = Vectorize(rcusp)(1, 4*x1-2, 4*x2-1)
data &lt;- data.frame(x1, x2, z)
fit &lt;- cusp(y ~ z, alpha ~ x1+x2, beta ~ x1+x2, data)

cusp3d(fit)

</code></pre>


</div>