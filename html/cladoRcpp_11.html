<div class="container">

<table style="width: 100%;"><tr>
<td>rcpp_calc_anclikes_sp_prebyte</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate probability of ancestral states below a speciation event, given probabilities of the states on each descendant branch</h2>

<h3>Description</h3>

<p>This is the pre-byte compiled version of <code>rcpp_calc_anclikes_sp</code>.  <code>rcpp_calc_anclikes_sp</code> is 
byte-compiled, which (might) make it faster.  See <code>rcpp_calc_anclikes_sp</code> for full description and help.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rcpp_calc_anclikes_sp_prebyte(Rcpp_leftprobs, Rcpp_rightprobs, l, s = 1,
  v = 1, j = 0, y = 1, dmat = NULL, maxent01s = NULL,
  maxent01v = NULL, maxent01j = NULL, maxent01y = NULL,
  max_minsize_as_function_of_ancsize = NULL, Rsp_rowsums = rep(1,
  length(Rcpp_leftprobs)), printmat = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Rcpp_leftprobs</code></td>
<td>
<p>Probabilities of the states at the base of the left descendant branch</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rcpp_rightprobs</code></td>
<td>
<p>Probabilities of the states at the base of the right descendant branch</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l</code></td>
<td>
<p>List of state indices (0-based)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>Relative weight of sympatric "subset" speciation. Default <code>s=1</code> mimics LAGRANGE model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>Relative weight of vicariant speciation. Default <code>v=1</code> mimics LAGRANGE model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>j</code></td>
<td>
<p>Relative weight of "founder event speciation"/jump speciation. Default <code>j=0</code> mimics LAGRANGE model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Relative weight of fully sympatric speciation (range-copying). Default <code>y=1</code> mimics LAGRANGE model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dmat</code></td>
<td>
<p>If given, a matrix of rank numareas giving multipliers for the probability
of each dispersal event between areas. Default NULL, which sets every cell of the 
<code>dmat</code> matrix to value 1.  Users may construct their own parameterized <code>dmat</code>
(for example, making <code>dmat</code> a function of distance) for inclusion in ML or
Bayesian analyses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxent01s</code></td>
<td>
<p>Matrix giving the relative weight of each possible descendant rangesize for 
the smaller range, for a given ancestral rangesize, for a subset-sympatric speciation event. 
Default is <code>NULL</code>, which means the script will set up the LAGRANGE model (one descendent
always has range size 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxent01v</code></td>
<td>
<p>Matrix giving the relative weight of each possible descendant rangesize for 
the smaller range, for a given ancestral rangesize, for a vicariance speciation event. 
Default is <code>NULL</code>, which means the script will set up the LAGRANGE model (one descendent 
always has range size 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxent01j</code></td>
<td>
<p>Matrix giving the relative weight of each possible descendant rangesize for 
the smaller range, for a given ancestral rangesize, for a founder-event speciation event. 
Default is <code>NULL</code>, which means the script will set up the LAGRANGE model (one descendent 
always has range size 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxent01y</code></td>
<td>
<p>Matrix giving the relative weight of each possible descendant rangesize for 
the smaller range, for a given ancestral rangesize, for a full-sympatric (range-copying) 
speciation event. 
Default is <code>NULL</code>, which means the script will set up the LAGRANGE model (one descendent 
always has range size 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_minsize_as_function_of_ancsize</code></td>
<td>
<p>If given, any state with a range larger that this value 
will be given a probability of zero (for the branch with the smaller rangesize).  This means that 
not every possible combination of ranges has to be checked, which can get very slow for large 
state spaces.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rsp_rowsums</code></td>
<td>
<p>A vector of size (numstates)  giving the sum of the relative probabilites of 
each combination of descendant states, assuming the probabilities of the left- and right-states are 
all equal (set to 1). This is thus the sum of the weights, and dividing by this normalization 
vector means that the each row of the speciation probability matrix will sum to 1.  Default assumes 
the weights sum to 1 but this is not usually the case. Rsp_rowsums need only be calculated once 
per tree+model combination, stored, and then re-used for each node in the tree, yielding 
significant time savings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>printmat</code></td>
<td>
<p>Should the probability matrix output be printed to screen? (useful for debugging, but 
can be dramatically slow in R.app for some reason for even moderate numbers of states; perhaps 
overrunning the line length...)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function gets slow for large state spaces.
</p>
<p>For information on byte-compiling, see <a href="http://www.r-statistics.com/2012/04/speed-up-your-r-code-using-a-just-in-time-jit-compiler/">http://www.r-statistics.com/2012/04/speed-up-your-r-code-using-a-just-in-time-jit-compiler/</a> and <code>cmpfun</code> in the <code>compiler</code> package.
</p>


<h3>Value</h3>

<p><code>prob_ancestral_states</code> The probabilities of the ancestral states.
</p>


<h3>Author(s)</h3>

<p>Nicholas Matzke <a href="mailto:matzke@berkeley.edu">matzke@berkeley.edu</a>
</p>


<h3>See Also</h3>

<p><code>rcpp_calc_anclikes_sp</code>
#bibliography /Dropbox/_njm/__packages/cladoRcpp_setup/cladoRcpp_refs.bib
@cite Matzke_2013
@cite Matzke_2014
@cite ReeSmith2008
</p>


<h3>Examples</h3>

<pre><code class="language-R"># For the basic logic of a probablistic cladogenesis model, see
?rcpp_calc_anclikes_sp

# For examples of running the functions, see the comparison of all functions at:
# ?cladoRcpp

</code></pre>


</div>