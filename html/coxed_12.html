<div class="container">

<table style="width: 100%;"><tr>
<td>coxed.npsf.tvc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Predict expected durations using the GAM method with time-varying covariates</h2>

<h3>Description</h3>

<p>This function is called by <code>coxed</code> and is not intended to be used by itself.
</p>


<h3>Usage</h3>

<pre><code class="language-R">coxed.npsf.tvc(cox.model, newdata = NULL, coef = NULL, b.ind = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cox.model</code></td>
<td>
<p>The output from a Cox proportional hazards model estimated
with the <code>coxph</code> function in the <code>survival</code> package
or with the <code>cph</code> function in the <code>rms</code>
package</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>An optional data frame in which to look for variables with
which to predict. If omitted, the fitted values are used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef</code></td>
<td>
<p>A vector of new coefficients to replace the <code>coefficients</code> attribute
of the <code>cox.model</code>. Used primarily for bootstrapping, to recalculate durations
using new coefficients derived from a bootstrapped sample.
If <code>NULL</code>, the original coefficients are employed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b.ind</code></td>
<td>
<p>A vector of observation numbers to pass to the estimation sample to construct
the a bootstrapped sample with replacement</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function employs the NPSF method of generating expected durations described
in Kropko and Harden (2018). See <code>coxed.npsf</code> for details.  This code
replicates the code for <code>cox.npsf</code>, but works with data whose structure allows time-varying
covariates, and requires using the <code>time2</code> argument of the <code>Surv</code> function.
This function requires the data to be reported as cumulative durations. The cumulative baseline hazard
function model is estimated using the ending times for each interval. Then the expected durations are
drawn from the Cox model and the NPSF method as with <code>coxed.npsf</code>.
</p>


<h3>Value</h3>

<p>Returns a list containing the following components:
</p>

<table>
<tr>
<td style="text-align: left;">
<code>exp.dur</code> </td>
<td style="text-align: left;"> A vector of predicted mean durations for the estimation sample
if <code>newdata</code> is omitted, or else for the specified new data. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>baseline.functions</code> </td>
<td style="text-align: left;"> The estimated cumulative baseline hazard function and survivor function. </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jonathan Kropko &lt;jkropko@virginia.edu&gt; and Jeffrey J. Harden &lt;jharden2@nd.edu&gt;
</p>


<h3>References</h3>

<p>Kropko, J. and Harden, J. J. (2018). Beyond the Hazard Ratio: Generating Expected Durations
from the Cox Proportional Hazards Model. <em>British Journal of Political Science</em>
<a href="https://doi.org/10.1017/S000712341700045X">https://doi.org/10.1017/S000712341700045X</a>
</p>


<h3>See Also</h3>

<p><code>coxed</code>, <code>coxed.npsf</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">bs.surv &lt;- Surv(time = boxsteffensmeier$start, time2 = boxsteffensmeier$te,
     event = boxsteffensmeier$cut_hi)
bs.cox &lt;- coxph(bs.surv ~ ec + dem + south + iv, data = boxsteffensmeier, method = "breslow")

ed &lt;- coxed.npsf.tvc(bs.cox)
ed$exp.dur
</code></pre>


</div>