<div class="container">

<table style="width: 100%;"><tr>
<td>XGpred</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>XGpred: Building Risk Classification Predictive Models using Survival Data</h2>

<h3>Description</h3>

<p>The XGpred function is designed to generate an empirical Bayesian-based binary risk classification model with survival data based on our novel XGpred algorithm, 
combining XGBoost and traditional survival analysis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">XGpred(
  data = NULL,
  varsIn = NULL,
  selection = FALSE,
  vsMethod = c("LASSO2", "LASSO2plus", "LASSO_plus"),
  time = NULL,
  event = NULL,
  nrounds = 5,
  probcut = 0.8,
  nclass = c(2, 3),
  topN = 10,
  outfile = "nameWithPath"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data matrix or a data frame where samples are in rows and features/traits are in columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varsIn</code></td>
<td>
<p>A vector of variables used for the prediction model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selection</code></td>
<td>
<p>Logical. Default is FALSE. If TRUE, three variable selection methods can be chosen.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vsMethod</code></td>
<td>
<p>When "selection" is set to TRUE, three variable selection methods can be chosen, with LASSO2 as the default method. The other two methods
are "LASSO2plus" and "LASSO_plus."</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>Time variable name.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>event</code></td>
<td>
<p>Event variable name.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrounds</code></td>
<td>
<p>The maximum number of boosting iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probcut</code></td>
<td>
<p>Probability cutoff for risk group classification. Default is set to 0.8.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nclass</code></td>
<td>
<p>Number of risk groups. By default, it is 2; any samples not classified into high-risk groups are classified into the low-risk group. 
When 3 is chosen, samples are classified into low, middle, and high-risk groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>topN</code></td>
<td>
<p>An integer indicating how many variables to select if LASSO_plus is chosen as the variable selection method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outfile</code></td>
<td>
<p>A string for the output file, including the path if necessary but without a file type extension.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If variable selection is needed, three variable selection methods are provided. Either the given variable or the selected variable list is used to build both an XGBoost model
and a traditional Cox model. Risk scores for each model are calculated and ranked, then averaged for each sample. 
The top 1/3 of samples are defined as the high-risk group, while the bottom 1/3 of samples are defined as the low-risk group. 
The binary risk classification model is built based on these two risk groups using either the given variable or the selected variable list. 
The model is a linear combination of these variables, with weights defined as t values derived from the single-variable linear model
of each variable on the two groups. Finally, the classification is based on empirical Bayesian probabilities.
</p>


<h3>Value</h3>

<p>A list is returned with the following seven items:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>ranks</code></td>
<td>
<p>Ranks from XGboost and Cox</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>twoEnds</code></td>
<td>
<p>High and low risk group samples identified by mean ranks from XGBoost and Cox models</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Weights for each variables used in the model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modelPars</code></td>
<td>
<p>Mean and standard error of model scores for each risk group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nclass</code></td>
<td>
<p>Number of risk groups</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>XGpred_score</code></td>
<td>
<p>Model XGpred score</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>XGpred_prob</code></td>
<td>
<p>Empirical Bayesian probability based on model XGpred score</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>XGpred_prob_class</code></td>
<td>
<p>Risk group classification based on XGpred_prob for the given probability cutoff</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probcut</code></td>
<td>
<p>Probability cutoff for risk group classification</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Aixiang Jiang
</p>


<h3>References</h3>

<p>Tianqi Chen and Carlos Guestrin (2016), "XGBoost: A Scalable Tree Boosting System", 22nd SIGKDD Conference on Knowledge Discovery and Data Mining, 2016, https://arxiv.org/abs/1603.02754
</p>
<p>Aoki T, Jiang A, Xu A et al.,(2023) Spatially Resolved Tumor Microenvironment Predicts Treatment Outcomes in Relapsed/Refractory Hodgkin Lymphoma. J Clin Oncol. 2023 Dec 19:JCO2301115. doi: 10.1200/JCO.23.01115. Epub ahead of print. PMID: 38113419.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load in data sets:
data("datlist", package = "csmpv")
tdat = datlist$training

# The function saves files locally. You can define your own temporary directory. 
# If not, tempdir() can be used to get the system's temporary directory.
temp_dir = tempdir()
# As an example, let's define Xvars, which will be used later:
Xvars = c("highIPI", "B.Symptoms", "MYC.IHC", "BCL2.IHC", "CD10.IHC", "BCL6.IHC")
# For given time-to-event outcome and Xvars, we can build up a binary risk classification:
 xgobj = XGpred(data = tdat, varsIn = Xvars, 
                time = "FFP..Years.", event = "Code.FFP", 
                outfile = paste0(temp_dir, "/XGpred"))
# You might save the files to the directory you want.

# To delete the temp_dir, use the following:
unlink(temp_dir)
</code></pre>


</div>