<div class="container">

<table style="width: 100%;"><tr>
<td>getRoots</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Convert a matrix of semi-processed DICOM images to root particle counts, volumes, and surface areas</h2>

<h3>Description</h3>

<p>Calculates the number of root/rhizome particles, volumes, and surface areas, for different size classes.  This version accommodates calibration curves with &gt;4 calibrants, and uses density thresholds converted to Hounsfield Units using the calibration curve (rather than direct calibration rod values) to partition sediment components.
</p>


<h3>Usage</h3>

<pre><code class="language-R">getRoots(mat.list, pixelA, diameter.classes = c(1, 2, 2.5, 10),
class.names = diameter.classes,
thickness = 0.625,
means     = c(-850.3233, 63.912, 271.7827, 1345.0696),
sds       = c(77.6953, 14.1728, 39.2814, 45.4129), 
densities = c(0.0012, 1, 1.23, 2.2),
pixel.minimum = 4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mat.list</code></td>
<td>
<p>list of DICOM images for a sediment core (values in Hounsfield Units)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pixelA</code></td>
<td>
<p>pixel area (mm2)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diameter.classes</code></td>
<td>
<p>an integer vector of diameter cut points. Units are mm (zero is added in automatically).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>class.names</code></td>
<td>
<p>not used presently</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thickness</code></td>
<td>
<p>slice thickness for computed tomography image series (mm)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>means</code></td>
<td>
<p>mean values (units = Hounsfield Units) for calibration rods used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sds</code></td>
<td>
<p>standard deviations (units = Hounsfield Units) for calibration rods used. Must be in the same order as <code>means</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>densities</code></td>
<td>
<p>numeric vector of known cal rod densities. Must be in the same order as <code>means</code> and <code>sds</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pixel.minimum</code></td>
<td>
<p>minimum number of pixels needed for a clump to be identified as a root</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Calculates the number of root/rhizome particles, volumes, and surface areas, for different size classes. This function requires that values be Hounsfield Units (i.e., data must be semi-processed from the raw DICOM imagery).
</p>


<h3>Value</h3>

<p>value <code>getRoots</code> returns a dataframe with one row per CT slice. Values returned are the number, volume (cm3), and surface area (cm2) of particles in each size class with an upper bound defined in <code>diameter.classes</code>.
</p>


<h3>See Also</h3>

<p><code>convert</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">ct.slope &lt;- unique(extractHeader(core_426$hdr, "RescaleSlope"))
ct.int   &lt;- unique(extractHeader(core_426$hdr, "RescaleIntercept")) 
# convert raw units to Hounsfield units
HU_426 &lt;- lapply(core_426$img, function(x) x*ct.slope + ct.int)

rootChars &lt;- getRoots(HU_426, pixelA = 0.0596,
diameter.classes = c(2.5, 10))

## Not run: 
# plot using "ggplot" package after transforming with "reshape2" package
area.long &lt;- reshape2::melt(rootChars, id.vars = c("depth"), 
   measure.vars = grep("Area", names(rootChars)))
ggplot2::ggplot(data = area.long, ggplot2::aes(y = -depth, x = value, 
   color = variable)) + ggplot2::geom_point() + ggplot2::theme_classic() + 
   ggplot2::xlab("root external surface area per slice (cm2)")

## End(Not run)

</code></pre>


</div>