<div class="container">

<table style="width: 100%;"><tr>
<td>l2Transformer</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Log Based Count Transformation Minimizing Sum of Sample-Specific Squared Difference
</h2>

<h3>Description</h3>

<p>Log based count transformation minimizing sum of sample-specific squared difference.
</p>


<h3>Usage</h3>

<pre><code class="language-R">l2Transformer(mat, low = 1e-04, upp = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mat</code></td>
<td>

<p>G x n data matrix, where G is the number of genes and n is the number of subjects
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>low</code></td>
<td>

<p>lower bound for the model parameter
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upp</code></td>
<td>

<p>upper bound for the model parameter
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Denote <code class="reqn">x_{gi}</code> as the expression level of the <code class="reqn">g</code>-th gene for
the <code class="reqn">i</code>-th subject.
We perform the log transformation
</p>
<p style="text-align: center;"><code class="reqn">y_{gi}=\log_2\left(x_{gi} + \frac{1}{\delta}\right)</code>
</p>
<p>. The optimal value for the parameter <code class="reqn">\delta</code> is to minimize the sum of the squared 
difference between the sample mean and the sample median across <code class="reqn">n</code> subjects </p>
<p style="text-align: center;"><code class="reqn">\sum_{i=1}^{n}\left(\bar{y}_i - \tilde{y}_i\right)^2</code>
</p>
<p>,
<code class="reqn">\bar{y}_i=\sum_{g=1}^{G}y_{gi}/G</code> and 
<code class="reqn">\tilde{y}_i</code> is the median of <code class="reqn">y_{1i}, \ldots, y_{Gi}</code>, and
where <code class="reqn">G</code> is the number of genes and <code class="reqn">n</code> is the number of subjects.
</p>


<h3>Value</h3>

<p>A list with 3 elements:	   
</p>
<table>
<tr style="vertical-align: top;">
<td><code>res.delta </code></td>
<td>
<p>An object returned by <code>optimize</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta </code></td>
<td>
<p>model parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mat2 </code></td>
<td>
<p>transformed data matrix having the same dimension as <code>mat</code></p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Zeyu Zhang, Danyang Yu, Minseok Seo, Craig P. Hersh, Scott T. Weiss, Weiliang Qiu
</p>


<h3>References</h3>

<p>Zhang Z, Yu D, Seo M, Hersh CP, Weiss ST, Qiu W. 
Novel Data Transformations for RNA-seq Differential Expression Analysis. 
(2019) 9:4820 https://rdcu.be/brDe5
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(Biobase)

data(es)
print(es)

# expression set
ex = exprs(es)
print(dim(ex))
print(ex[1:3,1:2])

# mean-median before transformation
vec = c(ex)
m = mean(vec)
md = median(vec)
diff = m - md
cat("m=", m, ", md=", md, ", diff=", diff, "\n")

res = l2Transformer(mat = ex)

# estimated model parameter
print(res$delta)

# mean-median after transformation
vec2 = c(res$mat2)
m2 = mean(vec2)
md2 = median(vec2)
diff2 = m2 - md2
cat("m2=", m2, ", md2=", md2, ", diff2=", diff2, "\n")


</code></pre>


</div>