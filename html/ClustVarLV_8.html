<div class="container">

<table style="width: 100%;"><tr>
<td>CLV3W</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Hierarchical clustering of variables (associated with mode 2 three-way array)  with consolidation</h2>

<h3>Description</h3>

<p>Hierarchical Cluster Analysis of a set of variables (mode 2) given a three-way array with a further consolidation step.
Each group of variables is associated with a one-rank PARAFAC model (comp x loading x weight).
Moreover, a Non Negativity (NN) constraint may be added to the model, so that the loading coefficients have positive values.
Return an object of class clv3w.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CLV3W(X,mode.scale=0,NN=FALSE,moddendoinertie=TRUE,gmax=20,graph=TRUE,cp.rand=10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>: a three way array - variables of mode 2 will be clustered</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode.scale</code></td>
<td>
<p>: scaling parameter applied to X, by default  centering of X (for mode 2 x mode 3) is done. By default no scaling (mode.scale=0) <br>
0 : no scaling only centering - the default <br>
1 : scaling with standard deviation of  (mode 2 x mode 3) elements <br>
2 : global scaling (each block i.e. each mode 2 slice will have the same inertia ) <br>
3 : global scaling (each block i.e. each mode 3 slice will have the same inertia )</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NN</code></td>
<td>
<p>: non Negativity constraint to be added on the loading coefficients. By default no constraint (NN=FALSE)   <br>
TRUE : a non negativity constrained is applied on the loading coefficients to set them as positive values <br>
FALSE : loading coefficients may be either positive or negative</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>moddendoinertie</code></td>
<td>
<p>: dendrogram. By default it is based on the delta clustering criterion (moddendoinertie =TRUE) <br>
TRUE : dendrogram associated with the clustering criterion delta <br>
FALSE : dendrogram associated with the the height (cumulative delta)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gmax</code></td>
<td>
<p>: maximum number of partitions for which the consolidation will be done (default : gmax=11)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>graph</code></td>
<td>
<p>: boolean, if TRUE, the graphs associated with the dendrogram and the evolution of the aggregation criterion are displayed (default : graph=TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cp.rand</code></td>
<td>
<p>: number of random starts associated with the one rank Candecomp/Parafac model (By default cp.rand=10)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tabres</code></td>
<td>
<p> Results of the hierarchical clustering algorithm.
In each line you find the results of one specific step of the hierarchical clustering.
</p>

<ul>
<li> <p>Columns 1 and 2 : the numbers of the two groups which are merged
</p>
</li>
<li> <p>Column 3 : name of the new cluster
</p>
</li>
<li> <p>Column 4 : the value of the aggregation criterion for the Hierarchical Ascendant Clustering (delta) : delta loss
</p>
</li>
<li> <p>Column 5 : the loss value of the clustering criterion for the HAC
</p>
</li>
<li> <p>Column 6 : the percentage of explained inertia of the data array X
</p>
</li>
<li> <p>Column 7 : the loss value of the clustering criterion  after consolidation
</p>
</li>
<li> <p>Column 8 : the percentage of explained inertia of the data array X after consolidation 
</p>
</li>
<li> <p>Column 9 : number of iterations in the partitioning algorithm. <br>
Remark : A zero in columns 7 to 9 indicates that no consolidation was done
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hclust</code></td>
<td>
<p> contains the results of the HCA </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>partition K</code></td>
<td>
<p> contains a list for each number of clusters of the partition, K=1 to gmax with
</p>

<ul>
<li> <p>clusters :  in line 1, the groups membership before consolidation; in line 2 the groups membership after consolidation
</p>
</li>
<li> <p>comp : the latent components of the clusters associated with the first mode (after consolidation)
</p>
</li>
<li> <p>loading : the vector of loadings  associated with the second mode by cluster (after consolidation)
</p>
</li>
<li> <p>weigth : the vector of weights  associated with the third mode by cluster (after consolidation)
</p>
</li>
<li> <p>criterion : vector of loss giving for each cluster the residual amount between the sub-array and its reconstitution associated with the cluster one rank PARAFAC model (after consolidation)
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p> contains the clustering parameters
</p>

<ul>
<li> <p>gmax :  maximum number of partitions for which the consolidation has been done
</p>
</li>
<li> <p>X : the scaled three-way array
</p>
</li>
</ul>
</td>
</tr>
</table>
<p>call : call of the method
</p>


<h3>Author(s)</h3>

<p>Veronique Cariou, <a href="mailto:veronique.cariou@oniris-nantes.fr">veronique.cariou@oniris-nantes.fr</a>
</p>


<h3>References</h3>

<p>Wilderjans, T. F., &amp; Cariou, V. (2016). CLV3W: A clustering around latent variables approach to detect panel disagreement in three-way conventional sensory profiling data. Food quality and preference, 47, 45-53.
</p>
<p>Cariou, V., &amp; Wilderjans, T. F. (2018). Consumer segmentation in multi-attribute product evaluation by means of non-negatively constrained CLV3W. Food Quality and Preference, 67, 18-26.
</p>


<h3>See Also</h3>

<p>CLV3W_kmeans, get_comp, get_loading, get_partition, plot, plot_var.clv3w,
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(ciders)
## Cluster Analysis of cider sensory descriptors with block scaling
## to set the assessors to the same footing
res.cider&lt;-CLV3W(ciders,mode.scale=3,NN=FALSE,moddendoinertie=FALSE,gmax=20,graph=FALSE,cp.rand=5)
plot(res.cider,type="delta")
plot(res.cider,type="dendrogram")
print(res.cider)
summary(res.cider,2)
get_comp(res.cider,2)
get_loading(res.cider,2)
get_weight(res.cider,2)


</code></pre>


</div>