<div class="container">

<table style="width: 100%;"><tr>
<td>cb.sims.sim_impulse</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Impulse Simulation</h2>

<h3>Description</h3>

<p>Impulse Simulation
</p>


<h3>Usage</h3>

<pre><code class="language-R">cb.sims.sim_impulse(
  n = 100,
  pi = 0.5,
  eff_sz = 1,
  alpha = 2,
  unbalancedness = 1,
  err = 1/2,
  null = FALSE,
  a = -0.5,
  b = 1/2,
  c = 4,
  nbreaks = 200
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>the number of samples. Defaults to <code>100</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi</code></td>
<td>
<p>the balance between the classes, where samples will be from group 1
with probability <code>pi</code>, and group 2 with probability <code>1 - pi</code>. Defaults
to <code>0.5</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eff_sz</code></td>
<td>
<p>the treatment effect between the different groups. Defaults to <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>the alpha for the covariate sampling procedure. Defaults to <code>2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unbalancedness</code></td>
<td>
<p>the level of covariate dissimilarity between the covariates
for each of the groups. Defaults to <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>err</code></td>
<td>
<p>the level of noise for the simulation. Defaults to <code>1/2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null</code></td>
<td>
<p>whether to generate a null simulation. Defaults to <code>FALSE</code>. Same behavior can be achieved by setting <code>eff_sz = 0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>the first parameter for the covariate/outcome relationship. Defaults to <code>-0.5</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>the second parameter for the covariate/outcome relationship. Defaults to <code>1/2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c</code></td>
<td>
<p>the third parameter for the covariate/outcome relationship. Defaults to <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbreaks</code></td>
<td>
<p>the number of breakpoints for computing the expected outcome at a given covariate level
for each batch. Defaults to <code>200</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list, containing the following:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Ys</code></td>
<td>
<p>an <code>[n, 2]</code> matrix, containing the outcomes for each sample. The first dimension contains the "treatment effect".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ts</code></td>
<td>
<p>an <code>[n, 1]</code> matrix, containing the group/batch labels for each sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xs</code></td>
<td>
<p>an <code>[n, 1]</code> matrix, containing the covariate values for each sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Eps</code></td>
<td>
<p>an <code>[n, 1]</code> matrix, containing the error for each sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.bounds</code></td>
<td>
<p>the theoretical bounds for the covariate values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ytrue</code></td>
<td>
<p>an <code>[nbreaks*2, 2]</code> matrix, containing the expected outcomes at a covariate level indicated by <code>Xtrue</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ttrue</code></td>
<td>
<p>an <code>[nbreaks*2,1]</code> matrix, indicating the group/batch the expected outcomes and covariate breakpoints correspond to.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xtrue</code></td>
<td>
<p>an <code>[nbreaks*2, 1]</code> matrix, indicating the values of the covariate breakpoints for the theoretical expected outcome in <code>Ytrue</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Overlap</code></td>
<td>
<p>the theoretical degree of overlap between the covariate distributions for each of the two groups/batches.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A sigmoidal relationship between the covariate and the outcome. The first dimension of the outcome is:
</p>
<p style="text-align: center;"><code class="reqn">Y_i = c \times \phi(X_i, \mu = a, \sigma = b) - \text{eff\_sz} \times T_i + \frac{1}{2} \epsilon_i</code>
</p>

<p>where <code class="reqn">\phi(x, \mu, \sigma)</code> is the probability density function for the normal distribution with
mean <code class="reqn">\mu</code> and standard deviation <code class="reqn">\sigma</code>.
</p>
<p>where the batch/group labels are:
</p>
<p style="text-align: center;"><code class="reqn">T_i \overset{iid}{\sim} Bern(\pi)</code>
</p>

<p>The beta coefficient for the covariate sampling is:
</p>
<p style="text-align: center;"><code class="reqn">\beta = \alpha \times \text{unbalancedness}</code>
</p>

<p>The covariate values for the first batch are:
</p>
<p style="text-align: center;"><code class="reqn">X_i | T_i = 0 \overset{ind}{\sim} 2 Beta(\alpha, \beta) - 1</code>
</p>

<p>and the covariate values for the second batch are:
</p>
<p style="text-align: center;"><code class="reqn">X_i | T_i = 1 \overset{ind}{\sim} 2 Beta(\beta, \alpha) - 1</code>
</p>

<p>Note that <code class="reqn">X_i | T_i = 0 \overset{D}{=} - X_i | T_i = 1</code>, or that the covariates are symmetric
about the origin in distribution.
</p>
<p>Finally, the error terms are:
</p>
<p style="text-align: center;"><code class="reqn">\epsilon_i \overset{iid}{\sim} Norm(0, \text{err}^2)</code>
</p>

<p>For more details see the help vignette:
<code>vignette("causal_simulations", package = "causalBatch")</code>
</p>


<h3>Author(s)</h3>

<p>Eric W. Bridgeford
</p>


<h3>References</h3>

<p>Eric W. Bridgeford, et al. "A Causal Perspective for Batch Effects: When is no answer better than a wrong answer?" Biorxiv (2024).
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(causalBatch)
sim = cb.sims.sim_impulse()

</code></pre>


</div>