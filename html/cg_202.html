<div class="container">

<table style="width: 100%;"><tr>
<td>samplesizeTable.cgOneFactorFit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Estimate Sample Sizes based on a cgOneFactorFit object
</h2>

<h3>Description</h3>

<p>Estimate the sample size that would be required to detect a specified 
difference in a one factor study.  The estimate is based on the
variability that was observed in a previous one factor study.
A cgOneFactorSampleSizeTable class object is created. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'cgOneFactorFit'
samplesizeTable(fit, direction, mmdvec,
 power = 0.80, alpha = 0.05, nmax = 1000, display = "print", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fit </code></td>
<td>

<p>A <code>cgOneFactorFit</code> object from a previous one factor study.    
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>direction </code></td>
<td>

<p>A <code>character</code> value indicating whether the sample size should be estimated
to detect an <code>"increase"</code> or a <code>"decrease"</code>.  This only effects
the sample size estimates if the previous study in <code>fit</code> was 
analyzed on the log scale, in which case the differences in <code>mmdvec</code>
are relative differences instead of absolute differences.
For detecting relative changes, the sample size
required to detect a relative increase of 25% is not the same as the sample
size to detect a relative decrease of 25%, for example.  But for detecting
absolute changes, the sample size required
to detect an absolute increase of 25 is the same as the sample size
to detect an absolute decrease of 25.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mmdvec </code></td>
<td>

<p>A <code>numeric</code> <code>vector</code> specifying the minimum meaningful differences
to be detected in the future study.  If the previous study
in <code>fit</code> was analyzed on the log scale, then the values in <code>mmdvec</code>
are assumed to be relative percentage increases or decreases, depending
on the value of <code>direction</code>.  If the previous study in
<code>fit</code> was not analyzed on the log scale, then the values in <code>mmdvec</code>
are assumed to be absolute increases or decreases, depending on 
the value of <code>direction</code>. Each value in <code>mmdvec</code> needs to
be positive.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power </code></td>
<td>

<p>The power for the future study, set by default to be <code>0.80</code>.
This is equivalent
to <code class="reqn">1 - \beta</code>, where <code class="reqn">\beta</code> is the probability of
committing a Type II error: accepting the null hypothesis of
no difference when differences truly exist.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha </code></td>
<td>

<p>The significance level or alpha for the future study, set by default
as <code>0.05</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nmax </code></td>
<td>

<p>The maximum number of subjects per group.  If more subjects are estimated
to be required, then the exact number required is not reported, only the
fact that more than the maximum number would be required. This is in
place to prevent long and likely unnecessary calculations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>display </code></td>
<td>

<p>One of three valid values:
</p>

<dl>
<dt><code>"print"</code></dt>
<dd>
<p>The default value; It calls a <code>print</code> method for the
created <br><code>cgOneFactorSamplesizeTable</code> object, which is
a formatted text output of the table(s).
</p>
</dd>
<dt><code>"none"</code></dt>
<dd>
<p>Supresses any printing. Useful, for example, when just assignment
of the resulting object is desired.
</p>
</dd>
<dt><code>"show"</code></dt>
<dd>
<p>Calls the default <code>showDefault</code> method, which
will just print out the <code>cgOneFactorSamplesizeTable</code> components.
</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>... </code></td>
<td>

<p>Additional arguments.
</p>

<dl>
<dt>
<code>ngrps</code> </dt>
<dd>
<p>The number of groups that will be in the future one factor
study. The default is <code>ngrps = 2</code>.
</p>
</dd>
<dt><code>model</code></dt>
<dd>  
<p>A <code>character</code> value indicating which variability estimate
in
<code>fit</code> should be
used to estimate the sample size: the robust model (<code>"rronly"</code>),
the classical model (<code>"olsonly"</code>), or both (<code>"both"</code>).  If an estimate
is requested for a model that was not fit, then no sample sizes are returned
for that model but an error is not reported (e.g. if only the classical model
was fitted but "both" are requested, only the classical model estimates
will be returned):
</p>

<dl>
<dt><code>"both"</code></dt>
<dd>
<p>Sample Size tables based on both the ordinary 
classical least squares and resistant &amp; robust fits are
performed. This is the default when both fits are present in
the <code>cgOneFactorFit</code> object specified in the <code>fit</code>
argument. If the resistant &amp; robust fit is not available,
this value is not relevant.
</p>
</dd>
<dt><code>"olsonly"</code></dt>
<dd>
<p>Only a sample size table based on the ordinary 
classical least squares <code>olsfit</code> fit is calculated.
</p>
</dd>
<dt><code>"rronly"</code></dt>
<dd>
<p>Only a sample size table based on the resistant and
robust <code>rrfit</code> fit is calculated.
</p>
</dd>
</dl>
</dd>
</dl>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This sample size method does not work for fitted models that allowed unequal
variances or censored observations.
</p>
<p>Sample sizes are estimated for detecting a minimum difference with a global
F test. The algorithm is detailed in Fleiss (1986), Appendix A. When
there are more than 2 groups, the lower bound of possible
noncentrality parameter values is calculated from assuming only two of
the <code>ngrps</code> number of groups differ by the <code>mmdvec/2</code> amount
from the "grand mean" while the rest of the groups are equal to the grand
mean.
</p>
<p>For detecting an absolute difference, the sample size is the
smallest group size n for which<br><code>1 - pf (qf (1 - alpha, numdf, dendf), numdf,
  dendf, ncp)</code> exceeds <code>power</code>,<br> where <code>ncp = (n * mmdvec ^ 2) / (2 *
  sigamest ^ 2)</code>, and <code>sigmaest</code> is the residual mean square error from the model in
<code>fit</code>.  For detecting a relative difference, the calculations are
the same except<br><code>ncp = (n * (log (sign * mmdvec / 100 + 1) ) ^ 2) / (2
    * sigmaest ^ 2)</code>, where<br><code>sign = -1</code> if <code>direction="decreasing"</code>,
and <code>sign = 1</code> if <code>direction = "increasing"</code>.
</p>


<h3>Value</h3>

<p>Creates an object of class <code>cgOneFactorSampleSizeTable</code>, with the
following slots:
</p>

<dl>
<dt><code>ols.sstable</code></dt>
<dd>
<p>A matrix with the estimated sample sizes based on the
classical model variance estimates, or <code>NULL</code>.   The matrix has 3 columns and
one row for each element of the <code>mmdvec</code> <code>vector</code>.
The first column specifies the minimum meaningful difference (<code>"mmd"</code>).
The second column gives the number of subjects required for each 
group (<code>"n"</code>), possibly truncated at <code>nmax</code>.
The third column gives the total number of
subjects required (<code>"N"</code>), also truncated if
<code>nmax</code> is truncated.</p>
</dd>
<dt><code>rr.sstable</code></dt>
<dd>
<p>A matrix with the estimated sample sizes based on the
robust model variance estimates, or else <code>NULL</code> if
<code>model="olsonly"</code> was specified. See the <code>ols.sstable</code>
slot description above for the analogous layout of the matrix.
</p>
</dd>
<dt><code>settings</code></dt>
<dd>
<p>A list of properties mostly carried as-is from the
<code>data</code> argument object of class
<code>cgOneFactorData</code>, with the following additional members:
</p>

<dl>
<dt><code>sigmaest</code></dt>
<dd>
<p>A list with 2 members, <code>ols</code>, containing the
estimated spread (sigma, standard deviation) from
the classical model of <code>fit</code>, 
and <code>rr</code>,
containing the estimated spread (sigma, standard deviation)
from the robust model of
<code>fit</code>, or
<code>NULL</code> if the robust model was not fit.</p>
</dd>
<dt><code>planningname</code></dt>
<dd>
<p>A <code>character</code> describing the study
or purpose of the sample size analysis.  Taken from the 
<code>settings$analysisname</code> of the <code>fit</code> object. </p>
</dd>
<dt><code>ngrps</code></dt>
<dd>
<p>A saved copy of the <code>ngrps</code> argument. </p>
</dd>
<dt><code>direction</code></dt>
<dd>
<p>A saved copy of the <code>direction</code> argument. </p>
</dd>
<dt><code>alpha</code></dt>
<dd>
<p>A saved copy of the <code>alpha</code> argument. </p>
</dd>
<dt><code>power</code></dt>
<dd>
<p>A saved copy of the <code>power</code> argument. </p>
</dd>
<dt><code>nmax</code></dt>
<dd>
<p>A saved copy of the <code>nmax</code> argument. </p>
</dd>
</dl>
</dd>
</dl>
<h3>Note</h3>

<p>Contact <a href="mailto:cg@billpikounis.net">cg@billpikounis.net</a> for bug reports, questions,
concerns, and comments. 
</p>


<h3>Author(s)</h3>

<p>Bill Pikounis [aut, cre, cph], John Oleynick [aut], Eva Ye [ctb]
</p>


<h3>References</h3>

<p>Fleiss, J.L. (1986). <em>The Design and Analysis of Clinical
Experiments</em>, Appendix A, pages 371 - 376. New York: Wiley.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(canine)
canine.data &lt;- prepareCGOneFactorData(canine, format="groupcolumns",
                                      analysisname="Canine",
                                      endptname="Prostate Volume",
                                      endptunits=expression(plain(cm)^3),
                                      digits=1, logscale=TRUE, refgrp="CC")
canine.fit &lt;- fit(canine.data)

canine.samplesize &lt;- samplesizeTable(canine.fit, direction="increasing", 
                                     mmdvec=c(10, 25, 50, 75, 100))

samplesizeTable(canine.fit, direction="decreasing", 
                mmdvec=c(25, 50, 75), model="olsonly")
</code></pre>


</div>