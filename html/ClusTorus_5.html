<div class="container">

<table style="width: 100%;"><tr>
<td>clus.torus</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Clustering on the torus by conformal prediction</h2>

<h3>Description</h3>

<p><code>clus.torus</code> returns clustering results of data on the torus based on
inductive conformal prediction set
</p>


<h3>Usage</h3>

<pre><code class="language-R">clus.torus(
  data,
  split.id = NULL,
  model = c("kmeans", "mixture"),
  mixturefitmethod = c("axis-aligned", "circular", "general"),
  kmeansfitmethod = c("general", "homogeneous-circular", "heterogeneous-circular",
    "ellipsoids"),
  J = NULL,
  level = NULL,
  option = NULL,
  verbose = TRUE,
  ...
)

## S3 method for class 'clus.torus'
plot(
  x,
  panel = 1,
  assignment = "outlier",
  data = NULL,
  ellipse = TRUE,
  type = NULL,
  overlay = FALSE,
  out = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>n x d matrix of toroidal data on <code class="reqn">[0, 2\pi)^d</code>
or <code class="reqn">[-\pi, \pi)^d</code>. Default is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>split.id</code></td>
<td>
<p>a n-dimensional vector consisting of values 1 (estimation)
and 2(evaluation)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>A string. One of "mixture" and "kmeans" which
determines the model or estimation methods. If "mixture", the model is based
on the von Mises mixture, fitted
with an EM algorithm. It supports the von Mises mixture and its variants
based conformity scores. If "kmeans", the model is also based on the von
Mises mixture, but the parameter estimation is implemented with the
elliptical k-means algorithm. It supports the
log-max-mixture based conformity score only. If the
dimension of data space is greater than 2, only "kmeans" is supported.
Default is <code>model = "kmeans"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mixturefitmethod</code></td>
<td>
<p>A string. One of "circular", "axis-aligned", and
"general" which determines the constraint of the EM fitting. Default is
"axis-aligned". This argument only works for <code>model = "mixture"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kmeansfitmethod</code></td>
<td>
<p>A string. One of "general", ellipsoids",
"heterogeneous-circular" or "homogeneous-circular". If "general", the
elliptical k-means algorithm with no constraint is used. If "ellipsoids",
only the one iteration of the algorithm is used. If"heterogeneous-circular",
the same as above, but with the constraint that ellipsoids must be spheres.
If "homogeneous-circular", the same as above but the radii of the spheres are
identical. Default is "general". This argument only works for <code>model = "kmeans"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>J</code></td>
<td>
<p>the number of components for mixture model fitting. If <code>J</code> is a vector,
then <code>hyperparam.torus</code> is used to choose optimal <code>J</code>. If
<code>J == NULL</code>, then <code>J = 4:30</code> is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>a scalar in <code class="reqn">[0,1]</code>. The level of the conformal prediction set
used for clustering. If <code>level == NULL</code>, then <code>hyperparam.alpha</code> is
used to choose optimal <code>level</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>option</code></td>
<td>
<p>A string. One of "elbow", "risk", "AIC", or "BIC", which determines the
criterion for the model selection. "risk" is based on the negative log-likelihood, "AIC"
for the Akaike Information Criterion, and "BIC" for the Bayesian Information Criterion.
"elbow" is based on minimizing the criterion used in Jung et. al.(2021).
This argument is only used if <code>J</code> is a vector or <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>boolean index, which indicates whether display
additional details as to what the algorithm is doing or
how many loops are done. Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments that will be passed to <code>icp.torus</code> and
<code>hyperparam.torus</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p><code>clus.torus</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>panel</code></td>
<td>
<p>One of 1 or 2 which determines the type of plot. If <code>panel = 1</code>,
<code>x$cluster.obj</code> will be plotted, if <code>panel = 2</code>, <code>x$icp.torus</code> will be plotted.
If <code>panel = 3</code>, <code>x$hyperparam.select</code> will be plotted. Default is <code>panel = 1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>assignment</code></td>
<td>
<p>A string. One of "outlier", "log.density", "posterior", "mahalanobis". Default is "outlier".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ellipse</code></td>
<td>
<p>A boolean index which determines whether plotting ellipse-intersections. Default is <code>TRUE</code>. Only available
for <code>panel = 2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>A string. One of "mix", "max" or "e". This argument is only available if <code>icp.torus</code>
object is fitted with <code>model = "mixture"</code>. Default is <code>NULL</code>. If <code>type != NULL</code>, argument
<code>ellipse</code> automatically becomes <code>FALSE</code>. If "mix", it plots based on von Mises mixture.
If "max", it plots based on von Mises max-mixture. If "e", it plots based on ellipse-approximation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overlay</code></td>
<td>
<p>A boolean index which determines whether plotting ellipse-intersections on clustering plots. Default is <code>FALSE</code>.
Only available for <code>panel = 1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out</code></td>
<td>
<p>An option for returning the ggplot object. Default is <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>clus.torus</code> is a user-friendly all-in-one function which implements following
procedures automatically: 1. compute conformity scores for given model and fitting method,
2. choose optimal model and level based on prespecified criterion, and
3. make clusters based on the chosen model and level. Procedure 1-3 can be
independently done with <code>icp.torus</code>, <code>hyperparam.torus</code>,
<code>hyperparam.J</code>, <code>hyperparam.alpha</code> and <code>cluster.assign.torus</code>.
If you want to see more detail for each procedure, please see
<code>icp.torus</code>, <code>hyperparam.J</code>, <code>hyperparam.alpha</code>
<code>hyperparam.torus</code>, <code>cluster.assign.torus</code>.
</p>


<h3>Value</h3>

<p><code>clus.torus</code> returns a <code>clus.torus</code> object, which consists of following 3 different S3 objects;
</p>

<dl>
<dt><code>cluster.obj</code></dt>
<dd>
<p><code>cluster.obj</code> object; clustering assignment results for
several methods. For detail, see <code>cluster.assign.torus</code>.</p>
</dd>
<dt><code>icp.torus</code></dt>
<dd>
<p><code>icp.torus</code> object; containing model parameters and
conformity scores. For detail, see <code>icp.torus</code>.</p>
</dd>
<dt><code>hyperparam.select</code></dt>
<dd>
<p><code>hyperparam.torus</code> object (if <code>J = NULL</code> or a
sequence of numbers, and  <code>level = NULL</code> or a sequence of numbers), <code>hyperparam.J</code> object (if <code>level</code> is a scalar), or <code>hyperparam.alpha</code> object (if <code>J</code> is a scalar);
contains information for the optimally chosen model (number of components J) and level (alpha)
based on prespecified criterion.  For detail, see <code>hyperparam.torus</code>, <code>hyperparam.J</code>, and <code>hyperparam.alpha</code>.</p>
</dd>
</dl>
<h3>References</h3>

<p>Jung, S., Park, K., &amp; Kim, B. (2021). Clustering on the torus by conformal prediction. <em>The Annals of Applied Statistics</em>, 15(4), 1583-1603.
</p>
<p>Mardia, K. V., Kent, J. T., Zhang, Z., Taylor, C. C., &amp; Hamelryck, T. (2012). Mixtures of concentrated multivariate sine distributions with applications to bioinformatics. <em>Journal of Applied Statistics</em>, 39(11), 2475-2492.
</p>
<p>Shin, J., Rinaldo, A., &amp; Wasserman, L. (2019). Predictive clustering. <em>arXiv preprint arXiv:1903.08125</em>.
</p>


<h3>See Also</h3>

<p><code>icp.torus</code>, <code>hyperparam.torus</code>,
<code>hyperparam.J</code>, <code>hyperparam.alpha</code>
<code>cluster.assign.torus</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data &lt;- toydata2[, 1:2]
n &lt;- nrow(data)
clus.torus(data = data, model = "kmeans", kmeansfitmethod = "general", J = 5:30, option = "risk")

</code></pre>


</div>