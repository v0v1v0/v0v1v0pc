<div class="container">

<table style="width: 100%;"><tr>
<td>tobit2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Tobit II family for censored GAM</h2>

<h3>Description</h3>

<p>This function implements the Tobit II family for the mgcv package.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tobit2(link=list("identity","identity","log","logit2" ), 
censoring = FALSE, rho=NULL, eps = 1e-3) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>
<p>The link functions: Corresponds to <code>mu1</code>, <code>mu2</code>, <code>sigma</code> and <code>rho</code> respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>censoring</code></td>
<td>
<p>Vector of TRUE/FALSE values to denote censorship. TRUE values are censored</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>Value of rho. If NULL, is estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>Parameter to perturb rho in estimation if very close to -1 or 1.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Under the Tobit II model, given a value sigma and a conditional mean of mu1, and a censoring parameter mu2, response values are censored if mu2 + epsilon2 &lt; 0, and mu1 + sigma*epsilon1 otherwise.
</p>
<p>Here epsilon1, epsilon2 are distributed Normal(0, 1) with correlated rho.
</p>
<p>This function allows a non-linear relationship be estimated between mu1, mu2, sigma, rho and the covariates in a restricted maximum likelihood approach, via application of Wood (2016). Note that this allows for heteroskedastic errors.
</p>
<p>Estimation of rho depends on the distributional qualities near the censorship boundary, and is hence typically very inaccurate for typical sample sizes. Hence in practice it is often better to supply a value of rho (for example 0 to imply independent censorship) instead. eps is used when estimating rho to avoid errors when rho is close to 1 or -1. Smaller values may produce more accurate results.
</p>
<p>This method is still currently very *experimental*. It's not suggested to be used to important applications. Errors can occur if the default starting point for the function cause problems, consider changing the <code>start</code> argument to <code>gam</code>.
</p>


<h3>Value</h3>

<p>An object inheriting from class <code>family</code> for use with the mgcv package.
</p>


<h3>References</h3>

<p>Wood, S.N., N. Pya and B. Saefken (2016), Smoothing parameter and
model selection for general smooth models. Journal of the American
Statistical Association. &lt;URL: http://arxiv.org/abs/1511.03864&gt;
</p>


<h3>See Also</h3>

<p><code>gam</code>,<code>ziplss</code></p>


<h3>Examples</h3>

<pre><code class="language-R"># Generate a small example
set.seed(1)
x &lt;- matrix(2*rnorm(400), 200)
yn &lt;-  x[,1]^2 + x[,2]
y &lt;- yn + rnorm(200)
censored &lt;- (rnorm(200) + 2*x[,2]+1) &lt; 0 #censored according to x[,2]
ycensored &lt;- replace(y, censored, 0) 
m &lt;- gam(c(ycensored ~ s(x[,1]) + s(x[,2]) , ~x[,1]+x[,2], ~1,~1), 
family = tobit2(censoring = censored)) #estimated rho
par(mfrow = c(3,2))
plot(gam(y ~ s(x[,1]) + s(x[,2]) ), ylim=c(-5, 5), main = "True")
plot(m, ylim = c(-5, 5), main = "Tobit II estimated rho") 

summary(m) 
m$fitted #gives for each observation fitted mu1, mu2, sigma, rho

m2 &lt;- gam(c(ycensored ~ s(x[,1]) + s(x[,2]) , ~x[,1]+x[,2], ~1), 
family = tobit2(censoring = censored, rho=0)) #non estimated rho
plot(m2, ylim = c(-5, 5), main = "Tobit II fixed rho") 

## Not run: 
#Larger example
set.seed(1)
x &lt;- matrix(2*rnorm(1500), 500)
yn &lt;- 2*x[,3] + 4*cos(x[,1]*2)
y &lt;- yn + 3*rnorm(500)
censored &lt;- (rnorm(500) + 2*x[,2]) &lt; 0 #censored according to x[,2]
ycensored &lt;- replace(y, censored, 0)  

par(mfrow = c(3,3))

# True model
plot(gam(y ~ s(x[,1]) + s(x[,2]) + s(x[, 3])), ylim=c(-5, 5), main = "True")

# Naive estimation
plot(gam(ycensored ~ s(x[,1]) + s(x[,2]) + s(x[, 3])), ylim=c(-5, 5), main = "Naive")

# Tobit II estimation
m &lt;- gam(c(ycensored ~ s(x[,1]) + s(x[,2]) + s(x[, 3]), ~x[,1]+x[,2]+x[,3], ~1,~1), 
family = tobit2(censoring = censored))
plot(m, ylim = c(-5, 5), main = "Tobit II") 

#fitting with non-estimated rho
m2 &lt;- gam(c(ycensored ~ s(x[,1]) + s(x[,2]) + s(x[, 3]), ~x[,1]+x[,2]+x[,3],~1), 
family = tobit2(censoring = censored, rho=0))

## End(Not run)
</code></pre>


</div>