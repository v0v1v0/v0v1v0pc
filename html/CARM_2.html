<div class="container">

<table style="width: 100%;"><tr>
<td>ARM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Adaptive Randomization via Mahalanobis Distance</h2>

<h3>Description</h3>

<p>Allocates patients to one of two treatments using
Adaptive Randomization via Mahalanobis Distance proposed by
Yichen Qin,Yang Li, Wei Ma, Haoyu Yang, and Feifang Hu.(2022)
</p>


<h3>Usage</h3>

<pre><code class="language-R">ARM(covariate, assignment, q = 0.75)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>covariate</code></td>
<td>
<p>a data frame. A row of the dataframe
corresponds to the covariate profile of a patient.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>assignment</code></td>
<td>
<p>a vector. If partial patients had been allocated
, please input their allocation. IF
all the patients are not be allocated, please input
'assignment = NA' directly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>the biased coin probability.
<code class="reqn">q</code> should be larger than 1/2 and less than 1, default = 0.75</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Suppose that <code class="reqn">n</code> patients are to be assigned to two treatment groups.
Consider <code class="reqn">p</code>  continuous covariates for each patient.
<code class="reqn">T_i</code> is the assignment of the <code class="reqn">i</code>th patient.
The proposed procedure to assign units to treatment groups, namely adaptive
randomization via Mahalanobis distance (ARM), is outlined below.
</p>
<p>(1) Arrange all <code class="reqn">n</code> units randomly into a sequence
<code class="reqn">x_1,...,x_n</code>.
</p>
<p>(2) Assign the first two units with <code class="reqn">T_1=1</code> and <code class="reqn">T_2=2</code>.
</p>
<p>(3) Suppose that <code class="reqn">2i</code> units have been assigned to
treatment groups,
for the <code class="reqn">2i+1</code>-th and <code class="reqn">2i+2</code>-th units:
</p>
<p>(3a) If the <code class="reqn">2i+1</code>-th unit is assigned to treatment 1 and
the <code class="reqn">2i+2</code>-th
unit to treatment 2, then calculate the potential
Mahalanobis distance, between the updated treatment groups.
with <code class="reqn">2i+2</code> units, <code class="reqn">M_1(2i + 2)</code>.
</p>
<p>(3b) Similarly, if the <code class="reqn">2i+1</code>-th unit is
assigned to treatment 2 and
the <code class="reqn">2i+2</code>-th unit to treatment 1, then calculate the
other potential Mahalanobis distance, <code class="reqn">M_2(2i + 2)</code>.
</p>
<p>(4) Assign the <code class="reqn">2i+1</code>-th unit to treatment groups
according to the
following probabilities:
</p>
<p>if <code class="reqn"> M_1(2i + 2) &lt; M_2(2i + 2)</code>, <code class="reqn">P(T_{2i+1} = 1)= q</code>;
</p>
<p>if <code class="reqn"> M_1(2i + 2) &gt; M_2(2i + 2)</code>, <code class="reqn">P(T_{2i+1} = 1)= 1-q</code>;
</p>
<p>if <code class="reqn"> M_1(2i + 2) = M_2(2i + 2)</code>, <code class="reqn">P(T_{2i+1} = 1)= 0.5</code>.
</p>
<p>(5) Repeat the last two steps until all units are assigned. If n is odd,
assign the last unit to two treatments with equal probabilities.
</p>
<p>Mahalanobis distance <code class="reqn">M(n)</code> between the sample means across
different treatment groups is:
</p>
<p style="text-align: center;"><code class="reqn">M(n)= np(1-p)(\hat{x_1} - \hat{x_2})^Tcov(x)^{-1}(\hat{x_1} - \hat{x_2}</code>
</p>

<p>See the reference for more details.
</p>


<h3>Value</h3>

<p>An object of class "ARM" is a list containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>assignment</code></td>
<td>
<p>Allocation of patients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample_size</code></td>
<td>
<p>The number of patients in treatment 1 and treatment 2 respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Mahalanobis_Distance</code></td>
<td>
<p>Mahalanobis distance between treatment groups 1 and 2.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Qin, Y., Y. Li, W. Ma, H. Yang, and F. Hu (2022). Adaptive randomization via mahalanobis distance. Statistica Sinica.DOI:&lt;10.5705/ss.202020.0440&gt;.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(MASS)
#simulate covariates of patients
p &lt;- 6; n &lt;- 30
sigma &lt;- diag(p); mean &lt;- c(rep(0,p))
data &lt;- mvrnorm(n, mean, sigma)
covariate &lt;- as.data.frame(data)
#IF all the patients are not be allocated
ARM(covariate = covariate, assignment = NA, q=0.75)
#IF you had allocated partial patients
ARM(covariate = covariate,assignment = c(1,2),q=0.75)
</code></pre>


</div>