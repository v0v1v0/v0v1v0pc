<div class="container">

<table style="width: 100%;"><tr>
<td>psmat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Matrix / Array from Panel Series
</h2>

<h3>Description</h3>

<p><code>psmat</code> efficiently expands a panel-vector or 'indexed_series' ('pseries') into a matrix. If a data frame or 'indexed_frame' ('pdata.frame') is passed, <code>psmat</code> returns a 3D array or a list of matrices.  
</p>


<h3>Usage</h3>

<pre><code class="language-R">psmat(x, ...)

## Default S3 method:
psmat(x, g, t = NULL, transpose = FALSE, ...)

## S3 method for class 'data.frame'
psmat(x, by, t = NULL, cols = NULL, transpose = FALSE, array = TRUE, ...)

# Methods for indexed data / compatibility with plm:

## S3 method for class 'pseries'
psmat(x, transpose = FALSE, drop.index.levels = "none", ...)

## S3 method for class 'pdata.frame'
psmat(x, cols = NULL, transpose = FALSE, array = TRUE, drop.index.levels = "none", ...)


## S3 method for class 'psmat'
plot(x, legend = FALSE, colours = legend, labs = NULL, grid = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a vector, indexed series 'indexed_series' ('pseries'), data frame or 'indexed_frame' ('pdata.frame').</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>a factor, <code>GRP</code> object, atomic vector (internally converted to factor) or a list of vectors / factors (internally converted to a <code>GRP</code> object) used to group <code>x</code>. If the panel is balanced an integer indicating the number of groups can also be supplied. See Examples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by</code></td>
<td>
<p><em>data.frame method</em>: Same input as <code>g</code>, but also allows one- or two-sided formulas using the variables in <code>x</code>, i.e. <code>~ idvar</code> or <code>var1 + var2 ~ idvar1 + idvar2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>same inputs as <code>g/by</code>, to indicate the time-variable(s) or second identifier(s). <code>g</code> and <code>t</code> together should fully identify the panel. If <code>t = NULL</code>, the data is assumed sorted and <code>seq_col</code> is used to generate rownames for the output matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cols</code></td>
<td>
<p><em>data.frame method</em>: Select columns using a function, column names, indices or a logical vector. <em>Note</em>: <code>cols</code> is ignored if a two-sided formula is passed to <code>by</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transpose</code></td>
<td>
<p>logical. <code>TRUE</code> generates the matrix such that <code>g/by -&gt; columns, t -&gt; rows</code>. Default is <code>g/by -&gt; rows, t -&gt; columns</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>array</code></td>
<td>
<p><em>data.frame / pdata.frame methods</em>: logical. <code>TRUE</code> returns a 3D array (if just one column is selected a matrix is returned). <code>FALSE</code> returns a list of matrices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop.index.levels</code></td>
<td>
<p>character. Either <code>"id"</code>, <code>"time"</code>, <code>"all"</code> or <code>"none"</code>. See indexing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments to be passed to or from other methods, or for the plot method additional arguments passed to <code>ts.plot</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>
<p>logical. Automatically create a legend of panel-groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colours</code></td>
<td>
<p>either <code>TRUE</code> to automatically colour by panel-groups using <code>rainbow</code> or a character vector of colours matching the number of panel-groups (series).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labs</code></td>
<td>
<p>character. Provide a character-vector of variable labels / series titles when plotting an array.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>logical. Calls <code>grid</code> to draw gridlines on the plot.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If n &gt; 2 index variables are attached to an indexed series or frame, the first n-1 variables in the index are interacted.
</p>


<h3>Value</h3>

<p>A matrix or 3D array containing the data in <code>x</code>, where by default the rows constitute the groups-ids (<code>g/by</code>) and the columns the time variable or individual ids (<code>t</code>). 3D arrays contain the variables in the 3rd dimension. The objects have a class 'psmat', and also a 'transpose' attribute indicating whether <code>transpose = TRUE</code>.
</p>


<h3>Note</h3>

<p>The <code>pdata.frame</code> method only works for properly subsetted objects of class 'pdata.frame'. A list of 'pseries' won't work. There also exist simple <code>aperm</code> and <code>[</code> (subset) methods for 'psmat' objects. These differ from the default methods only by keeping the class and the 'transpose' attribute.
</p>


<h3>See Also</h3>

<p>Time Series and Panel Series, Collapse Overview 
</p>


<h3>Examples</h3>

<pre><code class="language-R">## World Development Panel Data
head(wlddev)                                                    # View data
qsu(wlddev, pid = ~ iso3c, cols = 9:12, vlabels = TRUE)         # Sumarizing data
str(psmat(wlddev$PCGDP, wlddev$iso3c, wlddev$year))             # Generating matrix of GDP
r &lt;- psmat(wlddev, PCGDP ~ iso3c, ~ year)                       # Same thing using data.frame method
plot(r, main = vlabels(wlddev)[9], xlab = "Year")               # Plot the matrix
str(r)                                                          # See srructure
str(psmat(wlddev$PCGDP, wlddev$iso3c))                          # The Data is sorted, could omit t
str(psmat(wlddev$PCGDP, 216))                                   # This panel is also balanced, so
# ..indicating the number of groups would be sufficient to obtain a matrix

ar &lt;- psmat(wlddev, ~ iso3c, ~ year, 9:12)                      # Get array of transposed matrices
str(ar)
plot(ar)
plot(ar, legend = TRUE)
plot(psmat(collap(wlddev, ~region+year, cols = 9:12),           # More legible and fancy plot
           ~region, ~year), legend = TRUE,
     labs = vlabels(wlddev)[9:12])

psml &lt;- psmat(wlddev, ~ iso3c, ~ year, 9:12, array = FALSE)     # This gives list of ps-matrices
head(unlist2d(psml, "Variable", "Country", id.factor = TRUE),2) # Using unlist2d, can generate DF

## Indexing simplifies things
wldi &lt;- findex_by(wlddev, iso3c, year)  # Creating an indexed frame
PCGDP &lt;- wldi$PCGDP                     # An indexed_series of GDP per Capita
head(psmat(PCGDP), 2)                   # Same as above, more parsimonious
plot(psmat(PCGDP))
plot(psmat(wldi[9:12]))
plot(psmat(G(wldi[9:12])))              # Here plotting panel-growth rates

</code></pre>


</div>