<div class="container">

<table style="width: 100%;"><tr>
<td>estimateNPCondCopula</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute a kernel-based estimator of the conditional copula</h2>

<h3>Description</h3>

<p>Assuming that we observe a sample <code class="reqn">(X_{i,1}, X_{i,2}, X_{i,3}), i=1, \dots, n</code>,
this function returns a array
<code class="reqn">\hat C_{1,2|3}(u_1, u_2 | X_3 = x_3)</code>
for each choice of (u_1, u_2, x_3).
</p>


<h3>Usage</h3>

<pre><code class="language-R">estimateNPCondCopula(
  X1 = NULL,
  X2 = NULL,
  X3 = NULL,
  U1_,
  U2_,
  newX3,
  kernel,
  h,
  observedX1 = NULL,
  observedX2 = NULL,
  observedX3 = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X1, X2, X3</code></td>
<td>
<p>vectors of observations of size <code>n</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>U1_</code></td>
<td>
<p>a vector of numbers in [0, 1]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>U2_</code></td>
<td>
<p>a vector of numbers in [0, 1]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newX3</code></td>
<td>
<p>a vector of new values for the conditioning variable <code>X3</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel</code></td>
<td>
<p>a character string describing the kernel to be used.
Possible choices are <code>Gaussian</code>, <code>Triangular</code> and <code>Epanechnikov</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>the bandwidth to use in the estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>observedX1, observedX2, observedX3</code></td>
<td>
<p>old parameter names for <code>X1</code>,
<code>X2</code>, <code>X3</code>. Support for this will be removed at a later version.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An array of dimension <code>(length(U1_, U2_, newX3))</code>
whose element in position (i, j, k) is
<code class="reqn">\hat C_{1,2|3}(u_1, u_2 | X_3 = x_3)</code>
where <code class="reqn">u_1</code> = U1_[i], <code class="reqn">u_2</code> = U2_[j] and <code class="reqn">x_3</code> = newX3[k]
</p>


<h3>References</h3>

<p>Derumigny, A., &amp; Fermanian, J. D. (2017).
About tests of the “simplifying” assumption for conditional copulas.
Dependence Modeling, 5(1), 154-197.
<a href="https://doi.org/10.1515/demo-2017-0011">doi:10.1515/demo-2017-0011</a>
</p>


<h3>See Also</h3>

<p><code>estimateParCondCopula</code> for estimating a conditional
copula in a parametric setting ( = where the conditional copula is assumed to
belong to a parametric class).
<code>simpA.NP</code> for a test that this conditional copula is
constant with respect to the value <code class="reqn">x_3</code> of the conditioning variable.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># We simulate from a conditional copula
N = 500
X3 = rnorm(n = N, mean = 5, sd = 2)
conditionalTau = 0.9 * pnorm(X3, mean = 5, sd = 2)
simCopula = VineCopula::BiCopSim(N=N , family = 3,
    par = VineCopula::BiCopTau2Par(1 , conditionalTau ))
X1 = qnorm(simCopula[,1])
X2 = qnorm(simCopula[,2])

# We do the estimation
grid = c(0.2, 0.4, 0.6, 0.8)
arrayEst = estimateNPCondCopula(
  X1 = X1, X2 = X2, X3 = X3,
  U1_ = grid, U2_ = grid, newX3 = c(2, 5, 7),
  kernel = "Gaussian", h = 0.8)
arrayEst

</code></pre>


</div>