<div class="container">

<table style="width: 100%;"><tr>
<td>CFO.simu</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Conduct one simulation using the calibration-free odds (CFO) or accumulative CFO (aCFO) design for phase I trials.</h2>

<h3>Description</h3>

<p>In the CFO and aCFO designs for phase I trials, the function is used to conduct one single simulation and find the maximum tolerated dose (MTD).
</p>


<h3>Usage</h3>

<pre><code class="language-R">CFO.simu(design, target, p.true, init.level = 1, ncohort, cohortsize,
       prior.para = list(alp.prior = target, bet.prior = 1 - target), 
       cutoff.eli = 0.95, early.stop = 0.95, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>
<p>option for selecting different designs, which can be set as <code>'CFO'</code> and <code>'aCFO'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>
<p>the target DLT rate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.true</code></td>
<td>
<p>the true DLT rates under the different dose levels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init.level</code></td>
<td>
<p>the dose level assigned to the first cohort. The default value <code>init.level</code> is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncohort</code></td>
<td>
<p>the total number of cohorts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cohortsize</code></td>
<td>
<p>the number of patients of each cohort.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior.para</code></td>
<td>
<p>the prior parameters for a beta distribution, where set as <code>list(alp.prior = target, bet.prior = 1 - target)</code>
by default, <code>alp.prior</code> and <code>bet.prior</code> represent the parameters of the prior distribution for
the true DLT rate at any dose level. This prior distribution is specified as Beta(<code>alpha.prior</code>, <code>beta.prior</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff.eli</code></td>
<td>
<p>the cutoff to eliminate overly toxic doses for safety. We recommend
the default value of <code>cutoff.eli = 0.95</code> for general use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>early.stop</code></td>
<td>
<p>the threshold value for early stopping. The default value <code>early.stop = 0.95</code>
generally works well.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>an integer to be set as the seed of the random number generator for reproducible results. The default value is set to <code>NULL</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The <code>CFO.simu</code> function returns a list object comprising the following components:
</p>

<ul>
<li>
<p> target: the target DLT rate.
</p>
</li>
<li>
<p> MTD: the selected MTD. <code>MTD = 99</code> indicates that the simulation is terminated due to early stopping.
</p>
</li>
<li>
<p> correct: a binary indicator of whether the recommended dose level matches the correct MTD (1 for yes).
The correct MTD is the dose level at which the true DLT rate is closest to the target DLT rate.
</p>
</li>
<li>
<p> npatients: the total number of patients allocated to all dose levels.
</p>
</li>
<li>
<p> ntox: the total number of DLTs observed for all dose levels.
</p>
</li>
<li>
<p> over.doses: a vector indicating whether each dose is overdosed or not (1 for yes).
</p>
</li>
<li>
<p> cohortdose: a vector including the dose level assigned to each cohort.
</p>
</li>
<li>
<p> ptoxic: the percentage of subjects assigned to dose levels with a DLT rate greater than the target.
</p>
</li>
<li>
<p> patientDLT: a vector including the DLT outcome observed for each patient.
</p>
</li>
<li>
<p> sumDLT: the total number of DLT observed.
</p>
</li>
<li>
<p> earlystop: a binary indicator of whether the trial is early stopped (1 for yes).
</p>
</li>
</ul>
<h3>Note</h3>

<p>The <code>CFO.simu()</code> function is designed to conduct a single CFO or aCFO simulation. If <code>design = 'CFO'</code>, it corresponds
to the CFO design. If <code>design = 'aCFO'</code>, it corresponds to the aCFO design. <br>
The early stopping and dose elimination rules are incorporated into the CFO or aCFO design
to ensure patient safety and benefit. If there is substantial evidence indicating that the current dose level
exhibits excessive toxicity, we exclude the current dose level as well as higher dose levels from the trial. If the lowest dose level is overly toxic, the trial will be terminated
according to the early stopping rule. Upon the predefined maximum sample size is reached or the lowest dose
level is over-toxicity, the experiment is concluded, and the MTD is determined using isotonic regression.
</p>


<h3>Author(s)</h3>

<p>Jialu Fang, Wenliang Wang, Ninghao Zhang, and Guosheng Yin
</p>


<h3>References</h3>

<p>Jin H, Yin G (2022). CFO: Calibration-free odds design for phase I/II clinical trials.
<em>Statistical Methods in Medical Research</em>, 31(6), 1051-1066. <br>
Fang J, Yin G (2024). Fractional accumulative calibration‐free odds (f‐aCFO) design for delayed toxicity
in phase I clinical trials. <em>Statistics in Medicine</em>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">target &lt;- 0.2; ncohort &lt;- 12; cohortsize &lt;- 3; init.level &lt;- 1
p.true &lt;- c(0.01, 0.07, 0.20, 0.35, 0.50, 0.65, 0.80)
### find the MTD for a single CFO simulation
CFOtrial &lt;- CFO.simu(design = 'CFO', target, p.true, init.level, ncohort, cohortsize, seed = 1)
summary(CFOtrial)
plot(CFOtrial)

# This test may take longer than 5 seconds to run
# It is provided for illustration purposes only
# Users can run this code directly
### find the MTD for a single aCFO simulation
aCFOtrial &lt;- CFO.simu(design = 'aCFO', target, p.true, init.level, ncohort, cohortsize, seed = 1)
summary(aCFOtrial)
plot(aCFOtrial)

</code></pre>


</div>