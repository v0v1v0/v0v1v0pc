<div class="container">

<table style="width: 100%;"><tr>
<td>SimulateCVR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate simulation data.</h2>

<h3>Description</h3>

<p>Generate two sets of covariates and an univariate response driven by several latent factors.
</p>


<h3>Usage</h3>

<pre><code class="language-R">SimulateCVR(family = c("gaussian", "binomial", "poisson"), n = 100,  
         rank = 4, p1 = 50, p2 = 70, pnz = 10, sigmax = 0.2,   
         sigmay = 0.5, beta = c(2, 1, 0, 0), standardization = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>Type of response. <code>"gaussian"</code> for continuous response, <code>"binomial"</code>
for binary response, and <code>"poisson"</code> for Poisson response. The default is <code>"gaussian"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of rows. The default is 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rank</code></td>
<td>
<p>Number of latent factors generating the covariates.  The default is 4.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p1</code></td>
<td>
<p>Number of variables in X1. The default is 50.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p2</code></td>
<td>
<p>Number of variables in X2. The default is 70.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pnz</code></td>
<td>
<p>Number of variables in X1 and X2 related to the signal. The default is 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigmax</code></td>
<td>
<p>Standard deviation of normal noise in X1 and X2. The default is 0.2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigmay</code></td>
<td>
<p>Standard deviation of normal noise in Y. Only used when the response is Gaussian. The default is 0.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>Numeric vector, the coefficients used to generate respose from the latent factors. The default is c(2, 1, 0, 0).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>standardization</code></td>
<td>
<p>Logical. If TRUE, standardize X1 and X2 before output. The default is TRUE.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The latent factors in U are randomly generated normal vectors, 
</p>
<p><code class="reqn">X_1 = U*V_1 + \sigma_x*E_1, X_2 = U*V_2 + \sigma_x*E_2, E_1, E_2</code> are N(0,1) noise matrices.
</p>
<p>The nonzero entries of <code class="reqn">V_1</code> and <code class="reqn">V_2</code> are generated from Uniform([-1,-0.5]U[0.5,1]).
</p>
<p>For Gaussian response, 
</p>
<p><code class="reqn">y = U*\beta + \sigma_y*e_y, e_y</code> is N(0,1) noise vector,
</p>
<p>for binary response, 
</p>
<p><code class="reqn">y \sim rbinom(n, 1, 1/(1 + \exp(-U*\beta)))</code>,
</p>
<p>and for Poisson response,
</p>
<p><code class="reqn">y \sim rpois(n, \exp(U*\beta))</code>.
</p>
<p>See the reference for more details.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X1, X2</code></td>
<td>
<p>The two sets of covariates with dimensions  n*p1 and n*p2 respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The  response vector with length   n.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>U</code></td>
<td>
<p>The true latent factor matrix with dimension  n*rank.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>The coefficients used to generate response from <code>U</code>. The length is rank.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V1, V2</code></td>
<td>
<p>The true loading matrices for X1 and X2 with dimensions  p1*rank and p2*rank. The first <code>pnz</code> rows are nonzero.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Chongliang Luo, Kun Chen.
</p>


<h3>References</h3>

<p>Chongliang Luo, Jin Liu, Dipak D. Dey and Kun Chen (2016) Canonical variate regression. 
Biostatistics, doi: 10.1093/biostatistics/kxw001.
</p>


<h3>See Also</h3>

<p><code>CVR</code>, <code>cvrsolver</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"> set.seed(42)
 mydata &lt;- SimulateCVR(family = "g", n = 100, rank = 4, p1 = 50, p2 = 70, 
                   pnz = 10, beta = c(2, 1, 0, 0))
 X1 &lt;- mydata$X1
 X2 &lt;- mydata$X2
 Xlist &lt;- list(X1 = X1, X2 = X2); 
 Y &lt;- mydata$y
 opts &lt;- list(standardization = FALSE, maxIters = 300, tol = 0.005)
 ## use sparse CCA solution as initial values, see SparseCCA()
 Wini &lt;- SparseCCA(X1, X2, 4, 0.7, 0.7) 
 ## perform CVR with fixed eta and lambda, see cvrsolver()
 fit &lt;- cvrsolver(Y, Xlist, rank = 4, eta = 0.5, Lam = c(1, 1), 
                 family = "gaussian", Wini, penalty = "GL1", opts)
 ## check sparsity recovery
 fit$W[[1]]; 
 fit$W[[2]];
 ## check orthogonality
 X1W1 &lt;- X1 %*% fit$W[[1]]; 
 t(X1W1) %*% X1W1
</code></pre>


</div>