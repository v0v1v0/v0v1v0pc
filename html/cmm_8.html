<div class="container">

<table style="width: 100%;"><tr>
<td>DesignMatrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>DesignMatrix</h2>

<h3>Description</h3>

<p>Returns hierarchical model design matrix
</p>


<h3>Usage</h3>

<pre><code class="language-R">DesignMatrix(var, suffconfigs, dim, SubsetCoding = "Automatic", MakeSubsets=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>
<p>character or numeric vector containing variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>suffconfigs</code></td>
<td>
<p>subvector or list of subvectors of <code>var</code> indicating the sufficient configurations or highest order interactions in model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dim</code></td>
<td>
<p>numeric vector indicating the dimension of <code>var</code> (must be same length as <code>var</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SubsetCoding</code></td>
<td>
<p>allows a (character) type or a matrix to be assigned to variables for each element of <code>suffconfigs</code></p>
</td>
</tr>
</table>
<p>, see examples
</p>
<table><tr style="vertical-align: top;">
<td><code>MakeSubsets</code></td>
<td>
<p>boolean, indicates whether or not to use subsets of <code>suffconfigs</code> (used as option in <code>MarginaMatrix</code>)</p>
</td>
</tr></table>
<h3>Details</h3>

<p>The design matrix for a model <code class="reqn">\mu_{ij}=\alpha+\beta_{i}+\gamma_j</code>, 
where <code class="reqn">i</code> and <code class="reqn">j</code> each have three possible values, would be:
<code>Designmatrix(c(1,2),list(c(1),c(2)),c(3,3))</code>.
For readability, the use of characters is recommended for variable names, e.g.,
<code>Designmatrix(c("A","B"),list(c("A"),c("B")),c(3,3))</code>.
The probability vector is assumed to be a vectorized form of the probabilities in a table, 
such that the last variable changes value fastest, then the before last variable, etc. 
For example, the cells of a <code class="reqn">2 \times 3</code> table are arranged in vector form as (11,12,13,21,22,23).
To achieve this, the appropriate way to vectorize a data frame <code>dat</code> is using <code>c(t(ftable(dat)))</code>.
</p>
<p>The optional argument <code>SubsetCoding</code> is useful for e.g.\ specifying various regression models,
a linear by nominal model, grouping categories of a variable, or
omitting a category. <code>SubsetCoding</code> has default value
<code>"Automatic"</code>, which is the same as the value <code>"Nominal"</code>.
Other options are <code>"Linear"</code>, <code>"Quadratic"</code>,
<code>"Cubic"</code>, <code>"Quartic"</code>, <code>"Quintic"</code>, <code>"Identity"</code>.\
The command <code>ConstraintMatrix</code> is often more useful than <code>DesignMatrix</code> for specification of models
for use in <code>SampleStatistics</code>, <code>ModelStatistics</code> or <code>MarginalModelFit</code>.
</p>


<h3>Value</h3>

<p>matrix
</p>


<h3>Author(s)</h3>

<p>W. P. Bergsma <a href="mailto:w.p.bergsma@lse.ac.uk">w.p.bergsma@lse.ac.uk</a>
</p>


<h3>References</h3>

<p>Bergsma, W. P. (1997).
<em>Marginal models for categorical data</em>.
Tilburg, The Netherlands: Tilburg University Press.
<a href="http://stats.lse.ac.uk/bergsma/pdf/bergsma_phdthesis.pdf">http://stats.lse.ac.uk/bergsma/pdf/bergsma_phdthesis.pdf</a>
</p>
<p>Bergsma, W. P., Croon, M. A., &amp; Hagenaars, J. A. P. (2009).
Marginal models for dependent, clustered, and longitudunal categorical data.
Berlin: Springer.
</p>


<h3>See Also</h3>

<p><code>ConstraintMatrix</code>, <code>MarginalMatrix</code>, <code>DirectSum</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Design matrix for independence model
var &lt;- c("A","B")
suffconfigs &lt;- list(c("A"),c("B"))
dim &lt;- c(3, 3)
DesignMatrix(var,suffconfigs,dim)
# notation in one line
DesignMatrix(c("A","B"),list(c("A"),c("B")),c(3,3))


# Design matrix for saturated model, two short specifications giving same result
DesignMatrix(c("A","B"),c("A","B"),c(3,3))
DesignMatrix(c("A","B"),list(c("A","B")),c(3,3))


# Design matrix for univariate quadratic regression model
var &lt;- c("A")
suffconfigs &lt;- c("A")
dim &lt;- c(5)
DesignMatrix(var,suffconfigs,dim,SubsetCoding=list(c("A"),"Quadratic"))
# notation in one line
DesignMatrix(c("A"),c("A"),c(5),SubsetCoding=list(c("A"),"Quadratic"))


# Design matrix for linear by nominal model, various methods:
# simplest method which assumes equidistant centered scores:
DesignMatrix(
 var = c("A","B"),
 suffconfigs = c("A", "B"),
 dim = c(3,3),
 SubsetCoding = list(c("A","B"),list("Linear","Nominal")))
# alternative specification with same result as above:
DesignMatrix(
 var = c("A", "B"),
 suffconfigs = c("A", "B"),
 dim = c(3, 3),
 SubsetCoding = list(c("A","B"),list(rbind(c(-1,0,1)),rbind(c(1,0,0),c(0,1,0)))))
# specifying your own category scores
scores &lt;- c(1,2,5);
DesignMatrix(
 var = c("A","B"),
 suffconfigs = c("A","B"),
 dim = c(3, 3),
 SubsetCoding = list(c("A","B"), list(rbind(scores), "Nominal")))

# Design matrix for nominal by nominal model, equating parameters 
# of last two categories of second variable:
DesignMatrix(
 var = c("A", "B"),
 suffconfigs = c("A","B"),
 dim = c(3,3),
 SubsetCoding = list(c("A", "B"), list("Nominal", rbind(c(1, 0, 0), c(0, 1, 1)))))
</code></pre>


</div>