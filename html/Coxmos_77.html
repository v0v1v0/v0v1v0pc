<div class="container">

<table style="width: 100%;"><tr>
<td>sb.splsdrcox</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>SB.sPLS-DRCOX</h2>

<h3>Description</h3>

<p>This function performs a single-block sparse partial least squares deviance residual
Cox (SB.sPLS-DRCOX). The function returns a Coxmos model with the attribute model as "SB.sPLS-DRCOX".
</p>


<h3>Usage</h3>

<pre><code class="language-R">sb.splsdrcox(
  X,
  Y,
  n.comp = 4,
  penalty = 0.5,
  x.center = TRUE,
  x.scale = FALSE,
  remove_near_zero_variance = TRUE,
  remove_zero_variance = TRUE,
  toKeep.zv = NULL,
  remove_non_significant = FALSE,
  alpha = 0.05,
  MIN_EPV = 5,
  returnData = TRUE,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Numeric matrix or data.frame. Explanatory variables. Qualitative variables must be
transform into binary variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Numeric matrix or data.frame. Response variables. Object must have two columns named as
"time" and "event". For event column, accepted values are: 0/1 or FALSE/TRUE for censored and
event observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.comp</code></td>
<td>
<p>Numeric. Number of latent components to compute for the (s)PLS model (default: 10).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty</code></td>
<td>
<p>Numeric. Penalty for sPLS-DRCOX. If penalty = 0 no penalty is applied, when
penalty = 1 maximum penalty (no variables are selected) based on 'plsRcox' penalty. Equal or greater
than 1 cannot be selected (default: 0.5).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.center</code></td>
<td>
<p>Logical. If x.center = TRUE, X matrix is centered to zero means (default: TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.scale</code></td>
<td>
<p>Logical. If x.scale = TRUE, X matrix is scaled to unit variances (default: FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remove_near_zero_variance</code></td>
<td>
<p>Logical. If remove_near_zero_variance = TRUE, near zero variance
variables will be removed (default: TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remove_zero_variance</code></td>
<td>
<p>Logical. If remove_zero_variance = TRUE, zero variance variables will
be removed (default: TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>toKeep.zv</code></td>
<td>
<p>Character vector. Name of variables in X to not be deleted by (near) zero variance
filtering (default: NULL).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remove_non_significant</code></td>
<td>
<p>Logical. If remove_non_significant = TRUE, non-significant
variables/components in final cox model will be removed until all variables are significant by
forward selection (default: FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Numeric. Numerical values are regarded as significant if they fall below the
threshold (default: 0.05).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MIN_EPV</code></td>
<td>
<p>Numeric. Minimum number of Events Per Variable (EPV) you want reach for the final
cox model. Used to restrict the number of variables/components can be computed in final cox models.
If the minimum is not meet, the model cannot be computed (default: 5).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnData</code></td>
<td>
<p>Logical. Return original and normalized X and Y matrices (default: TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical. If verbose = TRUE, extra messages could be displayed (default: FALSE).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>SB.sPLS-DRCOX</code> function performs a single-block sparse partial least squares deviance residual
Cox analysis. This method is designed to handle datasets with a single block of explanatory variables
and aims to identify the most relevant features that contribute to the survival outcome. The method
combines the strengths of sparse partial least squares (sPLS) with Cox regression, allowing for
dimensionality reduction, feature selection, and survival analysis in a unified framework.
</p>
<p>The key feature of this function is the use of deviance residuals as the response in the sPLS model.
Deviance residuals are derived from a preliminary Cox model and capture the discrepancies between
the observed and expected number of events. By using these residuals as the response, the sPLS model
can focus on identifying the explanatory variables that have the most significant impact on the
survival outcome.
</p>
<p>The function offers flexibility in specifying various hyperparameters, such as the number of latent
components (<code>n.comp</code>) and the penalty for variable selection (<code>penalty</code>). The penalty parameter, <code>penalty</code>,
controls the sparsity of the model, with higher values leading to more variables being excluded from
the model. This allows for a balance between model complexity and interpretability.
</p>
<p>Data preprocessing options, such as centering and scaling of the explanatory variables and removal
of near-zero variance variables, are also provided. These preprocessing steps ensure that the data
is in a suitable format for the sPLS model and can help improve the stability and performance of
the analysis.
</p>
<p>The output of the function provides a comprehensive overview of the sPLS-DRCOX model, including the
normalized data, PLS weights and scores, and the final Cox model. Visualization tools and metrics
such as AIC and BIC are also provided to aid in understanding the model's performance and
significance of the selected features.
</p>
<p>In summary, the <code>SB.sPLS-DRCOX</code> function offers a robust approach for survival analysis with
high-dimensional data, combining feature selection, dimensionality reduction, and Cox regression
in a single-block framework. The method is particularly useful for datasets where the number of
variables exceeds the number of observations, and there's a need to identify the most relevant
features for predicting survival outcomes.
</p>


<h3>Value</h3>

<p>Instance of class "Coxmos" and model "sb.splscox". The class contains the following
elements:
<code>X</code>: List of normalized X data information.
</p>

<ul>
<li> <p><code>(data)</code>: normalized X matrix
</p>
</li>
<li> <p><code>(weightings)</code>: PLS weights
</p>
</li>
<li> <p><code>(weightings_norm)</code>: PLS normalize weights
</p>
</li>
<li> <p><code>(W.star)</code>: PLS W* vector
</p>
</li>
<li> <p><code>(scores)</code>: PLS scores/variates
</p>
</li>
<li> <p><code>(x.mean)</code>: mean values for X matrix
</p>
</li>
<li> <p><code>(x.sd)</code>: standard deviation for X matrix
</p>
</li>
</ul>
<p><code>Y</code>: List of normalized Y data information.
</p>

<ul>
<li> <p><code>(deviance_residuals)</code>: deviance residual vector used as Y matrix in the sPLS.
</p>
</li>
<li> <p><code>(dr.mean)</code>: mean values for deviance residuals Y matrix
</p>
</li>
<li> <p><code>(dr.sd)</code>: standard deviation for deviance residuals Y matrix'
</p>
</li>
<li> <p><code>(data)</code>: normalized X matrix
</p>
</li>
<li> <p><code>(y.mean)</code>: mean values for Y matrix
</p>
</li>
<li> <p><code>(y.sd)</code>: standard deviation for Y matrix'
</p>
</li>
</ul>
<p><code>survival_model</code>: List of survival model information.
</p>

<ul>
<li> <p><code>fit</code>: coxph object.
</p>
</li>
<li> <p><code>AIC</code>: AIC of cox model.
</p>
</li>
<li> <p><code>BIC</code>: BIC of cox model.
</p>
</li>
<li> <p><code>lp</code>: linear predictors for train data.
</p>
</li>
<li> <p><code>coef</code>: Coefficients for cox model.
</p>
</li>
<li> <p><code>YChapeau</code>: Y Chapeau residuals.
</p>
</li>
<li> <p><code>Yresidus</code>: Y residuals.
</p>
</li>
</ul>
<p><code>list_spls_models</code>: List of sPLS-DRCOX models computed for each block.
</p>
<p><code>n.comp</code>: Number of components selected.
</p>
<p><code>penalty</code> Penalty applied.
</p>
<p><code>call</code>: call function
</p>
<p><code>X_input</code>: X input matrix
</p>
<p><code>Y_input</code>: Y input matrix
</p>
<p><code>nzv</code>: Variables removed by remove_near_zero_variance or remove_zero_variance.
</p>
<p><code>nz_coeffvar</code>: Variables removed by coefficient variation near zero.
</p>
<p><code>class</code>: Model class.
</p>
<p><code>time</code>: time consumed for running the cox analysis.
</p>


<h3>Author(s)</h3>

<p>Pedro Salguero Garcia. Maintainer: pedsalga@upv.edu.es
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("X_multiomic")
data("Y_multiomic")
X &lt;- X_multiomic
X$mirna &lt;- X$mirna[,1:50]
X$proteomic &lt;- X$proteomic[,1:50]
Y &lt;- Y_multiomic
sb.splsdrcox(X, Y, n.comp = 2, penalty = 0.5, x.center = TRUE, x.scale = TRUE)
</code></pre>


</div>