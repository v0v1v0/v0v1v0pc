<div class="container">

<table style="width: 100%;"><tr>
<td>sel2ciuupi2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute the second definition of the scaled expected length of the Kabaila &amp;
Giri (2009) CIUUPI</h2>

<h3>Description</h3>

<p>Evaluate the second definition of the scaled expected length of the Kabaila &amp;
Giri (2009) confidence interval that utilizes uncertain prior information
(CIUUPI), with minimum coverage 1 - <code>alpha</code>, at <code>gam</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sel2ciuupi2(gam, bsvec, alpha, m, rho, natural = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>gam</code></td>
<td>
<p>A value of gamma or vector of gamma values at which the second
definition of the scaled expected length function is evaluated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bsvec</code></td>
<td>
<p>The vector (b(d/6),b(2d/6),...,b(5d/6),s(0),s(d/6),...,s(5d/6))
computed using <code>bsciuupi2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The minimum coverage probability is 1 - <code>alpha</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>Degrees of freedom <code>n - p</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>A known correlation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>natural</code></td>
<td>
<p>Equal to 1 (default) if the b and s functions are obtained by
natural cubic spline interpolation or 0 if obtained by clamped cubic spline
interpolation. This parameter must take the same value as that used in
<code>bsciuupi2</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Suppose that </p>
<p style="text-align: center;"><code class="reqn">y = X \beta + \epsilon</code>
</p>
<p> where <code class="reqn">y</code> is a random
<code class="reqn">n</code>-vector of responses, <code class="reqn">X</code> is a known <code class="reqn">n</code> by <code class="reqn">p</code> matrix with
linearly independent columns, <code class="reqn">\beta</code> is an unknown parameter
<code class="reqn">p</code>-vector and <code class="reqn">\epsilon</code> is a random <code class="reqn">n</code>-vector with components
that are independent and identically normally distributed with zero mean and
unknown variance. The parameter of interest is <code class="reqn">\theta = </code> <code>a</code>'
<code class="reqn">\beta</code>. The uncertain prior information is that <code class="reqn">\tau = </code> <code>c</code>'
<code class="reqn">\beta</code> takes the value <code>t</code>, where <code>a</code> and <code>c</code> are
specified linearly independent vectors and <code>t</code> is a specified number.
<code>rho</code> is the known correlation between the least squares estimators of
<code class="reqn">\theta</code> and <code class="reqn">\tau</code>. It is determined by the <code class="reqn">n</code> by <code class="reqn">p</code> design
matrix X and the <code class="reqn">p</code>-vectors a and c using <code>find_rho</code>.
</p>
<p>The Kabaila &amp; Giri (2009) CIUUPI is specified by the vector
(b(d/6),...,b(5d/6),s(0),...,s(5d/6)), <code>alpha</code>, <code>m</code> and
<code>natural</code>
</p>
<p>The second definition of the scaled expected length of the Kabaila and
Giri(2009) CIUUPI is the expected value of the ratio of the length of this
confidence interval divided by the length of the usual confidence interval,
with coverage probability <code>1 - alpha</code>, computed from the same data.
</p>
<p>In the examples, we continue with the same 2 x 2 factorial example described
in the documentation for <code>find_rho</code>.
</p>


<h3>Value</h3>

<p>The value(s) of the second definition of the scaled expected length of
the Kabaila &amp; Giri (2009) CIUUPI at <code>gam</code>.
</p>


<h3>References</h3>

<p>Kabaila, P. and Giri, K. (2009) Confidence intervals in regression utilizing
prior information.  Journal of Statistical Planning and Inference, 139, 3419 -
3429.
</p>


<h3>See Also</h3>

<p><code>find_rho</code>, <code>bsciuupi2</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">alpha &lt;- 0.05
m &lt;- 8

# Find the vector (b(d/6),...,b(5d/6),s(0),...,s(5d/6)) that specifies the
# Kabaila &amp; Giri (2009) CIUUPI for the second definition of the
# scaled expected length (takes about 30 mins to run):

bsvec &lt;- bsciuupi2(alpha, m, rho = -0.7071068, obj = 2)


# The result bsvec is (to 7 decimal places) the following:
bsvec &lt;- c(-0.0344224, -0.2195927, -0.3451243, -0.3235045, -0.1060439,
            1.9753281,  2.0688684,  2.3803642,  2.6434660,  2.6288564,  2.4129931)


# Graph the squared scaled expected length function
gam &lt;- seq(0, 10, by = 0.1)
sel &lt;- sel2ciuupi2(gam, bsvec, alpha, m, rho = -0.7071068)
plot(gam, sel^2, type = "l", lwd = 2, ylab = "", las = 1, xaxs = "i",
main = "Squared Scaled Expected Length", col = "blue",
xlab = expression(paste("|", gamma, "|")))
abline(h = 1, lty = 2)

</code></pre>


</div>