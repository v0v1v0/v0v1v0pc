<div class="container">

<table style="width: 100%;"><tr>
<td>d.rel.conn.finite.settlement</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate the probability distribution for the number of settlers originating 
at a site given a sample from a finite settler pool</h2>

<h3>Description</h3>

<p>These functions calculate the probability mass function 
(<code>d.rel.conn.finite.settlement</code>), the cumulative distribution function 
(<code>p.rel.conn.finite.settlement</code>) and the quantile function 
(<code>q.rel.conn.finite.settlement</code>) for the true number of settlers at a 
site that originated in a particular site given a known fraction of marked 
eggs among the eggs originating at the source site, a sample of settlers at 
the destination site, a known fraction of which are marked, and a finite 
settler pool of known size.
</p>


<h3>Usage</h3>

<pre><code class="language-R">d.rel.conn.finite.settlement(
  n.origin,
  p,
  k,
  n.obs,
  n.settlers,
  prior.n.origin = 1
)

p.rel.conn.finite.settlement(
  n.origin,
  p,
  k,
  n.obs,
  n.settlers,
  prior.n.origin = 1
)

q.rel.conn.finite.settlement(q, p, k, n.obs, n.settlers, prior.n.origin = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n.origin</code></td>
<td>
<p>Vector of integers of possible numbers of settlers in the 
cohort that originated at the site of marking. All values should be 
integers <code>&lt;=n.settlers</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Fraction of individuals (i.e., eggs) marked in the source population</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Number of marked settlers in sample</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.obs</code></td>
<td>
<p>Total number of settlers collected</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.settlers</code></td>
<td>
<p>Total number of settlers at the destination site from which
the <code>n.obs</code> (<code>&lt;=n.settlers</code>) settlers are collected</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior.n.origin</code></td>
<td>
<p>A prior probability mass function for the number of 
settlers in the cohort originating at the site of marking. Must be a scalar
or a vector of length <code>n.settlers+1</code>. Defaults to <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>Vector of quantiles</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The relative connectivity between the source and destination sites is 
calculated as <code>n.origin/n.settlers</code>.
</p>


<h3>Value</h3>

<p>A vector of probabilities or quantiles.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>d.rel.conn.finite.settlement</code>: Returns the probability mass 
function for the numbers of settlers in the cohort that originated at the
source site (i.e., site of marking).
</p>
</li>
<li> <p><code>p.rel.conn.finite.settlement</code>: Returns the cumulative distribution 
function for the numbers of settlers in the cohort that originated at the
source site (i.e., site of marking).
</p>
</li>
<li> <p><code>q.rel.conn.finite.settlement</code>: Returns quantiles of the cumulative
distribution function for the numbers of settlers in the cohort that
originated at the source site (i.e., site of marking).
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>David M. Kaplan <a href="mailto:dmkaplan2000@gmail.com">dmkaplan2000@gmail.com</a>
</p>


<h3>References</h3>

<p>Kaplan DM, Cuif M, Fauvelot C, Vigliola L, Nguyen-Huu T, Tiavouane J and Lett C 
(in press) Uncertainty in empirical estimates of marine larval connectivity. 
ICES Journal of Marine Science. doi:10.1093/icesjms/fsw182.
</p>


<h3>See Also</h3>

<p>Other connectivity estimation: 
<code>d.rel.conn.beta.prior()</code>,
<code>d.rel.conn.dists.func()</code>,
<code>d.rel.conn.multinomial.unnorm()</code>,
<code>d.rel.conn.multiple()</code>,
<code>d.rel.conn.unif.prior()</code>,
<code>dual.mark.transmission()</code>,
<code>optim.rel.conn.dists()</code>,
<code>r.marked.egg.fraction()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(ConnMatTools)

k &lt;- 10 # Number of marked settlers among sample
n.obs &lt;- 87 # Number of settlers in sample
n.settlers &lt;- 100 # Total size of settler pool

p &lt;- 0.4 # Fraction of eggs that was marked
phi &lt;- seq(0,1,length.out=101) # Values for relative connectivity

# Probability distribution assuming infinite settler pool and uniform prior
drc &lt;- d.rel.conn.unif.prior(phi,p,k,n.obs)
prc &lt;- p.rel.conn.unif.prior(phi,p,k,n.obs)
qrc &lt;- q.rel.conn.unif.prior(c(0.025,0.975),p,k,n.obs) # 95% confidence interval

# Test with finite settlement function and large (approx. infinite) settler pool
# Can be a bit slow for large settler pools
dis &lt;- d.rel.conn.finite.settlement(0:(7*n.obs),p,k,n.obs,7*n.obs)

# Quantiles
qis &lt;- q.rel.conn.finite.settlement(c(0.025,0.975),p,k,n.obs,7*n.obs)

# Finite settler pool
dfs &lt;- d.rel.conn.finite.settlement(0:n.settlers,p,k,n.obs,n.settlers)

# Quantiles for the finite settler pool
qfs &lt;- q.rel.conn.finite.settlement(c(0.025,0.975),p,k,n.obs,n.settlers)

# Make a plot of different distributions
plot(phi,drc,type="l",main="Probability of relative connectivity values",
     xlab=expression(phi),ylab="Probability density")
lines(phi,prc,col="blue")
lines((0:(7*n.obs))/(7*n.obs),dis*(7*n.obs),col="black",lty="dashed")
lines((0:n.settlers)/n.settlers,dfs*n.settlers,col="red",lty="dashed")
abline(v=qrc,col="black")
abline(v=qis/(7*n.obs),col="black",lty="dashed")
abline(v=qfs/n.settlers,col="red",lty="dashed")

</code></pre>


</div>