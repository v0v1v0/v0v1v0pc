<div class="container">

<table style="width: 100%;"><tr>
<td>fix_root_time</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fixes root.time after taxa have been pruned from a tree</h2>

<h3>Description</h3>

<p>Fixes root.time after taxa have been pruned from a tree using ape::drop.tip
</p>


<h3>Usage</h3>

<pre><code class="language-R">fix_root_time(original_tree, pruned_tree)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>original_tree</code></td>
<td>
<p>A tree in phylo format.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pruned_tree</code></td>
<td>
<p>A tree in phylo format that represents a pruned version of <code>original_tree</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>(NB: This function is designed to only cope with trees containing at least three tips.)
</p>
<p>When removing taxa from a time-scaled tree using drop.tip in ape <code>$root.time</code> is left unchanged. This can cause downstream problems if not fixed and that is what this function does.
</p>
<p>Note that <code>fix_root_time</code> in the <code>paleotree</code> package performs the same function, but is not called here to reduce the number of libraries on which <code>Claddis</code> is dependent. Interested users should also refer to the <code>dropPaleoTip</code> function in <code>paleotree</code>.
</p>


<h3>Value</h3>

<p>Returns a tree (phylo object) with a fixed <code>$root.time</code>.
</p>


<h3>Author(s)</h3>

<p>Graeme T. Lloyd <a href="mailto:graemetlloyd@gmail.com">graemetlloyd@gmail.com</a>
</p>


<h3>See Also</h3>

<p>drop_time_tip
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Create a simple four-taxon tree with branch lengths:
tree &lt;- ape::read.tree(text = "(A:1,(B:1,(C:1,D:1):1):1);")

# Set root age as 20 Ma:
tree$root.time &lt;- 20

# Now prune taxon A:
pruned_tree &lt;- ape::drop.tip(phy = tree, tip = "A")

# Show that drop.tip has not updated the tree's root time:
pruned_tree$root.time

# Use the function to fix the root time:
pruned_tree &lt;- fix_root_time(original_tree = tree, pruned_tree = pruned_tree)

# Show that the root time is now fixed (19 Ma):
pruned_tree$root.time
</code></pre>


</div>