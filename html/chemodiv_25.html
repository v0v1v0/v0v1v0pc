<div class="container">

<table style="width: 100%;"><tr>
<td>sampDis</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate sample dissimilarities</h2>

<h3>Description</h3>

<p>Function to calculate dissimilarities between samples.
Either Bray-Curtis dissimilarities and/or Generalized UniFrac
dissimilarities are calculated.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sampDis(sampleData, compDisMat = NULL, type = "BrayCurtis", alpha = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sampleData</code></td>
<td>
<p>Data frame with the relative concentration of each
compound (column) in every sample (row).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>compDisMat</code></td>
<td>
<p>Compound dissimilarity matrix, as calculated by
<code>compDis</code>. If this is supplied, Generalized UniFrac
dissimilarities can be calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Type of sample dissimilarities to be calculated. This is
Bray-Curtis dissimilarities, <code>type = "BrayCurtis"</code>, and/or
Generalized UniFrac dissimilarities, <code>type = "GenUniFrac"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Parameter used in calculations of Generalized UniFrac
dissimilarities. alpha can be set between 0 and 1.
With <code>alpha = 0</code>, equal weight is put on every
branch in the dendrogram. With <code>alpha = 1</code>, branches are
weighted by their abundance, and hence more emphasis is put on high
abundance branches. <code>alpha = 0.5</code> strikes a balance between the two.
alpha 0.5 or 1 is recommended, with <code>alpha = 1</code> as default.
See Chen et al. 2012 for details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function calculates a dissimilarity matrix for all the samples
in <code>sampleData</code>, for the given dissimilarity index/indices.
Bray-Curtis dissimilarities are calculated using only
the <code>sampleData</code>. This is the most commonly calculated dissimilarity
index used for phytochemical data (other types of dissimilarities are
easily calculated using the <code>vegdist</code> function in
the <code>vegan</code> package).
</p>
<p>If a compound dissimilarity matrix, <code>compDisMat</code>, is supplied,
Generalized UniFrac dissimilarities can be calculated, which also
use the compound dissimilarity matrix for the sample dissimilarity
calculations. For the calculation of Generalized UniFrac
dissimilarities (Chen et al. 2012), the compound dissimilarity matrix is
transformed into a dendrogram using hierarchical clustering (with the
UPGMA method). Calculations of UniFrac dissimilarities quantifies the
fraction of the total branch length of the dendrogram that leads to
compounds present in either sample, but not both. The (weighted) Generalized
UniFrac dissimilarities implemented here additionally take compound
abundances into account. In this way, both the relative proportions of
compounds and the biosynthetic/structural dissimilarities of the compounds
are accounted for in the calculations of sample dissimilarities, such that
two samples containing more biosynthetically/structurally different
compounds have a higher pairwise dissimilarity than two samples
containing more biosynthetically/structurally similar compounds.
As with Bray-Curtis dissimilarities, Generalized UniFrac dissimilarities
range in value from 0 to 1.
</p>


<h3>Value</h3>

<p>List with sample dissimilarity matrices. A list is always
outputted, even if only one matrix is calculated.
</p>


<h3>References</h3>

<p>Bray JR, Curtis JT. 1957. An Ordination of the Upland Forest Communities
of Southern Wisconsin. Ecological Monographs 27: 325-349.
</p>
<p>Chen J, Bittinger K, Charlson ES, et al. 2012. Associating microbiome
composition with environmental covariates using generalized
UniFrac distances. Bioinformatics 28: 2106-2113.
</p>
<p>Lozupone C, Knight R. 2005. UniFrac: a New Phylogenetic Method for Comparing
Microbial Communities. Applied and Environmental Microbiology 71: 8228-8235.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(minimalSampData)
data(minimalCompDis)
sampDis(minimalSampData)
sampDis(sampleData = minimalSampData, compDisMat = minimalCompDis,
type = c("BrayCurtis", "GenUniFrac"), alpha = 0.5)

data(alpinaSampData)
data(alpinaCompDis)
sampDis(sampleData = alpinaSampData, compDisMat = alpinaCompDis,
type = "GenUniFrac")
</code></pre>


</div>