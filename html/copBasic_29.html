<div class="container">

<table style="width: 100%;"><tr>
<td>derCOP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Numerical Derivative of a Copula for V with respect to U</h2>

<h3>Description</h3>

<p>Compute the numerical partial derivative of a copula, which is a <em>conditional distribution function</em>, according to Nelsen (2006, pp. 13, 40–41) with respect to <code class="reqn">u</code>:
</p>
<p style="text-align: center;"><code class="reqn">0 \le \frac{\delta}{\delta u} \mathbf{C}(u,v) \le 1\mbox{,}</code>
</p>

<p>or
</p>
<p style="text-align: center;"><code class="reqn">\mathrm{Pr}[V \le v\mid U=u] = \mathbf{C}_{2 \mid 1}(v \mid u) = \lim_{\Delta u \rightarrow 0}\frac{\mathbf{C}(u+\Delta u, v) - \mathbf{C}(u,v)}{\Delta u}\mbox{,}</code>
</p>

<p>which is to read as the probability that <code class="reqn">V \le v</code> given that <code class="reqn">U = u</code> and corresponds to the <br><code>derdir="left"</code> mode of the function. For <code>derdir="right"</code>, we have
</p>
<p style="text-align: center;"><code class="reqn">\mathrm{Pr}[V \le v\mid U=u] = \lim_{\Delta u \rightarrow 0}\frac{\mathbf{C}(u,v) - \mathbf{C}(u-\Delta u, v)}{\Delta u}\mbox{,}</code>
</p>

<p>and for <code>derdir="center"</code> (the usual method of computing a derivative), the following results
</p>
<p style="text-align: center;"><code class="reqn">\mathrm{Pr}[V \le v\mid U=u] = \lim_{\Delta u \rightarrow 0}\frac{\mathbf{C}(u+\Delta u,v) - \mathbf{C}(u-\Delta u, v)}{2 \Delta u}\mbox{.}</code>
</p>

<p>The “<em>with respect to <code class="reqn">V</code></em>” versions are available under <code>derCOP2</code>.
</p>
<p>Copula derivatives (<code class="reqn">\delta \mathbf{C}/\delta u</code> or say  <code class="reqn">\delta \mathbf{C}/\delta v</code> <code>derCOP2</code>) are non-decreasing functions meaning that if <code class="reqn">v_1 \le v_2</code>, then <code class="reqn">\mathbf{C}(u, v_2) - \mathbf{C}(u,v_1)</code> is a non-decreasing function in <code class="reqn">u</code>, thus
</p>
<p style="text-align: center;"><code class="reqn">\frac{\delta\bigl(\mathbf{C}(u, v_2) - \mathbf{C}(u,v_1)\bigr)}{\delta u}</code>
</p>

<p>is non-negative, which means
</p>
<p style="text-align: center;"><code class="reqn">\frac{\delta\mathbf{C}(u, v_2)}{\delta u} \ge \frac{\delta\mathbf{C}(u, v_1)}{\delta u}\mbox{\ for\ } v_2 \ge v_1\mbox{.}</code>
</p>



<h3>Usage</h3>

<pre><code class="language-R">derCOP(cop=NULL, u, v, delu=.Machine$double.eps^0.50,
       derdir=c("left", "right", "center"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cop</code></td>
<td>
<p>A copula function;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>Nonexceedance probability <code class="reqn">u</code> in the <code class="reqn">X</code> direction. If the length of <code>u</code> is unity, then the length of <code>v</code> can be arbitrarily long. If the length of <code>u</code> is not unity, then the length of <code>v</code> should be the same, and if not, then  only the first value in <code>v</code> is silently used;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>Nonexceedance probability <code class="reqn">v</code> in the <code class="reqn">Y</code> direction (see previous comment on <code>u</code>);</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delu</code></td>
<td>
<p>The <code class="reqn">\Delta u</code> interval for the derivative;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>derdir</code></td>
<td>
<p>The direction of the derivative as described above. Default is <code>left</code> but internally any setting can be temporarily suspended to avoid improper computations (see source code); and</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to pass such as the parameters often described in <code>para</code> arguments of other copula functions. (The lack of <code>para=NULL</code> for <code>derCOP</code> and <code>derCOP2</code> was either design oversight or design foresight but regardless it is too late to enforce package consistency in this matter.)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Value(s) for the partial derivative are returned.
</p>


<h3>Note</h3>

<p>A known caveat of the current implementation of the copula derivative is that there is a chance that the <code class="reqn">\Delta u</code> will span a singularity or discontinuous (or nearly so) portion of a copula should it have a property of singularity (or nearly so). The <code>delu</code> is chosen small so the chance is mitigated to be a small change and certainly appear to work throughout the examples herein. It is not decided whether a derivative from the positive side (<code>dir="left"</code>), when failing should switch over to a computation from the negative side (<code>dir="right"</code>). The distinction is important for the computation of the inverse of the derivative <code>derCOPinv</code> because the solution finder needs a sign reversal to work.
</p>


<h3>Author(s)</h3>

<p>W.H. Asquith</p>


<h3>References</h3>

<p>Nelsen, R.B., 2006, An introduction to copulas: New York, Springer, 269 p.
</p>


<h3>See Also</h3>

<p><code>derCOPinv</code>, <code>derCOP2</code></p>


<h3>Examples</h3>

<pre><code class="language-R">derCOP(cop=W, 0.4, 0.6); derCOP(cop=P, 0.4, 0.6); derCOP(cop=M, 0.4, 0.6)

lft &lt;- derCOP(cop=PSP,   0.4, 0.6, derdir="left"  )
rgt &lt;- derCOP(cop=PSP,   0.4, 0.6, derdir="right" )
cnt &lt;- derCOP(cop=PSP,   0.4, 0.6, derdir="center")
cat(c(lft,rgt,cnt,"\n"))
#stopifnot(all.equal(lft,rgt), all.equal(lft,cnt))

# Let us contrive a singularity through this NOT A COPULA in the function "afunc".
"afunc" &lt;- function(u,v, ...) return(ifelse(u &lt;= 0.5, sqrt(u^2+v^2), P(u,v,...)))
lft &lt;- derCOP(cop=afunc, 0.5, 0.67, derdir="left"  )
rgt &lt;- derCOP(cop=afunc, 0.5, 0.67, derdir="right" )
cnt &lt;- derCOP(cop=afunc, 0.5, 0.67, derdir="center")
cat(c(lft,rgt,cnt,"\n")) # The "right" version is correct.
</code></pre>


</div>