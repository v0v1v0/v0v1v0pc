<div class="container">

<table style="width: 100%;"><tr>
<td>fix_costmatrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fixes a costmatrix that has inconsistent costs</h2>

<h3>Description</h3>

<p>Given a costmatrix where transition costs are not self-consistent finds and returns a costmatrix that does.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fix_costmatrix(costmatrix, message = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>costmatrix</code></td>
<td>
<p>A costMatrix object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>message</code></td>
<td>
<p>A logical indicating whether messages should be output (defaults to <code>TRUE</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A user may wish to consider a complicated set of transition costs between states when modelling discrete character evolution. This can be achieved with a custom costmatrix in Claddis (and elsewhere). However, some caution is urged when using such matrices to ensure that these costs are <em>self-consistent</em> (Maddison and Maddison 2003). More specifically, no direct state-to-state transition cost should be greater than is possible with an indirect path via one or more intermediate states.
</p>
<p>This function offers a solution through an algorithm that will iteratively alter a costmatrix until all direct transition costs are self-consistent. It does so by finding the shortest state-to-state path for all possible transitions using the find_shortest_costmatrix_path function. Because the first solution may itself be inconsistent (as it relied on costs that have since updated) the algorithm is repeated until an equilibrium is reached. (This scenario is unlikely in most real world cases, but may be possible with very large matrices representing many states so was implemented here for safety.)
</p>
<p>Note: infinite costs are allowed in costmatrices but unless they fill entire rows or columns (excluding the diagonal) they will not be self-consistent as there will always be a cheaper indirect cost.
</p>
<p>Note: that both PAUP* (Swofford 2003) TNT (Goloboff et al. 2008; Goloboff and Catalano, 2016) offerthe same correction using the triangle inequality.
</p>
<p>Note: other issues with a costmatrix may arise that are better revealed by using the check_costMatrix function, which returns informative error messages (with fix suggestions) where issues are found.
</p>


<h3>Value</h3>

<p>A costMatrix object with self-consistent transition costs.
</p>


<h3>Author(s)</h3>

<p>Graeme T. Lloyd <a href="mailto:graemetlloyd@gmail.com">graemetlloyd@gmail.com</a>
</p>


<h3>References</h3>

<p>Goloboff, P. A. and Catalano, S. A., 2016. TNT version 1.5, including a full implementation of phylogenetic morphometrics. <em>Cladistics</em>, <b>32</b>, 221-238.
</p>
<p>Goloboff, P., Farris, J. and Nixon, K., 2008. TNT, a free program for phylogenetic analysis. <em>Cladistics</em>, <b>24</b>, 774-786.
</p>
<p>Maddison, D. R. and Maddison, W. P., 2003. <em>MacClade 4: Analysis of phylogeny and character evolution</em>. Version 4.06. Sinauer Associates, Sunderland, Massachusetts.
</p>
<p>Swofford, D. L., 2003. <em>PAUP*. Phylogenetic Analysis Using Parsimony (*and Other Methods). Version 4</em>. Sinauer Associates, Sunderland, Massachusetts.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Build a custom costmatrix with non-self consistent path lengths:
costmatrix &lt;- make_costmatrix(
  min_state = 0,
  max_state = 2,
  character_type = "irreversible"
)
costmatrix$costmatrix[1:9] &lt;- c(0, 2, 4, 1, 0, 3, 5, 3, 0)
costmatrix$symmetry &lt;- "Asymmetric"
costmatrix$type &lt;- "custom"

# Fix costmatrix:
fixed_costmatrix &lt;- fix_costmatrix(costmatrix = costmatrix)

# Compare transition costs:
costmatrix$costmatrix
fixed_costmatrix$costmatrix
</code></pre>


</div>