<div class="container">

<table style="width: 100%;"><tr>
<td>finemap.signals</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Finemap multiple signals in a single dataset</h2>

<h3>Description</h3>

<p>This is an analogue to finemap.abf, adapted to find multiple
signals where they exist, via conditioning or masking - ie a
stepwise procedure
</p>


<h3>Usage</h3>

<pre><code class="language-R">finemap.signals(
  D,
  LD = D$LD,
  method = c("single", "mask", "cond"),
  r2thr = 0.01,
  sigsnps = NULL,
  pthr = 1e-06,
  maxhits = 3,
  return.pp = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>list of summary stats for a single disease, see
check_dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LD</code></td>
<td>
<p>matrix of signed r values (not rsq!) giving correlation between
SNPs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>if method="cond", then use conditioning to coloc multiple
signals. The default is mask - this is less powerful, but safer because it
does not assume that the LD matrix is properly allelically aligned to
estimated effect</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r2thr</code></td>
<td>
<p>if mask==TRUE, all snps will be masked with r2 &gt; r2thr with any
sigsnps. Otherwise ignored</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigsnps</code></td>
<td>
<p>SNPs already deemed significant, to condition on or mask,
expressed as a numeric vector, whose <em>names</em> are the snp names</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pthr</code></td>
<td>
<p>when p &gt; pthr, stop successive searching</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxhits</code></td>
<td>
<p>maximum depth of conditioning. procedure will stop if p &gt;
pthr OR abs(z)&lt;zthr OR maxhits hits have been found.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.pp</code></td>
<td>
<p>if FALSE (default), just return the hits. Otherwise return vectors of PP</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mask</code></td>
<td>
<p>use masking if TRUE, otherwise conditioning. defaults to TRUE</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>list of successively significant fine mapped SNPs, named by the SNPs
</p>


<h3>Author(s)</h3>

<p>Chris Wallace
</p>


</div>