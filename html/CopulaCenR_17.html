<div class="container">

<table style="width: 100%;"><tr>
<td>ic_scmprisk_spTran_copula</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Copula regression models with semi-parametric transformation margins for semi-competing risk data under interval-censoring and left-truncation</h2>

<h3>Description</h3>

<p>Fits a copula model with semi-parametric transformation margins for semi-competing risk data under interval-censoring and left-truncation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ic_scmprisk_spTran_copula(
  data,
  var_list,
  copula = "Copula2",
  l1 = 0,
  u1,
  m1 = 3,
  r1 = 1,
  l2 = 0,
  u2,
  m2 = 3,
  r2 = 1,
  method = "BFGS",
  iter = 1000,
  stepsize = 1e-05,
  control = list(),
  eta_ini = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame; must have <code>id</code> (subject id), <code>Left</code> (0 if left-censoring for non-terminal event),
<code>Right</code> (Inf if right-censoring for non-terminal event), <code>status</code> (0 for right-censoring,
1 for interval-censoring or left-censoring of non-terminal event), <code>timeD</code> (observed terminal event),
<code>statusD</code> (for terminal event), <code>A</code> (left truncation time, 0 if none), and <code>covariates</code> by column.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var_list</code></td>
<td>
<p>the list of covariates to be fitted into the copula model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>copula</code></td>
<td>
<p>Types of copula model, only Copula2 is supported at this stage.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l1</code></td>
<td>
<p>for non-terminal event, the left bound for all <code>Left</code> and <code>Right</code> endpoints of observed finite intervals;
default is 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u1</code></td>
<td>
<p>for non-terminal event, the right bound for all <code>Left</code> and <code>Right</code> endpoints of observed finite intervals;
has to be a finite value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m1</code></td>
<td>
<p>for non-terminal event, integer, degree of Berstein polynomials for both margins; default is 3</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r1</code></td>
<td>
<p>for non-terminal event, postive transformation parameter for the semiparametric transformation marginal model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l2</code></td>
<td>
<p>for terminal event, the left bound for all <code>Left</code> and <code>Right</code> endpoints of observed finite intervals;
default is 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u2</code></td>
<td>
<p>for terminal event, the right bound for all <code>Left</code> and <code>Right</code> endpoints of observed finite intervals;
has to be a finite value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m2</code></td>
<td>
<p>for terminal event, integer, degree of Berstein polynomials for both margins; default is 3</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r2</code></td>
<td>
<p>for terminal event, postive transformation parameter for the semiparametric transformation marginal model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>optimization method (see ?optim); default is "BFGS";
also can be "Newton" (see ?nlm).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>number of iterations when method is <code>"Newton"</code>;
default is 300.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stepsize</code></td>
<td>
<p>size of optimization step when method is <code>"Newton"</code>;
default is 1e-5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list of control parameters for methods other than <code>"Newton"</code>;
see <code>?optim</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta_ini</code></td>
<td>
<p>a vector of initial values for copula parameters, default is NULL</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The input data must be a data frame. with columns <code>id</code> (sample id),
<code>Left</code> (0 if left-censoring), <code>Right</code> (Inf if right-censoring),
<code>status</code> (0 for right-censoring, 1 for interval-censoring or left-censoring),
<code>timeD</code> (for terminal event), <code>statusD</code>,<code>A</code> (0 if no left truncation),
and <code>covariates</code>. The function does not allow <code>Left</code> == <code>Right</code>. <br></p>
<p>The supported copula model in this version is <code>"Copula2"</code>.
The <code>"Copula2"</code> model is a two-parameter copula model that incorporates <code>Clayton</code>
and <code>Gumbel</code> as special cases.
The parametric generator functions of copula functions are list below:
</p>
<p>The Two-parameter copula (Copula2) has a generator </p>
<p style="text-align: center;"><code class="reqn">\phi_{\eta}(t) = \{1/(1+t^{\alpha})\}^{\kappa},</code>
</p>

<p>with <code class="reqn">\alpha \in (0,1], \kappa &gt; 0</code> and Kendall's <code class="reqn">\tau = 1-2\alpha\kappa/(2\kappa+1)</code>. <br></p>
<p>The marginal semiparametric transformation models are built based on Bernstein polynomials, which is formulated below:
</p>
<p style="text-align: center;"><code class="reqn">S(t|Z) = \exp[-G\{\Lambda(t) e^{Z^{\top}\beta}\}],</code>
</p>
<p> where <code class="reqn">t</code> is time, <code class="reqn">Z</code> is covariate,
<code class="reqn">\beta</code> is coefficient and <code class="reqn">\Lambda(t)</code> is an unspecified function with infinite dimensions.
We approximate <code class="reqn">\Lambda(t)</code> in a sieve space constructed by Bernstein polynomials with degree <code class="reqn">m</code>. By default, <code class="reqn">m=3</code>.
In the end, all model parameters are estimated by the sieve estimators (Sun and Ding, In Press).
</p>
<p>The <code class="reqn">G(\cdot)</code> function is the transformation function with a parameter <code class="reqn">r &gt; 0</code>, which has a form of
<code class="reqn">G(x) = \frac{(1+x)^r - 1}{r}</code>, when <code class="reqn">0 &lt; r \leq 2</code> and <code class="reqn">G(x) = \frac{\log\{1 + (r-2)x\}}{r - 2}</code> when <code class="reqn">r &gt; 2</code>.
When <code class="reqn">r = 1</code>, the marginal model becomes a proportional hazards model;
when <code class="reqn">r = 3</code>, the marginal model becomes a proportional odds model.
In practice, <code>m</code> and <code>r</code> can be selected based on the AIC value. <br></p>
<p>Optimization methods can be all methods (except <code>"Brent"</code>) from <code>optim</code>, such as
<code>"Nelder-Mead"</code>, <code>"BFGS"</code>, <code>"CG"</code>, <code>"L-BFGS-B"</code>, <code>"SANN"</code>.
Users can also use <code>"Newton"</code> (from <code>nlm</code>).
</p>


<h3>Value</h3>

<p>a <code>CopulaCenR</code> object summarizing the model.
Can be used as an input to general <code>S3</code> methods including
<code>summary</code>, <code>print</code>, <code>coef</code>,
<code>logLik</code>, <code>AIC</code>, <code>BIC</code>.
</p>


<h3>Source</h3>

<p>Tao Sun, Yunlong Li, Zhengyan Xiao, Ying Ding, Xiaojun Wang (2022).
Semiparametric copula method for semi-competing risks data
subject to interval censoring and left truncation:
Application to disability in elderly. Statistical Methods in Medical Research (Accepted).
</p>


<h3>Examples</h3>

<pre><code class="language-R"># fit a Copula2-Semiparametric model
data("data_scmprisk")
copula2_sp &lt;- ic_scmprisk_spTran_copula(data = data_scmprisk,
              var_list = c("x1"), copula = "Copula2",
              l1=0, u1 = 21, m1 = 3, r1 = 1,
              l2=0, u2 = 21, m2 = 3, r2 = 1,
              )
summary(copula2_sp)
</code></pre>


</div>