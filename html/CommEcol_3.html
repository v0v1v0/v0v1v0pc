<div class="container">

<table style="width: 100%;"><tr>
<td>betaRegDisp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Beta diversity metrics between sites in a moving window along environmental gradients</h2>

<h3>Description</h3>

<p>The function computes eight metrics of beta diversity according to an informed environmental gradient. It selects a given number of environmentally-neighborhood sites in a moving window to obtain beta diversity.</p>


<h3>Usage</h3>

<pre><code class="language-R">betaRegDisp(y, x, xy.coords = NULL, ws = 3, 
            method.1 = "jaccard", method.2 = "ruzicka", 
            method.3 = "ruzicka", 
            independent.data = FALSE, illust.plot = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y </code></td>
<td>
<p>Response matrix, where rows are sites and columns are species.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x </code></td>
<td>
<p>Predictor vector. A vector of the environmental gradient under study with the same number of sites as in matrix <code>y</code>. Make sure the order of samples in <code>y</code> and <code>x</code> is the same.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xy.coords </code></td>
<td>
<p>Geographical coordinates. A matrix with two columns of XY decimal degree geographical coordinates, which are used to compute euclidean distance among sites. Rows must be sites in the same order as in <code>y</code> and <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ws </code></td>
<td>
<p>Window size or number of sites to be used in the computation of the distinct beta-diversity metrics or between-site dissimilarities.  It must be a positive integer higher than 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method.1 </code></td>
<td>
<p>For beta-diversity metrics 1 to 3 (see details). A dissimilarity index available in the <code>vegdist</code>. The options are: "euclidean", "jaccard", "bray", "manhattan", "canberra", "kulczynski", "gower", "morisita", "horn", "mountford",  "raup", "binomial", "chao", "altGower", "cao", "mahalanobis".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method.2 </code></td>
<td>
<p>For beta-diversity metrics 4 and 5 (see details). A dissimilarity index available in the <code>beta.div</code>. The options are: "hellinger", "chord", "log.chord", "chisquare", "profiles", "percentdiff", "ruzicka", "divergence", "canberra", "whittaker", "wishart", "kulczynski", "jaccard", "sorensen", "ochiai", "ab.jaccard", "ab.sorensen", "ab.ochiai", "ab.simpson", "euclidean".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method.3 </code></td>
<td>
<p>For beta-diversity metrics 6, 7, and 8 (see details). A multisample dissimilarity index available in the <code>beta.multi.abund</code>. The options are: "ruzicka" and "bray".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>independent.data </code></td>
<td>
<p>Should windows not superpose each other? If <code>independent.data=TRUE</code>, sites do not enter more than once in the dissimilarity calculations, that is, sites are included in a single window.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>illust.plot </code></td>
<td>
<p>Should a window plot be open and illustrate how the window moves along the gradient?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function computes eight beta-diversity metrics among sites included in a set (window) of length <code>ws</code>. See details in Dala-Corte et al. (2019).
</p>
<p>Metrics 1-3 uses dissimilarity indices available in <code>vegdist</code>:
</p>
<p>1. Mean pair-wise dissimilarity between sites in a window;
</p>
<p>2. Mean dissimilarity between focal site and the other sites in a window. If an odd number is informed in <code>ws</code>, the focal site is the central site in relation to its neighbours in the window. If an even number is informed in <code>ws</code>, the focal site is the first site in the window;
</p>
<p>3. Mean distance of sites to their group centroid in a Principal Coordinate (PCoA) space computed using <code>betadisper</code>;
</p>
<p>Metrics 4-5 uses dissimilarity indices available in <code>beta.div</code>:
</p>
<p>4. Total sum of squares (SS) of the window sites (Legendre and De Caceres, 2013);
</p>
<p>5. Local contributions to beta diversity (LCBD; Legendre and De Caceres, 2013);
</p>
<p>Metrics 6-8 uses dissimilarity indices available in <code>beta.multi.abund</code>:
</p>
<p>6. Total multiple-site dissimilarities for a selected window of sites;
</p>
<p>7. Nestedness component of multiple-site dissimilarities for a selected window of sites;
</p>
<p>8. Turnover component of multiple-site dissimilarities for a selected window of sites. 
</p>


<h3>Value</h3>

<p>A matrix with 10 columns (or 12 if <code>xy.coords</code> is informed). Values in columns are sorted according to the enviromental gradient, from the lowest to the highest value. Columns correspond to:
</p>
<p>1. <code>grad</code> - The environmental gradient (predictor vector, <code>x</code>);
</p>
<p>2. <code>mean.grad</code> - Mean value of the environmental gradient of sites selected in each window;
</p>
<p>3. <code>mean.diss.pairs</code> - Mean pair-wise dissimilarity between sites in a selected window (metric 1);
</p>
<p>4. <code>diss.focal</code> - Mean dissimilarity between focal site and the other sites (metric 2);
</p>
<p>5. <code>mean.dist.cent </code> - Mean distance of sites to their group centroid in a Principal Coordinate (PCoA) space (metric 3);
</p>
<p>6. <code>SS.group</code> - Total sum of squares (SS) of the sites in a window (metric 4); 
</p>
<p>7. <code>SS.focal</code> - Local contributions to beta diversity (LCBD), which represents how much a focal site contributed to the total window SS;
</p>
<p>8. <code>beta.TOT</code> - Total multiple-site dissimilarity;
</p>
<p>9. <code>beta.NES</code> - Nestedness component of multiple-site dissimilarity;
</p>
<p>10. <code>beta.TUR</code> - Turnover component of multiple-site dissimilarity;
</p>
<p>11. <code>mean.geodist</code> - If <code>xy.coords</code> is provided, the mean linear euclidean distance between sites in the a window is returned.
</p>
<p>12. <code>focal.geodist</code> - If <code>xy.coords</code> is provided, the mean linear euclidean distance of the focal site in relation to its neighbours in the window is returned. 
</p>


<h3>Author(s)</h3>

<p>Luciano F. Sgarbi, Renato B. Dala-Corte and Adriano S. Melo</p>


<h3>References</h3>

<p>Anderson, M.J., K.E. Ellingsen and B.H. McArdle. 2006. Multivariate dispersion as a measure of beta diversity. Ecology Letters 9: 683-693.
</p>
<p>Baselga, A. 2010. Partitioning the turnover and nestedness components of beta diversity. Global Ecology and Biogeography 19: 134-143.
</p>
<p>Baselga, A. 2017. Partitioning abundance-based multiple-site dissimilarity into components: balanced variation in abundance and abundance gradients. Methods in Ecology and Evolution 8: 799-808.
</p>
<p>Dala-Corte, R.B., L.F. Sgarbi, F.G. Becker and A.S. Melo. 2019. Beta diversity of stream fish communities along anthropogenic environmental gradients at multiple spatial scales. Environmental Monitoring and Assessment 191:288.
</p>
<p>Legendre, P. and M. De Caceres. 2013. Beta diversity as the variance of community data: dissimilarity coefficients and partitioning. Ecology Letters 16: 951-963.
</p>


<h3>See Also</h3>

<p><code>vegdist</code>, <code>betadisper</code>, <code>beta.div</code>, <code>beta.multi</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## Example 1. A simmulated community matrix with a known structure of increasing
##  beta diversity by turnover
# n is the total sample sites
# LocS is the number of spp per site
# MaxS is the total number of spp in the matrix

# All samples will contain LocS species. The first sample will contain presences
# for the first LocS species. The subsequent samples will contain LocS presences
# spread over a increasing set of species. The assignment of presences for the
# second sample to the last sample is done randomly. The last sample will
# contain LocS presences assigned randomly to the MaxS species. Thus, for a 
# window size of 3 (ws=3) and a dataset of 10 samples, beta diversity for the
# samples 1-3 will be much lower than for samples 8-10.   

SimComm &lt;- function(n = 19, MaxS = 24, LocS = 8){
    s &lt;- seq (LocS, MaxS, length.out = n)
    mat &lt;- matrix(0, n, MaxS, dimnames = 
                      list(paste("site", 1:n, sep = "_"), 
                           paste("sp", 1:MaxS, sep = "_")))
    for(i in 1:n){
        mat[i, sample(1:s[i], LocS)] &lt;- 1
    }
    mat &lt;- mat[, colSums(mat)!=0]
    return(mat)
}

mat &lt;- SimComm(n = 19, MaxS = 24, LocS = 8)

#Creating an environmental gradient:
grad &lt;- 1:nrow(mat)

b.resu &lt;- betaRegDisp(y = mat, x = grad, xy.coord = NULL, ws = 3, 
                      method.1 = "jaccard", 
                      method.2 = "ruzicka",
                      method.3 = "ruzicka", 
                      independent.data = FALSE, illust.plot = FALSE)

##Ploting all the output of the object for the simmulated community
op &lt;- par(no.readonly = TRUE)
par(mfrow = c(5, 2), oma = c(1, 0, 1, 0.1), mar = c(1.5, 3, .1, .1), cex = 1, las = 0)
for(i in 1:ncol(b.resu)){
  plot(b.resu[, 1], b.resu[, i], ylab = colnames(b.resu)[i], cex.lab = .9, 
       cex.axis = 0.9, tcl = -0.2, mgp = c(1.5, .2, 0), pch = 15, col = "grey")
}
mtext("Environmental gradient", cex = 1.3, 1, -0.1, outer = TRUE)
par(op)



##Example 2
data(varespec)
data(varechem)
grad &lt;- varechem[, "Baresoil"]
resu &lt;- betaRegDisp(y = varespec, x = grad, ws = 3, method.1 = "jaccard", 
            method.2 = "ruzicka", method.3 = "ruzicka", 
            independent.data = FALSE, illust.plot = FALSE)

#Plotting all the outputs of the function:
op &lt;- par(no.readonly = TRUE)
par(mfrow = c(5, 2), oma = c(1, 0, 1, 0.1), mar = c(1.5, 3, .1, .1), cex = 1, las = 0)
for(i in 1:ncol(resu)){
  plot(resu[, 1], resu[, i], ylab = colnames(resu)[i], cex.lab = .9, 
       cex.axis = 0.9, tcl = -0.2, mgp = c(1.5, .2, 0), pch = 15, col = "grey")
}
mtext("Environmental gradient", cex = 1.3, 1, 0, outer = TRUE)
par(op)

</code></pre>


</div>