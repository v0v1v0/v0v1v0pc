<div class="container">

<table style="width: 100%;"><tr>
<td>mixCopula</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create Mixture of Copulas</h2>

<h3>Description</h3>

<p>A mixture of <code class="reqn">m</code> copulas of dimension <code class="reqn">d</code> with weights
<code class="reqn">w_j</code>, <code class="reqn">j=1,2,\ldots,m</code> is itself a <code class="reqn">d</code>-dimensional copula,
with cumulative distribution function
</p>
<p style="text-align: center;"><code class="reqn">C(x) = \sum_{j=1}^m w_j C_j(x),</code>
</p>

<p>and (probability) density function
</p>
<p style="text-align: center;"><code class="reqn">c(x) = \sum_{j=1}^m w_j c_j(x),</code>
</p>

<p>where <code class="reqn">C_j</code> are the CDFs and <code class="reqn">c_j</code> are the
densities of the <code class="reqn">m</code> component copulas,
<code class="reqn">j=1,2,\ldots,m</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mixCopula(coplist, w = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>coplist</code></td>
<td>
<p>a <code>list</code> of length <code class="reqn">m (\ge 1)</code> copulas (each inheriting from <code>parCopula</code>), all
of the same dimension.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>numeric vector of length <code class="reqn">m</code> of non-negative mixture
weights, or <code>NULL</code>, which means equal weights.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>It easy to see that the tail dependencies <code>lambda()</code> and
Spearman's rank correlation <code>rho()</code> can be computed as
mixture of the individual measures.
</p>


<h3>Value</h3>

<p>an object of <code>class</code> <code>mixCopula</code>
</p>


<h3>See Also</h3>

<p><code>khoudrajiCopula</code>, <code>rotCopula</code> also create new
copula models from existing ones.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
mC &lt;- mixCopula(list(gumbelCopula(2.5, dim=3),
                     claytonCopula(pi, dim=3),
                     tCopula(0.7, dim=3)),
                c(2,2,4)/8)
mC
stopifnot(dim(mC) == 3)

set.seed(17)
uM &lt;- rCopula(600, mC)
splom2(uM, main = "mixCopula( (gumbel, clayton, t-Cop) )")
d.uM &lt;- dCopula(uM, mC)
p.uM &lt;- pCopula(uM, mC)

## mix a Gumbel with a rotated Gumbel (with equal weights 1/2):
mGG &lt;- mixCopula(list(gumbelCopula(2), rotCopula(gumbelCopula(1.5))))
rho(mGG)   # 0.57886
lambda(mGG)# both lower and upper tail dependency

loglikCopula(c(2.5, pi, rho.1=0.7, df = 4, w = c(2,2,4)/8),
                    u = uM, copula = mC)
## define (profiled) log-likelihood function of two arguments (df, rho) :
ll.df &lt;- Vectorize(function(df, rho)
                   loglikCopula(c(2.5, pi, rho.1=rho, df=df, w = c(2,2,4)/8),
                                uM, mC))
(df. &lt;- 1/rev(seq(1/8, 1/2, length=21)))# in [2, 8] equidistant in 1/. scale

ll. &lt;- ll.df(df., rho = (rh1 &lt;- 0.7))
plot(df., ll., type = "b", main = "loglikCopula((.,.,rho = 0.7, df, ..), u, &lt;mixCopula&gt;)")

if(!exists("Xtras")) Xtras &lt;- copula:::doExtras() ; cat("Xtras: ", Xtras,"\n")
if (Xtras) withAutoprint({
  Rhos &lt;- seq(0.55, 0.70, by = 0.01)
  ll.m &lt;- matrix(NA, nrow=length(df.), ncol=length(Rhos))
  for(k in seq_along(Rhos)) ll.m[,k] &lt;- ll.df(df., rho = Rhos[k])
  tit &lt;- "loglikelihood(&lt;tCop&gt;, true param. for rest)"
  persp         (df., Rhos, ll.m, phi=30, theta = 50, ticktype="detailed", main = tit)
  filled.contour(df., Rhos, ll.m, xlab="df", ylab = "rho", main = tit)
})

## fitCopula() example -----------------------------------------------------

## 1) with "fixed" weights :

(mNt &lt;- mixCopula(list(normalCopula(0.95), tCopula(-0.7)), w = c(1, 2) / 3))
set.seed(1452) ; U &lt;- pobs(rCopula(1000, mNt))
(m1 &lt;- mixCopula(list(normalCopula(), tCopula()), w = mNt@w))

getTheta(m1, freeOnly = TRUE, attr = TRUE)
getTheta(m1, named=TRUE)
isFree(m1) # all of them; --&gt; now fix the weights :
fixedParam(m1) &lt;- fx &lt;- c(FALSE, FALSE, FALSE, TRUE, TRUE)
stopifnot(identical(isFree(m1), !fx))

if(Xtras) withAutoprint({ ## time
  system.time( # ~ 16 sec (nb-mm4) :
    fit &lt;- fitCopula(m1, start = c(0, 0, 10), data = U)
  )
  fit
  summary(fit) #-&gt; incl  'Std.Error' (which seems small for rho1 !)
})

## 2) with "free" weights (possible since copula 1.0-0):

(mNt2 &lt;- mixCopula(list(normalCopula(0.9), tCopula(-0.8)), w = c(1, 3) / 4))
set.seed(1959) ; U2 &lt;- pobs(rCopula(2000, mNt2))
if(Xtras) withAutoprint({ ## time
  m2 &lt;- mixCopula(list(normalCopula(), tCopula()), w = mNt@w)
  system.time( # ~ 13.5 sec (lynne) :
    f2 &lt;- fitCopula(m2, start = c(0, 0, 10, c(1/2, 1/2)), data = U2)
  )
  f2
  summary(f2) # NA for 'Std. Error' as did *not* estimate.variance
  summary(f2, orig=FALSE) # default 'orig=TRUE': w-scale;  whereas
     coef(f2, orig=FALSE) # 'orig=FALSE' =&gt; shows 'l-scale' instead
})


</code></pre>


</div>