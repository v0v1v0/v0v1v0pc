<div class="container">

<table style="width: 100%;"><tr>
<td>rnorm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Normal distributions on special spaces</h2>

<h3>Description</h3>

<p><code>rnorm.</code><var>X</var> generates multivariate normal random variates in
the space <var>X</var>. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">rnorm.acomp(n,mean,var)
rnorm.rcomp(n,mean,var)
rnorm.aplus(n,mean,var)
rnorm.rplus(n,mean,var)
rnorm.rmult(n,mean,var)
rnorm.ccomp(n,mean,var,lambda)
dnorm.acomp(x,mean,var,withJacobian=FALSE)
dnorm.aplus(x,mean,var,withJacobian=FALSE)
dnorm.rmult(x,mean,var)
          </code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of datasets to be simulated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p>The mean of the dataset to be simulated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>
<p>The variance covariance matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>The expected total count</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>vectors in the sampling space</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>withJacobian</code></td>
<td>
<p>should the jacobian of the log or logratio transformation be included in
the density calculations? defaults to FALSE (see details)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The normal distributions in the various spaces dramatically
differ. The normal distribution in the <code>rmult</code> space is the
commonly known multivariate joint normal distribution. For
<code>rplus</code> this distribution has to be somehow truncated at 0. This
is here done by setting negative values to 0, i.e. this simulation function
produces a sort of multivariate tobit model.
<br>
The normal distribution
of <code>rcomp</code> is seen as a normal distribution within the simplex as
a geometrical portion of the real vector space. The variance is thus
forced to be singular and restricted to the affine subspace generated
by the simplex. The necessary truncation of negative values is
currently done by setting them explicitly to zero and reclosing
afterwards, again in the fashion of a tobit model. 
<br>
The <code>"acomp"</code> and <code>"aplus"</code> are themselves metric vector spaces and
thus a normal distribution is defined in them just as in the real
space. The resulting distribution almost correspond to multivariate
lognormal in the case of <code>"aplus"</code> and Aitchison normal
distribution in the simplex in the case of <code>"acomp"</code>. These models
are equivalent in probability to the multivariate lognormal distribution
and the addditive logistic normal distribution respectively, albeit without
including the jacobian of the log or the logratio transformation. If you are 
interested in the density of the additive logistic normal model, give the extra
argument <code>withJacobian=TRUE</code>. If you are interested in the multivariate 
lognormal density cou can either do the same, or better call <code>dlnorm.rplus</code>.
<br>
Densities are only provided for the models constructed for <code>rmult</code>, 
<code>aplus</code> and <code>acomp</code> because they do exist w
with repect to the Lebesgue measure of each of these spaces. 
In the other cases it is not possible to compute a measure, since the truncation
at zero values produce 
distributions that are not absolutely continuous with respect to the real, conventional 
Lebesgue measure. 
<br>
For count compositions <code>ccomp</code> a rnorm.acomp is realized and used
as a parameter to a Poisson distribution (see <code>rpois.ccomp</code>). So, this is 
in reality no normal model, but a double stochastic counting process.
</p>


<h3>Value</h3>

<p>a random dataset of the given class generated by a normal distribution
with the given mean and
variance in the given space. For the density functions <code>d*</code>, the value of the 
probability density at the values of <code>x</code> provided</p>


<h3>Author(s)</h3>

<p>K.Gerald v.d. Boogaart <a href="http://www.stat.boogaart.de">http://www.stat.boogaart.de</a></p>


<h3>References</h3>

<p>Aitchison, J. (1986) <em>The Statistical Analysis of Compositional
Data</em> Monographs on Statistics and Applied Probability. Chapman &amp;
Hall Ltd., London (UK). 416p.<br></p>
<p>Pawlowsky-Glahn, V. and J.J. Egozcue (2001) Geometric approach to
statistical analysis on the simplex. <em>SERRA</em> <b>15</b>(5), 384-398<br></p>
<p>Aitchison, J, C. Barcel'o-Vidal, J.J. Egozcue, V. Pawlowsky-Glahn
(2002) A consise guide to the algebraic geometric structure of the
simplex, the sample space for compositional data analysis, <em>Terra
Nostra</em>, Schriften der Alfred Wegener-Stiftung, 03/2003<br></p>


<h3>See Also</h3>

<p><code>runif.acomp</code>, <code>rlnorm.rplus</code>,
<code>rDirichlet.acomp</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">MyVar &lt;- matrix(c(
0.2,0.1,0.0,
0.1,0.2,0.0,
0.0,0.0,0.2),byrow=TRUE,nrow=3)
MyMean &lt;- c(1,1,2)

plot(rnorm.acomp(100,MyMean,MyVar))
plot(rnorm.rcomp(100,MyMean,MyVar))
plot(rnorm.aplus(100,MyMean,MyVar))
plot(rnorm.rplus(100,MyMean,MyVar))
plot(rnorm.rmult(100,MyMean,MyVar))
x &lt;- rnorm.aplus(5,MyMean,MyVar)
dnorm.acomp(x,MyMean,MyVar)
dnorm.aplus(x,MyMean,MyVar)
dnorm.rmult(x,MyMean,MyVar)
</code></pre>


</div>