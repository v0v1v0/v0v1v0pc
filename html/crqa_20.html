<div class="container">

<table style="width: 100%;"><tr>
<td>windowdrp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Windowed Recurrence Profile</h2>

<h3>Description</h3>

<p>A recurrence plot is computed in overlapping
windows of a specified size for a number of
delays smaller than the size of the window.
In every window, the recurrence value for the
different delays is calculated.
A mean is then taken across the delays to obtain
a recurrence value in that particular window.
</p>


<h3>Usage</h3>

<pre><code class="language-R">windowdrp(ts1, ts2, windowstep, windowsize, lagwidth,
radius, delay, embed, rescale, normalize, mindiagline, minvertline,
tw, whiteline, recpt, side, method, metric, datatype)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ts1</code></td>
<td>
<p>First time-series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ts2</code></td>
<td>
<p>Second time-series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>windowstep</code></td>
<td>
<p>Interval by which the window is
moved.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>windowsize</code></td>
<td>
<p>The size of the window</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lagwidth</code></td>
<td>
<p>The number of delays to be
considered within the window</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>radius</code></td>
<td>
<p>For numeric time-series, the
cutoff distance to accept or reject
two-points as recurrent</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delay</code></td>
<td>
<p>The delay unit by which the series are lagged.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>embed</code></td>
<td>
<p>The number of embedding dimension for
phase-reconstruction, i.e., the lag intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rescale</code></td>
<td>
<p>Rescale the distance matrix;
if rescale = 0 (do nothing);
if rescale = 1 (mean distance of entire matrix);
if rescale = 2 (maximum distance of entire matrix).
if rescale = 3 (minimum distance of entire matrix).
if rescale = 4 (euclidean distance of entire matrix).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalize</code></td>
<td>
<p>Normalize the time-series;
if normalize = 0 (do nothing);
if normalize = 1 (Unit interval);
if normalize =  2 (z-score).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mindiagline</code></td>
<td>
<p>A minimum diagonal length of
recurrent points. Usually set to 2, as it takes
a minimum of two points to define any line.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minvertline</code></td>
<td>
<p>A minimum vertical length of
recurrent points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tw</code></td>
<td>
<p>The Theiler window parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>whiteline</code></td>
<td>
<p>A logical flag to calculate (TRUE)
or not (FALSE) empty vertical lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>recpt</code></td>
<td>
<p>A logical flag indicating whether
measures of cross-recurrence are calculated directly
from a recurrent plot (TRUE) or not (FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>side</code></td>
<td>
<p>A string indicating whether recurrence measures
should be calculated in the 'upper' triangle of the RP
'lower' triangle of the matrix, or 'both'.
LOC is automatically excluded for 'upper' and 'lower'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A string to indicate the type of recurrence
analysis to peform. There are three options:
rqa (autorecurrence); crqa(cross-recurrence); 
mdcrqa(multidimensional recurrence). Default value is crqa</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metric</code></td>
<td>
<p>A string to indicate the type of 
distance metric used, default is euclidean but 
see help rdist() to list all other possible metrics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>datatype</code></td>
<td>
<p>a string (continuous or categorical) 
to indicate whether the nature of the data type</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>It returns a list of arguments where:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>profile</code></td>
<td>
<p>Time-course windowed recurrence profile</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxrec</code></td>
<td>
<p>Maximal recurrence observed along the time-course</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxlag</code></td>
<td>
<p>The point where maximal recurrence is observed</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Moreno I. Coco (moreno.cocoi@gmail.com)
and Rick Dale (rdale@ucmerced.edu)</p>


<h3>References</h3>

<p>Boker, S. M., Rotondo, J. L., Xu, M., and King, K. (2002).
Windowed cross-correlation and peak picking
for the analysis of variability in the
association between behavioral time series.
Psychological Methods, 7(3), 338.
</p>


<h3>See Also</h3>

<p><code>drpfromts</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
# use the available data
data(crqa) 

listener = eyemovement$listener
narrator = eyemovement$narrator

# NB, the parameters for windowsize and windowstep are large to allow
# faster running time, please set them carefully in your analysis. 

delay = 1; embed = 1; rescale = 1; radius = 0.001;
normalize = 0; mindiagline = 2; minvertline = 2;
tw = 0; whiteline = FALSE; recpt = FALSE; side = "both"
method = 'crqa'; metric = 'euclidean';  
datatype = "continuous"; windowsize =  100; 
lagwidth = 10; windowstep = 200

ans = windowdrp(narrator, listener, windowstep, windowsize, lagwidth, 
                radius, delay, embed, rescale, normalize, 
                mindiagline, minvertline, tw, 
                whiteline, recpt, side, method, metric, 
                datatype)


profile = ans$profile; maxrec = ans$maxrec; maxlag = ans$maxlag

plot(profile, type = 'l')

</code></pre>


</div>