<div class="container">

<table style="width: 100%;"><tr>
<td>opt.fpcac</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Optimal cluster selection in Functional Principal Components Analysis Clustering
</h2>

<h3>Description</h3>

<p>This function provides the optimal selection of clusters for  the algorithm FPCAC,  as a variant of a k-means algorithm based on the principal component rotation of data
</p>


<h3>Usage</h3>

<pre><code class="language-R">opt.fpcac(X, k.max = 5, method = c("silhouette", "wss"),
          fd = NULL, nbasis = 5, norder = 3, nharmonics = 3,
          alpha = 0, niter = 30, Ksteps = 10, seed,
          diss = NULL, trace=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Matrix of ‘curves’ of dimension <kbd>n</kbd> x <kbd>q</kbd>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k.max</code></td>
<td>
<p>the number of cluster used in the optimization step to select the optimal one.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the method used to select the optimal number of clusters, "silhouette" or "wss" (whithin sum of squares.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fd</code></td>
<td>
<p>If not NULL it overrides X and must be an object of class fd.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbasis</code></td>
<td>
<p>an integer variable specifying the number of basis functions. The default value is 5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>norder</code></td>
<td>
<p>an integer specifying the order of b-splines, which is one higher than their degree. The default value is 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nharmonics</code></td>
<td>
<p>the number of harmonics or principal components to use. The default value is 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>trimming size, that is  the given proportion of observations to be
discarded.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niter</code></td>
<td>
<p>the number or random restarting (larger values provide more accurate solutions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ksteps</code></td>
<td>
<p>the number of k-mean steps (not too many ksteps are needed).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>the seed used for reproducibility.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diss</code></td>
<td>
<p>the dissimilarity matrix used to compute measures "silhouette" or "wss".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>if TRUE, it is used to print some information across the algorithm.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Silhouette is a method for validate the consistency within clusters, providing a measure  of how similar an object is to its own cluster  compared to other clusters.
The silhouette score S belongs to the interval [-1,1].
S close to one means that the data is appropriately clustered. If S is close to negative one, datum should be clustered in its neighbouring cluster. S near zero means that the datum is on the border of two natural clusters.
</p>
<p>The wss is obtained as the classical sum of the squared deviations from each observation and the cluster centroid, providing  a measure of the variability of the observations within each cluster. Clusters with higher values exhibit greater variability of the observations within the cluster.
</p>


<h3>Value</h3>

<p>a list containing the following items:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>obj.function</code></td>
<td>
<p>the sequence of objective functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clusters</code></td>
<td>
<p>the matrix in which each columns identify clusters for each fixed K.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>the sequence of K used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K.opt</code></td>
<td>
<p>the optimal number of clusters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>a ggplot object to plot the curve of silhouette or whithin sum of squares.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Gianluca Sottile <a href="mailto:gianluca.sottile@unipa.it">gianluca.sottile@unipa.it</a>
</p>


<h3>References</h3>

<p> Peter J. Rousseeuw (1987). Silhouettes: a Graphical Aid to the Interpretation and Validation of Cluster Analysis. Computational and Applied Mathematics. 20, 53-65
</p>
<p>K. V. Mardia, J. T. Kent and J. M. Bibby (1979). Multivariate Analysis. Academic Press.
</p>


<h3>See Also</h3>

<p><code>fpcac</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
set.seed(1234)
n &lt;- 300
x &lt;- 1:n/n

Y &lt;- matrix(0, n, 30)

sigma2 &lt;- 4*pmax(x-.2, 0) - 8*pmax(x-.5, 0) + 4*pmax(x-.8, 0)

mu &lt;- sin(3*pi*x)
for(i in 1:10) Y[, i] &lt;- mu + rnorm(length(x), 0, pmax(sigma2, 0))

mu &lt;- cos(3*pi*x)
for(i in 11:23) Y[,i] &lt;- mu + rnorm(length(x), 0, pmax(sigma2,0))

mu &lt;- sin(3*pi*x)*cos(pi*x)
for(i in 24:28) Y[, i] &lt;- mu + rnorm(length(x), 0, pmax(sigma2, 0))

mu &lt;- 0 #sin(1/3*pi*x)*cos(2*pi*x)
for(i in 29:30) Y[, i] &lt;- mu + rnorm(length(x), 0, pmax(sigma2, 0))

num.clust &lt;- opt.fpcac(Y)
obj2 &lt;- fpcac(Y, K = num.clust$K.opt, disp = FALSE)
obj2

</code></pre>


</div>