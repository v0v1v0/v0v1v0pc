<div class="container">

<table style="width: 100%;"><tr>
<td>CFA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Configural Frequencies Analysis Main Function</h2>

<h3>Description</h3>

<p>Calculates various coefficients for the Configural Frequencies Analysis (CFA) defining main- and (optional) interaction effects. The core principle is to use <code>glm</code> in package <code>stats</code> to calculate the expected counts considering a designmatrix, which is constructed based on an formula definition given in argument <code>form</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CFA(
  patternfreq,
  alpha = 0.05,
  form = NULL,
  ccor = FALSE,
  family = poisson(),
  intercept = FALSE,
  method = "log",
  blank = NULL,
  cova = NULL,
  bintest = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>patternfreq</code></td>
<td>
<p>an object of class <code>"Pfreq"</code>, which is data in pattern frequencies representation - see function <code>dat2fre</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>a numeric giving the alpha level for testing (default set to <code>alpha=.05</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>either a character expression which can be coerced into a model formula with the function <code>as.formula</code> in the package <code>stats</code>. If this argument is left empty (at default <code>form=NULL</code>) the (internal) function <code>design_cfg_cfa()</code> will return a designmatrix coding only main effects and no interactions – for a designmatrix referring to  three variables (V1, V2, V3) for example, leaving the argument <code>form</code> empty will be equivalent to assigning the character <code>"~ V1 + V2 + V3"</code> to the argument (<code>form="~ V1 + V2 + V3"</code>).
A special case is to define a null-model or rather a cfa model of order zero. In such a model no (main) effects are considered. This can be achieved bei passing the character expression <code>"null"</code> to the argument <code>form</code> – so: <code>form = "null"</code> – not to be confound with the default setting of this argument <code>form=NULL</code>. Another option is to define your own designmatrix and assign it to this argument (<code>form</code>) in this case the object assigned to <code>form</code> must be of class <code>"matrix"</code> and must logical match to the argument <code>patternfreq</code>, which is currently not checked! - but simply assumed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ccor</code></td>
<td>
<p>either a logical (TRUE / FALSE) determining whether to apply a continuity correction or not for the Binomial Approximation to the z-Test. When set to <code>ccor=TRUE</code> continuity correction is applied for expected values 5 =&lt; expected =&lt; 10. For <code>ccor=FALSE</code> no continuity correction is applied. Another option is to set <code>ccor=c(x,y)</code> where x is the lower and y the upper bound for expected values where continuity correction is applied. So <code>ccor=c(5,10)</code> is equivalent to <code>ccor=TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>argument passed to <code>glm.fit</code> with default set to <code>poisson()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>argument passed to <code>glm.fit</code> with default set to <code>FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>character defining the estimation method for expected frequencies with default set to <code>method="log"</code> to estimate the expected frequencies using <code>glm</code>. An other option is to set this argument to <code>method="margins"</code> which will result in expected frequencies calculated based on the margins of the multidimensional contingency table. Only main effects models are possible in this case and thus the arguments <code>form</code>, <code>family</code> <code>cova</code> and <code>intercept</code> are ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>blank</code></td>
<td>
<p>can be used to indicate which pattern (configurations) are declared as structural cells (configurations) for functional CFA. Should be either (1) a character vector defining the pattern (with spaces between variable categories), which will be ignored for calculation of expected frequencies; or (2) a numeric vector defining the (row) positions of the pattern in an object of class <code>"Pfreq"</code> (see. argument <code>patternfreq</code>), which will be ignored for calculation of expected frequencies. At default (<code>blank=NULL</code>) all possible pattern, as listed in object of class <code>"Pfreq"</code>, are included for calculation of expected frequencies.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cova</code></td>
<td>
<p>a matrix (possibly with one or more columns) holding the covariate (mean) values for each pattern (configurations) see function <code>dat2cov</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bintest</code></td>
<td>
<p>a logical with default set to <code>bintest=TRUE</code>; if set to <code>bintest=FALSE</code> no calculations for the exact binomial test are performed, which can reduce processing time in some cases dramatically.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters passed through to other functions.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is the main function of the package. It internal calls several functions of the package <code>confreq-package</code> which are also available as single functions. For classification of the observed patterns into 'Types' and 'Antitypes' according to Lienert  (1971), a S3 summary method for the resulting object of class <code>"CFA"</code> can be applied - see <code>summary.CFA</code>. An S3 plot method is useful for visualization of the contingency table and the 'Types' and 'Antitypes' – see <code>plot.CFA</code>. Since version  1.6.0-1 of <code>confreq</code> survey weights are supported when tabluating a data set with function <code>dat2fre</code>. In case that for the resulting tabulated data in the object of class <code>c("data.frame","Pfreq")</code> survey weights were used the function <code>CFA</code> will take into account those weigts for estimation of the expected counts – currently only when <code>method="log"</code>.
</p>


<h3>Value</h3>

<p>an object of class <code>CFA</code> with results.
</p>


<h3>References</h3>

<p>Lienert, G. A. (1971). Die Konfigurationsfrequenzanalyse: I. Ein neuer Weg zu Typen und Syndromen. <em>Zeitschrift für Klinische Psychologie und Psychotherapie, 19</em>(2), 99-115.
</p>
<p>Glück, J., &amp; Von Eye, A. (2000). Including covariates in Configural Frequency Analysis. <em>Psychologische Beitrage, 42</em>, 405–417.
</p>
<p>Victor, N. (1989). An Alternativ Approach to Configural Frequency Analysis. <em>Methodika, 3</em>, 61–73.
</p>
<p>Stemmler, M. (2020). <em>Person-Centered Methods</em>. Cham: Springer International Publishing.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#######################################
######### some examples ########
data(LienertLSD)
LienertLSD
res1 &lt;- CFA(LienertLSD)
summary(res1)
## testing with (full) interactions
res2 &lt;- CFA(LienertLSD,form="~ C + T + A + C:T + C:A + T:A + C:T:A")
summary(res2)
#' ## testing the null model
res3 &lt;- CFA(LienertLSD,form="null")
summary(res3)
#######################
data(suicide)
suicide
# suicide data is in non tabulated data representation - so it must be tabulated !
res4 &lt;- CFA(dat2fre(suicide))  
summary(res4)
</code></pre>


</div>