<div class="container">

<table style="width: 100%;"><tr>
<td>test_hvg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>test_hvg</h2>

<h3>Description</h3>

<p>For each cluster in <em>cluster</em>, HVGs are defined with
Seurat function <em>FindVariableFeatures</em>. A Fisher test is performed to
see if there is a statistically significant enrichment between the top
<em>number_hvg</em> and the <em>localized_genes</em>
</p>


<h3>Usage</h3>

<pre><code class="language-R">test_hvg(
  raw_counts,
  cluster,
  localized_genes,
  background,
  number_hvg,
  min_p_value
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>raw_counts</code></td>
<td>
<p>Raw count matrix (n_genes X n_cells).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>Vector of length equal to the number of cells, with cluster
assignment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>localized_genes</code></td>
<td>
<p>Character vector with localized genes detected by CIARA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>background</code></td>
<td>
<p>Character vector with all the genes names to use as
background for the Fisher test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>number_hvg</code></td>
<td>
<p>Integer value. Number of top HVGs provided by the Seurat
function <em>FindVariableFeatures</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_p_value</code></td>
<td>
<p>Threshold on p values provided by Fisher test.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with two elements. </p>
<table>
<tr style="vertical-align: top;">
<td><code>first element</code></td>
<td>
<p>The first one is a
list with length equal to the number of clusters. Each entry is list of
three elements. The first two elements contain the p value and the odds
ration given by the Fisher test The third is a vector with genes names that
are present both in <em>localized_genes</em> and in top <em>number_hvg</em> HVGs
.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>second element</code></td>
<td>
<p>a character vector with the name of the cluster that
have a p value smaller than <em>min_p_value</em>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Gabriele Lubatti <a href="mailto:gabriele.lubatti@helmholtz-muenchen.de">gabriele.lubatti@helmholtz-muenchen.de</a>
</p>


<h3>See Also</h3>

<p><a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/fisher.test">https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/fisher.test</a>
</p>


</div>