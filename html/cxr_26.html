<div class="container">

<table style="width: 100%;"><tr>
<td>cxr_pm_multifit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multi-species parameter optimization</h2>

<h3>Description</h3>

<p>This function is a wrapper for estimating parameters for several
focal species, instead of making separate calls to <code>cxr_pm_fit</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cxr_pm_multifit(
  data,
  model_family = c("BH"),
  focal_column = NULL,
  covariates = NULL,
  optimization_method = c("BFGS", "CG", "Nelder-Mead", "ucminf", "L-BFGS-B", "nlm",
    "nlminb", "Rcgmin", "Rvmmin", "spg", "bobyqa", "nmkb", "hjkb", "nloptr_CRS2_LM",
    "nloptr_ISRES", "nloptr_DIRECT_L_RAND", "DEoptimR", "GenSA"),
  alpha_form = c("none", "global", "pairwise"),
  lambda_cov_form = c("none", "global"),
  alpha_cov_form = c("none", "global", "pairwise"),
  initial_values = NULL,
  lower_bounds = NULL,
  upper_bounds = NULL,
  fixed_terms = NULL,
  bootstrap_samples = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>named list in which each component is
a dataframe with a fitness column and a number of columns representing neighbours</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model_family</code></td>
<td>
<p>family of model to use. Available families are BH (Beverton-Holt), LV (Lotka-Volterra),
RK (Ricker), and LW (Law-Watkinson). Users may also define their own families and models (see vignette 4).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>focal_column</code></td>
<td>
<p>character vector with the same length as data,
giving the names of the columns representing
intraspecific observations for each species,
or numeric vector giving the position of such columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariates</code></td>
<td>
<p>optional named list in which each component is
a dataframe with values of each covariate for each observation. The ith component
of <code>covariates</code> are the covariate values that correspond to
the ith component of <code>data</code>, so they must have the same number of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimization_method</code></td>
<td>
<p>numerical optimization method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_form</code></td>
<td>
<p>what form does the alpha parameter take? one of "none" (no alpha in the model),
"global" (a single alpha for all pairwise interactions), or "pairwise" (one alpha value for every interaction).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda_cov_form</code></td>
<td>
<p>form of the covariate effects on lambda. Either "none" (no covariate effects) or "global" (one estimate per covariate).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_cov_form</code></td>
<td>
<p>form of the covariate effects on alpha. One of "none" (no covariate effects), "global" (one estimate per covariate on every alpha),
or "pairwise" (one estimate per covariate and pairwise alpha)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial_values</code></td>
<td>
<p>list with components "lambda","alpha_intra","alpha_inter","lambda_cov", "alpha_cov", specifying the initial values
for numerical optimization. Single values are allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower_bounds</code></td>
<td>
<p>optional list with single values for "lambda","alpha_intra","alpha_inter","lambda_cov", "alpha_cov".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper_bounds</code></td>
<td>
<p>optional list with single values for "lambda","alpha_intra","alpha_inter","lambda_cov", "alpha_cov".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed_terms</code></td>
<td>
<p>optional named list in which each component is
itself a list containing fixed terms for each focal species.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bootstrap_samples</code></td>
<td>
<p>number of bootstrap samples for error calculation. Defaults to 0, i.e. no error is calculated.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object of class 'cxr_pm_multifit' which is a list with the following components:
</p>

<ul>
<li>
<p> model_name: string with the name of the fitness model
</p>
</li>
<li>
<p> model: model function
</p>
</li>
<li>
<p> data: data supplied
</p>
</li>
<li>
<p> taxa: names of the taxa fitted
</p>
</li>
<li>
<p> covariates: covariate data supplied
</p>
</li>
<li>
<p> optimization_method: optimization method used
</p>
</li>
<li>
<p> initial_values: list with initial values
</p>
</li>
<li>
<p> fixed_terms: list with fixed terms
</p>
</li>
<li>
<p> lambda: fitted values for lambda, or NULL if fixed
</p>
</li>
<li>
<p> alpha_intra: fitted values for alpha_intra, or NULL if fixed
</p>
</li>
<li>
<p> alpha_inter: fitted values for alpha_inter, or NULL if fixed
</p>
</li>
<li>
<p> lambda_cov: fitted values for lambda_cov, or NULL if fixed
</p>
</li>
<li>
<p> alpha_cov: fitted values for alpha_cov, or NULL if fixed
</p>
</li>
<li>
<p> lambda_standard_error: standard errors for lambda, if computed
</p>
</li>
<li>
<p> alpha_standard_error: standard errors for alpha, if computed
</p>
</li>
<li>
<p> lambda_cov_standard_error: standard errors for lambda_cov, if computed
</p>
</li>
<li>
<p> alpha_cov_standard_error: standard errors for alpha_cov, if computed
</p>
</li>
<li>
<p> log_likelihood: log-likelihoods of the fits
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R"># fit three species at once
data("neigh_list")
data &lt;- neigh_list[1:3]
# keep only fitness and neighbours columns
for(i in 1:length(data)){
  data[[i]] &lt;- data[[i]][,2:length(data[[i]])]
}
# be explicit about the focal species
focal.sp &lt;- names(data)
# covariates: salinity
data("salinity_list")
salinity &lt;- salinity_list[1:3]
# keep only salinity column
for(i in 1:length(salinity)){
  salinity[[i]] &lt;- data.frame(salinity = salinity[[i]][,2:length(salinity[[i]])])
}

  fit_3sp &lt;- cxr_pm_multifit(data = data,
                             optimization_method = "bobyqa",
                             model_family = "BH",
                             focal_column = focal.sp,
                             covariates = salinity,
                             alpha_form = "pairwise",
                             lambda_cov_form = "global",
                             alpha_cov_form = "global",
                             initial_values = list(lambda = 1,
                                                   alpha_intra = 0.1,
                                                   alpha_inter = 0.1,
                                                   lambda_cov = 0.1, 
                                                   alpha_cov = 0.1),
                             lower_bounds = list(lambda = 0.01,
                                                 alpha_intra = 0,
                                                 alpha_inter = 0,
                                                 lambda_cov = 0, 
                                                 alpha_cov = 0),
                             upper_bounds = list(lambda = 100,
                                                 alpha_intra = 1,
                                                 alpha_inter = 1,
                                                 lambda_cov = 1, 
                                                 alpha_cov = 1),
                             bootstrap_samples = 3)
  # brief summary
  summary(fit_3sp)
  # interaction matrix
  fit_3sp$alpha_matrix

</code></pre>


</div>