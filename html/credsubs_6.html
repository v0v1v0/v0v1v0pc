<div class="container">

<table style="width: 100%;"><tr>
<td>sim.cred.band</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Constructs a simultaneous credible band</h2>

<h3>Description</h3>

<p><code>sim.cred.band</code> returns a simultaneous band over a finite set of
covariate points given either a sample from the posterior of the
regression surface or a function <code>FUN(x, params)</code> and a sample from
the posterior of the parameters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim.cred.band(
  params,
  design = NULL,
  FUN = function(x, params) {     params %*% t(x) },
  cred.level = 0.95,
  method = c("asymptotic", "quantile"),
  sides = c("both", "upper", "lower"),
  est.FUN = mean,
  var.FUN = sd,
  point.estimate = NULL,
  track = numeric(0),
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>
<p>A numeric matrix whose rows are draws from the posterior
distribution of either the regression surface or the parameter vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>
<p>(Optional) A numeric matrix whose rows are covariate points
over which the band is to be constructed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUN</code></td>
<td>
<p>(Optional) a function of the form <code>function(x, params)</code>
that takes a row of <code>design</code> and the entire <code>params</code> matrix and
returns a vector of the same length of <code>x</code> representing the regression
surface.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cred.level</code></td>
<td>
<p>Numeric; the credible level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Either "asymptotic" (default) or "quantile"; see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sides</code></td>
<td>
<p>One of "both" (default), "upper", or "lower".
Which bounds should be constructed?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est.FUN</code></td>
<td>
<p>The function used to produce estimates of the regression
surface. Default is <code>mean</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.FUN</code></td>
<td>
<p>The function used to quantify the variability of the
regression surface posterior. Default is <code>sd</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>point.estimate</code></td>
<td>
<p>If not null, replaces the mean and sets the reference 
around which the standard error is computed.
Useful for bootstrapping methods.
Treated as a row of the <code>params</code> matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>track</code></td>
<td>
<p>A numeric vector of indices indicating which rows (default none)
of the design matrix should have the sample of the corresponding
<code>FUN(x, params)</code> returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical (default <code>FALSE</code>); print progress?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>design</code> is <code>NULL</code> (default), it is taken to be the identity
matrix of dimension <code>ncol(params)</code>, so that the rows of params
are treated as draws from the posterior <code>FUN(x, params)</code>.
</p>
<p>The 'asymptotic' method assumes that the marginal posteriors of 
the <code>FUN(x, params)</code> are asymptotically normal and is usually
significantly faster and less memory-intensive than the 'quantile'
method, which makes no such assumption.
</p>


<h3>Value</h3>

<p>An object of class <code>sim.cred.band</code>, which contains:
</p>

<dl>
<dt><code>upper</code></dt>
<dd>
<p>A numeric vector of upper bounds.</p>
</dd>
<dt><code>lower</code></dt>
<dd>
<p>A numeric vector of lower bounds.</p>
</dd>
<dt><code>cred.level</code></dt>
<dd>
<p>As provided.</p>
</dd>
<dt><code>method</code></dt>
<dd>
<p>As provided.</p>
</dd>
<dt><code>sides</code></dt>
<dd>
<p>As provided.</p>
</dd>
<dt><code>est</code></dt>
<dd>
<p>Posterior estimate of the regression surface.</p>
</dd>
<dt><code>est.FUN</code></dt>
<dd>
<p>As provided.</p>
</dd>
<dt><code>var</code></dt>
<dd>
<p>Summary of posterior variability of the regression
surface.</p>
</dd>
<dt><code>var.FUN</code></dt>
<dd>
<p>As provided.</p>
</dd>
<dt><code>W</code></dt>
<dd>
<p>An estimate of the extremal errors.</p>
</dd>
<dt><code>W.crit</code></dt>
<dd>
<p>The critical quantile of W.</p>
</dd>
<dt><code>trace</code></dt>
<dd>
<p>The posterior samples of the regression surface
indicated by the <code>track</code> argument.</p>
</dd>
</dl>
<h3>Examples</h3>

<pre><code class="language-R">### Sample from regression surface posterior
reg.surf.sample &lt;- matrix(rnorm(1000, mean=1:10), ncol=2, byrow=TRUE)
sim.cred.band(reg.surf.sample, cred.level=0.80)

### Parametric case
design &lt;- cbind(1, 1:10)
params &lt;- matrix(rnorm(200, mean=1:2), ncol=2, byrow=TRUE)
sim.cred.band(params, design)

### With custom function
params.sd &lt;- cbind(1 / rgamma(100, 1), params)
FUN.sd &lt;- function(x, params) { params[, -1] %*% t(x) / params[, 1] }
sim.cred.band(params.sd, design, FUN.sd)

</code></pre>


</div>