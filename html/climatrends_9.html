<div class="container">

<table style="width: 100%;"><tr>
<td>crop_sensitive</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Crop sensitive indices</h2>

<h3>Description</h3>

<p>Compute crop sensitive indices. These indices are designed to capture 
the changes in temperature extremes during key phenological stages 
(e.g. anthesis), but can also be applied to other phenological stages.
</p>


<h3>Usage</h3>

<pre><code class="language-R">crop_sensitive(object, ...)

## Default S3 method:
crop_sensitive(object, tmin, ...)

## S3 method for class 'data.frame'
crop_sensitive(object, day.one, ...)

## S3 method for class 'array'
crop_sensitive(object, day.one, ...)

## S3 method for class 'sf'
crop_sensitive(object, day.one, ..., as.sf = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>a numeric vector with the maximum temperature, 
or a data.frame with geographical coordinates (lonlat), 
or an object of class <code>sf</code> with geometry 'POINT' or 'POLYGON', 
or an <code>array</code> with two dimensions containing the
maximum and minimum temperature, in that order. See details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments passed to methods. See details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tmin</code></td>
<td>
<p>a numeric vector with the minimum temperature</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>day.one</code></td>
<td>
<p>a vector of class <code>Date</code> or any other object that can be 
coerced to <code>Date</code> (e.g. integer, character YYYY-MM-DD) for the starting 
day to capture the climate data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>as.sf</code></td>
<td>
<p>logical, to return an object of class 'sf'</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function uses pre-defined threshold to compute the indices. For hts_mean (32,
35, 38 Celsius), for hts_max (36, 39, 42 Celsius), for hse (31 Celsius), for 
cdi_mean (22, 23, 24 Celsius), for cdi_max (27, 28, 29 Celsius) and for 
lethal (43, 46, 49 Celsius). 
</p>
<p>Additional arguments:
</p>
<p>The thresholds can be adjusted using the arguments <code>hts_mean.threshold</code>, 
<code>hts_max.threshold</code>, <code>hse.threshold</code>, <code>cdi_mean.threshold</code>, 
<code>cdi_max.threshold</code> and <code>lethal.threshold</code> which are a numeric (or
vector of numeric)
</p>
<p><code>last.day</code>: an object (optional to <var>span</var>) of class <code>Date</code> or
any other object that can be coerced to <code>Date</code> (e.g. integer, character 
YYYY-MM-DD) for the last day of the time series. For <code>data.frame</code>, <code>array</code> 
and <code>sf</code> methods
</p>
<p><code>span</code>: an integer (optional to <var>last.day</var>) or a vector with 
integers (optional if <var>last.day</var> is given) for the length of 
the time series to be captured. For <code>data.frame</code>, <code>array</code> 
and <code>sf</code> methods
</p>


<h3>Value</h3>

<p>A dataframe with crop sensitive indices with n colunms depending on the 
number of thresholds passed to each index:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>hts_mean</code></td>
<td>
<p>high temperature stress using daily MEAN temperature, 
and given as percentage number of days a certain threshold is exceeded</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hts_max</code></td>
<td>
<p>high temperature stress using daily MAX temperature,
and given as percentage number of days a certain threshold is exceeded</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hse</code></td>
<td>
<p>heat stress event, and given as percentage number of days a 
a certain threshold is exceeded for at least two consecutive days</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hse_ms</code></td>
<td>
<p>heat stress event, and given the maximum number of days 
a certain threshold is exceeded for at least two consecutive days</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cdi_mean</code></td>
<td>
<p>crop duration index using daily MEAN temperature, 
and given as max(Tmean - threshold, 0)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cdi_max</code></td>
<td>
<p>crop duration index using daily MAX temperature, 
and given as max(Tmax - threshold, 0)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lethal</code></td>
<td>
<p>lethal temperatures, defined as percentage of days during the 
timeseries where daily MEAN temperature exceeds a given threshold</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Challinor et al. (2016). Nature Climate Change 6(10):6954-958
<a href="https://doi.org/10.1038/nclimate3061">doi:10.1038/nclimate3061</a>
</p>
<p>Trnka et al. (2014). Nature Climate Change 4(7):637â€“43.
<a href="https://doi.org/10.1038/nclimate2242">doi:10.1038/nclimate2242</a>
</p>


<h3>See Also</h3>

<p>Other temperature functions: 
<code>ETo()</code>,
<code>GDD()</code>,
<code>temperature()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># the default method
set.seed(78)
tmax &lt;- runif(50, 37, 47)
set.seed(79)
tmin &lt;- runif(50, 31, 34)

crop_sensitive(tmax, tmin)

###############################################

# the array method
data("temp_dat", package = "climatrends")

# use the default thresholds
crop_sensitive(temp_dat,
               day.one = "2013-10-27",
               last.day = "2013-11-04")

# or change the thresholds based on the crop physiology
crop_sensitive(temp_dat,
               day.one = "2013-10-27",
               last.day = "2013-11-04",
               hts_mean.threshold = c(24),
               hts_max.threshold = c(31, 33))
</code></pre>


</div>