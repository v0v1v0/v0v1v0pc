<div class="container">

<table style="width: 100%;"><tr>
<td>trim_matrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Trims a morphological distance matrix</h2>

<h3>Description</h3>

<p>Trims a morphological distance matrix by removing objects that cause empty cells.
</p>


<h3>Usage</h3>

<pre><code class="language-R">trim_matrix(distance_matrix, tree = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>distance_matrix</code></td>
<td>
<p>A distance matrix in the format created by calculate_morphological_distances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>If the distance matrix includes ancestors this should be the tree (phylo object) used to estimate their states.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Trims a morphological distance matrix by removing nodes (terminal or internal) that cause empty cells allowing it to be passed to an ordination function such as cmdscale.
</p>
<p>Some distances are not calculable from cladistic matrices if there are taxa that have no coded characters in common. This algorithm iteratively removes the taxa responsible for the most empty cells until the matrix is complete (no empty cells).
</p>
<p>If the matrix includes estimated ancestral states the user should also provide the tree used (as the <code>tree</code> argument). The function will then also remove the tips from the tree and where reconstructed ancestors also cause empty cells will prune the minimum number of descendants of that node. The function will then renumber the nodes in the distance matrix so they match the pruned tree.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>distance_matrix</code></td>
<td>
<p>A complete distance matrix with all cells filled. If there were no empty cells will return original.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>A tree (if supplied) with the removed taxa (see below) pruned. If no taxa are dropped will return the same tree as inputted. If no tree is supplied this is set to NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>removed_taxa</code></td>
<td>
<p>A character vector listing the taxa removed. If none are removed this will be set to NULL.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Graeme T. Lloyd <a href="mailto:graemetlloyd@gmail.com">graemetlloyd@gmail.com</a>
</p>


<h3>See Also</h3>

<p>calculate_morphological_distances
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Get morphological distances for Michaux (1989) data set:
distances &lt;- calculate_morphological_distances(cladistic_matrix = michaux_1989)

# Attempt to trim max.distance_matrix:
trim_matrix(distance_matrix = distances$distance_matrix)
</code></pre>


</div>