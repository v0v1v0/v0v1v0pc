<div class="container">

<table style="width: 100%;"><tr>
<td>davies</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Davies method</h2>

<h3>Description</h3>

<p>Distribution function (survival function in fact) of quadratic forms in normal variables using Davies's method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">davies(q, lambda, h = rep(1, length(lambda)), delta = rep(0,
         length(lambda)), sigma = 0, lim = 10000, acc = 0.0001)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>value point at which distribution function is to be evaluated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>the weights <code class="reqn">\lambda_1, \lambda_2, ..., \lambda_n</code>, i.e. distinct non-zero characteristic roots of <code class="reqn">A\Sigma</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>respective orders of multiplicity <code class="reqn">n_j</code> of the <code class="reqn">\lambda</code>s</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>non-centrality parameters <code class="reqn">\delta_j^2</code> (should be positive)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>coefficient <code class="reqn">\sigma</code> of the standard Gaussian</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lim</code></td>
<td>
<p>maximum number of integration terms. Realistic values for
'lim' range from 1,000 if the procedure is to be called repeatedly up
to 50,000 if it is to be called only occasionally</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>acc</code></td>
<td>
<p>error bound. Suitable values for 'acc' range from 0.001 to
0.00005 which should be adequate for most statistical purposes.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Computes <code class="reqn">P[Q&gt;q]</code> where <code class="reqn">Q = \sum_{j=1}^r\lambda_jX_j+\sigma X_0</code> where <code class="reqn">X_j</code> are independent random variables having a non-central <code class="reqn">chi^2</code> distribution with <code class="reqn">n_j</code> degrees of freedom and non-centrality parameter <code class="reqn">delta_j^2</code> for <code class="reqn">j=1,...,r</code> and <code class="reqn">X_0</code> having a standard Gaussian distribution.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>vector, indicating performance of procedure, with the
following components: 1: absolute
value sum, 2: total number of integration terms, 3: number of
integrations, 4: integration interval in main integration,
5: truncation point in initial integration, 6: standard deviation of
convergence factor term, 7: number of cycles to locate integration parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ifault</code></td>
<td>
<p>fault indicator: 0: no error, 1: requested accuracy
could not be obtained, 2: round-off error possibly significant, 3:
invalid parameters, 4: unable to locate integration parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Qq</code></td>
<td>
<p><code class="reqn">P[Q&gt;q]</code></p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Pierre Lafaye de Micheaux (<a href="mailto:lafaye@dms.umontreal.ca">lafaye@dms.umontreal.ca</a>) and
Pierre Duchesne (<a href="mailto:duchesne@dms.umontreal.ca">duchesne@dms.umontreal.ca</a>)</p>


<h3>References</h3>

<p>P. Duchesne, P. Lafaye de Micheaux, Computing the distribution of quadratic forms: Further comparisons between the Liu-Tang-Zhang approximation and exact methods, <em>Computational Statistics and Data Analysis</em>, Volume 54, (2010), 858-862
</p>
<p>Davies R.B., Algorithm AS 155: The Distribution of a Linear
Combination of chi-2 Random Variables, Journal of the Royal
Statistical Society. Series C (Applied Statistics), 29(3), p. 323-333,
(1980)</p>


<h3>Examples</h3>

<pre><code class="language-R"># Some results from Table 3, p.327, Davies (1980)

 round(1 - davies(1, c(6, 3, 1), c(1, 1, 1))$Qq, 4)
 round(1 - davies(7, c(6, 3, 1), c(1, 1, 1))$Qq, 4)
 round(1 - davies(20, c(6, 3, 1), c(1, 1, 1))$Qq, 4)
 
 round(1 - davies(2, c(6, 3, 1), c(2, 2, 2))$Qq, 4)
 round(1 - davies(20, c(6, 3, 1), c(2, 2, 2))$Qq, 4)
 round(1 - davies(60, c(6, 3, 1), c(2, 2, 2))$Qq, 4)
 
 round(1 - davies(10, c(6, 3, 1), c(6, 4, 2))$Qq, 4)
 round(1 - davies(50, c(6, 3, 1), c(6, 4, 2))$Qq, 4)
 round(1 - davies(120, c(6, 3, 1), c(6, 4, 2))$Qq, 4)

 round(1 - davies(20, c(7, 3), c(6, 2), c(6, 2))$Qq, 4)
 round(1 - davies(100, c(7, 3), c(6, 2), c(6, 2))$Qq, 4)
 round(1 - davies(200, c(7, 3), c(6, 2), c(6, 2))$Qq, 4)

 round(1 - davies(10, c(7, 3), c(1, 1), c(6, 2))$Qq, 4)
 round(1 - davies(60, c(7, 3), c(1, 1), c(6, 2))$Qq, 4)
 round(1 - davies(150, c(7, 3), c(1, 1), c(6, 2))$Qq, 4)

 round(1 - davies(70, c(7, 3, 7, 3), c(6, 2, 1, 1), c(6, 2, 6, 2))$Qq, 4)
 round(1 - davies(160, c(7, 3, 7, 3), c(6, 2, 1, 1), c(6, 2, 6, 2))$Qq, 4)
 round(1 - davies(260, c(7, 3, 7, 3), c(6, 2, 1, 1), c(6, 2, 6, 2))$Qq, 4)

 round(1 - davies(-40, c(7, 3, -7, -3), c(6, 2, 1, 1), c(6, 2, 6,
 2))$Qq, 4)
 round(1 - davies(40, c(7, 3, -7, -3), c(6, 2, 1, 1), c(6, 2, 6, 2))$Qq,
 4)
 round(1 - davies(140, c(7, 3, -7, -3), c(6, 2, 1, 1), c(6, 2, 6,
 2))$Qq, 4)

# You should sometimes play with the 'lim' parameter:
davies(0.00001,lambda=0.2)
imhof(0.00001,lambda=0.2)$Qq
davies(0.00001,lambda=0.2, lim=20000)

</code></pre>


</div>