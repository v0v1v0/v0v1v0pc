<div class="container">

<table style="width: 100%;"><tr>
<td>crmsim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>CRM Simulator</h2>

<h3>Description</h3>

<p>crmsim, crmsiminc1 and crmsiminc2 implement the continued reassessment method (CRM) for dose
finding in Phase I clinical trials.  The operating characteristics of
CRM are summarized through simulations.
</p>
<p>crmsim allows users to select a variety of cohort sizes.  A cohort of
subjects are treated at the same dose.
</p>
<p>The cohort size is fixed to 1 in crmsiminc1 and crmsiminc2.
crmsiminc1 implements an algorithm that allows a clinical trial to proceed to the next subject's
dose assignment before observing the last subject's toxicity data.
crmsiminc2 allows a clinical trial to proceed to the next
subject's dose assignment before observing the last two subject's
toxicity data (see Iasonos et al. for details).
</p>


<h3>Usage</h3>

<pre><code class="language-R">crmsim(target,prior,true,rate,cycle,cohort=1,nsubject=24,nsim=1000,
       model=1,a0=1,b=3,jump=FALSE,start.dose=1,seed=777)
crmsiminc1(target,prior,true,rate,cycle,nsubject=24,nsim=1000,
           model=1,a0=1,b=3,jump=FALSE,start.dose=1,seed=777)
crmsiminc2(target,prior,true,rate,cycle,nsubject=24,nsim=1000,
           model=1,a0=1,b=3,jump=FALSE,start.dose=1,seed=777)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>
<p>Target probability of toxicity. The value must be in (0, 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>Prior probabilities of toxicity for each dose.
The values must be in (0,1) and in an ascending order.  For
example, prior=c(0.05,0.1,0.2,0.3,0.5,0.7),which corresponds to dose
levels 1, 2, 3, 4, 5 and 6,respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>true</code></td>
<td>
<p>True probabilities of toxicity. The values must be in
(0,1) and in an ascending order.  e.g. (0.1,0.2,0,3,0.4,0.5,0.8)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate</code></td>
<td>
<p>Recruitment/accrual rate of subjects in a 30 window.
For example,if 1 subject can be recruited per 30 days, then set rate
= 1/30 = 0.033; if 2 patients per 30 day then rate = 2/30 = 0.0667.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cycle</code></td>
<td>
<p>The length of treatment cycle in days.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cohort</code></td>
<td>
<p>Cohort size of subjects entering into the trials. Default
is 1.  The value for cohort must be less than or equal to the value
for nsubject.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsubject</code></td>
<td>
<p>Total number of subjects in one simulation(or
trial). Default is 24.  nsubject should be equal to n*cohort,where
n is positive integer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>Total number of simulations. Default is 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Dose-toxicity model.  The value must be 1 (hyperbolic
tangent model) or 2 (one-parameter logistic model).  Default is 1.
Hyperbolic tangent model: $p(y=1|x,a) = ((tanh(x)+1)/2)^a$.
One-parameter logistic model: $p(y=1|x,a,b) = exp(b+ax)/(1+exp(b+ax))$.
For both models, y=1 indicates toxicity is observed; a is the
parameter that can be updated based on the outcome of the trail;
b is a fixed parameter. The prior for a is exp(-a).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a0</code></td>
<td>
<p>Initial value for parameter a.  Default is 1.0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>A fixed parameter for the one-parameter logistic model.
Default is 3.0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jump</code></td>
<td>
<p>jump=FALSE means NOT allowing that the proposed dose by the
CRM program has an increase of more than one level than the
previous level;  jump=TRUE means allowing more-than-one-level
increase of the proposed dose by the CRM program.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start.dose</code></td>
<td>
<p>Initial dose for each trial.  Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Seed for the random number generator.  Default is 777.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>SimResult is a matrix that summarizes the operating characteristics of
CRM.  The column names are the dose levels.  The row names are the
operating characteristics.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>% Selection</code></td>
<td>
<p>the percentage of selection of each dose as MTD</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>% Subjects Treated</code></td>
<td>
<p>the percentage of subjects treated at each
dose</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code># Subjects Treated</code></td>
<td>
<p>the average number of subjects treated at
each dose</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Average Toxicities</code></td>
<td>
<p>the average toxicities per trial at each dose</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>True Probabilities</code></td>
<td>
<p>the true probability of toxicity of each
dose</p>
</td>
</tr>
</table>
<p>TrialDuration is a table that summarizes the time needed for the
trial based on the simulation.
</p>


<h3>Author(s)</h3>

<p>Qianxing Mo; <a href="mailto:qianxing.mo@moffitt.org">qianxing.mo@moffitt.org</a></p>


<h3>References</h3>

<p>John O'Quigley, Margaret Pepe,and Lloyd Fisher. (1990). Continual
Reassessment Method: A Practical Design for Phase 1 Clinical Trials in Cancer.
<em>Biometrics</em>, 46, pp.33-48
</p>
<p>Alexia Iasonos,Andrew S Wilton,Elyn R Riedel,Venkatraman E Seshan and
David R Spriggs.  A comprehensive comparison of the continual
reassessment method to the standard 3+3 dose escalation scheme in
Phase I dose-finding studies.  <em>Clinical Trials</em>,2008,nil:1-12
</p>


<h3>See Also</h3>

<p><code>crm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
prior1 &lt;- c(0.05,0.1,0.2,0.3,0.5,0.7)
true1 &lt;- c(0.1,0.15,0.2,0.4,0.5,0.8)

### simulations using model 1 (hyperbolic tangent model)

### uncomment the following code to run ###
#crmsim(target=0.2,prior=prior1,true=true1,rate=0.1,cycle=21,cohort=1,nsubject=24,nsim=1000,
#       model=1,a0=1,b=3,jump=FALSE,start.dose=1,seed=777)

#crmsiminc1(target=0.2,prior=prior1,true=true1,rate=0.1,cycle=21,nsubject=24,nsim=1000,
#           model=1,a0=1,b=3,jump=FALSE,start.dose=1,seed=777)

#crmsiminc2(target=0.2,prior=prior1,true=true1,rate=0.1,cycle=21,nsubject=24,nsim=1000,
#           model=1,a0=1,b=3,jump=FALSE,start.dose=1,seed=777)

# simulations using model 2 (one-parameter logistic model)
#crmsim(target=0.2,prior=prior1,true=true1,rate=0.1,cycle=21,cohort=1,nsubject=24,nsim=1000,
#       model=2,a0=1,b=3,jump=FALSE,start.dose=1,seed=777)

#crmsiminc1(target=0.2,prior=prior1,true=true1,rate=0.1,cycle=21,nsubject=24,nsim=1000,
#           model=2,a0=1,b=3,jump=FALSE,start.dose=1,seed=777)

#crmsiminc2(target=0.2,prior=prior1,true=true1,rate=0.1,cycle=21,nsubject=24,nsim=1000,
#           model=2,a0=1,b=3,jump=FALSE,start.dose=1,seed=777)
</code></pre>


</div>