<div class="container">

<table style="width: 100%;"><tr>
<td>loq</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate a limit of quantification (LOQ)</h2>

<h3>Description</h3>

<p>The limit of quantification is the x value, where the relative error of the
quantification given the calibration model reaches a prespecified value 1/k.
Thus, it is the solution of the equation </p>
<p style="text-align: center;"><code class="reqn">L = k c(L)</code>
</p>

<p>where c(L) is half of the length of the confidence interval at the limit L
(DIN 32645, equivalent to ISO 11843). c(L) is internally estimated by
<code>inverse.predict</code>, and L is obtained by iteration.
</p>


<h3>Usage</h3>

<pre><code class="language-R">loq(
  object,
  ...,
  alpha = 0.05,
  k = 3,
  n = 1,
  w.loq = "auto",
  var.loq = "auto",
  tol = "default"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A univariate model object of class <code>lm</code> or
<code>rlm</code> with model formula <code>y ~ x</code> or <code>y ~ x -
1</code>, optionally from a weighted regression. If weights are specified in the
model, either <code>w.loq</code> or <code>var.loq</code> have to be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Placeholder for further arguments that might be needed by
future implementations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The error tolerance for the prediction of x values in the
calculation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>The inverse of the maximum relative error tolerated at the desired
LOQ.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The number of replicate measurements for which the LOQ should be
specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w.loq</code></td>
<td>
<p>The weight that should be attributed to the LOQ. Defaults to
one for unweighted regression, and to the mean of the weights for weighted
regression. See <code>massart97ex3</code> for an example how to take
advantage of knowledge about the variance function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.loq</code></td>
<td>
<p>The approximate variance at the LOQ. The default value is
calculated from the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>The default tolerance for the LOQ on the x scale is the value of
the smallest non-zero standard divided by 1000. Can be set to a numeric
value to override this.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The estimated limit of quantification for a model used for
calibration.
</p>


<h3>Note</h3>

<p>* IUPAC recommends to base the LOQ on the standard deviation of the
signal where x = 0.
* The calculation of a LOQ based on weighted regression is non-standard and
therefore not tested. Feedback is welcome.
</p>


<h3>See Also</h3>

<p>Examples for <code>din32645</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
m &lt;- lm(y ~ x, data = massart97ex1)
loq(m)

# We can get better by using replicate measurements
loq(m, n = 3)

</code></pre>


</div>