<div class="container">

<table style="width: 100%;"><tr>
<td>CoreMicrobiome</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Identification of Core Microbiome</h2>

<h3>Description</h3>

<p>This function provides a comprehensive pipeline for processing
OTU (Operational Taxonomic Unit) tables, taxonomic tables, and metadata tables.
It applies various filtering methods based on user-defined parameters to select
core OTUs and non-core OTUs calculates alpha and beta diversity measures.
The pipeline can be customized with different normalization methods and filtering
criteria. Taxa are ranked in descending according to the cumulative sum obtained.
This method assigns taxa to the core if they are in the top X% of reads. Any taxa which appears before some cutoff percentage is included in the core.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CoreMicrobiome(otu_table, tax_table, metadata_table, filter_type, ...,
method, beta_diversity_method, top_percentage)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>otu_table</code></td>
<td>
<p>A dataframe of OTUs where the first row is the OTU ID and column names refer to sites/sample names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tax_table</code></td>
<td>
<p>A dataframe of taxonomies where the first row is the OTU ID and column names refer to taxonomic classification.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metadata_table</code></td>
<td>
<p>A dataframe of sites/samples where the first row is the sites/sample names and column names refer to groups of samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filter_type</code></td>
<td>
<p>Filtering method type, includes "abundance_fun_filter", "occupancy_fun_filter", or "combined_filter".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other parameters. These are ignored, except in filter_type = "abundance_fun_filter" which accepts min_count, prop, min_total_count parameter, and in filter_type = "occupancy_fun_filter" which accepts percent parameter, and also filter_type = "combined_filter" which accepts percent, min_count, prop, min_total_count parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Different normalization methods, includes "rrarefy", "srs", "css", "tmm", "tmmwsp", "rle", "upperquartile" or "none". The default method is tmm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_diversity_method</code></td>
<td>
<p>Different beta diversity methods, includes "bray", "jaccard", "mountford". The default method is bray.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>top_percentage</code></td>
<td>
<p>Percentage used for Core OTUs identification and the default is 10 percent.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>This function gives the list  which consist of following results.
</p>
<p>'final_otu_table_bef_filter'  otu_table obtained after sorting according to the provided tax_table and metadata_table
</p>
<p>'filtered_md_table' metadata_table obtained after sorting according to the provided otu_table
</p>
<p>'final_otu_aft_filter' otu_table obtained after filtering according to the user defined filtering method
</p>
<p>'normalized_table' normalized_otu_table obtained after normalizing according to the user defined normalization method
</p>
<p>'alpha_diversity' Alpha diversity measures of the samples
</p>
<p>'beta_diversity' Beta diversity measures between the samples
</p>
<p>'core_otus' Core OTUs obtained
</p>
<p>'non_core_otus' Non Core OTUs obtained
</p>
<p>'core_otus_tax' Taxonomy of the obtained Core OTUs
</p>
<p>'core_otus_count_data' Original count data of the obtained core OTUs
</p>
<p>'core_otus_relative_abundance' Relative abundance data of the obtained core OTUs
</p>


<h3>References</h3>

<p>Pereira, M., Wallroth, M., Jonsson, V. et al. (2018). Comparison of normalization methods for the analysis of metagenomic gene abundance data. BMC Genomics 19, 274. &lt;doi:https://doi.org/10.1186/s12864-018-4637-6&gt;
</p>
<p>Beule L, Karlovsky P. (2020). Improved normalization of species count data in ecology by scaling with ranked subsampling (SRS): application to microbial communities. PeerJ 8:e9593.&lt;doi:https://doi.org/10.7717/peerj.9593&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R">#To run input data
core_1 &lt;- CoreMicrobiome(
 otu_table = demo_otu,
 tax_table = demo_tax,
 metadata_table = demo_md,
 filter_type = "occupancy_fun_filter", #Or "abundance_fun_filter", Or "combined_filter"
 percent = 0.5,
 method = "css",  # Or "srs", "rrarefy", "tmm", "tmmwsp", "rle", "upperquartile", "none"
 beta_diversity_method = "jaccard",
 top_percentage = 10  # Adjust the percentage as needed for core/non-core OTUs
)

#To view the core otus obtained
core_1[["core_otus"]]
#To view the taxonomy of the obtained core otus
core_1[["core_otus_tax"]]
</code></pre>


</div>