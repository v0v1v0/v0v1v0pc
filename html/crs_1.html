<div class="container">

<table style="width: 100%;"><tr>
<td>crs-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Nonparametric Regression Splines with Continuous and Categorical Predictors</h2>

<h3>Description</h3>

<p>This package provides a method for nonparametric regression that
combines the (global) approximation power of regression splines for
continuous predictors (‘<code>x</code>’) with the (local) power of
kernel methods for categorical predictors (‘<code>z</code>’). The
user also has the option of instead using indicator bases for the
categorical predictors. When the predictors contain both continuous
and categorical (discrete) data types, both approaches offer more
efficient estimation than the traditional sample-splitting
(i.e. ‘frequency’) approach where the data is first broken into
subsets governed by the categorical <code>z</code>.
</p>
<p>To cite the <span class="pkg">crs</span> package type: ‘<code>citation("crs")</code>’
(without the single quotes).
</p>
<p>For a listing of all routines in the <span class="pkg">crs</span> package type:
‘<code>library(help="crs")</code>’.
</p>
<p>For a listing of all demos in the <span class="pkg">crs</span> package type:
‘<code>demo(package="crs")</code>’.
</p>
<p>For a ‘<code>vignette</code>’ that presents an overview of the
<span class="pkg">crs</span> package type: ‘<code>vignette("crs")</code>’.
</p>


<h3>Details</h3>

<p>For the continuous predictors the regression spline model employs the
B-spline basis matrix using the B-spline routines in the GNU
Scientific Library (<a href="https://www.gnu.org/software/gsl/">https://www.gnu.org/software/gsl/</a>).
</p>
<p>The <code>tensor.prod.model.matrix</code> function is used to
construct multivariate tensor spline bases when <code>basis="tensor"</code>
and uses additive B-splines otherwise (i.e. when
<code>basis="additive"</code>).
</p>
<p>For the discrete predictors the product kernel function is of the
‘Li-Racine’ type (see Li and Racine (2007) for details) which is
formed by constructing products of one of the following univariate
kernels:
</p>

<dl>
<dt>(<code class="reqn">z</code> is discrete/nominal)</dt>
<dd>
<p><code class="reqn">l(z_i,z,\lambda) = 1 </code> if <code class="reqn">z_i=z</code>, and
<code class="reqn">\lambda</code> if <code class="reqn">z_i \neq z</code>. Note that
<code class="reqn">\lambda</code> must lie between <code class="reqn">0</code> and <code class="reqn">1</code>.
</p>
</dd>
<dt>(<code class="reqn">z</code> is discrete/ordinal)</dt>
<dd>
<p><code class="reqn">l(z_i,z,\lambda) = 1</code> if
<code class="reqn">|z_i-z|=0</code>, and
<code class="reqn">\lambda^{|z_i-z|}</code> if <code class="reqn">|z_i -
        z|\ge1</code>. Note that <code class="reqn">\lambda</code> must lie
between <code class="reqn">0</code> and <code class="reqn">1</code>.
</p>
</dd>
</dl>
<p>Alternatively, for the ordinal/nominal predictors the regression
spline model will use indicator basis functions.
</p>


<h3>Author(s)</h3>

<p>Jeffrey S. Racine <a href="mailto:racinej@mcmaster.ca">racinej@mcmaster.ca</a> and Zhenghua Nie <a href="mailto:niez@mcmaster.ca">niez@mcmaster.ca</a>
</p>
<p>Maintainer: Jeffrey S. Racine <a href="mailto:racinej@mcmaster.ca">racinej@mcmaster.ca</a>
</p>
<p>I would like to gratefully acknowledge support from the Natural
Sciences and Engineering Research Council of Canada
(<a href="https://www.nserc-crsng.gc.ca">https://www.nserc-crsng.gc.ca</a>), the Social Sciences and Humanities
Research Council of Canada (<a href="https://www.sshrc-crsh.gc.ca">https://www.sshrc-crsh.gc.ca</a>), and the Shared
Hierarchical Academic Research Computing Network
(<a href="https://www.sharcnet.ca">https://www.sharcnet.ca</a>).
</p>


<h3>References</h3>

<p>Li, Q. and J.S. Racine (2007), <em>Nonparametric Econometrics:
Theory and Practice,</em> Princeton University Press.
</p>
<p>Ma, S. and J.S. Racine and L. Yang (2015), “Spline
Regression in the Presence of Categorical Predictors,” Journal of
Applied Econometrics, Volume 30, 705-717.
</p>
<p>Ma, S. and J.S. Racine (2013), “Additive Regression
Splines with Irrelevant Categorical and Continuous Regressors,”
Statistica Sinica, Volume 23, 515-541.
</p>


</div>