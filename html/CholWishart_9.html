<div class="container">

<table style="width: 100%;"><tr>
<td>rGenInvWishart</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Random Generalized Inverse Wishart Distributed Matrices</h2>

<h3>Description</h3>

<p>Generate n random matrices, distributed according
to the generalized inverse Wishart distribution with parameters
<code>Sigma</code> and <code>df</code>, <code class="reqn">W_p(\Sigma, df)</code>,
with sample size <code>df</code> less than the dimension <code>p</code>.
</p>
<p>Let <code class="reqn">X_i</code>, <code class="reqn">i = 1, 2, ..., df</code> be <code>df</code>
observations of a multivariate normal distribution with mean 0 and
covariance <code>Sigma</code>. Then <code class="reqn">\sum X_i X_i'</code> is distributed as a pseudo
Wishart <code class="reqn">W_p(\Sigma, df)</code>. Sometimes this is called a
singular Wishart distribution, however, that can be confused with the case
where <code class="reqn">\Sigma</code> itself is singular. Then the generalized inverse
Wishart distribution is the natural extension of the inverse Wishart using
the Moore-Penrose pseudo-inverse. This can generate samples for positive
semi-definite <code class="reqn">\Sigma</code> however, a function dedicated to generating
singular normal random distributions or singular pseudo Wishart distributions
should be used if that is desired.
</p>
<p>Note there are different ways of parameterizing the Inverse
Wishart distribution, so check which one you need.
Here, if <code class="reqn">X \sim IW_p(\Sigma, \nu)</code> then
<code class="reqn">X^{-1} \sim W_p(\Sigma^{-1}, \nu)</code>.
Dawid (1981) has a different definition: if
<code class="reqn">X \sim W_p(\Sigma^{-1}, \nu)</code> and
<code class="reqn">\nu &gt; p - 1</code>, then
<code class="reqn">X^{-1} = Y \sim IW(\Sigma, \delta)</code>,
where <code class="reqn">\delta = \nu - p + 1</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rGenInvWishart(n, df, Sigma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>integer sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>integer parameter, "degrees of freedom", should be less than the
dimension of <code>p</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>positive semi-definite <code class="reqn">p \times p</code> "scale" matrix,
the matrix parameter of the distribution.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a numeric array, say <code>R</code>, of dimension
<code class="reqn">p \times p \times n</code>,
where each <code>R[,,i]</code> is a realization of the pseudo Wishart
distribution <code class="reqn">W_p(Sigma, df)</code>.
</p>


<h3>References</h3>

<p>Diaz-Garcia, Jose A, Ramon Gutierrez Jaimez, and Kanti V Mardia. 1997.
“Wishart and Pseudo-Wishart Distributions and Some Applications to
Shape Theory.”
Journal of Multivariate Analysis 63 (1): 73–87. <a href="https://doi.org/10.1006/jmva.1997.1689">doi:10.1006/jmva.1997.1689</a>.
</p>
<p>Bodnar, T.,  Mazur, S., Podgórski, K.
"Singular inverse Wishart distribution and
its application to portfolio theory",
Journal of Multivariate Analysis, Volume 143,
2016, Pages 314-326, ISSN 0047-259X,
<a href="https://doi.org/10.1016/j.jmva.2015.09.021">doi:10.1016/j.jmva.2015.09.021</a>.
</p>
<p>Bodnar, T.,  Okhrin, Y., "Properties of the singular, inverse
and generalized inverse partitioned Wishart distributions", Journal of
Multivariate Analysis, Volume 99, Issue 10, 2008,  Pages 2389-2405,
ISSN 0047-259X, <a href="https://doi.org/10.1016/j.jmva.2008.02.024">doi:10.1016/j.jmva.2008.02.024</a>.
</p>
<p>Uhlig, Harald. "On Singular Wishart and Singular Multivariate Beta
Distributions."
Ann. Statist. 22 (1994), no. 1, 395–405. <a href="https://doi.org/10.1214/aos/1176325375">doi:10.1214/aos/1176325375</a>.
</p>


<h3>See Also</h3>

<p><code>rWishart</code>, <code>rInvWishart</code>,
and <code>rPseudoWishart</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(20181228)
A &lt;- rGenInvWishart(1L, 4L, 5.0 * diag(5L))[, , 1]
A
# A should be singular
eigen(A)$values
set.seed(20181228)
B &lt;- rPseudoWishart(1L, 4L, 5.0 * diag(5L))[, , 1]

# A should be a Moore-Penrose pseudo-inverse of B
B
# this should be equal to B
B %*% A %*% B
# this should be equal to A
A %*% B %*% A
</code></pre>


</div>