<div class="container">

<table style="width: 100%;"><tr>
<td>colour_space</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
N-dimensional colour spaces
</h2>

<h3>Description</h3>

<p>Generates a colour space based on any number of photoreceptor types and finds a colour locus for a given photoreceptor output.</p>


<h3>Usage</h3>

<pre><code class="language-R">colour_space(n, type="length", length=NA, edge=NA,
          q=rep(1,n), recep.noise=FALSE, e=NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of photoreceptor types. Function accepts any number of photoreceptor types &gt;=2. For instance, trichromatic: <code>n=3</code>; tetrachromatic: <code>n=4</code>, etc.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Whether the colour space should be built with a fixed vector length (<code>type="length"</code>), or a fixed distance between vertices (<code>type="edge"</code>; e.g. Pike 2012 and Renoult et al. 2015).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>length</code></td>
<td>
<p>Vector length used to construct the colour space. Used when <code>type="length"</code>. Typically <code>length=1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edge</code></td>
<td>
<p>Edge length used to construct the colour space. Used when <code>type="edge"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>Photoreceptor output values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>recep.noise</code></td>
<td>
<p>Whether receptor noise should be used to calculate colour locus coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>e</code></td>
<td>
<p>Vector representing photoreceptor noises. Used when <code>recep.noise=TRUE</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is used internally in colour vision models.
</p>


<h3>Value</h3>

<p>A list with the following dimensions:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coordinates</code></td>
<td>
<p>Colour locus of photoreceptor output values <code>q</code> in the colour space</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vector_matrix</code></td>
<td>
<p>Matrix of column vectors, each representing one photoreceptor type</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Felipe M. Gawryszewski <a href="mailto:f.gawry@gmail.com">f.gawry@gmail.com</a>
</p>


<h3>References</h3>

<p>Pike, T.W. 2012. Generalised chromaticity diagrams for animals with n-chromatic colour vision. Journal of Insect Behavior 255: 277-286.
</p>
<p>Renoult, J. P., A. Kelber, and H. M. Schaefer. 2015. Colour spaces in ecology and evolutionary biology. Biol Rev Camb Philos Soc, doi: 10.1111/brv.12230.
</p>


<h3>See Also</h3>

<p><code>Q</code>, <code>Qr</code>, <code>CTTKmodel</code>, <code>EMmodel</code>, <code>RNLmodel</code>, <code>GENmodel</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#A trichromatic colour space based on Endler and Mielke (2005) 
tri&lt;-colour_space(n=3, length=0.75, q=c(0.5,0.2,0.3))

#showing:
#(1) Limits of the colour space (triangle)
plot(0, ylim=c(-1,1), xlim=c(-1,1), asp=1, ylab="X2", xlab="X1", type="n")
polygon(x=tri$vector_matrix[1,], y=tri$vector_matrix[2,], lty=2)

#(2) Vectors (length=0.75) used to build the colour space (arrows)
arrows(x0=0,y0=0, x1=tri$vector_matrix[1,1], y1=tri$vector_matrix[2,1], col="red")
arrows(x0=0,y0=0, x1=tri$vector_matrix[1,2], y1=tri$vector_matrix[2,2], col="red")
arrows(x0=0,y0=0, x1=tri$vector_matrix[1,3], y1=tri$vector_matrix[2,3], col="red")

#(3) Colour loci of given photoreceptor outputs
points(x=tri$coordinates[[1]], y=tri$coordinates[[2]], pch=21, col="blue", bg="blue")
</code></pre>


</div>