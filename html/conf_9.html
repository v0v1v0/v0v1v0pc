<div class="container">

<table style="width: 100%;"><tr>
<td>crplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plotting Two-Dimensional Confidence Regions</h2>

<h3>Description</h3>

<p>Plotting a two-dimensional confidence region for probability distribution parameters (supported distribution
suffixes: cauchy, gamma, invgauss, lnorm, llogis, logis, norm, unif, weibull) corresponding to a user given
complete or right-censored dataset and level of significance.  See the CRAN website
https://CRAN.R-project.org/package=conf for a link to two <code>crplot</code> vignettes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">crplot(dataset, alpha, distn,
                cen       = rep(1, length(dataset)),
                heuristic = 1,
                maxdeg    = 5,
                ellipse_n = 4,
                pts       = TRUE,
                mlelab    = TRUE,
                sf        = NULL,
                mar       = c(4, 4.5, 2, 1.5),
                xyswap    = FALSE,
                xlab      = "",
                ylab      = "",
                main      = "",
                xlas      = 0,
                ylas      = 0,
                origin    = FALSE,
                xlim      = NULL,
                ylim      = NULL,
                tol       = .Machine$double.eps ^ 1,
                info      = FALSE,
                maxcount  = 30,
                repair    = TRUE,
                jumpshift = 0.5,
                jumpuphill = min(alpha, 0.01),
                jumpinfo  = FALSE,
                showjump  = FALSE,
                showplot  = TRUE,
                animate   = FALSE,
                delay     = 0.5,
                exact     = FALSE,
                silent    = FALSE )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dataset</code></td>
<td>
<p>a vector of n data values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>significance level; resulting plot illustrates a 100(1 - <code>alpha</code>)% confidence region.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distn</code></td>
<td>
<p>distribution to fit the dataset to; accepted values: <code>'cauchy'</code>, <code>'gamma'</code>, <code>'invgauss'</code>,
<code>'logis'</code>, <code>'llogis'</code>, <code>'lnorm'</code>, <code>'norm'</code>, <code>'unif'</code>, <code>'weibull'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cen</code></td>
<td>
<p>a vector of binary values specifying if the corresponding data values are right-censored (0), or
observed (1, default); its length must match length(dataset).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>heuristic</code></td>
<td>
<p>numeric value selecting method for plotting: 0 for elliptic-oriented point distribution, and
1 for smoothing boundary search heuristic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxdeg</code></td>
<td>
<p>maximum angle tolerance between consecutive plot segments in degrees.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ellipse_n</code></td>
<td>
<p>number of roughly equidistant confidence region points to plot using the
elliptic-oriented point distribution (must be a multiple of four because its algorithm
exploits symmetry in the quadrants of an ellipse).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pts</code></td>
<td>
<p>displays confidence region boundary points identified if <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mlelab</code></td>
<td>
<p>logical argument to include the maximum
likelihood estimate coordinate point (default is <code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sf</code></td>
<td>
<p>significant figures in axes labels specified using sf = c(x, y), where x and y represent the optional
digits argument in the R function <code>round</code> as it pertains to the horizontal and vertical labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mar</code></td>
<td>
<p>specifies margin values for <code>par(mar = c( ))</code> (see <code>mar</code> in <code>par</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xyswap</code></td>
<td>
<p>logical argument to switch the axes that the distribution parameter are shown.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>string specifying the x axis label.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>string specifying the y axis label.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>string specifying the plot title.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlas</code></td>
<td>
<p>numeric value of 0, 1, 2, or 3 specifying the style of axis labels (see <code>las</code> in <code>par</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylas</code></td>
<td>
<p>numeric value of 0, 1, 2, or 3 specifying the style of axis labels (see <code>las</code> in <code>par</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>origin</code></td>
<td>
<p>logical argument to include the plot origin (default is <code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>two-element vector containing horizontal axis minimum and maximum values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>two-element vector containing vertical axis minimum and maximum values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>the <code>uniroot</code> parameter specifying its required accuracy.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>info</code></td>
<td>
<p>logical argument to return plot information: MLE is returned as a list; (x, y) plot point coordinates
and corresponding phi angles (with respect to MLE) are returned as a list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxcount</code></td>
<td>
<p>integer value specifying the number of smoothing search iterations before terminating with <code>maxdeg</code> not met.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>repair</code></td>
<td>
<p>logical argument to repair regions inaccessible using a radial angle from its MLE due to multiple
roots at select <code class="reqn">\phi</code> angles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jumpshift</code></td>
<td>
<p>see vignette "conf Advanced Options" for details; location (as a fractional value between 0 and 1) along the
vertical or horizontal "gap" (near an uncharted region) to locate a jump-center toward; can be either a scalar value (uniformly
applied to all jump-centers) or vector of length four (with unique values for its respective quadrants, relative to the MLE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jumpuphill</code></td>
<td>
<p>see vignette "conf Advanced Options" for details; significance level increase to <code>alpha</code> for the jump-center
(corresponds to an "uphill" location on its likelihood function); can be either a scalar value (uniformly applied to all jump-centers)
or vector of length four (with unique values for its respective quadrants, relative to the MLE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jumpinfo</code></td>
<td>
<p>logical argument to return plot info (see <code>info</code> argument) and jump-center info; returned within 'repair'
attribute are <code>jumpuphill</code> value, <code>jumpshift</code> value, "|" or "-" gap type, jump-center(s) coordinates, and coordinates
of points left &amp; right of the inaccessible region.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showjump</code></td>
<td>
<p>logical argument specifying if jump-center repair reference points appear on the confidence region plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showplot</code></td>
<td>
<p>logical argument specifying if a plot is output; altering from its default of <code>TRUE</code> is
only logical assuming <code>crplot</code> is run for its data only (see the <code>info</code> argument).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>animate</code></td>
<td>
<p>logical argument specifying if an animated plot build will display; the annimation sequence is given in successive plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delay</code></td>
<td>
<p>numeric value of delay (in seconds) between successive plots when <code>animate = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exact</code></td>
<td>
<p>logical argument specifying if alpha value is adjusted to compensate for negative coverage bias to achieve
(1 - alpha) coverage probability using previously recorded Monte Carlo simulation results; available for limited values of
alpha (roughly &lt;= 0.2–0.3), n (typically n = 4, 5, ..., 50) and distributions (distn suffixes: weibull, llogis, norm).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>logical argument specifying if console output should be suppressed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function plots a confidence region for a variety of two-parameter distributions.  It requires:
</p>

<ul>
<li>
<p> a vector of dataset values,
</p>
</li>
<li>
<p> the level of significance (alpha), and
</p>
</li>
<li>
<p> a population distribution to fit the data to.
</p>
</li>
</ul>
<p>Plots display according to probability density function parameterization given later in this section.
Two heuristics (and their associated combination) are available to plot confidence regions.  Along
with their descriptions, they are:
</p>

<ol>
<li> <p><em>Smoothing Boundary Search Heuristic (default)</em>.  This heuristic plots more points in areas of
greater curvature to ensure a smooth appearance throughout the confidence region boundary.  Its
<code>maxdeg</code> parameter specifies the maximum tolerable angle between three successive points.
Lower values of <code>maxdeg</code> result in smoother plots, and its default value of 5 degrees
provides adequate smoothing in most circumstances.  Values of <code>maxdeg</code> <code class="reqn">\le</code> 3 are not
recommended due to their complicating implications to trigonometric numerical approximations near 0
and 1; their use may result in plot errors.
</p>
</li>
<li> <p><em>Elliptic-Oriented Point Distribution</em>.  This heuristic allows the user to specify
a number of points to plot along the confidence region boundary at roughly uniform intervals.
Its name is derived from the technique it uses to choose these points—an extension of the Steiner
generation of a non-degenerate conic section, also known as the parallelogram method—which identifies
points along an ellipse that are approximately equidistant.  To exploit the computational benefits of
ellipse symmetry over its four quadrants, <code>ellipse_n</code> value must be divisible by four.</p>
</li>
</ol>
<p>By default, <code>crplot</code> implements the smoothing boundary search heuristic.  Alternatively,
the user can plot using the elliptic-oriented point distribution algorithm, or a combination
of them both.  Combining the two techniques initializes the plot using the elliptic-oriented point
distribution algorithm, and then subsequently populates additional points in areas of high curvature
(those outside of the maximum angle tolerance parameterization) in accordance with the smoothing
boundary search heuristic.  This combination results when the smoothing boundary search heuristic
is specified in conjunction with an <code>ellipse_n</code> value greater than four.
</p>
<p>Both of the aforementioned heuristics use a radial profile log likelihood function to identify
points along the confidence region boundary.  It cuts the log likelihood function in a directional
azimuth from its MLE, and locates the associated confidence region boundary point using the
asymptotic results associated with the ratio test statistic <code class="reqn">-2 [\log L(\theta) - \log L(\hat{\theta})]</code>
which converges in distribution to the chi-square distribution with two degrees of freedom (for
a two parameter distribution).
</p>
<p>The default axes convention in use by <code>crplot</code> are
</p>

<table>
<tr>
<td style="text-align: left;">
</td>
<td style="text-align: center;"> Horizontal </td>
<td style="text-align: center;"> Vertical</td>
</tr>
<tr>
<td style="text-align: left;">
Distribution  </td>
<td style="text-align: center;">  Axis  </td>
<td style="text-align: center;"> Axis</td>
</tr>
<tr>
<td style="text-align: left;">
Cauchy </td>
<td style="text-align: center;"> <code class="reqn">a</code> </td>
<td style="text-align: center;"> <code class="reqn">s</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
gamma </td>
<td style="text-align: center;"> <code class="reqn">\theta</code> </td>
<td style="text-align: center;"> <code class="reqn">\kappa</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
inverse Gaussian </td>
<td style="text-align: center;"> <code class="reqn">\mu</code> </td>
<td style="text-align: center;"> <code class="reqn">\lambda</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
log logistic </td>
<td style="text-align: center;"> <code class="reqn">\lambda</code> </td>
<td style="text-align: center;"> <code class="reqn">\kappa</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
log normal </td>
<td style="text-align: center;"> <code class="reqn">\mu</code> </td>
<td style="text-align: center;"> <code class="reqn">\sigma</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
logistic </td>
<td style="text-align: center;"> <code class="reqn">\mu</code> </td>
<td style="text-align: center;"> <code class="reqn">\sigma</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
normal </td>
<td style="text-align: center;"> <code class="reqn">\mu</code> </td>
<td style="text-align: center;"> <code class="reqn">\sigma</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
uniform </td>
<td style="text-align: center;"> <code class="reqn">a</code> </td>
<td style="text-align: center;"> <code class="reqn">b</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
Weibull </td>
<td style="text-align: center;"> <code class="reqn">\kappa</code> </td>
<td style="text-align: center;"> <code class="reqn">\lambda</code>
</td>
</tr>
</table>
<p>where each respective distribution is defined below.
</p>

<ul>
<li>
<p> The Cauchy distribution
for the real-numbered location parameter <code class="reqn">a</code>, scale parameter <code class="reqn">s</code>, and <code class="reqn">x</code> is a real number,
has the probability density function
</p>
<p style="text-align: center;"><code class="reqn">1 / (s \pi (1 + ((x - a) / s) ^ 2)).</code>
</p>

</li>
<li>
<p> The gamma distribution
for shape parameter <code class="reqn">\kappa &gt; 0</code>, scale parameter <code class="reqn">\theta &gt; 0</code>, and <code class="reqn">x &gt; 0</code>,
has the probability density function
</p>
<p style="text-align: center;"><code class="reqn">1 / (Gamma(\kappa) \theta ^ \kappa) x ^ {(\kappa - 1)} exp(-x / \theta).</code>
</p>

</li>
<li>
<p> The inverse Gaussian distribution
for mean <code class="reqn">\mu &gt; 0</code>, shape parameter <code class="reqn">\lambda &gt; 0</code>, and <code class="reqn">x &gt; 0</code>,
has the probability density function
</p>
<p style="text-align: center;"><code class="reqn">\sqrt (\lambda / (2 \pi x ^ 3)) exp( - \lambda (x - \mu) ^ 2 / (2 \mu ^ 2 x)).</code>
</p>

</li>
<li>
<p> The log logistic distribution
for scale parameter <code class="reqn">\lambda &gt; 0</code>, shape parameter <code class="reqn">\kappa &gt; 0</code>, and <code class="reqn">x \ge 0</code>,
has a probability density function
</p>
<p style="text-align: center;"><code class="reqn">(\kappa \lambda) (x \lambda) ^ {(\kappa - 1)} / (1 + (\lambda x) ^ \kappa) ^ 2.</code>
</p>

</li>
<li>
<p> The log normal distribution
for the real-numbered mean <code class="reqn">\mu</code> of the logarithm, standard deviation <code class="reqn">\sigma &gt; 0</code>
of the logarithm, and <code class="reqn">x &gt; 0</code>,
has the probability density function
</p>
<p style="text-align: center;"><code class="reqn">1 / (x \sigma \sqrt(2 \pi)) exp(-(\log x - \mu) ^ 2 / (2 \sigma ^ 2)).</code>
</p>

</li>
<li>
<p> The logistic distribution
for the real-numbered location parameter <code class="reqn">\mu</code>, scale parameter <code class="reqn">\sigma</code>, and <code class="reqn">x</code> is a real number,
has the probability density function
</p>
<p style="text-align: center;"><code class="reqn">(1 / \sigma) exp((x - \mu) / \sigma) (1 + exp((x - \mu) / \sigma)) ^ {-2}</code>
</p>

</li>
<li>
<p> The normal distribution
for the real-numbered mean <code class="reqn">\mu</code>, standard deviation <code class="reqn">\sigma &gt; 0</code>, and <code class="reqn">x</code> is a real number,
has the probability density function
</p>
<p style="text-align: center;"><code class="reqn">1 / \sqrt (2 \pi \sigma ^ 2) exp(-(x - \mu) ^ 2 / (2 \sigma ^ 2)).</code>
</p>

</li>
<li>
<p> The uniform distribution for real-valued parameters <code class="reqn">a</code> and <code class="reqn">b</code> where <code class="reqn">a &lt; b</code>
and <code class="reqn">a \le x \le b</code>,
has the probability density function
</p>
<p style="text-align: center;"><code class="reqn">1 / (b - a).</code>
</p>

</li>
<li>
<p> The Weibull distribution
for scale parameter <code class="reqn">\lambda &gt; 0</code>, shape parameter <code class="reqn">\kappa &gt; 0</code>, and <code class="reqn">x &gt; 0</code>,
has the probability density function
</p>
<p style="text-align: center;"><code class="reqn">\kappa (\lambda ^ \kappa) x ^ {(\kappa - 1)} exp(-(\lambda x) ^ \kappa).</code>
</p>

</li>
</ul>
<h3>Value</h3>

<p>If the optional argument <code>info = TRUE</code> is included then a list is returned with:
</p>

<ul>
<li>
<p> parm1*: a vector containing the associated confidence region boundary values for parameter 1
</p>
</li>
<li>
<p> parm2*: a vector containing the associated confidence region boundary values for parameter 2
</p>
</li>
<li>
<p> phi: a vector containing the angles used
</p>
</li>
<li>
<p> parm1hat*: the MLE for parameter 1
</p>
</li>
<li>
<p> parm2hat*: the MLE for parameter 2
</p>
</li>
</ul>
<p>*Note: "param1" and "param2" are placeholders that will be replaced with the appropriate parameter names
based on the probability distribution.
</p>


<h3>Author(s)</h3>

<p>Christopher Weld (<a href="mailto:ceweld241@gmail.com">ceweld241@gmail.com</a>)
</p>
<p>Lawrence Leemis (<a href="mailto:leemis@math.wm.edu">leemis@math.wm.edu</a>)
</p>


<h3>References</h3>

<p>A. Jaeger (2016), "Computation of Two- and Three-Dimensional Confidence Regions with the Likelihood Ratio",
The American Statistician, 49, 48–53.
</p>
<p>C. Weld, A. Loh, L. Leemis (2020), "Plotting Two-Dimensional Confidence Regions",
The American Statistician, Volume 72, Number 2, 156–168.
</p>


<h3>See Also</h3>

<p><code>coversim</code>, <code>uniroot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## plot the 95% confidence region for Weibull shape and scale parameters
## corresponding to the given ballbearing dataset
ballbearing &lt;- c(17.88, 28.92, 33.00, 41.52, 42.12, 45.60, 48.48, 51.84,
                 51.96, 54.12, 55.56, 67.80, 68.64, 68.64, 68.88, 84.12,
                 93.12, 98.64, 105.12, 105.84, 127.92, 128.04, 173.40)
crplot(dataset = ballbearing, distn = "weibull", alpha = 0.05)

## repeat this plot using the elliptic-oriented point distribution heuristic
crplot(dataset = ballbearing, distn = "weibull", alpha = 0.05,
       heuristic = 0, ellipse_n = 80)

## combine the two heuristics, compensating any elliptic-oriented point verticies whose apparent
## angles &gt; 6 degrees with additional points, and expand the plot area to include the origin
crplot(dataset = ballbearing, distn = "weibull", alpha = 0.05,
       maxdeg = 6, ellipse_n = 80, origin = TRUE)

## next use the inverse Gaussian distribution and show no plot points
crplot(dataset = ballbearing, distn = "invgauss", alpha = 0.05,
       pts = FALSE)
</code></pre>


</div>