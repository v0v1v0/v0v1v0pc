<div class="container">

<table style="width: 100%;"><tr>
<td>conditional_probabilities</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Computes the conditional probabilities of a categorical time series</h2>

<h3>Description</h3>

<p><code>conditional_probabilities</code> returns a matrix with the conditional
probabilities of a categorical time series
</p>


<h3>Usage</h3>

<pre><code class="language-R">conditional_probabilities(series, lag = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>series</code></td>
<td>
<p>An object of type <code>tsibble</code> (see R package <code>tsibble</code>), whose column named Value
contains the values of the corresponding CTS. This column must be of class <code>factor</code> and its levels
must be determined by the range of the CTS.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lag</code></td>
<td>
<p>The considered lag (default is 1).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given a CTS of length <code class="reqn">T</code> with range <code class="reqn">\mathcal{V}=\{1, 2, \ldots, r\}</code>,
<code class="reqn">\overline{X}_t=\{\overline{X}_1,\ldots, \overline{X}_T\}</code>, the function computes the
matrix <code class="reqn">\widehat{\boldsymbol P}^c(l) = \big(\widehat{p}^c_{ij}(l)\big)_{1 \le i, j \le r}</code>,
with <code class="reqn">\widehat{p}^c_{ij}(l)=\frac{TN_{ij}(l)}{(T-l)N_i}</code>, where
<code class="reqn">N_i</code> is the number of elements equal to <code class="reqn">i</code> in the realization <code class="reqn">\overline{X}_t</code> and <code class="reqn">N_{ij}(l)</code> is the number
of pairs <code class="reqn">(\overline{X}_t, \overline{X}_{t-l})=(i,j)</code> in the realization <code class="reqn">\overline{X}_t</code>.
</p>


<h3>Value</h3>

<p>A matrix with the conditional probabilities.
</p>


<h3>Author(s)</h3>

<p>Ángel López-Oriona, José A. Vilar
</p>


<h3>References</h3>


<p>Weiß CH, Göb R (2008).
“Measuring serial dependence in categorical time series.”
<em>AStA Advances in Statistical Analysis</em>, <b>92</b>, 71–89.
</p>



<h3>Examples</h3>

<pre><code class="language-R">sequence_1 &lt;- GeneticSequences[which(GeneticSequences$Series==1),]
matrix_cp &lt;- conditional_probabilities(series = sequence_1) # Computing the matrix of
# joint probabilities for the first series in dataset GeneticSequences
</code></pre>


</div>