<div class="container">

<table style="width: 100%;"><tr>
<td>crm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>A function for the continued reassessment method (CRM) used in Phase I clinical trials</h2>

<h3>Description</h3>

<p>Function crm implement the continued reassessment method (CRM) for dose
finding in Phase I clinical trials. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">crm(target,prior,ptdata,model=1,a0=1,b=3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>
<p>Target probability of toxicity. The value must be in (0, 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>Prior probabilities of toxicity for each dose.
The values must be in (0,1) and in an ascending order.  For
example, prior=c(0.05,0.1,0.2,0.3,0.5,0.7),which corresponds to dose
levels 1, 2, 3, 4, 5 and 6,respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ptdata</code></td>
<td>
<p>A n by 2 matrix in which the first column contains dose
levels and the second column contains toxicity indicators.  Dose levels
must be integers (e.g., 1, 2, 3, ..., N).  Toxicity indicators must be
0 and 1, where 0 indicates no toxicity and 1 indicates toxicity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Dose-toxicity model.  The value must be 1 (hyperbolic
tangent model) or 2 (one-parameter logistic model).  Default is 1.
Hyperbolic tangent model: $p(y=1|x,a) = ((tanh(x)+1)/2)^a$.
One-parameter logistic model: $p(y=1|x,a,b) = exp(b+ax)/(1+exp(b+ax))$.
For both models, y=1 indicates toxicity is observed; a is the
parameter that can be updated based on the outcome of the trail;
b is a fixed parameter. The prior for a is exp(-a).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a0</code></td>
<td>
<p>Initial value for parameter a.  Default is 1.0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>A fixed parameter for the one-parameter logistic model.
Default is 3.0.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the following two objects:  
</p>
<table>
<tr style="vertical-align: top;">
<td><code>MTD</code></td>
<td>
<p>The dose level proposed as the maximum tolerated dose (MTD) based on the patient data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>The updated value for parameter a</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Qianxing Mo; <a href="mailto:qianxing.mo@moffitt.org">qianxing.mo@moffitt.org</a></p>


<h3>References</h3>

<p>John O'Quigley, Margaret Pepe,and Lloyd Fisher. (1990). Continual
Reassessment Method: A Practical Design for Phase 1 Clinical Trials in Cancer.
<em>Biometrics</em>, 46, pp.33-48
</p>


<h3>See Also</h3>

<p><code>crmsim</code>, <code>crmsiminc1</code>, <code>crmsiminc2</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
#The table 1 in O'Quingley et al.'s paper, page 40
#This example is used to illustrate how the program is used to find
#the MTD and the updated parameter 
 
target &lt;- 0.2
prior &lt;- c(0.05,0.1,0.2,0.3,0.5,0.7)
x &lt;- c(3,4,4,3,3,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1)
y &lt;- c(0,0,1,0,1,1,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,1,0,1,1)
ptdata &lt;- cbind(x,y)
for(i in 1:25){
  if(i == 1){
    cat(1,1,3,0,"\n")
  }
  res &lt;- crm(target,prior,ptdata[1:i,],model=1,a0=1)
  if(i &lt; 25){
    cat(i+1,res$a,res$MTD,ptdata[i+1,2],"\n")
  }else {
    cat(i+1,res$a,res$MTD,"\n")
  }
}

#the proposed MTD is
res$MTD

</code></pre>


</div>