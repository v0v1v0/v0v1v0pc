<div class="container">

<table style="width: 100%;"><tr>
<td>warpDLM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Posterior Inference for warpDLM model with latent structural DLM</h2>

<h3>Description</h3>

<p>This function outputs posterior quantities and forecasts from a univariate
warpDLM model. Currently two latent DLM specifications are supported:
local level and the local linear trend.
</p>


<h3>Usage</h3>

<pre><code class="language-R">warpDLM(
  y,
  type = c("level", "trend"),
  transformation = c("np", "identity", "log", "sqrt", "pois", "neg-bin"),
  y_max = Inf,
  R0 = 10,
  nsave = 5000,
  nburn = 5000,
  nskip = 1,
  n.ahead = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>the count-valued time series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>the type of latent DLM (must be either level or trend)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transformation</code></td>
<td>
<p>transformation to use for the latent process (default is np);
must be one of
</p>

<ul>
<li>
<p> "identity" (identity transformation)
</p>
</li>
<li>
<p> "log" (log transformation)
</p>
</li>
<li>
<p> "sqrt" (square root transformation)
</p>
</li>
<li>
<p> "np" (nonparametric transformation estimated from empirical CDF)
</p>
</li>
<li>
<p> "pois" (transformation for moment-matched marginal Poisson CDF)
</p>
</li>
<li>
<p> "neg-bin" (transformation for moment-matched marginal Negative Binomial CDF)
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_max</code></td>
<td>
<p>a fixed and known upper bound for all observations; default is <code>Inf</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R0</code></td>
<td>
<p>the variance for the initial state theta_0; default is 10</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsave</code></td>
<td>
<p>number of MCMC iterations to save</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nburn</code></td>
<td>
<p>number of MCMC iterations to discard</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nskip</code></td>
<td>
<p>number of MCMC iterations to skip between saving iterations,
i.e., save every (nskip + 1)th draw</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.ahead</code></td>
<td>
<p>number of steps to forecast ahead</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the following elements:
</p>

<ul>
<li> <p><code>V_post</code>: posterior draws of the observation variance
</p>
</li>
<li> <p><code>W_post</code>: posterior draws of the state update variance(s)
</p>
</li>
<li> <p><code>fc_post</code>: draws from the forecast distribution (of length n.ahead)
</p>
</li>
<li> <p><code>post_pred</code>: draws from the posterior predictive distribution of <code>y</code>
</p>
</li>
<li> <p><code>g_func</code>: transformation function
</p>
</li>
<li> <p><code>g_inv_func</code>: inverse transformation function
</p>
</li>
<li> <p><code>KFAS_mod</code>: the final KFAS model representing the latent DLM
</p>
</li>
</ul>
</div>