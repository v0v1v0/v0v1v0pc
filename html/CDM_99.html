<div class="container">

<table style="width: 100%;"><tr>
<td>eval_likelihood</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Evaluation of Likelihood
</h2>

<h3>Description</h3>

<p>The function <code>eval_likelihood</code> evaluates the likelihood given item
responses and item response probabilities.
</p>
<p>The function <code>prep_data_long_format</code> stores the matrix of
item responses in a long format omitted all missing responses.
</p>


<h3>Usage</h3>

<pre><code class="language-R">eval_likelihood(data, irfprob, prior=NULL, normalization=FALSE, N=NULL)

prep_data_long_format(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>Dataset containing item responses in wide format or long format
(generated by <code>prep_data_long_format</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>irfprob</code></td>
<td>

<p>Array containing item responses probabilities, format
see <code>IRT.irfprob</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>

<p>Optional prior (matrix or vector)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalization</code></td>
<td>

<p>Logical indicating whether posterior should be normalized
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Number of persons (optional)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Numeric matrix
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
#############################################################################
# EXAMPLE 1: Likelihood data.ecpe
#############################################################################

data(data.ecpe, package="CDM")
dat &lt;- data.ecpe$dat[,-1]
Q &lt;- data.ecpe$q.matrix

#*** store data matrix in long format
data_long &lt;- CDM::prep_data_long_format(data)
str(data_long)

#** estimate GDINA model
mod &lt;- CDM::gdina(dat, q.matrix=Q)
summary(mod)

#** extract data, item response functions and prior
data &lt;- CDM::IRT.data(mod)
irfprob &lt;- CDM::IRT.irfprob(mod)
prob_theta &lt;- attr( irfprob, "prob.theta")

#** compute likelihood
lmod &lt;- CDM::eval_likelihood(data=data, irfprob=irfprob)
max( abs( lmod - CDM::IRT.likelihood(mod) ))

#** compute posterior
pmod &lt;- CDM::eval_likelihood(data=data, irfprob=irfprob, prior=prob.theta,
            normalization=TRUE)
max( abs( pmod - CDM::IRT.posterior(mod) ))

## End(Not run)
</code></pre>


</div>