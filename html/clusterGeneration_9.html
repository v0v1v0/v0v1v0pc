<div class="container">

<table style="width: 100%;"><tr>
<td>plot2DProjection</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>PLOT A PAIR OF CLUSTERS ALONG A 2-D PROJECTION SPACE</h2>

<h3>Description</h3>

<p>Plot a pair of clusters along a 2-D projection space. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot2DProjection(
		 y1, 
		 y2, 
		 projDir, 
                 sepValMethod = c("normal", "quantile"), 
                 iniProjDirMethod = c("SL", "naive"), 
                 projDirMethod = c("newton", "fixedpoint"), 
                 xlim = NULL, 
		 ylim = NULL, 
                 xlab = "1st projection direction", 
                 ylab = "2nd projection direction", 
                 title = "Scatter plot of 2-D Projected Clusters",
                 font = 2, 
		 font.lab = 2, 
		 cex = 1.2, 
		 cex.lab = 1, 
		 cex.main = 1.5,
                 lwd = 4, 
		 lty1 = 1, 
		 lty2 = 2, 
		 pch1 = 18, 
		 pch2 = 19, 
		 col1 = 2, 
		 col2 = 4, 
                 alpha = 0.05, 
		 ITMAX = 20, 
		 eps = 1.0e-10, 
		 quiet = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y1</code></td>
<td>

<p>Data matrix of cluster 1. Rows correspond to observations. Columns correspond to variables.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y2</code></td>
<td>

<p>Data matrix of cluster 2. Rows correspond to observations. Columns correspond to variables.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>projDir</code></td>
<td>

<p>1-D projection direction along which two clusters will be projected.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sepValMethod</code></td>
<td>

<p>Method to calculate separation index for a pair of clusters projected onto a 
1-D space. <code>sepValMethod="quantile"</code> indicates the quantile version of
separation index will be used: <code class="reqn">sepVal=(L_2-U_1)/(U_2-L_1)</code> where <code class="reqn">L_i</code> and 
<code class="reqn">U_i</code>, <code class="reqn">i=1, 2</code>, are the lower and upper <code>alpha/2</code> sample percentiles 
of projected cluster <code class="reqn">i</code>. <code>sepValMethod="normal"</code> indicates the 
normal version of separation index will be used: 
<code class="reqn">sepVal=[(xbar_2-xbar_1)-z_{\alpha/2}(s_1+s_2)]/
[(xbar_2-xbar_1)+z_{\alpha/2}(s_1+s_2)]</code>, 
where <code class="reqn">xbar_i</code> and <code class="reqn">s_i</code> are the sample mean and standard deviation 
of projected cluster <code class="reqn">i</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iniProjDirMethod</code></td>
<td>

<p>Indicating the method to get initial projection direction when calculating
the separation index between a pair of clusters (c.f. Qiu and Joe,
2006a, 2006b). <br><code>iniProjDirMethod</code>=“SL” indicates the initial projection 
direction is the sample version of the SL's projection direction 
(Su and Liu, 1993)
<code class="reqn">\left(\boldsymbol{\Sigma}_1+\boldsymbol{\Sigma}_2\right)^{-1}\left(\boldsymbol{\mu}_2-\boldsymbol{\mu}_1\right)</code><br><code>iniProjDirMethod</code>=“naive” indicates the initial projection 
direction is <code class="reqn">\boldsymbol{\mu}_2-\boldsymbol{\mu}_1</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>projDirMethod</code></td>
<td>

<p>Indicating the method to get the optimal projection direction when calculating 
the separation index between a pair of clusters (c.f. Qiu and Joe,
2006a, 2006b). <br><code>projDirMethod</code>=“newton” indicates we use the Newton-Raphson 
method to search the optimal projection direction (c.f. Qiu and Joe, 2006a). 
This requires the assumptions that both covariance matrices of the pair of 
clusters are positive-definite. If this assumption is violated, the 
“fixedpoint” method could be used. The “fixedpoint” method 
iteratively searches the optimal projection direction based on the first 
derivative of the separation index to the project direction 
(c.f. Qiu and Joe, 2006b).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>

<p>Range of X axis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>

<p>Range of Y axis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>

<p>X axis label.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>

<p>Y axis label.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>

<p>Title of the plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>font</code></td>
<td>

<p>An integer which specifies which font to use for text (see <code>par</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>font.lab</code></td>
<td>

<p>The font to be used for x and y labels (see <code>par</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>

<p>A numerical value giving the amount by which plotting text
and symbols should be scaled relative to the default (see <code>par</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.lab</code></td>
<td>

<p>The magnification to be used for x and y labels relative
to the current setting of 'cex' (see <code>par</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.main</code></td>
<td>

<p>The magnification to be used for main titles relative
to the current setting of 'cex' (see <code>par</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>

<p>The line width, a positive number, defaulting to '1' (see <code>par</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty1</code></td>
<td>

<p>Line type for cluster 1 (see <code>par</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty2</code></td>
<td>

<p>Line type for cluster 2 (see <code>par</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch1</code></td>
<td>

<p>Either an integer specifying a symbol or a single character
to be used as the default in plotting points for cluster 1 (see <code>points</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch2</code></td>
<td>

<p>Either an integer specifying a symbol or a single character
to be used as the default in plotting points for cluster 2 (see <code>points</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col1</code></td>
<td>

<p>Color to indicates cluster 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col2</code></td>
<td>

<p>Color to indicates cluster 2.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>Tuning parameter reflecting the percentage in the two
tails of a projected cluster that might be outlying.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ITMAX</code></td>
<td>

<p>Maximum iteration allowed when iteratively calculating the
optimal projection direction.
The actual number of iterations is usually much less than the default value 20.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>

<p>A small positive number to check if a quantitiy <code class="reqn">q</code> is equal to zero.  
If <code class="reqn">|q|&lt;</code><code>eps</code>, then we regard <code class="reqn">q</code> as equal to zero.  
<code>eps</code> is used to check the denominator in the formula of the separation 
index is equal to zero. Zero-value denominator indicates two clusters are 
totally overlapped. Hence the separation index is set to be <code class="reqn">-1</code>.
The default value of <code>eps</code> is <code class="reqn">1.0e-10</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>

<p>A flag to switch on/off the outputs of intermediate results and/or possible warning messages. The default value is <code>TRUE</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>To get the second projection direction, we first construct an orthogonal 
matrix with first column <code>projDir</code>. Then we rotate the data points 
according to this orthogonal matrix. Next, we remove the first dimension 
of the rotated data points, and obtain the optimal projection direction 
<code>projDir2</code> for the rotated data points in the remaining dimensions. 
Finally, we rotate the vector
<code>projDir3=(0, projDir2)</code> back to the original space. 
The vector <code>projDir3</code> is the second projection direction.
</p>
<p>The ticks along X axis indicates the positions of points of the projected 
two clusters. The positions of <code class="reqn">L_i</code> and <code class="reqn">U_i</code>, <code class="reqn">i=1, 2</code>, are also indicated 
on X axis, where <code class="reqn">L_i</code> and <code class="reqn">U_i</code> are the lower and upper <code class="reqn">\alpha/2</code> sample 
percentiles of cluster <code class="reqn">i</code> if <code>sepValMethod="quantile"</code>. 
If <code>sepValMethod="normal"</code>,
<code class="reqn">L_i=xbar_i-z_{\alpha/2}s_i</code>, where <code class="reqn">xbar_i</code> and <code class="reqn">s_i</code> are the 
sample mean and standard deviation of cluster <code class="reqn">i</code>, and <code class="reqn">z_{\alpha/2}</code> 
is the upper <code class="reqn">\alpha/2</code> percentile of standard normal distribution.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sepValx</code></td>
<td>

<p>value of the separation index for the projected two clusters along the
1st projection direction.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sepValy</code></td>
<td>

<p>value of the separation index for the projected two clusters along the
2nd projection direction.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q2</code></td>
<td>

<p>1st column is the 1st projection direction. 2nd column is the 2nd
projection direction.
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Weiliang Qiu <a href="mailto:weiliang.qiu@gmail.com">weiliang.qiu@gmail.com</a><br>
Harry Joe <a href="mailto:harry@stat.ubc.ca">harry@stat.ubc.ca</a>
</p>


<h3>References</h3>

<p>Qiu, W.-L. and Joe, H. (2006a)
Generation of Random Clusters with Specified Degree of Separaion.
<em>Journal of Classification</em>, <b>23</b>(2), 315-334.
</p>
<p>Qiu, W.-L. and Joe, H. (2006b)
Separation Index and Partial Membership for Clustering.
<em>Computational Statistics and Data Analysis</em>, <b>50</b>, 585–603.
</p>


<h3>See Also</h3>

<p><code>plot1DProjection</code>
<code>viewClusters</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">n1 &lt;- 50
mu1 &lt;- c(0,0)
Sigma1 &lt;- matrix(c(2, 1, 1, 5), 2, 2)
n2 &lt;- 100
mu2 &lt;- c(10, 0)
Sigma2 &lt;- matrix(c(5, -1, -1, 2), 2, 2)
projDir &lt;- c(1,  0)

library(MASS)
set.seed(1234)
y1 &lt;- mvrnorm(n1, mu1, Sigma1)
y2 &lt;- mvrnorm(n2, mu2, Sigma2)
y &lt;- rbind(y1, y2)
cl &lt;- rep(1:2, c(n1, n2))

b &lt;- getSepProjData(
		    y = y, 
		    cl = cl, 
		    iniProjDirMethod = "SL", 
		    projDirMethod = "newton")
# projection direction for clusters 1 and 2
projDir &lt;- b$projDirArray[1,2,]

par(mfrow = c(2,1))
plot1DProjection(
		 y1 = y1, 
		 y2 = y2, 
		 projDir = projDir)
plot2DProjection(
		 y1 = y1, 
		 y2 = y2, 
		 projDir = projDir)

</code></pre>


</div>