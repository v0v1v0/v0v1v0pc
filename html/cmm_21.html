<div class="container">

<table style="width: 100%;"><tr>
<td>ModelStatistics</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>ModelStatistics</h2>

<h3>Description</h3>

<p>If fitted frequencies under a model have been calculated, this procedure can be used to give sample values,
fitted values, estimated standard errors, z-scores and adjusted residuals of one or more coefficients.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ModelStatistics(dat, fitfreq, model, coeff, CoefficientDimensions = "Automatic",
    Labels = "Automatic", Method = "ML", ShowCoefficients = TRUE, ShowParameters = FALSE, 
    ParameterCoding = "Effect", ShowCorrelations = FALSE, Title = "")</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>observed data as a list of frequencies or as a data frame</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitfreq</code></td>
<td>
<p>vector of fitted frequencies for each cell of full table (including latent variables, if any)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>list specified eg as <code>list(bt,coeff,at)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coeff</code></td>
<td>
<p>list of coefficients, can be obtained using <code>SpecifyCoefficient</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CoefficientDimensions</code></td>
<td>
<p>numeric vector of dimensions of the table in which the coefficient vector is to be arranged</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Labels</code></td>
<td>
<p>list of characters or numbers indicating labels for dimensions of table in which the coefficient vector is to be arranged</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ShowCoefficients</code></td>
<td>
<p>boolean, indicating whether or not the coefficients are to be displayed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ShowParameters</code></td>
<td>
<p>boolean, indicating whether or not the parameters (computed from the coefficients) are to be displayed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Method</code></td>
<td>
<p>character, choice of "ML" for maximum likelihood or "GSK" for the GSK method</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ParameterCoding</code></td>
<td>
<p>Coding to be used for parameters, choice of <code>"Effect"</code>, <code>"Dummy"</code> and  <code>"Polynomial"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ShowCorrelations</code></td>
<td>
<p>boolean, indicating whether or not to show the correlation matrix for the estimated coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Title</code></td>
<td>
<p>title of computation to appear at top of screen output</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The data can be a data frame or vector of frequencies. <code>MarginalModelFit</code> converts a data frame <code>dat</code> using <code>c(t(ftable(dat)))</code>.
</p>
<p>For <code>ParameterCoding</code>, the default for <code>"Dummy"</code>
is that the first cell in the table is the reference cell. Cell
<code class="reqn">(i,j,k,...)</code> can be made reference cell using
<code>list("Dummy",c(i,j,k,...))</code>. For <code>"Polynomial"</code> the
default is to use centralized scores based on equidistant (distance
1) linear scores, for example, if for <code class="reqn">i=1,2,3,4</code>,
<code class="reqn">\mu_i=\alpha+q_i\beta+r_i\gamma+s_i\delta</code> 
where <code class="reqn">\beta</code> is a quadratic, <code class="reqn">\gamma</code> a cubic and <code class="reqn">\delta</code> a 
quartic effect, then <code class="reqn">q_i</code> takes the values <code class="reqn">(-1.5,-.5,.5,1.5)</code>, 
<code class="reqn">r_i</code> takes the values <code class="reqn">(1,-1,-1,1)</code> 
(centralized squares of the <code class="reqn">q_i</code>), and <code class="reqn">s_i</code> takes the values 
<code class="reqn">(-3.375,-.125,.125,3.375)</code> (cubes of the <code class="reqn">q_i</code>).</p>


<h3>Value</h3>

<p> A subset of the output of <code>MarginalModelFit</code>. </p>


<h3>Author(s)</h3>

<p>W. P. Bergsma <a href="mailto:w.p.bergsma@lse.ac.uk">w.p.bergsma@lse.ac.uk</a>
</p>


<h3>References</h3>

<p>Bergsma, W. P. (1997).
<em>Marginal models for categorical data</em>.
Tilburg, The Netherlands: Tilburg University Press.
<a href="http://stats.lse.ac.uk/bergsma/pdf/bergsma_phdthesis.pdf">http://stats.lse.ac.uk/bergsma/pdf/bergsma_phdthesis.pdf</a>
</p>
<p>Bergsma, W. P., Croon, M. A., &amp; Hagenaars, J. A. P. (2009).
Marginal models for dependent, clustered, and longitudunal categorical data.
Berlin: Springer.
</p>


<h3>See Also</h3>

 <p><code>ModelStatistics</code>,
<code>MarginalModelFit</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
# Below an example where ModelStatistics can be used to get output for coefficients 
# not given by MarginalModelFit 

# Marginal homogeneity (MH) in a 3x3 table AB
# Note that MH is equivalent to independence in the 2x3 table of marginals IR, in which the 
# row with I=1 gives the A marginal, and the row with I=2 gives the B marginal 
n &lt;- 1 : 9
at &lt;- MarginalMatrix(c("A", "B"), list(c("A"), c("B")), c(3,3))
bt &lt;- ConstraintMatrix(c("I", "R"), list(c("I"), c("R")), c(2,3))
model &lt;- list( bt, "log", at)

#The "coefficients" for the model are the log marginal probabilities for table IR
fit &lt;- MarginalModelFit(dat = n, model = model, 
 CoefficientDimensions = c(2, 3), Labels = c("I", "R"))

#to get output for the marginal probabilities, ModelStatistics can be used as follows
spec &lt;-  SpecifyCoefficient("ConditionalProbabilities",list(c("I","R"),c("I"),c(2,3)))
coeff &lt;- list(spec, at)
stats &lt;- ModelStatistics(dat = n, fitfreq = fit$FittedFrequencies, 
 model = model, coeff = coeff, CoefficientDimensions = c(2, 3),
 Labels = c("I", "R"))
</code></pre>


</div>