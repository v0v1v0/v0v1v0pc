<div class="container">

<table style="width: 100%;"><tr>
<td>analyzeStepPairs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Find Distances and Angles for all Pairs of Steps</h2>

<h3>Description</h3>

<p>Find cell indices and timepoints where these cells both have a step, then return
angles and distances for each pair of steps.
</p>


<h3>Usage</h3>

<pre><code class="language-R">analyzeStepPairs(
  X,
  filter.steps = NULL,
  searchRadius = Inf,
  quietly = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a tracks object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filter.steps</code></td>
<td>
<p>optional: a function used to filter steps on. See examples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>searchRadius</code></td>
<td>
<p>if specified, only return analysis for pairs of steps that
start within distance searchRadius from each other</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quietly</code></td>
<td>
<p>(default FALSE) if TRUE, suppress warnings</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed on to <code>angleSteps</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Analyzing step angles at different distances can be useful to detect
directional bias or local crowding effects; see (Beltman et al, 2009).
</p>
<p>Internally, the function uses <code>stepPairs</code>, <code>angleSteps</code>,
and <code>distanceSteps</code>.
</p>


<h3>Value</h3>

<p>A dataframe with five columns: two for the indices of cellpairs that
share a step, one for the timepoint at which they do so, one for the distance
between them, and one for their angle.
</p>


<h3>References</h3>

<p>Joost B. Beltman, Athanasius F.M. Maree and Rob. J. de Boer (2009),
Analysing immune cell migration. <em>Nature Reviews Immunology</em> <b>9</b>,
789â€“798. doi:10.1038/nri2638
</p>


<h3>See Also</h3>

<p><code>analyzeCellPairs</code> to do something similar for entire tracks
rather than single steps.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Plot distance versus angle for all step pairs, filtering for those that
## displace at least 2 microns. Sample dataset in this example for speed.
pairs &lt;- analyzeStepPairs( sample( TCells, 100), filter.steps = function(t) displacement(t) &gt; 2 )
scatter.smooth( pairs$dist, pairs$angle )
</code></pre>


</div>