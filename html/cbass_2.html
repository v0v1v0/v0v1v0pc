<div class="container">

<table style="width: 100%;"><tr>
<td>fit.cbass</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit CBASS model using reversible jump MCMC</h2>

<h3>Description</h3>

<p>Fit CBASS model using reversible jump MCMC
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit.cbass(
  X,
  y,
  max.int = 3,
  max.basis = 10 * ncol(X),
  tau2 = 10,
  nmcmc = 10000,
  nburn = round(nmcmc/2),
  nthin = 10,
  h1 = 4,
  h2 = 20 * (length(unique(y)) - 1)/nrow(X),
  p.int.prior = 1/(1:max.int),
  verbose = FALSE,
  print.interval = round(nmcmc/100),
  init1 = FALSE,
  ordinal = NULL,
  writeout = FALSE,
  writedir = tempdir(),
  mod = NULL,
  restart = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>n by p matrix of inputs on unit invteral</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>n-length factor factor of categories</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.int</code></td>
<td>
<p>maximum number of interactions, default 3</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.basis</code></td>
<td>
<p>maximum number of basis functions for each latent mean function, default ncol(X)*10</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau2</code></td>
<td>
<p>prior variance of basis regression coefficients, default 10</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nmcmc</code></td>
<td>
<p>number of MCMC samples, default 1e4</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nburn</code></td>
<td>
<p>number of MCMC samples to burn, default nmcmc/2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nthin</code></td>
<td>
<p>number of samples by which to thin, default 10</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h1</code></td>
<td>
<p>first parameter for Gamma hyperprior on tau2, default 4</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h2</code></td>
<td>
<p>second parameter for Gamma hyperprior on tau2, default 20(d-1)/n</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.int.prior</code></td>
<td>
<p>prior for number of interactions, default 1/(1:max.int)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>should progress be printed out? default false</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.interval</code></td>
<td>
<p>how often should progress be printed out? default every 1%</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init1</code></td>
<td>
<p>should model be initialized with single interaction model? default FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ordinal</code></td>
<td>
<p>indicator of ordinal predictors (non-categorical), usually computed automatically</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>writeout</code></td>
<td>
<p>should samples be written out to text file? default FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>writedir</code></td>
<td>
<p>where should text files be written? default tempdir()</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mod</code></td>
<td>
<p>initial / previous model fit, default NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>restart</code></td>
<td>
<p>should initial input model be used for starting chain? default FALSE</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of CBASS model parameters. LIST THEM.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)
n &lt;- 100;  d &lt;- 3
X &lt;- matrix(runif(n*2, 0, 1), ncol=2)
mu &lt;- scale(X)
bound &lt;- qnorm(1/d^(1/(d-1)))
mu &lt;- cbind(bound, mu)
z &lt;- mu
z[,-1] &lt;- rnorm(length(mu[,-1]), mu[,-1], 1)
y &lt;- apply(z, 1, which.max)
mod &lt;- fit.cbass(X, y, max.int=1, max.basis=10, nmcmc=1e3, nburn=500, nthin=10)
pred.chain &lt;- pred.cbass(mod, X)
mu.hat &lt;- apply(pred.chain, 2:3, mean)
mean(abs(mu - mu.hat))
plot(c(mu), c(mu.hat))
</code></pre>


</div>