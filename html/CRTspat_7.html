<div class="container">

<table style="width: 100%;"><tr>
<td>CRTanalysis</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Analysis of cluster randomized trial with spillover</h2>

<h3>Description</h3>

<p><code>CRTanalysis</code> carries out a statistical analysis of a cluster randomized trial (CRT).
</p>


<h3>Usage</h3>

<pre><code class="language-R">CRTanalysis(
  trial,
  method = "GEE",
  distance = "nearestDiscord",
  scale_par = NULL,
  cfunc = "L",
  link = "logit",
  numerator = "num",
  denominator = "denom",
  excludeBuffer = FALSE,
  alpha = 0.05,
  baselineOnly = FALSE,
  baselineNumerator = "base_num",
  baselineDenominator = "base_denom",
  personalProtection = FALSE,
  clusterEffects = TRUE,
  spatialEffects = FALSE,
  requireMesh = FALSE,
  inla_mesh = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>trial</code></td>
<td>
<p>an object of class <code>"CRTsp"</code> or a data frame containing locations in (x,y) coordinates, cluster
assignments (factor <code>cluster</code>), and arm assignments (factor <code>arm</code>) and outcome data (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>statistical method with options:
</p>

<table>
<tr>
<td style="text-align: left;">
<code>"EMP"</code> </td>
<td style="text-align: left;"> simple averages of the data   </td>
</tr>
<tr>
<td style="text-align: left;">
<code>"T"</code>   </td>
<td style="text-align: left;"> comparison of cluster means by t-test </td>
</tr>
<tr>
<td style="text-align: left;">
<code>"GEE"</code> </td>
<td style="text-align: left;"> Generalised Estimating Equations </td>
</tr>
<tr>
<td style="text-align: left;">
<code>"LME4"</code> </td>
<td style="text-align: left;"> Generalized Linear Mixed-Effects Models </td>
</tr>
<tr>
<td style="text-align: left;">
<code>"INLA"</code>
</td>
<td style="text-align: left;"> Integrated Nested Laplace Approximation (INLA) </td>
</tr>
<tr>
<td style="text-align: left;">
<code>"MCMC"</code>
</td>
<td style="text-align: left;"> Markov chain Monte Carlo using <code>"JAGS"</code> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>"WCA"</code>
</td>
<td style="text-align: left;"> Within cluster analysis </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p>Measure of distance or surround with options: <br></p>

<table>
<tr>
<td style="text-align: left;">
<code>"nearestDiscord"</code> </td>
<td style="text-align: left;"> distance to nearest discordant location (km)</td>
</tr>
<tr>
<td style="text-align: left;">
<code>"disc"</code> </td>
<td style="text-align: left;"> disc</td>
</tr>
<tr>
<td style="text-align: left;">
<code>"kern"</code> </td>
<td style="text-align: left;"> surround based on sum of normal kernels</td>
</tr>
<tr>
<td style="text-align: left;">
<code>"hdep"</code> </td>
<td style="text-align: left;"> Tukey half space depth</td>
</tr>
<tr>
<td style="text-align: left;">
<code>"sdep"</code> </td>
<td style="text-align: left;"> simplicial depth</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale_par</code></td>
<td>
<p>numeric: pre-specified value of the spillover parameter or disc radius for models where this is fixed (<code>cfunc = "R"</code>).<br><br></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cfunc</code></td>
<td>
<p>transformation defining the spillover function with options:
</p>

<table>
<tr>
<td style="text-align: left;">
<code>"Z"</code> </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> arm effects not considered</td>
<td style="text-align: left;"> reference model</td>
</tr>
<tr>
<td style="text-align: left;">
<code>"X"</code> </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> spillover not modelled</td>
<td style="text-align: left;"> the only valid value of <code>cfunc</code> for methods <code>"EMP"</code>, <code>"T"</code> and <code>"GEE"</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
<code>"L"</code> </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> inverse logistic (sigmoid)</td>
<td style="text-align: left;"> the default for <code>"INLA"</code> and <code>"MCMC"</code> methods</td>
</tr>
<tr>
<td style="text-align: left;">
<code>"P"</code> </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> inverse probit (error function)</td>
<td style="text-align: left;"> available with <code>"INLA"</code> and <code>"MCMC"</code> methods</td>
</tr>
<tr>
<td style="text-align: left;">
<code>"S"</code> </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> piecewise linear</td>
<td style="text-align: left;"> only available with the <code>"MCMC"</code> method</td>
</tr>
<tr>
<td style="text-align: left;">
<code>"E"</code> </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> estimation of scale factor</td>
<td style="text-align: left;"> only available with <code>distance = "disc"</code> or <code>distance = "kern"</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
<code>"R"</code> </td>
<td style="text-align: left;"></td>
<td style="text-align: left;"> rescaled linear</td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>
<p>link function with options:
</p>

<table>
<tr>
<td style="text-align: left;">
<code>"logit"</code>
</td>
<td style="text-align: left;"> (the default). <code>numerator</code> has a binomial distribution with denominator <code>denominator</code>.</td>
</tr>
<tr>
<td style="text-align: left;">
<code>"log"</code>  </td>
<td style="text-align: left;"> <code>numerator</code> is Poisson distributed with an offset of log(<code>denominator</code>).</td>
</tr>
<tr>
<td style="text-align: left;">
<code>"cloglog"</code> </td>
<td style="text-align: left;"> <code>numerator</code> is Bernoulli distributed with an offset of log(<code>denominator</code>).</td>
</tr>
<tr>
<td style="text-align: left;">
<code>"identity"</code>
</td>
<td style="text-align: left;"> The outcome is <code>numerator/denominator</code> with a normally distributed error function.</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numerator</code></td>
<td>
<p>string: name of numerator variable for outcome</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>denominator</code></td>
<td>
<p>string: name of denominator variable for outcome data (if present)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>excludeBuffer</code></td>
<td>
<p>logical: indicator of whether any buffer zone (records with <code>buffer=TRUE</code>) should be excluded from analysis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>numeric: confidence level for confidence intervals and credible intervals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>baselineOnly</code></td>
<td>
<p>logical: indicator of whether required analysis is of effect size or of baseline only</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>baselineNumerator</code></td>
<td>
<p>string: name of numerator variable for baseline data (if present)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>baselineDenominator</code></td>
<td>
<p>string: name of denominator variable for baseline data (if present)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>personalProtection</code></td>
<td>
<p>logical: indicator of whether the model includes local effects with no spillover</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clusterEffects</code></td>
<td>
<p>logical: indicator of whether the model includes cluster random effects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spatialEffects</code></td>
<td>
<p>logical: indicator of whether the model includes spatial random effects
(available only for <code>method = "INLA"</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>requireMesh</code></td>
<td>
<p>logical: indicator of whether spatial predictions are required
(available only for <code>method = "INLA"</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inla_mesh</code></td>
<td>
<p>string: name of pre-existing INLA input object created by <code>compute_mesh()</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>CRTanalysis</code> is a wrapper for the statistical analysis packages:
<a href="https://CRAN.R-project.org/package=geepack">geepack</a>,
<a href="https://www.r-inla.org/">INLA</a>,
<a href="https://CRAN.R-project.org/package=jagsUI">jagsUI</a>,
and the <a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/t.test">t.test</a>
function of package <code>stats</code>.<br><br>
The wrapper does not provide an interface to the full functionality of these packages.
It is specific for typical analyses of cluster randomized trials with geographical clustering. Further details
are provided in the <a href="https://thomasasmith.github.io/articles/Usecase5.html">vignette</a>.<br><br>
The key results of the analyses can be extracted using a <code>summary()</code> of the output list.
The <code>model_object</code> in the output list is the usual output from the statistical analysis routine,
and can be also be inspected with <code>summary()</code>, or analysed using <code>stats::fitted()</code>
for purposes of evaluation of model fit etc..<br><br>
For models with a complementary log-log link function specified with <code>link = "cloglog"</code>.
the numerator must be coded as 0 or 1. Technically the binomial denominator is then 1.
The value of <code>denominator</code> is used as a rate multiplier.<br><br>
With the <code>"INLA"</code> and <code>"MCMC"</code> methods 'iid' random effects are used to model extra-Poisson variation.<br><br>
Interval estimates for the coefficient of variation of the cluster level outcome are calculated using the method of
<a href="https://www.jstor.org/stable/2685039">Vangel (1996)</a>.
</p>


<h3>Value</h3>

<p>list of class <code>CRTanalysis</code> containing the following results of the analysis:
</p>

<ul>
<li> <p><code>description</code> : description of the dataset
</p>
</li>
<li> <p><code>method</code> : statistical method
</p>
</li>
<li> <p><code>pt_ests</code> : point estimates
</p>
</li>
<li> <p><code>int_ests</code> : interval estimates
</p>
</li>
<li> <p><code>model_object</code> : object returned by the fitting routine
</p>
</li>
<li> <p><code>spillover</code> : function values and statistics describing the estimated spillover
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">
example &lt;- readdata('exampleCRT.txt')
# Analysis of test dataset by t-test
exampleT &lt;- CRTanalysis(example, method = "T")
summary(exampleT)
# Standard GEE analysis of test dataset ignoring spillover
exampleGEE &lt;- CRTanalysis(example, method = "GEE")
summary(exampleGEE)
# LME4 analysis with error function spillover function
exampleLME4 &lt;- CRTanalysis(example, method = "LME4", cfunc = "P")
summary(exampleLME4)

</code></pre>


</div>