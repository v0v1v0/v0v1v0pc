<div class="container">

<table style="width: 100%;"><tr>
<td>sdm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Structural Dynamic Model (alias Structural Growth Model) </h2>

<h3>Description</h3>

<p>This function computes the general equilibrium and simulates the economic dynamics. The key part of this function is an exchange function (see <code>F_Z</code>), which is expounded in Li (2010, 2019).
</p>


<h3>Usage</h3>

<pre><code class="language-R">sdm(
  A,
  B = diag(nrow(A)),
  n = nrow(B),
  m = ncol(B),
  S0Exg = matrix(NA, n, m),
  p0 = matrix(1, nrow = n, ncol = 1),
  z0 = matrix(100, nrow = m, ncol = 1),
  GRExg = NA,
  moneyOwnerIndex = NULL,
  moneyIndex = NULL,
  pExg = NULL,
  tolCond = 1e-5,
  maxIteration = 200,
  numberOfPeriods = 300,
  depreciationCoef = 0.8,
  thresholdForPriceAdjustment = 0.99,
  priceAdjustmentMethod = "variable",
  priceAdjustmentVelocity = 0.15,
  trace = TRUE,
  ts = FALSE,
  policy = NULL,
  exchangeFunction = F_Z
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>a demand coefficient n-by-m matrix (alias demand structure matrix) or a function A(state) which returns an n-by-m matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>a supply coefficient n-by-m matrix (alias supply structure matrix) or a function which returns an n-by-m matrix. If (i,j)-th element of S0Exg is not NA, the value of the (i,j)-th element of B will be useless and ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>the number of commodities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>the number of economic agents (or sectors).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S0Exg</code></td>
<td>
<p>an initial exogenous supply n-by-m matrix. This matrix may contain NA, but not zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p0</code></td>
<td>
<p>an initial price n-vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z0</code></td>
<td>
<p>an m-vector consisting of the initial exchange levels (i.e. activity levels, production levels or utility levels).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GRExg</code></td>
<td>
<p>an exogenous growth rate of the exogenous supplies in S0Exg. If GRExg is NA and some commodities have exogenous supply, then GRExg will be set to 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>moneyOwnerIndex</code></td>
<td>
<p>a vector consisting of the indices of agents supplying money.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>moneyIndex</code></td>
<td>
<p>a vector consisting of the commodity indices of all types of money.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pExg</code></td>
<td>
<p>an n-vector indicating the exogenous prices (if any).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tolCond</code></td>
<td>
<p>the tolerance condition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxIteration</code></td>
<td>
<p>the maximum iteration count. If the main purpose of running this function is to do simulation instead of calculating equilibrium, then maxIteration should be set to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numberOfPeriods</code></td>
<td>
<p>the period number in each iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>depreciationCoef</code></td>
<td>
<p>the depreciation coefficient (i.e. 1 minus the depreciation rate) of the unsold products.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresholdForPriceAdjustment</code></td>
<td>
<p>the threshold for the fixed percentage price adjustment method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>priceAdjustmentMethod</code></td>
<td>
<p>the price adjustment method. Normally it should be set to "variable". If it is set to "fixed", a fixed percentage price adjustment method will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>priceAdjustmentVelocity</code></td>
<td>
<p>the price adjustment velocity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>if TRUE, information is printed during the running of sdm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ts</code></td>
<td>
<p>if TRUE, the time series of the last iteration are returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>policy</code></td>
<td>
<p>a policy function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exchangeFunction</code></td>
<td>
<p>the exchange function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The parameters A may be a function A(state) wherein state is a list consisting of p (the price vector), z (the output and utility vector), w (the wealth vector), t (the time) and e (the foreign exchange rate vector if any). state indicates the states at time t.
</p>
<p>The parameters B also may be a function B(state) wherein state is a list consisting of p (the price vector), z (the output and utility vector) and t (the time).
</p>


<h3>Value</h3>

<p>sdm returns a list containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>tolerance</code></td>
<td>
<p>the tolerance of the results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>equilibrium prices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>equilibrium exchange levels (i.e. activity levels, output levels or utility levels).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>the equilibrium supply matrix at the initial period.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>e</code></td>
<td>
<p>equilibrium foreign exchange rates in a multi-money economy.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>growthRate</code></td>
<td>
<p>the endogenous equilibrium growth rate in a pure production economy.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>the equilibrium demand coefficient matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>If B is a function, the equilibrium supply coefficient matrix is returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ts.p</code></td>
<td>
<p>the time series of prices in the last iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ts.z</code></td>
<td>
<p>the time series of exchange levels (i.e. activity levels, production levels or utility levels) in the last iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ts.S</code></td>
<td>
<p>the time series of supply matrix in the last iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ts.q</code></td>
<td>
<p>the time series of sales rates in the last iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ts.e</code></td>
<td>
<p>the time series of foreign exchange rates in the last iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>policy.data</code></td>
<td>
<p>the policy data.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>LI Wu &lt;liwu@staff.shu.edu.cn&gt;
</p>


<h3>References</h3>

<p>LI Wu (2019, ISBN: 9787521804225) General Equilibrium and Structural Dynamics: Perspectives of New Structural Economics. Beijing: Economic Science Press. (In Chinese)
</p>
<p>LI Wu (2010) A Structural Growth Model and its Applications to Sraffa's System. http://www.iioa.org/conferences/18th/papers/files/104_20100729011_AStructuralGrowthModelanditsApplicationstoSraffasSstem.pdf
</p>
<p>Torres, Jose L. (2016, ISBN: 9781622730452) Introduction to Dynamic Macroeconomic General Equilibrium Models (Second Edition). Vernon Press.
</p>
<p>Varian, Hal R. (1992, ISBN: 0393957357) Microeconomic Analysis. W. W. Norton &amp; Company.
</p>


<h3>See Also</h3>

<p><code>iep</code>;
<code>Example2.2</code>;
<code>Example2.3</code>;
<code>Example.Section.3.1.2.corn</code>;
<code>Example3.1</code>;
<code>Example3.2</code>;
<code>Example3.4</code>;
<code>Example3.8</code>;
<code>Example3.9</code>;
<code>Example3.10</code>;
<code>Example3.12</code>;
<code>Example3.14</code>;
<code>Example4.2</code>;
<code>Example4.8</code>;
<code>Example4.9</code>;
<code>Example4.10</code>;
<code>Example4.11.1</code>;
<code>Example4.11.2</code>;
<code>Example4.12</code>;
<code>Example4.13</code>;
<code>Example4.15</code>;
<code>Example4.16</code>;
<code>Example5.1</code>;
<code>Example5.2</code>;
<code>Example5.3.2</code>;
<code>Example5.4</code>;
<code>Example5.5</code>;
<code>Example5.6</code>;
<code>Example5.10</code>;
<code>Example5.11.1</code>;
<code>Example5.11.2</code>;
<code>Example6.2.1</code>;
<code>Example6.2.2</code>;
<code>Example6.3</code>;
<code>Example6.4</code>;
<code>Example6.5</code>;
<code>Example6.6.1</code>;
<code>Example6.6.2</code>;
<code>Example6.6.3</code>;
<code>Example6.7</code>;
<code>Example6.9</code>;
<code>Example6.10</code>;
<code>Example6.11</code>;
<code>Example7.1</code>;
<code>Example7.2</code>;
<code>Example7.3</code>;
<code>Example7.4</code>;
<code>Example7.5.1</code>;
<code>Example7.5.2</code>;
<code>Example7.6</code>;
<code>Example7.7</code>;
<code>Example7.8</code>;
<code>Example7.9X</code>;
<code>Example7.10</code>;
<code>Example7.10.2</code>;
<code>Example7.11</code>;
<code>Example7.12</code>;
<code>Example7.13</code>;
<code>Example7.14</code>;
<code>Example7.15</code>;
<code>Example8.1</code>;
<code>Example8.2</code>;
<code>Example8.7</code>;
<code>Example8.8</code>;
<code>Example8.9</code>;
<code>Example9.3</code>;
<code>Example9.4</code>;
<code>Example9.5</code>;
<code>Example9.6</code>;
<code>Example9.7</code>;
<code>Example9.10</code>;
</p>


<h3>Examples</h3>

<pre><code class="language-R">## the example on page 352 in Varian (1992)
ge &lt;- sdm(
  A = function(state) {
    a &lt;- 0.5

    alpha &lt;- rep(1, 3)
    Beta &lt;- matrix(c(0,   a,   a,
                     0.5, 0,   0,
                     0.5, 1 - a, 1 - a), 3, 3, TRUE)

    #the demand coefficient matrix.
    CD_A(alpha, Beta, state$p)
  },
  B = diag(3),
  S0Exg = matrix(c(NA, NA, NA,
                   NA, 1, NA,
                   NA, NA, 1), 3, 3, TRUE),
  GRExg = 0,
  tolCond = 1e-10
)

ge$p/ge$p[1]


## the example (see Table 2.1 and 2.2) of the canonical dynamic
## macroeconomic general equilibrium model in Torres (2016).
discount.factor &lt;- 0.97
return.rate &lt;- 1 / discount.factor - 1
depreciation.rate &lt;- 0.06

ge &lt;- sdm(
  n = 4, m = 3,
  A = function(state) {
    a1 &lt;- CD_A(1, rbind(0, 0.65, 0.35, 0), state$p)
    a2 &lt;- CD_A(1, rbind(0.4, 1 - 0.4, 0, 0), state$p)
    a3 &lt;- c(1, 0, 0, state$p[1] * return.rate / state$p[4])
    cbind(a1, a2, a3)
  },
  B = matrix(c(
    1, 0, 1 - depreciation.rate,
    0, 1, 0,
    0, 0, 1,
    0, 1, 0
  ), 4, 3, TRUE),
  S0Exg = {
    tmp &lt;- matrix(NA, 4, 3)
    tmp[2, 2] &lt;- 1
    tmp[4, 2] &lt;- 1
    tmp
  },
  priceAdjustmentVelocity = 0.03,
  maxIteration = 1,
  numberOfPeriods = 5000,
  ts = TRUE
)

ge$A %*% diag(ge$z) # the demand matrix
ge$p / ge$p[1]

plot(ge$ts.z[, 1], type = "l")
</code></pre>


</div>