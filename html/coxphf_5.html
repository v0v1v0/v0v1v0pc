<div class="container">

<table style="width: 100%;"><tr>
<td>coxphfplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot the Penalized Profile Likelhood Function</h2>

<h3>Description</h3>

<p>Plots the penalized profile likelihood for a specified parameter.
</p>


<h3>Usage</h3>

<pre><code class="language-R">coxphfplot(
  formula,
  data,
  profile,
  pitch = 0.05,
  limits,
  alpha = 0.05,
  maxit = 50,
  maxhs = 5,
  epsilon = 1e-06,
  maxstep = 0.5,
  firth = TRUE,
  penalty = 0.5,
  adapt = NULL,
  legend = "center",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula object, with the response on the left of the  operator, and the
model terms on the right. The response must be a survival object as returned by the 'Surv' function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data.frame in which to interpret the variables named in the 'formula' argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>profile</code></td>
<td>
<p>a righthand formula specifying the plotted parameter, interaction or general term, e.g. <code>~ A</code> or <code>~ A : C</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pitch</code></td>
<td>
<p>distances between the interpolated points in standard errors of the parameter estimate, the default value is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>limits</code></td>
<td>
<p>the range of the x-axis in terms of standard errors from the parameter estimate. The default values 
are the extremes of both confidence intervals, Wald and PL, plus or minus half a
standard error, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>the significance level (1-<code class="reqn">\alpha</code> the confidence level, 0.05 as default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>maximum number of iterations (default value is 50)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxhs</code></td>
<td>
<p>maximum number of step-halvings per iterations (default value is 5). 
The increments of the parameter vector in one Newton-Rhaphson iteration step are halved, 
unless the new likelihood is greater than the old one, maximally doing <code>maxhs</code> halvings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>specifies the maximum allowed change in penalized log likelihood to declare convergence. Default value is 0.0001.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxstep</code></td>
<td>
<p>specifies the maximum change of (standardized) parameter values allowed in one iteration. Default value is 2.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>firth</code></td>
<td>
<p>use of Firth's penalized maximum likelihood (<code>firth=TRUE</code>, default) or the standard maximum likelihood method (<code>firth=FALSE</code>) for fitting the Cox model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty</code></td>
<td>
<p>optional: specifies a vector of 1s and 0s, where 0 means that the corresponding parameter is fixed at 0, while 1 enables 
parameter estimation for that parameter. The length of adapt must be equal to the number of parameters to be estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adapt</code></td>
<td>
<p>strength of Firth-type penalty. Defaults to 0.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>
<p>if FALSE, legends in the plot would be omitted (default is TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other parameters to legend</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function plots the profile (penalized) log likelihood of the specified parameter. A symmetric shape of 
the profile (penalized) log likelihood (PPL) function allows use of Wald intervals, while an
asymmetric shape demands profile (penalized) likelihood intervals (Heinze &amp; Schemper (2001)).
</p>


<h3>Value</h3>

<p>A matrix of dimension <code class="reqn">m \times 3</code>, with <code class="reqn">m = 1/\code{pitch} + 1</code>. 
With the default settings, <code class="reqn">m=101</code>. The column headers are:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>std</code></td>
<td>
<p>the distance from the parameter estimate in standard errors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>the parameter value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log-likelihood</code></td>
<td>
<p>the profile likelihood at <code>x</code></p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Georg Heinze and Meinhard Ploner
</p>


<h3>References</h3>

<p>Firth D (1993). Bias reduction of maximum likelihood estimates. <em>Biometrika</em> 80:27–38.
</p>
<p>Heinze G and Schemper M (2001). A Solution to the Problem of Monotone Likelihood in Cox Regression. <em>Biometrics</em> 57(1):114–119. 
</p>
<p>Heinze G (1999). Technical Report 10/1999: The application of Firth's procedure to Cox and logistic regression. Section of Clinical Biometrics, Department of Medical Computer Sciences, University of Vienna, Vienna.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(survival)
time&lt;-c(1,2,3)
cens&lt;-c(1,1,1)
x&lt;-c(1,1,0)
sim&lt;-cbind(time,cens,x)
sim&lt;-data.frame(sim)
profplot&lt;-coxphfplot(sim, formula=Surv(time,cens)~x, profile=~x)

</code></pre>


</div>