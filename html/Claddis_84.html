<div class="container">

<table style="width: 100%;"><tr>
<td>read_nexus_matrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Reads in a morphological #NEXUS data file</h2>

<h3>Description</h3>

<p>Reads in a morphological data file in #NEXUS format.
</p>


<h3>Usage</h3>

<pre><code class="language-R">read_nexus_matrix(file_name, equalize_weights = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>file_name</code></td>
<td>
<p>The file name or path of the #NEXUS file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>equalize_weights</code></td>
<td>
<p>Optional that overrides the weights specified in the file to make all characters truly equally weighted.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Reads in a #NEXUS (Maddison et al. 1997) data file representing the distribution of characters (continuous, discrete, DNA etc.) in a set of taxa. Unlike read.nexus.data this function can handle polymorphisms (e.g., <code>(012)</code>).
</p>
<p>Note that the function is generally intolerant to excursions from a standard format and it is recommended your data be formatted like the <code>morphmatrix.nex</code> example below. However, the function also produces informative error messages if (expected) excursions are discovered.
</p>
<p>Previously all empty values (missing or inapplicable) were treated as NAs. But now anything coded as a "gap" now appears as an empty text string ("") in the matrix. Additionally, previously polymorphisms and uncertianties were both considered as polymorphisms with multiple states separated by an ampersand ("&amp;"), but now polymorphisms use the ampersand ("&amp;") and uncertainties use a slash ("/"), allowing for different treatment later and correct outputting when writing to #NEXUS format. (NB: TNT does not allow this distinction and so both polymorphisms and uncertainties will be output as polymorphisms.)
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>topper</code></td>
<td>
<p>Contains any header text or costmatrices and pertains to the entire file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>matrix_N</code></td>
<td>
<p>One or more matrix blocks (numbered 1 to N) with associated information pertaining only to that matrix block. This includes the block name (if specificed, NA if not), the block datatype (one of "CONTINUOUS", "DNA", "NUCLEOTIDE", "PROTEIN", "RESTRICTION", "RNA", or "STANDARD"), the actual matrix (taxa as rows, names stored as rownames and characters as columns), the ordering type of each character (<code>"ordered"</code>, <code>"unordered"</code>), the character weights, the minimum and maximum values (used by Claddis' distance functions), and the original characters (symbols, missing, and gap values) used for writing out the data.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Graeme T. Lloyd <a href="mailto:graemetlloyd@gmail.com">graemetlloyd@gmail.com</a>
</p>


<h3>References</h3>

<p>Maddison, D. R., Swofford, D. L. and Maddison, W. P., 1997. NEXUS: an extensible file format for systematic information. <em>Systematic Biology</em>, <b>46</b>, 590-621.
</p>


<h3>See Also</h3>

<p>build_cladistic_matrix, compactify_cladistic_matrix, prune_cladistic_matrix, safe_taxonomic_reduction, write_nexus_matrix, write_tnt_matrix
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Create example matrix
example_matrix &lt;- paste("#NEXUS", "", "BEGIN DATA;",
                        "\tDIMENSIONS  NTAX=5 NCHAR=5;",
                        "\tFORMAT SYMBOLS= \" 0 1 2\" MISSING=? GAP=- ;",
                        "MATRIX", "", "Taxon_1  010?0", "Taxon_2  021?0",
                        "Taxon_3  02111", "Taxon_4  011-1",
                        "Taxon_5  001-1", ";", "END;", "",
                        "BEGIN ASSUMPTIONS;",
                        "\tOPTIONS  DEFTYPE=unord PolyTcount=MINSTEPS ;",
                        "\tTYPESET * UNTITLED  = unord: 1 3-5, ord: 2;",
                        "\tWTSET * UNTITLED  = 1: 2, 2: 1 3-5;",
                        "END;", sep = "\n")

# Write example matrix to current working directory called
# "morphmatrix.nex":
cat(example_matrix, file = "morphmatrix.nex")

# Read in example matrix:
morph.matrix &lt;- read_nexus_matrix("morphmatrix.nex")

# View example matrix in R:
morph.matrix

# Remove the generated data set:
file.remove("morphmatrix.nex")

</code></pre>


</div>