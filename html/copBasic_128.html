<div class="container">

<table style="width: 100%;"><tr>
<td>rmseCOP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Root Mean Square Error between a Fitted Copula and an Empirical Copula</h2>

<h3>Description</h3>

<p>Compute the <em>root mean square error</em> <code class="reqn">\mathrm{RMSE}_\mathbf{C}</code> (Chen and Guo, 2019, p. 29), which is computed using <em>mean square error</em> <code class="reqn">\mathrm{MSE}</code> as
</p>
<p style="text-align: center;"><code class="reqn">\mathrm{MSE}_\mathbf{C} = \frac{1}{n}\sum_{i=1}^n \bigl(\mathbf{C}_n(u_i,v_i) - \mathbf{C}_{\Theta_m}(u_i, v_i)\bigr)^2\mbox{ and}</code>
</p>

<p style="text-align: center;"><code class="reqn">\mathrm{RMSE}_\mathbf{C} = \sqrt{\mathrm{MSE}_\mathbf{C}}\mbox{,}</code>
</p>

<p>where <code class="reqn">\mathbf{C}_n(u_i,v_i)</code> is the <em>empirical copula</em> (empirical joint probability) for the <code class="reqn">i</code>th observation, <code class="reqn">\mathbf{C}_{\Theta_m}(u_i, v_i)</code> is the fitted copula having <code class="reqn">m</code> parameters in <code class="reqn">\Theta</code>. The <code class="reqn">\mathbf{C}_n(u_i,v_i)</code> comes from <code>EMPIRcop</code>. The <code class="reqn">\mathrm{RMSE}_\mathbf{C}</code> is in effect saying that the best copula will have its joint probabilities plotting on a 1:1 line with the empirical joint probabilities, which is an <code class="reqn">\mathrm{RMSE}_\mathbf{C}=0</code>. From the <code class="reqn">\mathrm{MSE}_\mathbf{C}</code> shown above, the <em>Akaike information criterion</em> (AIC) <code>aicCOP</code> and <em>Bayesian information criterion</em> (BIC) <code>bicCOP</code> can be computed, which add a penalty for <code class="reqn">m</code> parameters. These goodness-of-fits can assist in deciding one copula favorability over another, and another goodness-of-fit using the absolute differences between <code class="reqn">\mathbf{C}_n(u,v)</code> and <code class="reqn">\mathbf{C}_{\Theta_m}(u, v)</code> is found under <code>statTn</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rmseCOP(u, v=NULL, cop=NULL, para=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>Nonexceedance probability <code class="reqn">u</code> in the <code class="reqn">X</code> direction;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>Nonexceedance probability <code class="reqn">v</code> in the <code class="reqn">Y</code> direction; If not given, then a second column from argument <code>u</code> is attempted;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cop</code></td>
<td>
<p>A copula function;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>para</code></td>
<td>
<p>Vector of parameters or other data structure, if needed, to pass to the copula; and</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to pass to either copula (likely most commonly to the empirical copula).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The value for <code class="reqn">\mathrm{RMSE}_\mathbf{C}</code> is returned.
</p>


<h3>Author(s)</h3>

<p>W.H. Asquith</p>


<h3>References</h3>

<p>Chen, Lu, and Guo, Shenglian, 2019, Copulas and its application in hydrology and water resources: Springer Nature, Singapore, ISBN 978–981–13–0574–0.
</p>


<h3>See Also</h3>

<p><code>EMPIRcop</code>, <code>aicCOP</code>, <code>bicCOP</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
S &lt;- simCOP(80, cop=GHcop, para=5) # Simulate some probabilities, but we
# must then treat these as data and recompute empirical probabilities.
U &lt;- lmomco::pp(S$U, sort=FALSE); V &lt;- lmomco::pp(S$V, sort=FALSE)
# The parent distribution is Gumbel-Hougaard extreme value copula.
# But in practical application we do not know that but say we speculate that
# perhaps the Galambos extreme value might be the parent. Then maximum
# likelihood is used to fit the single parameter.
pGL &lt;- mleCOP(U,V, cop=GLcop, interval=c(0,20))$par

rmses &lt;- c(rmseCOP(U,V, cop=GLcop, para=pGL),
           rmseCOP(U,V, cop=P),
           rmseCOP(U,V, cop=PSP))
names(rmses) &lt;- c("GLcop", "P", "PSP")
print(rmses) # We will see that the first RMSE is the smallest as the
# Galambos has the nearest overall behavior than the P and PSP copulas.
## End(Not run)
</code></pre>


</div>