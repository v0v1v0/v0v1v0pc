<div class="container">

<table style="width: 100%;"><tr>
<td>FindSummedProbabilityDistribution</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Find the summed probability distribution (SPD) for a set of radiocarbon observations</h2>

<h3>Description</h3>

<p>Takes a set of radiocarbon determinations and uncertainties, independently
calibrates each one, and then averages the resultant calendar age estimates
to give the SPD estimate. <br><br><strong>Important:</strong> This function should not be used for inference as SPDs are not statistically rigorous.
Instead use either of:
</p>

<ul>
<li>
<p> the Bayesian non-parametric summarisation approaches PolyaUrnBivarDirichlet
or WalkerBivarDirichlet;
</p>
</li>
<li>
<p> or the Poisson process rate approach PPcalibrate
</p>
</li>
</ul>
<p>The SPD function provided here is only intended for comparison. We provide a inbuilt plotting option to show the SPD alongside the
determinations and the calibration curve. <br><br></p>


<h3>Usage</h3>

<pre><code class="language-R">FindSummedProbabilityDistribution(
  calendar_age_range_BP,
  rc_determinations,
  rc_sigmas,
  calibration_curve,
  F14C_inputs = FALSE,
  resolution = 1,
  plot_output = FALSE,
  plot_cal_age_scale = "BP",
  interval_width = "2sigma",
  bespoke_probability = NA,
  denscale = 3,
  plot_pretty = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>calendar_age_range_BP</code></td>
<td>
<p>A vector of length 2 with the start and end
calendar age BP to calculate the SPD over. These two values must be in order
with start value less than end value, e.g., (600, 1700) cal yr BP.
The code will extend this range (by 400 cal yrs each side) for conservativeness</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rc_determinations</code></td>
<td>
<p>A vector of observed radiocarbon determinations. Can be provided either as
<code class="reqn">{}^{14}</code>C ages (in <code class="reqn">{}^{14}</code>C yr BP) or as F<code class="reqn">{}^{14}</code>C concentrations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rc_sigmas</code></td>
<td>
<p>A vector of the (1-sigma) measurement uncertainties for the
radiocarbon determinations. Must be the same length as <code>rc_determinations</code> and
given in the same units.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>calibration_curve</code></td>
<td>
<p>A dataframe which must contain one column <code>calendar_age_BP</code>, and also
columns <code>c14_age</code> and <code>c14_sig</code> or <code>f14c</code> and <code>f14c_sig</code> (or both sets).
This format matches the curves supplied with this package, e.g., intcal20,
intcal13, which contain all 5 columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>F14C_inputs</code></td>
<td>
<p><code>TRUE</code> if the provided <code>rc_determinations</code> are F<code class="reqn">{}^{14}</code>C
concentrations and <code>FALSE</code> if they are radiocarbon ages. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resolution</code></td>
<td>
<p>The distance between the calendar ages at which to calculate the calendar age probability.
Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_output</code></td>
<td>
<p><code>TRUE</code> if you wish to plot the determinations, the calibration curve,
and the SPD on the same plot. Defaults to <code>FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_cal_age_scale</code></td>
<td>
<p>Only for usage when <code>plot_output = TRUE</code>.
The calendar scale to use for the x-axis. Allowed values are "BP", "AD" and "BC". The default
is "BP", corresponding to plotting in cal yr BP.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interval_width</code></td>
<td>
<p>Only for usage when <code>plot_output = TRUE</code>. The confidence intervals to show for the
calibration curve. Choose from one of "1sigma" (68.3%), "2sigma" (95.4%) and "bespoke". Default is "2sigma".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bespoke_probability</code></td>
<td>
<p>The probability to use for the confidence interval
if "bespoke" is chosen above. E.g. if 0.95 is chosen, then the 95% confidence
interval is calculated. Ignored if "bespoke" is not chosen.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>denscale</code></td>
<td>
<p>Whether to scale the vertical range of the calendar age density plot
relative to the calibration curve plot (optional). Default is 3 which means
that the maximum SPD will be at 1/3 of the height of the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_pretty</code></td>
<td>
<p>logical, defaulting to <code>TRUE</code>. If set <code>TRUE</code> then will select pretty plotting
margins (that create sufficient space for axis titles and rotates y-axis labels). If <code>FALSE</code> will
implement current user values.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A data frame with one column <code>calendar_age_BP</code> containing the calendar
ages, and the other column <code>probability</code> containing the probability at that
calendar age
</p>


<h3>See Also</h3>

<p>PolyaUrnBivarDirichlet,
WalkerBivarDirichlet for rigorous non-parametric Bayesian alternatives; and
PPcalibrate for a rigorous variable-rate Poisson process alternative.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># An example using 14C age BP and the IntCal 20 curve
SPD &lt;- FindSummedProbabilityDistribution(
   calendar_age_range_BP=c(400, 1700),
   rc_determinations=c(602, 805, 1554),
   rc_sigmas=c(35, 34, 45),
   calibration_curve=intcal20)
plot(SPD, type = "l",
   xlim = rev(range(SPD$calendar_age_BP)),
   xlab = "Calendar Age (cal yr BP)")

# Using the inbuilt plotting features
SPD &lt;- FindSummedProbabilityDistribution(
   calendar_age_range_BP=c(400, 1700),
   rc_determinations=c(602, 805, 1554),
   rc_sigmas=c(35, 34, 45),
   calibration_curve=intcal20,
   plot_output = TRUE,
   interval_width = "bespoke",
   bespoke_probability = 0.8)

# An different example using F14C concentrations and the IntCal 13 curve
SPD &lt;- FindSummedProbabilityDistribution(
   calendar_age_range_BP=c(400, 2100),
   rc_determinations=c(0.8, 0.85, 0.9),
   rc_sigmas=c(0.01, 0.015, 0.012),
   F14C_inputs=TRUE,
   calibration_curve=intcal13)
plot(SPD, type = "l",
   xlim = rev(range(SPD$calendar_age_BP)),
   xlab = "Calendar Age (cal yr BP)")
</code></pre>


</div>