<div class="container">

<table style="width: 100%;"><tr>
<td>composite3COP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>(Extended) Composition of Two Copulas with Four Compositing Parameters</h2>

<h3>Description</h3>

<p>The <em>(extended) composition of two copulas</em>  (Salvadori <em>et al.</em>, 2006, p. 266, prop. C.4) provides for even more sophisticated structures of dependence between variables than two-copula composition in <code>composite2COP</code>. Let <code class="reqn">\mathbf{A}</code> and <code class="reqn">\mathbf{B}</code> be copulas with respective parameters <code class="reqn">\Theta_\mathbf{A}</code> and <code class="reqn">\Theta_\mathbf{B}</code>, then
</p>
<p style="text-align: center;"><code class="reqn">\mathbf{C}_{\alpha,\beta,\kappa,\gamma}(u,v) = u^\kappa v^\gamma \cdot
                              \mathbf{A}([u^{1-\kappa}]^\alpha,    [v^{1-\gamma}]^\beta) \cdot
                              \mathbf{B}([u^{1-\kappa}]^{1-\alpha},[v^{1-\gamma}]^{1-\beta})\mbox{,}</code>
</p>

<p>defines a family of copulas <code class="reqn">\mathbf{C}_{\alpha,\beta,\kappa,\gamma}</code> with <b>four</b> <em>compositing parameters</em> <code class="reqn">\alpha,\beta,\kappa,\gamma \in (0,1)</code>.
</p>
<p>It is important to stress that copulas <code class="reqn">\mathbf{A}_{\Theta_A}</code> and <code class="reqn">\mathbf{B}_{\Theta_B}</code> can be of different families and each parameterized accordingly by the vectors of parameters <code class="reqn">\Theta_A</code> and <code class="reqn">\Theta_B</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">composite3COP(u, v, para, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>Nonexceedance probability <code class="reqn">u</code> in <code class="reqn">X</code> direction;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>Nonexceedance probability <code class="reqn">v</code> in <code class="reqn">Y</code> direction;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>para</code></td>
<td>
<p>A special parameter <code>list</code> (see <b>Note</b>); and</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to pass to <code>composite2COP</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A value for the composited copula is returned.
</p>


<h3>Note</h3>

<p>The following descriptions list in detail the structure and content of the <code>para</code> argument:
</p>

<dl>
<dt><code>alpha</code></dt>
<dd>
<p>— The <code class="reqn">\alpha</code> compositing parameter;</p>
</dd>
<dt><code>beta</code></dt>
<dd>
<p>— The <code class="reqn">\beta</code> compositing parameter;</p>
</dd>
<dt><code>kappa</code></dt>
<dd>
<p>— The <code class="reqn">\kappa</code> compositing parameter;</p>
</dd>
<dt><code>gamma</code></dt>
<dd>
<p>— The <code class="reqn">\gamma</code> compositing parameter;</p>
</dd>
<dt><code>cop1</code></dt>
<dd>
<p>— Function of the first copula <code class="reqn">\mathbf{A}</code>;</p>
</dd>
<dt><code>cop2</code></dt>
<dd>
<p>— Function of the second copula <code class="reqn">\mathbf{B}</code>;</p>
</dd>
<dt><code>para1</code></dt>
<dd>
<p>— Vector of parameters <code class="reqn">\Theta_\mathbf{A}</code> for <code class="reqn">\mathbf{A}</code>; and</p>
</dd>
<dt><code>para2</code></dt>
<dd>
<p>— Vector of parameters <code class="reqn">\Theta_\mathbf{B}</code> for <code class="reqn">\mathbf{B}</code>.</p>
</dd>
</dl>
<p>The first example produces two plots. These are extremely informative for many nuances of copula theory. Whereas it is difficult in prose to describe, users are strongly encouraged that once full understanding of connection of red and green between the easier to understand bivariate plot and the plot showing the sections and derivatives of the sections is achieved that much of copula theory will be mastered—get a copy of Nelsen (2006) and (or) Salvadori <em>et al.</em> (2007).

</p>


<h3>Author(s)</h3>

<p>W.H. Asquith</p>


<h3>References</h3>

<p>Nelsen, R.B., 2006, An introduction to copulas: New York, Springer, 269 p.
</p>
<p>Salvadori, G., De Michele, C., Kottegoda, N.T., and Rosso, R., 2007, Extremes in Nature—An approach using copulas: Springer, 289 p.
</p>


<h3>See Also</h3>

<p><code>COP</code>, <code>breveCOP</code>, <code>simCOP</code>, <code>composite1COP</code>, <code>composite2COP</code>, <code>convexCOP</code>, <code>glueCOP</code>, <code>simcomposite3COP</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
para &lt;- list(cop1=PLACKETTcop, cop2=N4212cop,
             para1=10^(runif(1,min=-5,max=5)), para2=runif(1,min=1,max=100),
             alpha=runif(1), beta=runif(1), kappa=runif(1), gamma=runif(1))
txts &lt;- c("Alpha=",    round(para$alpha,    digits=4),
          "; Beta=",   round(para$beta,     digits=4),
          "; Kappa=",  round(para$kappa,    digits=4),
          "; Gamma=",  round(para$gamma,    digits=4),
          "; Theta1=", round(para$para1[1], digits=5),
          "; Theta2=", round(para$para2[1], digits=2))
layout(matrix(1:2, byrow=TRUE))
D &lt;- simCOP(n=300, cop=composite3COP, para=para, cex=0.5, col=rgb(0,0,0,0.2), pch=16)
mtext(paste(txts,collapse=""))

f &lt;- round(runif(1),digits=2)
ftxt &lt;- c("Sectionals (thick) and derivatives (thin) at f=",f," nonexceedance prob.")
segments(f,0,f,1, col=3, lwd=2); segments(0,f,1,f, col=2, lwd=2)
t &lt;- sectionCOP(f,cop=composite3COP,para=para, col=3, lwd=4)
t &lt;- sectionCOP(f,cop=composite3COP,para=para, dercop=TRUE, ploton=FALSE,col=3)
t &lt;- sectionCOP(f,cop=composite3COP,para=para, wrtV=TRUE,   ploton=FALSE,col=2,lwd=4)
t &lt;- sectionCOP(f,cop=composite3COP,para=para, wrtV=TRUE,   ploton=FALSE,col=2,
                  dercop=TRUE)
mtext(paste(ftxt, collapse=""))#
## End(Not run)
</code></pre>


</div>