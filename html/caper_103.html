<div class="container">

<table style="width: 100%;"><tr>
<td>phylo.d</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculates the phylogenetic D statistic</h2>

<h3>Description</h3>

<p>Calculates the D value, a measure of phylogenetic signal in a binary trait, and tests the estimated D value for significant departure from both random association and the clumping expected under a Brownian evolution threshold model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">phylo.d(data, phy, names.col, binvar, permut = 1000, rnd.bias=NULL)
## S3 method for class 'phylo.d'
print(x, ...)
## S3 method for class 'phylo.d'
summary(object, ...)
## S3 method for class 'phylo.d'
plot(x, bw=0.02, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A 'comparative.data' or 'data.frame' object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phy</code></td>
<td>
<p>An object of class 'phylo', required when data is not a 'comparative.data' object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>names.col</code></td>
<td>
<p>A name specifying the column in 'data' that matches rows to tips in 'phy', required when data is not a 'comparative.data' object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binvar</code></td>
<td>
<p>The name of the variable in <code>data</code> holding the binary variable of interest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>permut</code></td>
<td>
<p>Number of permutations to be used in the randomisation test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rnd.bias</code></td>
<td>
<p>An optional name of a variable in <code>data</code> holding probability weights to bias the generation of the random distribution. See 'destails'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class 'phylo.d'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of class 'phylo.d'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw</code></td>
<td>
<p>The bandwidth to be used for the density plots</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to print and summary methods</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The sum of changes in estimated nodal values of a binary trait along edges in a phylogeny (D) provides a measure of the phylogenetic signal in that trait (Fritz and Purvis, 2010). If a trait is highly conserved, with only a basal division between two clades expressing either trait value, then the only change will be along the two daughters at the root. This will give a summed value of 1: the two differences between the root nodal value of 0.5 and the ancestors of the 1 and 0 clades. In contrast, if the trait is labile, more differences will be observed and the sum will be higher.
</p>
<p>This function calculates the observed D for a binary trait on a tree and compares this to the value of D found using an equal number of simulations under each of two models:
</p>

<dl>
<dt>Phylogenetic randomness</dt>
<dd>
<p>Trait values are randomly shuffled relative to the tips of the phylogeny and D is calculated.</p>
</dd>
<dt>Brownian threshold model</dt>
<dd>
<p>A continuous trait is evolved along the phylogeny under a Brownian process and then converted to a binary trait using a threshold that reproduces the relative prevalence of the observed trait.</p>
</dd>
</dl>
<p>The value of D depends on phylogeny size - more sister clades yield higher sums - and so the means of the  two sets of simulated data are used as calibrations to scale both observed and simulated values of D to set points of 0 (as phylogenetically conserved as expected under a Brownian threshold model) and 1 (random). The value of D can be both smaller than 0 (highly conserved) and greater than 1 (overdispersed) and the distributions of scaled D from the simulations are used to assess the significance of the observed scaled D. The <code>plot</code> method generates density plots of the distributions of the two simulations relative to the observed D value.
</p>
<p><code>rnd.bias</code> is passed to <code>sample</code> as the <code>prob</code> argument to weight the random shuffles of the observed trait. The weights are not checked for validity.</p>


<h3>Value</h3>

<p>Returns an object of class 'phylo.d', which is a list of the following:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>DEstimate</code></td>
<td>
<p>The estimated D value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pval1</code></td>
<td>
<p>A p value, giving the result of testing whether D is significantly different from one</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pval0</code></td>
<td>
<p>A p value, giving the result of testing whether D is significantly different from zero</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Parameters</code></td>
<td>
<p>A list of the Observed, MeanRandom and MeanBrownian sums of sister-clade differences</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Permutations</code></td>
<td>
<p>A list with elements random and brownian, containing the sums of sister-clade differences from random permutations and simulations of Brownian evolution under a threshold model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NodalVals</code></td>
<td>
<p>A list with the elements observed, random and brownian, containing the nodal values estimated for the observed trait and permutations. The values are as matrices with rows labelled by the node names in the comparative data object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binvar</code></td>
<td>
<p>The binary variable used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phyName</code></td>
<td>
<p>The name of the phylogeny object used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dsName</code></td>
<td>
<p>The name of the dataframe used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nPermut</code></td>
<td>
<p>The number of permutations used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rnd.bias</code></td>
<td>
<p>If a bias was introduced to the calculation of the random distribution, the bias used, else <code>NULL</code></p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Susanne Fritz &lt;Susanne.Fritz@senckenberg.de&gt; and David Orme</p>


<h3>References</h3>

<p>Fritz, S. A. and Purvis, A. (2010). Selectivity in mammalian extinction risk and threat types: a new measure of phylogenetic signal strength in binary traits. Conservation Biology, 24(4):1042-1051.</p>


<h3>Examples</h3>

<pre><code class="language-R">data(BritishBirds)
BritishBirds &lt;- comparative.data(BritishBirds.tree, BritishBirds.data, binomial)
redPhyloD &lt;- phylo.d(BritishBirds, binvar=Red_list)
print(redPhyloD)
plot(redPhyloD)
</code></pre>


</div>