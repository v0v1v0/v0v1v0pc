<div class="container">

<table style="width: 100%;"><tr>
<td>findWhenUnneeded</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Determine the code block after which a variable can be explicitly
removed</h2>

<h3>Description</h3>

<p>These functions analyze the meta-information about code blocks
and determine when a variable is no longer needed and
can add code to the relevant code block to remove the variable. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">findWhenUnneeded(var, frags, info = lapply(frags, getInputs), simplify,
                 index = TRUE, end = NA, redefined = FALSE)
addRemoveIntermediates(doc, frags = readScript(doc),
                       info = getInputs(frags),
                       vars = getVariables(info))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>
<p>the name of the variable(s) whose final </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>doc</code></td>
<td>
<p>the
location of the script, given as a file name or a connection</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frags</code></td>
<td>
<p>an object of class <code>Script</code> which is a list containing
the code blocks in the script. This is typically obtained via a call to
<code>readScript</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>info</code></td>
<td>
<p>an object of class
<code>ScriptInfo</code> which is a list of <code>ScriptNodeInfo</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simplify</code></td>
<td>
<p>ignored</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>
<p>a logical value indicating whether
<code>findWhenUnneeded</code> should return the indices of the code
blocks/fragments or the code fragments themselves.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vars</code></td>
<td>
<p>the
names of all the variables of interest</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>end</code></td>
<td>
<p>the value to use if
the variable is used in the last code block, i.e. the end of the
script.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>redefined</code></td>
<td>
<p>a logical value which controls whether we
return the earliest code block in which the variable is redefined rather
than when the variable is no longer used.  Redefinition is a kind of
"no longer being used" but for the value, not the variable.  </p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A vector of indices indicating the last expression in which each of
the specified  variables is an input.
</p>


<h3>Author(s)</h3>

<p>Duncan Temple Lang</p>


<h3>See Also</h3>

<p><code>readScript</code>
<code>addRemoveIntermediates</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">f = system.file("samples", "cleanVars.R", package = "CodeDepends")
sc = readScript(f)
findWhenUnneeded("x", sc)
findWhenUnneeded(c("x", "y"), sc)  

# z is never used
findWhenUnneeded("z", sc)
findWhenUnneeded("z", sc, end = 1L)  

code = addRemoveIntermediates(f)
 # Note that rm(x), rm(y) and rm(d) are added.
code[c(4, 5, 6)]
</code></pre>


</div>