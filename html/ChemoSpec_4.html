<div class="container">

<table style="width: 100%;"><tr>
<td>aovPCAscores</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot ANOVA-PCA Scores from a Spectra Object</h2>

<h3>Description</h3>

<p>Uses the results from <code>aov_pcaSpectra</code> to plot the scores.
Argument <code>submat</code> is used to select PCA results from among those
stored in argument <code>PCA</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">aovPCAscores(
  spectra,
  so,
  submat = 1,
  ellipse = "none",
  tol = "none",
  use.sym = FALSE,
  leg.loc = "topright",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>spectra</code></td>
<td>
<p>An object of S3 class <code>Spectra()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>so</code></td>
<td>
<p><em>List</em> of pca results created by <code>aov_pcaSpectra</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>submat</code></td>
<td>
<p>Integer.  Selects list element <code>submat</code> from <code>PCA</code>
which is a list of PCA results, each corresponding to the computation
in <code>aov_pcaSpectra</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ellipse</code></td>
<td>
<p>A character vector specifying the type of ellipses to be
plotted.  One of <code>c("both"</code>, <code>"none"</code>, <code>"cls"</code>, <code>"rob")</code>.  <code>cls</code>
specifies classical confidence ellipses, <code>rob</code> specifies robust
confidence ellipses.  An ellipse is drawn for each group unless there
are three or fewer samples in the group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>A number describing the fraction of points to be labeled. <code>tol = 1.0</code> labels all the points; <code>tol = 0.05</code> labels <em>approximately</em> the most extreme 5 percent. Set to <code>'none'</code> to completely suppress labels. Note that a simple approach based upon quantiles is used, assumes that both x and y are each normally distributed, and treats x and y separately.  Thus, this is not a formal treatment of outliers, just a means of labeling points. Groups are lumped together for the computation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.sym</code></td>
<td>
<p>A logical; if TRUE, the color scheme is set to black and the
points plotted with symbols.  Applies only to <code>Spectra</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leg.loc</code></td>
<td>
<p>Character; if <code>"none"</code> no legend will be drawn.
Otherwise, any string acceptable to <code>legend</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters to be passed to <code>plotScores</code>.
For example, you can plot confidence ellipses this way.  Note that ellipses
are drawn based on the groups in <code>spectra$groups</code>, but the separation
done by <code>aov_pcaSpectra</code> is based on argument <code>fac</code>.  These may
not correspond, but you can edit <code>spectra$groups</code> to match if necessary.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The returned value depends on the graphics option selected (see <code>ChemoSpecUtils::GraphicsOptions()</code>).
</p>

<ul>
<li> <p><strong>base</strong> A data frame or list containing the data plotted.  Assign the value and run <code>str()</code> or <code>names()</code> on it to see what it contains. Side effect is a plot.
</p>
</li>
<li> <p><strong>ggplot2</strong> The plot is displayed, and a <code>ggplot2</code> plot object is returned if the value is assigned. The plot can be modified in the usual <code>ggplot2</code> manner. If you want the plotted values, you can access them via the base graphics mode.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University), Matthew J. Keinsley.
</p>


<h3>References</h3>

<p>Pinto, Bosc, Nocairi, Barros, and Rutledge. "Using ANOVA-PCA for
Discriminant Analysis: ..." Analytica Chimica Acta 629.1-2 (2008): 47-55.
</p>
<p>Harrington, Vieira, Espinoza, Nien, Romero, and Yergey. "Analysis of
Varianceâ€“Principal Component Analysis: ..." Analytica Chimica Acta 544.1-2
(2005): 118-27.
</p>


<h3>See Also</h3>

<p>The use of this function can be seen in
<code>aov_pcaSpectra</code>.  See also <code>plotScores</code>.
Additional documentation at <a href="https://bryanhanson.github.io/ChemoSpec/">https://bryanhanson.github.io/ChemoSpec/</a>
</p>


</div>