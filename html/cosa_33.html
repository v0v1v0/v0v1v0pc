<div class="container">

<table style="width: 100%;"><tr>
<td>crd2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cluster-level Regression Discontinuity (Two-level Design, Discontinuity at Level 2, w/ or w/o Strata or Fixed Blocks)</h2>

<h3>Description</h3>

<p>Use <code>mdes.crd2()</code> to calculate minimum detectable effect size, <code>power.crd2()</code> to calculate statistical power, and <code>cosa.crd2()</code> for bound constrained optimal sample size allocation (BCOSSA). If higher level strata or fixed blocks exist, use <code>mdes.bcrd3f2()</code> to calculate minimum detectable effect size, <code>power.bcrd3f2()</code> to calculate statistical power, and <code>cosa.bcrd3f2()</code> for BCOSSA.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mdes.crd2(score = NULL, dists = "normal", k1 = -6, k2 = 6,
          order = 1, interaction = FALSE,
          treat.lower = TRUE, cutoff = 0, p = NULL,
          power = .80, alpha = .05, two.tailed = TRUE,
          df = n2 - g2 - order * (1 + interaction) - 2,
          rho2, r21 = 0, r22 = 0, g2 = 0, rate.tp = 1, rate.cc = 0, n1, n2)

power.crd2(score = NULL, dists = "normal", k1 = -6, k2 = 6,
           order = 1, interaction = FALSE,
           treat.lower = TRUE, cutoff = 0, p = NULL,
           es = .25, alpha = .05, two.tailed = TRUE,
           df = n2 - g2 - order * (1 + interaction) - 2,
           rho2, r21 = 0, r22 = 0, g2 = 0, rate.tp = 1, rate.cc = 0, n1, n2)

cosa.crd2(score = NULL, dists = "normal", k1 = -6, k2 = 6, rhots = NULL,
          order = 1, interaction = FALSE,
          treat.lower = TRUE, cutoff = 0, p = NULL,
          cn1 = 0, cn2 = 0, cost = NULL,
          n1 = NULL, n2 = NULL, n0 = c(10, 100), p0 = .499,
          constrain = "power", round = TRUE,
          max.power = FALSE, local.solver = c("LBFGS", "SLSQP"),
          power = .80, es = .25, alpha = .05, two.tailed = TRUE,
          rho2, g2 = 0, r21 = 0, r22 = 0)

mdes.bcrd3f2(score = NULL, dists = "normal", k1 = -6, k2 = 6,
             order = 1, interaction = FALSE,
             treat.lower = TRUE, cutoff = 0, p = NULL,
             power = .80, alpha = .05, two.tailed = TRUE,
             df = n3 * (n2 - 2) - g2 - order * (1 + interaction),
             rho2, r21 = 0, r22 = 0, g2 = 0,
             rate.tp = 1, rate.cc = 0, n1, n2, n3)

power.bcrd3f2(score = NULL, dists = "normal", k1 = -6, k2 = 6,
              order = 1, interaction = FALSE,
              treat.lower = TRUE, cutoff = 0, p = NULL,
              es = .25, alpha = .05, two.tailed = TRUE,
              df = n3 * (n2 - 2) - g2 - order * (1 + interaction),
              rho2, r21 = 0, r22 = 0, g2 = 0,
              rate.tp = 1, rate.cc = 0, n1, n2, n3)

cosa.bcrd3f2(score = NULL, dists = "normal", k1 = -6, k2 = 6, rhots = NULL,
             order = 1, interaction = FALSE,
             treat.lower = TRUE, cutoff = 0, p = NULL,
             cn1 = 0, cn2 = 0, cn3 = 0, cost = NULL,
             n1 = NULL, n2 = NULL, n3 = NULL,
             n0 = c(10, 100, 5), p0 = .499,
             constrain = "power", round = TRUE, max.power = FALSE,
             local.solver = c("LBFGS", "SLSQP"),
             power = .80, es = .25, alpha = .05, two.tailed = TRUE,
             rho2, g2 = 0, r21 = 0, r22 = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>score</code></td>
<td>
<p>vector or list; an empirical score variable or an object with class 'score' returned from the <code>inspect.score()</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dists</code></td>
<td>
<p>character; distribution of the score variable, <code>"normal"</code> or <code>"uniform"</code>. By default, <code>dists = "normal"</code> specification implies a truncated normal distribution with <code>k1 = -6</code> and <code>k2 = 6</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k1</code></td>
<td>
<p>left truncation point for (uncentered) empirical, truncated normal, or uniform distribution. Ignored when <code>rhots = 0</code> or <code>order = 0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k2</code></td>
<td>
<p>right truncation point for (uncentered) empirical, truncated normal, or uniform distribution. Ignored when <code>rhots = 0</code> or <code>order = 0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>integer &gt;= 0; order of polynomial functional form specification for the score variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interaction</code></td>
<td>
<p>logical; if <code>TRUE</code> polynomial specification interacts with the treatment variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rhots</code></td>
<td>
<p>obsolote; use <code>order = 0</code> to obtain results equivalent to random assignment designs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>treat.lower</code></td>
<td>
<p>logical; if <code>TRUE</code> units below the cutoff are treated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p>decision threshold.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>proportion of level 2 units in the treatment condition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>statistical power (1 - <code class="reqn">\beta</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>es</code></td>
<td>
<p>effect size (Cohen's d).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>probability of type I error (<code class="reqn">\alpha</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>two.tailed</code></td>
<td>
<p>logical; <code>TRUE</code> for two-tailed hypothesis testing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>degrees of freedom.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho2</code></td>
<td>
<p>proportion of variance in the outcome between level 2 units (unconditional ICC2).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g2</code></td>
<td>
<p>number of covariates at level 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r21</code></td>
<td>
<p>proportion of level 1 variance in the outcome explained by level 1 covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r22</code></td>
<td>
<p>proportion of level 2 variance in the outcome explained by level 2 covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate.tp</code></td>
<td>
<p>treatment group participation rate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate.cc</code></td>
<td>
<p>control group crossover rate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n1</code></td>
<td>
<p>average number of level 1 units per level 2 unit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n2</code></td>
<td>
<p>number of level 2 units (per stratum or block, if exists).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n3</code></td>
<td>
<p>number of stratum or fixed blocks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cn1</code></td>
<td>
<p>marginal costs per level 1 unit in treatment and control conditions (positional), e.g. <code>c(10, 5)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cn2</code></td>
<td>
<p>marginal costs per level 2 unit in treatment and control conditions (positional), e.g. <code>c(50, 30)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cn3</code></td>
<td>
<p>marginal cost per stratum or fixed block.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cost</code></td>
<td>
<p>total cost or budget. Ignored when <code>constrain = "power"</code> or <code>constrain = "es"</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n0</code></td>
<td>
<p>vector of starting values for <code>n1, n2</code> or <code>n1, n2, n3</code> (positional). Starting values are replaced with the averages when sample sizes are constrained by bounds.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p0</code></td>
<td>
<p>starting value for <code>p</code> when <code>rhots = 0</code> or <code>order = 0</code>, and <code>p = NULL</code>. Starting value is replaced with the average when <code>p</code> is constrained by bounds.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constrain</code></td>
<td>
<p>character; constrains one of the <code>"cost"</code>, <code>"power"</code>, or <code>"es"</code> at the specified value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>round</code></td>
<td>
<p>logical; <code>TRUE</code> for rounded BCOSSA solution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.power</code></td>
<td>
<p>logical; <code>TRUE</code> for maximizing the power rate instead of minimizing the variance. Applies when <code>constrain = "cost"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>local.solver</code></td>
<td>
<p>subset of <code>c("LBFGS", "SLSQP")</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>parms</code></td>
<td>
<p>list of parameters used in the function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>degrees of freedom.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sse</code></td>
<td>
<p>standardized standard error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cosa</code></td>
<td>
<p>BCOSSA solution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mdes</code></td>
<td>
<p>minimum detectable effect size and (1 - <code class="reqn">\alpha</code>)% confidence limits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>statistical power (1 - <code class="reqn">\beta</code>)</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">score.obj &lt;- inspect.score(rnorm(1000),
                           order = 1, interaction = FALSE,
                           cutoff = 0, k1 = -1, k2 = 1)

# single site (no blocks)
power.crd2(score.obj,
           es = .25, rho2 = .20, g2 = 0, r22 = 0,
           n1 = 50, n2 = 30)

# with 5 blocks (note that r22 is modified but g2 remains the same)
power.bcrd3f2(score.obj,
              es = .25, rho2 = .20, g2 = 0, r22 = .30,
              n1 = 50, n2 = 30, n3 = 5)

# minimum required number of level 2 units for each block
cosa.bcrd3f2(score.obj,
             es = .25, rho2 = .20, g2 = 0, r22 = .30,
             n1 = 50, n2 = NULL, n3 = 5)

</code></pre>


</div>