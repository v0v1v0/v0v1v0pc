<div class="container">

<table style="width: 100%;"><tr>
<td>c212.convergence.diag</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Convergence Diagnostics of the Simulation</h2>

<h3>Description</h3>

<p>The function applies either Gelman-Rubin or the Geweke diagnostic to the raw output of model simulation (e.g. c212.BB).
It returns the convergence diagnostics and, if applicable, the acceptance rates for the sampling distributions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">	c212.convergence.diag(raw, debug_diagnostic = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>raw</code></td>
<td>

<p>The output from a model simulation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>debug_diagnostic</code></td>
<td>

<p>Unused parameter.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>parameter is time consuming. This function applies one of two convergence diagnostics to the raw output of a model simulation
in order to allow convergence to be assessed. The two diagnostics are:
</p>
<p>i) Gelman-Rubin diagnostic - used when there is more than one chain. A value close to 1 is consistent with
an MCMC simulation which has converged. The ‘coda’ diagnostic returns a point estimate and upper confidence
limits.
</p>
<p>ii) Geweke diagnostic - used when there is a single chain. A Z-score which is consistent with a standard normal
distribution is expected from an MCMC simulation which has converged.
</p>
<p>The raw sample data is converted to ‘coda’ format (mcmc objects) and the ‘coda’ methods gelman.diag and
geweke.diag are used to perform the checks.
</p>


<h3>Value</h3>

<p>Returns a list of the diagnostics for each sampled variable. Each individual element of the list is a
data.frame containing at least the columns <em>type</em>, which is the type of diagnostic
(‘Gelman-Rubin’ or ‘Geweke’), <em>stat</em>, which is the value of the dignostic, and <em>upper_ci</em> which is
the upper confidence interval for the Gelman-Rubin diagnostic. For the Geweke diagnostic <em>upper_ci</em>
contains the value NA. Depending on the simulation performed the return from <em>c212.convergence.diag</em> will contain different
variables. The return for a simulation from <em>c212.1a</em> is as follows:
</p>
<pre>
list(sim_type, gamma.conv.diag, theta.conv.diag, mu.gamma.conv.diag,
                       mu.theta.conv.diag, sigma2.gamma.conv.diag,
                       sigma2.theta.conv.diag, mu.gamma.0.conv.diag,
                       mu.theta.0.conv.diag, tau2.gamma.0.conv.diag,
                       tau2.theta.0.conv.diag)
</pre>
<p>Additional columns which may be used to identify the individual samples are <em>B</em>, the body-system, and
<em>AE</em>, the Adverse Event and <em>interval</em>.
</p>


<h3>Author(s)</h3>

<p>R. Carragher
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(c212.trial.data)
raw = c212.BB(c212.trial.data, burnin = 100, iter = 200)
conv = c212.convergence.diag(raw)

## Not run: 
data(c212.trial.data)
raw = c212.BB(c212.trial.data)
conv = c212.convergence.diag(raw)

## End(Not run)
</code></pre>


</div>