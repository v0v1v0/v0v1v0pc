<div class="container">

<table style="width: 100%;"><tr>
<td>CST_RFSlope</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>RainFARM spectral slopes from a CSTools object</h2>

<h3>Description</h3>

<p>This function computes spatial spectral slopes from a CSTools 
object to be used for RainFARM stochastic precipitation downscaling method and 
accepts a CSTools object (of the class 's2dv_cube') as input.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CST_RFSlope(data, kmin = 1, time_dim = NULL, ncores = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>An object of the class 's2dv_cube', containing the spatial 
precipitation fields to downscale. The data object is expected to have an 
element named <code>$data</code> with at least two spatial dimensions named "lon" 
and "lat" and one or more dimensions over which to average these slopes, 
which can be specified by parameter <code>time_dim</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kmin</code></td>
<td>
<p>First wavenumber for spectral slope (default <code>kmin=1</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time_dim</code></td>
<td>
<p>String or character array with name(s) of dimension(s) (e.g. 
"ftime", "sdate", "member" ...) over which to compute spectral slopes. If a 
character array of dimension names is provided, the spectral slopes will be 
computed as an average over all elements belonging to those dimensions. If 
omitted one of c("ftime", "sdate", "time")  is searched and the first one 
with more than one element is chosen.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>Is an integer that indicates the number of cores for parallel 
computations using multiApply function. The default value is one.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>CST_RFSlope() returns spectral slopes using the RainFARM convention
(the logarithmic slope of k*|A(k)|^2 where A(k) are the spectral amplitudes).
The returned array has the same dimensions as the <code>exp</code> element of the 
input object, minus the dimensions specified by <code>lon_dim</code>, 
<code>lat_dim</code> and <code>time_dim</code>.
</p>


<h3>Author(s)</h3>

<p>Jost von Hardenberg - ISAC-CNR, <a href="mailto:j.vonhardenberg@isac.cnr.it">j.vonhardenberg@isac.cnr.it</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">exp &lt;- 1 : (2 * 3 * 4 * 8 * 8)
dim(exp) &lt;- c(dataset = 1, member = 2, sdate = 3, ftime = 4, lat = 8, lon = 8)
lon &lt;- seq(10, 13.5, 0.5)
lat &lt;- seq(40, 43.5, 0.5)
coords &lt;- list(lon = lon, lat = lat)
data &lt;- list(data = exp, coords = coords)
class(data) &lt;- 's2dv_cube'
slopes &lt;- CST_RFSlope(data)
</code></pre>


</div>