<div class="container">

<table style="width: 100%;"><tr>
<td>sa</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Flexible Monte Carlo sensitivity analysis for unmeasured confounding</h2>

<h3>Description</h3>

<p>The function <code>sa</code> implements the flexible sensitivity analysis
approach for unmeasured confounding with multiple treatments
and a binary outcome.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sa(
  x,
  y,
  w,
  formula = NULL,
  prior_c_function,
  m1,
  m2 = NULL,
  n_cores = 1,
  estimand,
  reference_trt,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A dataframe, including all the covariates but not treatments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A numeric vector (0, 1) representing a binary outcome.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>A numeric vector representing the treatment groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A <code>formula</code> object for the analysis.
The default is to use all terms specified in <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior_c_function</code></td>
<td>
<p>1) A vector of characters indicating the
prior distributions for the confounding functions.
Each character contains the random number generation code
from the standard probability
<code>distributions</code>
in the <code>stats</code> package.
2) A vector of characters including the grid specifications for
the confounding functions. It should be used when users want to formulate
the  confounding  functions as scalar values.
3) A matrix indicating the point mass prior for the confounding functions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m1</code></td>
<td>
<p>A numeric value indicating the number of draws of the GPS
from the posterior predictive distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m2</code></td>
<td>
<p>A numeric value indicating the number of draws from
the prior distributions of the confounding functions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_cores</code></td>
<td>
<p>A numeric value indicating number of cores to use
for parallel computing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimand</code></td>
<td>
<p>A character string representing the type of
causal estimand. Only <code>"ATT"</code> or <code>"ATE"</code> is allowed.
When the <code>estimand = "ATT"</code>, users also need to specify the
reference treatment group by setting the <code>reference_trt</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reference_trt</code></td>
<td>
<p>A numeric value indicating reference treatment group
for ATT effect.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other parameters that can be passed to BART functions</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of causal estimands including risk difference (RD)
between different treatment groups.
</p>


<h3>References</h3>

<p>Hadley Wickham (2019).
<em>stringr: Simple, Consistent Wrappers for Common String Operations</em>.
R package version 1.4.0.
URL:<a href="https://CRAN.R-project.org/package=stringr">https://CRAN.R-project.org/package=stringr</a>
</p>
<p>Hadley Wickham (2021).
<em>tidyr: Tidy Messy Data</em>.
R package version 1.1.4.
URL:<a href="https://CRAN.R-project.org/package=tidyr">https://CRAN.R-project.org/package=tidyr</a>
</p>
<p>Sparapani R, Spanbauer C, McCulloch R
Nonparametric Machine Learning and
Efficient Computation with Bayesian Additive Regression Trees:
The BART R Package. <em>Journal of Statistical Software</em>,
<strong>97</strong>(1), 1-66.
</p>
<p>Microsoft Corporation and Steve Weston (2020).
<em>doParallel: Foreach Parallel Adaptor for the 'parallel' Package</em>.
R package version 1.0.16.
URL:<a href="https://CRAN.R-project.org/package=doParallel">https://CRAN.R-project.org/package=doParallel</a>
</p>
<p>Microsoft and Steve Weston (2020).
<em>foreach: Provides Foreach Looping Construct.</em>.
R package version 1.5.1
URL:<a href="https://CRAN.R-project.org/package=foreach">https://CRAN.R-project.org/package=foreach</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
lp_w_all &lt;-
  c(
    ".4*x1 + .1*x2  - 1.1*x4 + 1.1*x5", # w = 1
    ".2 * x1 + .2 * x2  - 1.2 * x4 - 1.3 * x5"
  ) # w = 2
nlp_w_all &lt;-
  c(
    "-.5*x1*x4  - .1*x2*x5", # w = 1
    "-.3*x1*x4 + .2*x2*x5"
  ) # w = 2
lp_y_all &lt;- rep(".2*x1 + .3*x2 - .1*x3 - 1.1*x4 - 1.2*x5", 3)
nlp_y_all &lt;- rep(".7*x1*x1  - .1*x2*x3", 3)
X_all &lt;- c(
  "rnorm(0, 0.5)", # x1
  "rbeta(2, .4)", # x2
  "runif(0, 0.5)", # x3
  "rweibull(1,2)", # x4
  "rbinom(1, .4)" # x5
)
set.seed(1111)
data &lt;- data_sim(
  sample_size = 100,
  n_trt = 3,
  x = X_all,
  lp_y = lp_y_all,
  nlp_y = nlp_y_all,
  align = FALSE,
  lp_w = lp_w_all,
  nlp_w = nlp_w_all,
  tau = c(0.5, -0.5, 0.5),
  delta = c(0.5, 0.5),
  psi = 2
)
c_grid &lt;- c(
  "runif(-0.6, 0)", # c(1,2)
  "runif(0, 0.6)", # c(2,1)
  "runif(-0.6, 0)", # c(2,3)
  "seq(-0.6, 0, by = 0.3)", # c(1,3)
  "seq(0, 0.6, by = 0.3)", # c(3,1)
  "runif(0, 0.6)" # c(3,2)
)
sensitivity_analysis_parallel_result &lt;-
  sa(
    m1 = 1,
    x = data$covariates,
    y = data$y,
    w = data$w,
    prior_c_function = c_grid,
    n_cores = 1,
    estimand = "ATE",
  )

</code></pre>


</div>