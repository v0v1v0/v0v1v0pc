<div class="container">

<table style="width: 100%;"><tr>
<td>vcov.zlm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate Variance-Covariance Matrix and Pseudo Variance-Covariance Matrix for a Complex Fitted Model Object</h2>

<h3>Description</h3>

<p>A method for of stats::vcov that is compatible with complex linear models. In addition to variance-covariance matrix,
the pseudo variance-covariance matrix, which is a measure of the covariance between real and imaginary components, is returned as well.
Can also return the "double covariance" matrix, which combines the information of the covariance matrix and the pseudo-covariance matrix, as described in (van den Bos 1995).
While not as compact as two separate smaller matrices, the double covariance matrix simplifies calculations such as the mahalanobis distance.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'zlm'
vcov(object, complete = TRUE, merge = TRUE, ...)

.vcov.aliased.complex(aliased, vc, complete = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>Typically a fitted model object of class "zlm" and/or "rzlm". Sometimes also a summary() object of such a fitted model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>complete</code></td>
<td>
<p>logical. Indicates if the full covariance and pseudo-covariance matrices should be returned even in the case of an over-determined system, meaning that some coefficients are undefined.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>merge</code></td>
<td>
<p>logical. Should the covariance matrix and pseudo-covariance / relational matrix be merged into one matrix of twice the dimensions? Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters, not currently used for anything.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aliased</code></td>
<td>
<p>a logical vector typically identical to <code>is.na(coef(.))</code> indicating which coefficients are 'aliased'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vc</code></td>
<td>
<p>a variance-covariance matrix, typically "incomplete", i.e., with no rows and columns for aliased coefficients.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If <code>merge</code> is false, a list containing both the numeric variance-covariance matrix, and the complex pseudo variance-covariance matrix.
If <code>merge</code> is true, a large matrix (both dimensions being twice the number of coefficients) containing both the variance-covariance matrix and the pseudo variance-covariance matrix, merged together.
</p>


<h3>Functions</h3>


<ul><li> <p><code>.vcov.aliased.complex</code>: auxiliary function for dealing with singular model fits. See stats::vcov.
</p>
</li></ul>
<h3>References</h3>

<p>A. van den Bos, The Multivariate Complex Normal Distribution-a Generalization, IEEE Trans. Inform. Theory 41, 537 (1995).
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(4242)
n &lt;- 8
slop &lt;- complex(real = 4.23, imaginary = 2.323)
interc &lt;- complex(real = 1.4, imaginary = 1.804)
err &lt;- complex(real = rnorm(n)/16, imaginary = rnorm(n)/16)
tframe &lt;- data.frame(x= x &lt;- complex(real=rnorm(n), imaginary= rnorm(n)), y=slop*x + interc+err)
fit &lt;- lm(y ~ x, data = tframe, weights = rep(1,n))
vcov(fit)
</code></pre>


</div>