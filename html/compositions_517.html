<div class="container">

<table style="width: 100%;"><tr>
<td>plot.acomp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Ternary diagrams</h2>

<h3>Description</h3>

<p>Displaying compositions in ternary diagrams
</p>


<h3>Usage</h3>

<pre><code class="language-R"> ## S3 method for class 'acomp'
plot(x,...,labels=names(x),
          aspanel=FALSE,id=FALSE,idlabs=NULL,idcol=2,center=FALSE,
          scale=FALSE,pca=FALSE,col.pca=par("col"),margin="acomp",
          add=FALSE,triangle=!add,col=par("col"),axes=FALSE,
          plotMissings=TRUE,
          lenMissingTck=0.05,colMissingTck="red",
          mp=~simpleMissingSubplot(c(0,1,0.95,1),
                                  missingInfo,c("NM","TM",cn)),
          robust=getOption("robust"))
 ## S3 method for class 'rcomp'
plot(x,...,labels=names(x),
          aspanel=FALSE,id=FALSE,idlabs=NULL,idcol=2,center=FALSE,
          scale=FALSE,pca=FALSE,col.pca=par("col"),margin="rcomp",
          add=FALSE,triangle=!add,col=par("col"),axes=FALSE
          ,plotMissings=TRUE,
          lenMissingTck=0.05,colMissingTck="red",
          mp=~simpleMissingSubplot(c(0,1,0.95,1),
                                   missingInfo,c("NM","TM",cn)),
          robust=getOption("robust"))
 ## S3 method for class 'ccomp'
plot(x,...)
          </code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a dataset of a compositional class</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further graphical parameters passed (see
<code>par</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>margin</code></td>
<td>
<p>the type of marginalisation to be computed, when
displaying the individual panels. Possible values are: <code>"acomp"</code>,
<code>"rcomp"</code> and any of the variable names/column numbers in the
composition. If one of the columns is selected each panel displays a
subcomposition given by the row part, the column part and
the given part. If one of the classes is given the corresponding
margin <code>acompmargin</code>  or  <code>rcompmargin</code> is
used. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>a logical indicating whether the information should just
be added to an existing plot. If FALSE a new plot is created</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>triangle</code></td>
<td>
<p>a logical indicating whether the triangle should be
drawn</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>the color to plot the data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p>the names of the parts</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>aspanel</code></td>
<td>
<p>logical indicating that only a single panel should be
drawn and not the whole plot. Internal use only</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>logical, if TRUE one can identify the points like with the
<code>identify</code> command. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>idlabs</code></td>
<td>
<p>a character vector providing the labels to be used with
the identification, when <code>id=TRUE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>idcol</code></td>
<td>
<p>color of the <code>idlabs</code> labels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p>a logical indicating whether a the data should be
centered prior to the plot. Centering is done in the choosen
geometry. See <code>scale</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>a logical indicating whether a the data should be
scaled prior to the plot. Scaling is done in the choosen
geometry. See <code>scale</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pca</code></td>
<td>
<p>a logical indicating whether the first principal component
should be displayed in the plot. Currently, the direction of the
principal component of the displayed subcomposition is displayed as 
a line. In a future, the projected principal componenent of the whole 
dataset should be displayed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.pca</code></td>
<td>
<p>The color to draw the principal component.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axes</code></td>
<td>
<p>Either a logical wether to plot the axes, or numerical
enumerating the axes sides to be used e.g. 1 for only plotting the
lower axes, or a list of parameters to ternaryAxis. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotMissings</code></td>
<td>
<p> logical indicating that missingness should be
represented graphically. Componentes with one missing subcomponent
in the plot are represented by tickmarks at the three
axis. Components with two or three missing components are only
represented in a special panel drawn according to the mp parameter
if missings are present. Missings of type BDL (below detection
limit) are always plotted, even if <code>plotMissings</code> is false, but
in this case this fact is not specially marked. In rcomp geometry an
actuall 0 in the data is never treated as missing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lenMissingTck</code></td>
<td>
<p>length of the tick-marks to be plotted for missing
values. If 0 no tickmarks are plotted. Negative lengths point
outside. length 1 draws right through to the opposit
corner. Missing ticks in acomp geometry are inclined showing the
line of possible values in acomp geometry. Missingticks in
rcomp-geometry are vertical to the axis representing the fact that
only the other component is unkown. That these lines can leave the plot
is one of the  odd consequences of rcomp geometry.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colMissingTck</code></td>
<td>
<p>colors to draw the missing tick-marks. NULL means
to take the colors specified for the observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mp</code></td>
<td>
<p>A formula providing a call to a function plotting
informations on the missings. The call is evaluted in the
environment of the panel plotting function and has access (among
others) to: <code>cn</code> the names of the components in the current
plot, <code>x</code> the dataset of the current plot, <code>y</code> the
transformed dataset, (c60,s60) coordinates of the upper vertex of
the triangle. <code>missingInfo</code> is a table giving the number of
observations of the types NM=Non Missing, TM=Totally missing
(i.e. at least two components of the subcomposition are missing),
and the three single component missing possibilities for the three
components. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust</code></td>
<td>
<p>A robustness description. See
robustnessInCompositions for details. The option is used for
centering, scaling and principle components. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The data is displayed in ternary diagrams. Thus, it does not work for
two-part compositions. Compositions of three parts are displayed
in a single ternary diagram. For compositions of more than three
components, the data is arranged in a scatterplot matrix through the
command <code>pairs</code>.
<br>
In this case, the third component in each of the panels is chosen 
according to setting of <code>margin=</code>. Possible values of <code>margin=</code> are:
<code>"acomp"</code>, <code>"rcomp"</code> and any of the variable names/column numbers in the
composition. If one of the columns is selected each panel displays a
subcomposition given by the row part, the column part and
the given part. If one of the classes is given the corresponding
margin <code>acompmargin</code>  or  <code>rcompmargin</code> is
used.
<br>
Ternary diagrams can be read in multiple ways. Each corner of the
triangle corresponds to an extreme composition containing only the part
displayed in that corner. Points on the edges correspond to
compositions containing only the parts in the adjacent corners. The
relative amounts are displayed by the distance to the opposite
corner (so-called barycentric coordinates). The individual portions 
of any point can be infered by drawing a line through the investigated point, 
and parallel to the edge opposite to the corner of the part of interest. 
The portion of this part is constant along the line. Thus we can read it 
on the sides of the ternary diagram, where the line crosses its borders.
Note that these <code>isoPortionLines</code> remain straight under an 
arbitrary perturbation. 
<br>
ccomp ternary diagrams are always jittered to avoid overplotting.
</p>


<h3>Author(s)</h3>

<p>K.Gerald v.d. Boogaart <a href="http://www.stat.boogaart.de">http://www.stat.boogaart.de</a>, Raimon
Tolosana-Delgado</p>


<h3>References</h3>

<p>Aitchison, J. (1986) <em>The Statistical Analysis of Compositional
Data</em> Monographs on Statistics and Applied Probability. Chapman &amp;
Hall Ltd., London (UK). 416p.<br></p>
<p>Aitchison, J, C. Barcel'o-Vidal, J.J. Egozcue, V. Pawlowsky-Glahn
(2002) A consise guide to the algebraic geometric structure of the
simplex, the sample space for compositional data analysis, <em>Terra
Nostra</em>, Schriften der Alfred Wegener-Stiftung, 03/2003<br></p>
<p>Billheimer, D., P. Guttorp, W.F. and Fagan (2001) Statistical interpretation of species composition,
<em>Journal of the American Statistical Association</em>, <b>96</b> (456), 1205-1214<br></p>
<p>Pawlowsky-Glahn, V. and J.J. Egozcue (2001) Geometric approach to
statistical analysis on the simplex. <em>SERRA</em> <b>15</b>(5), 384-398<br></p>
<p><a href="https://ima.udg.edu/Activitats/CoDaWork03/">https://ima.udg.edu/Activitats/CoDaWork03/</a><br></p>
<p><a href="https://ima.udg.edu/Activitats/CoDaWork05/">https://ima.udg.edu/Activitats/CoDaWork05/</a>
</p>


<h3>See Also</h3>

<p><code>plot.aplus</code>, <code>plot3D</code> (for 3D plot),
<code>kingTetrahedron</code> (for 3D-plot model export),
<code>qqnorm.acomp</code>,<code>boxplot.acomp</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">data(SimulatedAmounts)
plot(acomp(sa.lognormals))
plot(acomp(sa.lognormals),axes=TRUE)
plot(rcomp(sa.lognormals))
plot(rcomp(sa.lognormals5))

plot(acomp(sa.lognormals5),pca=TRUE,col.pca="red")
plot(rcomp(sa.lognormals5),pca=TRUE,col.pca="red",axes=TRUE)
</code></pre>


</div>