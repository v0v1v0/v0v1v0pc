<div class="container">

<table style="width: 100%;"><tr>
<td>bbdml</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Maximum Likelihood for the Beta-binomial Distribution</h2>

<h3>Description</h3>

<p>Maximum Likelihood for the Beta-binomial Distribution
</p>


<h3>Usage</h3>

<pre><code class="language-R">bbdml(
  formula,
  phi.formula,
  data,
  link = "logit",
  phi.link = "logit",
  method = "trust",
  control = list(maxit = 1000, reltol = 1e-14),
  numerical = FALSE,
  nstart = 1,
  inits = NULL,
  allow_noninteger = FALSE,
  robust = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class <code>formula</code>: a symbolic description of the model to be fitted to the abundance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi.formula</code></td>
<td>
<p>an object of class <code>formula</code> without the response: a symbolic description of the model to be fitted to the dispersion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame or <code>phyloseq</code> object containing the variables in the models</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>
<p>link function for abundance covariates, defaults to <code>"logit"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi.link</code></td>
<td>
<p>link function for dispersion covariates, defaults to <code>"logit"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>optimization method, defaults to <code>"trust"</code>, or see <code>optimr</code> for other options</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>optimization control parameters (see <code>optimr</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numerical</code></td>
<td>
<p>Boolean. Defaults to <code>FALSE</code>. Indicator of whether to use the numeric Hessian (not recommended).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nstart</code></td>
<td>
<p>Integer. Defaults to <code>1</code>. Number of starts for optimization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inits</code></td>
<td>
<p>Optional initializations as rows of a matrix. Defaults to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allow_noninteger</code></td>
<td>
<p>Boolean. Defaults to <code>FALSE</code>. Should noninteger W's and M's be allowed? This behavior was not permitted prior to v4.1, needs to be explicitly allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust</code></td>
<td>
<p>Should robust standard errors be returned? If not, model-based standard arras are used. Logical, defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Optional additional arguments for <code>optimr</code> or <code>trust</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>bbdml</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># data frame example
data(soil_phylum_small_otu1)
bbdml(formula = cbind(W, M - W) ~ DayAmdmt,
phi.formula = ~ DayAmdmt,
data = soil_phylum_small_otu1)

# phyloseq example (only run this if you have phyloseq installed)
## Not run: 
data(soil_phylum_small_sample)
data(soil_phylum_small_otu)
data_phylo &lt;- phyloseq::phyloseq(phyloseq::sample_data(soil_phylum_small_sample),
phyloseq::otu_table(soil_phylum_small_otu, taxa_are_rows = TRUE))
bbdml(formula = Proteobacteria ~ DayAmdmt,
phi.formula = ~ DayAmdmt,
data = data_phylo)

## End(Not run)

</code></pre>


</div>