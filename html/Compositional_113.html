<div class="container">

<table style="width: 100%;"><tr>
<td>Helper Frechet mean for compositional data</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Helper Frechet mean for compositional data
</h2>

<h3>Description</h3>

<p>Helper Frechet mean for compositional data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">frechet2(x, di, a, k)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>A matrix with the compositional data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>di</code></td>
<td>

<p>A matrix with indices as produced by the function "dista" of the package "Rfast"" or the function "nn" 
of the package "Rnanoflann". Better see the details section.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>

<p>The value of the power transformation, it has to be between -1 and 1. If zero values are present it has to be greater than 0. If <code class="reqn">\alpha=0</code> the isometric log-ratio transformation is applied and the closed geometric mean is calculated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>

<p>The number of nearest neighbours used for the computation of the Frechet means.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The power transformation is applied to the compositional data and the mean vector is calculated. Then the inverse of it is calculated and the inverse of the power transformation applied to the last vector is the Frechet mean.
</p>
<p>What this helper function do is to speed up the Frechet mean when used in the <code class="reqn">\alpha</code>-k-NN regression. The <code class="reqn">\alpha</code>-k-NN regression computes the Frechet mean of the k nearest neighbours for a value of <code class="reqn">\alpha</code> and this function does exactly that. Suppose you want to predict the compositional value of some new predictors. For each predictor value you must use the Frechet mean computed at various nearest neighbours. This function performs these computations in a fast way. It is not the fastest way, yet it is a pretty fast way. This function is being called inside the function aknn.reg.
</p>


<h3>Value</h3>

<p>A list where eqch element contains a matrix. Each matrix contains the Frechet means computed at various nearest neighbours.
</p>


<h3>Author(s)</h3>

<p>Michail Tsagris.
</p>
<p>R implementation and documentation: Michail Tsagris <a href="mailto:mtsagris@uoc.gr">mtsagris@uoc.gr</a>.
</p>


<h3>References</h3>

<p>Tsagris M.T., Preston S. and Wood A.T.A. (2011). A data-based power transformation for compositional data. In Proceedings of the 4th Compositional Data Analysis Workshop, Girona, Spain.
https://arxiv.org/pdf/1106.1451.pdf
</p>


<h3>See Also</h3>

<p><code>alfa, alfainv, profile
</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(MASS)
library(Rfast)
x &lt;- as.matrix(fgl[, 2:9])
x &lt;- x / rowSums(x)
xnew &lt;- x[1:10, ]
x &lt;- x[-c(1:10), ]
k &lt;- 2:5
di &lt;- Rfast::dista( xnew, x, k = max(k), index = TRUE, square = TRUE )
est &lt;- frechet2(x, di, 0.2, k)

</code></pre>


</div>