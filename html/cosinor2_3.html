<div class="container">

<table style="width: 100%;"><tr>
<td>cosinor.poptests</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Comparison of Cosinor Parameters of Two Populations</h2>

<h3>Description</h3>

<p>Runs the tests that compare MESORs, amplitudes and acrophases of two different populations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cosinor.poptests(pop1, pop2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pop1</code></td>
<td>
<p>An object of the <code>population.cosinor.lm</code> class calculated on the first population.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pop2</code></td>
<td>
<p>An object of the <code>population.cosinor.lm</code> class calculated on the second population.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Bingham et al. (1982) describe tests for comparing population MESORs, amplitudes and acrophases. These tests are esentially F-ratios with <code class="reqn">df_1 = m - 1</code> and <code class="reqn">df_2 = K - m</code>, where <code class="reqn">m</code> is the number of populations and <code class="reqn">K</code> is the total number of subjects. The tests for MESOR, amplitude and acrophase differences respectively are calculated as follows:
</p>
<p style="text-align: center;"><code class="reqn">F_M = \frac{\sum_{j = 1}^{m}k_j(\widehat{M}_j - \widehat{M})^2}{(m-1)\widehat{\sigma}_M^2}</code>
</p>

<p style="text-align: center;"><code class="reqn">F_\phi = \frac{\frac{\sum_{j = 1}^{m}k_j A_j^2 * sin^2(\widehat{\phi}_j - \tilde{\phi})}{m - 1}} {\widehat{\sigma}_\beta^2 sin^2\tilde{\phi} + 2\widehat{\sigma}_{\beta \gamma} cos\tilde{\phi}sin\tilde{\phi} + \widehat{\sigma}_\gamma^2 cos^2\tilde{\phi}}</code>
</p>

<p style="text-align: center;"><code class="reqn">F_A = \frac{\frac{\sum_{j = 1}^{m}(\widehat{A}_j - \widehat{A})^2}{m - 1}}{\widehat{\sigma}^2_\beta cos^2\widehat{\phi} - 2\widehat{\sigma}_{\beta \gamma}cos\widehat{\phi}sin\widehat{\phi} + \widehat{\sigma}^2_\gamma sin^2 \widehat{\phi}}</code>
</p>

<p>where <code class="reqn">\widehat{M}</code>, <code class="reqn">\widehat{A}</code> and <code class="reqn">\widehat{\phi}</code> are weighted averages of parameters across populations calculated as:
</p>
<p style="text-align: center;"><code class="reqn">\widehat{M} = \frac{\sum_{j = 1}^{m}k_j\widehat{M}_j}{K}</code>
</p>

<p style="text-align: center;"><code class="reqn">\widehat{A} = \frac{\sum_{j = 1}^{m}k_j\widehat{A}_j}{K}</code>
</p>

<p style="text-align: center;"><code class="reqn">\widehat{\phi} = \frac{\sum_{j = 1}^{m}k_j\widehat{\phi}_j}{K}</code>
</p>

<p><code class="reqn">\tilde{\phi}</code> is derived from the following expression:
</p>
<p style="text-align: center;"><code class="reqn">tan 2\tilde{\phi} = \frac{\sum_{j = 1}^{m}k_j\widehat{A}^2_j sin 2\widehat{\phi}_j}{\sum_{j = 1}^{m}k_j\widehat{A}^2_j cos 2\widehat{\phi}_j}</code>
</p>

<p>where <code class="reqn">2\tilde{\phi}</code> lies between <code class="reqn">-\frac{\pi}{2}</code> and <code class="reqn">\frac{\pi}{2}</code> if the denomanator is positive or between <code class="reqn">\frac{\pi}{2}</code> and <code class="reqn">\frac{3\pi}{2}</code> if the denominator is negative, <code class="reqn">k_j</code> is the number of subjects in the <code class="reqn">j</code>th population, <code class="reqn">\widehat{M}_j</code>, <code class="reqn">\widehat{A}_j</code> and <code class="reqn">\widehat{\phi}_j</code> are the cosinor parameters of the <code class="reqn">j</code>th population and <code class="reqn">\widehat{\sigma}_\beta</code>,<code class="reqn">\widehat{\sigma}_\gamma</code> and <code class="reqn">\widehat{\sigma}_{\beta \gamma}</code> are the estimates of pooled standard deviations (and covariance) calculated as following:
</p>
<p style="text-align: center;"><code class="reqn">\widehat{\sigma}_\beta = \frac{\sum_{j = 1}^{m} (k_j - 1)\widehat{\sigma}_{\beta_j}}{K - m}</code>
</p>

<p style="text-align: center;"><code class="reqn">\widehat{\sigma}_\gamma = \frac{\sum_{j = 1}^{m} (k_j - 1)\widehat{\sigma}_{\gamma_j}}{K - m}</code>
</p>

<p style="text-align: center;"><code class="reqn">\widehat{\sigma}_{\beta \gamma} = \frac{\sum_{j = 1}^{m} (k_j - 1)\widehat{\sigma}_{{\beta_j} {\gamma_j}}}{K - m}</code>
</p>

<p>where <code class="reqn">\widehat{\sigma}_{\beta_j}</code>, <code class="reqn">\widehat{\sigma}_{\gamma_j}</code> and <code class="reqn">\widehat{\sigma}_{{\beta_j} {\gamma_j}}</code> are the standard devations and covariance of <code class="reqn">\beta</code> and <code class="reqn">\gamma</code> parameters in the <code class="reqn">j</code>th population.
</p>


<h3>Note</h3>

<p>These tests should only be performed on independent samples. If the acrophases of two populations are significantly different, the results of the amplitude difference test are not reliable and should not be interpreted. While it's possible to perform tests which compare more than two populations, this function can only compare two populations.
</p>


<h3>References</h3>

<p>Bingham, C., Arbogast, B., Guillaume Corn√©lissen, G., Lee, J.K. &amp; Halberg, F. (1982). Inferential Statistical Methods for Estimating and Comparing Cosinor Parameters. <em>Chronobiologia</em>, <em>9(4)</em>, 397-439.
</p>


<h3>Examples</h3>

<pre><code class="language-R">fit.extraverts&lt;-population.cosinor.lm(data = PA_extraverts, time = PA_time,
period = 24)
fit.introverts&lt;-population.cosinor.lm(data = PA_introverts, time = PA_time,
period = 24)
cosinor.poptests(pop1 = fit.extraverts, pop2 = fit.introverts)
</code></pre>


</div>