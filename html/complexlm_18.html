<div class="container">

<table style="width: 100%;"><tr>
<td>plot.zlm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot Diagnostics for a Complex Linear Model Objects</h2>

<h3>Description</h3>

<p>A modified version of stats::plot.lm used for visualizing ordinary ("zlm") and robust ("rzlm")
linear models of complex variables. This documentation entry describes the complex version, focusing on the
differences and changes from the numeric. For further explanation of the plots please see stats::plot.lm.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'zlm'
plot(
  x,
  which = c(1, 3, 5),
  caption = list("Residuals vs Fitted", "Scale-Location", "Cook's distance",
    "Residuals vs Leverage", expression("Cook's dist vs Leverage  " * h[ii]/(1 - h[ii]))),
  panel = if (add.smooth) function(x, y, ...) panel.smooth(x, y, iter = iter.smooth,
    ...) else points,
  sub.caption = NULL,
  main = "",
  ask = prod(par("mfcol")) &lt; length(which) &amp;&amp; dev.interactive(),
  ...,
  id.n = 3,
  labels.id = names(residuals(x)),
  cex.id = 0.75,
  cook.levels = c(0.5, 1),
  add.smooth = getOption("add.smooth"),
  iter.smooth = if (isGlm) 0 else 3,
  label.pos = c(4, 2),
  cex.caption = 1,
  cex.oma.main = 1.25
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>complex lm object ("zlm" or "rzlm"). Typically produced by lm or rlm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>If a subset of the plots is required, specify a subset of the numbers 1:6, except 2. See stats::plot.lm, and below, for the different kinds. Default is c(1,3,5).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>caption</code></td>
<td>
<p>captions to appear above the plots;
<code>character</code> vector or <code>list</code> of valid
graphics annotations, see <code>as.graphicsAnnot</code>, of length
6, the j-th entry corresponding to <code>which[j]</code>.  Can be set to
<code>""</code> or <code>NA</code> to suppress all captions.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>panel</code></td>
<td>
<p>panel function.  The useful alternative to
<code>points</code>, <code>panel.smooth</code> can be chosen
by <code>add.smooth = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sub.caption</code></td>
<td>
<p>common title—above the figures if there are more
than one; used as <code>sub</code> (s.<code>title</code>) otherwise.  If
<code>NULL</code>, as by default, a possible abbreviated version of
<code>deparse(x$call)</code> is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>title to each plot—in addition to <code>caption</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ask</code></td>
<td>
<p>logical; if <code>TRUE</code>, the user is <em>ask</em>ed before
each plot, see <code>par(ask=.)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other parameters to be passed through to plotting
functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id.n</code></td>
<td>
<p>number of points to be labelled in each plot, starting
with the most extreme.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels.id</code></td>
<td>
<p>vector of labels, from which the labels for extreme
points will be chosen.  <code>NULL</code> uses observation numbers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.id</code></td>
<td>
<p>magnification of point labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cook.levels</code></td>
<td>
<p>levels of Cook's distance at which to draw contours.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.smooth</code></td>
<td>
<p>logical indicating if a smoother should be added to
most plots; see also <code>panel</code> above.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter.smooth</code></td>
<td>
<p>the number of robustness iterations, the argument
<code>iter</code> in <code>panel.smooth()</code>; the default uses no such
iterations for <code>glm</code> fits which is
particularly desirable for the (predominant) case of binary
observations, but also for other models where the response
distribution can be highly skewed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label.pos</code></td>
<td>
<p>positioning of labels, for the left half and right
half of the graph respectively, for plots 1-3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.caption</code></td>
<td>
<p>controls the size of <code>caption</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.oma.main</code></td>
<td>
<p>controls the size of the <code>sub.caption</code> only if
that is <em>above</em> the figures when there is more than one.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Five of the six plots generated by stats::plot.lm can be produced by this function:
The residuals vs. fitted values plot, the scale-location plot, the plot of Cook's distances vs. row labels,
the plot of residuals vs. leverages, and the plot of Cook's distances vs. leverage/(1-leverage). The Q-Q plot is
<em>not</em> drawn because it requires quantiles, which are not unambiguously defined for complex numbers.
Because complex numbers are two dimensional, pairs is used to create multiple scatter plots of the real
and imaginary components for the residuals vs. fitted values and scale-location plots.
</p>


<h3>Value</h3>

<p>Several diagnostic plots.
</p>


<h3>References</h3>

<p>Belsley, D. A., Kuh, E. and Welsch, R. E. (1980). Regression Diagnostics. New York: Wiley.
</p>
<p>Cook, R. D. and Weisberg, S. (1982). Residuals and Influence in Regression. London: Chapman and Hall.
</p>
<p>Firth, D. (1991) Generalized Linear Models. In Hinkley, D. V. and Reid, N. and Snell, E. J., eds: Pp. 55-82 in Statistical Theory and Modelling. In Honour of Sir David Cox, FRS. London: Chapman and Hall.
</p>
<p>Hinkley, D. V. (1975). On power transformations to symmetry. Biometrika, 62, 101-111. doi: 10.2307/2334491.
</p>
<p>McCullagh, P. and Nelder, J. A. (1989). Generalized Linear Models. London: Chapman and Hall.
</p>


<h3>See Also</h3>

<p>zhatvalues, cooks.distance, lm, rlm
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(4242)
n &lt;- 8
slop &lt;- complex(real = 4.23, imaginary = 2.323)
interc &lt;- complex(real = 1.4, imaginary = 1.804)
e &lt;- complex(real=rnorm(n)/6, imaginary=rnorm(n)/6)
xx &lt;- complex(real= rnorm(n), imaginary= rnorm(n))
tframe &lt;- data.frame(x = xx, y= slop*xx + interc + e)
fit &lt;- lm(y ~ x, data = tframe, weights = rep(1,n))
plot(fit)
</code></pre>


</div>