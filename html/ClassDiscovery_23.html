<div class="container">

<table style="width: 100%;"><tr>
<td>plotColoredClusters</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot Dendrograms with Color-Coded Labels</h2>

<h3>Description</h3>

<p>Provides an interface to the <code>plot</code> method for
<code>hclust</code> that makes it easier to plot dendrograms with
labels that are color-coded, usually to indicate the different levels
of a factor.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotColoredClusters(hd, labs, cols, cex = 0.8, main = "", line = 0, ...)
pcc(hd, colors=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>hd</code></td>
<td>
<p> An object with S3 class <code>hclust</code>, as produced by the
<code>hclust</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labs</code></td>
<td>
<p> A vector of character strings used to label the leaves
in the dendrogram</p>
</td>
</tr>
</table>
<p>.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>cols</code></td>
<td>
<p> A vector of color names suitable for passing to the
<code>col</code> argument of graphics routines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p> A numeric value; the character expansion parameter of
<code>par</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p> A character string; the plot title</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line</code></td>
<td>
<p> An integer determining how far away to plot the labels;
see <code>mtext</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colors</code></td>
<td>
<p> A list; see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Any additional graphical parameters that can be supplied
when plotting an <code>hclust</code> object.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>plotColoredClusters</code> function is used to implement the
<code>pltree</code> methods of the 
<code>Mosaic</code> class and the <code>PCanova</code> class.  It simply bundles
a two step process (first plotting the dendrogram with no labels,
followed by writing the labels in the right places with the desired
colors) into a single unit.
</p>
<p>The <code>pcc</code> function also produces dendrograms with colored
annotations.  However, instead of coloring the labels based on a
single factor, it produces color bars for any number of factors.  The
<code>colors</code> argument should be a list with named components, where
each component should correspond to a factor and a color scheme.
Specifically, the components must themselves be lists with two
components named <code>fac</code> (and containing the factor) and <code>col</code>
(containing a named vector specifying colors for each level of the
factor).
</p>


<h3>Value</h3>

<p>The function has no useful return value; it merely produces a plot.
</p>


<h3>See Also</h3>

 <p><code>hclust</code>,
<code>Mosaic</code>, <code>PCanova</code>, <code>par</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># simulate data from three different groups
d1 &lt;- matrix(rnorm(100*10, rnorm(100, 0.5)), nrow=100, ncol=10, byrow=FALSE)
d2 &lt;- matrix(rnorm(100*10, rnorm(100, 0.5)), nrow=100, ncol=10, byrow=FALSE)
d3 &lt;- matrix(rnorm(100*10, rnorm(100, 0.5)), nrow=100, ncol=10, byrow=FALSE)
dd &lt;- cbind(d1, d2, d3)

# perform hierarchical clustering using correlation
hc &lt;- hclust(distanceMatrix(dd, 'pearson'), method='average')
cols &lt;- rep(c('red', 'green', 'blue'), each=10)
labs &lt;- paste('X', 1:30, sep='')

# plot the dendrogram with color-coded groups
plotColoredClusters(hc, labs=labs, cols=cols)

# simulate another dataset
fakedata &lt;- matrix(rnorm(200*30), ncol=30)
colnames(fakedata) &lt;- paste("P", 1:30, sep='')
# define two basic factors, with colors
faccol &lt;- list(fac=factor(rep(c("A", "B"), each=15)),
               col=c(A='red', B='green'))
fac2col &lt;- list(fac=factor(rep(c("X", "Y", "Z"), times=10)),
               col=c(X='cyan', Y='orange', Z='purple'))
# add another factor that reverses the colors
BA &lt;- faccol
BA$col &lt;- c(A='blue', B='yellow')
# assemble the list of factors
colors &lt;- list(AB=faccol, XYZ=fac2col, "tricky long name"=fac2col,
               another=BA)
# cluster the samples
hc &lt;- hclust(distanceMatrix(fakedata, "pearson"), "ward")
# plot the results
pcc(hc, colors)


#cleanup
rm(d1, d2, d3, dd, hc, cols, labs)
rm(fakedata, faccol, fac2col, BA, colors)
</code></pre>


</div>