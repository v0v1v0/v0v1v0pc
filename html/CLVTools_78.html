<div class="container">

<table style="width: 100%;"><tr>
<td>ggomnbd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Gamma-Gompertz/NBD model</h2>

<h3>Description</h3>

<p>Fits Gamma-Gompertz/NBD models on transactional data with static and without covariates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'clv.data'
ggomnbd(
  clv.data,
  start.params.model = c(),
  optimx.args = list(),
  verbose = TRUE,
  ...
)

## S4 method for signature 'clv.data.static.covariates'
ggomnbd(
  clv.data,
  start.params.model = c(),
  optimx.args = list(),
  verbose = TRUE,
  names.cov.life = c(),
  names.cov.trans = c(),
  start.params.life = c(),
  start.params.trans = c(),
  names.cov.constr = c(),
  start.params.constr = c(),
  reg.lambdas = c(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>clv.data</code></td>
<td>
<p>The data object on which the model is fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start.params.model</code></td>
<td>
<p>Named start parameters containing the optimization start parameters for the model without covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimx.args</code></td>
<td>
<p>Additional arguments to control the optimization which are forwarded to <code>optimx::optimx</code>.
If multiple optimization methods are specified, only the result of the last method is further processed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Show details about the running of the function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Ignored</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>names.cov.life</code></td>
<td>
<p>Which of the set Lifetime covariates should be used. Missing parameter indicates all covariates shall be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>names.cov.trans</code></td>
<td>
<p>Which of the set Transaction covariates should be used. Missing parameter indicates all covariates shall be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start.params.life</code></td>
<td>
<p>Named start parameters containing the optimization start parameters for all lifetime covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start.params.trans</code></td>
<td>
<p>Named start parameters containing the optimization start parameters for all transaction covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>names.cov.constr</code></td>
<td>
<p>Which covariates should be forced to use the same parameters for the lifetime and transaction process. The covariates need to be present as both, lifetime and transaction covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start.params.constr</code></td>
<td>
<p>Named start parameters containing the optimization start parameters for the constraint covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reg.lambdas</code></td>
<td>
<p>Named lambda parameters used for the L2 regularization of the lifetime and the transaction covariate parameters. Lambdas have to be &gt;= 0.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Model parameters for the GGompertz/NBD model are <code>r, alpha, beta, b and s</code>. <br><code>r</code>: shape parameter of the Gamma distribution of the purchase process.
The smaller <code>r</code>, the stronger the heterogeneity of the purchase process.<br><code>alpha</code>: scale parameter of the Gamma distribution of the purchase process.<br><code>beta</code>: scale parameter for the Gamma distribution for the lifetime process.<br><code>b</code>: scale parameter of the Gompertz distribution (constant across customers).<br><code>s</code>: shape parameter of the Gamma distribution for the lifetime process.
The smaller <code>s</code>, the stronger the heterogeneity of customer lifetimes.
</p>
<p>If no start parameters are given, r=0.5, alpha=2, b=0.1, s=1, beta=0.1 is used.
All model start parameters are required to be &gt; 0. If no start values are given for the covariate parameters,
0.1 is used.
</p>
<p>Note that the DERT expression has not been derived (yet) and it consequently is not possible to calculated
values for DERT and CLV.
</p>


<h4>The Gamma-Gompertz/NBD model</h4>

<p>There are two key differences of the gamma/Gompertz/NBD (GGompertz/NBD) model compared to the relative to the well-known Pareto/NBD
model: (i) its probability density function can exhibit a mode at zero or an interior mode, and (ii) it can be skewed
to the right or to the left. Therefore, the GGompertz/NBD model is more flexible than the Pareto/NBD model.
According to Bemmaor and Glady (2012) can indicate substantial differences in expected residual lifetimes compared to the Pareto/NBD.
The GGompertz/NBD tends to be appropriate when firms are reputed and their offerings are differentiated.
</p>



<h3>Value</h3>

<p>Depending on the data object on which the model was fit, <code>ggomnbd</code> returns either an object of
class clv.ggomnbd or clv.ggomnbd.static.cov.
</p>
<p>The function <code>summary</code> can be used to obtain and print a summary of the results.
The generic accessor functions <code>coefficients</code>, <code>vcov</code>, <code>fitted</code>,
<code>logLik</code>, <code>AIC</code>, <code>BIC</code>, and <code>nobs</code> are available.
</p>


<h3>References</h3>

<p>Bemmaor AC, Glady N (2012). “Modeling Purchasing Behavior with Sudden “Death”: A Flexible Customer
Lifetime Model” Management Science, 58(5), 1012-1021.
</p>
<p>Adler J (2022).  “Comment on “Modeling Purchasing Behavior with Sudden “Death”: A Flexible Customer
Lifetime Model” Management Science 69(3):1929-1930.
</p>
<p>The expression for the PMF was derived by Adler J (2024). (unpublished)
</p>


<h3>See Also</h3>

<p><code>clvdata</code> to create a clv data object, <code>SetStaticCovariates</code>
to add static covariates to an existing clv data object.
</p>
<p>gg to fit customer's average spending per transaction with the <code>Gamma-Gamma</code> model
</p>
<p><code>predict</code> to predict expected transactions, probability of being alive, and customer lifetime value for every customer
</p>
<p><code>plot</code> to plot the unconditional expectation as predicted by the fitted model
</p>
<p><code>pmf</code> for the probability to make exactly x transactions in the estimation period, given by the probability mass function (PMF).
</p>
<p><code>newcustomer</code> to predict the expected number of transactions for an average new customer.
</p>
<p>The generic functions <code>vcov</code>, <code>summary</code>, <code>fitted</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data("apparelTrans")
clv.data.apparel &lt;- clvdata(apparelTrans, date.format = "ymd",
                            time.unit = "w", estimation.split = 52)

# Fit standard ggomnbd model
ggomnbd(clv.data.apparel)

# Give initial guesses for the model parameters
ggomnbd(clv.data.apparel,
     start.params.model = c(r=0.5, alpha=15, b=5, beta=10, s=0.5))


# pass additional parameters to the optimizer (optimx)
#    Use Nelder-Mead as optimization method and print
#    detailed information about the optimization process
apparel.ggomnbd &lt;- ggomnbd(clv.data.apparel,
                     optimx.args = list(method="Nelder-Mead",
                                        control=list(trace=6)))

# estimated coefs
coef(apparel.ggomnbd)

# summary of the fitted model
summary(apparel.ggomnbd)

# predict CLV etc for holdout period
predict(apparel.ggomnbd)

# predict CLV etc for the next 15 periods
predict(apparel.ggomnbd, prediction.end = 15)


# To estimate the ggomnbd model with static covariates,
#   add static covariates to the data
data("apparelStaticCov")
clv.data.static.cov &lt;-
 SetStaticCovariates(clv.data.apparel,
                     data.cov.life = apparelStaticCov,
                     names.cov.life = c("Gender", "Channel"),
                     data.cov.trans = apparelStaticCov,
                     names.cov.trans = c("Gender", "Channel"))

# Fit ggomnbd with static covariates
ggomnbd(clv.data.static.cov)

# Give initial guesses for both covariate parameters
ggomnbd(clv.data.static.cov, start.params.trans = c(Gender=0.75, Channel=0.7),
                   start.params.life  = c(Gender=0.5, Channel=0.5))

# Use regularization
ggomnbd(clv.data.static.cov, reg.lambdas = c(trans = 5, life=5))

# Force the same coefficient to be used for both covariates
ggomnbd(clv.data.static.cov, names.cov.constr = "Gender",
                   start.params.constr = c(Gender=0.5))

# Fit model only with the Channel covariate for life but
# keep all trans covariates as is
ggomnbd(clv.data.static.cov, names.cov.life = c("Channel"))

</code></pre>


</div>