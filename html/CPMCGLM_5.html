<div class="container">

<table style="width: 100%;"><tr>
<td>CPMCGLM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Correction of the significance level after multiple coding of an explanatory variable in generalized linear model.
</h2>

<h3>Description</h3>

<p>We propose to determine the correction of the significance 
level after multiple coding of an explanatory variable in 
Generalized Linear Model. The different methods of correction 
of the p-value are the Single step Bonferroni procedure, and 
resampling based methods developped by P.H.Westfall in 1993. 
Resampling methods are based on the permutation 
and the parametric bootstrap procedure. If some 
continuous, and dichotomous transformations are performed 
this package offers an exact correction of the p-value
developped by B.Liquet &amp; D.Commenges in 2005. The naive method
with no correction is also available.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CPMCGLM(formula, family, link, data, varcod, dicho, nb.dicho, categ, 
nb.categ, boxcox, nboxcox, FP , N=1000, cutpoint)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>

<p>an object of class "formula" : a symbolic description of the model to be fitted. The details of model specification are given under 'Details'.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>

<p>a description of the error distribution to be used in the model. This should be a character string naming a family function. The possible family functions are: "binomial", "gaussian", and "poisson".
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>

<p>a description of the link function to be used in the model. This needs to be a character string naming a link function. For the "gaussian" family, you must use the "identity" link.
For the "binomial" family function, "logit" and "probit" link are available. And for "Poisson" family function, you must use the "log" link function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>a data frame containing the variables of the model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varcod</code></td>
<td>

<p>a continuous variable that you want to transform.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dicho</code></td>
<td>

<p>a vector with the order of the quantile which are used for computing the cutpoint of each dichotomous transformation. The length of the vector corresponds to the number of transformation. If you specify this argument, "nb.dicho" must not be present.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb.dicho</code></td>
<td>

<p>if you do not enter the "dicho" argument, you can enter the number of dichotomous transformations that you want. The strategy of coding is presented in "Details" section.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>categ</code></td>
<td>

<p>a matrix with the order of quantile which are used for computing the categorical cutpoints of each transformation. The details of the "categ" specification are given under "Details". If you specify this argument, "nb.categ" must not be present.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb.categ</code></td>
<td>

<p>if you do not enter the "categ" argument, you can enter the number of categorical transformations that you want. The strategy of coding is presented in "Details" section.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boxcox</code></td>
<td>

<p>a vector of <code class="reqn">\lambda</code> parameters corresponding to each BoxCox transformation. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nboxcox</code></td>
<td>

<p>if you do not enter the "boxcox" argument, you can enter the number of boxcox transformations that you want. The maximum number of transformations that you can enter is 5. For the stategy of coding, it seems natural to try the crude variable (<code class="reqn">\lambda</code>1=1) and  the log transformation. When two transformations are condidered we
propose <code class="reqn">\lambda</code>1 =1 and  <code class="reqn">\lambda</code>2 =0. Further interesting transformations 
include the square <code class="reqn">\lambda</code>3 =2 and the square root <code class="reqn">\lambda</code>4 =0.5. Finally, the power <code class="reqn">\lambda</code>5 =3/2 may be tried.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FP</code></td>
<td>

<p>a matrix with powers which are used for computing each fractional polynomial transformations. The details of the "FP" specification are given under "Details" section.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>

<p>the number of resampling that you want to do.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutpoint</code></td>
<td>

<p>a matrix with the different numeric values for the cutpoints. The details of the cutpoint specification are given under 'Details'.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>- formula: A typical predictor has the form "response ~ terms" where "response" is the numeric response (possibly binary "0","1") vector and "terms" is a serie of terms which specifies a linear predictor for response.
</p>
<p>- nb.dicho: Dichotomous transformations include only the categorical transformations in two classes. The most natural method is to use a transformation based on the quantile. For one transformation, the median is used as a cutpoint for the dichotomous coding. 
For two transformations, the first tercile is used for the first dichotomous transformation, and the second tercile for the second one, and so on. 
</p>
<p>- categ: The categ argument needs to be a matrix. You need to have one line per transformation. Therefore, the dimension of the matrix is  nbq <code class="reqn">\times</code> maxq, where nbq is the number of transformations tried with the categ
transformations, and maxq is the maximum of number of quantiles that is used in one quantile transformation. 
</p>
<p>For example: 
</p>

<table>
<tr>
<td style="text-align: right;">
         [1,] </td>
<td style="text-align: left;"> 0.33 </td>
<td style="text-align: left;"> 0.66 </td>
<td style="text-align: left;"> NA </td>
<td style="text-align: left;"> NA</td>
</tr>
<tr>
<td style="text-align: right;">
         [2,] </td>
<td style="text-align: left;"> 0.25 </td>
<td style="text-align: left;"> 0.5 </td>
<td style="text-align: left;"> 0.75</td>
<td style="text-align: left;"> NA</td>
</tr>
<tr>
<td style="text-align: right;">
	       [3,] </td>
<td style="text-align: left;"> 0.2 </td>
<td style="text-align: left;"> 0.4 </td>
<td style="text-align: left;"> 0.6 </td>
<td style="text-align: left;"> 0.8 </td>
</tr>
<tr>
<td style="text-align: right;">
       </td>
</tr>
</table>
<p>In this example, three transformations are performed, so nbq=3. And maxq=4, because the maximum of number of quantiles that we used for the quintiles is 4. The first transformation leads to 
a categorical transformation in three classes, with cutpoints at the first and the second tercile. The second transformation allows to obtain a categorical variable in four classes with cutpoints
at the quartile. And the third one allows to obtain a variable in five classes with the cutpoints at the quintiles.
</p>
<p>- nb.categ: This concerns categorical transformations in more than two classes. Considering one of these transformations, the most intuitive method is to use a transformation in three classes at the tercile. For two of such transformations, we added the previous coding and a categorical transformation in four classes based on the quartile, and so on.
</p>
<p>- cutpoint: The cutpoint argument needs to be a matrix. The form of this matrix is similar as one of the quantile matrix. The number of rows corresponds to the number of tranformations (nbc)
tried with this method, and the number of columns corresponds to the maximum of cutpoints (maxc) that is used in one transformation. 
</p>
<p>For example: 
</p>

<table>
<tr>
<td style="text-align: right;">
         [1,] </td>
<td style="text-align: left;"> 8 </td>
<td style="text-align: left;"> 16 </td>
<td style="text-align: left;"> NA </td>
<td style="text-align: left;"> NA</td>
</tr>
<tr>
<td style="text-align: right;">
         [2,] </td>
<td style="text-align: left;"> 6 </td>
<td style="text-align: left;"> 12 </td>
<td style="text-align: left;"> 18</td>
<td style="text-align: left;"> NA</td>
</tr>
<tr>
<td style="text-align: right;">
	       [3,] </td>
<td style="text-align: left;"> 5 </td>
<td style="text-align: left;"> 10 </td>
<td style="text-align: left;"> 15 </td>
<td style="text-align: left;"> 20 </td>
</tr>
<tr>
<td style="text-align: right;">
       </td>
</tr>
</table>
<p>In this example,one wants to perform three transformations, hence the three rows. The first transformation leads to a categorical variable in three classes, with two cutpoints for the value "8",
and the value "16". The second transformation allows to obtain a categorical transformation in four classes, with cutpoints for values: "6","12" and "18". The last transformation tried allows to obtain
a categorical transformation in five classes with cutpoint for values: "5","10","15", and "20". 
Therefore, we used four columns because four is the maximum of cutpoints used, in the third transformation.
</p>
<p>- FP: The FP argument needs to be a matrix.  The number of rows correspond to the number of transformations tested, and the number of columns is the maximum number of degrees tested for a single transformation.
</p>
<p>For example:
</p>

<table>
<tr>
<td style="text-align: right;">
         [1,] </td>
<td style="text-align: left;"> -2 </td>
<td style="text-align: left;"> NA </td>
<td style="text-align: left;"> NA </td>
<td style="text-align: left;"> NA</td>
</tr>
<tr>
<td style="text-align: right;">
         [2,] </td>
<td style="text-align: left;"> 0.5 </td>
<td style="text-align: left;"> 1 </td>
<td style="text-align: left;"> -0.5</td>
<td style="text-align: left;"> 2</td>
</tr>
<tr>
<td style="text-align: right;">
	       [3,] </td>
<td style="text-align: left;"> -0.5 </td>
<td style="text-align: left;"> 1 </td>
<td style="text-align: left;"> NA </td>
<td style="text-align: left;"> NA </td>
</tr>
<tr>
<td style="text-align: right;">
       </td>
</tr>
</table>
<p>In this example, the user performs three transformations of the variable of interest. The first is a fractional polynomial transformation with one degree and a power of -2. The second transformation is a fractional polynomial transformation with four degrees and powers of 0.5,1,-0.5,and 2. The third transformation is a fractional polynomial transformation with two degrees and powers of  -0.5, and 1.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the code used for the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>the number of subjects in the dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>the number of resampling.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>the family function used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>
<p>the link function used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbt</code></td>
<td>
<p>the number of score tests realised.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbb</code></td>
<td>
<p>the number of score tests realised with BoxCox transformation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbq</code></td>
<td>
<p>the number of score tests realised with Quantile transformation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbc</code></td>
<td>
<p>the number of score tests realised with Cutpoint transformation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vq</code></td>
<td>
<p>the vector quantiles' values for the best coding.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adj</code></td>
<td>
<p>the number of adjustment variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trans</code></td>
<td>
<p>the method of transformation for each coding.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BC</code></td>
<td>
<p>the method of the best transformation: "Dichotomous", "Categorical", "Boxcox", "Continuous","Cutpoint".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bestcod</code></td>
<td>
<p>the corresponding value of the transformation parameter for the best transformation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>naive.pvalue</code></td>
<td>
<p>the Pvalue of the best association without correction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exact.pvalue</code></td>
<td>
<p>the adjusted Pvalue of the best association with an exact correction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bonferroni.adjusted.pvalue</code></td>
<td>
<p>the adjusted Pvalue of the best association with the Bonferroni correction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parametric.bootstrap.adjusted.pvalue</code></td>
<td>
<p>the adjusted Pvalue of the best association with the parametric bootstrap correction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>permutation.adjusted.pvalue</code></td>
<td>
<p>the adjusted Pvalue of the best association with the permutation correction.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>J.Riou, A.Diakite, and B.Liquet
</p>


<h3>References</h3>

<p>Liquet, B. and Commenges, D. (2005). Computation of the p-value of the minimum of score tests in the
generalized linear model, application to multiple coding. <em>Statistics &amp; Probability Letters</em>, 71:33-38.
</p>
<p>Liquet, B. and Commenges, D. (2001). Correction of the p-value after multiple coding of anexplanatory
variable in logistic regression. <em>Statistics in Medicine</em>, 20:2815-2826.
</p>
<p>Westfall, P. H. and Young, S. (1992). Resampling-based multiple testing: examples and methods for pvalue
adjustment. Wiley Series in Probability and Mathematical Statistics. <em>Applied Probability and
Statistics</em>. New York, NY: Wiley. xvii, 340 p.
</p>
<p>Yu, K., Liang, F., Ciampa, J., and Chatterjee, N. (2011). Efficient p-value evaluation for resampling-based
tests. <em>Biostatistics</em>, 12(3):582-593.
</p>


<h3>See Also</h3>

<p><code>print.CPMCGLM</code>, <code>summary.CPMCGLM</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 

# load data
data(data_sim)
#
#Example of quantile matrix definition
	
#Linear Gaussian Model

fit1 &lt;- CPMCGLM(formula= Weight~Age+as.factor(Sport)+Desease+Height,
family="gaussian",link="identity",data=data_sim,varcod="Age",N=1000,
boxcox=c(0,1,2,3),nb.dicho=3,nb.categ=4)
### print fit1
fit1
### summary fit1
summary(fit1)

#Loglinear Poisson Model
fit2 &lt;- CPMCGLM(formula= Stroke~Age+as.factor(Sport)+Height+Weight,
family="poisson",link="log",data=data_sim,varcod="Age",N=1000,
boxcox=c(0,1,2,3))

### print fit2
fit2 
### summary fit2
summary(fit2)

#Logit Model
FP1 &lt;-  matrix(NA,ncol=4,nrow=3)
FP1[1,1] &lt;- -2
FP1[2,] &lt;- c(0.5,1,-0.5,2)
FP1[3,1:2] &lt;- c(-0.5,1)

fit3 &lt;- CPMCGLM(formula= Parameter~Age+as.factor(Sport)+Height+Weight,
family="binomial",link="logit",data=data_sim,varcod="Age",N=1000,
boxcox=c(0,1,2,3),nb.dicho=3,FP=FP1)
### print fit3
fit3 
### summary fit3
summary(fit3)

#Probit Model

fit4 &lt;- CPMCGLM(formula= Parameter~Age+as.factor(Sport)+Height+Weight,
family="binomial",link="probit",data=data_sim,varcod="Age",N=1000,
nboxcox=2,nb.categ=4)
### print fit4
fit4 
### summary fit4
summary(fit4)

## End(Not run)
</code></pre>


</div>