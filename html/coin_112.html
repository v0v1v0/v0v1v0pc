<div class="container">

<table style="width: 100%;"><tr>
<td>SurvivalTests</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Two- and <code class="reqn">K</code>-Sample Tests for Censored Data</h2>

<h3>Description</h3>

<p>Testing the equality of the survival distributions in two or more independent
groups.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'formula'
logrank_test(formula, data, subset = NULL, weights = NULL, ...)
## S3 method for class 'IndependenceProblem'
logrank_test(object, ties.method = c("mid-ranks", "Hothorn-Lausen",
                                     "average-scores"),
             type = c("logrank", "Gehan-Breslow", "Tarone-Ware",
                      "Peto-Peto", "Prentice", "Prentice-Marek",
                      "Andersen-Borgan-Gill-Keiding",
                      "Fleming-Harrington", "Gaugler-Kim-Liao", "Self"),
             rho = NULL, gamma = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>

<p>a formula of the form <code>y ~ x | block</code> where <code>y</code> is a survival
object (see <code>Surv</code> in package <span class="pkg">survival</span>),
<code>x</code> is a factor and <code>block</code> is an optional factor for
stratification.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>an optional data frame containing the variables in the model formula.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>

<p>an optional vector specifying a subset of observations to be used.  Defaults
to <code>NULL</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>

<p>an optional formula of the form <code>~ w</code> defining integer valued case
weights for each observation.  Defaults to <code>NULL</code>, implying equal
weight for all observations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>an object inheriting from class <code>"IndependenceProblem"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ties.method</code></td>
<td>

<p>a character, the method used to handle ties: the score generating function
either uses mid-ranks (<code>"mid-ranks"</code>, default), the Hothorn-Lausen
method (<code>"Hothorn-Lausen"</code>) or averages the scores of randomly broken
ties (<code>"average-scores"</code>); see ‘Details’.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>a character, the type of test: either <code>"logrank"</code> (default),
<code>"Gehan-Breslow"</code>, <code>"Tarone-Ware"</code>, <code>"Peto-Peto"</code>,
<code>"Prentice"</code>, <code>"Prentice-Marek"</code>,
<code>"Andersen-Borgan-Gill-Keiding"</code>, <code>"Fleming-Harrington"</code>,
<code>"Gaugler-Kim-Liao"</code> or <code>"Self"</code>; see
‘Details’.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>

<p>a numeric, the <code class="reqn">\rho</code> constant when <code>type</code> is <code>"Tarone-Ware"</code>,
<code>"Fleming-Harrington"</code>, <code>"Gaugler-Kim-Liao"</code> or <code>"Self"</code>; see
‘Details’.  Defaults to <code>NULL</code>, implying <code>0.5</code> for
<code>type = "Tarone-Ware"</code> and <code>0</code> otherwise.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>

<p>a numeric, the <code class="reqn">\gamma</code> constant when <code>type</code> is
<code>"Fleming-Harrington"</code>, <code>"Gaugler-Kim-Liao"</code> or <code>"Self"</code>; see
‘Details’.  Defaults to <code>NULL</code>, implying <code>0</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>further arguments to be passed to <code>independence_test()</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>logrank_test()</code> provides the weighted logrank test reformulated as a
linear rank test.  The family of weighted logrank tests encompasses a large
collection of tests commonly used in the analysis of survival data including,
but not limited to, the standard (unweighted) logrank test, the Gehan-Breslow
test, the Tarone-Ware class of tests, the Peto-Peto test, the Prentice test,
the Prentice-Marek test, the Andersen-Borgan-Gill-Keiding test, the
Fleming-Harrington class of tests, the Gaugler-Kim-Liao class of tests and the
Self class of tests.  A general description of these methods is given by Klein
and Moeschberger (2003, Ch. 7).  See Letón and Zuluaga (2001) for
the linear rank test formulation.
</p>
<p>The null hypothesis of equality, or conditional equality given <code>block</code>,
of the survival distribution of <code>y</code> in the groups defined by <code>x</code> is
tested.  In the two-sample case, the two-sided null hypothesis is <code class="reqn">H_0\!:
    \theta = 1</code>, where <code class="reqn">\theta = \lambda_2 / \lambda_1</code>
and <code class="reqn">\lambda_s</code> is the hazard rate in the <code class="reqn">s</code>th sample.  In case
<code>alternative = "less"</code>, the null hypothesis is <code class="reqn">H_0\!: \theta \ge
    1</code>, i.e., the survival is lower in sample 1 than in sample
2.  When <code>alternative = "greater"</code>, the null hypothesis is <code class="reqn">H_0\!:
    \theta \le 1</code>, i.e., the survival is higher in sample 1
than in sample 2.
</p>
<p>If <code>x</code> is an ordered factor, the default scores, <code>1:nlevels(x)</code>, can
be altered using the <code>scores</code> argument (see
<code>independence_test()</code>); this argument can also be used to coerce
nominal factors to class <code>"ordered"</code>.  In this case, a linear-by-linear
association test is computed and the direction of the alternative hypothesis
can be specified using the <code>alternative</code> argument.  This type of
extension of the standard logrank test was given by Tarone (1975) and later
generalized to general weights by Tarone and Ware (1977).
</p>
<p>Let <code class="reqn">(t_i, \delta_i)</code>, <code class="reqn">i = 1, 2, \ldots, n</code>, represent a
right-censored random sample of size <code class="reqn">n</code>, where <code class="reqn">t_i</code> is the observed
survival time and <code class="reqn">\delta_i</code> is the status indicator (<code class="reqn">\delta_i</code> is 0
for right-censored observations and 1 otherwise).  To allow for ties in the
data, let <code class="reqn">t_{(1)} &lt; t_{(2)} &lt; \cdots &lt; t_{(m)}</code> represent the <code class="reqn">m</code>, <code class="reqn">m \le n</code>, ordered distinct event times.
At time <code class="reqn">t_{(k)}</code>, <code class="reqn">k = 1, 2, \ldots, m</code>, the number of events
and the number of subjects at risk are given by <code class="reqn">d_k = \sum_{i = 1}^n
    I\!\left(t_i = t_{(k)}\,|\, \delta_i = 1\right)</code> and <code class="reqn">n_k = n - r_k</code>, respectively, where
<code class="reqn">r_k</code> depends on the ties handling method.
</p>
<p>Three different methods of handling ties are available using
<code>ties.method</code>: mid-ranks (<code>"mid-ranks"</code>, default), the
Hothorn-Lausen method (<code>"Hothorn-Lausen"</code>) and average-scores
(<code>"average-scores"</code>).  The first and last method are discussed and
contrasted by Callaert (2003), whereas the second method is defined in Hothorn
and Lausen (2003).  The mid-ranks method leads to
</p>
<p style="text-align: center;"><code class="reqn">
    r_k = \sum_{i = 1}^n I\!\left(t_i &lt; t_{(k)}\right)
  </code>
</p>

<p>whereas the Hothorn-Lausen method uses
</p>
<p style="text-align: center;"><code class="reqn">
    r_k = \sum_{i = 1}^n I\!\left(t_i \le t_{(k)}\right) - 1.
  </code>
</p>

<p>The scores assigned to right-censored and uncensored observations at the
<code class="reqn">k</code>th event time are given by
</p>
<p style="text-align: center;"><code class="reqn">
    C_k = \sum_{j = 1}^k w_j \frac{d_j}{n_j}
    \quad \mathrm{and} \quad
    c_k = C_k - w_k,
  </code>
</p>

<p>respectively, where <code class="reqn">w</code> is the logrank weight.  For the average-scores
method, used by, e.g., the software package StatXact, the <code class="reqn">d_k</code> events
observed at the <code class="reqn">k</code>th event time are arbitrarily ordered by assigning them
distinct values <code class="reqn">t_{(k_l)}</code>, <code class="reqn">l = 1, 2, \ldots, d_k</code>,
infinitesimally to the left of <code class="reqn">t_{(k)}</code>.  Then scores
<code class="reqn">C_{k_l}</code> and <code class="reqn">c_{k_l}</code> are computed as indicated above,
effectively assuming that no event times are tied.  The scores <code class="reqn">C_k</code> and
<code class="reqn">c_k</code> are assigned the average of the scores <code class="reqn">C_{k_l}</code> and
<code class="reqn">c_{k_l}</code>, respectively.  It then follows that the score for the
<code class="reqn">i</code>th subject is
</p>
<p style="text-align: center;"><code class="reqn">
    a_i = \left\{
      \begin{array}{ll}
        C_{k'} &amp; \mathrm{if}~\delta_i = 0 \\
        c_{k'} &amp; \mathrm{otherwise}
      \end{array}
    \right.
  </code>
</p>

<p>where <code class="reqn">k' = \max \{k: t_i \ge t_{(k)}\}</code>.
</p>
<p>The <code>type</code> argument allows for a choice between some of the most
well-known members of the family of weighted logrank tests, each corresponding
to a particular weight function.  The standard logrank test (<code>"logrank"</code>,
default) was suggested by Mantel (1966), Peto and Peto (1972) and Cox (1972)
and has <code class="reqn">w_k = 1</code>.  The Gehan-Breslow test (<code>"Gehan-Breslow"</code>)
proposed by Gehan (1965) and later extended to <code class="reqn">K</code> samples by Breslow
(1970) is a generalization of the Wilcoxon rank-sum test, where <code class="reqn">w_k =
    n_k</code>.  The Tarone-Ware class of tests (<code>"Tarone-Ware"</code>) discussed by
Tarone and Ware (1977) has <code class="reqn">w_k = n_k^\rho</code>, where <code class="reqn">\rho</code> is a
constant; <code class="reqn">\rho = 0.5</code> (default) was suggested by Tarone and Ware (1977),
but note that <code class="reqn">\rho = 0</code> and <code class="reqn">\rho = 1</code> lead to the standard logrank
test and Gehan-Breslow test, respectively.  The Peto-Peto test
(<code>"Peto-Peto"</code>) suggested by Peto and Peto (1972) is another
generalization of the Wilcoxon rank-sum test, where
</p>
<p style="text-align: center;"><code class="reqn">
    w_k = \hat{S}_k = \prod_{j = 0}^{k - 1} \frac{n_j - d_j}{n_j}
  </code>
</p>

<p>is the <em>left-continuous</em> Kaplan-Meier estimator of the survival function,
<code class="reqn">n_0 \equiv n</code> and <code class="reqn">d_0 \equiv 0</code>.  The Prentice
test (<code>"Prentice"</code>) is also a generalization of the Wilcoxon rank-sum
test proposed by Prentice (1978), where
</p>
<p style="text-align: center;"><code class="reqn">
    w_k = \prod_{j = 1}^k \frac{n_j}{n_j + d_j}.
  </code>
</p>

<p>The Prentice-Marek test (<code>"Prentice-Marek"</code>) is yet another
generalization of the Wilcoxon rank-sum test discussed by Prentice and Marek
(1979), with
</p>
<p style="text-align: center;"><code class="reqn">
    w_k = \tilde{S}_k = \prod_{j = 1}^k \frac{n_j + 1 - d_j}{n_j + 1}.
  </code>
</p>

<p>The Andersen-Borgan-Gill-Keiding test (<code>"Andersen-Borgan-Gill-Keiding"</code>)
suggested by Andersen <em>et al.</em> (1982) is a modified version of the
Prentice-Marek test using
</p>
<p style="text-align: center;"><code class="reqn">
    w_k = \frac{n_k}{n_k + 1} \prod_{j = 0}^{k - 1} \frac{n_j + 1 - d_j}{n_j + 1},
  </code>
</p>

<p>where, again, <code class="reqn">n_0 \equiv n</code> and <code class="reqn">d_0 \equiv 0</code>.
The Fleming-Harrington class of tests (<code>"Fleming-Harrington"</code>) proposed
by Fleming and Harrington (1991) uses <code class="reqn">w_k = \hat{S}_k^\rho (1 -
    \hat{S}_k)^\gamma</code>, where <code class="reqn">\rho</code>
and <code class="reqn">\gamma</code> are constants; <code class="reqn">\rho = 0</code> and <code class="reqn">\gamma = 0</code> lead to
the standard logrank test, while <code class="reqn">\rho = 1</code> and <code class="reqn">\gamma = 0</code> result in
the Peto-Peto test.  The Gaugler-Kim-Liao class of tests
(<code>"Gaugler-Kim-Liao"</code>) discussed by Gaugler <em>et al.</em> (2007) is a
modified version of the Fleming-Harrington class of tests, replacing
<code class="reqn">\hat{S}_k</code> with <code class="reqn">\tilde{S}_k</code> so that <code class="reqn">w_k =
    \tilde{S}_k^\rho (1 - \tilde{S}_k)^\gamma</code>, where <code class="reqn">\rho</code> and <code class="reqn">\gamma</code> are constants; <code class="reqn">\rho
    = 0</code> and <code class="reqn">\gamma = 0</code> lead to the standard logrank test, whereas
<code class="reqn">\rho = 1</code> and <code class="reqn">\gamma = 0</code> result in the Prentice-Marek test.  The
Self class of tests (<code>"Self"</code>) suggested by Self (1991) has <code class="reqn">w_k =
    v_k^\rho (1 - v_k)^\gamma</code>, where
</p>
<p style="text-align: center;"><code class="reqn">
    v_k = \frac{1}{2} \frac{t_{(k-1)} + t_{(k)}}{t_{(m)}},
    \quad
    t_{(0)} \equiv 0
  </code>
</p>

<p>is the standardized mid-point between the <code class="reqn">(k - 1)</code>th and the <code class="reqn">k</code>th
event time.  (This is a slight generalization of Self's original proposal in
order to allow for non-integer follow-up times.)  Again, <code class="reqn">\rho</code> and
<code class="reqn">\gamma</code> are constants and <code class="reqn">\rho = 0</code> and <code class="reqn">\gamma = 0</code> lead to
the standard logrank test.
</p>
<p>The conditional null distribution of the test statistic is used to obtain
<code class="reqn">p</code>-values and an asymptotic approximation of the exact distribution is
used by default (<code>distribution = "asymptotic"</code>).  Alternatively, the
distribution can be approximated via Monte Carlo resampling or computed
exactly for univariate two-sample problems by setting <code>distribution</code> to
<code>"approximate"</code> or <code>"exact"</code>, respectively.  See
<code>asymptotic()</code>, <code>approximate()</code> and
<code>exact()</code> for details.
</p>


<h3>Value</h3>

<p>An object inheriting from class <code>"IndependenceTest"</code>.
</p>


<h3>Note</h3>

<p>Peto and Peto (1972) proposed the test statistic implemented in
<code>logrank_test()</code> and named it the <em>logrank test</em>.  However, the
Mantel-Cox test (Mantel, 1966; Cox, 1972), as implemented in
<code>survdiff()</code> (in package <span class="pkg">survival</span>), is also known
as the logrank test.  These tests are similar, but differ in the choice of
probability model: the (Peto-Peto) logrank test uses the permutational
variance, whereas the Mantel-Cox test is based on the hypergeometric variance.
</p>
<p>Combining <code>independence_test()</code> or <code>symmetry_test()</code>
with <code>logrank_trafo()</code> offers more flexibility than
<code>logrank_test()</code> and allows for, among other things, maximum-type
versatile test procedures (e.g., Lee, 1996; see ‘Examples’) and
user-supplied logrank weights (see <code>GTSG</code> for tests against
Weibull-type or crossing-curve alternatives).
</p>
<p>Starting with <span class="pkg">coin</span> version 1.1-0, <code>logrank_test()</code> replaced
<code>surv_test()</code> which was made <strong>defunct</strong> in version 1.2-0.
Furthermore, <code>logrank_trafo()</code> is now an increasing function for all
choices of <code>ties.method</code>, implying that the test statistic has the same
sign irrespective of the ties handling method.  Consequently, the sign of the
test statistic will now be the opposite of what it was in earlier versions
unless <code>ties.method = "average-scores"</code>.  (In versions of <span class="pkg">coin</span>
prior to 1.1-0, <code>logrank_trafo()</code> was a decreasing function when
<code>ties.method</code> was other than <code>"average-scores"</code>.)
</p>
<p>Starting with <span class="pkg">coin</span> version 1.2-0, mid-ranks and the Hothorn-Lausen
method can no longer be specified with <code>ties.method = "logrank"</code> and
<code>ties-method = "HL"</code> respectively.
</p>


<h3>References</h3>

<p>Andersen, P. K., Borgan, Ø., Gill, R. and Keiding, N.  (1982).
Linear nonparametric tests for comparison of counting processes, with
applications to censored survival data (with discussion).  <em>International
Statistical Review</em> <b>50</b>(3), 219–258.  <a href="https://doi.org/10.2307/1402489">doi:10.2307/1402489</a>
</p>
<p>Breslow, N.  (1970).  A generalized Kruskal-Wallis test for comparing <code class="reqn">K</code>
samples subject to unequal patterns of censorship.  <em>Biometrika</em>
<b>57</b>(3), 579–594.  <a href="https://doi.org/10.1093/biomet/57.3.579">doi:10.1093/biomet/57.3.579</a>
</p>
<p>Callaert, H.  (2003).  Comparing statistical software packages: The case of
the logrank test in StatXact.  <em>The American Statistician</em> <b>57</b>(3),
214–217.  <a href="https://doi.org/10.1198/0003130031900">doi:10.1198/0003130031900</a>
</p>
<p>Cox, D. R. (1972).  Regression models and life-tables (with discussion).
<em>Journal of the Royal Statistical Society</em> B <b>34</b>(2), 187–220.
<a href="https://doi.org/10.1111/j.2517-6161.1972.tb00899.x">doi:10.1111/j.2517-6161.1972.tb00899.x</a>
</p>
<p>Fleming, T. R. and Harrington, D. P.  (1991).  <em>Counting Processes and
Survival Analysis</em>.  New York: John Wiley &amp; Sons.
</p>
<p>Gaugler, T., Kim, D. and Liao, S.  (2007).  Comparing two survival time
distributions: An investigation of several weight functions for the weighted
logrank statistic.  <em>Communications in Statistics – Simulation and
Computation</em> <b>36</b>(2), 423–435.  <a href="https://doi.org/10.1080/03610910601161272">doi:10.1080/03610910601161272</a>
</p>
<p>Gehan, E. A.  (1965).  A generalized Wilcoxon test for comparing arbitrarily
single-censored samples.  <em>Biometrika</em> <b>52</b>(1–2), 203–223.
<a href="https://doi.org/10.1093/biomet/52.1-2.203">doi:10.1093/biomet/52.1-2.203</a>
</p>
<p>Hothorn, T. and Lausen, B.  (2003).  On the exact distribution of maximally
selected rank statistics.  <em>Computational Statistics &amp; Data Analysis</em>
<b>43</b>(2), 121–137.  <a href="https://doi.org/10.1016/S0167-9473%2802%2900225-6">doi:10.1016/S0167-9473(02)00225-6</a>
</p>
<p>Klein, J. P. and Moeschberger, M. L.  (2003).  <em>Survival Analysis:
Techniques for Censored and Truncated Data</em>, Second Edition.  New York:
Springer.
</p>
<p>Lee, J. W.  (1996).  Some versatile tests based on the simultaneous use of
weighted log-rank statistics.  <em>Biometrics</em> <b>52</b>(2), 721–725.
<a href="https://doi.org/10.2307/2532911">doi:10.2307/2532911</a>
</p>
<p>Letón, E. and Zuluaga, P.  (2001).  Equivalence between score
and weighted tests for survival curves.  <em>Communications in Statistics –
Theory and Methods</em> <b>30</b>(4), 591–608.  <a href="https://doi.org/10.1081/STA-100002138">doi:10.1081/STA-100002138</a>
</p>
<p>Mantel, N.  (1966).  Evaluation of survival data and two new rank order
statistics arising in its consideration.  <em>Cancer Chemotherapy Reports</em>
<b>50</b>(3), 163–170.
</p>
<p>Peto, R. and Peto, J.  (1972).  Asymptotic efficient rank invariant test
procedures (with discussion).  <em>Journal of the Royal Statistical Society</em>
A <b>135</b>(2), 185–207.  <a href="https://doi.org/10.2307/2344317">doi:10.2307/2344317</a>
</p>
<p>Prentice, R. L.  (1978).  Linear rank tests with right censored data.
<em>Biometrika</em> <b>65</b>(1), 167–179.  <a href="https://doi.org/10.1093/biomet/65.1.167">doi:10.1093/biomet/65.1.167</a>
</p>
<p>Prentice, R. L. and Marek, P.  (1979).  A qualitative discrepancy between
censored data rank tests.  <em>Biometrics</em> <b>35</b>(4), 861–867.
<a href="https://doi.org/10.2307/2530120">doi:10.2307/2530120</a>
</p>
<p>Self, S. G.  (1991).  An adaptive weighted log-rank test with application to
cancer prevention and screening trials.  <em>Biometrics</em> <b>47</b>(3),
975–986.  <a href="https://doi.org/10.2307/2532653">doi:10.2307/2532653</a>
</p>
<p>Tarone, R. E.  (1975).  Tests for trend in life table analysis.
<em>Biometrika</em> <b>62</b>(3), 679–682.  <a href="https://doi.org/10.1093/biomet/62.3.679">doi:10.1093/biomet/62.3.679</a>
</p>
<p>Tarone, R. E. and Ware, J.  (1977).  On distribution-free tests for equality
of survival distributions.  <em>Biometrika</em> <b>64</b>(1), 156–160.
<a href="https://doi.org/10.1093/biomet/64.1.156">doi:10.1093/biomet/64.1.156</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Example data (Callaert, 2003, Tab. 1)
callaert &lt;- data.frame(
    time = c(1, 1, 5, 6, 6, 6, 6, 2, 2, 2, 3, 4, 4, 5, 5),
    group = factor(rep(0:1, c(7, 8)))
)

## Logrank scores using mid-ranks (Callaert, 2003, Tab. 2)
with(callaert,
     logrank_trafo(Surv(time)))

## Asymptotic Mantel-Cox test (p = 0.0523)
survdiff(Surv(time) ~ group, data = callaert)

## Exact logrank test using mid-ranks (p = 0.0505)
logrank_test(Surv(time) ~ group, data = callaert, distribution = "exact")

## Exact logrank test using average-scores (p = 0.0468)
logrank_test(Surv(time) ~ group, data = callaert, distribution = "exact",
             ties.method = "average-scores")


## Lung cancer data (StatXact 9 manual, p. 213, Tab. 7.19)
lungcancer &lt;- data.frame(
    time = c(257, 476, 355, 1779, 355,
             191, 563, 242, 285, 16, 16, 16, 257, 16),
    event = c(0, 0, 1, 1, 0,
              1, 1, 1, 1, 1, 1, 1, 1, 1),
    group = factor(rep(1:2, c(5, 9)),
                   labels = c("newdrug", "control"))
)

## Logrank scores using average-scores (StatXact 9 manual, p. 214)
with(lungcancer,
     logrank_trafo(Surv(time, event), ties.method = "average-scores"))

## Exact logrank test using average-scores (StatXact 9 manual, p. 215)
logrank_test(Surv(time, event) ~ group, data = lungcancer,
             distribution = "exact", ties.method = "average-scores")

## Exact Prentice test using average-scores (StatXact 9 manual, p. 222)
logrank_test(Surv(time, event) ~ group, data = lungcancer,
             distribution = "exact", ties.method = "average-scores",
             type = "Prentice")


## Approximative (Monte Carlo) versatile test (Lee, 1996)
rho.gamma &lt;- expand.grid(rho = seq(0, 2, 1), gamma = seq(0, 2, 1))
lee_trafo &lt;- function(y)
    logrank_trafo(y, ties.method = "average-scores",
                  type = "Fleming-Harrington",
                  rho = rho.gamma["rho"], gamma = rho.gamma["gamma"])

it &lt;- independence_test(Surv(time, event) ~ group, data = lungcancer,
                        distribution = approximate(nresample = 10000),
                        ytrafo = function(data)
                            trafo(data, surv_trafo = lee_trafo))
pvalue(it, method = "step-down")
</code></pre>


</div>