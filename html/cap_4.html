<div class="container">

<table style="width: 100%;"><tr>
<td>cap_beta</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Inference of model coefficients
</h2>

<h3>Description</h3>

<p> This function performs inference on the model coefficient <code class="reqn">\beta</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cap_beta(Y, X, gamma = NULL, beta = NULL, method = c("asmp", "LLR"), 
    boot = FALSE, sims = 1000, boot.ci.type = c("bca", "perc"), 
    conf.level = 0.95, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p> a data list of length <code class="reqn">n</code>. Each list element is a <code class="reqn">T\times p</code> matrix, the data matrix of <code class="reqn">T</code> observations from <code class="reqn">p</code> features.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p> a <code class="reqn">n\times q</code> data matrix, the covariate matrix of <code class="reqn">n</code> subjects with <code class="reqn">q-1</code> predictors. The first column is all ones.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p> a <code class="reqn">p</code>-dimensional vector, the projecting direction <code class="reqn">\gamma</code>. Default is <code>NULL</code>. If <code>gamma = NULL</code>, an error warning will be returned.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p> a <code class="reqn">q</code>-dimensional vector, the model coefficient <code class="reqn">\beta</code>. Default is <code>NULL</code>. If <code>beta = NULL</code>, when <code>boot = FALSE</code>, <code class="reqn">\beta</code> will be estimated using the provided <code class="reqn">\gamma</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p> a character of inference method. If <code>method = "asmp"</code>, the inference is made based on the asymptotic variance; if <code>method = "LLR"</code>, the likelihood ratio test is conducted. When <code>boot = TRUE</code>, this argument is ignored.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot</code></td>
<td>
<p> a logic variable, whether bootstrap inference is performed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sims</code></td>
<td>
<p> a numeric value, the number of bootstrap iterations will be performed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot.ci.type</code></td>
<td>
<p> a character of the way of calculating bootstrap confidence interval. If <code>boot.ci.type = "bca"</code>, the bias corrected confidence interval is returned; if <code>boot.ci.type = "perc"</code>, the percentile confidence interval is returned.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p> a numeric value, the designated significance level. Default is <code class="reqn">0.95</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p> a logic variable, whether the bootstrap procedure is printed. Default is <code>TRUE</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p> Considering <code class="reqn">y_{it}</code> are <code class="reqn">p</code>-dimensional independent and identically distributed random samples from a multivariate normal distribution with mean zero and covariance matrix <code class="reqn">\Sigma_{i}</code>. We assume there exits a <code class="reqn">p</code>-dimensional vector <code class="reqn">\gamma</code> such that <code class="reqn">z_{it}:=\gamma'y_{it}</code> satisfies the multiplicative heteroscedasticity:
</p>
<p style="text-align: center;"><code class="reqn">\log(\mathrm{Var}(z_{it}))=\log(\gamma'\Sigma_{i}\gamma)=\beta_{0}+x_{i}'\beta_{1},</code>
</p>

<p>where <code class="reqn">x_{i}</code> contains explanatory variables of subject <code class="reqn">i</code>, and <code class="reqn">\beta_{0}</code> and <code class="reqn">\beta_{1}</code> are model coefficients.
</p>
<p>The <code class="reqn">\beta</code> coefficient is estimated by maximizing the likelihood function. The asymptotic variance is obtained based on maximum likelihood estimator theory.
</p>


<h3>Value</h3>

<p> When <code>method = "asmp"</code>, the output is a <code class="reqn">q \times 6</code> data frame containing the estimate of <code class="reqn">\beta</code> coefficient, the asymptotic standard error, the test statistic, the <code class="reqn">p</code>-value, and the lower and upper bound of the confidence interval.
</p>
<p>When <code>method = "LLR"</code>, the output is a <code class="reqn">q \times 3</code> data frame containing the estimate of <code class="reqn">\beta</code> coefficient, the test statistic, and the <code class="reqn">p</code>-value.
</p>
<p>When <code>boot = TRUE</code>,
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Inference</code></td>
<td>
<p>point estimate of the <code class="reqn">\beta</code> coefficient, as well as the corresponding standard error, test statistic, <code class="reqn">p</code>-value, and the lower and upper bound of the confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.boot</code></td>
<td>
<p>the estimate of the <code class="reqn">\beta</code> coefficient in each iteration.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Yi Zhao, Johns Hopkins University, &lt;zhaoyi1026@gmail.com&gt; 
</p>
<p>Bingkai Wang, Johns Hopkins University, &lt;bwang51@jhmi.edu&gt;
</p>
<p>Stewart Mostofsky, Johns Hopkins University, &lt;mostofsky@kennedykrieger.org&gt; 
</p>
<p>Brian Caffo, Johns Hopkins University, &lt;bcaffo@gmail.com&gt; 
</p>
<p>Xi Luo, Brown University, &lt;xi.rossi.luo@gmail.com&gt; 
</p>


<h3>References</h3>

<p>Zhao et al. (2018) <em>Covariate Assisted Principal Regression for Covariance Matrix Outcomes</em> &lt;doi:10.1101/425033&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R">
#############################################
data(env.example)
X&lt;-get("X",env.example)
Y&lt;-get("Y",env.example)
Phi&lt;-get("Phi",env.example)

# asymptotic variance
re1&lt;-cap_beta(Y,X,gamma=Phi[,2],method=c("asmp"),boot=FALSE)

# likelihood ratio test
re2&lt;-cap_beta(Y,X,gamma=Phi[,2],method=c("LLR"),boot=FALSE)

# bootstrap confidence interval

re3&lt;-cap_beta(Y,X,gamma=Phi[,2],boot=TRUE,sims=500,verbose=FALSE)

#############################################
</code></pre>


</div>