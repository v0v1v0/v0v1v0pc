<div class="container">

<table style="width: 100%;"><tr>
<td>combine_loci</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Combine the genotype frequencies and transition matrices of two genetic loci</h2>

<h3>Description</h3>

<p>A function to calculate the genotype frequencies and the transition matrices
for the joint genotypes of two unlinked genetic loci in linkage
equilibrium, given the corresponding objects for the separate loci.
The results from this function can be used as inputs to
<code>pedigree_loglikelihood</code> or
<code>genotype_probabilities</code>
to model the combined effect of the two loci on phenotypes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">combine_loci(geno_freq1, geno_freq2, trans1, trans2, annotate = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>geno_freq1</code></td>
<td>
<p>A vector of strictly positive numbers that sum to <code>1</code>,
with <code>geno_freq1[i]</code> interpreted as the population genotype frequency of the
<code>i</code>th possible genotype at a genetic locus (locus 1).
When <code>annotate</code> is <code>TRUE</code>, the names of the genotypes at locus 1 will be
taken to be <code>names(geno_freq1)</code> or, if <code>names(geno_freq1)</code> is <code>NULL</code>, to be
<code>1:length(geno_freq1)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>geno_freq2</code></td>
<td>
<p>Similar to <code>geno_freq1</code> (above) but interpreted as the
population genotype frequencies for a different genetic locus (locus 2).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trans1</code></td>
<td>
<p>An <code>ngeno1^2</code> by <code>ngeno1</code> matrix of non-negative numbers
whose rows sum to <code>1</code>, where <code>ngeno1 = length(geno_freq1)</code>.
This matrix is usually generated by <code>trans_monogenic</code> or a similar
helper function, and its elements are interpreted as genetic
transmission probabilities for locus 1 (see <code>trans_monogenic</code>
for more details).  If <code>trans1</code> has <code>ngeno1 + 2</code> instead of <code>ngeno1</code> columns,
as could occur if it was generated by
<code>trans_monogenic</code> with <code>annotate = TRUE</code>, then the first two
columns will be deleted and <code>trans1</code> will be converted to a matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trans2</code></td>
<td>
<p>Similar to <code>trans1</code> (above) but interpreted as the
genetic transmission probabilities for locus 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>annotate</code></td>
<td>
<p>A logical flag. When <code>FALSE</code> (the default), the function
returns objects that can be used as the <code>geno_freq</code> and <code>trans</code> arguments of
<code>pedigree_loglikelihood</code>. When <code>TRUE</code>, the function annotates
these objects (and converts <code>trans</code> to a data frame) to make the output more
easily understood by humans.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function combines the genotype frequencies and transition
probabilities of two unlinked genetic loci that are in linkage equilibrium
in a given population.  Because
the loci are unlinked, any person's genotypes at the two loci are
conditionally independent given his or her parental genotypes,
and because the loci are in linkage equilibrium, the genotypes at the two
loci for a random person from the population are independent.
This function uses these assumptions to calculate the population frequencies
and transition probabilities for the joint genotypes of the two loci, where a
joint genotype is just a pair consisting of a genotype at locus 1
and a genotype at locus 2.  If the <code>annotate</code> option is set to <code>FALSE</code> then
these frequencies and probabilities can be used in
<code>pedigree_loglikelihood</code> to model the combined effect of the two
loci on the phenotypes.  By a repeated application of this function, more
than two genetic loci can be included in the genetic model.
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>geno_freq</code></td>
<td>
<p>A vector of strictly positive numbers (the joint genotype
frequencies) that sum to <code>1</code>, with genotype names added when <code>annotate</code> is <code>TRUE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trans</code></td>
<td>
<p>Either a matrix of genetic transmission probabilities suitable to be
used as the <code>trans</code> argument of <code>pedigree_loglikelihood</code>
(if <code>annotate</code> is <code>FALSE</code>), or a data frame that is an annotated version of
this matrix (if <code>annotate</code> is <code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genotype_decoder</code></td>
<td>
<p>A data frame giving the locus 1 and locus 2 genotypes
that correspond to each joint genotype.  In some cases, this could aid the user's
calculation of the <code>penet</code> argument of <code>pedigree_loglikelihood</code>.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">pa1 &lt;- c(0.9, 0.1); names(pa1) &lt;- c("-","+")
pa2 &lt;- c(0.5, 0.5); names(pa2) &lt;- c("A","a")
(geno_freq1 &lt;- geno_freq_monogenic(pa1, TRUE))
(geno_freq2 &lt;- geno_freq_monogenic(pa2, TRUE))
(trans1 &lt;- trans_monogenic(2, TRUE))
(trans2 &lt;- trans_monogenic(2))
(cl &lt;- combine_loci(geno_freq1, geno_freq2, trans1, trans2, TRUE))
sum(cl$geno_freq)
apply(cl$trans[,-(1:2)], 1, sum)

</code></pre>


</div>