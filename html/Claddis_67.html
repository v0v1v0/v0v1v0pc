<div class="container">

<table style="width: 100%;"><tr>
<td>permute_restricted_compositions</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Permute all ways to place n items into m bins</h2>

<h3>Description</h3>

<p>Given a positive integer, n, and a number of bins (m), permutes all possible compositions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">permute_restricted_compositions(n, m_labels, allow_zero = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>A positive integer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m_labels</code></td>
<td>
<p>A character vector of labels for m.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allow_zero</code></td>
<td>
<p>A logical indicating whether or not each bin should (<code>TRUE</code>) or should not (<code>FALSE</code>) be allowed to be zero.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Every way that an integer (<code>n</code>) can be divided up into <code>m</code> bins can be permuted using a restricted version of the mathematical concept of compositions. In practice this function is designed to distribute the states for <code>n</code> tips across <code>m</code> states (e.g., with permute_tipstates), but many other uses are conceivable and hence this is included here as a general function.
</p>
<p>This algorithm reuses code from the <code>multicool</code> (Curran et al. 2021) and <code>partitions</code> (Hankin 2006) packages.
</p>
<p>The number of restricted compositions is given by the k-dimensional extension of triangular numbers (Baumann 2019):
</p>

<ul>
<li>
<p>If <code>allow_zero = TRUE</code>, the binomial coefficient, n choose k, where n = <code>n + m</code> - 1 and k = <code>m</code>.
</p>
</li>
<li>
<p>If <code>allow_zero = FALSE</code>, the binomial coefficient, n choose k, where n = <code>n</code> - 1 and k = <code>m</code>.
</p>
</li>
</ul>
<h3>Value</h3>

<p>A matrix where each row is a unique restricted composition of n and each column is a labelled bin.
</p>


<h3>Author(s)</h3>

<p>Graeme T. Lloyd <a href="mailto:graemetlloyd@gmail.com">graemetlloyd@gmail.com</a>
</p>


<h3>References</h3>

<p>Baumann, M. H., 2019. Die k-dimensionale Champagnerpyramide. Mathematische Semesterberichte, 66, 89-100.
</p>
<p>Curran, J., Williams, A., Kelleher, J. and Barber, D., 2021. multicool: Permutations of Multisets in Cool-Lex Order. R package version 0.1-12. https://CRAN.R-project.org/package=multicool.
</p>
<p>Hankin, R. K. S., 2006. Additive integer partitions in R. <em>Journal of Statistical Software, Code Snippets</em>, <b>16</b>, 1.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Permute all the ways eight can be assigned to four bins (A, C, G, T),
# with each bin assigned at least one:
permute_restricted_compositions(
  n = 8,
  m_labels = c("A", "C", "G", "T"),
  allow_zero = FALSE
)

</code></pre>


</div>