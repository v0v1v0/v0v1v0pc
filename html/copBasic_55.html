<div class="container">

<table style="width: 100%;"><tr>
<td>FRECHETcop</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The Fréchet Family Copula</h2>

<h3>Description</h3>

<p>The <em>Fréchet Family copula</em> (Durante, 2007, pp. 256–259) is
</p>
<p style="text-align: center;"><code class="reqn">\mathbf{C}_{\alpha, \beta}(u,v) = \mathbf{FF}(u,v) = \alpha\mathbf{M}(u,v) + (1-\alpha-\beta)\mathbf{\Pi}(u,v)+\beta\mathbf{W}(u,v)\mbox{,}</code>
</p>

<p>where <code class="reqn">\alpha, \beta \ge 0</code> and <code class="reqn">\alpha + \beta \le 1</code>. The Fréchet Family copulas are <em>convex combinations</em> of the fundamental copulas <code class="reqn">\mathbf{W}</code> (<em>Fréchet–Hoeffding lower-bound copula</em>; <code>W</code>), <code class="reqn">\mathbf{\Pi}</code> (independence; <code>P</code>), and <code class="reqn">\mathbf{M}</code> (<em>Fréchet–Hoeffding upper-bound copula</em>; <code>M</code>). The copula is <em>comprehensive</em> because both <code class="reqn">\mathbf{W}</code> and <code class="reqn">\mathbf{M}</code> can be obtained. The parameters are readily estimated using <em>Spearman Rho</em> (<code class="reqn">\rho_\mathbf{C}</code>; <code>rhoCOP</code>) and <em>Kendall Tau</em> (<code class="reqn">\tau_\mathbf{C}</code>; <code>tauCOP</code>) by
</p>
<p style="text-align: center;"><code class="reqn">\tau_\mathbf{C} = \frac{(\alpha - \beta)(\alpha + \beta + 2)}{3}\mbox{\ and\ } \rho_\mathbf{C} = \alpha - \beta\mbox{.}</code>
</p>

<p>The Fréchet Family copula virtually always has a visible <em>singular component</em> unless <code class="reqn">\alpha, \beta = 0</code>. The copula has respective <em>lower-</em> and <em>upper-tail dependency parameters</em> of <code class="reqn">\lambda^L = \alpha</code> and <code class="reqn">\lambda^U = \alpha</code> (<code>taildepCOP</code>). Durante (2007, p. 257) reports that the Fréchet Family copula can approximate any bivariate copula in a “unique way” and the error bound can be estimated.
</p>


<h3>Usage</h3>

<pre><code class="language-R">FRECHETcop(u,v, para=NULL, rho=NULL, tau=NULL, par2rhotau=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>Nonexceedance probability <code class="reqn">u</code> in the <code class="reqn">X</code> direction;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>Nonexceedance probability <code class="reqn">v</code> in the <code class="reqn">Y</code> direction;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>para</code></td>
<td>
<p>A vector (two element) of parameters <code class="reqn">\alpha</code> and <code class="reqn">\beta</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>Spearman Rho from which to estimate the parameters;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>Kendall Tau from which to estimate the parameters;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par2rhotau</code></td>
<td>
<p>A logical that if <code>TRUE</code> will return an <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> <code>list</code> of the <code class="reqn">\rho_\mathbf{C}</code> and <code class="reqn">\tau_\mathbf{C}</code> for the parameters; and</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to pass.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function will check the consistency of the parameters whether given by argument or computed from <code class="reqn">\rho_\mathbf{C}</code> and <code class="reqn">\tau_\mathbf{C}</code>. The term “Family” is used with this particular copula in <span class="pkg">copBasic</span> so as to draw distinction to the Fréchet lower- and upper-bound copulas as the two limiting copulas are called.
</p>
<p>For no other reason than that it can be easily done and makes a nice picture, loop through a nest of <code class="reqn">\rho</code> and <code class="reqn">\tau</code> for the Fréchet Family copula and plot the domain of the resulting parameters:
</p>
<pre>
  ops &lt;- options(warn=-1) # warning supression because "loops" are dumb
  taus &lt;- rhos &lt;- seq(-1,1, by=0.01)
  plot(NA, NA, type="n", xlim=c(0,1), ylim=c(0,1),
       xlab="Frechet Copula Parameter Alpha",
       ylab="Frechet Copula Parameter Beta")
  for(tau in taus) {
    for(rho in rhos) {
      fcop &lt;- FRECHETcop(rho=rho, tau=tau)
      if(! is.na(fcop$para[1])) points(fcop$para[1], fcop$para[2])
    }
  }
  options(ops)
</pre>


<h3>Value</h3>

<p>Value(s) for the copula are returned using the <code class="reqn">\alpha</code> and <code class="reqn">\beta</code> as set by argument <code>para</code>; however, if <code>para=NULL</code> and <code>rho</code> and <code>tau</code> are set and compatible with the copula, then <code class="reqn">\{\rho_\mathbf{C}, \tau_\mathbf{C}\} \rightarrow \{\alpha, \beta\}</code>, parameter estimation made, and an <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> <code>list</code> is returned.
</p>


<h3>Note</h3>

<p>A convex combination (<code>convex2COP</code>) of <code class="reqn">\mathbf{\Pi}</code> and <code class="reqn">\mathbf{M}</code>, which is a modification of the Fréchet Family, is the <em>Linear Spearman</em> copula:
</p>
<p style="text-align: center;"><code class="reqn">\mathbf{C}_\alpha(u,v) = (1-\alpha)\mathbf{\Pi}(u,v) + \alpha\mathbf{M}(u,v)\mbox{,}</code>
</p>

<p>for <code class="reqn">0 \le \alpha \le 1</code>, and the parameter is equal to <code class="reqn">\rho_\mathbf{C}</code>. When the convex combination is used for construction, the complement of the parameter is equal to <code class="reqn">\rho_\mathbf{C}</code> (<em>e.g.</em> <code class="reqn">1-\alpha = \rho_\mathbf{C}</code>; <code>rhoCOP</code>), which can be validated by
</p>
<pre>
  rhoCOP(cop=convex2COP, para=list(alpha=1-0.48, cop1=P, cop2=M)) # 0.4799948
</pre>


<h3>Author(s)</h3>

<p>W.H. Asquith</p>


<h3>References</h3>

<p>Durante, F., 2007, Families of copulas, Appendix C, <em>in</em> Salvadori, G., De Michele, C., Kottegoda, N.T., and Rosso, R., 2007, Extremes in Nature—An approach using copulas: Springer, 289 p.
</p>


<h3>See Also</h3>

<p><code>M</code>, <code>P</code>, <code>W</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
ppara &lt;- c(0.25, 0.50)
fcop &lt;- FRECHETcop(para=ppara, par2rhotau=TRUE)
RHO &lt;- fcop$rho; TAU &lt;- fcop$tau

level.curvesCOP(cop=FRECHETcop, para=ppara) # Durante (2007, Fig. C.27(b))
mtext("Frechet Family copula")
 UV &lt;- simCOP(n=50, cop=FRECHETcop, para=ppara, ploton=FALSE, points=FALSE)
tau &lt;- cor(UV$U, UV$V, method="kendall" ) # sample Kendall Tau
rho &lt;- cor(UV$U, UV$V, method="spearman") # sample Spearman Rho
spara &lt;- FRECHETcop(rho=rho, tau=tau) # a fitted Frechet Family copula
spara &lt;- spara$para
if(is.na(spara[1])) { # now a fittable combination is not guaranteed
   warning("sample rho and tau do not provide valid parameters, ",
           "try another simulation")
} else { # now if fit, draw some red-colored level curves for comparison
   level.curvesCOP(cop=FRECHETcop, para=spara, ploton=FALSE, col=2)
} #
## End(Not run)
</code></pre>


</div>