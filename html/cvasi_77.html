<div class="container">

<table style="width: 100%;"><tr>
<td>Lemna_Schmitt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Lemna model (Schmitt et al. 2013)</h2>

<h3>Description</h3>

<p>The model is a mechanistic combined toxicokinetic-toxicodynamic (TK/TD) and
growth model for the aquatic macrophytes <em>Lemna spp.</em>
The model simulates the development of <em>Lemna</em> biomass under laboratory and
environmental conditions and was developed by Schmitt <em>et al.</em> (2013). Growth
of the <em>Lemna</em> population is simulated on basis of photosynthesis and respiration
rates which are functions of environmental conditions.
The toxicodynamic sub-model describes the effects of growth-inhibiting
substances by a respective reduction in the photosynthesis rate based on
internal concentrations. This is the historical version of the Lemna model.
For current uses, we recommend the Lemna (SETAC) model, which is a more recent
version of the Schmitt model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Lemna_Schmitt(param, init)

Lemna_SchmittThold(param, init)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>optional named <code>list</code> or <code>vector</code> of model parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>optional named numeric <code>vector</code> of initial state values</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Constructors to ease creation of scenarios based on the <em>Lemna</em> model by
Schmitt <em>et al.</em> (2013).
A variant of this <em>Lemna</em> model, <code>Lemna_SchmittThold()</code>, provides an additional
cumulative exposure threshold parameter. The Lemna biomass stops growing
if the integral of exposure over time exceeds the threshold. The integral
of exposure is internally accounted for by an additional state variable
<code>AUC</code> (Area Under Curve).
</p>


<h3>Value</h3>

<p>an S4 object of type LemnaSchmittScenario
</p>


<h3>Functions</h3>


<ul><li> <p><code>Lemna_SchmittThold()</code>: model variant with cumulative exposure threshold
</p>
</li></ul>
<h3>State variables</h3>

<p>The following list describes the default names and standard units of the model's
state variables:
</p>

<ul>
<li>
<p> BM, g_dw/m2, dry weight biomass per square meter
</p>
</li>
<li>
<p> E, -, effect [0,1]
</p>
</li>
<li>
<p> M_int, ug, internal toxicant mass
</p>
</li>
<li>
<p> AUC, ug/L, cumulative exposure (<strong>only</strong> for <code>LemnaThreshold</code> model)
</p>
</li>
</ul>
<p>Biomass (BM) and internal toxicant mass (M_int) are initialized to zero by
default. See <code>set_init()</code> on how to set the initial states.
</p>


<h3>Model parameters</h3>

<p>The following model parameters are required:
</p>

<ul>
<li>
<p> Fate and biomass
</p>

<ul>
<li> <p><code>k_phot_fix</code>, logical, TRUE then k_phot_max is not changed by environmental factors, else FALSE
</p>
</li>
<li> <p><code>k_phot_max</code>, 1/d, maximum photosynthesis rate
</p>
</li>
<li> <p><code>k_resp</code>, 1/d, respiration rate
</p>
</li>
<li> <p><code>k_loss</code>, 1/d, rate of loss (e.g. flow rate)
</p>
</li>
<li> <p><code>mass_per_frond</code>, g_dw/frond, dry weight per frond
</p>
</li>
<li> <p><code>BMw2BMd</code>, g_fw/g_dw, Fresh weight/dry weight
</p>
</li>
</ul>
</li>
<li>
<p> Effect
</p>

<ul>
<li> <p><code>Emax</code>, -, maximum effect [0,1]
</p>
</li>
<li> <p><code>EC50</code>, ug/L, midpoint of effect curve
</p>
</li>
<li> <p><code>b</code>, -, slope of effect curve
</p>
</li>
</ul>
</li>
<li>
<p> Toxicokinetics
</p>

<ul>
<li> <p><code>P_up</code>, cm/d, Permeability for uptake
</p>
</li>
<li> <p><code>AperBM</code>, cm2/g_dw, A_leaf / d_leaf = 1/d_leaf (for circular disc, d=0.05 cm)
</p>
</li>
<li> <p><code>Kbm</code>, -, Biomass(fw) : water partition coefficient
</p>
</li>
<li> <p><code>P_Temp</code>, logical, TRUE to enable temperature dependence of cuticle permeability, else FALSE
</p>
</li>
<li> <p><code>MolWeight</code>, g/mol, Molmass of molecule (determines Q10_permeability)
</p>
</li>
</ul>
</li>
<li>
<p> Temperature dependence
</p>

<ul>
<li> <p><code>Tmin</code>, deg C, minimum temperature for growth
</p>
</li>
<li> <p><code>Tmax</code>, deg C, maximum temperature for growth
</p>
</li>
<li> <p><code>Topt</code>, deg C, optimal temperature for growth
</p>
</li>
<li> <p><code>t_ref</code>, deg C, reference temperature for respiration rate
</p>
</li>
<li> <p><code>Q10</code>, -, temperature dependence factor for respiration rate
</p>
</li>
</ul>
</li>
<li>
<p> Light dependence
</p>

<ul>
<li> <p><code>k_0</code>, 1/d, light dependence: intercept of linear part
</p>
</li>
<li> <p><code>a_k</code>, (1/d)/(kJ/m2.d), light dependence: slope of linear part
</p>
</li>
</ul>
</li>
<li>
<p> Phosphorus dependence (Hill like dep.)
</p>

<ul>
<li> <p><code>C_P</code>, mg/L, phosphorus concentration in water
</p>
</li>
<li> <p><code>CP50</code>, mg/L, phosphorus conc. where growth rate is halfed
</p>
</li>
<li> <p><code>a_p</code>, -, Hill coefficient
</p>
</li>
<li> <p><code>KiP</code>, mg/L, p-inhibition constant for very high p-conc.
</p>
</li>
</ul>
</li>
<li>
<p> Nitrogen dependence (Hill like dep.)
</p>

<ul>
<li> <p><code>C_N</code>, mg/L, nitrogen concentration in water
</p>
</li>
<li> <p><code>CN50</code>, mg/L, n-conc. where growth rate is halfed
</p>
</li>
<li> <p><code>a_N</code>, -, Hill coefficient
</p>
</li>
<li> <p><code>KiN</code>, mg/L, n-inhibition constant for very high p-conc.
</p>
</li>
</ul>
</li>
<li>
<p> Density dependence
</p>

<ul><li> <p><code>BM50</code>, g_dw/m2, cut off BM
</p>
</li></ul>
</li>
</ul>
<p>The <code>Lemna_SchmittThold</code> model requires the following additional parameter:
</p>

<ul><li> <p><code>threshold</code>, ug/L, cumulative exposure threshold
</p>
</li></ul>
<h3>Forcings</h3>

<p>Besides exposure, the Lemna model requires two environmental properties as
time-series input: global radiation (<code>rad</code>, kJ/m2.d) and temperature (<code>temp</code>, deg C).
Forcings time-series are represented by <code>data.frame</code> objects consisting of two
columns. The first for time and the second for the environmental factor in question.
</p>
<p>Entries of the <code>data.frame</code> need to be ordered chronologically. A time-series
can consist of only a single row; in this case it will represent constant
environmental conditions. See scenarios for more details.
</p>


<h3>Effects</h3>

<p>Supported effect endpoints include <em>BM</em> (biomass) and <em>r</em> (average
growth rate during simulation). The effect on biomass is calculated from
the last state of a simulation. Be aware that endpoint <em>r</em> is incompatible
with frond transfers.
</p>


<h3>Parameter boundaries</h3>

<p>Default values for parameter boundaries are set for all parameters by expert
judgement, for calibration purposes. Values can be access from the object, and
defaults overwritten.
</p>


<h3>Simulation output</h3>

<p>Simulation results will contain two additional columns besides state variables:
</p>

<ul>
<li> <p><code>C_int</code>, ug/L, internal concentration of toxicant
</p>
</li>
<li> <p><code>FrondNo</code>, -, number of fronds
</p>
</li>
</ul>
<p>It is possible to amend the output of <code>simulate()</code> with additional model
quantities that are not state variables, for e.g. debugging purposes or to
analyze model behavior. To enable or disable additional outputs, use the
optional argument <code>nout</code> of <code>simulate()</code>, see examples below. <code>nout=1</code>
enables reporting of internal concentration (C_int), <code>nout=14</code> enables all
additional outputs, and <code>nout=0</code> will disable additional outputs.
</p>
<p>The available output levels are as follows:
</p>

<ul>
<li> <p><code>nout=1</code>
</p>

<ul><li> <p><code>C_int</code>, internal concentration (ug/L)
</p>
</li></ul>
</li>
<li> <p><code>nout=2</code>
</p>

<ul><li> <p><code>FrondNo</code>, number of fronds (-)
</p>
</li></ul>
</li>
<li> <p><code>nout=3</code>
</p>

<ul><li> <p><code>C_int_u</code>, unbound internal concentration (ug/l)
</p>
</li></ul>
</li>
<li> <p><code>nout=8</code>, growth and TK/TD
</p>

<ul>
<li> <p><code>BM_fresh</code>, fresh weight biomass (g_fw/m2)
</p>
</li>
<li> <p><code>k_photo_eff</code>, current photosynthesis rate (1/d)
</p>
</li>
<li> <p><code>k_resp_eff</code>, current respiration rate (1/d)
</p>
</li>
<li> <p><code>f_Eff</code>, toxic effect factor (-)
</p>
</li>
<li> <p><code>P_up_eff</code>, current permeability for uptake (cm/d)
</p>
</li>
</ul>
</li>
<li> <p><code>nout=11</code>, environmental factors
</p>

<ul>
<li> <p><code>actConc</code>, current toxicant concentration in surrounding medium (ug/L)
</p>
</li>
<li> <p><code>actTemp</code>, current environmental temperature (deg C)
</p>
</li>
<li> <p><code>actRad</code>, current environmental radiation (kJ/m2.d)
</p>
</li>
</ul>
</li>
<li> <p><code>nout=14</code>, derivatives
</p>

<ul>
<li> <p><code style="white-space: pre;">⁠d BM/dt⁠</code>, current change in state variable BM
</p>
</li>
<li> <p><code style="white-space: pre;">⁠d E/dt⁠</code>, current change in effect
</p>
</li>
<li> <p><code style="white-space: pre;">⁠d M_int/dt⁠</code>, current change in internal toxicant mass
</p>
</li>
</ul>
</li>
</ul>
<h3>Biomass transfer</h3>

<p>Models supporting biomass transfer can be instructed to move a fixed amount
of biomass to a new medium after a period of time. This feature replicates
a procedure occurring in e.g. Lemna effect studies and may be necessary to
recreate study results.
</p>
<p>The biomass transfer feature assumes that always a fixed amount of
biomass is transferred. Transfers can occur at any fixed point in time or
in regular intervals. During a transfer, the biomass is reset to the
transferred amount and additional compartments can be scaled 1:1 accordingly,
to e.g. reflect the change in internal toxicant mass when biomass is modified.
Transfer settings can be modified using <code>set_transfer()</code>.
</p>
<p>Any transfer time point must also be an output time point. If a transfer
occurs, simulation results of that time point will report the model state
<strong>before</strong> the transfer. Be aware that in order to use transfers at regular
intervals, the simulation must start at time point zero.
</p>


<h3>References</h3>

<p>Schmitt W., Bruns E., Dollinger M., and Sowig P., 2013:
<em>Mechanistic TK/TD-model simulating the effect of growth inhibitors on
Lemna populations</em>. Ecol Model 255, pp. 1-10. <a href="https://doi.org/10.1016/j.ecolmodel.2013.01.017">doi:10.1016/j.ecolmodel.2013.01.017</a>
</p>


<h3>See Also</h3>

<p>Lemna-models, Macrophyte-models, Transferable, Scenarios
</p>
<p>Other Lemna models: 
<code>Lemna-models</code>,
<code>Lemna_SETAC()</code>
</p>
<p>Other macrophyte models: 
<code>Lemna_SETAC()</code>,
<code>Macrophyte-models</code>,
<code>Myrio()</code>,
<code>Myrio_log()</code>
</p>


</div>