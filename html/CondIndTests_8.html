<div class="container">

<table style="width: 100%;"><tr>
<td>KCI</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Kernel conditional independence test.</h2>

<h3>Description</h3>

<p>Tests the null hypothesis that Y and E are independent given X. The distribution of the test
statistic under the null hypothesis equals an infinite weighted sum of chi squared variables. This distribution
can either be approximated by a gamma distribution or by a Monte Carlo approach. This version includes an
implementation of choosing the hyperparameters by Gaussian Process regression.
</p>


<h3>Usage</h3>

<pre><code class="language-R">KCI(Y, E, X, width = 0, alpha = 0.05, unbiased = FALSE,
  gammaApprox = TRUE, GP = TRUE, nRepBs = 5000, lambda = 0.001,
  thresh = 1e-05, numEig = NROW(Y), verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>A vector of length n or a matrix or dataframe with n rows and p columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>E</code></td>
<td>
<p>A vector of length n or a matrix or dataframe with n rows and p columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A matrix or dataframe with n rows and p columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>Kernel width; if it is set to zero, the width is chosen automatically (default: 0).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Significance level (default: 0.05).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unbiased</code></td>
<td>
<p>A boolean variable that indicates whether a bias correction should be applied (default: FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gammaApprox</code></td>
<td>
<p>A boolean variable that indicates whether the null distribution is approximated by a Gamma
distribution. If it is FALSE, a Monte Carlo approach is used (default: TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GP</code></td>
<td>
<p>Flag whether to use Gaussian Process regression to choose the hyperparameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nRepBs</code></td>
<td>
<p>Number of draws for the Monte Carlo approach (default: 500).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Regularization parameter (default: 1e-03).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresh</code></td>
<td>
<p>Threshold for eigenvalues. Whenever eigenvalues are computed, they are set to zero if they are
smaller than thresh times the maximum eigenvalue (default: 1e-05).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numEig</code></td>
<td>
<p>Number of eigenvalues computed (only relevant for computing the distribution under the hypothesis
of conditional independence) (default: length(Y)).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>If <code>TRUE</code>, intermediate output is provided. (default: <code>FALSE</code>).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the following entries:
</p>

<ul>
<li> <p><code>testStatistic</code> the statistic Tr(K_(ddot(Y)|X) * K_(E|X))
</p>
</li>
<li> <p><code>criticalValue</code> the critical point at the p-value equal to alpha;
obtained by a Monte Carlo approach if <code>gammaApprox = FALSE</code>, otherwise obtained by Gamma approximation.
</p>
</li>
<li> <p><code>pvalue</code> The p-value for the null hypothesis that Y and E are independent given X.
It is obtained by a Monte Carlo approach if <code>gammaApprox = FALSE</code>, 
otherwise obtained by Gamma approximation.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R"># Example 1
n &lt;- 100
E &lt;- rnorm(n)
X &lt;- 4 + 2 * E + rnorm(n)
Y &lt;- 3 * (X)^2 + rnorm(n)
KCI(Y, E, X)
KCI(Y, X, E)

</code></pre>


</div>