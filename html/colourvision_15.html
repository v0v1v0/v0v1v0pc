<div class="container">

<table style="width: 100%;"><tr>
<td>GENmodel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
N-dimensional generic colour vision model
</h2>

<h3>Description</h3>

<p>A flexible function to build colour vision models based on any number of photoreceptor types (Gawryszewski 2018).
</p>


<h3>Usage</h3>

<pre><code class="language-R">GENmodel(photo=ncol(C)-1, type="length", length=NA, edge=NA,
          R, I, Rb=NA, C, vonKries = TRUE, func, unity=FALSE,
          recep.noise=FALSE, noise.given=TRUE, e=NA, v=NA, n=NA,
          interpolate=TRUE, nm=seq(300,700,1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>photo</code></td>
<td>

<p>Number of photoreceptor types. Model accepts any number of photoreceptor types (<code>&gt;=2</code>). For instance, dichromatic: <code>photo=2</code>; trichromatic: <code>photo=3</code>; tetrachromatic: <code>photo=4</code>, etc. Default gets number of photoreceptor types from <code>C</code> argument.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Whether the colour space should be built with a fixed vector length (<code>type="length"</code>), or a fixed distance between vertices (<code>type="edge"</code>; e.g. Pike 2012 and Renoult et al. 2015).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>length</code></td>
<td>
<p>Vector length used to construct the colour space. Used when <code>type="length"</code>. Typically <code>length=1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edge</code></td>
<td>
<p>Edge length used to construct the colour space. Used when <code>type="edge"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>

<p>Reflectance of observed objects. A data frame with first column corresponding to wavelength values and following columns with reflectance values. <code>R</code> must be in the same scale as <code>Rb</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>I</code></td>
<td>

<p>Irradiance spectrum. A data frame with two columns only: first column corresponding to wavelength values and second column with irradiance values. Irradiance values must be in quantum flux units.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rb</code></td>
<td>

<p>Background reflectance. A data frame with two columns only: first column corresponding to wavelength values and second column with reflectance values. <code>Rb</code> must be in the same scale as in <code>R</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>

<p>Photoreceptor sensitivity curves, from lowest to longest lambda-max. A data frame: first column corresponding to wavelength values and following columns with photoreceptor sensitivity values (see function <code>photor</code>). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vonKries</code></td>
<td>
<p>Whether the von Kries transformation should be applied to photoreceptor photon catches. Calculates the ratio between stimulus and background photoreceptor photon catches</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>func</code></td>
<td>
<p>Transformation of photoreceptors inputs. For instance, <code>func=log</code> for a ln-transformation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unity</code></td>
<td>
<p>Whether sum of photoreceptor output should be normalized to 1, as in <code>EMmodel</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>recep.noise</code></td>
<td>
<p>Logical. Whether chromaticity distances should be calculated based on receptor noises.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noise.given</code></td>
<td>
<p>Logical. Whether receptor noise is provided (<code>noise.given = TRUE</code>) or calculated from photoreceptor relative abundances (<code>noise.given = FALSE</code>). Used when <code>recep.noise=TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>e</code></td>
<td>

<p>Receptor noise of each photoreceptor type. Used when <code>recep.noise = TRUE</code> and <code>noise.given = TRUE</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>Relative number of each photoreceptor type in the retina. Used to calculate <code>e</code> when <code>recep.noise = TRUE</code> and <code>noise.given = TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>

<p>Noise-to-signal ratio of a single photoreceptor. Used to calculate <code>e</code> when <code>recep.noise = TRUE</code> and <code>noise.given = TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interpolate</code></td>
<td>

<p>Whether data files should be interpolated before further calculations. See <code>approx</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nm</code></td>
<td>

<p>A sequence of numeric values specifying where interpolation is to take place. See <code>approx</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ei</code></td>
<td>
<p>Noise of photoreceptor channels. Calculated only when <code>recep.noise=TRUE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Qri</code></td>
<td>
<p>Photoreceptor photon catch values from <code>R</code>. Relative Photoreceptor photon catches when <code>vonKries=TRUE</code>. See functions <code>Q</code> and <code>Qr</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ei</code></td>
<td>
<p>Photoreceptor outputs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xi</code></td>
<td>
<p>Stimulus colour locus coordinates in the colour space</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deltaS</code></td>
<td>
<p>Euclidean distance to the origin of the colour space. It represents the conspicuousness of the stimulus (<code>R</code>) in relation to the background (<code>Rb</code>)</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Felipe M. Gawryszewski <a href="mailto:f.gawry@gmail.com">f.gawry@gmail.com</a>
</p>


<h3>References</h3>

<p>Gawryszewski, F.M. 2018. Colour vision models: Some simulations, a general n-dimensional model, and the colourvision R package. Ecology and Evolution, 10.1002/ece3.4288.
</p>
<p>Pike, T.W. 2012. Generalised chromaticity diagrams for animals with n-chromatic colour vision. Journal of Insect Behavior 255: 277-286.
</p>
<p>Renoult, J. P., A. Kelber, and H. M. Schaefer. 2015. Colour spaces in ecology and evolutionary biology. Biol Rev Camb Philos Soc, doi: 10.1111/brv.12230.
</p>


<h3>See Also</h3>

<p><code>Q</code>, <code>Qr</code>, <code>CTTKmodel</code>, <code>EMmodel</code>, <code>RNLmodel</code>, <code>colour_space</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#A trichromatic colour vision model based on Endler and Mielke (2005)

##Photoreceptor sensitivity curves
##with lambda max at 350nm, 450nm and 550nm:
C&lt;-photor(lambda.max=c(350,450,550))

##Gray background
##with 7 percent reflectance from 300 to 700nm:
Rb &lt;- data.frame(300:700, rep(7, length(300:700)))

## Read CIE D65 standard illuminant
data("D65")

##Reflectance data
## with a sigmoid spectrum and midpoint at 500nm and 550 nm
R1&lt;-logistic(x=seq(300,700,1), x0=500, L=50, k=0.04)
R2&lt;-logistic(x=seq(300,700,1), x0=550, L=50, k=0.04)
R&lt;-cbind(R1, R2[,2])
R[,2]&lt;-R[,2]+10
R[,3]&lt;-R[,3]+10

## Run model 
model&lt;-GENmodel(length=0.75, R=R, I=D65, Rb=Rb, C=C, 
                func=log, unity=TRUE)

plot(model)
</code></pre>


</div>