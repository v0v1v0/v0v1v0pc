<div class="container">

<table style="width: 100%;"><tr>
<td>add_event</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Add eventlines to the chart</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt="[Experimental]"></a>
</p>
<p>A high-level <code>plotly::layout()</code>-function.
The function adds <code>shapes</code> and <code>annotations</code> to the main <code>chart()</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">add_event(data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data.frame-type object with <code>index</code>, <code>event</code>
and <code>color</code> columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>For internal use. Please ignore.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The data.frame must include the following columns,
</p>

<ul>
<li> <p><code>index</code> integer or date: corresponding to the event timing.
</p>
</li>
<li> <p><code>event</code> character: the event label.
</p>
</li>
<li> <p><code>color</code> character: the color of the event
</p>
</li>
</ul>
<h3>Value</h3>

<p>A <code>plotly::plot_ly()</code>-object with <code>shapes</code> and <code>annotations</code>
</p>


<h3>Author(s)</h3>

<p>Serkan Korkmaz
</p>


<h3>See Also</h3>

<p>Other chart indicators: 
<code>alma()</code>,
<code>bollinger_bands()</code>,
<code>chart()</code>,
<code>dema()</code>,
<code>donchian_channel()</code>,
<code>ema()</code>,
<code>evwma()</code>,
<code>fgi()</code>,
<code>hma()</code>,
<code>lsr()</code>,
<code>macd()</code>,
<code>rsi()</code>,
<code>sma()</code>,
<code>smi()</code>,
<code>volume()</code>,
<code>vwap()</code>,
<code>wma()</code>,
<code>zlema()</code>
</p>
<p>Other subchart indicators: 
<code>fgi()</code>,
<code>lsr()</code>,
<code>macd()</code>,
<code>rsi()</code>,
<code>smi()</code>,
<code>volume()</code>
</p>
<p>Other main chart indicators: 
<code>alma()</code>,
<code>bollinger_bands()</code>,
<code>dema()</code>,
<code>donchian_channel()</code>,
<code>ema()</code>,
<code>evwma()</code>,
<code>hma()</code>,
<code>sma()</code>,
<code>vwap()</code>,
<code>wma()</code>,
<code>zlema()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># script start;

# 1) Generate random events
# of buys and sells and convert
# to data.frame
#
# Note: tibbles, data.tables are also supported
# but only base R is shown here to avoid
# too many dependencies
set.seed(1903)
event_data &lt;- cryptoQuotes::ATOM[
  sample(
    x = 1:nrow(cryptoQuotes::ATOM),
    size = 2
  )
]

# 1.1) Extract the index
# from the event data
index &lt;- zoo::index(
  event_data
)

# 1.2) Convert the coredata
# into a data.frame
event_data &lt;- as.data.frame(
  zoo::coredata(
    event_data
  )
)

# 1.3) Add the index into the data.frame
# case insensitive
event_data$index &lt;- index

# 1.4) add events to the data.
# here we use Buys and Sells.
event_data$event &lt;- rep(
  x = c('Buy', 'Sell'),
  lenght.out = nrow(event_data)
)

# 1.5) add colors based
# on the event; here buy is colored
# darkgrey, and if the position is closed
# with profit the color is green
event_data$color &lt;- ifelse(
  event_data$event == 'Buy',
  yes = 'darkgrey',
  no  = ifelse(
    test = subset(
        x = event_data,
        event == 'Buy')$close &lt; subset(x = event_data, event == 'Sell')$close,
    yes  = 'green',
    no   = 'red'
  )
)

# 1.6) modify the event to add
# closing price at each event
event_data$event &lt;- paste0(
  event_data$event, ' @', event_data$close
)

# 2) Chart the the klines
# and add the buy and sell events
cryptoQuotes::chart(
  ticker     = cryptoQuotes::ATOM,
  main       = cryptoQuotes::kline(),
  sub        = list(
    cryptoQuotes::volume()
  ),
  indicator = list(
    cryptoQuotes::bollinger_bands()
  ),
  event_data = event_data,
  options = list(
    dark = TRUE,
    deficiency = FALSE
  )
)

# script end;
</code></pre>


</div>