<div class="container">

<table style="width: 100%;"><tr>
<td>LCTSres</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plots solutions that are identified by findstysols</h2>

<h3>Description</h3>

<p>Plots lots of useful information concerning solutions
identified using findstysols. It only plots those where the
optimizer converged. Can additionally return the time-varying
linear combination associated with any solution if plots are
turned off.
</p>


<h3>Usage</h3>

<pre><code class="language-R">LCTSres(res, tsx, tsy, inc = 0, solno = 1:nrow(res$endpar), filter.number = 1,
  family = c("DaubExPhase", "DaubLeAsymm"), plot.it = FALSE,
  spec.filter.number = 1,
  spec.family = c("DaubExPhase", "DaubLeAsymm"), plotcoef = FALSE,
  sameplot = TRUE, norm = FALSE, plotstystat = FALSE,
  plotsolinfo = TRUE, onlyacfs = FALSE,
  acfdatatrans = I, xlab = "Time", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>res</code></td>
<td>
<p>Solution set returned by findstysols</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tsx</code></td>
<td>
<p>The <code>x</code> time series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tsy</code></td>
<td>
<p>The <code>y</code> time series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inc</code></td>
<td>
<p>Adds an increment to the x-axis values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>solno</code></td>
<td>
<p>Which solution number to look at. This can be a vector of
solution numbers. The default is to look at all solutions (which
can be a lot, depending on how many you've got)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filter.number</code></td>
<td>
<p>The wavelet filter number to use in reconstructing
the linear combination function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>The wavelet family to use in reconstructing the linear
combination function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.it</code></td>
<td>
<p>Currently unused in this function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spec.filter.number</code></td>
<td>
<p>This function computes the linear combination
time series and also then computes its EWS. 
The wavelet (<code>spec.filter.number</code> is the filter number of
this wavelet) used to compute the EWS can be different to the
one used to compute the linear combination, as the latter is
only a means to an end - e.g. in principle, other basis functions
could be use in the linear combination. Also the spectrum
computed is only used to assess its constancy, so could be
a locally stationary Fourier one.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spec.family</code></td>
<td>
<p>The family of the wavelet used to compute the spectrum</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotcoef</code></td>
<td>
<p>If TRUE then only the linear combination functions
are plotted. If FALSE then a (set of potentially multiple)
composite plot(s) are produced. These composite plots are what
are usually most useful.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sameplot</code></td>
<td>
<p>If TRUE then the linear combination functions are plotted
on the same plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>norm</code></td>
<td>
<p>If TRUE then the linear combination functions are normalized
before plotting if <code>sameplot</code> is TRUE. This is so as to
be able to compare the patterns in each function without regard
to their overall size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotstystat</code></td>
<td>
<p>If TRUE (and if <code>plotcoef=FALSE</code>) this option
causes the function to plot statistics associated with the
stationary solution, <code class="reqn">Z_t</code>. The acf and partial acf are always
plotted. The time series plot of <code class="reqn">Z_t</code> and its spectrum are
optionally plotted too if <code>onlyacfs=FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotsolinfo</code></td>
<td>
<p>If TRUE (and if <code>plotsolinfo=FALSE</code>) this
option plots the <code class="reqn">\alpha_t</code> linear combination function,
the <code class="reqn">\beta_t</code> one (ie both of them),
the stationary linear combination
<code class="reqn">Z_t</code>,
and an estimate of the EWS of <code class="reqn">Z_t</code> computed using the
<code>spec.filter.number</code> and <code>spec.family</code> wavelet.
The variance associated with <code class="reqn">Z_t</code> (the minimizing variance from
the optimizer in <code>findstysols</code> and the p-value	
associated with the solution are displayed as plot titles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>onlyacfs</code></td>
<td>
<p>Only plot the two acfs if <code>plotstystat=TRUE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>acfdatatrans</code></td>
<td>
<p>A function (e.g. <code>log</code>) to transform the series
before taking and displaying the acf functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>An x label for the time series plots, and spectral plots</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Extra arguments for the acf plots.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>findstysols</code> takes two time series
and attempts to find time-varying linear combinations of the
two that are stationary. If one is found, we call it <code class="reqn">Z_t</code>.
However, <code>findstysols</code> works by numerical optimization,
typically from random starts, and, generally, there is no unique
stationary solution. 
</p>
<p>This function takes the results obtained by <code>findstysols</code>
in an object called <code>res</code> and then for a set of solutions
already identifed by the user, and supplied to this function
via <code>solno</code>, this function takes each identified solution
in turn and produces a set of plots.
</p>
<p>Determining which solutions are interesting is another problem.
The <code>COEFbothscale</code> is a useful function which
can analyze all solution sets simultaneously and, usually, arrange
them into groups which are mutually similar. Then representative
members from each group can be further analyzed by
<code>LCTSres</code>.
</p>
<p>Probably the most useful set of options is
<code>plotcoef=FALSE</code> and to issue a
<code>par(mfrow=c(2,2))</code> command prior to running
<code>LCTSres</code>. This produces the plots, four to a page,
and enables interesting features to be compared from plot to plot.
</p>
<p>The <code>plotcoef=FALSE</code> option causes four plots to be produced
(on the same page if <code>mfrow</code> is set as the previous paragraph
suggests). The first two are the (potentially) time-varying linear 
combination functions, the next is the stationary linear
combination, <code class="reqn">Z_t</code>, itself and the final plot is an estimate of
the <code class="reqn">Z_t</code>'s evolutionary wavelet spectrum. The titles of the latter
two plots display the process variance of <code class="reqn">Z_t</code> (the global
unconditional variance, because <code class="reqn">Z_t</code> is assumed to be stationary)
and the p-value associated the the hypothesis test of stationarity
of <code class="reqn">Z_t</code>. The spectral estimate show exhibit near constancy because
of the stationarity (as assessed by hypothesis test) of <code class="reqn">Z_t</code>.
</p>
<p>If <code>plotstystat=TRUE</code> then further plots are produced 
of the results of various classical time series analyses of <code class="reqn">Z_t</code>.
If <code>onlyacfs=TRUE</code> then only the acf and partial acf of <code class="reqn">Z_t</code>
are plotted, otherwise <code class="reqn">Z_t</code> and its classical spectrum are also
plotted (remember, <code class="reqn">Z_t</code>, has tested to be stationary and so these
classical methods are valid).
</p>
<p>If more than one solution is to be plotted, then the <code>scan()</code>
function is employed to pause the plots between plots.
</p>


<h3>Value</h3>

<p>The stationary solution, <code class="reqn">Z_t</code>, associated with the last solution
to be plotted is returned. Of course, if there is only one
solution to be plotted then it is the only possibility. Hence,
if all the <code>plot</code> arguments are FALSE then no plots are 
produced and the stationary linear combination of the (last)
solution number is returned.
</p>


<h3>Author(s)</h3>

<p>Guy Nason</p>


<h3>References</h3>

<p>Cardinali, A. and Nason, Guy P. (2013) Costationarity of
Locally Stationary Time Series Using costat.
<em>Journal of Statistical Software</em>, <b>55</b>, Issue 1.
</p>
<p>Cardinali, A. and Nason, G.P. (2010) Costationarity of locally stationary
time series. <em>J. Time Series Econometrics</em>, <b>2</b>, Issue 2, Article 1.
</p>


<h3>See Also</h3>

<p><code>findstysols</code></p>


<h3>Examples</h3>

<pre><code class="language-R">#
# See examples in findstysols (the plot method for the results of
# findstysols make use of LCTSres)
</code></pre>


</div>