<div class="container">

<table style="width: 100%;"><tr>
<td>keypair_openssl</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Asymmetric encryption with openssl</h2>

<h3>Description</h3>

<p>Wrap a pair of openssl keys.  You should pass your private key and
the public key of the person that you are communicating with.
</p>


<h3>Usage</h3>

<pre><code class="language-R">keypair_openssl(
  pub,
  key,
  envelope = TRUE,
  password = NULL,
  authenticated = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pub</code></td>
<td>
<p>An openssl public key.  Usually this will be the path
to the key, in which case it may either the path to a public key
or be the path to a directory containing a file
<code>id_rsa.pub</code>.  If <code>NULL</code>, then your public key will be
used (found via the environment variable <code>USER_PUBKEY</code>,
then <code style="white-space: pre;">⁠~/.ssh/id_rsa.pub⁠</code>).  However, it is not that common
to use your own public key - typically you want either the
sender of a message you are going to decrypt, or the recipient
of a message you want to send.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>key</code></td>
<td>
<p>An openssl private key.  Usually this will be the path
to the key, in which case it may either the path to a private
key or be the path to a directory containing a file.  You may
specify <code>NULL</code> here, in which case the environment variable
<code>USER_KEY</code> is checked and if that is not defined then
<code style="white-space: pre;">⁠~/.ssh/id_rsa⁠</code> will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>envelope</code></td>
<td>
<p>A logical indicating if "envelope" encryption
functions should be used.  If so, then we use
<code>openssl::encrypt_envelope()</code> and
<code>openssl::decrypt_envelope()</code>.  If <code>FALSE</code> then we use
<code>openssl::rsa_encrypt()</code> and <code>openssl::rsa_decrypt()</code>.
See the openssl docs for further details.  The main effect of
this is that using <code>envelope = TRUE</code> will allow you to
encrypt much larger data than <code>envelope = FALSE</code>; this is
because openssl asymmetric encryption can only encrypt data up
to the size of the key itself.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>password</code></td>
<td>
<p>A password for the private key.  If <code>NULL</code>
then you will be prompted interactively for your password, and
if a string then that string will be used as the password (but
be careful in scripts!)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>authenticated</code></td>
<td>
<p>Logical, indicating if the result should be
signed with your public key.  If <code>TRUE</code> then your key will
be verified on decryption.  This provides tampering detection.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>keypair_sodium()</code> for a similar function using
sodium keypairs
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Note this uses password = FALSE for use in examples only, but
# this should not be done for any data you actually care about.

# Note that the vignette contains much more information than this
# short example and should be referred to before using these
# functions.

# Generate two keypairs, one for Alice, and one for Bob
path_alice &lt;- tempfile()
path_bob &lt;- tempfile()
cyphr::ssh_keygen(path_alice, password = FALSE)
cyphr::ssh_keygen(path_bob, password = FALSE)

# Alice wants to send Bob a message so she creates a key pair with
# her private key and bob's public key (she does not have bob's
# private key).
pair_alice &lt;- cyphr::keypair_openssl(pub = path_bob, key = path_alice)

# She can then encrypt a secret message:
secret &lt;- cyphr::encrypt_string("hi bob", pair_alice)
secret

# Bob wants to read the message so he creates a key pair using
# Alice's public key and his private key:
pair_bob &lt;- cyphr::keypair_openssl(pub = path_alice, key = path_bob)

cyphr::decrypt_string(secret, pair_bob)

# Clean up
unlink(path_alice, recursive = TRUE)
unlink(path_bob, recursive = TRUE)
</code></pre>


</div>