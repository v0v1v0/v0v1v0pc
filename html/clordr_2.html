<div class="container">

<table style="width: 100%;"><tr>
<td>cl.rord</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Composite Likelihood Calculation for Replciations of Spatial Ordinal Data (for illustration)</h2>

<h3>Description</h3>

<p><code>cl.rord</code> Calculate the negative composite log-likelihood value for replications of spatial ordinal data at given value of parameter value.
Note that this function is not directly used in <code>cle.rord</code> but illustration only.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cl.rord(theta, response, covar, location, radius = 4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>a vector of parameter value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>
<p>a matrix of observation (row: spatial site and column: subject).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covar</code></td>
<td>
<p>regression (design) matrix, including intercepts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>location</code></td>
<td>
<p>a matrix contains spatial location of sites within each subject</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>radius</code></td>
<td>
<p>radius for selecting pairs for the composite likelihood estimation.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>cl.rord</code> returns a list: negative composite log-likelihood, a vector of first-order partial derivatives for <code>theta</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1203)
n.subject &lt;- 10
n.lat &lt;- n.lon &lt;- 10
n.site &lt;- n.lat*n.lon

beta &lt;- c(1,2,-1) # First 1 here is the intercept
midalpha &lt;- c(1.15, 2.18) ; sigma2 &lt;- 0.7 ; phi &lt;- 0.8

true = c(midalpha,beta,sigma2,phi)

Xi = rnorm(n.subject,0,1) ; Xj &lt;- rbinom(n.site,1,0.6)

 VV &lt;- matrix(NA, nrow = n.subject*n.site, ncol = 3)

 for(i in 1:n.subject){ for(j in 1:n.site){
     VV[(i-1)*n.site+j,] &lt;- c(1,Xi[i],Xj[j])
       }
 }

location = cbind(rep(seq(1,n.lat,length=n.lat),n.lat),rep(1:n.lon, each=n.lon))
sim.data &lt;- sim.rord(n.subject, n.site, n.rep = 2, midalpha, beta, sigma2, phi, covar=VV, location)

cl.rord(theta=true,response=sim.data[[1]], covar=VV, location, radius = 4)

</code></pre>


</div>